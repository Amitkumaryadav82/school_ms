{"version":3,"file":"debug-api-d828a4a5.js","sources":["../../src/utils/debug-api.ts"],"sourcesContent":["import axios from 'axios';\r\nimport config from '../config/environment';\r\n\r\n/**\r\n * Debug utility to test API endpoints with different configurations\r\n */\r\nexport const debugApi = {\r\n  /**\r\n   * Test the fee status report API with direct axios call\r\n   * @param classGrade Optional class grade filter\r\n   * @returns Promise with the response data\r\n   */  testFeeStatusReport: async (classGrade?: number | null) => {\r\n    try {\r\n      // Get user information for debugging\r\n      const userStr = localStorage.getItem('user');\r\n      let userRole = 'unknown';\r\n      let username = 'unknown';\r\n      \r\n      if (userStr) {\r\n        try {\r\n          const userData = JSON.parse(userStr);\r\n          userRole = userData.role || 'unknown';\r\n          username = userData.username || 'unknown';\r\n          console.log(`User data from localStorage: ${username} (${userRole})`);\r\n        } catch (e) {\r\n          console.error('Error parsing user data:', e);\r\n        }\r\n      }\r\n      \r\n      // Build URL without the apiUrl duplication\r\n      let url = `${config.apiUrl}/api/fees/reports/fee-status`;\r\n      if (classGrade !== undefined && classGrade !== null) {\r\n        url += `?classGrade=${classGrade}`;\r\n      }\r\n      \r\n      console.log(`Testing fee status report with URL: ${url}`);\r\n      \r\n      // Make direct axios call with appropriate headers\r\n      const token = localStorage.getItem('token');\r\n      \r\n      // Log token information\r\n      if (token) {\r\n        try {\r\n          // Decode token parts for inspection (without verification)\r\n          const parts = token.split('.');\r\n          if (parts.length === 3) {\r\n            const payload = JSON.parse(atob(parts[1]));\r\n            console.log('Token payload:', payload);\r\n            console.log('Token expiration:', new Date(payload.exp * 1000).toLocaleString());\r\n            console.log('Token issued at:', new Date(payload.iat * 1000).toLocaleString());\r\n          }\r\n        } catch (e) {\r\n          console.error('Error decoding token:', e);\r\n        }\r\n      }\r\n      \r\n      const response = await axios.get(url, {\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n          'Content-Type': 'application/json',\r\n          'Accept': 'application/json',\r\n        }\r\n      });\r\n        console.log('Fee status report successful response:', response.data);\r\n      \r\n      // Log details about each record in the response\r\n      if (Array.isArray(response.data)) {\r\n        console.log(`Received ${response.data.length} fee status report records`);\r\n        \r\n        // Check each record's properties for better debugging\r\n        response.data.forEach((record, index) => {\r\n          console.log(`Record ${index + 1}:`, {\r\n            studentId: record.studentId,\r\n            studentName: record.studentName || record.feeName,\r\n            totalAmount: record.totalAmount,\r\n            paidAmount: record.paidAmount,\r\n            remainingAmount: record.remainingAmount,\r\n            status: record.status,\r\n            isOverdue: record.isOverdue,\r\n            hasPaymentData: !!record.paidAmount\r\n          });\r\n        });\r\n      } else {\r\n        console.log('Response is not an array. Actual type:', typeof response.data);\r\n      }\r\n      \r\n      return response.data;\r\n    } catch (error) {\r\n      console.error('Error in test fee status report:', error);\r\n      \r\n      // Log detailed error information\r\n      if (axios.isAxiosError(error)) {\r\n        console.error('HTTP Status:', error.response?.status);\r\n        console.error('Response Data:', error.response?.data);\r\n        console.error('Request URL:', error.config?.url);\r\n        console.error('Request Headers:', error.config?.headers);\r\n      }\r\n      \r\n      throw error;\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * Verify the base URL configuration is correct\r\n   * @returns Configuration information\r\n   */\r\n  checkApiConfig: () => {\r\n    const apiUrl = config.apiUrl;\r\n    const isDevEnvironment = import.meta.env.MODE !== 'production';\r\n    \r\n    console.log('API Configuration:', {\r\n      apiUrl,\r\n      environment: import.meta.env.MODE,\r\n      isDevelopment: isDevEnvironment,\r\n    });\r\n    \r\n    return {\r\n      apiUrl,\r\n      environment: import.meta.env.MODE,\r\n      isDevelopment: isDevEnvironment,\r\n    };\r\n  }\r\n};\r\n\r\nexport default debugApi;\r\n"],"names":["debugApi","classGrade","userStr","userRole","username","userData","url","config","token","parts","payload","response","axios","record","index","error","_a","_b","_c","_d","apiUrl","isDevEnvironment"],"mappings":"sJAMO,MAAMA,EAAW,CAKjB,oBAAqB,MAAOC,GAA+B,aAC1D,GAAA,CAEI,MAAAC,EAAU,aAAa,QAAQ,MAAM,EAC3C,IAAIC,EAAW,UACXC,EAAW,UAEf,GAAIF,EACE,GAAA,CACI,MAAAG,EAAW,KAAK,MAAMH,CAAO,EACnCC,EAAWE,EAAS,MAAQ,UAC5BD,EAAWC,EAAS,UAAY,UAChC,QAAQ,IAAI,gCAAgCD,CAAQ,KAAKD,CAAQ,GAAG,QAC7D,EAAG,CACF,QAAA,MAAM,2BAA4B,CAAC,CAC7C,CAIE,IAAAG,EAAM,GAAGC,EAAO,MAAM,+BACMN,GAAe,OAC7CK,GAAO,eAAeL,CAAU,IAG1B,QAAA,IAAI,uCAAuCK,CAAG,EAAE,EAGlD,MAAAE,EAAQ,aAAa,QAAQ,OAAO,EAG1C,GAAIA,EACE,GAAA,CAEI,MAAAC,EAAQD,EAAM,MAAM,GAAG,EACzB,GAAAC,EAAM,SAAW,EAAG,CACtB,MAAMC,EAAU,KAAK,MAAM,KAAKD,EAAM,CAAC,CAAC,CAAC,EACjC,QAAA,IAAI,iBAAkBC,CAAO,EAC7B,QAAA,IAAI,oBAAqB,IAAI,KAAKA,EAAQ,IAAM,GAAI,EAAE,eAAA,CAAgB,EACtE,QAAA,IAAI,mBAAoB,IAAI,KAAKA,EAAQ,IAAM,GAAI,EAAE,eAAA,CAAgB,CAC/E,QACO,EAAG,CACF,QAAA,MAAM,wBAAyB,CAAC,CAC1C,CAGF,MAAMC,EAAW,MAAMC,EAAM,IAAIN,EAAK,CACpC,QAAS,CACP,cAAiB,UAAUE,CAAK,GAChC,eAAgB,mBAChB,OAAU,kBACZ,CAAA,CACD,EACS,eAAA,IAAI,yCAA0CG,EAAS,IAAI,EAGjE,MAAM,QAAQA,EAAS,IAAI,GAC7B,QAAQ,IAAI,YAAYA,EAAS,KAAK,MAAM,4BAA4B,EAGxEA,EAAS,KAAK,QAAQ,CAACE,EAAQC,IAAU,CACvC,QAAQ,IAAI,UAAUA,EAAQ,CAAC,IAAK,CAClC,UAAWD,EAAO,UAClB,YAAaA,EAAO,aAAeA,EAAO,QAC1C,YAAaA,EAAO,YACpB,WAAYA,EAAO,WACnB,gBAAiBA,EAAO,gBACxB,OAAQA,EAAO,OACf,UAAWA,EAAO,UAClB,eAAgB,CAAC,CAACA,EAAO,UAAA,CAC1B,CAAA,CACF,GAED,QAAQ,IAAI,yCAA0C,OAAOF,EAAS,IAAI,EAGrEA,EAAS,WACTI,EAAO,CACN,cAAA,MAAM,mCAAoCA,CAAK,EAGnDH,EAAM,aAAaG,CAAK,IAC1B,QAAQ,MAAM,gBAAgBC,EAAAD,EAAM,WAAN,YAAAC,EAAgB,MAAM,EACpD,QAAQ,MAAM,kBAAkBC,EAAAF,EAAM,WAAN,YAAAE,EAAgB,IAAI,EACpD,QAAQ,MAAM,gBAAgBC,EAAAH,EAAM,SAAN,YAAAG,EAAc,GAAG,EAC/C,QAAQ,MAAM,oBAAoBC,EAAAJ,EAAM,SAAN,YAAAI,EAAc,OAAO,GAGnDJ,CACR,CACF,EAMA,eAAgB,IAAM,CACpB,MAAMK,EAASb,EAAO,OAChBc,EAAmB,GAEzB,eAAQ,IAAI,qBAAsB,CAChC,OAAAD,EACA,YAAa,aACb,cAAeC,CAAA,CAChB,EAEM,CACL,OAAAD,EACA,YAAa,aACb,cAAeC,CAAA,CAEnB,CACF"}