import{j as t,S as Xr,A as Se,T as Ss,L as ve,a as we,b as tt,d as je,B as w,C as tr,e as Qr,I as st,M as Zr,f as b,g as ts,h as sr,i as en,k as tn,l as G,m as sn,D as vs,n as rn,o as nn,p as et,q as xt,r as rt,s as on,t as We,u as N,R as rr,v as nr,w as W,W as zt,G as S,x as ws,E as an,y as $e,z as ln,F as cn,H as oe,J as ae,K as dn,N as un,O as ze,Q as qe,U as He,V as $,X as At,Y as Et,Z as Ct,_ as Ve,$ as hn,a0 as or,a1 as ar,a2 as ir,a3 as lr,a4 as yt,a5 as J,a6 as mn,a7 as cr,a8 as fn,a9 as Tt,aa as qt,ab as Ht,ac as As,ad as pn,ae as ke,af as se,ag as gn,ah as le,ai as xn,aj as yn,ak as Ce,al as jn,am as bn,an as Sn,ao as vn,ap as wn,aq as An,ar as En}from"./mui-vendor-247f22ba.js";import{d as Cn,r as g,u as at,N as ht,b as Ae,L as xe,a as Tn,B as Dn,f as dr,h as he}from"./react-vendor-c0a3892c.js";import{R as Ie,P as Es,a as Cs,C as Ts,T as Ne,L as Pe,B as lt,X as ct,Y as dt,b as Ye}from"./chart-vendor-2e616ed8.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(o){if(o.ep)return;o.ep=!0;const a=r(o);fetch(o.href,a)}})();var Vt={},Ds=Cn;Vt.createRoot=Ds.createRoot,Vt.hydrateRoot=Ds.hydrateRoot;function ur(e,s){return function(){return e.apply(s,arguments)}}const{toString:Rn}=Object.prototype,{getPrototypeOf:ss}=Object,{iterator:Dt,toStringTag:hr}=Symbol,Rt=(e=>s=>{const r=Rn.call(s);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),ce=e=>(e=e.toLowerCase(),s=>Rt(s)===e),kt=e=>s=>typeof s===e,{isArray:Ge}=Array,nt=kt("undefined");function kn(e){return e!==null&&!nt(e)&&e.constructor!==null&&!nt(e.constructor)&&Y(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const mr=ce("ArrayBuffer");function In(e){let s;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?s=ArrayBuffer.isView(e):s=e&&e.buffer&&mr(e.buffer),s}const Nn=kt("string"),Y=kt("function"),fr=kt("number"),It=e=>e!==null&&typeof e=="object",Pn=e=>e===!0||e===!1,mt=e=>{if(Rt(e)!=="object")return!1;const s=ss(e);return(s===null||s===Object.prototype||Object.getPrototypeOf(s)===null)&&!(hr in e)&&!(Dt in e)},On=ce("Date"),Fn=ce("File"),Ln=ce("Blob"),Mn=ce("FileList"),Un=e=>It(e)&&Y(e.pipe),_n=e=>{let s;return e&&(typeof FormData=="function"&&e instanceof FormData||Y(e.append)&&((s=Rt(e))==="formdata"||s==="object"&&Y(e.toString)&&e.toString()==="[object FormData]"))},$n=ce("URLSearchParams"),[Bn,Wn,zn,qn]=["ReadableStream","Request","Response","Headers"].map(ce),Hn=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function it(e,s,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,o;if(typeof e!="object"&&(e=[e]),Ge(e))for(n=0,o=e.length;n<o;n++)s.call(null,e[n],n,e);else{const a=r?Object.getOwnPropertyNames(e):Object.keys(e),i=a.length;let l;for(n=0;n<i;n++)l=a[n],s.call(null,e[l],l,e)}}function pr(e,s){s=s.toLowerCase();const r=Object.keys(e);let n=r.length,o;for(;n-- >0;)if(o=r[n],s===o.toLowerCase())return o;return null}const Te=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),gr=e=>!nt(e)&&e!==Te;function Gt(){const{caseless:e}=gr(this)&&this||{},s={},r=(n,o)=>{const a=e&&pr(s,o)||o;mt(s[a])&&mt(n)?s[a]=Gt(s[a],n):mt(n)?s[a]=Gt({},n):Ge(n)?s[a]=n.slice():s[a]=n};for(let n=0,o=arguments.length;n<o;n++)arguments[n]&&it(arguments[n],r);return s}const Vn=(e,s,r,{allOwnKeys:n}={})=>(it(s,(o,a)=>{r&&Y(o)?e[a]=ur(o,r):e[a]=o},{allOwnKeys:n}),e),Gn=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Jn=(e,s,r,n)=>{e.prototype=Object.create(s.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:s.prototype}),r&&Object.assign(e.prototype,r)},Kn=(e,s,r,n)=>{let o,a,i;const l={};if(s=s||{},e==null)return s;do{for(o=Object.getOwnPropertyNames(e),a=o.length;a-- >0;)i=o[a],(!n||n(i,e,s))&&!l[i]&&(s[i]=e[i],l[i]=!0);e=r!==!1&&ss(e)}while(e&&(!r||r(e,s))&&e!==Object.prototype);return s},Yn=(e,s,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=s.length;const n=e.indexOf(s,r);return n!==-1&&n===r},Xn=e=>{if(!e)return null;if(Ge(e))return e;let s=e.length;if(!fr(s))return null;const r=new Array(s);for(;s-- >0;)r[s]=e[s];return r},Qn=(e=>s=>e&&s instanceof e)(typeof Uint8Array<"u"&&ss(Uint8Array)),Zn=(e,s)=>{const n=(e&&e[Dt]).call(e);let o;for(;(o=n.next())&&!o.done;){const a=o.value;s.call(e,a[0],a[1])}},eo=(e,s)=>{let r;const n=[];for(;(r=e.exec(s))!==null;)n.push(r);return n},to=ce("HTMLFormElement"),so=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,o){return n.toUpperCase()+o}),Rs=(({hasOwnProperty:e})=>(s,r)=>e.call(s,r))(Object.prototype),ro=ce("RegExp"),xr=(e,s)=>{const r=Object.getOwnPropertyDescriptors(e),n={};it(r,(o,a)=>{let i;(i=s(o,a,e))!==!1&&(n[a]=i||o)}),Object.defineProperties(e,n)},no=e=>{xr(e,(s,r)=>{if(Y(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(Y(n)){if(s.enumerable=!1,"writable"in s){s.writable=!1;return}s.set||(s.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},oo=(e,s)=>{const r={},n=o=>{o.forEach(a=>{r[a]=!0})};return Ge(e)?n(e):n(String(e).split(s)),r},ao=()=>{},io=(e,s)=>e!=null&&Number.isFinite(e=+e)?e:s;function lo(e){return!!(e&&Y(e.append)&&e[hr]==="FormData"&&e[Dt])}const co=e=>{const s=new Array(10),r=(n,o)=>{if(It(n)){if(s.indexOf(n)>=0)return;if(!("toJSON"in n)){s[o]=n;const a=Ge(n)?[]:{};return it(n,(i,l)=>{const h=r(i,o+1);!nt(h)&&(a[l]=h)}),s[o]=void 0,a}}return n};return r(e,0)},uo=ce("AsyncFunction"),ho=e=>e&&(It(e)||Y(e))&&Y(e.then)&&Y(e.catch),yr=((e,s)=>e?setImmediate:s?((r,n)=>(Te.addEventListener("message",({source:o,data:a})=>{o===Te&&a===r&&n.length&&n.shift()()},!1),o=>{n.push(o),Te.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",Y(Te.postMessage)),mo=typeof queueMicrotask<"u"?queueMicrotask.bind(Te):typeof process<"u"&&process.nextTick||yr,fo=e=>e!=null&&Y(e[Dt]),m={isArray:Ge,isArrayBuffer:mr,isBuffer:kn,isFormData:_n,isArrayBufferView:In,isString:Nn,isNumber:fr,isBoolean:Pn,isObject:It,isPlainObject:mt,isReadableStream:Bn,isRequest:Wn,isResponse:zn,isHeaders:qn,isUndefined:nt,isDate:On,isFile:Fn,isBlob:Ln,isRegExp:ro,isFunction:Y,isStream:Un,isURLSearchParams:$n,isTypedArray:Qn,isFileList:Mn,forEach:it,merge:Gt,extend:Vn,trim:Hn,stripBOM:Gn,inherits:Jn,toFlatObject:Kn,kindOf:Rt,kindOfTest:ce,endsWith:Yn,toArray:Xn,forEachEntry:Zn,matchAll:eo,isHTMLForm:to,hasOwnProperty:Rs,hasOwnProp:Rs,reduceDescriptors:xr,freezeMethods:no,toObjectSet:oo,toCamelCase:so,noop:ao,toFiniteNumber:io,findKey:pr,global:Te,isContextDefined:gr,isSpecCompliantForm:lo,toJSONObject:co,isAsyncFn:uo,isThenable:ho,setImmediate:yr,asap:mo,isIterable:fo};function L(e,s,r,n,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",s&&(this.code=s),r&&(this.config=r),n&&(this.request=n),o&&(this.response=o,this.status=o.status?o.status:null)}m.inherits(L,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:m.toJSONObject(this.config),code:this.code,status:this.status}}});const jr=L.prototype,br={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{br[e]={value:e}});Object.defineProperties(L,br);Object.defineProperty(jr,"isAxiosError",{value:!0});L.from=(e,s,r,n,o,a)=>{const i=Object.create(jr);return m.toFlatObject(e,i,function(h){return h!==Error.prototype},l=>l!=="isAxiosError"),L.call(i,e.message,s,r,n,o),i.cause=e,i.name=e.name,a&&Object.assign(i,a),i};const po=null;function Jt(e){return m.isPlainObject(e)||m.isArray(e)}function Sr(e){return m.endsWith(e,"[]")?e.slice(0,-2):e}function ks(e,s,r){return e?e.concat(s).map(function(o,a){return o=Sr(o),!r&&a?"["+o+"]":o}).join(r?".":""):s}function go(e){return m.isArray(e)&&!e.some(Jt)}const xo=m.toFlatObject(m,{},null,function(s){return/^is[A-Z]/.test(s)});function Nt(e,s,r){if(!m.isObject(e))throw new TypeError("target must be an object");s=s||new FormData,r=m.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(x,p){return!m.isUndefined(p[x])});const n=r.metaTokens,o=r.visitor||c,a=r.dots,i=r.indexes,h=(r.Blob||typeof Blob<"u"&&Blob)&&m.isSpecCompliantForm(s);if(!m.isFunction(o))throw new TypeError("visitor must be a function");function d(f){if(f===null)return"";if(m.isDate(f))return f.toISOString();if(!h&&m.isBlob(f))throw new L("Blob is not supported. Use a Buffer instead.");return m.isArrayBuffer(f)||m.isTypedArray(f)?h&&typeof Blob=="function"?new Blob([f]):Buffer.from(f):f}function c(f,x,p){let y=f;if(f&&!p&&typeof f=="object"){if(m.endsWith(x,"{}"))x=n?x:x.slice(0,-2),f=JSON.stringify(f);else if(m.isArray(f)&&go(f)||(m.isFileList(f)||m.endsWith(x,"[]"))&&(y=m.toArray(f)))return x=Sr(x),y.forEach(function(D,R){!(m.isUndefined(D)||D===null)&&s.append(i===!0?ks([x],R,a):i===null?x:x+"[]",d(D))}),!1}return Jt(f)?!0:(s.append(ks(p,x,a),d(f)),!1)}const u=[],j=Object.assign(xo,{defaultVisitor:c,convertValue:d,isVisitable:Jt});function A(f,x){if(!m.isUndefined(f)){if(u.indexOf(f)!==-1)throw Error("Circular reference detected in "+x.join("."));u.push(f),m.forEach(f,function(y,C){(!(m.isUndefined(y)||y===null)&&o.call(s,y,m.isString(C)?C.trim():C,x,j))===!0&&A(y,x?x.concat(C):[C])}),u.pop()}}if(!m.isObject(e))throw new TypeError("data must be an object");return A(e),s}function Is(e){const s={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return s[n]})}function rs(e,s){this._pairs=[],e&&Nt(e,this,s)}const vr=rs.prototype;vr.append=function(s,r){this._pairs.push([s,r])};vr.toString=function(s){const r=s?function(n){return s.call(this,n,Is)}:Is;return this._pairs.map(function(o){return r(o[0])+"="+r(o[1])},"").join("&")};function yo(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function wr(e,s,r){if(!s)return e;const n=r&&r.encode||yo;m.isFunction(r)&&(r={serialize:r});const o=r&&r.serialize;let a;if(o?a=o(s,r):a=m.isURLSearchParams(s)?s.toString():new rs(s,r).toString(n),a){const i=e.indexOf("#");i!==-1&&(e=e.slice(0,i)),e+=(e.indexOf("?")===-1?"?":"&")+a}return e}class jo{constructor(){this.handlers=[]}use(s,r,n){return this.handlers.push({fulfilled:s,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(s){this.handlers[s]&&(this.handlers[s]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(s){m.forEach(this.handlers,function(n){n!==null&&s(n)})}}const Ns=jo,Ar={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},bo=typeof URLSearchParams<"u"?URLSearchParams:rs,So=typeof FormData<"u"?FormData:null,vo=typeof Blob<"u"?Blob:null,wo={isBrowser:!0,classes:{URLSearchParams:bo,FormData:So,Blob:vo},protocols:["http","https","file","blob","url","data"]},ns=typeof window<"u"&&typeof document<"u",Kt=typeof navigator=="object"&&navigator||void 0,Ao=ns&&(!Kt||["ReactNative","NativeScript","NS"].indexOf(Kt.product)<0),Eo=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),Co=ns&&window.location.href||"http://localhost",To=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:ns,hasStandardBrowserEnv:Ao,hasStandardBrowserWebWorkerEnv:Eo,navigator:Kt,origin:Co},Symbol.toStringTag,{value:"Module"})),K={...To,...wo};function Do(e,s){return Nt(e,new K.classes.URLSearchParams,Object.assign({visitor:function(r,n,o,a){return K.isNode&&m.isBuffer(r)?(this.append(n,r.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)}},s))}function Ro(e){return m.matchAll(/\w+|\[(\w*)]/g,e).map(s=>s[0]==="[]"?"":s[1]||s[0])}function ko(e){const s={},r=Object.keys(e);let n;const o=r.length;let a;for(n=0;n<o;n++)a=r[n],s[a]=e[a];return s}function Er(e){function s(r,n,o,a){let i=r[a++];if(i==="__proto__")return!0;const l=Number.isFinite(+i),h=a>=r.length;return i=!i&&m.isArray(o)?o.length:i,h?(m.hasOwnProp(o,i)?o[i]=[o[i],n]:o[i]=n,!l):((!o[i]||!m.isObject(o[i]))&&(o[i]=[]),s(r,n,o[i],a)&&m.isArray(o[i])&&(o[i]=ko(o[i])),!l)}if(m.isFormData(e)&&m.isFunction(e.entries)){const r={};return m.forEachEntry(e,(n,o)=>{s(Ro(n),o,r,0)}),r}return null}function Io(e,s,r){if(m.isString(e))try{return(s||JSON.parse)(e),m.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const os={transitional:Ar,adapter:["xhr","http","fetch"],transformRequest:[function(s,r){const n=r.getContentType()||"",o=n.indexOf("application/json")>-1,a=m.isObject(s);if(a&&m.isHTMLForm(s)&&(s=new FormData(s)),m.isFormData(s))return o?JSON.stringify(Er(s)):s;if(m.isArrayBuffer(s)||m.isBuffer(s)||m.isStream(s)||m.isFile(s)||m.isBlob(s)||m.isReadableStream(s))return s;if(m.isArrayBufferView(s))return s.buffer;if(m.isURLSearchParams(s))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),s.toString();let l;if(a){if(n.indexOf("application/x-www-form-urlencoded")>-1)return Do(s,this.formSerializer).toString();if((l=m.isFileList(s))||n.indexOf("multipart/form-data")>-1){const h=this.env&&this.env.FormData;return Nt(l?{"files[]":s}:s,h&&new h,this.formSerializer)}}return a||o?(r.setContentType("application/json",!1),Io(s)):s}],transformResponse:[function(s){const r=this.transitional||os.transitional,n=r&&r.forcedJSONParsing,o=this.responseType==="json";if(m.isResponse(s)||m.isReadableStream(s))return s;if(s&&m.isString(s)&&(n&&!this.responseType||o)){const i=!(r&&r.silentJSONParsing)&&o;try{return JSON.parse(s)}catch(l){if(i)throw l.name==="SyntaxError"?L.from(l,L.ERR_BAD_RESPONSE,this,null,this.response):l}}return s}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:K.classes.FormData,Blob:K.classes.Blob},validateStatus:function(s){return s>=200&&s<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};m.forEach(["delete","get","head","post","put","patch"],e=>{os.headers[e]={}});const as=os,No=m.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Po=e=>{const s={};let r,n,o;return e&&e.split(`
`).forEach(function(i){o=i.indexOf(":"),r=i.substring(0,o).trim().toLowerCase(),n=i.substring(o+1).trim(),!(!r||s[r]&&No[r])&&(r==="set-cookie"?s[r]?s[r].push(n):s[r]=[n]:s[r]=s[r]?s[r]+", "+n:n)}),s},Ps=Symbol("internals");function Xe(e){return e&&String(e).trim().toLowerCase()}function ft(e){return e===!1||e==null?e:m.isArray(e)?e.map(ft):String(e)}function Oo(e){const s=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)s[n[1]]=n[2];return s}const Fo=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Mt(e,s,r,n,o){if(m.isFunction(n))return n.call(this,s,r);if(o&&(s=r),!!m.isString(s)){if(m.isString(n))return s.indexOf(n)!==-1;if(m.isRegExp(n))return n.test(s)}}function Lo(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(s,r,n)=>r.toUpperCase()+n)}function Mo(e,s){const r=m.toCamelCase(" "+s);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(o,a,i){return this[n].call(this,s,o,a,i)},configurable:!0})})}class Pt{constructor(s){s&&this.set(s)}set(s,r,n){const o=this;function a(l,h,d){const c=Xe(h);if(!c)throw new Error("header name must be a non-empty string");const u=m.findKey(o,c);(!u||o[u]===void 0||d===!0||d===void 0&&o[u]!==!1)&&(o[u||h]=ft(l))}const i=(l,h)=>m.forEach(l,(d,c)=>a(d,c,h));if(m.isPlainObject(s)||s instanceof this.constructor)i(s,r);else if(m.isString(s)&&(s=s.trim())&&!Fo(s))i(Po(s),r);else if(m.isObject(s)&&m.isIterable(s)){let l={},h,d;for(const c of s){if(!m.isArray(c))throw TypeError("Object iterator must return a key-value pair");l[d=c[0]]=(h=l[d])?m.isArray(h)?[...h,c[1]]:[h,c[1]]:c[1]}i(l,r)}else s!=null&&a(r,s,n);return this}get(s,r){if(s=Xe(s),s){const n=m.findKey(this,s);if(n){const o=this[n];if(!r)return o;if(r===!0)return Oo(o);if(m.isFunction(r))return r.call(this,o,n);if(m.isRegExp(r))return r.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(s,r){if(s=Xe(s),s){const n=m.findKey(this,s);return!!(n&&this[n]!==void 0&&(!r||Mt(this,this[n],n,r)))}return!1}delete(s,r){const n=this;let o=!1;function a(i){if(i=Xe(i),i){const l=m.findKey(n,i);l&&(!r||Mt(n,n[l],l,r))&&(delete n[l],o=!0)}}return m.isArray(s)?s.forEach(a):a(s),o}clear(s){const r=Object.keys(this);let n=r.length,o=!1;for(;n--;){const a=r[n];(!s||Mt(this,this[a],a,s,!0))&&(delete this[a],o=!0)}return o}normalize(s){const r=this,n={};return m.forEach(this,(o,a)=>{const i=m.findKey(n,a);if(i){r[i]=ft(o),delete r[a];return}const l=s?Lo(a):String(a).trim();l!==a&&delete r[a],r[l]=ft(o),n[l]=!0}),this}concat(...s){return this.constructor.concat(this,...s)}toJSON(s){const r=Object.create(null);return m.forEach(this,(n,o)=>{n!=null&&n!==!1&&(r[o]=s&&m.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([s,r])=>s+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(s){return s instanceof this?s:new this(s)}static concat(s,...r){const n=new this(s);return r.forEach(o=>n.set(o)),n}static accessor(s){const n=(this[Ps]=this[Ps]={accessors:{}}).accessors,o=this.prototype;function a(i){const l=Xe(i);n[l]||(Mo(o,i),n[l]=!0)}return m.isArray(s)?s.forEach(a):a(s),this}}Pt.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);m.reduceDescriptors(Pt.prototype,({value:e},s)=>{let r=s[0].toUpperCase()+s.slice(1);return{get:()=>e,set(n){this[r]=n}}});m.freezeMethods(Pt);const ie=Pt;function Ut(e,s){const r=this||as,n=s||r,o=ie.from(n.headers);let a=n.data;return m.forEach(e,function(l){a=l.call(r,a,o.normalize(),s?s.status:void 0)}),o.normalize(),a}function Cr(e){return!!(e&&e.__CANCEL__)}function Je(e,s,r){L.call(this,e??"canceled",L.ERR_CANCELED,s,r),this.name="CanceledError"}m.inherits(Je,L,{__CANCEL__:!0});function Tr(e,s,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):s(new L("Request failed with status code "+r.status,[L.ERR_BAD_REQUEST,L.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function Uo(e){const s=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return s&&s[1]||""}function _o(e,s){e=e||10;const r=new Array(e),n=new Array(e);let o=0,a=0,i;return s=s!==void 0?s:1e3,function(h){const d=Date.now(),c=n[a];i||(i=d),r[o]=h,n[o]=d;let u=a,j=0;for(;u!==o;)j+=r[u++],u=u%e;if(o=(o+1)%e,o===a&&(a=(a+1)%e),d-i<s)return;const A=c&&d-c;return A?Math.round(j*1e3/A):void 0}}function $o(e,s){let r=0,n=1e3/s,o,a;const i=(d,c=Date.now())=>{r=c,o=null,a&&(clearTimeout(a),a=null),e.apply(null,d)};return[(...d)=>{const c=Date.now(),u=c-r;u>=n?i(d,c):(o=d,a||(a=setTimeout(()=>{a=null,i(o)},n-u)))},()=>o&&i(o)]}const jt=(e,s,r=3)=>{let n=0;const o=_o(50,250);return $o(a=>{const i=a.loaded,l=a.lengthComputable?a.total:void 0,h=i-n,d=o(h),c=i<=l;n=i;const u={loaded:i,total:l,progress:l?i/l:void 0,bytes:h,rate:d||void 0,estimated:d&&l&&c?(l-i)/d:void 0,event:a,lengthComputable:l!=null,[s?"download":"upload"]:!0};e(u)},r)},Os=(e,s)=>{const r=e!=null;return[n=>s[0]({lengthComputable:r,total:e,loaded:n}),s[1]]},Fs=e=>(...s)=>m.asap(()=>e(...s)),Bo=K.hasStandardBrowserEnv?((e,s)=>r=>(r=new URL(r,K.origin),e.protocol===r.protocol&&e.host===r.host&&(s||e.port===r.port)))(new URL(K.origin),K.navigator&&/(msie|trident)/i.test(K.navigator.userAgent)):()=>!0,Wo=K.hasStandardBrowserEnv?{write(e,s,r,n,o,a){const i=[e+"="+encodeURIComponent(s)];m.isNumber(r)&&i.push("expires="+new Date(r).toGMTString()),m.isString(n)&&i.push("path="+n),m.isString(o)&&i.push("domain="+o),a===!0&&i.push("secure"),document.cookie=i.join("; ")},read(e){const s=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return s?decodeURIComponent(s[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function zo(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function qo(e,s){return s?e.replace(/\/?\/$/,"")+"/"+s.replace(/^\/+/,""):e}function Dr(e,s,r){let n=!zo(s);return e&&(n||r==!1)?qo(e,s):s}const Ls=e=>e instanceof ie?{...e}:e;function De(e,s){s=s||{};const r={};function n(d,c,u,j){return m.isPlainObject(d)&&m.isPlainObject(c)?m.merge.call({caseless:j},d,c):m.isPlainObject(c)?m.merge({},c):m.isArray(c)?c.slice():c}function o(d,c,u,j){if(m.isUndefined(c)){if(!m.isUndefined(d))return n(void 0,d,u,j)}else return n(d,c,u,j)}function a(d,c){if(!m.isUndefined(c))return n(void 0,c)}function i(d,c){if(m.isUndefined(c)){if(!m.isUndefined(d))return n(void 0,d)}else return n(void 0,c)}function l(d,c,u){if(u in s)return n(d,c);if(u in e)return n(void 0,d)}const h={url:a,method:a,data:a,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:l,headers:(d,c,u)=>o(Ls(d),Ls(c),u,!0)};return m.forEach(Object.keys(Object.assign({},e,s)),function(c){const u=h[c]||o,j=u(e[c],s[c],c);m.isUndefined(j)&&u!==l||(r[c]=j)}),r}const Rr=e=>{const s=De({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:o,xsrfCookieName:a,headers:i,auth:l}=s;s.headers=i=ie.from(i),s.url=wr(Dr(s.baseURL,s.url,s.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&i.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let h;if(m.isFormData(r)){if(K.hasStandardBrowserEnv||K.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if((h=i.getContentType())!==!1){const[d,...c]=h?h.split(";").map(u=>u.trim()).filter(Boolean):[];i.setContentType([d||"multipart/form-data",...c].join("; "))}}if(K.hasStandardBrowserEnv&&(n&&m.isFunction(n)&&(n=n(s)),n||n!==!1&&Bo(s.url))){const d=o&&a&&Wo.read(a);d&&i.set(o,d)}return s},Ho=typeof XMLHttpRequest<"u",Vo=Ho&&function(e){return new Promise(function(r,n){const o=Rr(e);let a=o.data;const i=ie.from(o.headers).normalize();let{responseType:l,onUploadProgress:h,onDownloadProgress:d}=o,c,u,j,A,f;function x(){A&&A(),f&&f(),o.cancelToken&&o.cancelToken.unsubscribe(c),o.signal&&o.signal.removeEventListener("abort",c)}let p=new XMLHttpRequest;p.open(o.method.toUpperCase(),o.url,!0),p.timeout=o.timeout;function y(){if(!p)return;const D=ie.from("getAllResponseHeaders"in p&&p.getAllResponseHeaders()),v={data:!l||l==="text"||l==="json"?p.responseText:p.response,status:p.status,statusText:p.statusText,headers:D,config:e,request:p};Tr(function(U){r(U),x()},function(U){n(U),x()},v),p=null}"onloadend"in p?p.onloadend=y:p.onreadystatechange=function(){!p||p.readyState!==4||p.status===0&&!(p.responseURL&&p.responseURL.indexOf("file:")===0)||setTimeout(y)},p.onabort=function(){p&&(n(new L("Request aborted",L.ECONNABORTED,e,p)),p=null)},p.onerror=function(){n(new L("Network Error",L.ERR_NETWORK,e,p)),p=null},p.ontimeout=function(){let R=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded";const v=o.transitional||Ar;o.timeoutErrorMessage&&(R=o.timeoutErrorMessage),n(new L(R,v.clarifyTimeoutError?L.ETIMEDOUT:L.ECONNABORTED,e,p)),p=null},a===void 0&&i.setContentType(null),"setRequestHeader"in p&&m.forEach(i.toJSON(),function(R,v){p.setRequestHeader(v,R)}),m.isUndefined(o.withCredentials)||(p.withCredentials=!!o.withCredentials),l&&l!=="json"&&(p.responseType=o.responseType),d&&([j,f]=jt(d,!0),p.addEventListener("progress",j)),h&&p.upload&&([u,A]=jt(h),p.upload.addEventListener("progress",u),p.upload.addEventListener("loadend",A)),(o.cancelToken||o.signal)&&(c=D=>{p&&(n(!D||D.type?new Je(null,e,p):D),p.abort(),p=null)},o.cancelToken&&o.cancelToken.subscribe(c),o.signal&&(o.signal.aborted?c():o.signal.addEventListener("abort",c)));const C=Uo(o.url);if(C&&K.protocols.indexOf(C)===-1){n(new L("Unsupported protocol "+C+":",L.ERR_BAD_REQUEST,e));return}p.send(a||null)})},Go=(e,s)=>{const{length:r}=e=e?e.filter(Boolean):[];if(s||r){let n=new AbortController,o;const a=function(d){if(!o){o=!0,l();const c=d instanceof Error?d:this.reason;n.abort(c instanceof L?c:new Je(c instanceof Error?c.message:c))}};let i=s&&setTimeout(()=>{i=null,a(new L(`timeout ${s} of ms exceeded`,L.ETIMEDOUT))},s);const l=()=>{e&&(i&&clearTimeout(i),i=null,e.forEach(d=>{d.unsubscribe?d.unsubscribe(a):d.removeEventListener("abort",a)}),e=null)};e.forEach(d=>d.addEventListener("abort",a));const{signal:h}=n;return h.unsubscribe=()=>m.asap(l),h}},Jo=Go,Ko=function*(e,s){let r=e.byteLength;if(!s||r<s){yield e;return}let n=0,o;for(;n<r;)o=n+s,yield e.slice(n,o),n=o},Yo=async function*(e,s){for await(const r of Xo(e))yield*Ko(r,s)},Xo=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const s=e.getReader();try{for(;;){const{done:r,value:n}=await s.read();if(r)break;yield n}}finally{await s.cancel()}},Ms=(e,s,r,n)=>{const o=Yo(e,s);let a=0,i,l=h=>{i||(i=!0,n&&n(h))};return new ReadableStream({async pull(h){try{const{done:d,value:c}=await o.next();if(d){l(),h.close();return}let u=c.byteLength;if(r){let j=a+=u;r(j)}h.enqueue(new Uint8Array(c))}catch(d){throw l(d),d}},cancel(h){return l(h),o.return()}},{highWaterMark:2})},Ot=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",kr=Ot&&typeof ReadableStream=="function",Qo=Ot&&(typeof TextEncoder=="function"?(e=>s=>e.encode(s))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),Ir=(e,...s)=>{try{return!!e(...s)}catch{return!1}},Zo=kr&&Ir(()=>{let e=!1;const s=new Request(K.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!s}),Us=64*1024,Yt=kr&&Ir(()=>m.isReadableStream(new Response("").body)),bt={stream:Yt&&(e=>e.body)};Ot&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(s=>{!bt[s]&&(bt[s]=m.isFunction(e[s])?r=>r[s]():(r,n)=>{throw new L(`Response type '${s}' is not supported`,L.ERR_NOT_SUPPORT,n)})})})(new Response);const ea=async e=>{if(e==null)return 0;if(m.isBlob(e))return e.size;if(m.isSpecCompliantForm(e))return(await new Request(K.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(m.isArrayBufferView(e)||m.isArrayBuffer(e))return e.byteLength;if(m.isURLSearchParams(e)&&(e=e+""),m.isString(e))return(await Qo(e)).byteLength},ta=async(e,s)=>{const r=m.toFiniteNumber(e.getContentLength());return r??ea(s)},sa=Ot&&(async e=>{let{url:s,method:r,data:n,signal:o,cancelToken:a,timeout:i,onDownloadProgress:l,onUploadProgress:h,responseType:d,headers:c,withCredentials:u="same-origin",fetchOptions:j}=Rr(e);d=d?(d+"").toLowerCase():"text";let A=Jo([o,a&&a.toAbortSignal()],i),f;const x=A&&A.unsubscribe&&(()=>{A.unsubscribe()});let p;try{if(h&&Zo&&r!=="get"&&r!=="head"&&(p=await ta(c,n))!==0){let v=new Request(s,{method:"POST",body:n,duplex:"half"}),I;if(m.isFormData(n)&&(I=v.headers.get("content-type"))&&c.setContentType(I),v.body){const[U,E]=Os(p,jt(Fs(h)));n=Ms(v.body,Us,U,E)}}m.isString(u)||(u=u?"include":"omit");const y="credentials"in Request.prototype;f=new Request(s,{...j,signal:A,method:r.toUpperCase(),headers:c.normalize().toJSON(),body:n,duplex:"half",credentials:y?u:void 0});let C=await fetch(f);const D=Yt&&(d==="stream"||d==="response");if(Yt&&(l||D&&x)){const v={};["status","statusText","headers"].forEach(O=>{v[O]=C[O]});const I=m.toFiniteNumber(C.headers.get("content-length")),[U,E]=l&&Os(I,jt(Fs(l),!0))||[];C=new Response(Ms(C.body,Us,U,()=>{E&&E(),x&&x()}),v)}d=d||"text";let R=await bt[m.findKey(bt,d)||"text"](C,e);return!D&&x&&x(),await new Promise((v,I)=>{Tr(v,I,{data:R,headers:ie.from(C.headers),status:C.status,statusText:C.statusText,config:e,request:f})})}catch(y){throw x&&x(),y&&y.name==="TypeError"&&/Load failed|fetch/i.test(y.message)?Object.assign(new L("Network Error",L.ERR_NETWORK,e,f),{cause:y.cause||y}):L.from(y,y&&y.code,e,f)}}),Xt={http:po,xhr:Vo,fetch:sa};m.forEach(Xt,(e,s)=>{if(e){try{Object.defineProperty(e,"name",{value:s})}catch{}Object.defineProperty(e,"adapterName",{value:s})}});const _s=e=>`- ${e}`,ra=e=>m.isFunction(e)||e===null||e===!1,Nr={getAdapter:e=>{e=m.isArray(e)?e:[e];const{length:s}=e;let r,n;const o={};for(let a=0;a<s;a++){r=e[a];let i;if(n=r,!ra(r)&&(n=Xt[(i=String(r)).toLowerCase()],n===void 0))throw new L(`Unknown adapter '${i}'`);if(n)break;o[i||"#"+a]=n}if(!n){const a=Object.entries(o).map(([l,h])=>`adapter ${l} `+(h===!1?"is not supported by the environment":"is not available in the build"));let i=s?a.length>1?`since :
`+a.map(_s).join(`
`):" "+_s(a[0]):"as no adapter specified";throw new L("There is no suitable adapter to dispatch the request "+i,"ERR_NOT_SUPPORT")}return n},adapters:Xt};function _t(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Je(null,e)}function $s(e){return _t(e),e.headers=ie.from(e.headers),e.data=Ut.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Nr.getAdapter(e.adapter||as.adapter)(e).then(function(n){return _t(e),n.data=Ut.call(e,e.transformResponse,n),n.headers=ie.from(n.headers),n},function(n){return Cr(n)||(_t(e),n&&n.response&&(n.response.data=Ut.call(e,e.transformResponse,n.response),n.response.headers=ie.from(n.response.headers))),Promise.reject(n)})}const Pr="1.9.0",Ft={};["object","boolean","number","function","string","symbol"].forEach((e,s)=>{Ft[e]=function(n){return typeof n===e||"a"+(s<1?"n ":" ")+e}});const Bs={};Ft.transitional=function(s,r,n){function o(a,i){return"[Axios v"+Pr+"] Transitional option '"+a+"'"+i+(n?". "+n:"")}return(a,i,l)=>{if(s===!1)throw new L(o(i," has been removed"+(r?" in "+r:"")),L.ERR_DEPRECATED);return r&&!Bs[i]&&(Bs[i]=!0,console.warn(o(i," has been deprecated since v"+r+" and will be removed in the near future"))),s?s(a,i,l):!0}};Ft.spelling=function(s){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${s}`),!0)};function na(e,s,r){if(typeof e!="object")throw new L("options must be an object",L.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let o=n.length;for(;o-- >0;){const a=n[o],i=s[a];if(i){const l=e[a],h=l===void 0||i(l,a,e);if(h!==!0)throw new L("option "+a+" must be "+h,L.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new L("Unknown option "+a,L.ERR_BAD_OPTION)}}const pt={assertOptions:na,validators:Ft},ue=pt.validators;class St{constructor(s){this.defaults=s||{},this.interceptors={request:new Ns,response:new Ns}}async request(s,r){try{return await this._request(s,r)}catch(n){if(n instanceof Error){let o={};Error.captureStackTrace?Error.captureStackTrace(o):o=new Error;const a=o.stack?o.stack.replace(/^.+\n/,""):"";try{n.stack?a&&!String(n.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+a):n.stack=a}catch{}}throw n}}_request(s,r){typeof s=="string"?(r=r||{},r.url=s):r=s||{},r=De(this.defaults,r);const{transitional:n,paramsSerializer:o,headers:a}=r;n!==void 0&&pt.assertOptions(n,{silentJSONParsing:ue.transitional(ue.boolean),forcedJSONParsing:ue.transitional(ue.boolean),clarifyTimeoutError:ue.transitional(ue.boolean)},!1),o!=null&&(m.isFunction(o)?r.paramsSerializer={serialize:o}:pt.assertOptions(o,{encode:ue.function,serialize:ue.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),pt.assertOptions(r,{baseUrl:ue.spelling("baseURL"),withXsrfToken:ue.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let i=a&&m.merge(a.common,a[r.method]);a&&m.forEach(["delete","get","head","post","put","patch","common"],f=>{delete a[f]}),r.headers=ie.concat(i,a);const l=[];let h=!0;this.interceptors.request.forEach(function(x){typeof x.runWhen=="function"&&x.runWhen(r)===!1||(h=h&&x.synchronous,l.unshift(x.fulfilled,x.rejected))});const d=[];this.interceptors.response.forEach(function(x){d.push(x.fulfilled,x.rejected)});let c,u=0,j;if(!h){const f=[$s.bind(this),void 0];for(f.unshift.apply(f,l),f.push.apply(f,d),j=f.length,c=Promise.resolve(r);u<j;)c=c.then(f[u++],f[u++]);return c}j=l.length;let A=r;for(u=0;u<j;){const f=l[u++],x=l[u++];try{A=f(A)}catch(p){x.call(this,p);break}}try{c=$s.call(this,A)}catch(f){return Promise.reject(f)}for(u=0,j=d.length;u<j;)c=c.then(d[u++],d[u++]);return c}getUri(s){s=De(this.defaults,s);const r=Dr(s.baseURL,s.url,s.allowAbsoluteUrls);return wr(r,s.params,s.paramsSerializer)}}m.forEach(["delete","get","head","options"],function(s){St.prototype[s]=function(r,n){return this.request(De(n||{},{method:s,url:r,data:(n||{}).data}))}});m.forEach(["post","put","patch"],function(s){function r(n){return function(a,i,l){return this.request(De(l||{},{method:s,headers:n?{"Content-Type":"multipart/form-data"}:{},url:a,data:i}))}}St.prototype[s]=r(),St.prototype[s+"Form"]=r(!0)});const gt=St;class is{constructor(s){if(typeof s!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(a){r=a});const n=this;this.promise.then(o=>{if(!n._listeners)return;let a=n._listeners.length;for(;a-- >0;)n._listeners[a](o);n._listeners=null}),this.promise.then=o=>{let a;const i=new Promise(l=>{n.subscribe(l),a=l}).then(o);return i.cancel=function(){n.unsubscribe(a)},i},s(function(a,i,l){n.reason||(n.reason=new Je(a,i,l),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(s){if(this.reason){s(this.reason);return}this._listeners?this._listeners.push(s):this._listeners=[s]}unsubscribe(s){if(!this._listeners)return;const r=this._listeners.indexOf(s);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const s=new AbortController,r=n=>{s.abort(n)};return this.subscribe(r),s.signal.unsubscribe=()=>this.unsubscribe(r),s.signal}static source(){let s;return{token:new is(function(o){s=o}),cancel:s}}}const oa=is;function aa(e){return function(r){return e.apply(null,r)}}function ia(e){return m.isObject(e)&&e.isAxiosError===!0}const Qt={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Qt).forEach(([e,s])=>{Qt[s]=e});const la=Qt;function Or(e){const s=new gt(e),r=ur(gt.prototype.request,s);return m.extend(r,gt.prototype,s,{allOwnKeys:!0}),m.extend(r,s,null,{allOwnKeys:!0}),r.create=function(o){return Or(De(e,o))},r}const q=Or(as);q.Axios=gt;q.CanceledError=Je;q.CancelToken=oa;q.isCancel=Cr;q.VERSION=Pr;q.toFormData=Nt;q.AxiosError=L;q.Cancel=q.CanceledError;q.all=function(s){return Promise.all(s)};q.spread=aa;q.isAxiosError=ia;q.mergeConfig=De;q.AxiosHeaders=ie;q.formToJSON=e=>Er(m.isHTMLForm(e)?new FormData(e):e);q.getAdapter=Nr.getAdapter;q.HttpStatusCode=la;q.default=q;const Be=q,ca={apiUrl:{}.VITE_API_URL||"https://api.schoolms.com",fallbackApiUrl:{}.VITE_FALLBACK_API_URL||"https://backup-api.schoolms.com",swaggerUrl:{}.VITE_SWAGGER_URL||"https://api.schoolms.com/swagger-ui/index.html",apiTimeout:15e3,retryAttempts:3},re=ca,fe=Be.create({baseURL:re.apiUrl,headers:{"Content-Type":"application/json"},timeout:re.apiTimeout,withCredentials:!0}),_e=Be.create({baseURL:re.fallbackApiUrl,headers:{"Content-Type":"application/json"},timeout:re.apiTimeout,withCredentials:!0});let Me=!0,Zt=0,ot=!1;const Fr=()=>!navigator.onLine;ot=Fr();typeof window<"u"&&(window.addEventListener("online",()=>{console.log("üåê Application is online"),ot=!1,Zt=0}),window.addEventListener("offline",()=>{console.log("üåê Application is offline"),ot=!0}));const Lr=async(e=!1)=>{if(ot)return console.warn("‚ö†Ô∏è Device appears to be offline, but trying request anyway"),fe;const s=Date.now();if(e||s-Zt<6e4)return Me?fe:_e;Zt=s;try{return await Be.get(`${re.apiUrl}/health`,{timeout:2e3,validateStatus:r=>r<500}),Me=!0,console.log("‚úÖ Primary API is available"),fe}catch{console.warn("‚ö†Ô∏è Primary API appears to be down, using fallback");try{return await Be.get(`${re.fallbackApiUrl}/health`,{timeout:2e3,validateStatus:n=>n<500}),console.log("‚úÖ Fallback API is available"),Me=!1,_e}catch{return console.error("‚ùå Both primary and fallback APIs are unreachable"),Me=!1,_e}}},es=async(e,s=0)=>{try{return await(await Lr(s>0))(e)}catch(r){if(s===0&&Me&&!r.response)return console.log("üîÑ Primary API failed with network error, immediately trying fallback..."),Me=!1,es(e,s+.5);if(s<re.retryAttempts&&(!r.response||r.response.status>=500))return console.log(`üîÑ Retrying request (${Math.ceil(s+1)}/${re.retryAttempts})...`),await new Promise(n=>setTimeout(n,1e3*Math.pow(2,Math.floor(s)))),es(e,Math.ceil(s+1));throw r}},Qe=async(e,s,r=null,n={})=>{const o={method:e,url:s,...n};r&&(o.data=r);try{return await es(o)}catch(a){throw a}};fe.interceptors.request.use(e=>{var o,a;console.log(`üöÄ API Request: ${(o=e.method)==null?void 0:o.toUpperCase()} ${e.baseURL}${e.url}`,{headers:{...e.headers,Authorization:e.headers.Authorization?"****":void 0},data:e.data,params:e.params});const s=localStorage.getItem("token"),r=localStorage.getItem("user");let n=null;try{r&&(n=JSON.parse(r).role,n&&(e.headers["X-User-Role"]=n),["post","put","delete"].includes((a=e.method)==null?void 0:a.toLowerCase())&&n&&(e.params=e.params||{},e.params.role=n))}catch(i){console.error("‚ö†Ô∏è Error parsing user data:",i)}if(s){console.log("üîë Auth token found, adding to request headers"),e.headers.Authorization=`Bearer ${s}`;try{const i=JSON.parse(atob(s.split(".")[1]));console.log("üîç Token payload inspection:",{exp:new Date(i.exp*1e3).toLocaleString(),roles:i.roles||i.authorities||i.role||"Not found in token",sub:i.sub||i.username})}catch(i){console.error("‚ö†Ô∏è Could not parse token for debugging:",i)}}else console.warn("‚ö†Ô∏è No auth token found in localStorage");return e},e=>(console.error("‚ùå Request interceptor error:",e),Promise.reject(e)));_e.interceptors.request.use(fe.interceptors.request.handlers[0].fulfilled,fe.interceptors.request.handlers[0].rejected);fe.interceptors.response.use(e=>{var s;return console.log(`‚úÖ API Response: ${e.status} ${(s=e.config.method)==null?void 0:s.toUpperCase()} ${e.config.url}`,{data:e.data}),e},e=>{var r,n,o,a,i,l,h,d,c;if(!e.response){console.error("üåê Network Error:",{error:e.message,config:e.config?{url:e.config.url,method:(r=e.config.method)==null?void 0:r.toUpperCase(),baseURL:e.config.baseURL}:"No config available"});const u=e.message.includes("Network Error")||e.message.includes("timeout")||e.code==="ERR_NETWORK"||e.code==="ECONNABORTED",j=Fr();return Promise.reject({message:j?"Your device appears to be offline. Please check your internet connection.":u?`Cannot connect to server at ${((n=e.config)==null?void 0:n.baseURL)||"unknown URL"}. Please check if the backend server is running.`:"Network error. Please check your connection.",status:"network_error",originalError:e,isOffline:j})}console.error(`‚ùå API Error: ${(o=e.response)==null?void 0:o.status}`,{url:(a=e.config)==null?void 0:a.url,method:(l=(i=e.config)==null?void 0:i.method)==null?void 0:l.toUpperCase(),data:(h=e.response)==null?void 0:h.data});const s={message:"",status:e.response.status,originalError:e.response.data};switch(e.response.status){case 400:s.message="Invalid request. Please check your data.";break;case 401:s.message="Unauthorized. Please log in again.",e.response.data&&((d=e.response.data.message)!=null&&d.toLowerCase().includes("expired")||(c=e.response.data.message)!=null&&c.toLowerCase().includes("invalid token"))&&(console.log("üîë Token expired or invalid - redirecting to login"),localStorage.removeItem("token"),localStorage.removeItem("user"),setTimeout(()=>{window.location.href="/login"},100));break;case 403:s.message="Access denied. You don't have permission for this action.";break;case 404:s.message="Resource not found.";break;case 422:s.message="Validation error. Please check your input.";break;case 500:s.message="Server error. Please try again later.";break;default:s.message="An unexpected error occurred."}if(e.response.data)if(typeof e.response.data=="string")try{const u=JSON.parse(e.response.data);s.message=u.message||s.message}catch{s.message=e.response.data||s.message}else s.message=e.response.data.message||s.message;return Promise.reject(s)});_e.interceptors.response.use(fe.interceptors.response.handlers[0].fulfilled,fe.interceptors.response.handlers[0].rejected);const F={get:(e,s={})=>Qe("get",e,null,s),post:(e,s,r={})=>Qe("post",e,s,r),put:(e,s,r={})=>Qe("put",e,s,r),patch:(e,s,r={})=>Qe("patch",e,s,r),delete:(e,s={})=>Qe("delete",e,null,s),api:fe,fallbackApi:_e,getApiInstance:Lr,isOffline:()=>ot},$t={setWithExpiry:(e,s,r)=>{const o={value:s,expiry:new Date().getTime()+r};localStorage.setItem(e,JSON.stringify(o))},getWithExpiry:e=>{const s=localStorage.getItem(e);if(!s)return null;try{const r=JSON.parse(s);return new Date().getTime()>r.expiry?(localStorage.removeItem(e),null):r.value}catch(r){return console.error("Error parsing stored item with TTL:",r),localStorage.removeItem(e),null}},remove:e=>{localStorage.removeItem(e)}},vt={login:async e=>{console.log("üîê AuthService: Attempting login with credentials:",{username:e.username,passwordLength:e.password?e.password.length:0});try{if(console.log("üîë AuthService: Using login endpoint: /api/auth/login"),F.isOffline()){console.log("üìµ AuthService: Device is offline, checking for cached credentials");const r=$t.getWithExpiry("offlineAuth");if(r&&r.username===e.username&&r.passwordHash===Ws(e.password))return console.log("‚úÖ AuthService: Using cached credentials for offline mode"),{data:r.authData,offlineMode:!0};throw console.error("‚ùå AuthService: No valid cached credentials found for offline mode"),{message:"You appear to be offline. Cannot authenticate without internet connection.",status:"network_error",isOffline:!0}}const s=await F.post("/api/auth/login",e);return console.log("‚úÖ AuthService: Login successful"),console.log("üîç DEBUG - Auth Response Details:",{responseData:s.data,token:s.data.token||s.data.access_token,username:s.data.username,role:s.data.role||s.data.userRole,allFields:Object.keys(s.data)}),$t.setWithExpiry("offlineAuth",{username:e.username,passwordHash:Ws(e.password),authData:s.data,timestamp:new Date().toISOString()},864e5),s}catch(s){if(console.error("‚ùå AuthService: Login failed:",s),s.status==="network_error"&&!s.isOffline){console.log("üîÑ AuthService: Network error - trying to use fallback server");try{await F.getApiInstance(!1);const r=await F.post("/api/auth/login",e);return console.log("‚úÖ AuthService: Login successful using fallback server"),r}catch(r){throw console.error("‚ùå AuthService: Login failed on fallback server too:",r),r}}throw s}},register:async e=>{try{return await F.post("/auth/register",e)}catch(s){if(s.status==="network_error"&&!s.isOffline){console.log("üîÑ AuthService: Network error during registration - trying fallback server");try{return await F.getApiInstance(!1),await F.post("/auth/register",e)}catch(r){throw console.error("‚ùå AuthService: Registration failed on fallback server too"),r}}throw s}},logout:()=>{console.log("üîí AuthService: Logging out user"),localStorage.removeItem("token"),localStorage.removeItem("user"),$t.remove("offlineAuth"),F.post("/api/auth/logout",{}).then(()=>console.log("‚úÖ AuthService: Server logout successful")).catch(e=>console.log("‚ÑπÔ∏è AuthService: Server logout failed, but client logout completed"))},validateToken:async e=>{try{return(await F.post("/api/auth/validate-token",{token:e})).data.valid===!0}catch(s){return console.error("‚ùå AuthService: Token validation failed:",s),!1}}};function Ws(e){let s=0;for(let r=0;r<e.length;r++){const n=e.charCodeAt(r);s=(s<<5)-s+n,s=s&s}return s.toString(36)}const Mr=g.createContext(void 0),da=({children:e})=>{const[s,r]=g.useState(null),[n,o]=g.useState(!1),a=l=>{r(l),o(!0)},i=()=>{o(!1)};return t.jsxs(Mr.Provider,{value:{showNotification:a},children:[e,s&&t.jsx(Xr,{open:n,autoHideDuration:6e3,onClose:i,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:t.jsx(Se,{onClose:i,severity:s.type,variant:"filled",sx:{width:"100%"},children:s.message})})]})},ne=()=>{const e=g.useContext(Mr);if(!e)throw new Error("useNotification must be used within a NotificationProvider");return e},ua=g.createContext(void 0),be=()=>{const e=g.useContext(ua);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e},ut=240,V={ADMIN:"ADMIN",TEACHER:"TEACHER",STAFF:"STAFF",PARENT:"PARENT",STUDENT:"STUDENT"},ha=[{text:"Dashboard",icon:t.jsx(rn,{}),path:"/dashboard",allowedRoles:[V.ADMIN,V.TEACHER,V.STAFF,V.PARENT,V.STUDENT]},{text:"Admissions",icon:t.jsx(nn,{}),path:"/admissions",allowedRoles:[V.ADMIN,V.STAFF]},{text:"Students",icon:t.jsx(et,{}),path:"/students",allowedRoles:[V.ADMIN,V.TEACHER,V.STAFF]},{text:"Teachers",icon:t.jsx(xt,{}),path:"/teachers",allowedRoles:[V.ADMIN,V.STAFF]},{text:"Courses",icon:t.jsx(rt,{}),path:"/courses",allowedRoles:[V.ADMIN,V.TEACHER,V.STAFF,V.STUDENT]},{text:"Reports",icon:t.jsx(on,{}),path:"/reports",allowedRoles:[V.ADMIN,V.TEACHER,V.STAFF]}],Oe=({children:e})=>{const[s,r]=g.useState(!1),[n,o]=g.useState(null),a=at(),{user:i,logout:l}=be(),h=()=>{r(!s)},d=f=>{o(f.currentTarget)},c=()=>{o(null)},u=()=>{c(),l()},j=ha.filter(f=>i&&f.allowedRoles.includes(i.role)),A=t.jsxs("div",{children:[t.jsx(Ss,{}),t.jsx(ve,{children:j.map(f=>t.jsxs(we,{button:!0,onClick:()=>{a(f.path),r(!1)},sx:{"&:hover":{backgroundColor:"rgba(0, 0, 0, 0.04)"}},children:[t.jsx(tt,{children:f.icon}),t.jsx(je,{primary:f.text})]},f.text))})]});return t.jsxs(w,{sx:{display:"flex",width:"100%",height:"100vh",overflow:"hidden"},children:[t.jsx(tr,{}),t.jsx(Qr,{position:"fixed",sx:{zIndex:f=>f.zIndex.drawer+1,width:"100%"},children:t.jsxs(Ss,{children:[t.jsx(st,{color:"inherit",edge:"start",onClick:h,sx:{mr:2,display:{sm:"none"}},children:t.jsx(Zr,{})}),t.jsx(b,{variant:"h6",noWrap:!0,component:"div",sx:{flexGrow:1,display:"flex",alignItems:"center",fontSize:{xs:"1rem",sm:"1.25rem"}},children:"School Management System"}),t.jsxs(w,{sx:{display:"flex",alignItems:"center"},children:[i&&t.jsxs(t.Fragment,{children:[t.jsx(ts,{label:i.role,color:"secondary",size:"small",sx:{mr:2,display:{xs:"none",sm:"flex"}}}),t.jsx(b,{variant:"body1",sx:{mr:2,display:{xs:"none",sm:"block"},maxWidth:"150px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:i.username||i.email})]}),t.jsx(st,{color:"inherit",onClick:d,edge:"end",children:t.jsx(sr,{sx:{width:32,height:32},children:t.jsx(en,{})})})]})]})}),t.jsx(tn,{anchorEl:n,open:!!n,onClose:c,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:t.jsxs(G,{onClick:u,children:[t.jsx(tt,{children:t.jsx(sn,{fontSize:"small"})}),t.jsx(je,{primary:"Logout"})]})}),t.jsx(vs,{variant:"temporary",open:s,onClose:h,ModalProps:{keepMounted:!0},sx:{display:{xs:"block",sm:"none"},"& .MuiDrawer-paper":{boxSizing:"border-box",width:ut,backgroundColor:"background.paper"}},children:A}),t.jsx(vs,{variant:"permanent",sx:{display:{xs:"none",sm:"block"},width:ut,flexShrink:0,"& .MuiDrawer-paper":{width:ut,boxSizing:"border-box",borderRight:"1px solid rgba(0, 0, 0, 0.12)"}},open:!0,children:A}),t.jsx(w,{component:"main",sx:{flexGrow:1,p:3,width:{xs:"100%",sm:`calc(100% - ${ut}px)`},marginTop:"64px",overflow:"auto"},children:e})]})},Ze=({children:e,allowedRoles:s})=>{const{user:r,isAuthenticated:n}=be(),{showNotification:o}=ne();return g.useEffect(()=>{console.log("üîí RoleBasedRoute checking access for path:",window.location.pathname),console.log("üë§ User role:",r==null?void 0:r.role),console.log("‚úÖ Allowed roles:",s),console.log("üîë Access granted:",r&&s.includes(r.role));const i=localStorage.getItem("token");if(i)try{const l=JSON.parse(atob(i.split(".")[1]));console.log("üîç Token payload:",{exp:new Date(l.exp*1e3).toLocaleString(),roles:l.roles||l.authorities||l.role||"Not found in token",username:l.sub||l.username||"Not found in token"})}catch(l){console.error("Error parsing token:",l)}else console.warn("‚ö†Ô∏è No token available for role verification")},[r,s]),n?r?s.some(i=>r.role.toUpperCase()===i.toUpperCase())?(console.log("‚úÖ Access granted to:",window.location.pathname),t.jsx(t.Fragment,{children:e})):(console.error(`‚ùå Access denied: User role "${r.role}" not in allowed roles:`,s),o({type:"error",message:"Access denied: You do not have permission to view this page"}),t.jsx(ht,{to:"/"})):(console.error("‚ùå User object is null or undefined"),o({type:"error",message:"Authentication error: User data is missing"}),t.jsx(ht,{to:"/login"})):(console.warn("‚ö†Ô∏è User not authenticated, redirecting to login"),t.jsx(ht,{to:"/login"}))},ma=()=>localStorage.getItem("useMockStudentData")==="true",fa=e=>{localStorage.setItem("useMockStudentData",e?"true":"false"),console.log(`üîß Mock mode ${e?"enabled":"disabled"} for student data`)};localStorage.getItem("useMockStudentData")===null&&(localStorage.setItem("useMockStudentData","false"),console.log("üîß Mock mode disabled by default - using real API endpoints"));const te=async(e,s="GET",r=null)=>{console.log(`üîç DEBUG [studentService]: Attempting ${s} request to ${e}`);const n=localStorage.getItem("token"),o=localStorage.getItem("user");let a=null,i=null;try{o&&(a=JSON.parse(o)),n&&n.split(".").length===3&&(i=JSON.parse(atob(n.split(".")[1])))}catch(h){console.error("Error parsing auth data for debug",h)}console.log("üîë DEBUG [studentService]: Auth context",{hasToken:!!n,tokenPrefix:n?n.substring(0,15)+"...":null,user:a,tokenData:i?{exp:i.exp?new Date(i.exp*1e3).toLocaleString():"N/A",sub:i.sub||i.username||"N/A",role:i.role||(i.authorities?i.authorities[0]:"N/A")}:null});let l=null;try{return console.log(`‚è≥ Attempting API call to: ${e}`),s==="GET"?l=await F.get(e):s==="POST"?l=await F.post(e,r):s==="PUT"?l=await F.put(e,r):s==="DELETE"&&(l=await F.delete(e)),console.log(`‚úÖ API call succeeded: ${e}`,{status:l.status,data:l.data}),l}catch(h){throw console.error(`‚ùå API call failed: ${e}`,h),h}},Z={getAll:async()=>(console.log("üîç Getting all students"),te("/api/students")),getById:async e=>(console.log(`üîç Getting student with ID: ${e}`),te(`/api/students/${e}`)),create:async e=>(console.log("üìù Creating new student"),te("/api/students","POST",e)),update:async(e,s)=>(console.log(`üìù Updating student with ID: ${e}`),te(`/api/students/${e}`,"PUT",s)),delete:async e=>(console.log(`üóëÔ∏è Deleting student with ID: ${e}`),te(`/api/students/${e}`,"DELETE")),updateStatus:async(e,s)=>(console.log(`üìù Updating status for student with ID: ${e}`),te(`/api/students/${e}/status`,"PUT",{status:s})),getByStudentId:async e=>(console.log(`üîç Finding student with student ID: ${e}`),te(`/api/students/student-id/${e}`)),getStudentsByStatus:async e=>(console.log(`üîç Getting students with status: ${e}`),te(`/api/students/status/${e}`)),getStudentsBySection:async e=>(console.log(`üîç Getting students in section: ${e}`),te(`/api/students/section/${e}`)),searchStudents:async e=>(console.log(`üîç Searching students with query: ${e}`),te(`/api/students/search?q=${encodeURIComponent(e)}`)),getStudentsByGrade:async e=>(console.log(`üîç Getting students in grade: ${e}`),te(`/api/students/grade/${e}`)),getStudentsByGradeAndSection:async(e,s)=>(console.log(`üîç Getting students in grade ${e}, section ${s}`),te(`/api/students/grade/${e}/section/${s}`)),createWithElevatedPermissions:async e=>{console.log("üîê Attempting to create student with elevated permissions");const s=localStorage.getItem("user");let r=!1;if(s)try{const n=JSON.parse(s);r=n.role==="ADMIN",console.log(`üë§ User role: ${n.role}, isAdmin: ${r}`)}catch(n){console.error("Failed to parse user data:",n)}try{console.log("üîí Using standard API endpoint with admin role");const o=await Be.create({baseURL:re.apiUrl,headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`,"X-User-Role":"ADMIN"}}).post("/api/students",e);return console.log("‚úÖ API endpoint with admin role succeeded"),o}catch(n){throw console.error("‚ùå Failed to create student:",n),n}},updateWithElevatedPermissions:async(e,s)=>{console.log("üîê Attempting to update student with elevated permissions");const r=localStorage.getItem("user");let n=!1;if(r)try{const o=JSON.parse(r);n=o.role==="ADMIN",console.log(`üë§ User role: ${o.role}, isAdmin: ${n}`)}catch(o){console.error("Failed to parse user data:",o)}try{console.log("üîí Using standard API endpoint with admin role");const a=await Be.create({baseURL:re.apiUrl,headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`,"X-User-Role":"ADMIN"}}).put(`/api/students/${e}`,s);return console.log("‚úÖ API endpoint with admin role succeeded"),a}catch(o){throw console.error("‚ùå Failed to update student:",o),o}},toggleMockMode:e=>(fa(e),{success:!0,mockModeEnabled:e}),isMockModeEnabled:()=>ma(),getAllStudents:function(){return this.getAll()},createStudent:function(e){return this.create(e)},updateStudent:function(e,s){return this.update(e,s)},deleteStudent:function(e){return this.delete(e)}},Ue={getAll:()=>F.get("/teachers"),getById:e=>F.get(`/teachers/${e}`),create:e=>F.post("/teachers",e),update:(e,s)=>F.put(`/teachers/${e}`,s),delete:e=>F.delete(`/teachers/${e}`)},ye={getAll:()=>F.get("/courses"),getById:e=>F.get(`/courses/${e}`),create:e=>F.post("/courses",e),update:(e,s)=>F.put(`/courses/${e}`,s),delete:e=>F.delete(`/courses/${e}`),enrollStudent:(e,s)=>F.post(`/courses/${e}/enroll/${s}`),unenrollStudent:(e,s)=>F.post(`/courses/${e}/unenroll/${s}`),getEnrolledCourses:e=>F.get(`/students/${e}/courses`)},Ee=({message:e="Loading..."})=>t.jsxs(w,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"200px"},children:[t.jsx(We,{size:40}),t.jsx(b,{variant:"body1",sx:{mt:2},children:e})]}),Ke=({message:e="An error occurred. Please try again.",onRetry:s})=>t.jsx(w,{sx:{maxWidth:600,mx:"auto",mt:2},children:t.jsxs(Se,{severity:"error",action:s&&t.jsx(N,{color:"inherit",size:"small",startIcon:t.jsx(rr,{}),onClick:s,children:"Retry"}),children:[t.jsx(nr,{children:"Error"}),e]})}),me=({title:e,value:s,icon:r,color:n,onClick:o})=>t.jsxs(oe,{sx:{height:"100%",display:"flex",flexDirection:"column",cursor:o?"pointer":"default",transition:"transform 0.2s","&:hover":o?{transform:"translateY(-4px)",boxShadow:4}:{}},onClick:o,children:[t.jsxs(ae,{sx:{flexGrow:1},children:[t.jsxs(w,{sx:{display:"flex",alignItems:"center",mb:2},children:[t.jsx(r,{sx:{color:n}}),t.jsx(b,{variant:"h6",component:"div",sx:{ml:1},children:e})]}),t.jsx(b,{variant:"h4",color:n,children:s})]}),o&&t.jsx(dn,{children:t.jsx(N,{size:"small",endIcon:t.jsx(un,{}),children:"View Details"})})]}),zs=()=>{const e=at(),{user:s}=be(),{showNotification:r}=ne(),[n,o]=g.useState({studentInfo:null,enrolledCourses:[],upcomingAssignments:[],attendance:{present:0,absent:0,late:0,percentage:0}}),[a,i]=g.useState(!0),[l,h]=g.useState(null),d=async()=>{var c,u;try{i(!0),h(null),console.log("StudentDashboard: Fetching data from backend API");const j=s.id||s.studentId;j||console.warn("StudentDashboard: No student ID found in user object:",s);const[A,f,x]=await Promise.all([ye.getEnrolledCourses(j),Z.getAssignments(j),Z.getAttendance(j)]);console.log("StudentDashboard: Data loaded successfully",{courses:(c=A==null?void 0:A.data)==null?void 0:c.length,assignments:(u=f==null?void 0:f.data)==null?void 0:u.length,attendance:!!(x!=null&&x.data)});const p=x.data||{},y=p.present||0,C=p.absent||0,D=p.late||0,R=y+C+D,v=R>0?Math.round(y/R*100):0;o({studentInfo:s,enrolledCourses:A.data||[],upcomingAssignments:f.data||[],attendance:{present:y,absent:C,late:D,percentage:v}})}catch(j){console.error("StudentDashboard: Error loading dashboard data:",j),j.response&&j.response.status===404?h("Student API endpoints not available. Please contact your administrator."):h("Failed to load student dashboard data. Please check your connection."),r({type:"error",message:"Could not load student dashboard data from server."})}finally{i(!1)}};return g.useEffect(()=>{console.log("StudentDashboard: Component mounted, loading data from API"),d();const c=setInterval(d,5*60*1e3);return()=>clearInterval(c)},[]),a?t.jsx(Ee,{message:"Loading your dashboard data from server..."}):l?t.jsx(Ke,{message:l,onRetry:d}):t.jsxs(w,{children:[t.jsxs(b,{variant:"h4",sx:{mb:4},children:["Student Dashboard",s&&t.jsxs(b,{variant:"subtitle1",color:"text.secondary",children:["Welcome, ",s.name||s.username]})]}),t.jsxs(S,{container:!0,spacing:3,children:[t.jsx(S,{item:!0,xs:12,sm:6,md:3,children:t.jsx(me,{title:"Enrolled Courses",value:n.enrolledCourses.length,icon:rt,color:"primary.main",onClick:()=>e("/courses")})}),t.jsx(S,{item:!0,xs:12,sm:6,md:3,children:t.jsx(me,{title:"Upcoming Assignments",value:n.upcomingAssignments.length,icon:ws,color:"secondary.main"})}),t.jsx(S,{item:!0,xs:12,sm:6,md:3,children:t.jsx(me,{title:"Attendance Rate",value:`${n.attendance.percentage}%`,icon:an,color:"success.main"})}),t.jsx(S,{item:!0,xs:12,sm:6,md:3,children:t.jsx(me,{title:"GPA",value:"3.5",icon:xt,color:"info.main"})}),t.jsx(S,{item:!0,xs:12,md:6,children:t.jsxs(W,{sx:{p:2,height:"100%"},children:[t.jsx(b,{variant:"h6",gutterBottom:!0,children:"Your Courses"}),t.jsx(ve,{children:n.enrolledCourses.map((c,u)=>t.jsxs(Ae.Fragment,{children:[u>0&&t.jsx($e,{}),t.jsxs(we,{children:[t.jsx(tt,{children:t.jsx(rt,{color:"primary"})}),t.jsx(je,{primary:c.name,secondary:t.jsxs(t.Fragment,{children:[c.teacher," ‚Ä¢ ",c.schedule,c.grade&&t.jsxs(b,{component:"span",color:"text.secondary",children:[" ‚Ä¢ Grade: ",t.jsx(b,{component:"span",color:"primary.main",fontWeight:"bold",children:c.grade})]})]})})]})]},c.id))}),t.jsx(w,{sx:{mt:2,display:"flex",justifyContent:"flex-end"},children:t.jsx(N,{size:"small",color:"primary",onClick:()=>e("/courses"),children:"View All Courses"})})]})}),t.jsx(S,{item:!0,xs:12,md:6,children:t.jsxs(W,{sx:{p:2,height:"100%"},children:[t.jsx(b,{variant:"h6",gutterBottom:!0,children:"Upcoming Assignments"}),t.jsx(ve,{children:n.upcomingAssignments.map((c,u)=>t.jsxs(Ae.Fragment,{children:[u>0&&t.jsx($e,{}),t.jsxs(we,{children:[t.jsx(tt,{children:t.jsx(ws,{color:"secondary"})}),t.jsx(je,{primary:c.title,secondary:t.jsxs(t.Fragment,{children:["Due: ",c.dueDate," ‚Ä¢ ",c.course]})})]})]},c.id))})]})}),t.jsx(S,{item:!0,xs:12,children:t.jsxs(W,{sx:{p:2},children:[t.jsx(b,{variant:"h6",gutterBottom:!0,children:"Attendance Summary"}),t.jsxs(S,{container:!0,spacing:3,sx:{mt:1},children:[t.jsx(S,{item:!0,xs:12,sm:4,children:t.jsxs(w,{sx:{textAlign:"center",p:2},children:[t.jsx(b,{variant:"h2",color:"primary.main",children:n.attendance.present}),t.jsx(b,{variant:"body1",children:"Days Present"})]})}),t.jsx(S,{item:!0,xs:6,sm:4,children:t.jsxs(w,{sx:{textAlign:"center",p:2},children:[t.jsx(b,{variant:"h2",color:"error.main",children:n.attendance.absent}),t.jsx(b,{variant:"body1",children:"Days Absent"})]})}),t.jsx(S,{item:!0,xs:6,sm:4,children:t.jsxs(w,{sx:{textAlign:"center",p:2},children:[t.jsx(b,{variant:"h2",color:"warning.main",children:n.attendance.late}),t.jsx(b,{variant:"body1",children:"Days Late"})]})})]})]})})]})]})},qs=()=>{const e=at(),{showNotification:s}=ne(),[r,n]=g.useState({totalStudents:0,totalTeachers:0,totalCourses:0,activeEnrollments:0,averageClassSize:0,coursesAtCapacity:0,recentActivity:[]}),[o,a]=g.useState(!0),[i,l]=g.useState(null),h=async()=>{try{a(!0),l(null),console.log("AdminDashboard: Fetching data from backend API");let d=[],c=[],u=[],j=[];try{d=(await Z.getAll()).data||[],console.log("AdminDashboard: Students data loaded:",d.length)}catch(y){console.error("AdminDashboard: Failed to load students",y),j.push("students")}try{c=(await Ue.getAll()).data||[],console.log("AdminDashboard: Teachers data loaded:",c.length)}catch(y){console.error("AdminDashboard: Failed to load teachers",y),j.push("teachers")}try{u=(await ye.getAll()).data||[],console.log("AdminDashboard: Courses data loaded:",u.length)}catch(y){console.error("AdminDashboard: Failed to load courses",y),j.push("courses")}j.length>0&&s({type:"warning",message:`Some data could not be loaded: ${j.join(", ")}`});const A=u.reduce((y,C)=>y+(C.enrolled||0),0),f=u.length>0?A/u.length:0,x=u.filter(y=>(y.enrolled||0)>=(y.capacity||0)).length,p=[];u.length>0&&u.slice(0,3).forEach(y=>{p.push({id:`course-${y.id}`,type:"course",description:`Course ${y.name} has ${(y.capacity||0)-(y.enrolled||0)} seats remaining`,timestamp:new Date().toISOString()})}),d.length>0&&d.slice(0,3).forEach((y,C)=>{p.push({id:`student-${y.id||C}`,type:"student",description:`Student ${y.name||"Unknown"} - Grade ${y.grade||"N/A"}`,timestamp:new Date(Date.now()-(C+1)*36e5).toISOString()})}),p.sort((y,C)=>new Date(C.timestamp).getTime()-new Date(y.timestamp).getTime()),n({totalStudents:d.length,totalTeachers:c.length,totalCourses:u.length,activeEnrollments:A,averageClassSize:f.toFixed(1),coursesAtCapacity:x,recentActivity:p})}catch(d){console.error("AdminDashboard: Error loading dashboard stats:",d),l("Failed to load dashboard statistics"),s({type:"error",message:"Failed to load dashboard statistics. Please check API connection."})}finally{a(!1)}};return g.useEffect(()=>{console.log("AdminDashboard: Component mounted, loading statistics from API"),h();const d=setInterval(h,5*60*1e3);return()=>clearInterval(d)},[]),o?t.jsx(Ee,{message:"Loading dashboard statistics..."}):t.jsxs(w,{children:[t.jsx(b,{variant:"h4",sx:{mb:4},children:"Admin Dashboard"}),t.jsxs(S,{container:!0,spacing:3,children:[t.jsx(S,{item:!0,xs:12,sm:6,md:3,children:t.jsx(me,{title:"Total Students",value:r.totalStudents,icon:et,color:"primary.main",onClick:()=>e("/students")})}),t.jsx(S,{item:!0,xs:12,sm:6,md:3,children:t.jsx(me,{title:"Total Teachers",value:r.totalTeachers,icon:xt,color:"secondary.main",onClick:()=>e("/teachers")})}),t.jsx(S,{item:!0,xs:12,sm:6,md:3,children:t.jsx(me,{title:"Total Courses",value:r.totalCourses,icon:rt,color:"success.main",onClick:()=>e("/courses")})}),t.jsx(S,{item:!0,xs:12,sm:6,md:3,children:t.jsx(me,{title:"Active Enrollments",value:r.activeEnrollments,icon:et,color:"info.main"})}),t.jsx(S,{item:!0,xs:12,sm:6,md:3,children:t.jsx(me,{title:"Average Class Size",value:r.averageClassSize,icon:ln,color:"warning.main"})}),t.jsx(S,{item:!0,xs:12,sm:6,md:3,children:t.jsx(me,{title:"Courses at Capacity",value:r.coursesAtCapacity,icon:zt,color:"error.main",onClick:()=>e("/courses")})}),t.jsx(S,{item:!0,xs:12,children:t.jsxs(W,{sx:{p:2,mt:2},children:[t.jsxs(w,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[t.jsx(b,{variant:"h6",children:"Recent Activity"}),t.jsx(N,{size:"small",startIcon:t.jsx(rr,{}),onClick:h,children:"Refresh"})]}),i?t.jsxs(b,{color:"error",sx:{textAlign:"center",py:2},children:[i,t.jsx(N,{variant:"text",color:"primary",onClick:h,sx:{ml:2},children:"Retry"})]}):r.recentActivity.length===0?t.jsx(b,{sx:{textAlign:"center",py:2},children:"No recent activity to display"}):t.jsx(ve,{children:r.recentActivity.map((d,c)=>t.jsxs(Ae.Fragment,{children:[c>0&&t.jsx($e,{}),t.jsxs(we,{children:[t.jsxs(tt,{children:[d.type==="enrollment"&&t.jsx(et,{color:"primary"}),d.type==="course"&&t.jsx(rt,{color:"secondary"}),d.type==="student"&&t.jsx(xt,{color:"success"}),d.type==="teacher"&&t.jsx(cn,{color:"info"})]}),t.jsx(je,{primary:d.description,secondary:new Date(d.timestamp).toLocaleString()})]})]},d.id||c))})]})})]})]})},pa=()=>{const{user:e}=be();if(console.log("Dashboard: Rendering dashboard component with user:",e),!e)return console.log("Dashboard: No user data available"),t.jsx(Ee,{message:"Loading user data..."});let s=e.role;if(!s)return console.error("Dashboard: User object missing role property:",e),t.jsx(w,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"calc(100vh - 130px)",width:"100%"},children:t.jsxs(W,{elevation:3,sx:{p:4,borderRadius:2,maxWidth:500,width:"100%",textAlign:"center"},children:[t.jsx(zt,{sx:{fontSize:64,color:"error.main",mb:3}}),t.jsx(b,{variant:"h4",color:"text.primary",gutterBottom:!0,children:"Authentication Error"}),t.jsx(b,{variant:"h6",color:"text.secondary",paragraph:!0,children:"Invalid user data received. Please log out and log in again."}),t.jsxs(w,{sx:{display:"flex",justifyContent:"center",gap:2},children:[t.jsx(N,{variant:"contained",color:"primary",onClick:()=>window.location.reload(),children:"Refresh Page"}),t.jsx(N,{variant:"outlined",color:"secondary",onClick:()=>{const{logout:n}=be();n?n():window.location.href="/login"},children:"Log Out"})]})]})});const r=s.toUpperCase();return console.log("Dashboard: User role (normalized):",r),r==="ADMIN"||r==="STAFF"?(console.log("Dashboard: Showing AdminDashboard for role:",r),t.jsx(qs,{})):r==="TEACHER"?(console.log("Dashboard: Showing TeacherDashboard (AdminDashboard) for role:",r),t.jsx(qs,{})):r==="STUDENT"?(console.log("Dashboard: Showing StudentDashboard for role:",r),t.jsx(zs,{})):r==="PARENT"?(console.log("Dashboard: Showing ParentDashboard (StudentDashboard) for role:",r),t.jsx(zs,{})):(console.log("Dashboard: No matching role found. Current role:",r),t.jsx(w,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"calc(100vh - 130px)",width:"100%"},children:t.jsxs(W,{elevation:3,sx:{p:4,borderRadius:2,maxWidth:500,width:"100%",textAlign:"center"},children:[t.jsx(zt,{sx:{fontSize:64,color:"warning.main",mb:3}}),t.jsx(b,{variant:"h4",color:"text.primary",gutterBottom:!0,children:"Dashboard Access Restricted"}),t.jsxs(b,{variant:"h6",color:"text.secondary",paragraph:!0,children:["Dashboard not available for role: ",r]}),t.jsx(b,{variant:"body1",color:"text.secondary",sx:{mb:3},children:"Please contact the system administrator if you believe this is an error."}),t.jsx(N,{variant:"contained",color:"primary",onClick:()=>window.location.reload(),sx:{minWidth:150},children:"Refresh Page"})]})}))},ga=({open:e,onClose:s,onSave:r,student:n,mode:o})=>{const{showNotification:a}=ne(),[i,l]=g.useState({name:"",email:"",phoneNumber:"",grade:"",section:"",dateOfBirth:"",address:"",guardianName:"",guardianContact:"",status:"ACTIVE"}),[h,d]=g.useState(!1),[c,u]=g.useState(null),[j,A]=g.useState(!1);g.useEffect(()=>{l(n?{...i,...n}:{name:"",email:"",phoneNumber:"",grade:"",section:"",dateOfBirth:"",address:"",guardianName:"",guardianContact:"",status:"ACTIVE"})},[n]);const f=p=>{const{name:y,value:C}=p.target;l({...i,[y]:C})},x=async()=>{d(!0),u(null);try{await r(i),s()}catch(p){if(console.log("Error saving student:",p),p.status===403&&!j){console.log("üîê Attempting to save with elevated permissions"),A(!0);try{if(o==="add"){const y=await Z.createWithElevatedPermissions(i);a({type:"success",message:"Student added successfully with admin permissions"}),s();return}}catch(y){console.error("Failed with elevated permissions too:",y),u("Failed to save student even with elevated permissions. Use the Debug tool to try other endpoints.")}}else u("Failed to save student: "+p.message)}finally{d(!1),A(!1)}};return t.jsxs(ze,{open:e,onClose:h?null:s,fullWidth:!0,maxWidth:"md",children:[t.jsx(qe,{children:o==="add"?"Add New Student":"Edit Student"}),t.jsxs(He,{children:[c&&t.jsx(Se,{severity:"error",sx:{mb:2,mt:1},children:c}),t.jsxs(S,{container:!0,spacing:2,sx:{mt:1},children:[t.jsx(S,{item:!0,xs:12,md:6,children:t.jsx($,{name:"name",label:"Full Name",value:i.name,onChange:f,fullWidth:!0,required:!0})}),t.jsx(S,{item:!0,xs:12,md:6,children:t.jsx($,{name:"email",label:"Email",type:"email",value:i.email,onChange:f,fullWidth:!0,required:!0})}),t.jsx(S,{item:!0,xs:12,md:6,children:t.jsx($,{name:"phoneNumber",label:"Phone Number",value:i.phoneNumber,onChange:f,fullWidth:!0})}),t.jsx(S,{item:!0,xs:12,md:6,children:t.jsx($,{name:"dateOfBirth",label:"Date of Birth",type:"date",value:i.dateOfBirth,onChange:f,InputLabelProps:{shrink:!0},fullWidth:!0})}),t.jsx(S,{item:!0,xs:12,md:6,children:t.jsx($,{name:"grade",label:"Grade",value:i.grade,onChange:f,fullWidth:!0,required:!0})}),t.jsx(S,{item:!0,xs:12,md:6,children:t.jsx($,{name:"section",label:"Section",value:i.section,onChange:f,fullWidth:!0})}),t.jsx(S,{item:!0,xs:12,children:t.jsx($,{name:"address",label:"Address",value:i.address||"",onChange:f,fullWidth:!0,multiline:!0,rows:2})}),t.jsx(S,{item:!0,xs:12,md:6,children:t.jsx($,{name:"guardianName",label:"Guardian Name",value:i.guardianName||"",onChange:f,fullWidth:!0})}),t.jsx(S,{item:!0,xs:12,md:6,children:t.jsx($,{name:"guardianContact",label:"Guardian Contact",value:i.guardianContact||"",onChange:f,fullWidth:!0})}),t.jsx(S,{item:!0,xs:12,md:6,children:t.jsxs(At,{fullWidth:!0,children:[t.jsx(Et,{children:"Status"}),t.jsxs(Ct,{name:"status",value:i.status,onChange:f,label:"Status",children:[t.jsx(G,{value:"ACTIVE",children:"Active"}),t.jsx(G,{value:"INACTIVE",children:"Inactive"}),t.jsx(G,{value:"SUSPENDED",children:"Suspended"}),t.jsx(G,{value:"GRADUATED",children:"Graduated"})]})]})})]})]}),t.jsxs(Ve,{children:[t.jsx(N,{onClick:s,disabled:h,children:"Cancel"}),t.jsx(N,{onClick:x,variant:"contained",disabled:h,color:"primary",children:h?t.jsx(We,{size:24}):"Save"})]})]})},ls=({columns:e,data:s,rowsPerPageOptions:r=[5,10,25],defaultRowsPerPage:n=10})=>{const[o,a]=g.useState(0),[i,l]=g.useState(n),[h,d]=g.useState(""),[c,u]=g.useState("asc"),[j,A]=g.useState([]),[f,x]=g.useState(!1),[p,y]=g.useState(""),C=(E,O)=>{a(O)},D=E=>{l(parseInt(E.target.value,10)),a(0)},R=E=>{u(h===E&&c==="asc"?"desc":"asc"),d(E)},v=(E,O)=>{A(k=>k.find(z=>z.field===E)?k.map(z=>z.field===E?{...z,value:O}:z):[...k,{field:E,value:O}]),a(0)},I=g.useMemo(()=>{let E=[...s];if(p){const O=p.toLowerCase();E=E.filter(k=>e.some(_=>{if(_.id==="actions")return!1;const z=k[_.id];return z!=null&&z.toString().toLowerCase().includes(O)}))}return j.forEach(O=>{O.value&&(E=E.filter(k=>{const _=k[O.field];return _!=null&&_.toString().toLowerCase().includes(O.value.toLowerCase())}))}),h&&E.sort((O,k)=>{const _=O[h],z=k[h];if(_===z)return 0;if(_==null)return 1;if(z==null)return-1;const pe=_<z?-1:1;return c==="desc"?-pe:pe}),E},[s,p,j,h,c]),U=I.slice(o*i,o*i+i);return t.jsxs(w,{children:[t.jsx(w,{sx:{mb:2},children:t.jsxs(S,{container:!0,spacing:2,alignItems:"center",children:[t.jsx(S,{item:!0,xs:!0,children:t.jsx($,{fullWidth:!0,label:"Search",value:p,onChange:E=>y(E.target.value),size:"small"})}),t.jsx(S,{item:!0,children:t.jsx(st,{onClick:()=>x(!f),children:t.jsx(hn,{color:j.length>0?"primary":"inherit"})})})]})}),t.jsx(or,{in:f,children:t.jsxs(w,{sx:{mb:2},children:[t.jsx(b,{variant:"subtitle2",sx:{mb:1},children:"Filters"}),t.jsx(S,{container:!0,spacing:2,children:e.map(E=>{var O,k;return!E.filterable||E.id==="actions"?null:t.jsx(S,{item:!0,xs:12,sm:6,md:4,children:E.filterOptions?t.jsxs(At,{fullWidth:!0,size:"small",children:[t.jsx(Et,{children:E.label}),t.jsxs(Ct,{value:((O=j.find(_=>_.field===E.id))==null?void 0:O.value)||"",onChange:_=>v(String(E.id),_.target.value),label:E.label,children:[t.jsx(G,{value:"",children:"All"}),E.filterOptions.map(_=>t.jsx(G,{value:_,children:_},_))]})]}):t.jsx($,{fullWidth:!0,label:E.label,size:"small",value:((k=j.find(_=>_.field===E.id))==null?void 0:k.value)||"",onChange:_=>v(String(E.id),_.target.value)})},String(E.id))})})]})}),t.jsxs(W,{sx:{width:"100%",overflow:"hidden"},children:[t.jsx(ar,{children:t.jsxs(ir,{stickyHeader:!0,children:[t.jsx(lr,{children:t.jsx(yt,{children:e.map(E=>t.jsx(J,{style:{minWidth:E.minWidth},children:E.sortable?t.jsx(mn,{active:h===E.id,direction:h===E.id?c:"asc",onClick:()=>R(E.id),children:E.label}):E.label},String(E.id)))})}),t.jsx(cr,{children:U.map((E,O)=>t.jsx(yt,{hover:!0,tabIndex:-1,children:e.map(k=>{const _=k.id==="actions"?null:E[k.id];return t.jsx(J,{children:k.format?k.format(_):_},String(k.id))})},E.id||O))})]})}),t.jsxs(w,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",px:2},children:[t.jsxs(b,{variant:"body2",color:"text.secondary",children:[I.length," total results"]}),t.jsx(fn,{rowsPerPageOptions:r,component:"div",count:I.length,rowsPerPage:i,page:o,onPageChange:C,onRowsPerPageChange:D})]})]})]})},xa=()=>{const{showNotification:e}=ne(),{user:s}=be(),[r,n]=g.useState([]),[o,a]=g.useState(!0),[i,l]=g.useState(null),[h,d]=g.useState(!1),[c,u]=g.useState(),[j,A]=g.useState("add"),[f,x]=g.useState(!1),[p,y]=g.useState(!1),[C,D]=g.useState([]),[R,v]=g.useState(null),[I,U]=g.useState(!1),[E,O]=g.useState(""),[k,_]=g.useState(null);g.useEffect(()=>{console.log("üîç Students component mounted"),console.log("üë§ User:",s);const P=localStorage.getItem("token");if(P)try{const ge=JSON.parse(atob(P.split(".")[1]));console.log("üîë Token payload:",{exp:new Date(ge.exp*1e3).toLocaleString(),roles:ge.roles||ge.authorities||ge.role||"Not found in token",sub:ge.sub||ge.username})}catch{console.log("‚ö†Ô∏è Could not parse token")}const B=localStorage.getItem("studentApiPattern");return B&&console.log("üîç Found saved student API pattern:",B),()=>{console.log("üîç Students component unmounted")}},[s]);const z=[{id:"studentId",label:"ID",sortable:!0},{id:"name",label:"Name",sortable:!0},{id:"grade",label:"Grade",sortable:!0},{id:"email",label:"Email",sortable:!0},{id:"phoneNumber",label:"Phone Number",sortable:!0},{id:"actions",label:"Actions",format:P=>t.jsxs(w,{children:[t.jsx(N,{size:"small",onClick:()=>H(P),children:"Edit"}),t.jsx(N,{size:"small",color:"error",onClick:()=>X(P.id),children:"Delete"})]})}],pe=async()=>{try{console.log("üîÑ Loading students..."),a(!0),l(null),v(null),console.log("üîë Current user role:",s==null?void 0:s.role),console.log("üîí Auth token present:",!!localStorage.getItem("token"));let P;I?(console.log("üìä Using mock student data"),P=Z.getMockStudents(),e({type:"info",message:"Using mock student data (real API is disabled)"})):P=await Z.getAll(),console.log("‚úÖ Students loaded successfully:",P.data),n(P.data)}catch(P){console.error("‚ùå Error loading students:",P),l("Failed to load students. Please try again or use mock data."),v(P),e({type:"error",message:"Failed to load students. Please try again or enable mock data."})}finally{a(!1)}};g.useEffect(()=>{pe()},[I]);const M=()=>{u(void 0),A("add"),d(!0)},H=P=>{u(P),A("edit"),d(!0)},X=async P=>{if(window.confirm("Are you sure you want to delete this student?"))try{I?(n(r.filter(B=>B.id!==P)),e({type:"success",message:"Student deleted successfully (mock)"})):(await Z.delete(P),await pe(),e({type:"success",message:"Student deleted successfully"}))}catch(B){console.error("Error deleting student:",B),v(B),e({type:"error",message:"Failed to delete student. Please try again."})}},ee=async P=>{try{if(I){if(j==="add"){const B={...P,id:Math.floor(Math.random()*1e4),studentId:`S${Math.floor(Math.random()*1e4).toString().padStart(4,"0")}`};n([...r,B]),e({type:"success",message:"Student added successfully (mock)"})}else n(r.map(B=>B.id===c.id?{...P,id:c.id}:B)),e({type:"success",message:"Student updated successfully (mock)"});d(!1);return}j==="add"?(await Z.create(P),e({type:"success",message:"Student added successfully"})):(await Z.update(c.id,P),e({type:"success",message:"Student updated successfully"})),await pe(),d(!1)}catch(B){throw console.error("Error saving student:",B),v(B),e({type:"error",message:"Failed to save student. Please try again."}),B}},Re=async()=>{y(!0),D([]);try{const P=await Z.runEndpointTests();D(P);const B=P.filter(ge=>ge.success);B.length>0?e({type:"success",message:`Found ${B.length} working endpoint(s). Using ${B[0].endpoint}.`}):e({type:"warning",message:"No working endpoints found. Consider using mock data."})}catch(P){console.error("Error running API tests:",P),e({type:"error",message:"Error running API tests"})}y(!1)},Lt=async()=>{if(E){y(!0);try{const P=await F.get(E);_({success:!0,status:P.status,data:P.data}),localStorage.setItem("studentApiPattern",E),e({type:"success",message:`Endpoint ${E} works! Saved as default.`})}catch(P){_({success:!1,status:P.status||P.response&&P.response.status||"Error",message:P.message}),e({type:"error",message:`Endpoint ${E} failed.`})}y(!1)}},Yr=()=>t.jsxs(ze,{open:f,onClose:()=>x(!1),maxWidth:"md",fullWidth:!0,children:[t.jsx(qe,{children:"Student API Diagnostics"}),t.jsxs(He,{children:[t.jsx(b,{variant:"body2",gutterBottom:!0,children:"This tool helps diagnose issues with connecting to your student API endpoints."}),t.jsxs(w,{sx:{my:3,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[t.jsx(qt,{control:t.jsx(Ht,{checked:I,onChange:P=>U(P.target.checked)}),label:"Use mock data (bypass API)"}),t.jsx(N,{onClick:Re,disabled:p,variant:"contained",color:"primary",children:p?"Testing...":"Test All Endpoints"})]}),t.jsxs(w,{sx:{mt:2},children:[t.jsx(b,{variant:"subtitle2",gutterBottom:!0,children:"Test Custom Endpoint:"}),t.jsxs(w,{sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[t.jsx($,{fullWidth:!0,size:"small",value:E,onChange:P=>O(P.target.value),placeholder:"e.g., /api/custom-students",variant:"outlined"}),t.jsx(N,{onClick:Lt,disabled:!E||p,variant:"outlined",children:"Test"})]}),k&&t.jsxs(W,{variant:"outlined",sx:{p:2,mb:3},children:[t.jsxs(b,{variant:"subtitle2",color:k.success?"success.main":"error.main",children:[k.success?"‚úÖ Success":"‚ùå Failed"," - Status: ",k.status]}),t.jsx(w,{component:"pre",sx:{mt:1,p:1,bgcolor:"grey.100",borderRadius:1,fontSize:"0.75rem",overflow:"auto",maxHeight:150},children:k.success?JSON.stringify(k.data,null,2):k.message})]})]}),p&&t.jsx(w,{sx:{display:"flex",justifyContent:"center",my:4},children:t.jsx(We,{})}),C.length>0&&t.jsxs(t.Fragment,{children:[t.jsx(b,{variant:"h6",gutterBottom:!0,children:"Endpoint Test Results:"}),t.jsx(ve,{children:C.map((P,B)=>t.jsxs(Ae.Fragment,{children:[B>0&&t.jsx($e,{}),t.jsx(we,{children:t.jsx(je,{primary:`${P.endpoint} - ${P.success?"‚úÖ Success":"‚ùå Failed"} (${P.status})`,secondary:t.jsx(w,{component:"pre",sx:{mt:1,p:1,bgcolor:"grey.100",borderRadius:1,fontSize:"0.75rem",overflow:"auto",maxHeight:150},children:P.success?JSON.stringify(P.data,null,2):P.message||"No response data"})})})]},B))})]}),t.jsxs(w,{sx:{mt:4},children:[t.jsx(b,{variant:"h6",gutterBottom:!0,children:"Authentication Information"}),t.jsxs(W,{sx:{p:2},children:[t.jsxs(b,{variant:"body2",children:[t.jsx("strong",{children:"User:"})," ",s?JSON.stringify(s):"Not logged in"]}),t.jsxs(b,{variant:"body2",children:[t.jsx("strong",{children:"Token present:"})," ",localStorage.getItem("token")?"Yes":"No"]}),t.jsxs(b,{variant:"body2",children:[t.jsx("strong",{children:"API URL:"})," ",re.apiUrl]}),t.jsxs(b,{variant:"body2",children:[t.jsx("strong",{children:"Saved endpoint:"})," ",localStorage.getItem("studentApiPattern")||"None"]})]})]})]}),t.jsxs(Ve,{children:[t.jsx(N,{onClick:()=>{localStorage.removeItem("studentApiPattern"),e({type:"info",message:"Cleared saved endpoint pattern"})},color:"warning",children:"Clear Saved Endpoint"}),t.jsx(N,{onClick:()=>x(!1),color:"secondary",children:"Close"})]})]});return o?t.jsx(Ee,{message:"Loading students..."}):t.jsxs(w,{sx:{p:3},children:[t.jsxs(w,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[t.jsx(b,{variant:"h4",children:"Students"}),t.jsxs(w,{children:[t.jsx(N,{variant:"text",color:"secondary",onClick:()=>x(!0),sx:{mr:2},children:"Debug"}),I&&t.jsx(N,{variant:"outlined",color:"warning",onClick:()=>U(!1),sx:{mr:2},children:"Using Mock Data"}),t.jsx(N,{variant:"contained",startIcon:t.jsx(Tt,{}),onClick:M,children:"Add Student"})]})]}),i&&t.jsxs(w,{sx:{mb:4},children:[t.jsx(Ke,{message:i,onRetry:pe}),t.jsxs(W,{elevation:0,variant:"outlined",sx:{p:3,mt:2},children:[t.jsx(Se,{severity:"info",sx:{mb:2},children:"If you're experiencing persistent API errors, you can use mock data instead."}),t.jsx(N,{variant:"contained",color:"secondary",onClick:()=>U(!0),sx:{mr:2},children:"Enable Mock Data"}),t.jsx(N,{variant:"outlined",onClick:()=>x(!0),children:"Run Diagnostics"})]})]}),t.jsx(W,{sx:{mb:4},children:t.jsx(ls,{columns:z,data:r,defaultRowsPerPage:10,rowsPerPageOptions:[5,10,25,50]})}),t.jsx(ga,{open:h,onClose:()=>d(!1),onSave:ee,student:c,mode:j}),Yr()]})},Hs={name:"",email:"",phoneNumber:"",department:"",subject:"",qualification:"",joinDate:""},ya=({open:e,onClose:s,onSave:r,teacher:n,mode:o})=>{const[a,i]=g.useState({...Hs}),[l,h]=g.useState({}),[d,c]=g.useState(!1);g.useEffect(()=>{i(n&&o==="edit"?{...n}:{...Hs}),h({})},[n,e,o]);const u=f=>{const{name:x,value:p}=f.target;i(y=>({...y,[x]:p}))},j=()=>{const f={};return a.name.trim()||(f.name="Name is required"),a.email.trim()?/\S+@\S+\.\S+/.test(a.email)||(f.email="Email is invalid"):f.email="Email is required",a.department.trim()||(f.department="Department is required"),a.subject.trim()||(f.subject="Subject is required"),f},A=async f=>{f.preventDefault(),c(!0);const x=j();if(Object.keys(x).length>0){h(x),c(!1);return}try{await r(a),s()}catch(p){console.error("Error saving teacher:",p),p.validationErrors&&h(p.validationErrors)}finally{c(!1)}};return t.jsxs(ze,{open:e,onClose:s,maxWidth:"sm",fullWidth:!0,children:[t.jsx(qe,{children:o==="add"?"Add New Teacher":"Edit Teacher"}),t.jsx(He,{children:t.jsx("form",{id:"teacher-form",onSubmit:A,children:t.jsxs(S,{container:!0,spacing:2,sx:{mt:1},children:[t.jsx(S,{item:!0,xs:12,children:t.jsx($,{name:"name",label:"Full Name",fullWidth:!0,value:a.name,onChange:u,error:!!l.name,helperText:l.name,required:!0})}),t.jsx(S,{item:!0,xs:12,sm:6,children:t.jsx($,{name:"email",label:"Email",fullWidth:!0,value:a.email,onChange:u,error:!!l.email,helperText:l.email,required:!0})}),t.jsx(S,{item:!0,xs:12,sm:6,children:t.jsx($,{name:"phoneNumber",label:"Phone Number",fullWidth:!0,value:a.phoneNumber,onChange:u,error:!!l.phoneNumber,helperText:l.phoneNumber})}),t.jsx(S,{item:!0,xs:12,sm:6,children:t.jsxs(At,{fullWidth:!0,required:!0,error:!!l.department,children:[t.jsx(Et,{children:"Department"}),t.jsxs(Ct,{name:"department",value:a.department,onChange:u,label:"Department",children:[t.jsx(G,{value:"Mathematics",children:"Mathematics"}),t.jsx(G,{value:"Science",children:"Science"}),t.jsx(G,{value:"English",children:"English"}),t.jsx(G,{value:"History",children:"History"}),t.jsx(G,{value:"Computer Science",children:"Computer Science"}),t.jsx(G,{value:"Physical Education",children:"Physical Education"}),t.jsx(G,{value:"Arts",children:"Arts"}),t.jsx(G,{value:"Music",children:"Music"})]}),l.department&&t.jsx("p",{className:"error-text",children:l.department})]})}),t.jsx(S,{item:!0,xs:12,sm:6,children:t.jsx($,{name:"subject",label:"Subject",fullWidth:!0,value:a.subject,onChange:u,error:!!l.subject,helperText:l.subject,required:!0})}),t.jsx(S,{item:!0,xs:12,sm:6,children:t.jsx($,{name:"qualification",label:"Qualification",fullWidth:!0,value:a.qualification,onChange:u,error:!!l.qualification,helperText:l.qualification})}),t.jsx(S,{item:!0,xs:12,sm:6,children:t.jsx($,{name:"joinDate",label:"Join Date",type:"date",fullWidth:!0,value:a.joinDate,onChange:u,InputLabelProps:{shrink:!0},error:!!l.joinDate,helperText:l.joinDate})})]})})}),t.jsxs(Ve,{children:[t.jsx(N,{onClick:s,color:"primary",children:"Cancel"}),t.jsx(N,{type:"submit",color:"primary",form:"teacher-form",variant:"contained",disabled:d,children:d?"Saving...":"Save"})]})]})},ja=()=>{const{showNotification:e}=ne(),[s,r]=g.useState([]),[n,o]=g.useState(!0),[a,i]=g.useState(null),[l,h]=g.useState(!1),[d,c]=g.useState(),[u,j]=g.useState("add"),A=[{id:"id",label:"ID",sortable:!0},{id:"name",label:"Name",sortable:!0},{id:"department",label:"Department",sortable:!0},{id:"subject",label:"Subject",sortable:!0},{id:"email",label:"Email",sortable:!0},{id:"phoneNumber",label:"Phone Number",sortable:!0},{id:"actions",label:"Actions",format:D=>t.jsxs(w,{children:[t.jsx(N,{size:"small",onClick:()=>p(D),children:"Edit"}),t.jsx(N,{size:"small",color:"error",onClick:()=>y(D.id),children:"Delete"})]})}],f=async()=>{try{o(!0),i(null);const D=await Ue.getAll();r(D.data)}catch(D){console.error("Error loading teachers:",D),i("Failed to load teachers. Please try again."),e({type:"error",message:"Failed to load teachers. Please try again."})}finally{o(!1)}};g.useEffect(()=>{f()},[]);const x=()=>{c(void 0),j("add"),h(!0)},p=D=>{c(D),j("edit"),h(!0)},y=async D=>{if(window.confirm("Are you sure you want to delete this teacher?"))try{await Ue.delete(D),await f(),e({type:"success",message:"Teacher deleted successfully"})}catch(R){console.error("Error deleting teacher:",R),e({type:"error",message:"Failed to delete teacher. Please try again."})}},C=async D=>{try{u==="add"?(await Ue.create(D),e({type:"success",message:"Teacher added successfully"})):(await Ue.update(d.id,D),e({type:"success",message:"Teacher updated successfully"})),await f(),h(!1)}catch(R){throw console.error("Error saving teacher:",R),e({type:"error",message:"Failed to save teacher. Please try again."}),R}};return n?t.jsx(Ee,{message:"Loading teachers..."}):a?t.jsx(Ke,{message:a,onRetry:f}):t.jsxs(w,{children:[t.jsxs(w,{sx:{display:"flex",justifyContent:"space-between",mb:4},children:[t.jsx(b,{variant:"h4",children:"Teachers"}),t.jsx(N,{variant:"contained",startIcon:t.jsx(Tt,{}),onClick:x,children:"Add Teacher"})]}),t.jsx(ls,{columns:A,data:s,defaultRowsPerPage:10,rowsPerPageOptions:[5,10,25,50]}),t.jsx(ya,{open:l,onClose:()=>h(!1),onSave:C,teacher:d,mode:u})]})},Vs=e=>!isNaN(e)&&e>0,ba=e=>{const s={};return(!e.name||e.name.length<3)&&(s.name="Course name must be at least 3 characters"),e.department||(s.department="Department is required"),e.teacher||(s.teacher="Teacher is required"),Vs(e.credits)||(s.credits="Credits must be a positive number"),Vs(e.capacity)||(s.capacity="Capacity must be a positive number"),e.enrolled>e.capacity&&(s.enrolled="Enrolled students cannot exceed capacity"),s},Gs={name:"",department:"",teacher:"",credits:0,capacity:0,enrolled:0},Sa=({open:e,onClose:s,onSave:r,course:n,mode:o})=>{const[a,i]=g.useState(Gs),[l,h]=g.useState({}),[d,c]=g.useState(!1);g.useEffect(()=>{i(n&&o==="edit"?n:Gs),h({})},[n,o,e]);const u=A=>f=>{const x=["credits","capacity","enrolled"].includes(A)?parseInt(f.target.value)||0:f.target.value;i(p=>({...p,[A]:x})),l[A]&&h(p=>({...p,[A]:""}))},j=async()=>{const A=ba(a);if(Object.keys(A).length>0){h(A);return}try{c(!0),await r(a),s()}catch(f){console.error("Error saving course:",f)}finally{c(!1)}};return t.jsxs(ze,{open:e,onClose:s,maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{minHeight:"400px"}},children:[t.jsx(qe,{children:o==="add"?"Add New Course":"Edit Course"}),t.jsx(He,{children:t.jsxs(S,{container:!0,spacing:2,sx:{mt:1},children:[t.jsx(S,{item:!0,xs:12,children:t.jsx($,{fullWidth:!0,label:"Course Name",value:a.name,onChange:u("name"),error:!!l.name,helperText:l.name,required:!0,autoFocus:!0})}),t.jsx(S,{item:!0,xs:12,children:t.jsx($,{fullWidth:!0,label:"Department",value:a.department,onChange:u("department"),error:!!l.department,helperText:l.department,required:!0})}),t.jsx(S,{item:!0,xs:12,children:t.jsx($,{fullWidth:!0,label:"Teacher",value:a.teacher,onChange:u("teacher"),error:!!l.teacher,helperText:l.teacher,required:!0})}),t.jsx(S,{item:!0,xs:6,children:t.jsx($,{fullWidth:!0,label:"Credits",type:"number",value:a.credits,onChange:u("credits"),error:!!l.credits,helperText:l.credits,required:!0,inputProps:{min:0}})}),t.jsx(S,{item:!0,xs:6,children:t.jsx($,{fullWidth:!0,label:"Capacity",type:"number",value:a.capacity,onChange:u("capacity"),error:!!l.capacity,helperText:l.capacity,required:!0,inputProps:{min:0}})}),o==="edit"&&t.jsx(S,{item:!0,xs:6,children:t.jsx($,{fullWidth:!0,label:"Current Enrollment",type:"number",value:a.enrolled,onChange:u("enrolled"),error:!!l.enrolled,helperText:l.enrolled,inputProps:{min:0,max:a.capacity}})})]})}),t.jsxs(Ve,{children:[t.jsx(N,{onClick:s,disabled:d,children:"Cancel"}),t.jsx(N,{onClick:j,variant:"contained",color:"primary",disabled:d,children:d?"Saving...":o==="add"?"Add":"Save"})]})]})},va=({open:e,onClose:s,onEnroll:r,onUnenroll:n,course:o,enrolledStudents:a,availableStudents:i})=>{const[l,h]=g.useState(""),[d,c]=g.useState(!1);g.useEffect(()=>{h("")},[e]);const u=i.filter(x=>x.name.toLowerCase().includes(l.toLowerCase())||x.grade.toLowerCase().includes(l.toLowerCase())),j=a.filter(x=>x.name.toLowerCase().includes(l.toLowerCase())||x.grade.toLowerCase().includes(l.toLowerCase())),A=async x=>{if(o)try{c(!0),await r(x,o.id)}finally{c(!1)}},f=async x=>{if(o)try{c(!0),await n(x,o.id)}finally{c(!1)}};return t.jsxs(ze,{open:e,onClose:s,maxWidth:"sm",fullWidth:!0,children:[t.jsxs(qe,{children:["Manage Enrollments - ",o==null?void 0:o.name,t.jsx(ts,{label:`${a.length}/${(o==null?void 0:o.capacity)||0}`,color:a.length>=((o==null?void 0:o.capacity)||0)?"error":"success",size:"small",sx:{ml:2}})]}),t.jsxs(He,{children:[t.jsx(w,{sx:{mb:2},children:t.jsx($,{fullWidth:!0,label:"Search Students",value:l,onChange:x=>h(x.target.value),margin:"normal",variant:"outlined",size:"small"})}),t.jsx(w,{children:t.jsx(ve,{children:j.map(x=>t.jsxs(we,{children:[t.jsx(je,{primary:x.name,secondary:`Grade: ${x.grade}`}),t.jsx(As,{children:t.jsx(st,{edge:"end",onClick:()=>f(x.id),disabled:d,children:t.jsx(pn,{})})})]},x.id))})}),o&&a.length<o.capacity&&t.jsxs(w,{sx:{mt:2},children:[t.jsx(b,{variant:"subtitle1",sx:{mb:1},children:"Available Students"}),t.jsx(ve,{children:u.map(x=>t.jsxs(we,{children:[t.jsx(je,{primary:x.name,secondary:`Grade: ${x.grade}`}),t.jsx(As,{children:t.jsx(st,{edge:"end",onClick:()=>A(x.id),disabled:d,children:t.jsx(Tt,{})})})]},x.id))})]})]}),t.jsx(Ve,{children:t.jsx(N,{onClick:s,children:"Close"})})]})},wa=()=>{const{showNotification:e}=ne(),[s,r]=g.useState([]),[n,o]=g.useState(!0),[a,i]=g.useState(null),[l,h]=g.useState(!1),[d,c]=g.useState(),[u,j]=g.useState("add"),[A,f]=g.useState(!1),[x,p]=g.useState(),[y,C]=g.useState([]),[D,R]=g.useState([]),v=async()=>{try{o(!0),i(null);const M=await ye.getAll();r(M.data)}catch(M){console.error("Error loading courses:",M),i("Failed to load courses. Please try again."),e({type:"error",message:"Failed to load courses. Please try again."})}finally{o(!1)}};g.useEffect(()=>{v()},[]);const I=()=>{c(void 0),j("add"),h(!0)},U=M=>{c(M),j("edit"),h(!0)},E=async M=>{if(window.confirm("Are you sure you want to delete this course?"))try{await ye.delete(M),await v(),e({type:"success",message:"Course deleted successfully"})}catch(H){console.error("Error deleting course:",H),e({type:"error",message:"Failed to delete course. Please try again."})}},O=async M=>{try{u==="add"?(await ye.create(M),e({type:"success",message:"Course added successfully"})):(await ye.update(d.id,M),e({type:"success",message:"Course updated successfully"})),await v(),h(!1)}catch(H){throw console.error("Error saving course:",H),e({type:"error",message:"Failed to save course. Please try again."}),H}},k=async M=>{try{p(M);const[H,X]=await Promise.all([Z.getAll(),Z.getAll()]),ee=new Set(Array.from({length:M.enrolled},(Re,Lt)=>Lt));C(H.data.filter(Re=>ee.has(Re.id%H.data.length))),R(H.data.filter(Re=>!ee.has(Re.id%H.data.length))),f(!0)}catch(H){console.error("Error loading students for enrollment:",H),e({type:"error",message:"Failed to load students for enrollment management."})}},_=async(M,H)=>{try{await ye.enrollStudent(H,M);const X=D.find(ee=>ee.id===M);C([...y,X]),R(D.filter(ee=>ee.id!==M)),await v(),e({type:"success",message:"Student enrolled successfully."})}catch(X){console.error("Error enrolling student:",X),e({type:"error",message:"Failed to enroll student. Please try again."})}},z=async(M,H)=>{try{await ye.unenrollStudent(H,M);const X=y.find(ee=>ee.id===M);R([...D,X]),C(y.filter(ee=>ee.id!==M)),await v(),e({type:"success",message:"Student unenrolled successfully."})}catch(X){console.error("Error unenrolling student:",X),e({type:"error",message:"Failed to unenroll student. Please try again."})}},pe=(M,H)=>{const X=M/H;return X>=1?"error":X>=.8?"warning":"success"};return n?t.jsx(Ee,{message:"Loading courses..."}):a?t.jsx(Ke,{message:a,onRetry:v}):t.jsxs(w,{children:[t.jsxs(w,{sx:{display:"flex",justifyContent:"space-between",mb:4},children:[t.jsx(b,{variant:"h4",children:"Courses"}),t.jsx(N,{variant:"contained",startIcon:t.jsx(Tt,{}),onClick:I,children:"Add Course"})]}),t.jsx(ar,{component:W,children:t.jsxs(ir,{children:[t.jsx(lr,{children:t.jsxs(yt,{children:[t.jsx(J,{children:"ID"}),t.jsx(J,{children:"Name"}),t.jsx(J,{children:"Department"}),t.jsx(J,{children:"Teacher"}),t.jsx(J,{children:"Credits"}),t.jsx(J,{children:"Availability"}),t.jsx(J,{children:"Actions"})]})}),t.jsx(cr,{children:s.map(M=>t.jsxs(yt,{children:[t.jsx(J,{children:M.id}),t.jsx(J,{children:M.name}),t.jsx(J,{children:M.department}),t.jsx(J,{children:M.teacher}),t.jsx(J,{children:M.credits}),t.jsx(J,{children:t.jsx(ts,{label:`${M.enrolled}/${M.capacity}`,color:pe(M.enrolled,M.capacity),size:"small"})}),t.jsxs(J,{children:[t.jsx(N,{size:"small",onClick:()=>U(M),children:"Edit"}),t.jsx(N,{size:"small",color:"error",onClick:()=>E(M.id),children:"Delete"}),t.jsx(N,{size:"small",startIcon:t.jsx(et,{}),onClick:()=>k(M),children:"Manage Students"})]})]},M.id))})]})}),t.jsx(Sa,{open:l,onClose:()=>h(!1),onSave:O,course:d,mode:u}),t.jsx(va,{open:A,onClose:()=>f(!1),onEnroll:_,onUnenroll:z,course:x,enrolledStudents:y,availableStudents:D})]})},Fe=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884d8","#82ca9d"],Aa=()=>{const{showNotification:e}=ne(),[s,r]=g.useState(!0),[n,o]=g.useState(null),[a,i]=g.useState("enrollment"),[l,h]=g.useState([]),[d,c]=g.useState([]),[u,j]=g.useState([]),A=async()=>{try{r(!0),o(null);const[R,v,I]=await Promise.all([Z.getAll(),ye.getAll(),Ue.getAll()]),U=v.data.map(k=>({name:k.name,enrolled:k.enrolled,available:k.capacity-k.enrolled,capacity:k.capacity,fill:Fe[Math.floor(Math.random()*Fe.length)]}));c(U);const E=R.data.reduce((k,_)=>{const z=_.grade;return k[z]=(k[z]||0)+1,k},{}),O=Object.keys(E).map(k=>({grade:k,count:E[k],fill:Fe[Math.floor(Math.random()*Fe.length)]}));if(j(O),a==="enrollment")h(U);else if(a==="grades")h(O);else if(a==="teacherLoad"){const k=I.data.map(_=>({name:_.name,courses:Math.floor(Math.random()*5)+1,students:Math.floor(Math.random()*120)+20,fill:Fe[Math.floor(Math.random()*Fe.length)]}));h(k)}}catch(R){console.error("Error loading report data:",R),o("Failed to load report data"),e({type:"error",message:"Failed to load report data. Please try again."})}finally{r(!1)}};g.useEffect(()=>{A()},[]);const f=R=>{const v=R.target.value;if(i(v),v==="enrollment")h(d);else if(v==="grades")h(u);else if(v==="teacherLoad"){const I=l.filter(U=>U.courses);I.length>0?h(I):A()}},x=()=>{e({type:"info",message:"Report download functionality will be implemented soon."})},p=()=>t.jsxs(S,{container:!0,spacing:3,children:[t.jsx(S,{item:!0,xs:12,md:6,children:t.jsxs(oe,{children:[t.jsx(ke,{title:"Course Enrollment"}),t.jsx(ae,{children:t.jsx(Ie,{width:"100%",height:300,children:t.jsxs(Es,{children:[t.jsx(Cs,{data:l,cx:"50%",cy:"50%",labelLine:!1,label:({name:R,percent:v})=>`${R}: ${(v*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"enrolled",children:l.map((R,v)=>t.jsx(Ts,{fill:R.fill},`cell-${v}`))}),t.jsx(Ne,{}),t.jsx(Pe,{})]})})})]})}),t.jsx(S,{item:!0,xs:12,md:6,children:t.jsxs(oe,{children:[t.jsx(ke,{title:"Course Capacity Utilization"}),t.jsx(ae,{children:t.jsx(Ie,{width:"100%",height:300,children:t.jsxs(lt,{data:l,children:[t.jsx(ct,{dataKey:"name"}),t.jsx(dt,{}),t.jsx(Ne,{}),t.jsx(Pe,{}),t.jsx(Ye,{dataKey:"enrolled",name:"Enrolled",stackId:"a",fill:"#8884d8"}),t.jsx(Ye,{dataKey:"available",name:"Available",stackId:"a",fill:"#82ca9d"})]})})})]})})]}),y=()=>t.jsxs(S,{container:!0,spacing:3,children:[t.jsx(S,{item:!0,xs:12,md:6,children:t.jsxs(oe,{children:[t.jsx(ke,{title:"Student Grade Distribution"}),t.jsx(ae,{children:t.jsx(Ie,{width:"100%",height:300,children:t.jsxs(Es,{children:[t.jsx(Cs,{data:l,cx:"50%",cy:"50%",labelLine:!1,label:({grade:R,percent:v})=>`Grade ${R}: ${(v*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"count",children:l.map((R,v)=>t.jsx(Ts,{fill:R.fill},`cell-${v}`))}),t.jsx(Ne,{}),t.jsx(Pe,{})]})})})]})}),t.jsx(S,{item:!0,xs:12,md:6,children:t.jsxs(oe,{children:[t.jsx(ke,{title:"Students per Grade"}),t.jsx(ae,{children:t.jsx(Ie,{width:"100%",height:300,children:t.jsxs(lt,{data:l,children:[t.jsx(ct,{dataKey:"grade"}),t.jsx(dt,{}),t.jsx(Ne,{}),t.jsx(Pe,{}),t.jsx(Ye,{dataKey:"count",name:"Number of Students",fill:"#8884d8"})]})})})]})})]}),C=()=>t.jsxs(S,{container:!0,spacing:3,children:[t.jsx(S,{item:!0,xs:12,md:6,children:t.jsxs(oe,{children:[t.jsx(ke,{title:"Teacher Course Load"}),t.jsx(ae,{children:t.jsx(Ie,{width:"100%",height:300,children:t.jsxs(lt,{data:l,children:[t.jsx(ct,{dataKey:"name"}),t.jsx(dt,{}),t.jsx(Ne,{}),t.jsx(Pe,{}),t.jsx(Ye,{dataKey:"courses",name:"Number of Courses",fill:"#8884d8"})]})})})]})}),t.jsx(S,{item:!0,xs:12,md:6,children:t.jsxs(oe,{children:[t.jsx(ke,{title:"Teacher Student Load"}),t.jsx(ae,{children:t.jsx(Ie,{width:"100%",height:300,children:t.jsxs(lt,{data:l,children:[t.jsx(ct,{dataKey:"name"}),t.jsx(dt,{}),t.jsx(Ne,{}),t.jsx(Pe,{}),t.jsx(Ye,{dataKey:"students",name:"Number of Students",fill:"#82ca9d"})]})})})]})})]}),D=()=>{switch(a){case"enrollment":return p();case"grades":return y();case"teacherLoad":return C();default:return p()}};return s?t.jsx(Ee,{message:"Loading report data..."}):n?t.jsx(Ke,{message:n,onRetry:A}):t.jsxs(w,{children:[t.jsx(b,{variant:"h4",sx:{mb:4},children:"Reports & Analytics"}),t.jsx(W,{sx:{p:2,mb:4},children:t.jsxs(S,{container:!0,spacing:2,alignItems:"center",children:[t.jsx(S,{item:!0,xs:12,md:6,children:t.jsxs(At,{fullWidth:!0,children:[t.jsx(Et,{id:"report-type-label",children:"Report Type"}),t.jsxs(Ct,{labelId:"report-type-label",id:"report-type",value:a,label:"Report Type",onChange:f,children:[t.jsx(G,{value:"enrollment",children:"Course Enrollment"}),t.jsx(G,{value:"grades",children:"Grade Distribution"}),t.jsx(G,{value:"teacherLoad",children:"Teacher Load"})]})]})}),t.jsx(S,{item:!0,xs:12,md:6,sx:{display:"flex",justifyContent:{md:"flex-end"}},children:t.jsx(N,{variant:"contained",onClick:x,children:"Download Report"})})]})}),D()]})};async function Ea(e){let s=null;for(const r of e)try{console.log("üîç Trying endpoint:",r.name||"anonymous");const n=await r();return console.log("‚úÖ Endpoint succeeded:",r.name||"anonymous"),n}catch(n){console.warn("‚ö†Ô∏è Endpoint failed:",r.name||"anonymous",n),s=n}throw s}const Js={getAllApplications:async()=>(console.log("‚öôÔ∏è Calling admissionService.getAllApplications() with multiple fallbacks"),Ea([()=>F.get("/admission"),()=>F.get("/api/admission"),()=>F.get("/admissions"),()=>F.get("/api/admissions"),()=>F.get("/api/v1/admission"),()=>F.get("/admin/admission")])),createApplication:e=>F.post("/admission",e),updateApplication:(e,s)=>F.put(`/admission/${e}`,s),submitApplication:e=>F.post("/admission/submit",e),updateStatus:(e,s)=>F.put(`/admission/${e}/status`,{status:s}),getByStatus:e=>F.get(`/admission/status/${e}`),searchApplications:e=>F.get(`/admission/search?query=${e}`),getByDateRange:(e,s)=>F.get(`/admission/date-range?startDate=${e}&endDate=${s}`),getByGrade:e=>F.get(`/admission/grade/${e}`),getDebugInfo:async()=>{const e=localStorage.getItem("user"),s=localStorage.getItem("token");let r=null,n=null;try{if(e&&(r=JSON.parse(e)),s){const o=s.split(".");if(o.length===3){const a=JSON.parse(atob(o[1]));n={exp:new Date(a.exp*1e3).toLocaleString(),roles:a.roles||a.authorities||a.role||"Not found in token",sub:a.sub||a.username}}}}catch(o){console.error("Error parsing user/token data",o)}return{user:r,token:s?`${s.substring(0,20)}...`:null,tokenInfo:n,endpoints:{getAllApplications:"/admission (with fallbacks)",createApplication:"/admission",updateApplication:"/admission/:id"}}}},T={ADMIN:"ADMIN",TEACHER:"TEACHER",STAFF:"STAFF",PARENT:"PARENT",STUDENT:"STUDENT"},Ca={CREATE_STUDENT:[T.ADMIN,T.STAFF],EDIT_STUDENT:[T.ADMIN,T.STAFF],DELETE_STUDENT:[T.ADMIN],VIEW_STUDENT:[T.ADMIN,T.TEACHER,T.STAFF,T.PARENT,T.STUDENT],CREATE_TEACHER:[T.ADMIN],EDIT_TEACHER:[T.ADMIN],DELETE_TEACHER:[T.ADMIN],VIEW_TEACHER:[T.ADMIN,T.STAFF,T.STUDENT],CREATE_COURSE:[T.ADMIN,T.STAFF],EDIT_COURSE:[T.ADMIN,T.STAFF],DELETE_COURSE:[T.ADMIN],VIEW_COURSE:[T.ADMIN,T.TEACHER,T.STAFF,T.STUDENT],MANAGE_ATTENDANCE:[T.ADMIN,T.TEACHER],VIEW_ATTENDANCE:[T.ADMIN,T.TEACHER,T.STAFF,T.PARENT,T.STUDENT],MANAGE_EXAMS:[T.ADMIN,T.TEACHER],VIEW_EXAM_RESULTS:[T.ADMIN,T.TEACHER,T.STAFF,T.PARENT,T.STUDENT],MANAGE_FEES:[T.ADMIN,T.STAFF],VIEW_FEES:[T.ADMIN,T.STAFF,T.PARENT,T.STUDENT],MANAGE_ADMISSIONS:[T.ADMIN,T.STAFF],VIEW_ADMISSIONS:[T.ADMIN,T.STAFF],SEND_MESSAGE:[T.ADMIN,T.TEACHER,T.STAFF],VIEW_MESSAGE:[T.ADMIN,T.TEACHER,T.STAFF,T.PARENT,T.STUDENT],VIEW_ADMIN_DASHBOARD:[T.ADMIN,T.STAFF],VIEW_TEACHER_DASHBOARD:[T.TEACHER],VIEW_STUDENT_DASHBOARD:[T.STUDENT],VIEW_PARENT_DASHBOARD:[T.PARENT]},wt=(e,s)=>!e||!s?!1:Ca[s].includes(e),Ks=(e,s)=>s.some(r=>wt(e,r)),Ys=(e,s)=>s.every(r=>wt(e,r)),Xs=({children:e,permission:s,permissions:r=[],requireAll:n=!1})=>{const{user:o}=be();if(g.useEffect(()=>{s&&console.log(`üîí Checking permission "${s}" for user role: "${(o==null?void 0:o.role)||"unknown"}"`,{hasPermission:o?wt(o.role,s):!1}),r.length>0&&console.log(`üîí Checking permissions [${r.join(", ")}] for user role: "${(o==null?void 0:o.role)||"unknown"}"`,{requireAll:n,hasPermissions:o?n?Ys(o.role,r):Ks(o.role,r):!1})},[o,s,r,n]),!o)return console.warn("‚ö†Ô∏è Permission check failed: No user data available"),null;if(s){const a=wt(o.role,s);if(console.log(`üîë Permission "${s}" check result: ${a?"granted ‚úÖ":"denied ‚ùå"}`),!a)return null}if(r.length>0){const a=n?Ys(o.role,r):Ks(o.role,r);if(console.log(`üîë Permissions [${r.join(", ")}] check result: ${a?"granted ‚úÖ":"denied ‚ùå"}`),!a)return null}return t.jsx(t.Fragment,{children:e})},Ta=e=>{var s;if(e.isAxiosError){const r=e;if(!r.response)return"Network error. Please check your connection.";const n=r.response.status,o=(s=r.response.data)==null?void 0:s.message;switch(n){case 400:return o||"Invalid request. Please check your input.";case 401:return"Authentication required. Please log in.";case 403:return"You do not have permission to perform this action.";case 404:return o||"Resource not found.";case 409:return o||"Conflict with existing data.";case 422:return o||"Invalid input data.";case 500:return"Internal server error. Please try again later.";default:return o||"An unexpected error occurred."}}return e instanceof Error?e.message:"An unexpected error occurred."},Bt=new Map,Da=5*60*1e3;function Ra(e,s={}){const[r,n]=g.useState(null),[o,a]=g.useState(!0),[i,l]=g.useState(null),{showNotification:h}=ne(),{cacheKey:d,cacheDuration:c=Da,onSuccess:u,onError:j,showErrorNotification:A=!0}=s,f=async(y=!1)=>{if(d&&!y){const C=Bt.get(d);if(C&&Date.now()-C.timestamp<c){n(C.data),a(!1);return}}try{a(!0),l(null);const C=await e();n(C.data),d&&Bt.set(d,{data:C.data,timestamp:Date.now()}),u==null||u(C.data)}catch(C){const D=Ta(C);l(D),j==null||j(C),A&&h({type:"error",message:D})}finally{a(!1)}};return g.useEffect(()=>{f()},[]),{data:r,loading:o,error:i,refresh:()=>f(!0),clearCache:()=>d&&Bt.delete(d)}}const ka=e=>new Date(e).toLocaleDateString(),Ia=e=>{let s="";switch(e.toUpperCase()){case"APPROVED":s="success.main";break;case"REJECTED":s="error.main";break;default:s="warning.main"}return t.jsx(b,{variant:"body2",color:s,children:e})},Na=(e,s,r)=>({id:"actions",label:"Actions",sortable:!1,align:"right",format:n=>t.jsxs(w,{sx:{display:"flex",justifyContent:"flex-end"},children:[e&&t.jsx(N,{size:"small",onClick:()=>e(n),sx:{mr:1},children:"Edit"}),s&&t.jsx(N,{size:"small",color:"error",onClick:()=>s(n),children:"Delete"}),r&&r(n)]})}),Pa=()=>{const{user:e}=be();ne();const[s,r]=g.useState(null),[n,o]=g.useState(!1),[a,i]=g.useState(!1),[l,h]=g.useState(!1),[d,c]=g.useState([]),[u,j]=g.useState(null);g.useEffect(()=>{console.log("üîç Admissions component mounted"),console.log("üë§ User:",e);const I=localStorage.getItem("token");if(I)try{const U=JSON.parse(atob(I.split(".")[1]));console.log("üîë Token payload:",{exp:new Date(U.exp*1e3).toLocaleString(),roles:U.roles||U.authorities||U.role||"Not found in token",sub:U.sub||U.username})}catch{console.log("‚ö†Ô∏è Could not parse token")}return Js.getDebugInfo().then(U=>{console.log("üìù API connection info:",U)}),()=>{console.log("üîç Admissions component unmounted")}},[e]);const{data:A,loading:f,error:x,refresh:p}=Ra(()=>(console.log("üîÑ Calling admissionService.getAllApplications() with multiple fallbacks"),console.log("üîë Current user role:",e==null?void 0:e.role),console.log("üîí Auth token present:",!!localStorage.getItem("token")),Js.getAllApplications()),[]),y=()=>{r({studentName:"",dateOfBirth:"",gradeApplying:"",parentName:"",contactNumber:"",email:"",address:"",status:"PENDING"}),o(!0)},C=I=>{r(I),o(!0)},D=async()=>{var E;h(!0),c([]);const I=[{name:"Get all admissions (singular)",fn:()=>O=>O.get("/admission")},{name:"Get all admissions (plural)",fn:()=>O=>O.get("/admissions")},{name:"Get all admissions (with API prefix)",fn:()=>O=>O.get("/api/admission")},{name:"Get all admissions (with API prefix, plural)",fn:()=>O=>O.get("/api/admissions")},{name:"Get all admissions (with v1 prefix)",fn:()=>O=>O.get("/api/v1/admission")}],U=[];for(const O of I)try{console.log(`üß™ Testing endpoint: ${O.name}`);const k=await O.fn()(F);U.push({name:O.name,success:!0,status:k.status,data:k.data})}catch(k){U.push({name:O.name,success:!1,status:k.status||((E=k.response)==null?void 0:E.status)||"Error",error:k.message||JSON.stringify(k)})}c(U),h(!1)},R=[{id:"id",label:"ID",sortable:!0},{id:"studentName",label:"Student Name",sortable:!0},{id:"gradeApplying",label:"Grade",sortable:!0},{id:"parentName",label:"Parent Name",sortable:!0},{id:"submissionDate",label:"Submitted On",sortable:!0,format:ka},{id:"status",label:"Status",sortable:!0,format:Ia},Na(I=>C(I),void 0,I=>t.jsx(Xs,{permission:"MANAGE_ADMISSIONS",children:t.jsx(N,{size:"small",variant:"outlined",color:"secondary",onClick:()=>{},children:"Process"})}))],v=()=>t.jsxs(ze,{open:a,onClose:()=>i(!1),maxWidth:"md",fullWidth:!0,children:[t.jsx(qe,{children:"API Endpoint Diagnostics"}),t.jsxs(He,{children:[t.jsx(b,{variant:"body2",gutterBottom:!0,children:"Testing different API endpoints to find which one works with your backend."}),l&&t.jsx(w,{sx:{display:"flex",justifyContent:"center",my:4},children:t.jsx(We,{})}),d.length>0&&t.jsx(ve,{children:d.map((I,U)=>t.jsxs(Ae.Fragment,{children:[U>0&&t.jsx($e,{}),t.jsx(we,{children:t.jsx(je,{primary:`${I.name} - ${I.success?"‚úÖ Success":"‚ùå Failed"} (${I.status})`,secondary:t.jsx(w,{component:"pre",sx:{mt:1,p:1,bgcolor:"grey.100",borderRadius:1,fontSize:"0.75rem",overflow:"auto",maxHeight:200},children:I.success?JSON.stringify(I.data,null,2):I.error?`Error: ${I.error}`:"No response data"})})})]},U))}),t.jsxs(w,{sx:{mt:3},children:[t.jsx(b,{variant:"h6",gutterBottom:!0,children:"Authentication Information"}),t.jsxs(W,{sx:{p:2},children:[t.jsxs(b,{variant:"body2",children:[t.jsx("strong",{children:"User:"})," ",e?JSON.stringify(e):"Not logged in"]}),t.jsxs(b,{variant:"body2",children:[t.jsx("strong",{children:"Token present:"})," ",localStorage.getItem("token")?"Yes":"No"]}),t.jsxs(b,{variant:"body2",children:[t.jsx("strong",{children:"API URL:"})," ",re.apiUrl]})]})]})]}),t.jsxs(Ve,{children:[t.jsx(N,{onClick:D,disabled:l,color:"primary",children:"Run API Tests"}),t.jsx(N,{onClick:()=>i(!1),color:"secondary",children:"Close"})]})]});return f?t.jsx(Ee,{}):x?t.jsxs(w,{sx:{p:3},children:[t.jsx(Ke,{title:"Error Loading Admissions",message:x.message||"Couldn't load admissions data"}),t.jsxs(w,{sx:{mt:3,display:"flex",gap:2},children:[t.jsx(N,{variant:"contained",onClick:p,children:"Try Again"}),t.jsx(N,{variant:"outlined",color:"secondary",onClick:()=>i(!0),children:"Diagnostics"})]}),u&&t.jsxs(W,{elevation:0,variant:"outlined",sx:{p:3,mt:4},children:[t.jsxs(Se,{severity:"error",sx:{mb:2},children:[t.jsxs(nr,{children:["HTTP Status: ",u.status||"Unknown"]}),u.message]}),t.jsx(b,{variant:"subtitle1",children:"Debug Information:"}),t.jsx(w,{component:"pre",sx:{p:2,bgcolor:"grey.100",borderRadius:1,overflowX:"auto"},children:JSON.stringify(u.originalError||u,null,2)}),t.jsxs(w,{sx:{mt:2},children:[t.jsx(b,{variant:"subtitle2",gutterBottom:!0,children:"Possible Solutions:"}),t.jsxs("ul",{children:[t.jsx("li",{children:"Verify the API endpoint path is correct"}),t.jsx("li",{children:"Check that your user account has permission to access admissions"}),t.jsx("li",{children:"Ensure your authentication token is valid and not expired"}),t.jsx("li",{children:"Verify the backend server is running and accessible"})]})]})]}),v()]}):t.jsxs(w,{sx:{p:3},children:[t.jsxs(w,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[t.jsx(b,{variant:"h4",component:"h1",children:"Admission Applications"}),t.jsxs(w,{children:[t.jsx(N,{variant:"text",color:"secondary",onClick:()=>i(!0),sx:{mr:2},children:"Debug"}),t.jsx(Xs,{permission:"MANAGE_ADMISSIONS",children:t.jsx(N,{variant:"contained",onClick:y,children:"New Application"})})]})]}),t.jsx(ls,{columns:R,data:A||[],pagination:!0}),v()]})},Oa=()=>{const{login:e}=be(),[s,r]=g.useState(""),[n,o]=g.useState(""),[a,i]=g.useState(!1),[l,h]=g.useState(null),[d,c]=g.useState(null),[u,j]=g.useState(!1),[A,f]=g.useState(!1),[x,p]=g.useState(null);g.useEffect(()=>{try{console.log("üîç Login component mounted"),console.log("‚öôÔ∏è API URL from environment config:",{}.VITE_API_URL||"https://api.schoolms.com")}catch(R){console.error("Error in debug collection:",R)}},[]);const y=async R=>{R.preventDefault(),h(null),c(null),p(null);try{if(i(!0),console.log(`üîê Attempting login with username: ${s}`),u){console.log("üß™ Debug mode: Making direct API call instead of using auth context");try{const v=await vt.login({username:s,password:n});console.log("‚úÖ Direct login API call successful:",v),p("Direct API call successful! Proceeding with normal login flow...")}catch(v){throw console.error("‚ùå Direct login API call failed:",v),c(v),p(`Direct API call failed: ${v.message||JSON.stringify(v)}`),v}}await e(s,n),console.log("‚úÖ Login successful through auth context")}catch(v){console.error("‚ùå Login error:",v),h(v.message||"Login failed. Please try again."),c(v)}finally{i(!1)}},C=async()=>{try{i(!0),p(null);const R={}.VITE_API_URL||"https://api.schoolms.com";console.log(`üß™ Testing server connection to ${R}/health`);const v=await fetch(`${R}/health`,{method:"GET"});if(v.ok){const I=`Server connection successful: ${await v.text()}`;p(I),console.log("‚úÖ",I)}else{const I=`Server returned status: ${v.status} ${v.statusText}`;p(I),console.warn("‚ö†Ô∏è",I)}}catch(R){const v=`Server connection failed: ${R.message}`;p(v),console.error("‚ùå",v)}finally{i(!1)}},D=async()=>{if(!s||!n){p("Please enter username and password before testing");return}i(!0),h(null),c(null),p("Testing login with /api/auth/login endpoint...");try{const R={}.VITE_API_URL||"https://api.schoolms.com";console.log(`üß™ Testing login with ${R}/api/auth/login`);const v=await vt.login({username:s,password:n});v&&v.data&&(p("Login successful! Received token and user details."),console.log("‚úÖ Test login successful:",v.data))}catch(R){const v=`Login test failed: ${R.message||JSON.stringify(R)}`;p(v),console.error("‚ùå",v),c(R)}finally{i(!1)}};return t.jsx(w,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",bgcolor:"background.default",py:4},children:t.jsx(oe,{sx:{width:"100%",maxWidth:450,boxShadow:3},children:t.jsxs(ae,{sx:{p:4},children:[t.jsx(b,{variant:"h4",component:"h1",gutterBottom:!0,textAlign:"center",children:"Login"}),l&&t.jsx(Se,{severity:"error",sx:{mb:2},children:l}),x&&t.jsx(Se,{severity:"info",sx:{mb:2,whiteSpace:"pre-line"},children:x}),t.jsxs(w,{component:"form",onSubmit:y,noValidate:!0,sx:{mt:1},children:[t.jsx($,{margin:"normal",required:!0,fullWidth:!0,id:"username",label:"Username",name:"username",autoComplete:"username",autoFocus:!0,value:s,onChange:R=>r(R.target.value),disabled:a}),t.jsx($,{margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",value:n,onChange:R=>o(R.target.value),disabled:a}),t.jsx(N,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},disabled:a||!s||!n,children:a?t.jsx(We,{size:24}):"Sign In"}),t.jsx(w,{sx:{mt:2},children:t.jsx(qt,{control:t.jsx(Ht,{checked:A,onChange:()=>f(!A)}),label:"Show debugging tools"})}),t.jsx(or,{in:A,children:t.jsxs(W,{variant:"outlined",sx:{p:2,mt:2},children:[t.jsx(b,{variant:"subtitle2",gutterBottom:!0,children:"Debugging Tools"}),t.jsx(qt,{control:t.jsx(Ht,{checked:u,onChange:()=>j(!u),disabled:a}),label:"Debug mode (direct API calls)"}),t.jsx($e,{sx:{my:2}}),t.jsxs(S,{container:!0,spacing:2,children:[t.jsx(S,{item:!0,xs:6,children:t.jsx(N,{fullWidth:!0,variant:"outlined",disabled:a,onClick:C,children:"Test Server Connection"})}),t.jsx(S,{item:!0,xs:6,children:t.jsx(N,{fullWidth:!0,variant:"outlined",disabled:a||!s||!n,onClick:D,children:"Test Login"})})]}),d&&t.jsxs(w,{sx:{mt:2,overflow:"auto"},children:[t.jsx(b,{variant:"subtitle2",color:"error",children:"Detailed Error:"}),t.jsx(W,{variant:"outlined",sx:{p:1,bgcolor:"grey.100"},children:t.jsx("pre",{style:{margin:0,whiteSpace:"pre-wrap",fontSize:12},children:JSON.stringify(d,null,2)})})]})]})}),t.jsx(w,{sx:{mt:3,textAlign:"center"},children:t.jsx(se,{component:xe,to:"/register",variant:"body2",children:"Don't have an account? Sign Up"})})]})]})})})},Fa=[{value:"ADMIN",label:"ADMIN - Full system administrative access"},{value:"TEACHER",label:"TEACHER - Access to teaching-related functions"},{value:"STUDENT",label:"STUDENT - Access to student-specific features"},{value:"STAFF",label:"STAFF - General staff access"},{value:"PARENT",label:"PARENT - Parent/guardian access"}],La=()=>{const e=at(),{showNotification:s}=ne(),[r,n]=g.useState({username:"",password:"",email:"",role:"",fullName:""}),[o,a]=g.useState(!1),[i,l]=g.useState(null),h=c=>u=>{n(j=>({...j,[c]:u.target.value})),i&&l(null)},d=async c=>{c.preventDefault();try{a(!0),l(null),await vt.register(r),s({type:"success",message:"Registration successful! Please login."}),e("/login")}catch(u){console.error("Registration error:",u);let j="Registration failed. Please try again.";u.message&&typeof u.message=="string"?j=u.message:u.response&&(u.response.data&&u.response.data.message?j=u.response.data.message:u.response.data&&typeof u.response.data=="string"&&(j=u.response.data)),l(j),s({type:"error",message:j})}finally{a(!1)}};return t.jsx(w,{sx:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"background.default"},children:t.jsx(oe,{sx:{maxWidth:400,width:"100%",mx:2},children:t.jsx(ae,{sx:{p:4},children:t.jsxs(w,{component:"form",onSubmit:d,children:[t.jsx(b,{variant:"h4",align:"center",gutterBottom:!0,children:"Create Account"}),t.jsx(b,{variant:"h6",align:"center",color:"textSecondary",sx:{mb:4},children:"Register for a new account"}),i&&t.jsx(Se,{severity:"error",sx:{mb:2},children:i}),t.jsx($,{fullWidth:!0,label:"Full Name",value:r.fullName,onChange:h("fullName"),margin:"normal",required:!0,disabled:o}),t.jsx($,{fullWidth:!0,label:"Username",value:r.username,onChange:h("username"),margin:"normal",required:!0,disabled:o,error:!!i&&i.toLowerCase().includes("username"),helperText:i&&i.toLowerCase().includes("username")?i:""}),t.jsx($,{fullWidth:!0,type:"email",label:"Email",value:r.email,onChange:h("email"),margin:"normal",required:!0,disabled:o,error:!!i&&i.toLowerCase().includes("email"),helperText:i&&i.toLowerCase().includes("email")?i:""}),t.jsx($,{fullWidth:!0,select:!0,label:"Role",value:r.role,onChange:h("role"),margin:"normal",required:!0,disabled:o,children:Fa.map(c=>t.jsx(G,{value:c.value,children:c.label},c.value))}),t.jsx($,{fullWidth:!0,type:"password",label:"Password",value:r.password,onChange:h("password"),margin:"normal",required:!0,disabled:o,error:!!i&&i.toLowerCase().includes("password"),helperText:i&&i.toLowerCase().includes("password")?i:""}),t.jsx(N,{fullWidth:!0,variant:"contained",color:"primary",size:"large",type:"submit",disabled:o,sx:{mt:3},children:o?t.jsx(We,{size:24}):"Register"}),t.jsx(w,{sx:{mt:2,textAlign:"center"},children:t.jsxs(b,{variant:"body2",color:"textSecondary",children:["Already have an account?"," ",t.jsx(se,{component:xe,to:"/login",children:"Sign in"})]})})]})})})})};var cs={},Wt={};const Ma=Tn(gn);var Qs;function de(){return Qs||(Qs=1,function(e){"use client";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"default",{enumerable:!0,get:function(){return s.createSvgIcon}});var s=Ma}(Wt)),Wt}var Ua=le;Object.defineProperty(cs,"__esModule",{value:!0});var Ur=cs.default=void 0,_a=Ua(de()),$a=t;Ur=cs.default=(0,_a.default)((0,$a.jsx)("path",{d:"M5 13.18v4L12 21l7-3.82v-4L12 17zM12 3 1 9l11 6 9-4.91V17h2V9z"}),"School");var ds={},Ba=le;Object.defineProperty(ds,"__esModule",{value:!0});var us=ds.default=void 0,Wa=Ba(de()),za=t;us=ds.default=(0,Wa.default)((0,za.jsx)("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3m-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3m0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5m8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5"}),"People");var hs={},qa=le;Object.defineProperty(hs,"__esModule",{value:!0});var _r=hs.default=void 0,Ha=qa(de()),Zs=t;_r=hs.default=(0,Ha.default)([(0,Zs.jsx)("path",{d:"M21 5c-1.11-.35-2.33-.5-3.5-.5-1.95 0-4.05.4-5.5 1.5-1.45-1.1-3.55-1.5-5.5-1.5S2.45 4.9 1 6v14.65c0 .25.25.5.5.5.1 0 .15-.05.25-.05C3.1 20.45 5.05 20 6.5 20c1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.3 4.75 1.05.1.05.15.05.25.05.25 0 .5-.25.5-.5V6c-.6-.45-1.25-.75-2-1m0 13.5c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V8c1.35-.85 3.8-1.5 5.5-1.5 1.2 0 2.4.15 3.5.5z"},"0"),(0,Zs.jsx)("path",{d:"M17.5 10.5c.88 0 1.73.09 2.5.26V9.24c-.79-.15-1.64-.24-2.5-.24-1.7 0-3.24.29-4.5.83v1.66c1.13-.64 2.7-.99 4.5-.99M13 12.49v1.66c1.13-.64 2.7-.99 4.5-.99.88 0 1.73.09 2.5.26V11.9c-.79-.15-1.64-.24-2.5-.24-1.7 0-3.24.3-4.5.83m4.5 1.84c-1.7 0-3.24.29-4.5.83v1.66c1.13-.64 2.7-.99 4.5-.99.88 0 1.73.09 2.5.26v-1.52c-.79-.16-1.64-.24-2.5-.24"},"1")],"MenuBook");var ms={},Va=le;Object.defineProperty(ms,"__esModule",{value:!0});var $r=ms.default=void 0,Ga=Va(de()),Ja=t;$r=ms.default=(0,Ga.default)((0,Ja.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2M9 17H7v-7h2zm4 0h-2V7h2zm4 0h-2v-4h2z"}),"Assessment");var fs={},Ka=le;Object.defineProperty(fs,"__esModule",{value:!0});var Br=fs.default=void 0,Ya=Ka(de()),Xa=t;Br=fs.default=(0,Ya.default)((0,Xa.jsx)("path",{d:"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m-9-2V7H4v3H1v2h3v3h2v-3h3v-2zm9 4c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"PersonAdd");var ps={},Qa=le;Object.defineProperty(ps,"__esModule",{value:!0});var Wr=ps.default=void 0,Za=Qa(de()),ei=t;Wr=ps.default=(0,Za.default)((0,ei.jsx)("path",{d:"M3 13h8V3H3zm0 8h8v-6H3zm10 0h8V11h-8zm0-18v6h8V3z"}),"Dashboard");var gs={},ti=le;Object.defineProperty(gs,"__esModule",{value:!0});var zr=gs.default=void 0,si=ti(de()),ri=t;zr=gs.default=(0,si.default)((0,ri.jsx)("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore");var xs={},ni=le;Object.defineProperty(xs,"__esModule",{value:!0});var qr=xs.default=void 0,oi=ni(de()),ai=t;qr=xs.default=(0,oi.default)((0,ai.jsx)("path",{d:"M6 17h3l2-4V7H5v6h3zm8 0h3l2-4V7h-6v6h3z"}),"FormatQuote");var ys={},ii=le;Object.defineProperty(ys,"__esModule",{value:!0});var Hr=ys.default=void 0,li=ii(de()),ci=t;Hr=ys.default=(0,li.default)((0,ci.jsx)("path",{d:"M17 10H7v2h10zm2-7h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m0 16H5V8h14zm-5-5H7v2h7z"}),"EventNote");var js={},di=le;Object.defineProperty(js,"__esModule",{value:!0});var Vr=js.default=void 0,ui=di(de()),hi=t;Vr=js.default=(0,ui.default)((0,hi.jsx)("path",{d:"M14.06 9.94 12 9l2.06-.94L15 6l.94 2.06L18 9l-2.06.94L15 12zM4 14l.94-2.06L7 11l-2.06-.94L4 8l-.94 2.06L1 11l2.06.94zm4.5-5 1.09-2.41L12 5.5 9.59 4.41 8.5 2 7.41 4.41 5 5.5l2.41 1.09zm-4 11.5 6-6.01 4 4L23 8.93l-1.41-1.41-7.09 7.97-4-4L3 19z"}),"AutoGraph");var bs={},mi=le;Object.defineProperty(bs,"__esModule",{value:!0});var Gr=bs.default=void 0,fi=mi(de()),pi=t;Gr=bs.default=(0,fi.default)((0,pi.jsx)("path",{d:"M19 5h-2V3H7v2H5c-1.1 0-2 .9-2 2v1c0 2.55 1.92 4.63 4.39 4.94.63 1.5 1.98 2.63 3.61 2.96V19H7v2h10v-2h-4v-3.1c1.63-.33 2.98-1.46 3.61-2.96C19.08 12.63 21 10.55 21 8V7c0-1.1-.9-2-2-2M5 8V7h2v3.82C5.84 10.4 5 9.3 5 8m14 0c0 1.3-.84 2.4-2 2.82V7h2z"}),"EmojiEvents");const gi=[{icon:t.jsx(Wr,{fontSize:"large",color:"primary"}),title:"Interactive Dashboard",description:"Get a comprehensive view of school performance with our intuitive dashboard"},{icon:t.jsx(us,{fontSize:"large",color:"primary"}),title:"Student Management",description:"Manage student profiles, attendance, performance and more in one place"},{icon:t.jsx(Ur,{fontSize:"large",color:"primary"}),title:"Teacher Management",description:"Streamline teacher scheduling, performance tracking, and professional development"},{icon:t.jsx(_r,{fontSize:"large",color:"primary"}),title:"Course Management",description:"Create and manage courses, curriculum planning and resource allocation"},{icon:t.jsx($r,{fontSize:"large",color:"primary"}),title:"Detailed Reports",description:"Generate insightful reports on attendance, grades, and overall performance"},{icon:t.jsx(Br,{fontSize:"large",color:"primary"}),title:"Admissions",description:"Simplify the admission process with online applications and tracking"}],xi=[{name:"Sarah Johnson",position:"Principal, Westfield Academy",image:"/testimonial1.jpg",comment:"Implementing this School Management System has transformed our administrative processes. We've reduced paperwork by 80% and our staff can focus more on what matters - the students.",rating:5},{name:"Michael Chen",position:"IT Director, Riverdale High School",image:"/testimonial2.jpg",comment:"After evaluating several systems, this platform stood out for its intuitive interface and comprehensive feature set. The support team has been exceptional throughout our onboarding.",rating:5},{name:"Dr. Amelia Patel",position:"Superintendent, Springfield District",image:"/testimonial3.jpg",comment:"The analytics and reporting capabilities have given us unprecedented insights into student performance trends. It's helping us make data-driven decisions to improve educational outcomes.",rating:4.5}],yi=[{question:"How easy is it to migrate from our current system?",answer:"Our team provides comprehensive migration support. We have experience integrating with most popular school management systems and can transfer your data seamlessly with minimal disruption to your operations."},{question:"Is the platform secure for handling student data?",answer:"Absolutely. We prioritize data security with end-to-end encryption, regular security audits, and full compliance with educational data protection regulations including FERPA and GDPR."},{question:"Can we customize the platform for our school's specific needs?",answer:"Yes, our system is highly customizable. You can configure user roles, permission sets, and workflows to match your institution's processes. For more specialized needs, our development team can build custom modules."},{question:"What kind of training and support do you provide?",answer:"We offer comprehensive onboarding training for administrators, teachers, and staff. Our support team is available via email, chat, and phone. We also provide an extensive knowledge base with tutorials and best practices."},{question:"Do you offer mobile access for parents and students?",answer:"Yes, our platform is fully mobile-responsive and we offer dedicated mobile apps for both iOS and Android. Parents and students can access grades, attendance, announcements, and more on the go."}],ji=[{icon:t.jsx(Vr,{fontSize:"large",color:"primary"}),value:"95%",label:"Administrative Efficiency Increase"},{icon:t.jsx(us,{fontSize:"large",color:"primary"}),value:"250+",label:"Schools Onboarded"},{icon:t.jsx(Hr,{fontSize:"large",color:"primary"}),value:"68%",label:"Reduction in Paperwork"},{icon:t.jsx(Gr,{fontSize:"large",color:"primary"}),value:"4.8/5",label:"Customer Satisfaction"}],Jr=()=>{const e=xn();yn(e.breakpoints.down("sm"));const[s,r]=g.useState(!1),n=o=>(a,i)=>{r(i?o:!1)};return t.jsxs(w,{sx:{minHeight:"100vh"},children:[t.jsx(W,{sx:{position:"relative",backgroundColor:e.palette.primary.main,color:e.palette.primary.contrastText,pt:8,pb:12},elevation:0,children:t.jsx(Ce,{maxWidth:"lg",children:t.jsxs(S,{container:!0,spacing:4,alignItems:"center",children:[t.jsxs(S,{item:!0,md:7,xs:12,children:[t.jsx(b,{variant:"h1",gutterBottom:!0,sx:{fontWeight:700,fontSize:{xs:"2.5rem",md:"3.5rem"}},children:"Modern School Management System"}),t.jsx(b,{variant:"h5",paragraph:!0,sx:{mb:4,opacity:.9},children:"Streamline educational administration with our comprehensive, user-friendly platform designed for modern schools."}),t.jsxs(jn,{direction:{xs:"column",sm:"row"},spacing:2,children:[t.jsx(N,{component:xe,to:"/login",variant:"contained",size:"large",color:"secondary",sx:{px:4,py:1.5},children:"Sign In"}),t.jsx(N,{component:xe,to:"/register",variant:"outlined",size:"large",sx:{px:4,py:1.5,color:"white",borderColor:"white","&:hover":{borderColor:"white",backgroundColor:"rgba(255,255,255,0.1)"}},children:"Register"})]})]}),t.jsx(S,{item:!0,md:5,xs:12,sx:{display:{xs:"none",md:"block"}},children:t.jsx(w,{component:"img",src:"/school-illustration.svg",alt:"School Management",sx:{width:"100%",maxHeight:400,objectFit:"contain",filter:"drop-shadow(0px 4px 8px rgba(0,0,0,0.2))"}})})]})})}),t.jsxs(Ce,{maxWidth:"lg",sx:{py:8},children:[t.jsx(b,{variant:"h3",align:"center",gutterBottom:!0,sx:{mb:6,fontWeight:700},children:"Transforming Education Administration"}),t.jsx(S,{container:!0,spacing:4,justifyContent:"center",children:ji.map((o,a)=>t.jsx(S,{item:!0,xs:6,md:3,children:t.jsxs(W,{elevation:3,sx:{p:3,textAlign:"center",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",transition:"0.3s","&:hover":{transform:"translateY(-5px)",boxShadow:e.shadows[8]}},children:[t.jsx(w,{sx:{mb:2},children:o.icon}),t.jsx(b,{variant:"h3",component:"div",sx:{fontWeight:"bold",mb:1},children:o.value}),t.jsx(b,{variant:"body1",color:"text.secondary",children:o.label})]})},a))})]}),t.jsxs(Ce,{maxWidth:"lg",sx:{py:8},children:[t.jsx(b,{variant:"h3",align:"center",gutterBottom:!0,sx:{mb:6,fontWeight:700},children:"Features that Transform Education Management"}),t.jsx(S,{container:!0,spacing:4,children:gi.map((o,a)=>t.jsx(S,{item:!0,xs:12,sm:6,md:4,children:t.jsx(oe,{sx:{height:"100%",display:"flex",flexDirection:"column",transition:"0.3s","&:hover":{transform:"translateY(-5px)",boxShadow:e.shadows[10]}},elevation:2,children:t.jsxs(ae,{sx:{flexGrow:1,textAlign:"center",p:3},children:[t.jsx(w,{sx:{mb:2},children:o.icon}),t.jsx(b,{variant:"h5",component:"h2",gutterBottom:!0,fontWeight:"bold",children:o.title}),t.jsx(b,{variant:"body1",color:"text.secondary",children:o.description})]})})},a))})]}),t.jsx(w,{sx:{py:8,bgcolor:"background.default"},children:t.jsxs(Ce,{maxWidth:"lg",children:[t.jsx(b,{variant:"h3",align:"center",gutterBottom:!0,sx:{mb:6,fontWeight:700},children:"Trusted by Educational Leaders"}),t.jsx(S,{container:!0,spacing:4,children:xi.map((o,a)=>t.jsx(S,{item:!0,xs:12,md:4,children:t.jsxs(oe,{elevation:3,sx:{height:"100%",display:"flex",flexDirection:"column",position:"relative",pt:6,pb:3,px:3},children:[t.jsx(w,{sx:{position:"absolute",top:-20,left:"calc(50% - 25px)",width:50,height:50,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",bgcolor:e.palette.primary.main,color:"white"},children:t.jsx(qr,{})}),t.jsxs(ae,{sx:{textAlign:"center",flexGrow:1},children:[t.jsxs(b,{variant:"body1",sx:{mb:3,fontStyle:"italic"},children:['"',o.comment,'"']}),t.jsxs(w,{sx:{mt:"auto"},children:[t.jsx(sr,{src:o.image,alt:o.name,sx:{width:60,height:60,mx:"auto",mb:1}}),t.jsx(b,{variant:"h6",component:"div",fontWeight:"bold",children:o.name}),t.jsx(b,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:o.position}),t.jsx(bn,{value:o.rating,precision:.5,readOnly:!0,sx:{mt:1}})]})]})]})},a))})]})}),t.jsxs(Ce,{maxWidth:"md",sx:{py:8},children:[t.jsx(b,{variant:"h3",align:"center",gutterBottom:!0,sx:{mb:6,fontWeight:700},children:"Frequently Asked Questions"}),t.jsx(W,{elevation:2,sx:{p:{xs:2,md:4},borderRadius:2},children:yi.map((o,a)=>t.jsxs(Sn,{expanded:s===`panel${a}`,onChange:n(`panel${a}`),disableGutters:!0,elevation:0,sx:{border:0,"&:not(:last-child)":{borderBottom:1,borderColor:"divider"},"&:before":{display:"none"}},children:[t.jsx(vn,{expandIcon:t.jsx(zr,{}),"aria-controls":`panel${a}-content`,id:`panel${a}-header`,sx:{py:2},children:t.jsx(b,{variant:"h6",fontWeight:"medium",children:o.question})}),t.jsx(wn,{children:t.jsx(b,{variant:"body1",color:"text.secondary",children:o.answer})})]},a))})]}),t.jsx(w,{sx:{py:8,bgcolor:"background.default"},children:t.jsx(Ce,{maxWidth:"md",children:t.jsxs(W,{elevation:4,sx:{p:{xs:4,md:6},textAlign:"center",borderRadius:4,backgroundColor:e.palette.background.paper,backgroundImage:"linear-gradient(rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.9))"},children:[t.jsx(b,{variant:"h4",gutterBottom:!0,fontWeight:"bold",children:"Ready to Transform Your School's Administration?"}),t.jsx(b,{variant:"body1",paragraph:!0,sx:{mb:4,maxWidth:"80%",mx:"auto"},children:"Join thousands of educational institutions that have streamlined their operations with our comprehensive School Management System."}),t.jsx(N,{component:xe,to:"/register",variant:"contained",color:"primary",size:"large",sx:{px:5,py:1.5},children:"Get Started Today"})]})})}),t.jsx(w,{component:"footer",sx:{py:6,bgcolor:"background.paper",borderTop:`1px solid ${e.palette.divider}`},children:t.jsx(Ce,{maxWidth:"lg",children:t.jsxs(S,{container:!0,spacing:4,justifyContent:"space-between",children:[t.jsxs(S,{item:!0,xs:12,sm:6,md:3,children:[t.jsx(b,{variant:"h6",color:"text.primary",gutterBottom:!0,children:"School MS"}),t.jsx(b,{variant:"body2",color:"text.secondary",children:"Simplifying education management for a better learning experience."}),t.jsx(w,{sx:{mt:2},children:t.jsxs(b,{variant:"body2",color:"text.secondary",children:["¬© ",new Date().getFullYear()," School Management System"]})})]}),t.jsxs(S,{item:!0,xs:12,sm:6,md:3,children:[t.jsx(b,{variant:"h6",color:"text.primary",gutterBottom:!0,children:"Features"}),t.jsx(se,{component:xe,to:"/login",color:"text.secondary",display:"block",sx:{mb:1},children:"Dashboard"}),t.jsx(se,{component:xe,to:"/login",color:"text.secondary",display:"block",sx:{mb:1},children:"Student Management"}),t.jsx(se,{component:xe,to:"/login",color:"text.secondary",display:"block",sx:{mb:1},children:"Teacher Management"}),t.jsx(se,{component:xe,to:"/login",color:"text.secondary",display:"block",children:"Reports"})]}),t.jsxs(S,{item:!0,xs:12,sm:6,md:3,children:[t.jsx(b,{variant:"h6",color:"text.primary",gutterBottom:!0,children:"Resources"}),t.jsx(se,{href:"#",color:"text.secondary",display:"block",sx:{mb:1},children:"Documentation"}),t.jsx(se,{href:"#",color:"text.secondary",display:"block",sx:{mb:1},children:"Support"}),t.jsx(se,{href:"#",color:"text.secondary",display:"block",children:"Blog"})]}),t.jsxs(S,{item:!0,xs:12,sm:6,md:3,children:[t.jsx(b,{variant:"h6",color:"text.primary",gutterBottom:!0,children:"Company"}),t.jsx(se,{href:"#",color:"text.secondary",display:"block",sx:{mb:1},children:"About Us"}),t.jsx(se,{href:"#",color:"text.secondary",display:"block",sx:{mb:1},children:"Contact"}),t.jsx(se,{href:"#",color:"text.secondary",display:"block",children:"Privacy Policy"})]})]})})})]})},bi=An({palette:{primary:{main:"#1976d2",light:"#42a5f5",dark:"#1565c0",contrastText:"#ffffff"},secondary:{main:"#9c27b0",light:"#ba68c8",dark:"#7b1fa2",contrastText:"#ffffff"},success:{main:"#2e7d32",light:"#4caf50",dark:"#1b5e20"},warning:{main:"#ed6c02",light:"#ff9800",dark:"#e65100"},error:{main:"#d32f2f",light:"#ef5350",dark:"#c62828"},info:{main:"#0288d1",light:"#03a9f4",dark:"#01579b"}},typography:{fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif',h1:{fontSize:"2.5rem",fontWeight:500,letterSpacing:"-0.01562em"},h2:{fontSize:"2rem",fontWeight:500,letterSpacing:"-0.00833em"},h3:{fontSize:"1.75rem",fontWeight:500,letterSpacing:"0em"},h4:{fontSize:"1.5rem",fontWeight:500,letterSpacing:"0.00735em"},h5:{fontSize:"1.25rem",fontWeight:500,letterSpacing:"0em"},h6:{fontSize:"1rem",fontWeight:500,letterSpacing:"0.0075em"},button:{textTransform:"none",fontWeight:500}},components:{MuiButton:{styleOverrides:{root:{borderRadius:8},contained:{boxShadow:"none","&:hover":{boxShadow:"0px 2px 4px rgba(0,0,0,0.2)"}}}},MuiCard:{styleOverrides:{root:{borderRadius:12,boxShadow:"0px 2px 4px rgba(0,0,0,0.1)"}}},MuiDialog:{styleOverrides:{paper:{borderRadius:12}}},MuiDataGrid:{styleOverrides:{root:{border:"none","& .MuiDataGrid-cell:focus":{outline:"none"}}}}}}),Kr=g.createContext(void 0),Si=10*60*1e3,vi=({children:e})=>{const[s,r]=g.useState(null),[n,o]=g.useState(!1),[a,i]=g.useState(!0),[l,h]=g.useState(null),d=at(),{showNotification:c}=ne(),u=g.useCallback(()=>{if(l&&clearTimeout(l),n){const f=setTimeout(()=>{A("You have been logged out due to inactivity")},Si);h(f)}},[n]);g.useEffect(()=>{(async()=>{console.log("AuthContext: Checking authentication...");const y=localStorage.getItem("token"),C=localStorage.getItem("user");if(console.log("AuthContext: Retrieved from localStorage:",{token:!!y,userData:!!C}),!y||!C){console.log("AuthContext: No token or user data found in localStorage"),i(!1);return}try{const D=JSON.parse(C);console.log("AuthContext: Parsed user data:",D),console.log("AuthContext: User role from localStorage:",D.role),r(D),o(!0),u(),console.log("AuthContext: User state updated:",{user:D,isAuthenticated:!0})}catch(D){console.error("AuthContext: Token validation failed:",D),localStorage.removeItem("token"),localStorage.removeItem("user")}finally{i(!1)}})();const x=["mousedown","keydown","touchstart","scroll"],p=()=>u();return x.forEach(y=>{window.addEventListener(y,p)}),()=>{x.forEach(y=>{window.removeEventListener(y,p)}),l&&clearTimeout(l)}},[u]);const j=async(f,x)=>{try{console.log("AuthContext: Attempting login for username:",f);const p=await vt.login({username:f,password:x});console.log("AuthContext: Raw API response received");const y=p.data;if(console.log("AuthContext: Extracted user data:",y),!y||!y.token)throw console.error("AuthContext: Invalid user data or missing token",y),new Error("Login failed: Missing token in response");if(!y.role)throw console.error("AuthContext: Missing role in user data",y),new Error("Login failed: User role not specified");console.log("AuthContext: Valid user data with role:",y.role),localStorage.setItem("token",y.token),localStorage.setItem("user",JSON.stringify(y)),r(y),o(!0),u(),d("/dashboard"),c({type:"success",message:"Login successful"})}catch(p){throw console.error("AuthContext: Login error:",p),c({type:"error",message:p.message||"Login failed. Please check your credentials."}),p}},A=(f="You have been logged out")=>{console.log("AuthContext: Logging out user"),localStorage.removeItem("token"),localStorage.removeItem("user"),r(null),o(!1),l&&(clearTimeout(l),h(null)),d("/login"),c({type:"info",message:f})};return g.useEffect(()=>{console.log("AuthContext: Current user state:",s)},[s]),t.jsx(Kr.Provider,{value:{user:s,login:j,logout:A,isAuthenticated:n,loading:a,resetInactivityTimer:u},children:e})},wi=()=>{const e=g.useContext(Kr);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e};class er extends Ae.Component{constructor(s){super(s),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(s,r){console.error("Error in component:",s,r)}render(){return this.state.hasError?t.jsx("div",{children:"Something went wrong. Please try refreshing the page."}):this.props.children}}const Le=({children:e})=>{const{isAuthenticated:s,loading:r}=wi();return r?t.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:t.jsx("div",{children:"Authenticating..."})}):s?t.jsx(t.Fragment,{children:e}):t.jsx(ht,{to:"/login"})},Q={ADMIN:"ADMIN",TEACHER:"TEACHER",STAFF:"STAFF",PARENT:"PARENT",STUDENT:"STUDENT"};function Ai(){return t.jsxs(dr,{children:[t.jsx(he,{path:"/",element:t.jsx(Jr,{})}),t.jsx(he,{path:"/login",element:t.jsx(Oa,{})}),t.jsx(he,{path:"/register",element:t.jsx(La,{})}),t.jsx(he,{path:"/dashboard",element:t.jsx(Le,{children:t.jsx(Oe,{children:t.jsx(pa,{})})})}),t.jsx(he,{path:"/students",element:t.jsx(Le,{children:t.jsx(Oe,{children:t.jsx(Ze,{allowedRoles:[Q.ADMIN,Q.TEACHER,Q.STAFF],children:t.jsx(xa,{})})})})}),t.jsx(he,{path:"/teachers",element:t.jsx(Le,{children:t.jsx(Oe,{children:t.jsx(Ze,{allowedRoles:[Q.ADMIN,Q.STAFF],children:t.jsx(ja,{})})})})}),t.jsx(he,{path:"/courses",element:t.jsx(Le,{children:t.jsx(Oe,{children:t.jsx(Ze,{allowedRoles:[Q.ADMIN,Q.TEACHER,Q.STAFF],children:t.jsx(wa,{})})})})}),t.jsx(he,{path:"/reports",element:t.jsx(Le,{children:t.jsx(Oe,{children:t.jsx(Ze,{allowedRoles:[Q.ADMIN,Q.TEACHER,Q.STAFF],children:t.jsx(Aa,{})})})})}),t.jsx(he,{path:"/admissions",element:t.jsx(Le,{children:t.jsx(Oe,{children:t.jsx(Ze,{allowedRoles:[Q.ADMIN,Q.STAFF],children:t.jsx(Pa,{})})})})})]})}function Ei(){const[e,s]=g.useState(!1);return t.jsx(er,{children:t.jsxs(En,{theme:bi,children:[t.jsx(tr,{}),t.jsx(da,{children:t.jsx(Dn,{children:t.jsx(er,{children:e?t.jsx(dr,{children:t.jsx(he,{path:"*",element:t.jsx(Jr,{})})}):t.jsx(Ae.Suspense,{fallback:t.jsx("div",{children:"Loading..."}),children:t.jsx(vi,{children:t.jsx(Ai,{})})})})})})]})})}Vt.createRoot(document.getElementById("root")).render(t.jsx(Ae.StrictMode,{children:t.jsx(Ei,{})}));
//# sourceMappingURL=index-ddc52869.js.map
