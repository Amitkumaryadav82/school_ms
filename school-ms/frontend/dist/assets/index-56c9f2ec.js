var xv=Object.defineProperty;var gv=(e,r,t)=>r in e?xv(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t;var vv=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports);var Ne=(e,r,t)=>(gv(e,typeof r!="symbol"?r+"":r,t),t);import{j as o,S as xu,A as jr,u as yv,i as At,T as at,B as Se,a as te,b as rl,L as Ga,d as Ya,e as Li,f as qa,C as xp,g as bv,I as Ze,M as wv,h as Yt,k as gp,l as Sv,m as vp,n as Xe,o as Ev,D as pf,p as Tv,q as kv,r as Hs,s as Bi,F as Av,t as Cv,v as ta,G as X,w as Yo,E as _v,x as Xa,y as st,z as vr,H as Me,J as mf,W as Dv,R as Ka,K as yp,N as Ja,O as Qa,Q as Fv,U as Iv,V as ke,X as bp,Y as zs,Z as Za,_ as es,$ as ir,a0 as ze,a1 as Pv,a2 as ts,a3 as wp,a4 as kr,a5 as Xr,a6 as Sp,a7 as Rr,a8 as Nr,a9 as Ra,aa as Na,ab as Ma,ac as Fn,ad as Tt,ae as Wt,af as It,ag as rs,ah as $i,ai as no,aj as ei,ak as gc,al as Ep,am as Gs,an as Tp,ao as Ov,ap as jv,aq as Rv,ar as kp,as as Nv,at as xf,au as gf,av as Ap,aw as Ns,ax as jl,ay as Rl,az as Mv,P as ve,c as Xt,aA as Je,aB as Ct,aC as re,aD as ya,aE as Ge,aF as ra,aG as Lv,aH as Ys,aI as Cp,aJ as ao,aK as _p,aL as Dp,aM as gu,aN as vc,aO as Bv,aP as vu,aQ as $v,aR as Uv,aS as Vv,aT as vf,aU as yc,aV as Wv,aW as Hv,aX as yf,aY as zv,aZ as Fp,a_ as Gv,a$ as Yv,b0 as qv,b1 as tn,b2 as Ta,b3 as Xv,b4 as Kv,b5 as Jv}from"./mui-vendor-c50b5781.js";import{d as Qv,r as C,u as so,a as Zv,N as Bo,b as Mn,e as Ip,R as ey,g as Pp,L as Yn,B as ty,f as Op,h as dn}from"./react-vendor-c0a3892c.js";import{R as bf,B as ry,C as ny,X as ay,Y as sy,T as wf,L as Sf,a as Ef,P as iy,b as oy,c as cy}from"./chart-vendor-a1079580.js";var HB=vv((Yr,qr)=>{(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function t(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=t(a);fetch(a.href,s)}})();var Nl={},Tf=Qv;Nl.createRoot=Tf.createRoot,Nl.hydrateRoot=Tf.hydrateRoot;function jp(e,r){return function(){return e.apply(r,arguments)}}const{toString:ly}=Object.prototype,{getPrototypeOf:yu}=Object,{iterator:bc,toStringTag:Rp}=Symbol,wc=(e=>r=>{const t=ly.call(r);return e[t]||(e[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),Tn=e=>(e=e.toLowerCase(),r=>wc(r)===e),Sc=e=>r=>typeof r===e,{isArray:ti}=Array,Ui=Sc("undefined");function uy(e){return e!==null&&!Ui(e)&&e.constructor!==null&&!Ui(e.constructor)&&Mr(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Np=Tn("ArrayBuffer");function dy(e){let r;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?r=ArrayBuffer.isView(e):r=e&&e.buffer&&Np(e.buffer),r}const fy=Sc("string"),Mr=Sc("function"),Mp=Sc("number"),Ec=e=>e!==null&&typeof e=="object",hy=e=>e===!0||e===!1,$o=e=>{if(wc(e)!=="object")return!1;const r=yu(e);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(Rp in e)&&!(bc in e)},py=Tn("Date"),my=Tn("File"),xy=Tn("Blob"),gy=Tn("FileList"),vy=e=>Ec(e)&&Mr(e.pipe),yy=e=>{let r;return e&&(typeof FormData=="function"&&e instanceof FormData||Mr(e.append)&&((r=wc(e))==="formdata"||r==="object"&&Mr(e.toString)&&e.toString()==="[object FormData]"))},by=Tn("URLSearchParams"),[wy,Sy,Ey,Ty]=["ReadableStream","Request","Response","Headers"].map(Tn),ky=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function io(e,r,{allOwnKeys:t=!1}={}){if(e===null||typeof e>"u")return;let n,a;if(typeof e!="object"&&(e=[e]),ti(e))for(n=0,a=e.length;n<a;n++)r.call(null,e[n],n,e);else{const s=t?Object.getOwnPropertyNames(e):Object.keys(e),i=s.length;let c;for(n=0;n<i;n++)c=s[n],r.call(null,e[c],c,e)}}function Lp(e,r){r=r.toLowerCase();const t=Object.keys(e);let n=t.length,a;for(;n-- >0;)if(a=t[n],r===a.toLowerCase())return a;return null}const $a=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),Bp=e=>!Ui(e)&&e!==$a;function Ml(){const{caseless:e}=Bp(this)&&this||{},r={},t=(n,a)=>{const s=e&&Lp(r,a)||a;$o(r[s])&&$o(n)?r[s]=Ml(r[s],n):$o(n)?r[s]=Ml({},n):ti(n)?r[s]=n.slice():r[s]=n};for(let n=0,a=arguments.length;n<a;n++)arguments[n]&&io(arguments[n],t);return r}const Ay=(e,r,t,{allOwnKeys:n}={})=>(io(r,(a,s)=>{t&&Mr(a)?e[s]=jp(a,t):e[s]=a},{allOwnKeys:n}),e),Cy=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),_y=(e,r,t,n)=>{e.prototype=Object.create(r.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:r.prototype}),t&&Object.assign(e.prototype,t)},Dy=(e,r,t,n)=>{let a,s,i;const c={};if(r=r||{},e==null)return r;do{for(a=Object.getOwnPropertyNames(e),s=a.length;s-- >0;)i=a[s],(!n||n(i,e,r))&&!c[i]&&(r[i]=e[i],c[i]=!0);e=t!==!1&&yu(e)}while(e&&(!t||t(e,r))&&e!==Object.prototype);return r},Fy=(e,r,t)=>{e=String(e),(t===void 0||t>e.length)&&(t=e.length),t-=r.length;const n=e.indexOf(r,t);return n!==-1&&n===t},Iy=e=>{if(!e)return null;if(ti(e))return e;let r=e.length;if(!Mp(r))return null;const t=new Array(r);for(;r-- >0;)t[r]=e[r];return t},Py=(e=>r=>e&&r instanceof e)(typeof Uint8Array<"u"&&yu(Uint8Array)),Oy=(e,r)=>{const n=(e&&e[bc]).call(e);let a;for(;(a=n.next())&&!a.done;){const s=a.value;r.call(e,s[0],s[1])}},jy=(e,r)=>{let t;const n=[];for(;(t=e.exec(r))!==null;)n.push(t);return n},Ry=Tn("HTMLFormElement"),Ny=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,n,a){return n.toUpperCase()+a}),kf=(({hasOwnProperty:e})=>(r,t)=>e.call(r,t))(Object.prototype),My=Tn("RegExp"),$p=(e,r)=>{const t=Object.getOwnPropertyDescriptors(e),n={};io(t,(a,s)=>{let i;(i=r(a,s,e))!==!1&&(n[s]=i||a)}),Object.defineProperties(e,n)},Ly=e=>{$p(e,(r,t)=>{if(Mr(e)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const n=e[t];if(Mr(n)){if(r.enumerable=!1,"writable"in r){r.writable=!1;return}r.set||(r.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},By=(e,r)=>{const t={},n=a=>{a.forEach(s=>{t[s]=!0})};return ti(e)?n(e):n(String(e).split(r)),t},$y=()=>{},Uy=(e,r)=>e!=null&&Number.isFinite(e=+e)?e:r;function Vy(e){return!!(e&&Mr(e.append)&&e[Rp]==="FormData"&&e[bc])}const Wy=e=>{const r=new Array(10),t=(n,a)=>{if(Ec(n)){if(r.indexOf(n)>=0)return;if(!("toJSON"in n)){r[a]=n;const s=ti(n)?[]:{};return io(n,(i,c)=>{const l=t(i,a+1);!Ui(l)&&(s[c]=l)}),r[a]=void 0,s}}return n};return t(e,0)},Hy=Tn("AsyncFunction"),zy=e=>e&&(Ec(e)||Mr(e))&&Mr(e.then)&&Mr(e.catch),Up=((e,r)=>e?setImmediate:r?((t,n)=>($a.addEventListener("message",({source:a,data:s})=>{a===$a&&s===t&&n.length&&n.shift()()},!1),a=>{n.push(a),$a.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",Mr($a.postMessage)),Gy=typeof queueMicrotask<"u"?queueMicrotask.bind($a):typeof process<"u"&&process.nextTick||Up,Yy=e=>e!=null&&Mr(e[bc]),ge={isArray:ti,isArrayBuffer:Np,isBuffer:uy,isFormData:yy,isArrayBufferView:dy,isString:fy,isNumber:Mp,isBoolean:hy,isObject:Ec,isPlainObject:$o,isReadableStream:wy,isRequest:Sy,isResponse:Ey,isHeaders:Ty,isUndefined:Ui,isDate:py,isFile:my,isBlob:xy,isRegExp:My,isFunction:Mr,isStream:vy,isURLSearchParams:by,isTypedArray:Py,isFileList:gy,forEach:io,merge:Ml,extend:Ay,trim:ky,stripBOM:Cy,inherits:_y,toFlatObject:Dy,kindOf:wc,kindOfTest:Tn,endsWith:Fy,toArray:Iy,forEachEntry:Oy,matchAll:jy,isHTMLForm:Ry,hasOwnProperty:kf,hasOwnProp:kf,reduceDescriptors:$p,freezeMethods:Ly,toObjectSet:By,toCamelCase:Ny,noop:$y,toFiniteNumber:Uy,findKey:Lp,global:$a,isContextDefined:Bp,isSpecCompliantForm:Vy,toJSONObject:Wy,isAsyncFn:Hy,isThenable:zy,setImmediate:Up,asap:Gy,isIterable:Yy};function nt(e,r,t,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",r&&(this.code=r),t&&(this.config=t),n&&(this.request=n),a&&(this.response=a,this.status=a.status?a.status:null)}ge.inherits(nt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ge.toJSONObject(this.config),code:this.code,status:this.status}}});const Vp=nt.prototype,Wp={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Wp[e]={value:e}});Object.defineProperties(nt,Wp);Object.defineProperty(Vp,"isAxiosError",{value:!0});nt.from=(e,r,t,n,a,s)=>{const i=Object.create(Vp);return ge.toFlatObject(e,i,function(l){return l!==Error.prototype},c=>c!=="isAxiosError"),nt.call(i,e.message,r,t,n,a),i.cause=e,i.name=e.name,s&&Object.assign(i,s),i};const qy=null;function Ll(e){return ge.isPlainObject(e)||ge.isArray(e)}function Hp(e){return ge.endsWith(e,"[]")?e.slice(0,-2):e}function Af(e,r,t){return e?e.concat(r).map(function(a,s){return a=Hp(a),!t&&s?"["+a+"]":a}).join(t?".":""):r}function Xy(e){return ge.isArray(e)&&!e.some(Ll)}const Ky=ge.toFlatObject(ge,{},null,function(r){return/^is[A-Z]/.test(r)});function Tc(e,r,t){if(!ge.isObject(e))throw new TypeError("target must be an object");r=r||new FormData,t=ge.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(m,g){return!ge.isUndefined(g[m])});const n=t.metaTokens,a=t.visitor||d,s=t.dots,i=t.indexes,l=(t.Blob||typeof Blob<"u"&&Blob)&&ge.isSpecCompliantForm(r);if(!ge.isFunction(a))throw new TypeError("visitor must be a function");function u(p){if(p===null)return"";if(ge.isDate(p))return p.toISOString();if(!l&&ge.isBlob(p))throw new nt("Blob is not supported. Use a Buffer instead.");return ge.isArrayBuffer(p)||ge.isTypedArray(p)?l&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function d(p,m,g){let v=p;if(p&&!g&&typeof p=="object"){if(ge.endsWith(m,"{}"))m=n?m:m.slice(0,-2),p=JSON.stringify(p);else if(ge.isArray(p)&&Xy(p)||(ge.isFileList(p)||ge.endsWith(m,"[]"))&&(v=ge.toArray(p)))return m=Hp(m),v.forEach(function(b,S){!(ge.isUndefined(b)||b===null)&&r.append(i===!0?Af([m],S,s):i===null?m:m+"[]",u(b))}),!1}return Ll(p)?!0:(r.append(Af(g,m,s),u(p)),!1)}const f=[],h=Object.assign(Ky,{defaultVisitor:d,convertValue:u,isVisitable:Ll});function x(p,m){if(!ge.isUndefined(p)){if(f.indexOf(p)!==-1)throw Error("Circular reference detected in "+m.join("."));f.push(p),ge.forEach(p,function(v,y){(!(ge.isUndefined(v)||v===null)&&a.call(r,v,ge.isString(y)?y.trim():y,m,h))===!0&&x(v,m?m.concat(y):[y])}),f.pop()}}if(!ge.isObject(e))throw new TypeError("data must be an object");return x(e),r}function Cf(e){const r={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return r[n]})}function bu(e,r){this._pairs=[],e&&Tc(e,this,r)}const zp=bu.prototype;zp.append=function(r,t){this._pairs.push([r,t])};zp.toString=function(r){const t=r?function(n){return r.call(this,n,Cf)}:Cf;return this._pairs.map(function(a){return t(a[0])+"="+t(a[1])},"").join("&")};function Jy(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Gp(e,r,t){if(!r)return e;const n=t&&t.encode||Jy;ge.isFunction(t)&&(t={serialize:t});const a=t&&t.serialize;let s;if(a?s=a(r,t):s=ge.isURLSearchParams(r)?r.toString():new bu(r,t).toString(n),s){const i=e.indexOf("#");i!==-1&&(e=e.slice(0,i)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}class Qy{constructor(){this.handlers=[]}use(r,t,n){return this.handlers.push({fulfilled:r,rejected:t,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(r){this.handlers[r]&&(this.handlers[r]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(r){ge.forEach(this.handlers,function(n){n!==null&&r(n)})}}const _f=Qy,Yp={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Zy=typeof URLSearchParams<"u"?URLSearchParams:bu,eb=typeof FormData<"u"?FormData:null,tb=typeof Blob<"u"?Blob:null,rb={isBrowser:!0,classes:{URLSearchParams:Zy,FormData:eb,Blob:tb},protocols:["http","https","file","blob","url","data"]},wu=typeof window<"u"&&typeof document<"u",Bl=typeof navigator=="object"&&navigator||void 0,nb=wu&&(!Bl||["ReactNative","NativeScript","NS"].indexOf(Bl.product)<0),ab=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),sb=wu&&window.location.href||"http://localhost",ib=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:wu,hasStandardBrowserEnv:nb,hasStandardBrowserWebWorkerEnv:ab,navigator:Bl,origin:sb},Symbol.toStringTag,{value:"Module"})),mr={...ib,...rb};function ob(e,r){return Tc(e,new mr.classes.URLSearchParams,Object.assign({visitor:function(t,n,a,s){return mr.isNode&&ge.isBuffer(t)?(this.append(n,t.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},r))}function cb(e){return ge.matchAll(/\w+|\[(\w*)]/g,e).map(r=>r[0]==="[]"?"":r[1]||r[0])}function lb(e){const r={},t=Object.keys(e);let n;const a=t.length;let s;for(n=0;n<a;n++)s=t[n],r[s]=e[s];return r}function qp(e){function r(t,n,a,s){let i=t[s++];if(i==="__proto__")return!0;const c=Number.isFinite(+i),l=s>=t.length;return i=!i&&ge.isArray(a)?a.length:i,l?(ge.hasOwnProp(a,i)?a[i]=[a[i],n]:a[i]=n,!c):((!a[i]||!ge.isObject(a[i]))&&(a[i]=[]),r(t,n,a[i],s)&&ge.isArray(a[i])&&(a[i]=lb(a[i])),!c)}if(ge.isFormData(e)&&ge.isFunction(e.entries)){const t={};return ge.forEachEntry(e,(n,a)=>{r(cb(n),a,t,0)}),t}return null}function ub(e,r,t){if(ge.isString(e))try{return(r||JSON.parse)(e),ge.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(t||JSON.stringify)(e)}const Su={transitional:Yp,adapter:["xhr","http","fetch"],transformRequest:[function(r,t){const n=t.getContentType()||"",a=n.indexOf("application/json")>-1,s=ge.isObject(r);if(s&&ge.isHTMLForm(r)&&(r=new FormData(r)),ge.isFormData(r))return a?JSON.stringify(qp(r)):r;if(ge.isArrayBuffer(r)||ge.isBuffer(r)||ge.isStream(r)||ge.isFile(r)||ge.isBlob(r)||ge.isReadableStream(r))return r;if(ge.isArrayBufferView(r))return r.buffer;if(ge.isURLSearchParams(r))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),r.toString();let c;if(s){if(n.indexOf("application/x-www-form-urlencoded")>-1)return ob(r,this.formSerializer).toString();if((c=ge.isFileList(r))||n.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return Tc(c?{"files[]":r}:r,l&&new l,this.formSerializer)}}return s||a?(t.setContentType("application/json",!1),ub(r)):r}],transformResponse:[function(r){const t=this.transitional||Su.transitional,n=t&&t.forcedJSONParsing,a=this.responseType==="json";if(ge.isResponse(r)||ge.isReadableStream(r))return r;if(r&&ge.isString(r)&&(n&&!this.responseType||a)){const i=!(t&&t.silentJSONParsing)&&a;try{return JSON.parse(r)}catch(c){if(i)throw c.name==="SyntaxError"?nt.from(c,nt.ERR_BAD_RESPONSE,this,null,this.response):c}}return r}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:mr.classes.FormData,Blob:mr.classes.Blob},validateStatus:function(r){return r>=200&&r<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ge.forEach(["delete","get","head","post","put","patch"],e=>{Su.headers[e]={}});const Eu=Su,db=ge.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),fb=e=>{const r={};let t,n,a;return e&&e.split(`
`).forEach(function(i){a=i.indexOf(":"),t=i.substring(0,a).trim().toLowerCase(),n=i.substring(a+1).trim(),!(!t||r[t]&&db[t])&&(t==="set-cookie"?r[t]?r[t].push(n):r[t]=[n]:r[t]=r[t]?r[t]+", "+n:n)}),r},Df=Symbol("internals");function di(e){return e&&String(e).trim().toLowerCase()}function Uo(e){return e===!1||e==null?e:ge.isArray(e)?e.map(Uo):String(e)}function hb(e){const r=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=t.exec(e);)r[n[1]]=n[2];return r}const pb=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function nl(e,r,t,n,a){if(ge.isFunction(n))return n.call(this,r,t);if(a&&(r=t),!!ge.isString(r)){if(ge.isString(n))return r.indexOf(n)!==-1;if(ge.isRegExp(n))return n.test(r)}}function mb(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(r,t,n)=>t.toUpperCase()+n)}function xb(e,r){const t=ge.toCamelCase(" "+r);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+t,{value:function(a,s,i){return this[n].call(this,r,a,s,i)},configurable:!0})})}class kc{constructor(r){r&&this.set(r)}set(r,t,n){const a=this;function s(c,l,u){const d=di(l);if(!d)throw new Error("header name must be a non-empty string");const f=ge.findKey(a,d);(!f||a[f]===void 0||u===!0||u===void 0&&a[f]!==!1)&&(a[f||l]=Uo(c))}const i=(c,l)=>ge.forEach(c,(u,d)=>s(u,d,l));if(ge.isPlainObject(r)||r instanceof this.constructor)i(r,t);else if(ge.isString(r)&&(r=r.trim())&&!pb(r))i(fb(r),t);else if(ge.isObject(r)&&ge.isIterable(r)){let c={},l,u;for(const d of r){if(!ge.isArray(d))throw TypeError("Object iterator must return a key-value pair");c[u=d[0]]=(l=c[u])?ge.isArray(l)?[...l,d[1]]:[l,d[1]]:d[1]}i(c,t)}else r!=null&&s(t,r,n);return this}get(r,t){if(r=di(r),r){const n=ge.findKey(this,r);if(n){const a=this[n];if(!t)return a;if(t===!0)return hb(a);if(ge.isFunction(t))return t.call(this,a,n);if(ge.isRegExp(t))return t.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(r,t){if(r=di(r),r){const n=ge.findKey(this,r);return!!(n&&this[n]!==void 0&&(!t||nl(this,this[n],n,t)))}return!1}delete(r,t){const n=this;let a=!1;function s(i){if(i=di(i),i){const c=ge.findKey(n,i);c&&(!t||nl(n,n[c],c,t))&&(delete n[c],a=!0)}}return ge.isArray(r)?r.forEach(s):s(r),a}clear(r){const t=Object.keys(this);let n=t.length,a=!1;for(;n--;){const s=t[n];(!r||nl(this,this[s],s,r,!0))&&(delete this[s],a=!0)}return a}normalize(r){const t=this,n={};return ge.forEach(this,(a,s)=>{const i=ge.findKey(n,s);if(i){t[i]=Uo(a),delete t[s];return}const c=r?mb(s):String(s).trim();c!==s&&delete t[s],t[c]=Uo(a),n[c]=!0}),this}concat(...r){return this.constructor.concat(this,...r)}toJSON(r){const t=Object.create(null);return ge.forEach(this,(n,a)=>{n!=null&&n!==!1&&(t[a]=r&&ge.isArray(n)?n.join(", "):n)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([r,t])=>r+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(r){return r instanceof this?r:new this(r)}static concat(r,...t){const n=new this(r);return t.forEach(a=>n.set(a)),n}static accessor(r){const n=(this[Df]=this[Df]={accessors:{}}).accessors,a=this.prototype;function s(i){const c=di(i);n[c]||(xb(a,i),n[c]=!0)}return ge.isArray(r)?r.forEach(s):s(r),this}}kc.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ge.reduceDescriptors(kc.prototype,({value:e},r)=>{let t=r[0].toUpperCase()+r.slice(1);return{get:()=>e,set(n){this[t]=n}}});ge.freezeMethods(kc);const wn=kc;function al(e,r){const t=this||Eu,n=r||t,a=wn.from(n.headers);let s=n.data;return ge.forEach(e,function(c){s=c.call(t,s,a.normalize(),r?r.status:void 0)}),a.normalize(),s}function Xp(e){return!!(e&&e.__CANCEL__)}function ri(e,r,t){nt.call(this,e??"canceled",nt.ERR_CANCELED,r,t),this.name="CanceledError"}ge.inherits(ri,nt,{__CANCEL__:!0});function Kp(e,r,t){const n=t.config.validateStatus;!t.status||!n||n(t.status)?e(t):r(new nt("Request failed with status code "+t.status,[nt.ERR_BAD_REQUEST,nt.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function gb(e){const r=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return r&&r[1]||""}function vb(e,r){e=e||10;const t=new Array(e),n=new Array(e);let a=0,s=0,i;return r=r!==void 0?r:1e3,function(l){const u=Date.now(),d=n[s];i||(i=u),t[a]=l,n[a]=u;let f=s,h=0;for(;f!==a;)h+=t[f++],f=f%e;if(a=(a+1)%e,a===s&&(s=(s+1)%e),u-i<r)return;const x=d&&u-d;return x?Math.round(h*1e3/x):void 0}}function yb(e,r){let t=0,n=1e3/r,a,s;const i=(u,d=Date.now())=>{t=d,a=null,s&&(clearTimeout(s),s=null),e.apply(null,u)};return[(...u)=>{const d=Date.now(),f=d-t;f>=n?i(u,d):(a=u,s||(s=setTimeout(()=>{s=null,i(a)},n-f)))},()=>a&&i(a)]}const qo=(e,r,t=3)=>{let n=0;const a=vb(50,250);return yb(s=>{const i=s.loaded,c=s.lengthComputable?s.total:void 0,l=i-n,u=a(l),d=i<=c;n=i;const f={loaded:i,total:c,progress:c?i/c:void 0,bytes:l,rate:u||void 0,estimated:u&&c&&d?(c-i)/u:void 0,event:s,lengthComputable:c!=null,[r?"download":"upload"]:!0};e(f)},t)},Ff=(e,r)=>{const t=e!=null;return[n=>r[0]({lengthComputable:t,total:e,loaded:n}),r[1]]},If=e=>(...r)=>ge.asap(()=>e(...r)),bb=mr.hasStandardBrowserEnv?((e,r)=>t=>(t=new URL(t,mr.origin),e.protocol===t.protocol&&e.host===t.host&&(r||e.port===t.port)))(new URL(mr.origin),mr.navigator&&/(msie|trident)/i.test(mr.navigator.userAgent)):()=>!0,wb=mr.hasStandardBrowserEnv?{write(e,r,t,n,a,s){const i=[e+"="+encodeURIComponent(r)];ge.isNumber(t)&&i.push("expires="+new Date(t).toGMTString()),ge.isString(n)&&i.push("path="+n),ge.isString(a)&&i.push("domain="+a),s===!0&&i.push("secure"),document.cookie=i.join("; ")},read(e){const r=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return r?decodeURIComponent(r[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Sb(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function Eb(e,r){return r?e.replace(/\/?\/$/,"")+"/"+r.replace(/^\/+/,""):e}function Jp(e,r,t){let n=!Sb(r);return e&&(n||t==!1)?Eb(e,r):r}const Pf=e=>e instanceof wn?{...e}:e;function ns(e,r){r=r||{};const t={};function n(u,d,f,h){return ge.isPlainObject(u)&&ge.isPlainObject(d)?ge.merge.call({caseless:h},u,d):ge.isPlainObject(d)?ge.merge({},d):ge.isArray(d)?d.slice():d}function a(u,d,f,h){if(ge.isUndefined(d)){if(!ge.isUndefined(u))return n(void 0,u,f,h)}else return n(u,d,f,h)}function s(u,d){if(!ge.isUndefined(d))return n(void 0,d)}function i(u,d){if(ge.isUndefined(d)){if(!ge.isUndefined(u))return n(void 0,u)}else return n(void 0,d)}function c(u,d,f){if(f in r)return n(u,d);if(f in e)return n(void 0,u)}const l={url:s,method:s,data:s,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:c,headers:(u,d,f)=>a(Pf(u),Pf(d),f,!0)};return ge.forEach(Object.keys(Object.assign({},e,r)),function(d){const f=l[d]||a,h=f(e[d],r[d],d);ge.isUndefined(h)&&f!==c||(t[d]=h)}),t}const Qp=e=>{const r=ns({},e);let{data:t,withXSRFToken:n,xsrfHeaderName:a,xsrfCookieName:s,headers:i,auth:c}=r;r.headers=i=wn.from(i),r.url=Gp(Jp(r.baseURL,r.url,r.allowAbsoluteUrls),e.params,e.paramsSerializer),c&&i.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):"")));let l;if(ge.isFormData(t)){if(mr.hasStandardBrowserEnv||mr.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if((l=i.getContentType())!==!1){const[u,...d]=l?l.split(";").map(f=>f.trim()).filter(Boolean):[];i.setContentType([u||"multipart/form-data",...d].join("; "))}}if(mr.hasStandardBrowserEnv&&(n&&ge.isFunction(n)&&(n=n(r)),n||n!==!1&&bb(r.url))){const u=a&&s&&wb.read(s);u&&i.set(a,u)}return r},Tb=typeof XMLHttpRequest<"u",kb=Tb&&function(e){return new Promise(function(t,n){const a=Qp(e);let s=a.data;const i=wn.from(a.headers).normalize();let{responseType:c,onUploadProgress:l,onDownloadProgress:u}=a,d,f,h,x,p;function m(){x&&x(),p&&p(),a.cancelToken&&a.cancelToken.unsubscribe(d),a.signal&&a.signal.removeEventListener("abort",d)}let g=new XMLHttpRequest;g.open(a.method.toUpperCase(),a.url,!0),g.timeout=a.timeout;function v(){if(!g)return;const b=wn.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders()),I={data:!c||c==="text"||c==="json"?g.responseText:g.response,status:g.status,statusText:g.statusText,headers:b,config:e,request:g};Kp(function(E){t(E),m()},function(E){n(E),m()},I),g=null}"onloadend"in g?g.onloadend=v:g.onreadystatechange=function(){!g||g.readyState!==4||g.status===0&&!(g.responseURL&&g.responseURL.indexOf("file:")===0)||setTimeout(v)},g.onabort=function(){g&&(n(new nt("Request aborted",nt.ECONNABORTED,e,g)),g=null)},g.onerror=function(){n(new nt("Network Error",nt.ERR_NETWORK,e,g)),g=null},g.ontimeout=function(){let S=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const I=a.transitional||Yp;a.timeoutErrorMessage&&(S=a.timeoutErrorMessage),n(new nt(S,I.clarifyTimeoutError?nt.ETIMEDOUT:nt.ECONNABORTED,e,g)),g=null},s===void 0&&i.setContentType(null),"setRequestHeader"in g&&ge.forEach(i.toJSON(),function(S,I){g.setRequestHeader(I,S)}),ge.isUndefined(a.withCredentials)||(g.withCredentials=!!a.withCredentials),c&&c!=="json"&&(g.responseType=a.responseType),u&&([h,p]=qo(u,!0),g.addEventListener("progress",h)),l&&g.upload&&([f,x]=qo(l),g.upload.addEventListener("progress",f),g.upload.addEventListener("loadend",x)),(a.cancelToken||a.signal)&&(d=b=>{g&&(n(!b||b.type?new ri(null,e,g):b),g.abort(),g=null)},a.cancelToken&&a.cancelToken.subscribe(d),a.signal&&(a.signal.aborted?d():a.signal.addEventListener("abort",d)));const y=gb(a.url);if(y&&mr.protocols.indexOf(y)===-1){n(new nt("Unsupported protocol "+y+":",nt.ERR_BAD_REQUEST,e));return}g.send(s||null)})},Ab=(e,r)=>{const{length:t}=e=e?e.filter(Boolean):[];if(r||t){let n=new AbortController,a;const s=function(u){if(!a){a=!0,c();const d=u instanceof Error?u:this.reason;n.abort(d instanceof nt?d:new ri(d instanceof Error?d.message:d))}};let i=r&&setTimeout(()=>{i=null,s(new nt(`timeout ${r} of ms exceeded`,nt.ETIMEDOUT))},r);const c=()=>{e&&(i&&clearTimeout(i),i=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(s):u.removeEventListener("abort",s)}),e=null)};e.forEach(u=>u.addEventListener("abort",s));const{signal:l}=n;return l.unsubscribe=()=>ge.asap(c),l}},Cb=Ab,_b=function*(e,r){let t=e.byteLength;if(!r||t<r){yield e;return}let n=0,a;for(;n<t;)a=n+r,yield e.slice(n,a),n=a},Db=async function*(e,r){for await(const t of Fb(e))yield*_b(t,r)},Fb=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const r=e.getReader();try{for(;;){const{done:t,value:n}=await r.read();if(t)break;yield n}}finally{await r.cancel()}},Of=(e,r,t,n)=>{const a=Db(e,r);let s=0,i,c=l=>{i||(i=!0,n&&n(l))};return new ReadableStream({async pull(l){try{const{done:u,value:d}=await a.next();if(u){c(),l.close();return}let f=d.byteLength;if(t){let h=s+=f;t(h)}l.enqueue(new Uint8Array(d))}catch(u){throw c(u),u}},cancel(l){return c(l),a.return()}},{highWaterMark:2})},Ac=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Zp=Ac&&typeof ReadableStream=="function",Ib=Ac&&(typeof TextEncoder=="function"?(e=>r=>e.encode(r))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),em=(e,...r)=>{try{return!!e(...r)}catch{return!1}},Pb=Zp&&em(()=>{let e=!1;const r=new Request(mr.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!r}),jf=64*1024,$l=Zp&&em(()=>ge.isReadableStream(new Response("").body)),Xo={stream:$l&&(e=>e.body)};Ac&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(r=>{!Xo[r]&&(Xo[r]=ge.isFunction(e[r])?t=>t[r]():(t,n)=>{throw new nt(`Response type '${r}' is not supported`,nt.ERR_NOT_SUPPORT,n)})})})(new Response);const Ob=async e=>{if(e==null)return 0;if(ge.isBlob(e))return e.size;if(ge.isSpecCompliantForm(e))return(await new Request(mr.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(ge.isArrayBufferView(e)||ge.isArrayBuffer(e))return e.byteLength;if(ge.isURLSearchParams(e)&&(e=e+""),ge.isString(e))return(await Ib(e)).byteLength},jb=async(e,r)=>{const t=ge.toFiniteNumber(e.getContentLength());return t??Ob(r)},Rb=Ac&&(async e=>{let{url:r,method:t,data:n,signal:a,cancelToken:s,timeout:i,onDownloadProgress:c,onUploadProgress:l,responseType:u,headers:d,withCredentials:f="same-origin",fetchOptions:h}=Qp(e);u=u?(u+"").toLowerCase():"text";let x=Cb([a,s&&s.toAbortSignal()],i),p;const m=x&&x.unsubscribe&&(()=>{x.unsubscribe()});let g;try{if(l&&Pb&&t!=="get"&&t!=="head"&&(g=await jb(d,n))!==0){let I=new Request(r,{method:"POST",body:n,duplex:"half"}),k;if(ge.isFormData(n)&&(k=I.headers.get("content-type"))&&d.setContentType(k),I.body){const[E,T]=Ff(g,qo(If(l)));n=Of(I.body,jf,E,T)}}ge.isString(f)||(f=f?"include":"omit");const v="credentials"in Request.prototype;p=new Request(r,{...h,signal:x,method:t.toUpperCase(),headers:d.normalize().toJSON(),body:n,duplex:"half",credentials:v?f:void 0});let y=await fetch(p);const b=$l&&(u==="stream"||u==="response");if($l&&(c||b&&m)){const I={};["status","statusText","headers"].forEach(w=>{I[w]=y[w]});const k=ge.toFiniteNumber(y.headers.get("content-length")),[E,T]=c&&Ff(k,qo(If(c),!0))||[];y=new Response(Of(y.body,jf,E,()=>{T&&T(),m&&m()}),I)}u=u||"text";let S=await Xo[ge.findKey(Xo,u)||"text"](y,e);return!b&&m&&m(),await new Promise((I,k)=>{Kp(I,k,{data:S,headers:wn.from(y.headers),status:y.status,statusText:y.statusText,config:e,request:p})})}catch(v){throw m&&m(),v&&v.name==="TypeError"&&/Load failed|fetch/i.test(v.message)?Object.assign(new nt("Network Error",nt.ERR_NETWORK,e,p),{cause:v.cause||v}):nt.from(v,v&&v.code,e,p)}}),Ul={http:qy,xhr:kb,fetch:Rb};ge.forEach(Ul,(e,r)=>{if(e){try{Object.defineProperty(e,"name",{value:r})}catch{}Object.defineProperty(e,"adapterName",{value:r})}});const Rf=e=>`- ${e}`,Nb=e=>ge.isFunction(e)||e===null||e===!1,tm={getAdapter:e=>{e=ge.isArray(e)?e:[e];const{length:r}=e;let t,n;const a={};for(let s=0;s<r;s++){t=e[s];let i;if(n=t,!Nb(t)&&(n=Ul[(i=String(t)).toLowerCase()],n===void 0))throw new nt(`Unknown adapter '${i}'`);if(n)break;a[i||"#"+s]=n}if(!n){const s=Object.entries(a).map(([c,l])=>`adapter ${c} `+(l===!1?"is not supported by the environment":"is not available in the build"));let i=r?s.length>1?`since :
`+s.map(Rf).join(`
`):" "+Rf(s[0]):"as no adapter specified";throw new nt("There is no suitable adapter to dispatch the request "+i,"ERR_NOT_SUPPORT")}return n},adapters:Ul};function sl(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new ri(null,e)}function Nf(e){return sl(e),e.headers=wn.from(e.headers),e.data=al.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),tm.getAdapter(e.adapter||Eu.adapter)(e).then(function(n){return sl(e),n.data=al.call(e,e.transformResponse,n),n.headers=wn.from(n.headers),n},function(n){return Xp(n)||(sl(e),n&&n.response&&(n.response.data=al.call(e,e.transformResponse,n.response),n.response.headers=wn.from(n.response.headers))),Promise.reject(n)})}const rm="1.9.0",Cc={};["object","boolean","number","function","string","symbol"].forEach((e,r)=>{Cc[e]=function(n){return typeof n===e||"a"+(r<1?"n ":" ")+e}});const Mf={};Cc.transitional=function(r,t,n){function a(s,i){return"[Axios v"+rm+"] Transitional option '"+s+"'"+i+(n?". "+n:"")}return(s,i,c)=>{if(r===!1)throw new nt(a(i," has been removed"+(t?" in "+t:"")),nt.ERR_DEPRECATED);return t&&!Mf[i]&&(Mf[i]=!0,console.warn(a(i," has been deprecated since v"+t+" and will be removed in the near future"))),r?r(s,i,c):!0}};Cc.spelling=function(r){return(t,n)=>(console.warn(`${n} is likely a misspelling of ${r}`),!0)};function Mb(e,r,t){if(typeof e!="object")throw new nt("options must be an object",nt.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let a=n.length;for(;a-- >0;){const s=n[a],i=r[s];if(i){const c=e[s],l=c===void 0||i(c,s,e);if(l!==!0)throw new nt("option "+s+" must be "+l,nt.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new nt("Unknown option "+s,nt.ERR_BAD_OPTION)}}const Vo={assertOptions:Mb,validators:Cc},An=Vo.validators;class Ko{constructor(r){this.defaults=r||{},this.interceptors={request:new _f,response:new _f}}async request(r,t){try{return await this._request(r,t)}catch(n){if(n instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const s=a.stack?a.stack.replace(/^.+\n/,""):"";try{n.stack?s&&!String(n.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+s):n.stack=s}catch{}}throw n}}_request(r,t){typeof r=="string"?(t=t||{},t.url=r):t=r||{},t=ns(this.defaults,t);const{transitional:n,paramsSerializer:a,headers:s}=t;n!==void 0&&Vo.assertOptions(n,{silentJSONParsing:An.transitional(An.boolean),forcedJSONParsing:An.transitional(An.boolean),clarifyTimeoutError:An.transitional(An.boolean)},!1),a!=null&&(ge.isFunction(a)?t.paramsSerializer={serialize:a}:Vo.assertOptions(a,{encode:An.function,serialize:An.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Vo.assertOptions(t,{baseUrl:An.spelling("baseURL"),withXsrfToken:An.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let i=s&&ge.merge(s.common,s[t.method]);s&&ge.forEach(["delete","get","head","post","put","patch","common"],p=>{delete s[p]}),t.headers=wn.concat(i,s);const c=[];let l=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(t)===!1||(l=l&&m.synchronous,c.unshift(m.fulfilled,m.rejected))});const u=[];this.interceptors.response.forEach(function(m){u.push(m.fulfilled,m.rejected)});let d,f=0,h;if(!l){const p=[Nf.bind(this),void 0];for(p.unshift.apply(p,c),p.push.apply(p,u),h=p.length,d=Promise.resolve(t);f<h;)d=d.then(p[f++],p[f++]);return d}h=c.length;let x=t;for(f=0;f<h;){const p=c[f++],m=c[f++];try{x=p(x)}catch(g){m.call(this,g);break}}try{d=Nf.call(this,x)}catch(p){return Promise.reject(p)}for(f=0,h=u.length;f<h;)d=d.then(u[f++],u[f++]);return d}getUri(r){r=ns(this.defaults,r);const t=Jp(r.baseURL,r.url,r.allowAbsoluteUrls);return Gp(t,r.params,r.paramsSerializer)}}ge.forEach(["delete","get","head","options"],function(r){Ko.prototype[r]=function(t,n){return this.request(ns(n||{},{method:r,url:t,data:(n||{}).data}))}});ge.forEach(["post","put","patch"],function(r){function t(n){return function(s,i,c){return this.request(ns(c||{},{method:r,headers:n?{"Content-Type":"multipart/form-data"}:{},url:s,data:i}))}}Ko.prototype[r]=t(),Ko.prototype[r+"Form"]=t(!0)});const Wo=Ko;class Tu{constructor(r){if(typeof r!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(s){t=s});const n=this;this.promise.then(a=>{if(!n._listeners)return;let s=n._listeners.length;for(;s-- >0;)n._listeners[s](a);n._listeners=null}),this.promise.then=a=>{let s;const i=new Promise(c=>{n.subscribe(c),s=c}).then(a);return i.cancel=function(){n.unsubscribe(s)},i},r(function(s,i,c){n.reason||(n.reason=new ri(s,i,c),t(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(r){if(this.reason){r(this.reason);return}this._listeners?this._listeners.push(r):this._listeners=[r]}unsubscribe(r){if(!this._listeners)return;const t=this._listeners.indexOf(r);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const r=new AbortController,t=n=>{r.abort(n)};return this.subscribe(t),r.signal.unsubscribe=()=>this.unsubscribe(t),r.signal}static source(){let r;return{token:new Tu(function(a){r=a}),cancel:r}}}const Lb=Tu;function Bb(e){return function(t){return e.apply(null,t)}}function $b(e){return ge.isObject(e)&&e.isAxiosError===!0}const Vl={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Vl).forEach(([e,r])=>{Vl[r]=e});const Ub=Vl;function nm(e){const r=new Wo(e),t=jp(Wo.prototype.request,r);return ge.extend(t,Wo.prototype,r,{allOwnKeys:!0}),ge.extend(t,r,null,{allOwnKeys:!0}),t.create=function(a){return nm(ns(e,a))},t}const Ht=nm(Eu);Ht.Axios=Wo;Ht.CanceledError=ri;Ht.CancelToken=Lb;Ht.isCancel=Xp;Ht.VERSION=rm;Ht.toFormData=Tc;Ht.AxiosError=nt;Ht.Cancel=Ht.CanceledError;Ht.all=function(r){return Promise.all(r)};Ht.spread=Bb;Ht.isAxiosError=$b;Ht.mergeConfig=ns;Ht.AxiosHeaders=wn;Ht.formToJSON=e=>qp(ge.isHTMLForm(e)?new FormData(e):e);Ht.getAdapter=tm.getAdapter;Ht.HttpStatusCode=Ub;Ht.default=Ht;const qn=Ht,Vb={apiUrl:window.location.origin,fallbackApiUrl:"",swaggerUrl:"/swagger-ui/index.html",apiTimeout:15e3,retryAttempts:3};let am;am=Vb;const wt=am,mn=qn.create({baseURL:wt.apiUrl,timeout:wt.apiTimeout,headers:{"Content-Type":"application/json"}});mn.interceptors.request.use(e=>{const r=localStorage.getItem("token");return console.log(`Request to ${e.url}:`,{method:e.method,hasToken:!!r,tokenFirstChars:r?`${r.substring(0,10)}...`:"none",headers:e.headers,timestamp:new Date().toISOString()}),r&&e.headers&&(e.headers.Authorization=`Bearer ${r}`),e});mn.interceptors.response.use(e=>{var r,t;return(r=e.config.url)!=null&&r.includes("staff")&&((t=e.config.url)!=null&&t.includes("employment-status"))&&console.log("Successful staff status update response:",{status:e.status,url:e.config.url,method:e.config.method,data:e.data}),e},e=>{var n,a,s,i,c,l,u,d,f,h,x,p,m,g,v,y,b,S,I,k,E,T,w,F,P,A,L,Y,q,Q,K,ye,U,me,J,D,B,V,W,Z,fe;if(console.error("API Error Details:",{status:(n=e.response)==null?void 0:n.status,statusText:(a=e.response)==null?void 0:a.statusText,data:(s=e.response)==null?void 0:s.data,url:(i=e.config)==null?void 0:i.url,method:(c=e.config)==null?void 0:c.method,headers:(l=e.config)==null?void 0:l.headers,requestTimestamp:new Date().toISOString()}),((u=e.response)==null?void 0:u.status)===403){console.error("Permission Error (403) Details:"),console.error("Current localStorage token:",localStorage.getItem("token")?"Present (first 10 chars): "+((d=localStorage.getItem("token"))==null?void 0:d.substring(0,10))+"...":"Missing"),console.error("User from localStorage:",localStorage.getItem("user")),console.error("Full request URL:",((f=e.config)==null?void 0:f.baseURL)+((h=e.config)==null?void 0:h.url)),console.error("Request Method:",(p=(x=e.config)==null?void 0:x.method)==null?void 0:p.toUpperCase()),console.error("Request Headers:",(m=e.config)==null?void 0:m.headers);try{console.error("Request Payload:",(g=e.config)!=null&&g.data?JSON.parse((v=e.config)==null?void 0:v.data):"No data")}catch{console.error("Raw Request Payload:",(y=e.config)==null?void 0:y.data)}console.error("Response Body:",(b=e.response)==null?void 0:b.data)}if(((S=e.response)==null?void 0:S.status)===500){console.error("Server Error 500 Details:");try{console.error("Request URL:",(I=e.config)==null?void 0:I.url),console.error("Request Method:",(k=e.config)==null?void 0:k.method),console.error("Request Payload:",JSON.parse((E=e.config)==null?void 0:E.data)),console.error("Response Data:",(T=e.response)==null?void 0:T.data)}catch{console.error("Raw Request Data:",(w=e.config)==null?void 0:w.data)}}if(((F=e.response)==null?void 0:F.status)===400){console.error("Validation Error Details:"),(A=(P=e.response)==null?void 0:P.data)!=null&&A.errors?console.table(e.response.data.errors):(Y=(L=e.response)==null?void 0:L.data)!=null&&Y.fieldErrors?console.table(e.response.data.fieldErrors):typeof((q=e.response)==null?void 0:q.data)=="object"&&Object.entries(e.response.data).forEach(([ne,ee])=>{console.log(`${ne}:`,ee)});try{console.log("Request payload that caused validation error:",JSON.parse((Q=e.config)==null?void 0:Q.data))}catch{console.log("Request payload (could not parse):",(K=e.config)==null?void 0:K.data)}}((ye=e.response)==null?void 0:ye.status)===401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login");const t={message:((me=(U=e.response)==null?void 0:U.data)==null?void 0:me.message)||((D=(J=e.response)==null?void 0:J.data)==null?void 0:D.error)||e.message||"An error occurred",status:((B=e.response)==null?void 0:B.status)||"network_error",originalError:e,validationErrors:((W=(V=e.response)==null?void 0:V.data)==null?void 0:W.errors)||((fe=(Z=e.response)==null?void 0:Z.data)==null?void 0:fe.fieldErrors)};return Promise.reject(t)});const De={get:(e,r)=>mn.get(sa(e),{params:r}).then(t=>t.data),post:(e,r)=>mn.post(sa(e),r).then(t=>t.data),put:(e,r)=>mn.put(sa(e),r).then(t=>t.data),delete:e=>mn.delete(sa(e)).then(r=>r.data),patch:(e,r)=>mn.patch(sa(e),r).then(t=>t.data),bulkUpload:(e,r,t)=>{const n=(t==null?void 0:t.isFile)??r instanceof File,a=sa(e);if(n){const s=new FormData;return s.append("file",r),mn.post(a,s,{headers:{"Content-Type":"multipart/form-data"}}).then(i=>i.data)}else return mn.post(a,r).then(s=>s.data)},downloadBlob:(e,r)=>mn.get(sa(e),{responseType:"blob",params:r}).then(t=>t.data),downloadBlobPost:(e,r)=>mn.post(sa(e),r,{responseType:"blob"}).then(t=>t.data)};function sa(e){const r=wt.apiUrl.endsWith("/")?wt.apiUrl.slice(0,-1):wt.apiUrl;return e.startsWith("/api/")?`${r}${e}`:e.startsWith("/")?`${r}/api${e}`:`${r}/api/${e}`}function Wb(e){try{const t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),n=decodeURIComponent(window.atob(t).split("").map(a=>"%"+("00"+a.charCodeAt(0).toString(16)).slice(-2)).join(""));return JSON.parse(n)}catch(r){return console.error("Error parsing JWT token:",r),null}}const il={setWithExpiry:(e,r,t)=>{const a={value:r,expiry:new Date().getTime()+t};localStorage.setItem(e,JSON.stringify(a))},getWithExpiry:e=>{const r=localStorage.getItem(e);if(!r)return null;try{const t=JSON.parse(r);return new Date().getTime()>t.expiry?(localStorage.removeItem(e),null):t.value}catch(t){return console.error("Error parsing stored item with TTL:",t),localStorage.removeItem(e),null}},remove:e=>{localStorage.removeItem(e)}},Jo={login:async e=>{console.log("ðŸ” AuthService: Attempting login with credentials:",{username:e.username,passwordLength:e.password?e.password.length:0});try{if(!navigator.onLine){console.log("ðŸ“µ AuthService: Device is offline, checking for cached credentials");const n=il.getWithExpiry("offlineAuth");if(n&&n.username===e.username&&n.passwordHash===Lf(e.password))return console.log("âœ… AuthService: Using cached credentials for offline mode"),{data:n.authData,offlineMode:!0};throw console.error("âŒ AuthService: No valid cached credentials found for offline mode"),{message:"You appear to be offline. Cannot authenticate without internet connection.",status:"network_error",isOffline:!0}}const t=await De.post("/auth/login",e);return console.log("âœ… AuthService: Login successful"),console.log("ðŸ” DEBUG - Auth Response Details:",{responseData:t,token:t.token||t.access_token,username:t.username,role:t.role||t.userRole,allFields:Object.keys(t)}),il.setWithExpiry("offlineAuth",{username:e.username,passwordHash:Lf(e.password),authData:t,timestamp:new Date().toISOString()},864e5),t}catch(r){throw console.error("âŒ AuthService: Login failed:",r),r}},register:async e=>{try{return await De.post("/auth/register",e)}catch(r){throw console.error("âŒ AuthService: Registration failed:",r),r}},logout:()=>{console.log("ðŸ”’ AuthService: Logging out user"),localStorage.removeItem("token"),localStorage.removeItem("user"),il.remove("offlineAuth"),De.post("/auth/logout",{}).then(()=>console.log("âœ… AuthService: Server logout successful")).catch(e=>console.log("â„¹ï¸ AuthService: Server logout failed, but client logout completed"))},validateToken:async e=>{try{return(await De.post("/auth/validate-token",{token:e})).valid===!0}catch(r){return console.error("âŒ AuthService: Token validation failed:",r),!1}}},Hb=()=>{var t;const e=zb();if(console.log(`[AUTH DEBUG] [${new Date().toISOString()}] Checking staff status update permission`),!e)return console.log(`[AUTH DEBUG] [${new Date().toISOString()}] Permission check failed: No user found`),!1;if(console.log(`[AUTH DEBUG] [${new Date().toISOString()}] User role: ${e.role}`),console.log(`[AUTH DEBUG] [${new Date().toISOString()}] Token present: ${!!localStorage.getItem("token")}`),localStorage.getItem("token")){const n=((t=localStorage.getItem("token"))==null?void 0:t.substring(0,15))+"...";console.log(`[AUTH DEBUG] [${new Date().toISOString()}] Token sample: ${n}`)}const r=e.role==="ADMIN"||e.role==="HR_MANAGER";return console.log(`[AUTH DEBUG] [${new Date().toISOString()}] Has permission: ${r}`),r};function Lf(e){let r=0;for(let t=0;t<e.length;t++){const n=e.charCodeAt(t);r=(r<<5)-r+n,r=r&r}return r.toString(36)}function zb(){const e=localStorage.getItem("user");if(!e)return null;try{return JSON.parse(e)}catch(r){return console.error(`[AUTH DEBUG] [${new Date().toISOString()}] Error parsing user JSON:`,r),null}}const sm=C.createContext(void 0),Gb=({children:e})=>{const[r,t]=C.useState(null),[n,a]=C.useState(!1),s=c=>{t(c),a(!0)},i=()=>{a(!1)};return o.jsxs(sm.Provider,{value:{showNotification:s},children:[e,r&&o.jsx(xu,{open:n,autoHideDuration:6e3,onClose:i,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:o.jsx(jr,{onClose:i,severity:r.type,variant:"filled",sx:{width:"100%"},children:r.message})})]})},sn=()=>{const e=C.useContext(sm);if(!e)throw new Error("useNotification must be used within a NotificationProvider");return e},Yb=10*60*1e3,ku=C.createContext(void 0),qb=({children:e})=>{const[r,t]=C.useState(null),[n,a]=C.useState(!1),[s,i]=C.useState(!1),c=so(),{showNotification:l}=sn(),u=C.useRef(null),d=C.useCallback(()=>{n&&(u.current&&window.clearTimeout(u.current),u.current=window.setTimeout(()=>{console.log("â° User session expired due to inactivity"),l({type:"warning",message:"You are being logged out due to inactivity"}),h()},Yb),console.log("â° Inactivity timer reset - will expire in 10 minutes if no activity"))},[n]);C.useEffect(()=>{if(n){d();const x=["mousedown","mousemove","keydown","scroll","touchstart"],p=()=>{d()};return x.forEach(m=>{document.addEventListener(m,p)}),()=>{u.current&&window.clearTimeout(u.current),x.forEach(m=>{document.removeEventListener(m,p)})}}},[n,d]),C.useEffect(()=>{const x=localStorage.getItem("token"),p=localStorage.getItem("user");if(x&&p)try{const m=JSON.parse(p);t(m),a(!0),console.log("âœ… User authenticated from localStorage:",{username:m.username,role:m.role})}catch(m){console.error("âŒ Error parsing user data from localStorage:",m),localStorage.removeItem("token"),localStorage.removeItem("user")}else console.log("â„¹ï¸ No authentication data found in localStorage")},[]);const f=async(x,p)=>{try{i(!0),console.log("ðŸ” AuthContext: Attempting login for user:",x);const m=await Jo.login({username:x,password:p});console.log("âœ… AuthContext: Raw login response:",m);const g=m.data?m.data:m;if(!g||!g.token&&!g.access_token)throw console.error("âŒ Invalid response format, missing token:",g),new Error("Invalid response from server. Missing authentication token.");const v=g.token||g.access_token,y={token:v,username:g.username||x,role:g.role||g.userRole||"USER"};console.log("âœ… Processed user data:",y),localStorage.setItem("token",v),localStorage.setItem("user",JSON.stringify(y)),t(y),a(!0),c("/dashboard"),d(),l({type:"success",message:"Login successful"})}catch(m){console.error("âŒ Login error in AuthContext:",m);let g="Login failed. Please check your credentials.";throw m&&typeof m=="object"&&"message"in m&&typeof m.message=="string"?g=m.message:m&&typeof m=="object"&&"response"in m&&m.response&&typeof m.response=="object"&&"data"in m.response&&m.response.data&&typeof m.response.data=="object"&&"message"in m.response.data&&typeof m.response.data.message=="string"&&(g=m.response.data.message),l({type:"error",message:g}),m}finally{i(!1)}},h=()=>{u.current&&(window.clearTimeout(u.current),u.current=null),localStorage.removeItem("token"),localStorage.removeItem("user"),t(null),a(!1),c("/login"),l({type:"info",message:"You have been logged out"})};return o.jsx(ku.Provider,{value:{user:r,login:f,logout:h,isAuthenticated:n,resetInactivityTimer:d,loading:s},children:e})},kn=()=>{const e=C.useContext(ku);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e},Ba=class Ba{constructor(r="/actuator/health",t=6e4){Ne(this,"statusUrl");Ne(this,"pollingInterval");Ne(this,"statusListeners",[]);Ne(this,"currentStatus",{status:"UNKNOWN",message:"Checking server status..."});Ne(this,"pollingTimerId",null);this.statusUrl=r,this.pollingInterval=t}static getInstance(){return Ba.instance||(Ba.instance=new Ba),Ba.instance}startPolling(){this.pollingTimerId||(this.checkServerStatus(),this.pollingTimerId=setInterval(()=>{this.checkServerStatus()},this.pollingInterval))}stopPolling(){this.pollingTimerId&&(clearInterval(this.pollingTimerId),this.pollingTimerId=null)}addStatusListener(r){return this.statusListeners.push(r),r(this.currentStatus),()=>{this.statusListeners=this.statusListeners.filter(t=>t!==r)}}async checkServerStatus(){try{const r=await fetch(this.statusUrl);if(r.ok){const t=r.headers.get("content-type");if(!t||!t.includes("application/json")){console.warn("Server returned non-JSON response:",t),this.updateStatus({status:"ONLINE",message:"Server is online but returned non-JSON response",details:{contentType:t}});return}try{const n=await r.json();n.status==="UP"?this.updateStatus({status:"ONLINE",message:"Server is online",details:n}):(console.warn(`Server status degraded: ${n.status}`,n),this.updateStatus({status:"DEGRADED",message:`Server is experiencing issues: ${n.status}`,details:n}))}catch(n){console.warn("Error parsing JSON response:",n),this.updateStatus({status:"ONLINE",message:"Server is online but returned invalid JSON",error:n})}}else console.error(`Server error: ${r.status} ${r.statusText}`),this.updateStatus({status:"ERROR",message:`Server error: ${r.status} ${r.statusText}`})}catch(r){console.error("Cannot connect to server:",r),this.updateStatus({status:"OFFLINE",message:"Cannot connect to server",error:r}),console.log(`Connectivity issue logged at: ${new Date().toLocaleString()}`)}}updateStatus(r){const t=this.currentStatus.status;t!==r.status&&console.log(`Server status changed from ${t} to ${r.status}`),this.currentStatus=r,this.notifyListeners()}notifyListeners(){this.statusListeners.forEach(r=>{r(this.currentStatus)})}};Ne(Ba,"instance");let Wl=Ba;function Xb(){const[e,r]=C.useState({status:"UNKNOWN",message:"Initializing..."});return C.useEffect(()=>{const t=Wl.getInstance(),n=t.addStatusListener(r);return t.startPolling(),()=>{n(),t.stopPolling()}},[]),e}var Au={},ol={};const Kb=Zv(yv);var Bf;function _t(){return Bf||(Bf=1,function(e){"use client";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"default",{enumerable:!0,get:function(){return r.createSvgIcon}});var r=Kb}(ol)),ol}var Jb=At;Object.defineProperty(Au,"__esModule",{value:!0});var Cu=Au.default=void 0,Qb=Jb(_t()),Zb=o;Cu=Au.default=(0,Qb.default)((0,Zb.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"}),"CheckCircle");const $f=()=>{const e=Xb();return C.useEffect(()=>{e.status!=="ONLINE"&&(console.log(`Server Status: ${e.status}`),e.message&&console.log(`Message: ${e.message}`),e.details&&console.log("Details:",e.details),e.error&&console.error("Server connection error:",e.error))},[e]),e.status!=="ONLINE"?null:o.jsx(at,{title:"Server is connected",arrow:!0,placement:"bottom-end",children:o.jsxs(Se,{sx:{display:"flex",alignItems:"center",gap:1,padding:"4px 8px",borderRadius:1,bgcolor:"background.paper",border:1,borderColor:"success.main"},children:[o.jsx(Cu,{sx:{color:"success.main"}}),o.jsx(te,{variant:"caption",color:"success.main",sx:{fontWeight:"medium"},children:"Connected"})]})})},So=240,Zt={ADMIN:"ADMIN",TEACHER:"TEACHER",STAFF:"STAFF",PARENT:"PARENT",STUDENT:"STUDENT"},ew=[{text:"Dashboard",icon:o.jsx(Tv,{}),path:"/",allowedRoles:[Zt.ADMIN,Zt.TEACHER,Zt.STAFF,Zt.PARENT,Zt.STUDENT]},{text:"Admissions",icon:o.jsx(kv,{}),path:"/admissions",allowedRoles:[Zt.ADMIN,Zt.STAFF]},{text:"Students",icon:o.jsx(Hs,{}),path:"/students",allowedRoles:[Zt.ADMIN,Zt.TEACHER,Zt.STAFF]},{text:"Staff",icon:o.jsx(Hs,{}),path:"/staff",allowedRoles:[Zt.ADMIN]},{text:"Courses",icon:o.jsx(Bi,{}),path:"/courses",allowedRoles:[Zt.ADMIN,Zt.TEACHER,Zt.STAFF]},{text:"Fee Management",icon:o.jsx(Av,{}),path:"/fees",allowedRoles:[Zt.ADMIN]},{text:"Reports",icon:o.jsx(Cv,{}),path:"/reports",allowedRoles:[Zt.ADMIN,Zt.TEACHER,Zt.STAFF]}],ka=({children:e})=>{const[r,t]=C.useState(!1),[n,a]=C.useState(null),s=so(),{user:i,logout:c}=kn(),l=()=>{t(!r)},u=p=>{a(p.currentTarget)},d=()=>{a(null)},f=()=>{d(),c()},h=ew.filter(p=>i&&i.role&&p.allowedRoles.includes(i.role)),x=o.jsxs("div",{children:[o.jsx(rl,{}),o.jsx(Ga,{children:h.map(p=>o.jsxs(Ya,{button:!0,onClick:()=>{s(p.path),t(!1)},sx:{"&:hover":{backgroundColor:"rgba(0, 0, 0, 0.04)"}},children:[o.jsx(Li,{children:p.icon}),o.jsx(qa,{primary:p.text})]},p.text))})]});return o.jsxs(Se,{sx:{display:"flex",width:"100%",height:"100vh",overflow:"hidden"},children:[o.jsx(xp,{}),o.jsx(bv,{position:"fixed",sx:{zIndex:p=>p.zIndex.drawer+1,width:"100%"},children:o.jsxs(rl,{children:[o.jsx(Ze,{color:"inherit",edge:"start",onClick:l,sx:{mr:2,display:{sm:"none"}},children:o.jsx(wv,{})}),o.jsxs(te,{variant:"h6",noWrap:!0,component:"div",sx:{flexGrow:1,display:"flex",alignItems:"center",fontSize:{xs:"1rem",sm:"1.25rem"}},children:["School Management System",o.jsx(at,{title:"Server connection status",children:o.jsx(Se,{sx:{ml:2,display:{xs:"none",sm:"flex"}},children:o.jsx($f,{})})})]}),o.jsxs(Se,{sx:{display:"flex",alignItems:"center"},children:[o.jsx(Se,{sx:{mr:2,display:{xs:"flex",sm:"none"}},children:o.jsx($f,{})}),i&&o.jsxs(o.Fragment,{children:[o.jsx(Yt,{label:i.role,color:"secondary",size:"small",sx:{mr:2,display:{xs:"none",sm:"flex"}}}),o.jsx(te,{variant:"body1",sx:{mr:2,display:{xs:"none",sm:"block"},maxWidth:"150px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:i.username||i.email})]}),o.jsx(Ze,{color:"inherit",onClick:u,edge:"end",children:o.jsx(gp,{sx:{width:32,height:32},children:o.jsx(Sv,{})})})]})]})}),o.jsx(vp,{anchorEl:n,open:!!n,onClose:d,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:o.jsxs(Xe,{onClick:f,children:[o.jsx(Li,{children:o.jsx(Ev,{fontSize:"small"})}),o.jsx(qa,{primary:"Logout"})]})}),o.jsx(pf,{variant:"temporary",open:r,onClose:l,ModalProps:{keepMounted:!0},sx:{display:{xs:"block",sm:"none"},"& .MuiDrawer-paper":{boxSizing:"border-box",width:So,backgroundColor:"background.paper"}},children:x}),o.jsx(pf,{variant:"permanent",sx:{display:{xs:"none",sm:"block"},width:So,flexShrink:0,"& .MuiDrawer-paper":{width:So,boxSizing:"border-box",position:"relative",height:"100%",backgroundColor:"background.paper"}},open:!0,children:x}),o.jsxs(Se,{component:"main",sx:{flexGrow:1,p:3,width:{xs:"100%",sm:`calc(100% - ${So}px)`},mt:{xs:8,sm:0},height:"100%",overflow:"auto"},children:[o.jsx(rl,{})," ",e]})]})},ks=({children:e,allowedRoles:r})=>{const{user:t,isAuthenticated:n}=kn(),{showNotification:a}=sn();return C.useEffect(()=>{console.log("ðŸ”’ RoleBasedRoute checking access for path:",window.location.pathname),console.log("ðŸ‘¤ User role:",t==null?void 0:t.role),console.log("âœ… Allowed roles:",r),console.log("ðŸ”‘ Access granted:",t&&t.role&&r.includes(t.role));const i=localStorage.getItem("token");if(i)try{const c=JSON.parse(atob(i.split(".")[1]));console.log("ðŸ” Token payload:",{exp:new Date(c.exp*1e3).toLocaleString(),roles:c.roles||c.authorities||c.role||"Not found in token",username:c.sub||c.username||"Not found in token"})}catch(c){console.error("Error parsing token:",c)}else console.warn("âš ï¸ No token available for role verification")},[t,r]),n?t?t.role&&r.some(i=>t.role.toUpperCase()===i.toUpperCase())?(console.log("âœ… Access granted to:",window.location.pathname),o.jsx(o.Fragment,{children:e})):(console.error(`âŒ Access denied: User role "${t.role||"unknown"}" not in allowed roles:`,r),a({type:"error",message:"Access denied: You do not have permission to view this page"}),o.jsx(Bo,{to:"/"})):(console.error("âŒ User object is null or undefined"),a({type:"error",message:"Authentication error: User data is missing"}),o.jsx(Bo,{to:"/login"})):(console.warn("âš ï¸ User not authenticated, redirecting to login"),o.jsx(Bo,{to:"/login"}))},As=e=>{let r="",t="";if(e&&e.name){const s=e.name.split(" ");r=s[0]||"",t=s.length>1?s.slice(1).join(" "):""}let n;try{if(e.dateOfBirth)if(/^\d{4}-\d{2}-\d{2}$/.test(e.dateOfBirth))n=e.dateOfBirth;else{const s=e.dateOfBirth.split(/[-/\.]/);let i;s.length===3?(s[0].length===4?i=new Date(`${s[0]}-${s[1]}-${s[2]}`):(i=new Date(`${s[2]}-${s[0]}-${s[1]}`),isNaN(i.getTime())&&(i=new Date(`${s[2]}-${s[1]}-${s[0]}`))),isNaN(i.getTime())?(console.warn(`Invalid date format "${e.dateOfBirth}" for student ${e.name||e.studentId}, using current date`),n=new Date().toISOString().split("T")[0]):n=i.toISOString().split("T")[0]):(i=new Date(e.dateOfBirth),isNaN(i.getTime())?(console.warn(`Invalid date format "${e.dateOfBirth}" for student ${e.name||e.studentId}, using current date`),n=new Date().toISOString().split("T")[0]):n=i.toISOString().split("T")[0])}else n=new Date().toISOString().split("T")[0]}catch(s){console.warn(`Error parsing date ${e.dateOfBirth} for student ${e.name||e.studentId}: ${s==null?void 0:s.message}`),n=new Date().toISOString().split("T")[0]}const a=parseInt(e.grade||"0",10);return{id:e.id,studentId:e.studentId||`ST${Date.now().toString().slice(-6)}`,firstName:r||"First",lastName:t||"Last",grade:isNaN(a)?1:a,section:e.section||"A",email:e.email||`student${Date.now()}@example.com`,contactNumber:e.phoneNumber||e.parentPhone||"0000000000",dateOfBirth:n,status:e.status||"ACTIVE",address:e.address||"Address not provided",guardianName:e.parentName||"Guardian",guardianContact:e.parentPhone||"0000000000",guardianEmail:e.parentEmail||e.email||"",guardianOccupation:e.guardianOccupation||"",guardianOfficeAddress:e.guardianOfficeAddress||"",aadharNumber:e.aadharNumber||"",udiseNumber:e.udiseNumber||"",houseAlloted:e.houseAlloted||"",guardianAnnualIncome:parseFloat(e.guardianAnnualIncome||"0")||0,previousSchool:e.previousSchool||"",tcNumber:e.tcNumber||"",tcReason:e.tcReason||"",tcDate:e.tcDate||"",whatsappNumber:e.whatsappNumber||"",subjects:e.subjects||"",transportMode:e.transportMode||"",busRouteNumber:e.busRouteNumber||"",admissionDate:e.admissionDate||new Date().toISOString().split("T")[0],bloodGroup:e.bloodGroup||"",gender:e.gender&&["MALE","FEMALE","OTHER"].includes(e.gender.toUpperCase())?e.gender.toUpperCase():"MALE",medicalConditions:e.medicalConditions||""}},$r=e=>{var r;return{id:e.id,studentId:e.studentId,name:`${e.firstName} ${e.lastName}`.trim(),grade:e.grade.toString(),section:e.section,email:e.email,phoneNumber:e.contactNumber,dateOfBirth:e.dateOfBirth,status:e.status,address:e.address,parentName:e.guardianName,parentPhone:e.guardianContact,parentEmail:e.guardianEmail,guardianOccupation:e.guardianOccupation,guardianOfficeAddress:e.guardianOfficeAddress,aadharNumber:e.aadharNumber,udiseNumber:e.udiseNumber,houseAlloted:e.houseAlloted,guardianAnnualIncome:(r=e.guardianAnnualIncome)==null?void 0:r.toString(),previousSchool:e.previousSchool,tcNumber:e.tcNumber,tcReason:e.tcReason,tcDate:e.tcDate,whatsappNumber:e.whatsappNumber,subjects:e.subjects,transportMode:e.transportMode,busRouteNumber:e.busRouteNumber,admissionDate:e.admissionDate,bloodGroup:e.bloodGroup,gender:e.gender,medicalConditions:e.medicalConditions}};async function cl(e,r,t){const n=JSON.parse(localStorage.getItem("user")||sessionStorage.getItem("user")||"{}");if(n&&n.role==="ADMIN"){const i=localStorage.getItem("token")||sessionStorage.getItem("token");if(i)try{return await qn({method:e,url:`${wt.apiUrl}${r}`,data:t,headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`}})}catch(c){throw console.error("Error with admin token:",c),c}}const s=localStorage.getItem("adminToken")||sessionStorage.getItem("adminToken");if(s)try{return await qn({method:e,url:`${wt.apiUrl}${r}`,data:t,headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`}})}catch(i){throw console.error(`Error with admin token: ${i}`),sessionStorage.removeItem("adminToken"),localStorage.removeItem("adminToken"),new Error("Admin session expired. Please try again.")}else{const i=prompt("Admin username required for this action:"),c=prompt("Admin password required for this action:");if(!i||!c)throw new Error("Admin credentials required for this operation");try{const l=await qn.post(`${wt.apiUrl}/api/auth/admin-login`,{username:i,password:c});if(l.data&&l.data.token)return sessionStorage.setItem("adminToken",l.data.token),await qn({method:e,url:`${wt.apiUrl}${r}`,data:t,headers:{"Content-Type":"application/json",Authorization:`Bearer ${l.data.token}`}})}catch(l){throw console.error("Admin authentication failed:",l),new Error("Admin authentication failed. Please try again with correct credentials.")}}}const rn={getAll:async()=>(await De.get("/api/students")).map($r),getAllStudents:async()=>(await De.get("/api/students")).map($r),getById:async e=>{const r=await De.get(`/api/students/${e}`);return $r(r)},create:async e=>{const r=As(e),t=await De.post("/api/students",r);return $r(t)},update:async(e,r)=>{const t=As({...r,id:e}),n=await De.put(`/api/students/${e}`,t);return $r(n)},updateStatus:async(e,r)=>{try{console.log(`Updating student ${e} status to: ${r}`);const n={...await De.get(`/api/students/${e}`),status:r},a=await De.put(`/api/students/${e}`,n);return $r(a)}catch(t){throw console.error("Error updating student status:",t),t}},delete:async e=>{try{return console.log(`Deleting student with ID: ${e}`),await De.delete(`/api/students/${e}`),{success:!0,message:"Student deleted successfully"}}catch(r){throw console.error("Error deleting student:",r),r}},getByGrade:async e=>(await De.get(`/api/students/grade/${e}`)).map($r),getByStatus:async e=>(await De.get(`/api/students/status/${e}`)).map($r),search:async e=>(await De.get(`/api/students/search?query=${e}`)).map($r),createWithElevatedPermissions:async e=>{const r=As(e),t=await cl("post","/api/students",r);return t!=null&&t.data?$r(t.data):null},updateWithElevatedPermissions:async(e,r)=>{const t=As({...r,id:e}),n=await cl("put",`/api/students/${e}`,t);return n!=null&&n.data?$r(n.data):null},createBulk:async e=>{const r=e.map(As);return(await De.post("/api/students/bulk",{students:r,expectedCount:e.length})).map($r)},createBulkWithElevatedPermissions:async e=>{const r=e.map(As),t=await cl("post","/api/students/bulk",{students:r,expectedCount:e.length});return t!=null&&t.data?t.data.map($r):[]}},_u={getAll:()=>De.get("/staff"),getById:e=>De.get(`/staff/${e}`),create:e=>De.post("/staff",e),update:(e,r)=>De.put(`/staff/${e}`,r),delete:e=>De.delete(`/staff/${e}`),getAllTeachers:()=>De.get("/staff"),createTeacher:e=>De.post("/staff",e),updateTeacher:(e,r)=>De.put(`/staff/${e}`,r),deleteTeacher:e=>De.delete(`/staff/${e}`)},Ps={getAll:()=>De.get("courses"),getById:e=>De.get(`courses/${e}`),create:e=>De.post("courses",e),update:(e,r)=>De.put(`courses/${e}`,r),delete:e=>De.delete(`courses/${e}`),enrollStudent:(e,r)=>De.post(`courses/${e}/enroll`,{studentId:r}),unenrollStudent:(e,r)=>De.delete(`courses/${e}/enroll?studentId=${r}`),getAllCourses:()=>De.get("courses")},Rn=({message:e="Loading...",size:r})=>o.jsxs(Se,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:2,minHeight:r?"auto":200},children:[o.jsx(ta,{size:r}),!r&&o.jsx(te,{variant:"body1",color:"text.secondary",children:e})]}),Ln=({error:e,message:r,title:t,resetError:n,onRetry:a,className:s=""})=>{const[i,c]=C.useState(0),[l,u]=C.useState(!1),[d,f]=C.useState("unknown");if(r)return o.jsxs("div",{className:`error-message ${s}`,children:[t&&o.jsx("h4",{children:t}),o.jsx("p",{children:r})]});const h=(e==null?void 0:e.status)==="network_error",x=h&&!(e!=null&&e.isOffline),p=()=>e?typeof e=="string"?e:e.message?e.message:h?e.isOffline?"Your device appears to be offline. Please check your internet connection.":"Cannot connect to server. Please check if the backend server is running.":"An unexpected error occurred.":"",m=async()=>{if(!a&&!n)return;u(!0),c(3);const g=setInterval(()=>{c(v=>v<=1?(clearInterval(g),0):v-1)},1e3);setTimeout(async()=>{if(a)try{await a()}catch(v){console.error("Retry failed:",v)}else n&&n();u(!1)},3e3)};return C.useEffect(()=>{x&&wt.fallbackApiUrl&&(async()=>{try{await qn.get(`${wt.fallbackApiUrl}/api/health`),f("available")}catch{f("unavailable")}})()},[x]),e?o.jsxs("div",{className:`bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative ${s}`,role:"alert",children:[o.jsx("strong",{className:"font-bold",children:"Error: "}),o.jsx("span",{className:"block sm:inline",children:p()}),h&&o.jsxs("div",{className:"mt-3",children:[e.isOffline?o.jsx("p",{className:"text-sm",children:"Your browser reports that you are currently offline. Please check your internet connection and try again."}):o.jsxs("div",{children:[o.jsx("p",{className:"text-sm mb-2",children:"The application cannot reach the server. This could be due to:"}),o.jsxs("ul",{className:"list-disc pl-5 text-sm mb-3",children:[o.jsx("li",{children:"The server is not running"}),o.jsx("li",{children:"There's a network issue between your browser and the server"}),o.jsx("li",{children:"A firewall is blocking the connection"}),o.jsx("li",{children:"The server URL is incorrect"})]}),d!=="unknown"&&o.jsxs("div",{className:"text-sm mb-3",children:[o.jsxs("p",{children:["Backup server status: "," ",d==="available"?o.jsx("span",{className:"text-green-600 font-semibold",children:"Available"}):o.jsx("span",{className:"text-red-600 font-semibold",children:"Unavailable"})]}),d==="available"&&o.jsx("p",{className:"mt-1",children:"The system will automatically try to use the backup server for your requests."})]})]}),n&&o.jsx("button",{onClick:m,disabled:l,className:`mt-2 px-4 py-2 rounded text-white ${l?"bg-gray-400 cursor-not-allowed":"bg-blue-500 hover:bg-blue-600"}`,children:l?`Retrying in ${i}s...`:"Retry Request"})]}),!h&&e.originalError&&o.jsxs("details",{className:"mt-3 text-sm",children:[o.jsx("summary",{className:"cursor-pointer text-gray-600",children:"View technical details"}),o.jsx("pre",{className:"mt-2 bg-gray-100 p-2 rounded overflow-auto max-h-40 text-xs",children:JSON.stringify(e.originalError,null,2)})]})]}):null},je={ADMIN:"ADMIN",TEACHER:"TEACHER",STAFF:"STAFF",PARENT:"PARENT",STUDENT:"STUDENT"},tw={CREATE_STUDENT:[je.ADMIN,je.STAFF],EDIT_STUDENT:[je.ADMIN,je.STAFF],DELETE_STUDENT:[je.ADMIN],VIEW_STUDENT:[je.ADMIN,je.TEACHER,je.STAFF,je.PARENT,je.STUDENT],CREATE_TEACHER:[je.ADMIN],EDIT_TEACHER:[je.ADMIN],DELETE_TEACHER:[je.ADMIN],VIEW_TEACHER:[je.ADMIN,je.STAFF,je.STUDENT],MANAGE_STAFF:[je.ADMIN],CREATE_COURSE:[je.ADMIN,je.STAFF],EDIT_COURSE:[je.ADMIN,je.STAFF],DELETE_COURSE:[je.ADMIN],VIEW_COURSE:[je.ADMIN,je.TEACHER,je.STAFF,je.STUDENT],MANAGE_ENROLLMENTS:[je.ADMIN,je.STAFF],VIEW_ENROLLMENTS:[je.ADMIN,je.STAFF,je.TEACHER],MANAGE_ASSIGNMENTS:[je.ADMIN,je.TEACHER],MANAGE_SCHEDULE:[je.ADMIN,je.STAFF],MANAGE_ATTENDANCE:[je.ADMIN,je.TEACHER],VIEW_ATTENDANCE:[je.ADMIN,je.TEACHER,je.STAFF,je.PARENT,je.STUDENT],MANAGE_EXAMS:[je.ADMIN,je.TEACHER],VIEW_EXAM_RESULTS:[je.ADMIN,je.TEACHER,je.STAFF,je.PARENT,je.STUDENT],MANAGE_GRADES:[je.ADMIN,je.TEACHER],MANAGE_FEES:[je.ADMIN,je.STAFF],VIEW_FEES:[je.ADMIN,je.STAFF,je.PARENT,je.STUDENT],MANAGE_ADMISSIONS:[je.ADMIN,je.STAFF],VIEW_ADMISSIONS:[je.ADMIN,je.STAFF],SEND_MESSAGE:[je.ADMIN,je.TEACHER,je.STAFF],VIEW_MESSAGE:[je.ADMIN,je.TEACHER,je.STAFF,je.PARENT,je.STUDENT],VIEW_ADMIN_DASHBOARD:[je.ADMIN,je.STAFF],VIEW_TEACHER_DASHBOARD:[je.TEACHER],VIEW_STUDENT_DASHBOARD:[je.STUDENT],VIEW_PARENT_DASHBOARD:[je.PARENT]},rr=(e,r)=>{if(!e||!r)return!1;const t=tw[r]||[];return Object.values(je).includes(e)?t.includes(e):!1},Uf=(e,r)=>!r||!Array.isArray(r)?!1:r.some(t=>rr(e,t)),Vf=(e,r)=>!r||!Array.isArray(r)?!1:r.every(t=>rr(e,t)),In=({title:e,value:r,icon:t,color:n,onClick:a})=>o.jsxs(Ja,{sx:{height:"100%",display:"flex",flexDirection:"column",cursor:a?"pointer":"default",transition:"transform 0.2s","&:hover":a?{transform:"translateY(-4px)",boxShadow:4}:{}},onClick:a,children:[o.jsxs(Qa,{sx:{flexGrow:1},children:[o.jsxs(Se,{sx:{display:"flex",alignItems:"center",mb:2},children:[o.jsx(t,{sx:{color:n}}),o.jsx(te,{variant:"h6",component:"div",sx:{ml:1},children:e})]}),o.jsx(te,{variant:"h4",color:n,children:r})]}),a&&o.jsx(Fv,{children:o.jsx(Me,{size:"small",endIcon:o.jsx(Iv,{}),children:"View Details"})})]}),rw=()=>{const e=so(),{user:r}=kn(),{showNotification:t}=sn(),[n,a]=C.useState({studentInfo:null,enrolledCourses:[],upcomingAssignments:[],attendance:{present:0,absent:0,late:0,percentage:0}}),[s,i]=C.useState(!0),[c,l]=C.useState(null),u=async()=>{try{i(!0),l(null);const d=r==null?void 0:r.id;if(!d)throw new Error("User ID not found");const[f,h,x,p]=await Promise.all([De.get(`/students/${d}`),De.get(`/students/${d}/courses`),De.get(`/students/${d}/assignments`),De.get(`/students/${d}/attendance`)]);a({studentInfo:f||null,enrolledCourses:Array.isArray(h)?h:[],upcomingAssignments:Array.isArray(x)?x:[],attendance:p||{present:0,absent:0,late:0,percentage:0}})}catch(d){console.error("Error loading student dashboard data:",d),l("Failed to load student data from database. Please ensure the backend server is running."),t({type:"error",message:"Failed to load your dashboard data from database. Please try again later."})}finally{i(!1)}};return C.useEffect(()=>{u();const d=setInterval(u,5*60*1e3);return()=>clearInterval(d)},[]),s?o.jsx(Rn,{message:"Loading your dashboard..."}):c?o.jsx(Ln,{message:c,onRetry:u}):o.jsxs(Se,{children:[o.jsxs(te,{variant:"h4",sx:{mb:4},children:["Student Dashboard",r&&o.jsxs(te,{variant:"subtitle1",color:"text.secondary",children:["Welcome, ",r.name||r.email]})]}),o.jsxs(X,{container:!0,spacing:3,children:[o.jsx(X,{item:!0,xs:12,sm:6,md:3,children:o.jsx(In,{title:"Enrolled Courses",value:n.enrolledCourses.length,icon:Bi,color:"primary.main",onClick:()=>e("/courses")})}),o.jsx(X,{item:!0,xs:12,sm:6,md:3,children:o.jsx(In,{title:"Upcoming Assignments",value:n.upcomingAssignments.length,icon:Yo,color:"secondary.main"})}),o.jsx(X,{item:!0,xs:12,sm:6,md:3,children:o.jsx(In,{title:"Attendance Rate",value:`${n.attendance.percentage}%`,icon:_v,color:"success.main"})}),o.jsx(X,{item:!0,xs:12,sm:6,md:3,children:o.jsx(In,{title:"GPA",value:"3.5",icon:Xa,color:"info.main"})}),o.jsx(X,{item:!0,xs:12,md:6,children:o.jsxs(st,{sx:{p:2,height:"100%"},children:[o.jsx(te,{variant:"h6",gutterBottom:!0,children:"Your Courses"}),o.jsx(Ga,{children:n.enrolledCourses.map((d,f)=>o.jsxs(Mn.Fragment,{children:[f>0&&o.jsx(vr,{}),o.jsxs(Ya,{children:[o.jsx(Li,{children:o.jsx(Bi,{color:"primary"})}),o.jsx(qa,{primary:d.name,secondary:o.jsxs(o.Fragment,{children:[d.teacher," â€¢ ",d.schedule,d.grade&&o.jsxs(te,{component:"span",color:"text.secondary",children:[" â€¢ Grade: ",o.jsx(te,{component:"span",color:"primary.main",fontWeight:"bold",children:d.grade})]})]})})]})]},d.id))}),o.jsx(Se,{sx:{mt:2,display:"flex",justifyContent:"flex-end"},children:o.jsx(Me,{size:"small",color:"primary",onClick:()=>e("/courses"),children:"View All Courses"})})]})}),o.jsx(X,{item:!0,xs:12,md:6,children:o.jsxs(st,{sx:{p:2,height:"100%"},children:[o.jsx(te,{variant:"h6",gutterBottom:!0,children:"Upcoming Assignments"}),o.jsx(Ga,{children:n.upcomingAssignments.map((d,f)=>o.jsxs(Mn.Fragment,{children:[f>0&&o.jsx(vr,{}),o.jsxs(Ya,{children:[o.jsx(Li,{children:o.jsx(Yo,{color:"secondary"})}),o.jsx(qa,{primary:d.title,secondary:o.jsxs(o.Fragment,{children:["Due: ",d.dueDate," â€¢ ",d.course]})})]})]},d.id))})]})}),o.jsx(X,{item:!0,xs:12,children:o.jsxs(st,{sx:{p:2},children:[o.jsx(te,{variant:"h6",gutterBottom:!0,children:"Attendance Summary"}),o.jsxs(X,{container:!0,spacing:3,sx:{mt:1},children:[o.jsx(X,{item:!0,xs:12,sm:4,children:o.jsxs(Se,{sx:{textAlign:"center",p:2},children:[o.jsx(te,{variant:"h2",color:"primary.main",children:n.attendance.present}),o.jsx(te,{variant:"body1",children:"Days Present"})]})}),o.jsx(X,{item:!0,xs:6,sm:4,children:o.jsxs(Se,{sx:{textAlign:"center",p:2},children:[o.jsx(te,{variant:"h2",color:"error.main",children:n.attendance.absent}),o.jsx(te,{variant:"body1",children:"Days Absent"})]})}),o.jsx(X,{item:!0,xs:6,sm:4,children:o.jsxs(Se,{sx:{textAlign:"center",p:2},children:[o.jsx(te,{variant:"h2",color:"warning.main",children:n.attendance.late}),o.jsx(te,{variant:"body1",children:"Days Late"})]})})]})]})})]})]})},Wf=()=>{const e=so(),{showNotification:r}=sn(),[t,n]=C.useState({totalStudents:0,totalTeachers:0,totalCourses:0,activeEnrollments:0,averageClassSize:0,coursesAtCapacity:0,recentActivity:[]}),[a,s]=C.useState(!0),[i,c]=C.useState(null),l=async()=>{try{s(!0),c(null);const[u,d,f]=await Promise.all([rn.getAll(),_u.getAll(),Ps.getAll()]),h=Array.isArray(u)?u:[],x=Array.isArray(d)?d:[],p=Array.isArray(f)?f:[],m=p.reduce((b,S)=>b+(S.enrolled||0),0),g=p.length>0?m/p.length:0,v=p.filter(b=>(b.enrolled||0)>=(b.capacity||30)).length,y=[...p.slice(0,3).map(b=>({id:b.id,type:"course",description:`Course ${b.name} has ${(b.capacity||30)-(b.enrolled||0)} seats remaining`,timestamp:new Date().toISOString()})),...h.slice(0,3).map(b=>({id:b.id,type:"student",description:`Student ${b.name} - Grade ${b.grade||"N/A"}`,timestamp:new Date(Date.now()-36e5).toISOString()}))].sort((b,S)=>new Date(S.timestamp).getTime()-new Date(b.timestamp).getTime());n({totalStudents:h.length,totalTeachers:x.length,totalCourses:p.length,activeEnrollments:m,averageClassSize:Math.round(g*10)/10,coursesAtCapacity:v,recentActivity:y})}catch(u){console.error("Error loading dashboard stats:",u),c("Failed to load dashboard statistics. Please ensure the backend server is running and the database is properly configured."),r({type:"error",message:"Failed to load dashboard statistics from database. Please check your server connection."})}finally{s(!1)}};return C.useEffect(()=>{l();const u=setInterval(l,5*60*1e3);return()=>clearInterval(u)},[]),a?o.jsx(Rn,{message:"Loading dashboard statistics..."}):i?o.jsx(Ln,{message:i,onRetry:l}):o.jsxs(Se,{children:[o.jsx(te,{variant:"h4",sx:{mb:4},children:"Admin Dashboard"}),o.jsxs(X,{container:!0,spacing:3,children:[o.jsx(X,{item:!0,xs:12,sm:6,md:3,children:o.jsx(In,{title:"Total Students",value:t.totalStudents,icon:Hs,color:"primary.main",onClick:()=>e("/students")})}),o.jsx(X,{item:!0,xs:12,sm:6,md:3,children:o.jsx(In,{title:"Total Teachers",value:t.totalTeachers,icon:Xa,color:"secondary.main",onClick:()=>e("/teachers")})}),o.jsx(X,{item:!0,xs:12,sm:6,md:3,children:o.jsx(In,{title:"Total Courses",value:t.totalCourses,icon:Bi,color:"success.main",onClick:()=>e("/courses")})}),o.jsx(X,{item:!0,xs:12,sm:6,md:3,children:o.jsx(In,{title:"Active Enrollments",value:t.activeEnrollments,icon:mf,color:"info.main"})}),o.jsx(X,{item:!0,xs:12,sm:6,md:3,children:o.jsx(In,{title:"Average Class Size",value:t.averageClassSize,icon:mf,color:"warning.main"})}),o.jsx(X,{item:!0,xs:12,sm:6,md:3,children:o.jsx(In,{title:"Courses at Capacity",value:t.coursesAtCapacity,icon:Dv,color:"error.main",onClick:()=>e("/courses")})}),o.jsx(X,{item:!0,xs:12,children:o.jsxs(st,{sx:{p:2,mt:2},children:[o.jsxs(Se,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[o.jsx(te,{variant:"h6",children:"Recent Activity"}),o.jsx(Me,{size:"small",startIcon:o.jsx(Ka,{}),onClick:l,children:"Refresh"})]}),o.jsx(Ga,{children:t.recentActivity.map((u,d)=>o.jsxs(Mn.Fragment,{children:[d>0&&o.jsx(vr,{}),o.jsxs(Ya,{children:[o.jsxs(Li,{children:[u.type==="enrollment"&&o.jsx(Hs,{color:"primary"}),u.type==="course"&&o.jsx(Bi,{color:"secondary"}),u.type==="student"&&o.jsx(Xa,{color:"success"}),u.type==="teacher"&&o.jsx(yp,{color:"info"})]}),o.jsx(qa,{primary:u.description,secondary:new Date(u.timestamp).toLocaleString()})]})]},u.id||d))})]})})]})]})},nw=()=>{const{user:e}=kn();return e&&e.role===je.STUDENT?o.jsx(rw,{}):e&&e.role===je.TEACHER?o.jsx(Wf,{}):e&&(e.role===je.ADMIN||e.role===je.STAFF)?o.jsx(Wf,{}):o.jsxs(Se,{sx:{textAlign:"center",py:5},children:[o.jsx(te,{variant:"h5",color:"text.secondary",children:"Dashboard not available for your role."}),o.jsx(te,{variant:"body1",sx:{mt:2},children:"Please contact the system administrator if you believe this is an error."})]})},im=e=>{var r;if(e.isAxiosError){const t=e;if(!t.response)return"Network error. Please check your connection.";const n=t.response.status,a=(r=t.response.data)==null?void 0:r.message;switch(n){case 400:return a||"Invalid request. Please check your input.";case 401:return"Authentication required. Please log in.";case 403:return"You do not have permission to perform this action.";case 404:return a||"Resource not found.";case 409:return a||"Conflict with existing data.";case 422:return a||"Invalid input data.";case 500:return"Internal server error. Please try again later.";default:return a||"An unexpected error occurred."}}return e instanceof Error?e.message:"An unexpected error occurred."},ll=new Map,aw=5*60*1e3;function Nn(e,r={}){const[t,n]=C.useState(null),[a,s]=C.useState(!0),[i,c]=C.useState(null),{showNotification:l}=sn(),{cacheKey:u,cacheDuration:d=aw,onSuccess:f,onError:h,showErrorNotification:x=!0,dependencies:p=[],skip:m=!1}=r;C.useEffect(()=>{m?s(!1):g()},[...p]);const g=async(b=!1)=>{if(!m){if(u&&!b){const S=ll.get(u);if(S&&Date.now()-S.timestamp<d){n(S.data),s(!1);return}}try{s(!0),c(null);const S=await e();n(S),u&&ll.set(u,{data:S,timestamp:Date.now()}),f==null||f(S)}catch(S){const I=im(S);c(I),h==null||h(S),x&&l({type:"error",message:I})}finally{s(!1)}}};return C.useEffect(()=>{p.length===0&&!m&&g()},[]),{data:t,loading:a,error:i,refresh:()=>g(!0),refetch:()=>g(!0),clearCache:()=>u&&ll.delete(u)}}function Pr(e,r={}){const[t,n]=C.useState(!1),[a,s]=C.useState(null),{showNotification:i}=sn(),{onSuccess:c,onError:l,showErrorNotification:u=!0}=r;return{mutate:async f=>{try{n(!0),s(null);const h=await e(f);return c==null||c(h),h}catch(h){const x=im(h);throw s(x),l==null||l(h),u&&i({type:"error",message:x}),h}finally{n(!1)}},loading:t,error:a}}function _c({columns:e,data:r,defaultRowsPerPage:t=10,rowsPerPageOptions:n=[5,10,25,50],loading:a=!1,onRefresh:s,searchEnabled:i=!0,searchPlaceholder:c="Search...",onSearch:l,initialSortBy:u}){const[d,f]=C.useState(0),[h,x]=C.useState(t),[p,m]=C.useState(""),[g,v]=C.useState(u||null),[y,b]=C.useState("asc");C.useEffect(()=>{f(0)},[p]);const S=(P,A)=>{f(A)},I=P=>{x(parseInt(P.target.value,10)),f(0)},k=P=>{b(g===P&&y==="asc"?"desc":"asc"),v(P)},E=P=>{const A=P.target.value;m(A),l==null||l(A)},T=r.filter(P=>Object.values(P).some(A=>String(A).toLowerCase().includes(p.toLowerCase()))),w=g?[...T].sort((P,A)=>{const L=P[g],Y=A[g];if(L===Y)return 0;if(L==null)return 1;if(Y==null)return-1;const q=L<Y?-1:1;return y==="asc"?q:-q}):T,F=w.slice(d*h,d*h+h);return o.jsxs(st,{sx:{width:"100%",overflow:"hidden"},children:[(i||s)&&o.jsxs(Se,{sx:{p:2,display:"flex",gap:2,alignItems:"center"},children:[i&&o.jsx(ke,{size:"small",placeholder:c,value:p,onChange:E,sx:{minWidth:300},InputProps:{startAdornment:o.jsx(bp,{sx:{mr:1,color:"text.secondary"}})}}),s&&o.jsx(at,{title:"Refresh data",children:o.jsx(Ze,{onClick:s,disabled:a,children:o.jsx(Ka,{})})})]}),o.jsx(zs,{children:o.jsxs(Za,{stickyHeader:!0,children:[o.jsx(es,{children:o.jsx(ir,{children:e.map(P=>o.jsx(ze,{sortDirection:g===P.id?y:!1,children:P.sortable?o.jsx(Pv,{active:g===P.id,direction:g===P.id?y:"asc",onClick:()=>k(P.id),children:P.label}):P.label},P.id))})}),o.jsx(ts,{children:a?o.jsx(ir,{children:o.jsx(ze,{colSpan:e.length,align:"center",sx:{py:4},children:o.jsx(ta,{})})}):F.length===0?o.jsx(ir,{children:o.jsx(ze,{colSpan:e.length,align:"center",sx:{py:4},children:o.jsx(te,{variant:"body1",color:"text.secondary",children:"No data found"})})}):F.map((P,A)=>o.jsx(ir,{hover:!0,children:e.map(L=>o.jsx(ze,{children:L.format?L.format(P[L.id],P):P[L.id]},L.id))},A))})]})}),o.jsx(wp,{rowsPerPageOptions:n,component:"div",count:w.length,rowsPerPage:h,page:d,onPageChange:S,onRowsPerPageChange:I})]})}var Du={},sw=At;Object.defineProperty(Du,"__esModule",{value:!0});var om=Du.default=void 0,iw=sw(_t()),ow=o;om=Du.default=(0,iw.default)((0,ow.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-6h2zm0-8h-2V7h2z"}),"Info");var Fu={},cw=At;Object.defineProperty(Fu,"__esModule",{value:!0});var la=Fu.default=void 0,lw=cw(_t()),uw=o;la=Fu.default=(0,lw.default)((0,uw.jsx)("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore");const Dc={email:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,studentEmail:/^[^\s@]+@(edu\.com|school\.org)$/,phone:/^\+?[\d\s-]{10,}$/,name:/^[a-zA-Z\s-']{2,}$/,studentId:/^[A-Z0-9\d]{4,}$/,password:/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d@$!%*#?&]{8,}$/,indianMobile:/^\+91\d{10}$/},dw=e=>Dc.email.test(e),fw=e=>Dc.name.test(e),hw=e=>Dc.studentId.test(e),Hf=e=>!isNaN(e)&&e>0,pw=(e,r)=>{console.log("Validating student:",e);const t={},n=(r==null?void 0:r.isEdit)||!1;return(!e.name||!fw(e.name))&&(t.name="Please enter a valid name (minimum 2 characters, letters only)"),e.grade||(t.grade="Grade is required"),e.email?dw(e.email)||(t.email="Please enter a valid email address"):t.email="Email address is required",n||(e.studentId?hw(e.studentId)||(t.studentId="Please enter a valid student ID (at least 4 alphanumeric characters)"):t.studentId="Student ID is required"),e.parentPhone?Dc.indianMobile.test(e.parentPhone)||(t.parentPhone="Parent phone must start with +91 followed by 10 digits"):t.parentPhone="Parent phone is required",e.dateOfBirth||(t.dateOfBirth="Date of birth is required"),(!e.address||e.address.trim()==="")&&(t.address="Address is required"),(!e.parentName||e.parentName.trim()==="")&&(t.parentName="Parent/guardian name is required"),e.gender||(t.gender="Gender is required"),console.log("Validation errors:",t),t},mw=e=>{const r={};return(!e.name||e.name.length<3)&&(r.name="Course name must be at least 3 characters"),e.department||(r.department="Department is required"),e.teacherId||(r.teacherId="Teacher is required"),Hf(e.credits)||(r.credits="Credits must be a positive number"),Hf(e.capacity)||(r.capacity="Capacity must be a positive number"),e.enrolled>e.capacity&&(r.enrolled="Enrolled students cannot exceed capacity"),r},Fc=({open:e,onClose:r,title:t,children:n,onSubmit:a,submitLabel:s="Submit",cancelLabel:i="Cancel",loading:c=!1,maxWidth:l="sm",hideActions:u=!1,fullWidth:d=!0,disableSubmitButton:f=!1})=>o.jsxs(kr,{open:e,onClose:c?void 0:r,maxWidth:l,fullWidth:d,children:[o.jsx(Xr,{children:o.jsxs(Se,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[o.jsx(te,{variant:"h6",children:t}),!c&&o.jsx(Ze,{onClick:r,size:"small",children:o.jsx(Sp,{})})]})}),o.jsx(Rr,{dividers:!0,children:n}),!u&&o.jsxs(Nr,{children:[o.jsx(Me,{onClick:r,disabled:c,children:i}),a&&o.jsx(Me,{onClick:a,variant:"contained",color:"primary",disabled:c||f,children:s})]})]}),xw=["1","2","3","4","5","6","7","8","9","10","11","12"],gw=["A","B","C","D"],vw=["A+","A-","B+","B-","AB+","AB-","O+","O-"],yw=["School Bus","Self"],zf=()=>{const e=new Date;return e.setFullYear(e.getFullYear()-10),e.toISOString().split("T")[0]},bw=({open:e,onClose:r,onSubmit:t,initialData:n,loading:a})=>{const[s,i]=C.useState(n||{name:"",studentId:"",grade:"",section:"",dateOfBirth:zf(),gender:"",bloodGroup:"",address:"",email:"",parentName:"",phoneNumber:"",parentPhone:"+91",emergencyContact:"",admissionDate:new Date().toISOString().split("T")[0],status:"ACTIVE",guardianOccupation:"",guardianOfficeAddress:"",aadharNumber:"",udiseNumber:"",houseAlloted:"",guardianAnnualIncome:"",previousSchool:"",tcNumber:"",tcReason:"",tcDate:"",whatsappNumber:"",subjects:"",transportMode:"",busRouteNumber:"",medicalConditions:""}),[c,l]=C.useState({}),[u,d]=C.useState("panel1"),f=p=>(m,g)=>{d(g?p:!1)};C.useEffect(()=>{e&&!n&&i(p=>({...p,dateOfBirth:zf()}))},[e,n]);const h=p=>m=>{let g=m.target.value;p==="parentPhone"&&!g.startsWith("+91")&&(g="+91"+g.replace(/^\+91/,"")),i(v=>({...v,[p]:g})),c[p]&&l(v=>({...v,[p]:""}))},x=()=>{console.log("Submit button clicked");const p={...s,phoneNumber:s.parentPhone||""};if(new Date(p.dateOfBirth||"")>=new Date){l(b=>({...b,dateOfBirth:"Date of birth must be in the past"})),console.log("Date of birth validation failed - must be in the past");return}console.log("Preparing data for submission:",p);const v=!!(n!=null&&n.id),y=pw(p,{isEdit:v});if(Object.keys(y).length>0){l(y),console.log("Form validation failed");return}console.log("Form validation successful, submitting data"),console.log("Submitting data to API:",JSON.stringify(p,null,2)),t(p)};return o.jsx(Fc,{open:e,onClose:r,title:n?"Edit Student":"Add New Student",submitLabel:n?"Update":"Submit",onSubmit:x,maxWidth:"md",loading:a,disableSubmitButton:!1,children:o.jsxs(Se,{sx:{width:"100%"},children:[o.jsxs(Ra,{expanded:u==="panel1",onChange:f("panel1"),children:[o.jsx(Na,{expandIcon:o.jsx(la,{}),children:o.jsx(te,{variant:"subtitle1",children:"Basic Information"})}),o.jsx(Ma,{children:o.jsxs(X,{container:!0,spacing:2,children:[o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Name",value:s.name,onChange:h("name"),error:!!c.name,helperText:c.name,required:!0})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Student ID",value:s.studentId,onChange:h("studentId"),error:!!c.studentId,helperText:c.studentId||"Student ID cannot be changed after creation",required:!0,disabled:!!(n!=null&&n.id),InputProps:{endAdornment:!(n!=null&&n.id)&&o.jsx(Fn,{position:"end",children:o.jsx(at,{title:"Enter a unique Student ID. This cannot be changed later.",children:o.jsx(Ze,{size:"small",children:o.jsx(om,{fontSize:"small"})})})})}})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsxs(Tt,{fullWidth:!0,error:!!c.grade,children:[o.jsx(Wt,{children:"Grade"}),o.jsx(It,{value:s.grade,onChange:h("grade"),label:"Grade",required:!0,children:xw.map(p=>o.jsxs(Xe,{value:p,children:["Grade ",p]},p))}),c.grade&&o.jsx(rs,{children:c.grade})]})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsxs(Tt,{fullWidth:!0,children:[o.jsx(Wt,{children:"Section"}),o.jsx(It,{value:s.section,onChange:h("section"),label:"Section",children:gw.map(p=>o.jsxs(Xe,{value:p,children:["Section ",p]},p))})]})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Date of Birth",type:"date",value:s.dateOfBirth,onChange:h("dateOfBirth"),error:!!c.dateOfBirth,helperText:c.dateOfBirth,InputLabelProps:{shrink:!0},required:!0})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsxs(Tt,{fullWidth:!0,children:[o.jsx(Wt,{children:"Gender"}),o.jsxs(It,{value:s.gender,onChange:h("gender"),label:"Gender",required:!0,children:[o.jsx(Xe,{value:"MALE",children:"Male"}),o.jsx(Xe,{value:"FEMALE",children:"Female"}),o.jsx(Xe,{value:"OTHER",children:"Other"})]})]})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsxs(Tt,{fullWidth:!0,children:[o.jsx(Wt,{children:"Blood Group"}),o.jsxs(It,{value:s.bloodGroup,onChange:h("bloodGroup"),label:"Blood Group",children:[o.jsx(Xe,{value:"",children:"Not Specified"}),vw.map(p=>o.jsx(Xe,{value:p,children:p},p))]})]})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"House Alloted",value:s.houseAlloted,onChange:h("houseAlloted")})}),o.jsx(X,{item:!0,xs:12,children:o.jsx(ke,{fullWidth:!0,label:"Address",multiline:!0,rows:2,value:s.address,onChange:h("address"),error:!!c.address,helperText:c.address,required:!0})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Medical Conditions",value:s.medicalConditions,onChange:h("medicalConditions"),multiline:!0,rows:2})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Email",type:"email",value:s.email,onChange:h("email"),error:!!c.email,helperText:c.email,required:!0})})]})})]}),o.jsxs(Ra,{expanded:u==="panel2",onChange:f("panel2"),children:[o.jsx(Na,{expandIcon:o.jsx(la,{}),children:o.jsx(te,{variant:"subtitle1",children:"Parent/Guardian Information"})}),o.jsx(Ma,{children:o.jsxs(X,{container:!0,spacing:2,children:[o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Parent/Guardian Name",value:s.parentName,onChange:h("parentName"),error:!!c.parentName,helperText:c.parentName,required:!0})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Parent Phone",value:s.parentPhone,onChange:h("parentPhone"),error:!!c.parentPhone,helperText:c.parentPhone||"Must start with +91 followed by 10 digits",required:!0})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Emergency Contact Number",value:s.emergencyContact,onChange:h("emergencyContact"),error:!!c.emergencyContact,helperText:c.emergencyContact})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"WhatsApp Number",value:s.whatsappNumber,onChange:h("whatsappNumber")})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Parent/Guardian Email",type:"email",value:s.parentEmail,onChange:h("parentEmail")})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Guardian Occupation",value:s.guardianOccupation,onChange:h("guardianOccupation")})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Guardian Annual Income",value:s.guardianAnnualIncome,onChange:h("guardianAnnualIncome"),type:"number"})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Guardian Office Address",value:s.guardianOfficeAddress,onChange:h("guardianOfficeAddress"),multiline:!0,rows:2})})]})})]}),o.jsxs(Ra,{expanded:u==="panel3",onChange:f("panel3"),children:[o.jsx(Na,{expandIcon:o.jsx(la,{}),children:o.jsx(te,{variant:"subtitle1",children:"Identification & Records"})}),o.jsx(Ma,{children:o.jsxs(X,{container:!0,spacing:2,children:[o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Aadhar Number",value:s.aadharNumber,onChange:h("aadharNumber")})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"UDISE Number",value:s.udiseNumber,onChange:h("udiseNumber")})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Previous School",value:s.previousSchool,onChange:h("previousSchool")})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Subjects",value:s.subjects,onChange:h("subjects"),multiline:!0,rows:2,placeholder:"Comma separated list of subjects"})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Admission Date",type:"date",value:s.admissionDate,onChange:h("admissionDate"),InputLabelProps:{shrink:!0}})})]})})]}),o.jsxs(Ra,{expanded:u==="panel4",onChange:f("panel4"),children:[o.jsx(Na,{expandIcon:o.jsx(la,{}),children:o.jsx(te,{variant:"subtitle1",children:"Transfer Certificate Details"})}),o.jsx(Ma,{children:o.jsxs(X,{container:!0,spacing:2,children:[o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"TC Number",value:s.tcNumber,onChange:h("tcNumber")})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"TC Date",type:"date",value:s.tcDate,onChange:h("tcDate"),InputLabelProps:{shrink:!0}})}),o.jsx(X,{item:!0,xs:12,children:o.jsx(ke,{fullWidth:!0,label:"TC Reason",value:s.tcReason,onChange:h("tcReason"),multiline:!0,rows:2})})]})})]}),o.jsxs(Ra,{expanded:u==="panel5",onChange:f("panel5"),children:[o.jsx(Na,{expandIcon:o.jsx(la,{}),children:o.jsx(te,{variant:"subtitle1",children:"Transportation"})}),o.jsx(Ma,{children:o.jsxs(X,{container:!0,spacing:2,children:[o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsxs(Tt,{fullWidth:!0,children:[o.jsx(Wt,{children:"Transport Mode"}),o.jsxs(It,{value:s.transportMode,onChange:h("transportMode"),label:"Transport Mode",children:[o.jsx(Xe,{value:"",children:"Not Specified"}),yw.map(p=>o.jsx(Xe,{value:p,children:p},p))]})]})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Bus Route Number",value:s.busRouteNumber,onChange:h("busRouteNumber"),disabled:s.transportMode!=="School Bus"})})]})})]})]})})};var cm={exports:{}};/* @license
Papa Parse
v5.5.2
https://github.com/mholt/PapaParse
License: MIT
*/(function(e,r){((t,n)=>{e.exports=n()})(Ip,function t(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},a,s=!n.document&&!!n.postMessage,i=n.IS_PAPA_WORKER||!1,c={},l=0,u={};function d(T){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(w){var F=I(w);F.chunkSize=parseInt(F.chunkSize),w.step||w.chunk||(F.chunkSize=null),this._handle=new m(F),(this._handle.streamer=this)._config=F}).call(this,T),this.parseChunk=function(w,F){var P=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<P){let L=this._config.newline;L||(A=this._config.quoteChar||'"',L=this._handle.guessLineEndings(w,A)),w=[...w.split(L).slice(P)].join(L)}this.isFirstChunk&&E(this._config.beforeFirstChunk)&&(A=this._config.beforeFirstChunk(w))!==void 0&&(w=A),this.isFirstChunk=!1,this._halted=!1;var P=this._partialLine+w,A=(this._partialLine="",this._handle.parse(P,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(w=A.meta.cursor,P=(this._finished||(this._partialLine=P.substring(w-this._baseIndex),this._baseIndex=w),A&&A.data&&(this._rowCount+=A.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),i)n.postMessage({results:A,workerId:u.WORKER_ID,finished:P});else if(E(this._config.chunk)&&!F){if(this._config.chunk(A,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=A=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(A.data),this._completeResults.errors=this._completeResults.errors.concat(A.errors),this._completeResults.meta=A.meta),this._completed||!P||!E(this._config.complete)||A&&A.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),P||A&&A.meta.paused||this._nextChunk(),A}this._halted=!0},this._sendError=function(w){E(this._config.error)?this._config.error(w):i&&this._config.error&&n.postMessage({workerId:u.WORKER_ID,error:w,finished:!1})}}function f(T){var w;(T=T||{}).chunkSize||(T.chunkSize=u.RemoteChunkSize),d.call(this,T),this._nextChunk=s?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(F){this._input=F,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(w=new XMLHttpRequest,this._config.withCredentials&&(w.withCredentials=this._config.withCredentials),s||(w.onload=k(this._chunkLoaded,this),w.onerror=k(this._chunkError,this)),w.open(this._config.downloadRequestBody?"POST":"GET",this._input,!s),this._config.downloadRequestHeaders){var F,P=this._config.downloadRequestHeaders;for(F in P)w.setRequestHeader(F,P[F])}var A;this._config.chunkSize&&(A=this._start+this._config.chunkSize-1,w.setRequestHeader("Range","bytes="+this._start+"-"+A));try{w.send(this._config.downloadRequestBody)}catch(L){this._chunkError(L.message)}s&&w.status===0&&this._chunkError()}},this._chunkLoaded=function(){w.readyState===4&&(w.status<200||400<=w.status?this._chunkError():(this._start+=this._config.chunkSize||w.responseText.length,this._finished=!this._config.chunkSize||this._start>=(F=>(F=F.getResponseHeader("Content-Range"))!==null?parseInt(F.substring(F.lastIndexOf("/")+1)):-1)(w),this.parseChunk(w.responseText)))},this._chunkError=function(F){F=w.statusText||F,this._sendError(new Error(F))}}function h(T){(T=T||{}).chunkSize||(T.chunkSize=u.LocalChunkSize),d.call(this,T);var w,F,P=typeof FileReader<"u";this.stream=function(A){this._input=A,F=A.slice||A.webkitSlice||A.mozSlice,P?((w=new FileReader).onload=k(this._chunkLoaded,this),w.onerror=k(this._chunkError,this)):w=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var A=this._input,L=(this._config.chunkSize&&(L=Math.min(this._start+this._config.chunkSize,this._input.size),A=F.call(A,this._start,L)),w.readAsText(A,this._config.encoding));P||this._chunkLoaded({target:{result:L}})},this._chunkLoaded=function(A){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(A.target.result)},this._chunkError=function(){this._sendError(w.error)}}function x(T){var w;d.call(this,T=T||{}),this.stream=function(F){return w=F,this._nextChunk()},this._nextChunk=function(){var F,P;if(!this._finished)return F=this._config.chunkSize,w=F?(P=w.substring(0,F),w.substring(F)):(P=w,""),this._finished=!w,this.parseChunk(P)}}function p(T){d.call(this,T=T||{});var w=[],F=!0,P=!1;this.pause=function(){d.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){d.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(A){this._input=A,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){P&&w.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),w.length?this.parseChunk(w.shift()):F=!0},this._streamData=k(function(A){try{w.push(typeof A=="string"?A:A.toString(this._config.encoding)),F&&(F=!1,this._checkIsFinished(),this.parseChunk(w.shift()))}catch(L){this._streamError(L)}},this),this._streamError=k(function(A){this._streamCleanUp(),this._sendError(A)},this),this._streamEnd=k(function(){this._streamCleanUp(),P=!0,this._streamData("")},this),this._streamCleanUp=k(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function m(T){var w,F,P,A,L=Math.pow(2,53),Y=-L,q=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,Q=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,K=this,ye=0,U=0,me=!1,J=!1,D=[],B={data:[],errors:[],meta:{}};function V(ne){return T.skipEmptyLines==="greedy"?ne.join("").trim()==="":ne.length===1&&ne[0].length===0}function W(){if(B&&P&&(fe("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+u.DefaultDelimiter+"'"),P=!1),T.skipEmptyLines&&(B.data=B.data.filter(function(j){return!V(j)})),Z()){let j=function(_,ae){E(T.transformHeader)&&(_=T.transformHeader(_,ae)),D.push(_)};if(B)if(Array.isArray(B.data[0])){for(var ne=0;Z()&&ne<B.data.length;ne++)B.data[ne].forEach(j);B.data.splice(0,1)}else B.data.forEach(j)}function ee(j,_){for(var ae=T.header?{}:[],oe=0;oe<j.length;oe++){var Te=oe,ce=j[oe],ce=((be,pe)=>(Ce=>(T.dynamicTypingFunction&&T.dynamicTyping[Ce]===void 0&&(T.dynamicTyping[Ce]=T.dynamicTypingFunction(Ce)),(T.dynamicTyping[Ce]||T.dynamicTyping)===!0))(be)?pe==="true"||pe==="TRUE"||pe!=="false"&&pe!=="FALSE"&&((Ce=>{if(q.test(Ce)&&(Ce=parseFloat(Ce),Y<Ce&&Ce<L))return 1})(pe)?parseFloat(pe):Q.test(pe)?new Date(pe):pe===""?null:pe):pe)(Te=T.header?oe>=D.length?"__parsed_extra":D[oe]:Te,ce=T.transform?T.transform(ce,Te):ce);Te==="__parsed_extra"?(ae[Te]=ae[Te]||[],ae[Te].push(ce)):ae[Te]=ce}return T.header&&(oe>D.length?fe("FieldMismatch","TooManyFields","Too many fields: expected "+D.length+" fields but parsed "+oe,U+_):oe<D.length&&fe("FieldMismatch","TooFewFields","Too few fields: expected "+D.length+" fields but parsed "+oe,U+_)),ae}var se;B&&(T.header||T.dynamicTyping||T.transform)&&(se=1,!B.data.length||Array.isArray(B.data[0])?(B.data=B.data.map(ee),se=B.data.length):B.data=ee(B.data,0),T.header&&B.meta&&(B.meta.fields=D),U+=se)}function Z(){return T.header&&D.length===0}function fe(ne,ee,se,j){ne={type:ne,code:ee,message:se},j!==void 0&&(ne.row=j),B.errors.push(ne)}E(T.step)&&(A=T.step,T.step=function(ne){B=ne,Z()?W():(W(),B.data.length!==0&&(ye+=ne.data.length,T.preview&&ye>T.preview?F.abort():(B.data=B.data[0],A(B,K))))}),this.parse=function(ne,ee,se){var j=T.quoteChar||'"',j=(T.newline||(T.newline=this.guessLineEndings(ne,j)),P=!1,T.delimiter?E(T.delimiter)&&(T.delimiter=T.delimiter(ne),B.meta.delimiter=T.delimiter):((j=((_,ae,oe,Te,ce)=>{var be,pe,Ce,Oe;ce=ce||[",","	","|",";",u.RECORD_SEP,u.UNIT_SEP];for(var He=0;He<ce.length;He++){for(var N,ie=ce[He],le=0,we=0,Ae=0,Le=(Ce=void 0,new v({comments:Te,delimiter:ie,newline:ae,preview:10}).parse(_)),Ue=0;Ue<Le.data.length;Ue++)oe&&V(Le.data[Ue])?Ae++:(N=Le.data[Ue].length,we+=N,Ce===void 0?Ce=N:0<N&&(le+=Math.abs(N-Ce),Ce=N));0<Le.data.length&&(we/=Le.data.length-Ae),(pe===void 0||le<=pe)&&(Oe===void 0||Oe<we)&&1.99<we&&(pe=le,be=ie,Oe=we)}return{successful:!!(T.delimiter=be),bestDelimiter:be}})(ne,T.newline,T.skipEmptyLines,T.comments,T.delimitersToGuess)).successful?T.delimiter=j.bestDelimiter:(P=!0,T.delimiter=u.DefaultDelimiter),B.meta.delimiter=T.delimiter),I(T));return T.preview&&T.header&&j.preview++,w=ne,F=new v(j),B=F.parse(w,ee,se),W(),me?{meta:{paused:!0}}:B||{meta:{paused:!1}}},this.paused=function(){return me},this.pause=function(){me=!0,F.abort(),w=E(T.chunk)?"":w.substring(F.getCharIndex())},this.resume=function(){K.streamer._halted?(me=!1,K.streamer.parseChunk(w,!0)):setTimeout(K.resume,3)},this.aborted=function(){return J},this.abort=function(){J=!0,F.abort(),B.meta.aborted=!0,E(T.complete)&&T.complete(B),w=""},this.guessLineEndings=function(_,j){_=_.substring(0,1048576);var j=new RegExp(g(j)+"([^]*?)"+g(j),"gm"),se=(_=_.replace(j,"")).split("\r"),j=_.split(`
`),_=1<j.length&&j[0].length<se[0].length;if(se.length===1||_)return`
`;for(var ae=0,oe=0;oe<se.length;oe++)se[oe][0]===`
`&&ae++;return ae>=se.length/2?`\r
`:"\r"}}function g(T){return T.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function v(T){var w=(T=T||{}).delimiter,F=T.newline,P=T.comments,A=T.step,L=T.preview,Y=T.fastMode,q=null,Q=!1,K=T.quoteChar==null?'"':T.quoteChar,ye=K;if(T.escapeChar!==void 0&&(ye=T.escapeChar),(typeof w!="string"||-1<u.BAD_DELIMITERS.indexOf(w))&&(w=","),P===w)throw new Error("Comment character same as delimiter");P===!0?P="#":(typeof P!="string"||-1<u.BAD_DELIMITERS.indexOf(P))&&(P=!1),F!==`
`&&F!=="\r"&&F!==`\r
`&&(F=`
`);var U=0,me=!1;this.parse=function(J,D,B){if(typeof J!="string")throw new Error("Input must be a string");var V=J.length,W=w.length,Z=F.length,fe=P.length,ne=E(A),ee=[],se=[],j=[],_=U=0;if(!J)return le();if(Y||Y!==!1&&J.indexOf(K)===-1){for(var ae=J.split(F),oe=0;oe<ae.length;oe++){if(j=ae[oe],U+=j.length,oe!==ae.length-1)U+=F.length;else if(B)return le();if(!P||j.substring(0,fe)!==P){if(ne){if(ee=[],Oe(j.split(w)),we(),me)return le()}else Oe(j.split(w));if(L&&L<=oe)return ee=ee.slice(0,L),le(!0)}}return le()}for(var Te=J.indexOf(w,U),ce=J.indexOf(F,U),be=new RegExp(g(ye)+g(K),"g"),pe=J.indexOf(K,U);;)if(J[U]===K)for(pe=U,U++;;){if((pe=J.indexOf(K,pe+1))===-1)return B||se.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:ee.length,index:U}),N();if(pe===V-1)return N(J.substring(U,pe).replace(be,K));if(K===ye&&J[pe+1]===ye)pe++;else if(K===ye||pe===0||J[pe-1]!==ye){Te!==-1&&Te<pe+1&&(Te=J.indexOf(w,pe+1));var Ce=He((ce=ce!==-1&&ce<pe+1?J.indexOf(F,pe+1):ce)===-1?Te:Math.min(Te,ce));if(J.substr(pe+1+Ce,W)===w){j.push(J.substring(U,pe).replace(be,K)),J[U=pe+1+Ce+W]!==K&&(pe=J.indexOf(K,U)),Te=J.indexOf(w,U),ce=J.indexOf(F,U);break}if(Ce=He(ce),J.substring(pe+1+Ce,pe+1+Ce+Z)===F){if(j.push(J.substring(U,pe).replace(be,K)),ie(pe+1+Ce+Z),Te=J.indexOf(w,U),pe=J.indexOf(K,U),ne&&(we(),me))return le();if(L&&ee.length>=L)return le(!0);break}se.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:ee.length,index:U}),pe++}}else if(P&&j.length===0&&J.substring(U,U+fe)===P){if(ce===-1)return le();U=ce+Z,ce=J.indexOf(F,U),Te=J.indexOf(w,U)}else if(Te!==-1&&(Te<ce||ce===-1))j.push(J.substring(U,Te)),U=Te+W,Te=J.indexOf(w,U);else{if(ce===-1)break;if(j.push(J.substring(U,ce)),ie(ce+Z),ne&&(we(),me))return le();if(L&&ee.length>=L)return le(!0)}return N();function Oe(Ae){ee.push(Ae),_=U}function He(Ae){var Le=0;return Le=Ae!==-1&&(Ae=J.substring(pe+1,Ae))&&Ae.trim()===""?Ae.length:Le}function N(Ae){return B||(Ae===void 0&&(Ae=J.substring(U)),j.push(Ae),U=V,Oe(j),ne&&we()),le()}function ie(Ae){U=Ae,Oe(j),j=[],ce=J.indexOf(F,U)}function le(Ae){if(T.header&&!D&&ee.length&&!Q){var Le=ee[0],Ue={},Fe=new Set(Le);let Pe=!1;for(let Ve=0;Ve<Le.length;Ve++){let Ye=Le[Ve];if(Ue[Ye=E(T.transformHeader)?T.transformHeader(Ye,Ve):Ye]){let et,ut=Ue[Ye];for(;et=Ye+"_"+ut,ut++,Fe.has(et););Fe.add(et),Le[Ve]=et,Ue[Ye]++,Pe=!0,(q=q===null?{}:q)[et]=Ye}else Ue[Ye]=1,Le[Ve]=Ye;Fe.add(Ye)}Pe&&console.warn("Duplicate headers found and renamed."),Q=!0}return{data:ee,errors:se,meta:{delimiter:w,linebreak:F,aborted:me,truncated:!!Ae,cursor:_+(D||0),renamedHeaders:q}}}function we(){A(le()),ee=[],se=[]}},this.abort=function(){me=!0},this.getCharIndex=function(){return U}}function y(T){var w=T.data,F=c[w.workerId],P=!1;if(w.error)F.userError(w.error,w.file);else if(w.results&&w.results.data){var A={abort:function(){P=!0,b(w.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:S,resume:S};if(E(F.userStep)){for(var L=0;L<w.results.data.length&&(F.userStep({data:w.results.data[L],errors:w.results.errors,meta:w.results.meta},A),!P);L++);delete w.results}else E(F.userChunk)&&(F.userChunk(w.results,A,w.file),delete w.results)}w.finished&&!P&&b(w.workerId,w.results)}function b(T,w){var F=c[T];E(F.userComplete)&&F.userComplete(w),F.terminate(),delete c[T]}function S(){throw new Error("Not implemented.")}function I(T){if(typeof T!="object"||T===null)return T;var w,F=Array.isArray(T)?[]:{};for(w in T)F[w]=I(T[w]);return F}function k(T,w){return function(){T.apply(w,arguments)}}function E(T){return typeof T=="function"}return u.parse=function(T,w){var F=(w=w||{}).dynamicTyping||!1;if(E(F)&&(w.dynamicTypingFunction=F,F={}),w.dynamicTyping=F,w.transform=!!E(w.transform)&&w.transform,!w.worker||!u.WORKERS_SUPPORTED)return F=null,u.NODE_STREAM_INPUT,typeof T=="string"?(T=(P=>P.charCodeAt(0)!==65279?P:P.slice(1))(T),F=new(w.download?f:x)(w)):T.readable===!0&&E(T.read)&&E(T.on)?F=new p(w):(n.File&&T instanceof File||T instanceof Object)&&(F=new h(w)),F.stream(T);(F=(()=>{var P;return!!u.WORKERS_SUPPORTED&&(P=(()=>{var A=n.URL||n.webkitURL||null,L=t.toString();return u.BLOB_URL||(u.BLOB_URL=A.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",L,")();"],{type:"text/javascript"})))})(),(P=new n.Worker(P)).onmessage=y,P.id=l++,c[P.id]=P)})()).userStep=w.step,F.userChunk=w.chunk,F.userComplete=w.complete,F.userError=w.error,w.step=E(w.step),w.chunk=E(w.chunk),w.complete=E(w.complete),w.error=E(w.error),delete w.worker,F.postMessage({input:T,config:w,workerId:F.id})},u.unparse=function(T,w){var F=!1,P=!0,A=",",L=`\r
`,Y='"',q=Y+Y,Q=!1,K=null,ye=!1,U=((()=>{if(typeof w=="object"){if(typeof w.delimiter!="string"||u.BAD_DELIMITERS.filter(function(D){return w.delimiter.indexOf(D)!==-1}).length||(A=w.delimiter),typeof w.quotes!="boolean"&&typeof w.quotes!="function"&&!Array.isArray(w.quotes)||(F=w.quotes),typeof w.skipEmptyLines!="boolean"&&typeof w.skipEmptyLines!="string"||(Q=w.skipEmptyLines),typeof w.newline=="string"&&(L=w.newline),typeof w.quoteChar=="string"&&(Y=w.quoteChar),typeof w.header=="boolean"&&(P=w.header),Array.isArray(w.columns)){if(w.columns.length===0)throw new Error("Option columns is empty");K=w.columns}w.escapeChar!==void 0&&(q=w.escapeChar+Y),w.escapeFormulae instanceof RegExp?ye=w.escapeFormulae:typeof w.escapeFormulae=="boolean"&&w.escapeFormulae&&(ye=/^[=+\-@\t\r].*$/)}})(),new RegExp(g(Y),"g"));if(typeof T=="string"&&(T=JSON.parse(T)),Array.isArray(T)){if(!T.length||Array.isArray(T[0]))return me(null,T,Q);if(typeof T[0]=="object")return me(K||Object.keys(T[0]),T,Q)}else if(typeof T=="object")return typeof T.data=="string"&&(T.data=JSON.parse(T.data)),Array.isArray(T.data)&&(T.fields||(T.fields=T.meta&&T.meta.fields||K),T.fields||(T.fields=Array.isArray(T.data[0])?T.fields:typeof T.data[0]=="object"?Object.keys(T.data[0]):[]),Array.isArray(T.data[0])||typeof T.data[0]=="object"||(T.data=[T.data])),me(T.fields||[],T.data||[],Q);throw new Error("Unable to serialize unrecognized input");function me(D,B,V){var W="",Z=(typeof D=="string"&&(D=JSON.parse(D)),typeof B=="string"&&(B=JSON.parse(B)),Array.isArray(D)&&0<D.length),fe=!Array.isArray(B[0]);if(Z&&P){for(var ne=0;ne<D.length;ne++)0<ne&&(W+=A),W+=J(D[ne],ne);0<B.length&&(W+=L)}for(var ee=0;ee<B.length;ee++){var se=(Z?D:B[ee]).length,j=!1,_=Z?Object.keys(B[ee]).length===0:B[ee].length===0;if(V&&!Z&&(j=V==="greedy"?B[ee].join("").trim()==="":B[ee].length===1&&B[ee][0].length===0),V==="greedy"&&Z){for(var ae=[],oe=0;oe<se;oe++){var Te=fe?D[oe]:oe;ae.push(B[ee][Te])}j=ae.join("").trim()===""}if(!j){for(var ce=0;ce<se;ce++){0<ce&&!_&&(W+=A);var be=Z&&fe?D[ce]:ce;W+=J(B[ee][be],ce)}ee<B.length-1&&(!V||0<se&&!_)&&(W+=L)}}return W}function J(D,B){var V,W;return D==null?"":D.constructor===Date?JSON.stringify(D).slice(1,25):(W=!1,ye&&typeof D=="string"&&ye.test(D)&&(D="'"+D,W=!0),V=D.toString().replace(U,q),(W=W||F===!0||typeof F=="function"&&F(D,B)||Array.isArray(F)&&F[B]||((Z,fe)=>{for(var ne=0;ne<fe.length;ne++)if(-1<Z.indexOf(fe[ne]))return!0;return!1})(V,u.BAD_DELIMITERS)||-1<V.indexOf(A)||V.charAt(0)===" "||V.charAt(V.length-1)===" ")?Y+V+Y:V)}},u.RECORD_SEP=String.fromCharCode(30),u.UNIT_SEP=String.fromCharCode(31),u.BYTE_ORDER_MARK="\uFEFF",u.BAD_DELIMITERS=["\r",`
`,'"',u.BYTE_ORDER_MARK],u.WORKERS_SUPPORTED=!s&&!!n.Worker,u.NODE_STREAM_INPUT=1,u.LocalChunkSize=10485760,u.RemoteChunkSize=5242880,u.DefaultDelimiter=",",u.Parser=v,u.ParserHandle=m,u.NetworkStreamer=f,u.FileStreamer=h,u.StringStreamer=x,u.ReadableStreamStreamer=p,n.jQuery&&((a=n.jQuery).fn.parse=function(T){var w=T.config||{},F=[];return this.each(function(L){if(!(a(this).prop("tagName").toUpperCase()==="INPUT"&&a(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var Y=0;Y<this.files.length;Y++)F.push({file:this.files[Y],inputElem:this,instanceConfig:a.extend({},w)})}),P(),this;function P(){if(F.length===0)E(T.complete)&&T.complete();else{var L,Y,q,Q,K=F[0];if(E(T.before)){var ye=T.before(K.file,K.inputElem);if(typeof ye=="object"){if(ye.action==="abort")return L="AbortError",Y=K.file,q=K.inputElem,Q=ye.reason,void(E(T.error)&&T.error({name:L},Y,q,Q));if(ye.action==="skip")return void A();typeof ye.config=="object"&&(K.instanceConfig=a.extend(K.instanceConfig,ye.config))}else if(ye==="skip")return void A()}var U=K.instanceConfig.complete;K.instanceConfig.complete=function(me){E(U)&&U(me,K.file,K.inputElem),A()},u.parse(K.file,K.instanceConfig)}}function A(){F.splice(0,1),P()}}),i&&(n.onmessage=function(T){T=T.data,u.WORKER_ID===void 0&&T&&(u.WORKER_ID=T.workerId),typeof T.input=="string"?n.postMessage({workerId:u.WORKER_ID,results:u.parse(T.input,T.config),finished:!0}):(n.File&&T.input instanceof File||T.input instanceof Object)&&(T=u.parse(T.input,T.config))&&n.postMessage({workerId:u.WORKER_ID,results:T,finished:!0})}),(f.prototype=Object.create(d.prototype)).constructor=f,(h.prototype=Object.create(d.prototype)).constructor=h,(x.prototype=Object.create(x.prototype)).constructor=x,(p.prototype=Object.create(d.prototype)).constructor=p,u})})(cm);var lm=cm.exports,Iu={},ww=At;Object.defineProperty(Iu,"__esModule",{value:!0});var Pu=Iu.default=void 0,Sw=ww(_t()),Ew=o;Pu=Iu.default=(0,Sw.default)((0,Ew.jsx)("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96M14 13v4h-4v-4H7l5-5 5 5z"}),"CloudUpload");var Ou={},Tw=At;Object.defineProperty(Ou,"__esModule",{value:!0});var ju=Ou.default=void 0,kw=Tw(_t()),Aw=o;ju=Ou.default=(0,kw.default)((0,Aw.jsx)("path",{d:"M5 20h14v-2H5zM19 9h-4V3H9v6H5l7 7z"}),"Download");var Ru={},Cw=At;Object.defineProperty(Ru,"__esModule",{value:!0});var Nu=Ru.default=void 0,_w=Cw(_t()),Dw=o;Nu=Ru.default=(0,_w.default)((0,Dw.jsx)("path",{d:"M9 16h6v-6h4l-7-7-7 7h4zm-4 2h14v2H5z"}),"FileUpload");/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var um=1252,Fw=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Mu={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Lu=function(e){Fw.indexOf(e)!=-1&&(um=Mu[0]=e)};function Iw(){Lu(1252)}var vn=function(e){Lu(e)};function dm(){vn(1200),Iw()}function Gf(e){for(var r=[],t=0,n=e.length;t<n;++t)r[t]=e.charCodeAt(t);return r}function Pw(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return r.join("")}function fm(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return r.join("")}var Si=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1);return r==255&&t==254?Pw(e.slice(2)):r==254&&t==255?fm(e.slice(2)):r==65279?e.slice(1):e},Eo=function(r){return String.fromCharCode(r)},Yf=function(r){return String.fromCharCode(r)},ua,fa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function qf(e){for(var r="",t=0,n=0,a=0,s=0,i=0,c=0,l=0,u=0;u<e.length;)t=e.charCodeAt(u++),s=t>>2,n=e.charCodeAt(u++),i=(t&3)<<4|n>>4,a=e.charCodeAt(u++),c=(n&15)<<2|a>>6,l=a&63,isNaN(n)?c=l=64:isNaN(a)&&(l=64),r+=fa.charAt(s)+fa.charAt(i)+fa.charAt(c)+fa.charAt(l);return r}function Kr(e){var r="",t=0,n=0,a=0,s=0,i=0,c=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)s=fa.indexOf(e.charAt(u++)),i=fa.indexOf(e.charAt(u++)),t=s<<2|i>>4,r+=String.fromCharCode(t),c=fa.indexOf(e.charAt(u++)),n=(i&15)<<4|c>>2,c!==64&&(r+=String.fromCharCode(n)),l=fa.indexOf(e.charAt(u++)),a=(c&3)<<6|l,l!==64&&(r+=String.fromCharCode(a));return r}var ot=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ls=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}}();function xa(e){return ot?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Xf(e){return ot?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var gn=function(r){return ot?ls(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)&255})};function us(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function Bu(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Bu(new Uint8Array(e));for(var r=new Array(e.length),t=0;t<e.length;++t)r[t]=e[t];return r}var da=ot?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:ls(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var n=new Uint8Array(t),a=0;for(r=0,t=0;r<e.length;t+=a,++r)if(a=e[r].length,e[r]instanceof Uint8Array)n.set(e[r],t);else{if(typeof e[r]=="string")throw"wtf";n.set(new Uint8Array(e[r]),t)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function Ow(e){for(var r=[],t=0,n=e.length+250,a=xa(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)a[t++]=i;else if(i<2048)a[t++]=192|i>>6&31,a[t++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var c=e.charCodeAt(++s)&1023;a[t++]=240|i>>8&7,a[t++]=128|i>>2&63,a[t++]=128|c>>6&15|(i&3)<<4,a[t++]=128|c&63}else a[t++]=224|i>>12&15,a[t++]=128|i>>6&63,a[t++]=128|i&63;t>n&&(r.push(a.slice(0,t)),t=0,a=xa(65535),n=65530)}return r.push(a.slice(0,t)),da(r)}var Ar=/\u0000/g,Ei=/[\u0001-\u0006]/g;function Ms(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function yn(e,r){var t=""+e;return t.length>=r?t:Ft("0",r-t.length)+t}function $u(e,r){var t=""+e;return t.length>=r?t:Ft(" ",r-t.length)+t}function Qo(e,r){var t=""+e;return t.length>=r?t:t+Ft(" ",r-t.length)}function jw(e,r){var t=""+Math.round(e);return t.length>=r?t:Ft("0",r-t.length)+t}function Rw(e,r){var t=""+e;return t.length>=r?t:Ft("0",r-t.length)+t}var Kf=Math.pow(2,32);function Cs(e,r){if(e>Kf||e<-Kf)return jw(e,r);var t=Math.round(e);return Rw(t,r)}function Zo(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var Jf=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],ul=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Nw(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"ä¸Šåˆ/ä¸‹åˆ "hh"æ™‚"mm"åˆ†"ss"ç§’ "',e}var rt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"ä¸Šåˆ/ä¸‹åˆ "hh"æ™‚"mm"åˆ†"ss"ç§’ "'},Qf={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Mw={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ec(e,r,t){for(var n=e<0?-1:1,a=e*n,s=0,i=1,c=0,l=1,u=0,d=0,f=Math.floor(a);u<r&&(f=Math.floor(a),c=f*i+s,d=f*u+l,!(a-f<5e-8));)a=1/(a-f),s=i,i=c,l=u,u=d;if(d>r&&(u>r?(d=l,c=s):(d=u,c=i)),!t)return[0,n*c,d];var h=Math.floor(n*c/d);return[h,n*c-h*d,d]}function Ua(e,r,t){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),s=0,i=[],c={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),r&&r.date1904&&(n+=1462),c.u>.9999&&(c.u=0,++a==86400&&(c.T=a=0,++n,++c.D)),n===60)i=t?[1317,10,29]:[1900,2,29],s=3;else if(n===0)i=t?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),t&&(s=Ww(l,i))}return c.y=i[0],c.m=i[1],c.d=i[2],c.S=a%60,a=Math.floor(a/60),c.M=a%60,a=Math.floor(a/60),c.H=a,c.q=s,c}var hm=new Date(1899,11,31,0,0,0),Lw=hm.getTime(),Bw=new Date(1900,2,1,0,0,0);function pm(e,r){var t=e.getTime();return r?t-=1461*24*60*60*1e3:e>=Bw&&(t+=24*60*60*1e3),(t-(Lw+(e.getTimezoneOffset()-hm.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Uu(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function $w(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Uw(e){var r=e<0?12:11,t=Uu(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10),t.length<=r)?t:e.toExponential(5)}function Vw(e){var r=Uu(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function Vi(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return r>=-4&&r<=-1?t=e.toPrecision(10+r):Math.abs(r)<=9?t=Uw(e):r===10?t=e.toFixed(10).substr(0,12):t=Vw(e),Uu($w(t.toUpperCase()))}function as(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Vi(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return an(14,pm(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function Ww(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function Hw(e,r,t,n){var a="",s=0,i=0,c=t.y,l,u=0;switch(e){case 98:c=t.y+543;case 121:switch(r.length){case 1:case 2:l=c%100,u=2;break;default:l=c%1e4,u=4;break}break;case 109:switch(r.length){case 1:case 2:l=t.m,u=r.length;break;case 3:return ul[t.m-1][1];case 5:return ul[t.m-1][0];default:return ul[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:l=t.d,u=r.length;break;case 3:return Jf[t.q][0];default:return Jf[t.q][1]}break;case 104:switch(r.length){case 1:case 2:l=1+(t.H+11)%12,u=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:l=t.H,u=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:l=t.M,u=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return t.u===0&&(r=="s"||r=="ss")?yn(t.S,r.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,s=Math.round(i*(t.S+t.u)),s>=60*i&&(s=0),r==="s"?s===0?"0":""+s/i:(a=yn(s,2+n),r==="ss"?a.substr(0,2):"."+a.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":l=t.D*24+t.H;break;case"[m]":case"[mm]":l=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":l=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r}u=r.length===3?1:2;break;case 101:l=c,u=1;break}var d=u>0?yn(l,u):"";return d}function ha(e){var r=3;if(e.length<=r)return e;for(var t=e.length%r,n=e.substr(0,t);t!=e.length;t+=r)n+=(n.length>0?",":"")+e.substr(t,r);return n}var mm=/%/g;function zw(e,r,t){var n=r.replace(mm,""),a=r.length-n.length;return Jn(e,n,t*Math.pow(10,2*a))+Ft("%",a)}function Gw(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return Jn(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function xm(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+xm(e,-r);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(r)*Math.LOG10E)%a;if(s<0&&(s+=a),t=(r/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),t.indexOf("e")===-1){var i=Math.floor(Math.log(r)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(i-t.length+s):t+="E+"+(i-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,a)+"."+t.substr(2+a),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,l,u,d){return l+u+d.substr(0,(a+s)%a)+"."+d.substr(s)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var gm=/# (\?+)( ?)\/( ?)(\d+)/;function Yw(e,r,t){var n=parseInt(e[4],10),a=Math.round(r*n),s=Math.floor(a/n),i=a-s*n,c=n;return t+(s===0?"":""+s)+" "+(i===0?Ft(" ",e[1].length+1+e[4].length):$u(i,e[1].length)+e[2]+"/"+e[3]+yn(c,e[4].length))}function qw(e,r,t){return t+(r===0?"":""+r)+Ft(" ",e[1].length+2+e[4].length)}var vm=/^#*0*\.([0#]+)/,ym=/\).*[0#]/,bm=/\(###\) ###\\?-####/;function Sr(e){for(var r="",t,n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function Zf(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function e0(e,r){var t=e-Math.floor(e),n=Math.pow(10,r);return r<(""+Math.round(t*n)).length?0:Math.round(t*n)}function Xw(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function Kw(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function en(e,r,t){if(e.charCodeAt(0)===40&&!r.match(ym)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?en("n",n,t):"("+en("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return Gw(e,r,t);if(r.indexOf("%")!==-1)return zw(e,r,t);if(r.indexOf("E")!==-1)return xm(r,t);if(r.charCodeAt(0)===36)return"$"+en(e,r.substr(r.charAt(1)==" "?2:1),t);var a,s,i,c,l=Math.abs(t),u=t<0?"-":"";if(r.match(/^00+$/))return u+Cs(l,r.length);if(r.match(/^[#?]+$/))return a=Cs(t,0),a==="0"&&(a=""),a.length>r.length?a:Sr(r.substr(0,r.length-a.length))+a;if(s=r.match(gm))return Yw(s,l,u);if(r.match(/^#+0+$/))return u+Cs(l,r.length-r.indexOf("0"));if(s=r.match(vm))return a=Zf(t,s[1].length).replace(/^([^\.]+)$/,"$1."+Sr(s[1])).replace(/\.$/,"."+Sr(s[1])).replace(/\.(\d*)$/,function(p,m){return"."+m+Ft("0",Sr(s[1]).length-m.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),s=r.match(/^(0*)\.(#*)$/))return u+Zf(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=r.match(/^#{1,3},##0(\.?)$/))return u+ha(Cs(l,0));if(s=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+en(e,r,-t):ha(""+(Math.floor(t)+Xw(t,s[1].length)))+"."+yn(e0(t,s[1].length),s[1].length);if(s=r.match(/^#,#*,#0/))return en(e,r.replace(/^#,#*,/,""),t);if(s=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Ms(en(e,r.replace(/[\\-]/g,""),t)),i=0,Ms(Ms(r.replace(/\\/g,"")).replace(/[0#]/g,function(p){return i<a.length?a.charAt(i++):p==="0"?"0":""}));if(r.match(bm))return a=en(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),c=ec(l,Math.pow(10,i)-1,!1),a=""+u,d=Jn("n",s[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],d=Qo(c[2],i),d.length<s[4].length&&(d=Sr(s[4].substr(s[4].length-d.length))+d),a+=d,a;if(s=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),c=ec(l,Math.pow(10,i)-1,!0),u+(c[0]||(c[1]?"":"0"))+" "+(c[1]?$u(c[1],i)+s[2]+"/"+s[3]+Qo(c[2],i):Ft(" ",2*i+1+s[2].length+s[3].length));if(s=r.match(/^[#0?]+$/))return a=Cs(t,0),r.length<=a.length?a:Sr(r.substr(0,r.length-a.length))+a;if(s=r.match(/^([#0?]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var f=r.indexOf(".")-i,h=r.length-a.length-f;return Sr(r.substr(0,f)+a+r.substr(r.length-h))}if(s=r.match(/^00,000\.([#0]*0)$/))return i=e0(t,s[1].length),t<0?"-"+en(e,r,-t):ha(Kw(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?yn(0,3-p.length):"")+p})+"."+yn(i,s[1].length);switch(r){case"###,##0.00":return en(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var x=ha(Cs(l,0));return x!=="0"?u+x:"";case"###,###.00":return en(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return en(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function Jw(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return Jn(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function Qw(e,r,t){var n=r.replace(mm,""),a=r.length-n.length;return Jn(e,n,t*Math.pow(10,2*a))+Ft("%",a)}function wm(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+wm(e,-r);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(r)*Math.LOG10E)%a;if(s<0&&(s+=a),t=(r/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!t.match(/[Ee]/)){var i=Math.floor(Math.log(r)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(i-t.length+s):t+="E+"+(i-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,l,u,d){return l+u+d.substr(0,(a+s)%a)+"."+d.substr(s)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function _n(e,r,t){if(e.charCodeAt(0)===40&&!r.match(ym)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?_n("n",n,t):"("+_n("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return Jw(e,r,t);if(r.indexOf("%")!==-1)return Qw(e,r,t);if(r.indexOf("E")!==-1)return wm(r,t);if(r.charCodeAt(0)===36)return"$"+_n(e,r.substr(r.charAt(1)==" "?2:1),t);var a,s,i,c,l=Math.abs(t),u=t<0?"-":"";if(r.match(/^00+$/))return u+yn(l,r.length);if(r.match(/^[#?]+$/))return a=""+t,t===0&&(a=""),a.length>r.length?a:Sr(r.substr(0,r.length-a.length))+a;if(s=r.match(gm))return qw(s,l,u);if(r.match(/^#+0+$/))return u+yn(l,r.length-r.indexOf("0"));if(s=r.match(vm))return a=(""+t).replace(/^([^\.]+)$/,"$1."+Sr(s[1])).replace(/\.$/,"."+Sr(s[1])),a=a.replace(/\.(\d*)$/,function(p,m){return"."+m+Ft("0",Sr(s[1]).length-m.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),s=r.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=r.match(/^#{1,3},##0(\.?)$/))return u+ha(""+l);if(s=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+_n(e,r,-t):ha(""+t)+"."+Ft("0",s[1].length);if(s=r.match(/^#,#*,#0/))return _n(e,r.replace(/^#,#*,/,""),t);if(s=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Ms(_n(e,r.replace(/[\\-]/g,""),t)),i=0,Ms(Ms(r.replace(/\\/g,"")).replace(/[0#]/g,function(p){return i<a.length?a.charAt(i++):p==="0"?"0":""}));if(r.match(bm))return a=_n(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),c=ec(l,Math.pow(10,i)-1,!1),a=""+u,d=Jn("n",s[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],d=Qo(c[2],i),d.length<s[4].length&&(d=Sr(s[4].substr(s[4].length-d.length))+d),a+=d,a;if(s=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),c=ec(l,Math.pow(10,i)-1,!0),u+(c[0]||(c[1]?"":"0"))+" "+(c[1]?$u(c[1],i)+s[2]+"/"+s[3]+Qo(c[2],i):Ft(" ",2*i+1+s[2].length+s[3].length));if(s=r.match(/^[#0?]+$/))return a=""+t,r.length<=a.length?a:Sr(r.substr(0,r.length-a.length))+a;if(s=r.match(/^([#0]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var f=r.indexOf(".")-i,h=r.length-a.length-f;return Sr(r.substr(0,f)+a+r.substr(r.length-h))}if(s=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+_n(e,r,-t):ha(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?yn(0,3-p.length):"")+p})+"."+yn(0,s[1].length);switch(r){case"###,###":case"##,###":case"#,###":var x=ha(""+l);return x!=="0"?u+x:"";default:if(r.match(/\.[0#?]*$/))return _n(e,r.slice(0,r.lastIndexOf(".")),t)+Sr(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function Jn(e,r,t){return(t|0)===t?_n(e,r,t):en(e,r,t)}function Zw(e){for(var r=[],t=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:r[r.length]=e.substr(a,n-a),a=n+1}if(r[r.length]=e.substr(a),t===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var Sm=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ni(e){for(var r=0,t="",n="";r<e.length;)switch(t=e.charAt(r)){case"G":Zo(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"ä¸Š":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="ä¸Šåˆ/ä¸‹åˆ")return!0;++r;break;case"[":for(n=t;e.charAt(r++)!=="]"&&r<e.length;)n+=e.charAt(r);if(n.match(Sm))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||t=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function e2(e,r,t,n){for(var a=[],s="",i=0,c="",l="t",u,d,f,h="H";i<e.length;)switch(c=e.charAt(i)){case"G":if(!Zo(e,i))throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"G",v:"General"},i+=7;break;case'"':for(s="";(f=e.charCodeAt(++i))!==34&&i<e.length;)s+=String.fromCharCode(f);a[a.length]={t:"t",v:s},++i;break;case"\\":var x=e.charAt(++i),p=x==="("||x===")"?x:"t";a[a.length]={t:p,v:x},++i;break;case"_":a[a.length]={t:"t",v:" "},i+=2;break;case"@":a[a.length]={t:"T",v:r},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(u==null&&(u=Ua(r,t,e.charAt(i+1)==="2"),u==null))return"";a[a.length]={t:"X",v:e.substr(i,2)},l=c,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||u==null&&(u=Ua(r,t),u==null))return"";for(s=c;++i<e.length&&e.charAt(i).toLowerCase()===c;)s+=c;c==="m"&&l.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=h),a[a.length]={t:c,v:s},l=c;break;case"A":case"a":case"ä¸Š":var m={t:c,v:c};if(u==null&&(u=Ua(r,t)),e.substr(i,3).toUpperCase()==="A/P"?(u!=null&&(m.v=u.H>=12?"P":"A"),m.t="T",h="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(u!=null&&(m.v=u.H>=12?"PM":"AM"),m.t="T",i+=5,h="h"):e.substr(i,5).toUpperCase()==="ä¸Šåˆ/ä¸‹åˆ"?(u!=null&&(m.v=u.H>=12?"ä¸‹åˆ":"ä¸Šåˆ"),m.t="T",i+=5,h="h"):(m.t="t",++i),u==null&&m.t==="T")return"";a[a.length]=m,l=c;break;case"[":for(s=c;e.charAt(i++)!=="]"&&i<e.length;)s+=e.charAt(i);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(Sm)){if(u==null&&(u=Ua(r,t),u==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",ni(e)||(a[a.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=c;++i<e.length&&(c=e.charAt(i))==="0";)s+=c;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=c;++i<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(i))>-1;)s+=c;a[a.length]={t:"n",v:s};break;case"?":for(s=c;e.charAt(++i)===c;)s+=c;a[a.length]={t:c,v:s},l=c;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":a[a.length]={t:n===1?"t":c,v:c},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=c;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)s+=e.charAt(i);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:c,v:c},++i;break;case"$":a[a.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=â‚¬acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"t",v:c},++i;break}var g=0,v=0,y;for(i=a.length-1,l="t";i>=0;--i)switch(a[i].t){case"h":case"H":a[i].t=h,l="h",g<1&&(g=1);break;case"s":(y=a[i].v.match(/\.0+$/))&&(v=Math.max(v,y[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":l=a[i].t;break;case"m":l==="s"&&(a[i].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&a[i].v.match(/[Hh]/)&&(g=1),g<2&&a[i].v.match(/[Mm]/)&&(g=2),g<3&&a[i].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var b="",S;for(i=0;i<a.length;++i)switch(a[i].t){case"t":case"T":case" ":case"D":break;case"X":a[i].v="",a[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[i].v=Hw(a[i].t.charCodeAt(0),a[i].v,u,v),a[i].t="t";break;case"n":case"?":for(S=i+1;a[S]!=null&&((c=a[S].t)==="?"||c==="D"||(c===" "||c==="t")&&a[S+1]!=null&&(a[S+1].t==="?"||a[S+1].t==="t"&&a[S+1].v==="/")||a[i].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(a[S].v==="/"||a[S].v===" "&&a[S+1]!=null&&a[S+1].t=="?"));)a[i].v+=a[S].v,a[S]={v:"",t:";"},++S;b+=a[i].v,i=S-1;break;case"G":a[i].t="t",a[i].v=as(r,t);break}var I="",k,E;if(b.length>0){b.charCodeAt(0)==40?(k=r<0&&b.charCodeAt(0)===45?-r:r,E=Jn("n",b,k)):(k=r<0&&n>1?-r:r,E=Jn("n",b,k),k<0&&a[0]&&a[0].t=="t"&&(E=E.substr(1),a[0].v="-"+a[0].v)),S=E.length-1;var T=a.length;for(i=0;i<a.length;++i)if(a[i]!=null&&a[i].t!="t"&&a[i].v.indexOf(".")>-1){T=i;break}var w=a.length;if(T===a.length&&E.indexOf("E")===-1){for(i=a.length-1;i>=0;--i)a[i]==null||"n?".indexOf(a[i].t)===-1||(S>=a[i].v.length-1?(S-=a[i].v.length,a[i].v=E.substr(S+1,a[i].v.length)):S<0?a[i].v="":(a[i].v=E.substr(0,S+1),S=-1),a[i].t="t",w=i);S>=0&&w<a.length&&(a[w].v=E.substr(0,S+1)+a[w].v)}else if(T!==a.length&&E.indexOf("E")===-1){for(S=E.indexOf(".")-1,i=T;i>=0;--i)if(!(a[i]==null||"n?".indexOf(a[i].t)===-1)){for(d=a[i].v.indexOf(".")>-1&&i===T?a[i].v.indexOf(".")-1:a[i].v.length-1,I=a[i].v.substr(d+1);d>=0;--d)S>=0&&(a[i].v.charAt(d)==="0"||a[i].v.charAt(d)==="#")&&(I=E.charAt(S--)+I);a[i].v=I,a[i].t="t",w=i}for(S>=0&&w<a.length&&(a[w].v=E.substr(0,S+1)+a[w].v),S=E.indexOf(".")+1,i=T;i<a.length;++i)if(!(a[i]==null||"n?(".indexOf(a[i].t)===-1&&i!==T)){for(d=a[i].v.indexOf(".")>-1&&i===T?a[i].v.indexOf(".")+1:0,I=a[i].v.substr(0,d);d<a[i].v.length;++d)S<E.length&&(I+=E.charAt(S++));a[i].v=I,a[i].t="t",w=i}}}for(i=0;i<a.length;++i)a[i]!=null&&"n?".indexOf(a[i].t)>-1&&(k=n>1&&r<0&&i>0&&a[i-1].v==="-"?-r:r,a[i].v=Jn(a[i].t,a[i].v,k),a[i].t="t");var F="";for(i=0;i!==a.length;++i)a[i]!=null&&(F+=a[i].v);return F}var t0=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function r0(e,r){if(r==null)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function t2(e,r){var t=Zw(e),n=t.length,a=t[n-1].indexOf("@");if(n<4&&a>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof r!="number")return[4,t.length===4||a>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=a>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=a>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=a>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var s=r>0?t[0]:r<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var i=t[0].match(t0),c=t[1].match(t0);return r0(r,i)?[n,t[0]]:r0(r,c)?[n,t[1]]:[n,t[i!=null&&c!=null?2:1]]}return[n,s]}function an(e,r,t){t==null&&(t={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?n=t.dateNF:n=e;break;case"number":e==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:rt)[e],n==null&&(n=t.table&&t.table[Qf[e]]||rt[Qf[e]]),n==null&&(n=Mw[e]||"General");break}if(Zo(n,0))return as(r,t);r instanceof Date&&(r=pm(r,t.date1904));var a=t2(n,r);if(Zo(a[1]))return as(r,t);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return e2(a[1],r,t,a[0])}function Va(e,r){if(typeof r!="number"){r=+r||-1;for(var t=0;t<392;++t){if(rt[t]==null){r<0&&(r=t);continue}if(rt[t]==e){r=t;break}}r<0&&(r=391)}return rt[r]=e,r}function Em(){rt=Nw()}var r2={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Tm=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function n2(e){var r=typeof e=="number"?rt[e]:e;return r=r.replace(Tm,"(\\d+)"),new RegExp("^"+r+"$")}function a2(e,r,t){var n=-1,a=-1,s=-1,i=-1,c=-1,l=-1;(r.match(Tm)||[]).forEach(function(f,h){var x=parseInt(t[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=x;break;case"d":s=x;break;case"h":i=x;break;case"s":l=x;break;case"m":i>=0?c=x:a=x;break}}),l>=0&&c==-1&&a>=0&&(c=a,a=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return i==-1&&c==-1&&l==-1?u:n==-1&&a==-1&&s==-1?d:u+"T"+d}var s2=function(){var e={};e.version="1.2.0";function r(){for(var E=0,T=new Array(256),w=0;w!=256;++w)E=w,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,T[w]=E;return typeof Int32Array<"u"?new Int32Array(T):T}var t=r();function n(E){var T=0,w=0,F=0,P=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(F=0;F!=256;++F)P[F]=E[F];for(F=0;F!=256;++F)for(w=E[F],T=256+F;T<4096;T+=256)w=P[T]=w>>>8^E[w&255];var A=[];for(F=1;F!=16;++F)A[F-1]=typeof Int32Array<"u"?P.subarray(F*256,F*256+256):P.slice(F*256,F*256+256);return A}var a=n(t),s=a[0],i=a[1],c=a[2],l=a[3],u=a[4],d=a[5],f=a[6],h=a[7],x=a[8],p=a[9],m=a[10],g=a[11],v=a[12],y=a[13],b=a[14];function S(E,T){for(var w=T^-1,F=0,P=E.length;F<P;)w=w>>>8^t[(w^E.charCodeAt(F++))&255];return~w}function I(E,T){for(var w=T^-1,F=E.length-15,P=0;P<F;)w=b[E[P++]^w&255]^y[E[P++]^w>>8&255]^v[E[P++]^w>>16&255]^g[E[P++]^w>>>24]^m[E[P++]]^p[E[P++]]^x[E[P++]]^h[E[P++]]^f[E[P++]]^d[E[P++]]^u[E[P++]]^l[E[P++]]^c[E[P++]]^i[E[P++]]^s[E[P++]]^t[E[P++]];for(F+=15;P<F;)w=w>>>8^t[(w^E[P++])&255];return~w}function k(E,T){for(var w=T^-1,F=0,P=E.length,A=0,L=0;F<P;)A=E.charCodeAt(F++),A<128?w=w>>>8^t[(w^A)&255]:A<2048?(w=w>>>8^t[(w^(192|A>>6&31))&255],w=w>>>8^t[(w^(128|A&63))&255]):A>=55296&&A<57344?(A=(A&1023)+64,L=E.charCodeAt(F++)&1023,w=w>>>8^t[(w^(240|A>>8&7))&255],w=w>>>8^t[(w^(128|A>>2&63))&255],w=w>>>8^t[(w^(128|L>>6&15|(A&3)<<4))&255],w=w>>>8^t[(w^(128|L&63))&255]):(w=w>>>8^t[(w^(224|A>>12&15))&255],w=w>>>8^t[(w^(128|A>>6&63))&255],w=w>>>8^t[(w^(128|A&63))&255]);return~w}return e.table=t,e.bstr=S,e.buf=I,e.str=k,e}(),ct=function(){var r={};r.version="1.2.1";function t(O,H){for(var R=O.split("/"),M=H.split("/"),z=0,G=0,de=Math.min(R.length,M.length);z<de;++z){if(G=R[z].length-M[z].length)return G;if(R[z]!=M[z])return R[z]<M[z]?-1:1}return R.length-M.length}function n(O){if(O.charAt(O.length-1)=="/")return O.slice(0,-1).indexOf("/")===-1?O:n(O.slice(0,-1));var H=O.lastIndexOf("/");return H===-1?O:O.slice(0,H+1)}function a(O){if(O.charAt(O.length-1)=="/")return a(O.slice(0,-1));var H=O.lastIndexOf("/");return H===-1?O:O.slice(H+1)}function s(O,H){typeof H=="string"&&(H=new Date(H));var R=H.getHours();R=R<<6|H.getMinutes(),R=R<<5|H.getSeconds()>>>1,O.write_shift(2,R);var M=H.getFullYear()-1980;M=M<<4|H.getMonth()+1,M=M<<5|H.getDate(),O.write_shift(2,M)}function i(O){var H=O.read_shift(2)&65535,R=O.read_shift(2)&65535,M=new Date,z=R&31;R>>>=5;var G=R&15;R>>>=4,M.setMilliseconds(0),M.setFullYear(R+1980),M.setMonth(G-1),M.setDate(z);var de=H&31;H>>>=5;var Ee=H&63;return H>>>=6,M.setHours(H),M.setMinutes(Ee),M.setSeconds(de<<1),M}function c(O){sr(O,0);for(var H={},R=0;O.l<=O.length-4;){var M=O.read_shift(2),z=O.read_shift(2),G=O.l+z,de={};switch(M){case 21589:R=O.read_shift(1),R&1&&(de.mtime=O.read_shift(4)),z>5&&(R&2&&(de.atime=O.read_shift(4)),R&4&&(de.ctime=O.read_shift(4))),de.mtime&&(de.mt=new Date(de.mtime*1e3));break}O.l=G,H[M]=de}return H}var l;function u(){return l||(l={})}function d(O,H){if(O[0]==80&&O[1]==75)return _r(O,H);if((O[0]|32)==109&&(O[1]|32)==105)return Br(O,H);if(O.length<512)throw new Error("CFB file size "+O.length+" < 512");var R=3,M=512,z=0,G=0,de=0,Ee=0,ue=0,he=[],xe=O.slice(0,512);sr(xe,0);var _e=f(xe);switch(R=_e[0],R){case 3:M=512;break;case 4:M=4096;break;case 0:if(_e[1]==0)return _r(O,H);default:throw new Error("Major Version: Expected 3 or 4 saw "+R)}M!==512&&(xe=O.slice(0,M),sr(xe,28));var Re=O.slice(0,M);h(xe,R);var We=xe.read_shift(4,"i");if(R===3&&We!==0)throw new Error("# Directory Sectors: Expected 0 saw "+We);xe.l+=4,de=xe.read_shift(4,"i"),xe.l+=4,xe.chk("00100000","Mini Stream Cutoff Size: "),Ee=xe.read_shift(4,"i"),z=xe.read_shift(4,"i"),ue=xe.read_shift(4,"i"),G=xe.read_shift(4,"i");for(var Ie=-1,Be=0;Be<109&&(Ie=xe.read_shift(4,"i"),!(Ie<0));++Be)he[Be]=Ie;var tt=x(O,M);g(ue,G,tt,M,he);var St=y(tt,de,he,M);St[de].name="!Directory",z>0&&Ee!==L&&(St[Ee].name="!MiniFAT"),St[he[0]].name="!FAT",St.fat_addrs=he,St.ssz=M;var Et={},ur=[],ci=[],li=[];b(de,St,tt,ur,z,Et,ci,Ee),p(ci,li,ur),ur.shift();var ui={FileIndex:ci,FullPaths:li};return H&&H.raw&&(ui.raw={header:Re,sectors:tt}),ui}function f(O){if(O[O.l]==80&&O[O.l+1]==75)return[0,0];O.chk(Y,"Header Signature: "),O.l+=16;var H=O.read_shift(2,"u");return[O.read_shift(2,"u"),H]}function h(O,H){var R=9;switch(O.l+=2,R=O.read_shift(2)){case 9:if(H!=3)throw new Error("Sector Shift: Expected 9 saw "+R);break;case 12:if(H!=4)throw new Error("Sector Shift: Expected 12 saw "+R);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+R)}O.chk("0600","Mini Sector Shift: "),O.chk("000000000000","Reserved: ")}function x(O,H){for(var R=Math.ceil(O.length/H)-1,M=[],z=1;z<R;++z)M[z-1]=O.slice(z*H,(z+1)*H);return M[R-1]=O.slice(R*H),M}function p(O,H,R){for(var M=0,z=0,G=0,de=0,Ee=0,ue=R.length,he=[],xe=[];M<ue;++M)he[M]=xe[M]=M,H[M]=R[M];for(;Ee<xe.length;++Ee)M=xe[Ee],z=O[M].L,G=O[M].R,de=O[M].C,he[M]===M&&(z!==-1&&he[z]!==z&&(he[M]=he[z]),G!==-1&&he[G]!==G&&(he[M]=he[G])),de!==-1&&(he[de]=M),z!==-1&&M!=he[M]&&(he[z]=he[M],xe.lastIndexOf(z)<Ee&&xe.push(z)),G!==-1&&M!=he[M]&&(he[G]=he[M],xe.lastIndexOf(G)<Ee&&xe.push(G));for(M=1;M<ue;++M)he[M]===M&&(G!==-1&&he[G]!==G?he[M]=he[G]:z!==-1&&he[z]!==z&&(he[M]=he[z]));for(M=1;M<ue;++M)if(O[M].type!==0){if(Ee=M,Ee!=he[Ee])do Ee=he[Ee],H[M]=H[Ee]+"/"+H[M];while(Ee!==0&&he[Ee]!==-1&&Ee!=he[Ee]);he[M]=-1}for(H[0]+="/",M=1;M<ue;++M)O[M].type!==2&&(H[M]+="/")}function m(O,H,R){for(var M=O.start,z=O.size,G=[],de=M;R&&z>0&&de>=0;)G.push(H.slice(de*A,de*A+A)),z-=A,de=La(R,de*4);return G.length===0?Gt(0):da(G).slice(0,O.size)}function g(O,H,R,M,z){var G=L;if(O===L){if(H!==0)throw new Error("DIFAT chain shorter than expected")}else if(O!==-1){var de=R[O],Ee=(M>>>2)-1;if(!de)return;for(var ue=0;ue<Ee&&(G=La(de,ue*4))!==L;++ue)z.push(G);g(La(de,M-4),H-1,R,M,z)}}function v(O,H,R,M,z){var G=[],de=[];z||(z=[]);var Ee=M-1,ue=0,he=0;for(ue=H;ue>=0;){z[ue]=!0,G[G.length]=ue,de.push(O[ue]);var xe=R[Math.floor(ue*4/M)];if(he=ue*4&Ee,M<4+he)throw new Error("FAT boundary crossed: "+ue+" 4 "+M);if(!O[xe])break;ue=La(O[xe],he)}return{nodes:G,data:f0([de])}}function y(O,H,R,M){var z=O.length,G=[],de=[],Ee=[],ue=[],he=M-1,xe=0,_e=0,Re=0,We=0;for(xe=0;xe<z;++xe)if(Ee=[],Re=xe+H,Re>=z&&(Re-=z),!de[Re]){ue=[];var Ie=[];for(_e=Re;_e>=0;){Ie[_e]=!0,de[_e]=!0,Ee[Ee.length]=_e,ue.push(O[_e]);var Be=R[Math.floor(_e*4/M)];if(We=_e*4&he,M<4+We)throw new Error("FAT boundary crossed: "+_e+" 4 "+M);if(!O[Be]||(_e=La(O[Be],We),Ie[_e]))break}G[Re]={nodes:Ee,data:f0([ue])}}return G}function b(O,H,R,M,z,G,de,Ee){for(var ue=0,he=M.length?2:0,xe=H[O].data,_e=0,Re=0,We;_e<xe.length;_e+=128){var Ie=xe.slice(_e,_e+128);sr(Ie,64),Re=Ie.read_shift(2),We=Gu(Ie,0,Re-he),M.push(We);var Be={name:We,type:Ie.read_shift(1),color:Ie.read_shift(1),L:Ie.read_shift(4,"i"),R:Ie.read_shift(4,"i"),C:Ie.read_shift(4,"i"),clsid:Ie.read_shift(16),state:Ie.read_shift(4,"i"),start:0,size:0},tt=Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2);tt!==0&&(Be.ct=S(Ie,Ie.l-8));var St=Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2);St!==0&&(Be.mt=S(Ie,Ie.l-8)),Be.start=Ie.read_shift(4,"i"),Be.size=Ie.read_shift(4,"i"),Be.size<0&&Be.start<0&&(Be.size=Be.type=0,Be.start=L,Be.name=""),Be.type===5?(ue=Be.start,z>0&&ue!==L&&(H[ue].name="!StreamData")):Be.size>=4096?(Be.storage="fat",H[Be.start]===void 0&&(H[Be.start]=v(R,Be.start,H.fat_addrs,H.ssz)),H[Be.start].name=Be.name,Be.content=H[Be.start].data.slice(0,Be.size)):(Be.storage="minifat",Be.size<0?Be.size=0:ue!==L&&Be.start!==L&&H[ue]&&(Be.content=m(Be,H[ue].data,(H[Ee]||{}).data))),Be.content&&sr(Be.content,0),G[We]=Be,de.push(Be)}}function S(O,H){return new Date((Hr(O,H+4)/1e7*Math.pow(2,32)+Hr(O,H)/1e7-11644473600)*1e3)}function I(O,H){return u(),d(l.readFileSync(O),H)}function k(O,H){var R=H&&H.type;switch(R||ot&&Buffer.isBuffer(O)&&(R="buffer"),R||"base64"){case"file":return I(O,H);case"base64":return d(gn(Kr(O)),H);case"binary":return d(gn(O),H)}return d(O,H)}function E(O,H){var R=H||{},M=R.root||"Root Entry";if(O.FullPaths||(O.FullPaths=[]),O.FileIndex||(O.FileIndex=[]),O.FullPaths.length!==O.FileIndex.length)throw new Error("inconsistent CFB structure");O.FullPaths.length===0&&(O.FullPaths[0]=M+"/",O.FileIndex[0]={name:M,type:5}),R.CLSID&&(O.FileIndex[0].clsid=R.CLSID),T(O)}function T(O){var H="Sh33tJ5";if(!ct.find(O,"/"+H)){var R=Gt(4);R[0]=55,R[1]=R[3]=50,R[2]=54,O.FileIndex.push({name:H,type:2,content:R,size:4,L:69,R:69,C:69}),O.FullPaths.push(O.FullPaths[0]+H),w(O)}}function w(O,H){E(O);for(var R=!1,M=!1,z=O.FullPaths.length-1;z>=0;--z){var G=O.FileIndex[z];switch(G.type){case 0:M?R=!0:(O.FileIndex.pop(),O.FullPaths.pop());break;case 1:case 2:case 5:M=!0,isNaN(G.R*G.L*G.C)&&(R=!0),G.R>-1&&G.L>-1&&G.R==G.L&&(R=!0);break;default:R=!0;break}}if(!(!R&&!H)){var de=new Date(1987,1,19),Ee=0,ue=Object.create?Object.create(null):{},he=[];for(z=0;z<O.FullPaths.length;++z)ue[O.FullPaths[z]]=!0,O.FileIndex[z].type!==0&&he.push([O.FullPaths[z],O.FileIndex[z]]);for(z=0;z<he.length;++z){var xe=n(he[z][0]);M=ue[xe],M||(he.push([xe,{name:a(xe).replace("/",""),type:1,clsid:Q,ct:de,mt:de,content:null}]),ue[xe]=!0)}for(he.sort(function(We,Ie){return t(We[0],Ie[0])}),O.FullPaths=[],O.FileIndex=[],z=0;z<he.length;++z)O.FullPaths[z]=he[z][0],O.FileIndex[z]=he[z][1];for(z=0;z<he.length;++z){var _e=O.FileIndex[z],Re=O.FullPaths[z];if(_e.name=a(Re).replace("/",""),_e.L=_e.R=_e.C=-(_e.color=1),_e.size=_e.content?_e.content.length:0,_e.start=0,_e.clsid=_e.clsid||Q,z===0)_e.C=he.length>1?1:-1,_e.size=0,_e.type=5;else if(Re.slice(-1)=="/"){for(Ee=z+1;Ee<he.length&&n(O.FullPaths[Ee])!=Re;++Ee);for(_e.C=Ee>=he.length?-1:Ee,Ee=z+1;Ee<he.length&&n(O.FullPaths[Ee])!=n(Re);++Ee);_e.R=Ee>=he.length?-1:Ee,_e.type=1}else n(O.FullPaths[z+1]||"")==n(Re)&&(_e.R=z+1),_e.type=2}}}function F(O,H){var R=H||{};if(R.fileType=="mad")return wo(O,R);switch(w(O),R.fileType){case"zip":return Dr(O,R)}var M=function(We){for(var Ie=0,Be=0,tt=0;tt<We.FileIndex.length;++tt){var St=We.FileIndex[tt];if(St.content){var Et=St.content.length;Et>0&&(Et<4096?Ie+=Et+63>>6:Be+=Et+511>>9)}}for(var ur=We.FullPaths.length+3>>2,ci=Ie+7>>3,li=Ie+127>>7,ui=ci+Be+ur+li,Ea=ui+127>>7,tl=Ea<=109?0:Math.ceil((Ea-109)/127);ui+Ea+tl+127>>7>Ea;)tl=++Ea<=109?0:Math.ceil((Ea-109)/127);var zn=[1,tl,Ea,li,ur,Be,Ie,0];return We.FileIndex[0].size=Ie<<6,zn[7]=(We.FileIndex[0].start=zn[0]+zn[1]+zn[2]+zn[3]+zn[4]+zn[5])+(zn[6]+7>>3),zn}(O),z=Gt(M[7]<<9),G=0,de=0;{for(G=0;G<8;++G)z.write_shift(1,q[G]);for(G=0;G<8;++G)z.write_shift(2,0);for(z.write_shift(2,62),z.write_shift(2,3),z.write_shift(2,65534),z.write_shift(2,9),z.write_shift(2,6),G=0;G<3;++G)z.write_shift(2,0);for(z.write_shift(4,0),z.write_shift(4,M[2]),z.write_shift(4,M[0]+M[1]+M[2]+M[3]-1),z.write_shift(4,0),z.write_shift(4,4096),z.write_shift(4,M[3]?M[0]+M[1]+M[2]-1:L),z.write_shift(4,M[3]),z.write_shift(-4,M[1]?M[0]-1:L),z.write_shift(4,M[1]),G=0;G<109;++G)z.write_shift(-4,G<M[2]?M[1]+G:-1)}if(M[1])for(de=0;de<M[1];++de){for(;G<236+de*127;++G)z.write_shift(-4,G<M[2]?M[1]+G:-1);z.write_shift(-4,de===M[1]-1?L:de+1)}var Ee=function(We){for(de+=We;G<de-1;++G)z.write_shift(-4,G+1);We&&(++G,z.write_shift(-4,L))};for(de=G=0,de+=M[1];G<de;++G)z.write_shift(-4,K.DIFSECT);for(de+=M[2];G<de;++G)z.write_shift(-4,K.FATSECT);Ee(M[3]),Ee(M[4]);for(var ue=0,he=0,xe=O.FileIndex[0];ue<O.FileIndex.length;++ue)xe=O.FileIndex[ue],xe.content&&(he=xe.content.length,!(he<4096)&&(xe.start=de,Ee(he+511>>9)));for(Ee(M[6]+7>>3);z.l&511;)z.write_shift(-4,K.ENDOFCHAIN);for(de=G=0,ue=0;ue<O.FileIndex.length;++ue)xe=O.FileIndex[ue],xe.content&&(he=xe.content.length,!(!he||he>=4096)&&(xe.start=de,Ee(he+63>>6)));for(;z.l&511;)z.write_shift(-4,K.ENDOFCHAIN);for(G=0;G<M[4]<<2;++G){var _e=O.FullPaths[G];if(!_e||_e.length===0){for(ue=0;ue<17;++ue)z.write_shift(4,0);for(ue=0;ue<3;++ue)z.write_shift(4,-1);for(ue=0;ue<12;++ue)z.write_shift(4,0);continue}xe=O.FileIndex[G],G===0&&(xe.start=xe.size?xe.start-1:L);var Re=G===0&&R.root||xe.name;if(he=2*(Re.length+1),z.write_shift(64,Re,"utf16le"),z.write_shift(2,he),z.write_shift(1,xe.type),z.write_shift(1,xe.color),z.write_shift(-4,xe.L),z.write_shift(-4,xe.R),z.write_shift(-4,xe.C),xe.clsid)z.write_shift(16,xe.clsid,"hex");else for(ue=0;ue<4;++ue)z.write_shift(4,0);z.write_shift(4,xe.state||0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,xe.start),z.write_shift(4,xe.size),z.write_shift(4,0)}for(G=1;G<O.FileIndex.length;++G)if(xe=O.FileIndex[G],xe.size>=4096)if(z.l=xe.start+1<<9,ot&&Buffer.isBuffer(xe.content))xe.content.copy(z,z.l,0,xe.size),z.l+=xe.size+511&-512;else{for(ue=0;ue<xe.size;++ue)z.write_shift(1,xe.content[ue]);for(;ue&511;++ue)z.write_shift(1,0)}for(G=1;G<O.FileIndex.length;++G)if(xe=O.FileIndex[G],xe.size>0&&xe.size<4096)if(ot&&Buffer.isBuffer(xe.content))xe.content.copy(z,z.l,0,xe.size),z.l+=xe.size+63&-64;else{for(ue=0;ue<xe.size;++ue)z.write_shift(1,xe.content[ue]);for(;ue&63;++ue)z.write_shift(1,0)}if(ot)z.l=z.length;else for(;z.l<z.length;)z.write_shift(1,0);return z}function P(O,H){var R=O.FullPaths.map(function(ue){return ue.toUpperCase()}),M=R.map(function(ue){var he=ue.split("/");return he[he.length-(ue.slice(-1)=="/"?2:1)]}),z=!1;H.charCodeAt(0)===47?(z=!0,H=R[0].slice(0,-1)+H):z=H.indexOf("/")!==-1;var G=H.toUpperCase(),de=z===!0?R.indexOf(G):M.indexOf(G);if(de!==-1)return O.FileIndex[de];var Ee=!G.match(Ei);for(G=G.replace(Ar,""),Ee&&(G=G.replace(Ei,"!")),de=0;de<R.length;++de)if((Ee?R[de].replace(Ei,"!"):R[de]).replace(Ar,"")==G||(Ee?M[de].replace(Ei,"!"):M[de]).replace(Ar,"")==G)return O.FileIndex[de];return null}var A=64,L=-2,Y="d0cf11e0a1b11ae1",q=[208,207,17,224,161,177,26,225],Q="00000000000000000000000000000000",K={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:L,FREESECT:-1,HEADER_SIGNATURE:Y,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Q,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ye(O,H,R){u();var M=F(O,R);l.writeFileSync(H,M)}function U(O){for(var H=new Array(O.length),R=0;R<O.length;++R)H[R]=String.fromCharCode(O[R]);return H.join("")}function me(O,H){var R=F(O,H);switch(H&&H.type||"buffer"){case"file":return u(),l.writeFileSync(H.filename,R),R;case"binary":return typeof R=="string"?R:U(R);case"base64":return qf(typeof R=="string"?R:U(R));case"buffer":if(ot)return Buffer.isBuffer(R)?R:ls(R);case"array":return typeof R=="string"?gn(R):R}return R}var J;function D(O){try{var H=O.InflateRaw,R=new H;if(R._processChunk(new Uint8Array([3,0]),R._finishFlushFlag),R.bytesRead)J=O;else throw new Error("zlib does not expose bytesRead")}catch(M){console.error("cannot use native zlib: "+(M.message||M))}}function B(O,H){if(!J)return Rt(O,H);var R=J.InflateRaw,M=new R,z=M._processChunk(O.slice(O.l),M._finishFlushFlag);return O.l+=M.bytesRead,z}function V(O){return J?J.deflateRawSync(O):Pe(O)}var W=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],fe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ne(O){var H=(O<<1|O<<11)&139536|(O<<5|O<<15)&558144;return(H>>16|H>>8|H)&255}for(var ee=typeof Uint8Array<"u",se=ee?new Uint8Array(256):[],j=0;j<256;++j)se[j]=ne(j);function _(O,H){var R=se[O&255];return H<=8?R>>>8-H:(R=R<<8|se[O>>8&255],H<=16?R>>>16-H:(R=R<<8|se[O>>16&255],R>>>24-H))}function ae(O,H){var R=H&7,M=H>>>3;return(O[M]|(R<=6?0:O[M+1]<<8))>>>R&3}function oe(O,H){var R=H&7,M=H>>>3;return(O[M]|(R<=5?0:O[M+1]<<8))>>>R&7}function Te(O,H){var R=H&7,M=H>>>3;return(O[M]|(R<=4?0:O[M+1]<<8))>>>R&15}function ce(O,H){var R=H&7,M=H>>>3;return(O[M]|(R<=3?0:O[M+1]<<8))>>>R&31}function be(O,H){var R=H&7,M=H>>>3;return(O[M]|(R<=1?0:O[M+1]<<8))>>>R&127}function pe(O,H,R){var M=H&7,z=H>>>3,G=(1<<R)-1,de=O[z]>>>M;return R<8-M||(de|=O[z+1]<<8-M,R<16-M)||(de|=O[z+2]<<16-M,R<24-M)||(de|=O[z+3]<<24-M),de&G}function Ce(O,H,R){var M=H&7,z=H>>>3;return M<=5?O[z]|=(R&7)<<M:(O[z]|=R<<M&255,O[z+1]=(R&7)>>8-M),H+3}function Oe(O,H,R){var M=H&7,z=H>>>3;return R=(R&1)<<M,O[z]|=R,H+1}function He(O,H,R){var M=H&7,z=H>>>3;return R<<=M,O[z]|=R&255,R>>>=8,O[z+1]=R,H+8}function N(O,H,R){var M=H&7,z=H>>>3;return R<<=M,O[z]|=R&255,R>>>=8,O[z+1]=R&255,O[z+2]=R>>>8,H+16}function ie(O,H){var R=O.length,M=2*R>H?2*R:H+5,z=0;if(R>=H)return O;if(ot){var G=Xf(M);if(O.copy)O.copy(G);else for(;z<O.length;++z)G[z]=O[z];return G}else if(ee){var de=new Uint8Array(M);if(de.set)de.set(O);else for(;z<R;++z)de[z]=O[z];return de}return O.length=M,O}function le(O){for(var H=new Array(O),R=0;R<O;++R)H[R]=0;return H}function we(O,H,R){var M=1,z=0,G=0,de=0,Ee=0,ue=O.length,he=ee?new Uint16Array(32):le(32);for(G=0;G<32;++G)he[G]=0;for(G=ue;G<R;++G)O[G]=0;ue=O.length;var xe=ee?new Uint16Array(ue):le(ue);for(G=0;G<ue;++G)he[z=O[G]]++,M<z&&(M=z),xe[G]=0;for(he[0]=0,G=1;G<=M;++G)he[G+16]=Ee=Ee+he[G-1]<<1;for(G=0;G<ue;++G)Ee=O[G],Ee!=0&&(xe[G]=he[Ee+16]++);var _e=0;for(G=0;G<ue;++G)if(_e=O[G],_e!=0)for(Ee=_(xe[G],M)>>M-_e,de=(1<<M+4-_e)-1;de>=0;--de)H[Ee|de<<_e]=_e&15|G<<4;return M}var Ae=ee?new Uint16Array(512):le(512),Le=ee?new Uint16Array(32):le(32);if(!ee){for(var Ue=0;Ue<512;++Ue)Ae[Ue]=0;for(Ue=0;Ue<32;++Ue)Le[Ue]=0}(function(){for(var O=[],H=0;H<32;H++)O.push(5);we(O,Le,32);var R=[];for(H=0;H<=143;H++)R.push(8);for(;H<=255;H++)R.push(9);for(;H<=279;H++)R.push(7);for(;H<=287;H++)R.push(8);we(R,Ae,288)})();var Fe=function(){for(var H=ee?new Uint8Array(32768):[],R=0,M=0;R<fe.length-1;++R)for(;M<fe[R+1];++M)H[M]=R;for(;M<32768;++M)H[M]=29;var z=ee?new Uint8Array(259):[];for(R=0,M=0;R<Z.length-1;++R)for(;M<Z[R+1];++M)z[M]=R;function G(Ee,ue){for(var he=0;he<Ee.length;){var xe=Math.min(65535,Ee.length-he),_e=he+xe==Ee.length;for(ue.write_shift(1,+_e),ue.write_shift(2,xe),ue.write_shift(2,~xe&65535);xe-- >0;)ue[ue.l++]=Ee[he++]}return ue.l}function de(Ee,ue){for(var he=0,xe=0,_e=ee?new Uint16Array(32768):[];xe<Ee.length;){var Re=Math.min(65535,Ee.length-xe);if(Re<10){for(he=Ce(ue,he,+(xe+Re==Ee.length)),he&7&&(he+=8-(he&7)),ue.l=he/8|0,ue.write_shift(2,Re),ue.write_shift(2,~Re&65535);Re-- >0;)ue[ue.l++]=Ee[xe++];he=ue.l*8;continue}he=Ce(ue,he,+(xe+Re==Ee.length)+2);for(var We=0;Re-- >0;){var Ie=Ee[xe];We=(We<<5^Ie)&32767;var Be=-1,tt=0;if((Be=_e[We])&&(Be|=xe&-32768,Be>xe&&(Be-=32768),Be<xe))for(;Ee[Be+tt]==Ee[xe+tt]&&tt<250;)++tt;if(tt>2){Ie=z[tt],Ie<=22?he=He(ue,he,se[Ie+1]>>1)-1:(He(ue,he,3),he+=5,He(ue,he,se[Ie-23]>>5),he+=3);var St=Ie<8?0:Ie-4>>2;St>0&&(N(ue,he,tt-Z[Ie]),he+=St),Ie=H[xe-Be],he=He(ue,he,se[Ie]>>3),he-=3;var Et=Ie<4?0:Ie-2>>1;Et>0&&(N(ue,he,xe-Be-fe[Ie]),he+=Et);for(var ur=0;ur<tt;++ur)_e[We]=xe&32767,We=(We<<5^Ee[xe])&32767,++xe;Re-=tt-1}else Ie<=143?Ie=Ie+48:he=Oe(ue,he,1),he=He(ue,he,se[Ie]),_e[We]=xe&32767,++xe}he=He(ue,he,0)-1}return ue.l=(he+7)/8|0,ue.l}return function(ue,he){return ue.length<8?G(ue,he):de(ue,he)}}();function Pe(O){var H=Gt(50+Math.floor(O.length*1.1)),R=Fe(O,H);return H.slice(0,R)}var Ve=ee?new Uint16Array(32768):le(32768),Ye=ee?new Uint16Array(32768):le(32768),et=ee?new Uint16Array(128):le(128),ut=1,ar=1;function Bt(O,H){var R=ce(O,H)+257;H+=5;var M=ce(O,H)+1;H+=5;var z=Te(O,H)+4;H+=4;for(var G=0,de=ee?new Uint8Array(19):le(19),Ee=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ue=1,he=ee?new Uint8Array(8):le(8),xe=ee?new Uint8Array(8):le(8),_e=de.length,Re=0;Re<z;++Re)de[W[Re]]=G=oe(O,H),ue<G&&(ue=G),he[G]++,H+=3;var We=0;for(he[0]=0,Re=1;Re<=ue;++Re)xe[Re]=We=We+he[Re-1]<<1;for(Re=0;Re<_e;++Re)(We=de[Re])!=0&&(Ee[Re]=xe[We]++);var Ie=0;for(Re=0;Re<_e;++Re)if(Ie=de[Re],Ie!=0){We=se[Ee[Re]]>>8-Ie;for(var Be=(1<<7-Ie)-1;Be>=0;--Be)et[We|Be<<Ie]=Ie&7|Re<<3}var tt=[];for(ue=1;tt.length<R+M;)switch(We=et[be(O,H)],H+=We&7,We>>>=3){case 16:for(G=3+ae(O,H),H+=2,We=tt[tt.length-1];G-- >0;)tt.push(We);break;case 17:for(G=3+oe(O,H),H+=3;G-- >0;)tt.push(0);break;case 18:for(G=11+be(O,H),H+=7;G-- >0;)tt.push(0);break;default:tt.push(We),ue<We&&(ue=We);break}var St=tt.slice(0,R),Et=tt.slice(R);for(Re=R;Re<286;++Re)St[Re]=0;for(Re=M;Re<30;++Re)Et[Re]=0;return ut=we(St,Ve,286),ar=we(Et,Ye,30),H}function it(O,H){if(O[0]==3&&!(O[1]&3))return[xa(H),2];for(var R=0,M=0,z=Xf(H||1<<18),G=0,de=z.length>>>0,Ee=0,ue=0;!(M&1);){if(M=oe(O,R),R+=3,M>>>1)M>>1==1?(Ee=9,ue=5):(R=Bt(O,R),Ee=ut,ue=ar);else{R&7&&(R+=8-(R&7));var he=O[R>>>3]|O[(R>>>3)+1]<<8;if(R+=32,he>0)for(!H&&de<G+he&&(z=ie(z,G+he),de=z.length);he-- >0;)z[G++]=O[R>>>3],R+=8;continue}for(;;){!H&&de<G+32767&&(z=ie(z,G+32767),de=z.length);var xe=pe(O,R,Ee),_e=M>>>1==1?Ae[xe]:Ve[xe];if(R+=_e&15,_e>>>=4,!(_e>>>8&255))z[G++]=_e;else{if(_e==256)break;_e-=257;var Re=_e<8?0:_e-4>>2;Re>5&&(Re=0);var We=G+Z[_e];Re>0&&(We+=pe(O,R,Re),R+=Re),xe=pe(O,R,ue),_e=M>>>1==1?Le[xe]:Ye[xe],R+=_e&15,_e>>>=4;var Ie=_e<4?0:_e-2>>1,Be=fe[_e];for(Ie>0&&(Be+=pe(O,R,Ie),R+=Ie),!H&&de<We&&(z=ie(z,We+100),de=z.length);G<We;)z[G]=z[G-Be],++G}}}return H?[z,R+7>>>3]:[z.slice(0,G),R+7>>>3]}function Rt(O,H){var R=O.slice(O.l||0),M=it(R,H);return O.l+=M[1],M[0]}function Qt(O,H){if(O)typeof console<"u"&&console.error(H);else throw new Error(H)}function _r(O,H){var R=O;sr(R,0);var M=[],z=[],G={FileIndex:M,FullPaths:z};E(G,{root:H.root});for(var de=R.length-4;(R[de]!=80||R[de+1]!=75||R[de+2]!=5||R[de+3]!=6)&&de>=0;)--de;R.l=de+4,R.l+=4;var Ee=R.read_shift(2);R.l+=6;var ue=R.read_shift(4);for(R.l=ue,de=0;de<Ee;++de){R.l+=20;var he=R.read_shift(4),xe=R.read_shift(4),_e=R.read_shift(2),Re=R.read_shift(2),We=R.read_shift(2);R.l+=8;var Ie=R.read_shift(4),Be=c(R.slice(R.l+_e,R.l+_e+Re));R.l+=_e+Re+We;var tt=R.l;R.l=Ie+4,Es(R,he,xe,G,Be),R.l=tt}return G}function Es(O,H,R,M,z){O.l+=2;var G=O.read_shift(2),de=O.read_shift(2),Ee=i(O);if(G&8257)throw new Error("Unsupported ZIP encryption");for(var ue=O.read_shift(4),he=O.read_shift(4),xe=O.read_shift(4),_e=O.read_shift(2),Re=O.read_shift(2),We="",Ie=0;Ie<_e;++Ie)We+=String.fromCharCode(O[O.l++]);if(Re){var Be=c(O.slice(O.l,O.l+Re));(Be[21589]||{}).mt&&(Ee=Be[21589].mt),((z||{})[21589]||{}).mt&&(Ee=z[21589].mt)}O.l+=Re;var tt=O.slice(O.l,O.l+he);switch(de){case 8:tt=B(O,xe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+de)}var St=!1;G&8&&(ue=O.read_shift(4),ue==134695760&&(ue=O.read_shift(4),St=!0),he=O.read_shift(4),xe=O.read_shift(4)),he!=H&&Qt(St,"Bad compressed size: "+H+" != "+he),xe!=R&&Qt(St,"Bad uncompressed size: "+R+" != "+xe),el(M,We,tt,{unsafe:!0,mt:Ee})}function Dr(O,H){var R=H||{},M=[],z=[],G=Gt(1),de=R.compression?8:0,Ee=0,ue=0,he=0,xe=0,_e=0,Re=O.FullPaths[0],We=Re,Ie=O.FileIndex[0],Be=[],tt=0;for(ue=1;ue<O.FullPaths.length;++ue)if(We=O.FullPaths[ue].slice(Re.length),Ie=O.FileIndex[ue],!(!Ie.size||!Ie.content||We=="Sh33tJ5")){var St=xe,Et=Gt(We.length);for(he=0;he<We.length;++he)Et.write_shift(1,We.charCodeAt(he)&127);Et=Et.slice(0,Et.l),Be[_e]=s2.buf(Ie.content,0);var ur=Ie.content;de==8&&(ur=V(ur)),G=Gt(30),G.write_shift(4,67324752),G.write_shift(2,20),G.write_shift(2,Ee),G.write_shift(2,de),Ie.mt?s(G,Ie.mt):G.write_shift(4,0),G.write_shift(-4,Be[_e]),G.write_shift(4,ur.length),G.write_shift(4,Ie.content.length),G.write_shift(2,Et.length),G.write_shift(2,0),xe+=G.length,M.push(G),xe+=Et.length,M.push(Et),xe+=ur.length,M.push(ur),G=Gt(46),G.write_shift(4,33639248),G.write_shift(2,0),G.write_shift(2,20),G.write_shift(2,Ee),G.write_shift(2,de),G.write_shift(4,0),G.write_shift(-4,Be[_e]),G.write_shift(4,ur.length),G.write_shift(4,Ie.content.length),G.write_shift(2,Et.length),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(4,0),G.write_shift(4,St),tt+=G.l,z.push(G),tt+=Et.length,z.push(Et),++_e}return G=Gt(22),G.write_shift(4,101010256),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(2,_e),G.write_shift(2,_e),G.write_shift(4,tt),G.write_shift(4,xe),G.write_shift(2,0),da([da(M),da(z),G])}var Ts={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Qc(O,H){if(O.ctype)return O.ctype;var R=O.name||"",M=R.match(/\.([^\.]+)$/);return M&&Ts[M[1]]||H&&(M=(R=H).match(/[\.\\]([^\.\\])+$/),M&&Ts[M[1]])?Ts[M[1]]:"application/octet-stream"}function Zc(O){for(var H=qf(O),R=[],M=0;M<H.length;M+=76)R.push(H.slice(M,M+76));return R.join(`\r
`)+`\r
`}function ff(O){var H=O.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(he){var xe=he.charCodeAt(0).toString(16).toUpperCase();return"="+(xe.length==1?"0"+xe:xe)});H=H.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),H.charAt(0)==`
`&&(H="=0D"+H.slice(1)),H=H.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var R=[],M=H.split(`\r
`),z=0;z<M.length;++z){var G=M[z];if(G.length==0){R.push("");continue}for(var de=0;de<G.length;){var Ee=76,ue=G.slice(de,de+Ee);ue.charAt(Ee-1)=="="?Ee--:ue.charAt(Ee-2)=="="?Ee-=2:ue.charAt(Ee-3)=="="&&(Ee-=3),ue=G.slice(de,de+Ee),de+=Ee,de<G.length&&(ue+="="),R.push(ue)}}return R.join(`\r
`)}function hf(O){for(var H=[],R=0;R<O.length;++R){for(var M=O[R];R<=O.length&&M.charAt(M.length-1)=="=";)M=M.slice(0,M.length-1)+O[++R];H.push(M)}for(var z=0;z<H.length;++z)H[z]=H[z].replace(/[=][0-9A-Fa-f]{2}/g,function(G){return String.fromCharCode(parseInt(G.slice(1),16))});return gn(H.join(`\r
`))}function Dt(O,H,R){for(var M="",z="",G="",de,Ee=0;Ee<10;++Ee){var ue=H[Ee];if(!ue||ue.match(/^\s*$/))break;var he=ue.match(/^(.*?):\s*([^\s].*)$/);if(he)switch(he[1].toLowerCase()){case"content-location":M=he[2].trim();break;case"content-type":G=he[2].trim();break;case"content-transfer-encoding":z=he[2].trim();break}}switch(++Ee,z.toLowerCase()){case"base64":de=gn(Kr(H.slice(Ee).join("")));break;case"quoted-printable":de=hf(H.slice(Ee));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+z)}var xe=el(O,M.slice(R.length),de,{unsafe:!0});G&&(xe.ctype=G)}function Br(O,H){if(U(O.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var R=H&&H.root||"",M=(ot&&Buffer.isBuffer(O)?O.toString("binary"):U(O)).split(`\r
`),z=0,G="";for(z=0;z<M.length;++z)if(G=M[z],!!/^Content-Location:/i.test(G)&&(G=G.slice(G.indexOf("file")),R||(R=G.slice(0,G.lastIndexOf("/")+1)),G.slice(0,R.length)!=R))for(;R.length>0&&(R=R.slice(0,R.length-1),R=R.slice(0,R.lastIndexOf("/")+1),G.slice(0,R.length)!=R););var de=(M[1]||"").match(/boundary="(.*?)"/);if(!de)throw new Error("MAD cannot find boundary");var Ee="--"+(de[1]||""),ue=[],he=[],xe={FileIndex:ue,FullPaths:he};E(xe);var _e,Re=0;for(z=0;z<M.length;++z){var We=M[z];We!==Ee&&We!==Ee+"--"||(Re++&&Dt(xe,M.slice(_e,z),R),_e=z)}return xe}function wo(O,H){var R=H||{},M=R.boundary||"SheetJS";M="------="+M;for(var z=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+M.slice(2)+'"',"","",""],G=O.FullPaths[0],de=G,Ee=O.FileIndex[0],ue=1;ue<O.FullPaths.length;++ue)if(de=O.FullPaths[ue].slice(G.length),Ee=O.FileIndex[ue],!(!Ee.size||!Ee.content||de=="Sh33tJ5")){de=de.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(tt){return"_x"+tt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(tt){return"_u"+tt.charCodeAt(0).toString(16)+"_"});for(var he=Ee.content,xe=ot&&Buffer.isBuffer(he)?he.toString("binary"):U(he),_e=0,Re=Math.min(1024,xe.length),We=0,Ie=0;Ie<=Re;++Ie)(We=xe.charCodeAt(Ie))>=32&&We<128&&++_e;var Be=_e>=Re*4/5;z.push(M),z.push("Content-Location: "+(R.root||"file:///C:/SheetJS/")+de),z.push("Content-Transfer-Encoding: "+(Be?"quoted-printable":"base64")),z.push("Content-Type: "+Qc(Ee,de)),z.push(""),z.push(Be?ff(xe):Zc(xe))}return z.push(M+`--\r
`),z.join(`\r
`)}function fv(O){var H={};return E(H,O),H}function el(O,H,R,M){var z=M&&M.unsafe;z||E(O);var G=!z&&ct.find(O,H);if(!G){var de=O.FullPaths[0];H.slice(0,de.length)==de?de=H:(de.slice(-1)!="/"&&(de+="/"),de=(de+H).replace("//","/")),G={name:a(H),type:2},O.FileIndex.push(G),O.FullPaths.push(de),z||ct.utils.cfb_gc(O)}return G.content=R,G.size=R?R.length:0,M&&(M.CLSID&&(G.clsid=M.CLSID),M.mt&&(G.mt=M.mt),M.ct&&(G.ct=M.ct)),G}function hv(O,H){E(O);var R=ct.find(O,H);if(R){for(var M=0;M<O.FileIndex.length;++M)if(O.FileIndex[M]==R)return O.FileIndex.splice(M,1),O.FullPaths.splice(M,1),!0}return!1}function pv(O,H,R){E(O);var M=ct.find(O,H);if(M){for(var z=0;z<O.FileIndex.length;++z)if(O.FileIndex[z]==M)return O.FileIndex[z].name=a(R),O.FullPaths[z]=R,!0}return!1}function mv(O){w(O,!0)}return r.find=P,r.read=k,r.parse=d,r.write=me,r.writeFile=ye,r.utils={cfb_new:fv,cfb_add:el,cfb_del:hv,cfb_mov:pv,cfb_gc:mv,ReadShift:Ci,CheckField:Ym,prep_blob:sr,bconcat:da,use_zlib:D,_deflateRaw:Pe,_inflateRaw:Rt,consts:K},r}();function i2(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(e);r.open("r"),r.encoding="binary";var t=r.read();return r.close(),t}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Bn(e){for(var r=Object.keys(e),t=[],n=0;n<r.length;++n)Object.prototype.hasOwnProperty.call(e,r[n])&&t.push(r[n]);return t}function Vu(e){for(var r=[],t=Bn(e),n=0;n!==t.length;++n)r[e[t[n]]]=t[n];return r}var tc=new Date(1899,11,30,0,0,0);function Cr(e,r){var t=e.getTime();r&&(t-=1462*24*60*60*1e3);var n=tc.getTime()+(e.getTimezoneOffset()-tc.getTimezoneOffset())*6e4;return(t-n)/(24*60*60*1e3)}var km=new Date,o2=tc.getTime()+(km.getTimezoneOffset()-tc.getTimezoneOffset())*6e4,n0=km.getTimezoneOffset();function Ic(e){var r=new Date;return r.setTime(e*24*60*60*1e3+o2),r.getTimezoneOffset()!==n0&&r.setTime(r.getTime()+(r.getTimezoneOffset()-n0)*6e4),r}function c2(e){var r=0,t=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(t=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":t*=24;case"H":t*=60;case"M":if(n)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}r+=t*parseInt(a[s],10)}return r}var a0=new Date("2017-02-19T19:06:09.000Z"),Am=isNaN(a0.getFullYear())?new Date("2/19/17"):a0,l2=Am.getFullYear()==2017;function nr(e,r){var t=new Date(e);if(l2)return r>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):r<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(Am.getFullYear()==1917&&!isNaN(t.getFullYear())){var n=t.getFullYear();return e.indexOf(""+n)>-1||t.setFullYear(t.getFullYear()+100),t}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function ss(e,r){if(ot&&Buffer.isBuffer(e)){if(r){if(e[0]==255&&e[1]==254)return ki(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return ki(fm(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(e[0]==255&&e[1]==254)return ki(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return ki(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"â‚¬":"Â€","â€š":"Â‚",Æ’:"Âƒ","â€ž":"Â„","â€¦":"Â…","â€ ":"Â†","â€¡":"Â‡","Ë†":"Âˆ","â€°":"Â‰",Å :"ÂŠ","â€¹":"Â‹",Å’:"ÂŒ",Å½:"ÂŽ","â€˜":"Â‘","â€™":"Â’","â€œ":"Â“","â€":"Â”","â€¢":"Â•","â€“":"Â–","â€”":"Â—","Ëœ":"Â˜","â„¢":"Â™",Å¡:"Âš","â€º":"Â›",Å“:"Âœ",Å¾:"Âž",Å¸:"ÂŸ"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[â‚¬â€šÆ’â€žâ€¦â€ â€¡Ë†â€°Å â€¹Å’Å½â€˜â€™â€œâ€â€¢â€“â€”Ëœâ„¢Å¡â€ºÅ“Å¾Å¸]/g,function(s){return t[s]||s})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function or(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=or(e[t]));return r}function Ft(e,r){for(var t="";t.length<r;)t+=e;return t}function Sn(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(r=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return t=-t,s}),!isNaN(r=Number(n)))?r/t:r}var u2=["january","february","march","april","may","june","july","august","september","october","november","december"];function qs(e){var r=new Date(e),t=new Date(NaN),n=r.getYear(),a=r.getMonth(),s=r.getDate();if(isNaN(s))return t;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&u2.indexOf(i)==-1)return t}else if(i.match(/[a-z]/))return t;return n<0||n>8099?t:(a>0||s>1)&&n!=101?r:e.match(/[^-0-9:,\/\\]/)?t:r}var d2=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,n,a){if(e||typeof n=="string")return t.split(n);for(var s=t.split(n),i=[s[0]],c=1;c<s.length;++c)i.push(a),i.push(s[c]);return i}}();function Cm(e){return e?e.content&&e.type?ss(e.content,!0):e.data?Si(e.data):e.asNodeBuffer&&ot?Si(e.asNodeBuffer().toString("binary")):e.asBinary?Si(e.asBinary()):e._data&&e._data.getContent?Si(ss(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function _m(e){if(!e)return null;if(e.data)return Gf(e.data);if(e.asNodeBuffer&&ot)return e.asNodeBuffer();if(e._data&&e._data.getContent){var r=e._data.getContent();return typeof r=="string"?Gf(r):Array.prototype.slice.call(r)}return e.content&&e.type?e.content:null}function f2(e){return e&&e.name.slice(-4)===".bin"?_m(e):Cm(e)}function nn(e,r){for(var t=e.FullPaths||Bn(e.files),n=r.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<t.length;++s){var i=t[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||a==i)return e.files?e.files[t[s]]:e.FileIndex[s]}return null}function Wu(e,r){var t=nn(e,r);if(t==null)throw new Error("Cannot find file "+r+" in zip");return t}function Ut(e,r,t){if(!t)return f2(Wu(e,r));if(!r)return null;try{return Ut(e,r)}catch{return null}}function zr(e,r,t){if(!t)return Cm(Wu(e,r));if(!r)return null;try{return zr(e,r)}catch{return null}}function Dm(e,r,t){if(!t)return _m(Wu(e,r));if(!r)return null;try{return Dm(e,r)}catch{return null}}function s0(e){for(var r=e.FullPaths||Bn(e.files),t=[],n=0;n<r.length;++n)r[n].slice(-1)!="/"&&t.push(r[n].replace(/^Root Entry[\/]/,""));return t.sort()}function h2(e,r,t){if(e.FullPaths){if(typeof t=="string"){var n;return ot?n=ls(t):n=Ow(t),ct.utils.cfb_add(e,r,n)}ct.utils.cfb_add(e,r,t)}else e.file(r,t)}function Fm(e,r){switch(r.type){case"base64":return ct.read(e,{type:"base64"});case"binary":return ct.read(e,{type:"binary"});case"buffer":case"array":return ct.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function Ti(e,r){if(e.charAt(0)=="/")return e.slice(1);var t=r.split("/");r.slice(-1)!="/"&&t.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?t.pop():a!=="."&&t.push(a)}return t.join("/")}var Im=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,p2=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,i0=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,m2=/<[^>]*>/g,wr=Im.match(i0)?i0:m2,x2=/<\w*:/,g2=/<(\/?)\w+:/;function Ke(e,r,t){for(var n={},a=0,s=0;a!==e.length&&!((s=e.charCodeAt(a))===32||s===10||s===13);++a);if(r||(n[0]=e.slice(0,a)),a===e.length)return n;var i=e.match(p2),c=0,l="",u=0,d="",f="",h=1;if(i)for(u=0;u!=i.length;++u){for(f=i[u],s=0;s!=f.length&&f.charCodeAt(s)!==61;++s);for(d=f.slice(0,s).trim();f.charCodeAt(s+1)==32;)++s;for(h=(a=f.charCodeAt(s+1))==34||a==39?1:0,l=f.slice(s+1+h,f.length-h),c=0;c!=d.length&&d.charCodeAt(c)!==58;++c);if(c===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=l,t||(n[d.toLowerCase()]=l);else{var x=(c===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(c+1);if(n[x]&&d.slice(c-3,c)=="ext")continue;n[x]=l,t||(n[x.toLowerCase()]=l)}}return n}function Vn(e){return e.replace(g2,"<$1")}var Pm={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},v2=Vu(Pm),dt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;return function t(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(e,function(c,l){return Pm[c]||String.fromCharCode(parseInt(l,c.indexOf("x")>-1?16:10))||c}).replace(r,function(c,l){return String.fromCharCode(parseInt(l,16))});var i=a.indexOf("]]>");return t(a.slice(0,s))+a.slice(s+9,i)+t(a.slice(i+3))}}(),y2=/[&<>'"]/g,b2=/[\u0000-\u001f]/g;function Hu(e){var r=e+"";return r.replace(y2,function(t){return v2[t]}).replace(/\n/g,"<br/>").replace(b2,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}var o0=function(){var e=/&#(\d+);/g;function r(t,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,r)}}();function bt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function dl(e){for(var r="",t=0,n=0,a=0,s=0,i=0,c=0;t<e.length;){if(n=e.charCodeAt(t++),n<128){r+=String.fromCharCode(n);continue}if(a=e.charCodeAt(t++),n>191&&n<224){i=(n&31)<<6,i|=a&63,r+=String.fromCharCode(i);continue}if(s=e.charCodeAt(t++),n<240){r+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}i=e.charCodeAt(t++),c=((n&7)<<18|(a&63)<<12|(s&63)<<6|i&63)-65536,r+=String.fromCharCode(55296+(c>>>10&1023)),r+=String.fromCharCode(56320+(c&1023))}return r}function c0(e){var r=xa(2*e.length),t,n,a=1,s=0,i=0,c;for(n=0;n<e.length;n+=a)a=1,(c=e.charCodeAt(n))<128?t=c:c<224?(t=(c&31)*64+(e.charCodeAt(n+1)&63),a=2):c<240?(t=(c&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,t=(c&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),t-=65536,i=55296+(t>>>10&1023),t=56320+(t&1023)),i!==0&&(r[s++]=i&255,r[s++]=i>>>8,i=0),r[s++]=t%256,r[s++]=t>>>8;return r.slice(0,s).toString("ucs2")}function l0(e){return ls(e,"binary").toString("utf8")}var To="foo bar bazÃ¢Â˜ÂƒÃ°ÂŸÂÂ£",xt=ot&&(l0(To)==dl(To)&&l0||c0(To)==dl(To)&&c0)||dl,ki=ot?function(e){return ls(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,n=0,a=0;t<e.length;)switch(n=e.charCodeAt(t++),!0){case n<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(t++)-56320+(n<<10),r.push(String.fromCharCode(240+(a>>18&7))),r.push(String.fromCharCode(144+(a>>12&63))),r.push(String.fromCharCode(128+(a>>6&63))),r.push(String.fromCharCode(128+(a&63)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)))}return r.join("")},Wi=function(){var e={};return function(t,n){var a=t+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",n||"")}}(),Om=function(){var e=[["nbsp"," "],["middot","Â·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),w2=function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),S2=/<\/?(?:vt:)?variant>/g,E2=/<(?:vt:)([^>]*)>([\s\S]*)</;function u0(e,r){var t=Ke(e),n=e.match(w2(t.baseType))||[],a=[];if(n.length!=t.size){if(r.WTF)throw new Error("unexpected vector length "+n.length+" != "+t.size);return a}return n.forEach(function(s){var i=s.replace(S2,"").match(E2);i&&a.push({v:xt(i[2]),t:i[1]})}),a}var T2=/(^\s|\s$|\n)/;function k2(e){return Bn(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function A2(e,r,t){return"<"+e+(t!=null?k2(t):"")+(r!=null?(r.match(T2)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function zu(e){if(ot&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return xt(us(Bu(e)));throw new Error("Bad input format: expected Buffer or string")}var Hi=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,C2={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},_2=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function D2(e,r){for(var t=1-2*(e[r+7]>>>7),n=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),a=e[r+6]&15,s=5;s>=0;--s)a=a*256+e[r+s];return n==2047?a==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),t*Math.pow(2,n-52)*a)}function F2(e,r,t){var n=(r<0||1/r==-1/0?1:0)<<7,a=0,s=0,i=n?-r:r;isFinite(i)?i==0?a=s=0:(a=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(r)?26985:0);for(var c=0;c<=5;++c,s/=256)e[t+c]=s&255;e[t+6]=(a&15)<<4|s&15,e[t+7]=a>>4|n}var d0=function(e){for(var r=[],t=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,s=e[0][n].length;a<s;a+=t)r.push.apply(r,e[0][n].slice(a,a+t));return r},f0=ot?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:ls(r)})):d0(e)}:d0,h0=function(e,r,t){for(var n=[],a=r;a<t;a+=2)n.push(String.fromCharCode(Xn(e,a)));return n.join("").replace(Ar,"")},Gu=ot?function(e,r,t){return Buffer.isBuffer(e)?e.toString("utf16le",r,t).replace(Ar,""):h0(e,r,t)}:h0,p0=function(e,r,t){for(var n=[],a=r;a<r+t;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},jm=ot?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):p0(e,r,t)}:p0,m0=function(e,r,t){for(var n=[],a=r;a<t;a++)n.push(String.fromCharCode(Is(e,a)));return n.join("")},oo=ot?function(r,t,n){return Buffer.isBuffer(r)?r.toString("utf8",t,n):m0(r,t,n)}:m0,Rm=function(e,r){var t=Hr(e,r);return t>0?oo(e,r+4,r+4+t-1):""},Nm=Rm,Mm=function(e,r){var t=Hr(e,r);return t>0?oo(e,r+4,r+4+t-1):""},Lm=Mm,Bm=function(e,r){var t=2*Hr(e,r);return t>0?oo(e,r+4,r+4+t-1):""},$m=Bm,Um=function(r,t){var n=Hr(r,t);return n>0?Gu(r,t+4,t+4+n):""},Vm=Um,Wm=function(e,r){var t=Hr(e,r);return t>0?oo(e,r+4,r+4+t):""},Hm=Wm,zm=function(e,r){return D2(e,r)},rc=zm,Gm=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};ot&&(Nm=function(r,t){if(!Buffer.isBuffer(r))return Rm(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},Lm=function(r,t){if(!Buffer.isBuffer(r))return Mm(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},$m=function(r,t){if(!Buffer.isBuffer(r))return Bm(r,t);var n=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n-1)},Vm=function(r,t){if(!Buffer.isBuffer(r))return Um(r,t);var n=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n)},Hm=function(r,t){if(!Buffer.isBuffer(r))return Wm(r,t);var n=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+n)},rc=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):zm(r,t)},Gm=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var Is=function(e,r){return e[r]},Xn=function(e,r){return e[r+1]*256+e[r]},I2=function(e,r){var t=e[r+1]*256+e[r];return t<32768?t:(65535-t+1)*-1},Hr=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},La=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},P2=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function Ci(e,r){var t="",n,a,s=[],i,c,l,u;switch(r){case"dbcs":if(u=this.l,ot&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)t+=String.fromCharCode(Xn(this,u)),u+=2;e*=2;break;case"utf8":t=oo(this,this.l,this.l+e);break;case"utf16le":e*=2,t=Gu(this,this.l,this.l+e);break;case"wstr":return Ci.call(this,e,"dbcs");case"lpstr-ansi":t=Nm(this,this.l),e=4+Hr(this,this.l);break;case"lpstr-cp":t=Lm(this,this.l),e=4+Hr(this,this.l);break;case"lpwstr":t=$m(this,this.l),e=4+2*Hr(this,this.l);break;case"lpp4":e=4+Hr(this,this.l),t=Vm(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Hr(this,this.l),t=Hm(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(i=Is(this,this.l+e++))!==0;)s.push(Eo(i));t=s.join("");break;case"_wstr":for(e=0,t="";(i=Xn(this,this.l+e))!==0;)s.push(Eo(i)),e+=2;e+=2,t=s.join("");break;case"dbcs-cont":for(t="",u=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Is(this,u),this.l=u+1,c=Ci.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),s.join("")+c;s.push(Eo(Xn(this,u))),u+=2}t=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",u=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Is(this,u),this.l=u+1,c=Ci.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),s.join("")+c;s.push(Eo(Is(this,u))),u+=1}t=s.join("");break;default:switch(e){case 1:return n=Is(this,this.l),this.l++,n;case 2:return n=(r==="i"?I2:Xn)(this,this.l),this.l+=2,n;case 4:case-4:return r==="i"||!(this[this.l+3]&128)?(n=(e>0?La:P2)(this,this.l),this.l+=4,n):(a=Hr(this,this.l),this.l+=4,a);case 8:case-8:if(r==="f")return e==8?a=rc(this,this.l):a=rc([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:t=jm(this,this.l,e);break}}return this.l+=e,t}var O2=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},j2=function(e,r,t){e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},R2=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255};function N2(e,r,t){var n=0,a=0;if(t==="dbcs"){for(a=0;a!=r.length;++a)R2(this,r.charCodeAt(a),this.l+2*a);n=2*r.length}else if(t==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=r.length;++a)this[this.l+a]=r.charCodeAt(a)&255;n=r.length}else if(t==="hex"){for(;a<e;++a)this[this.l++]=parseInt(r.slice(2*a,2*a+2),16)||0;return this}else if(t==="utf16le"){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(r.length,e);++a){var i=r.charCodeAt(a);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=r&255;break;case 2:n=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:n=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:n=4,O2(this,r,this.l);break;case 8:if(n=8,t==="f"){F2(this,r,this.l);break}case 16:break;case-4:n=4,j2(this,r,this.l);break}return this.l+=n,this}function Ym(e,r){var t=jm(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function sr(e,r){e.l=r,e.read_shift=Ci,e.chk=Ym,e.write_shift=N2}function br(e,r){e.l+=r}function Gt(e){var r=xa(e);return sr(r,0),r}function na(e,r,t){if(e){var n,a,s;sr(e,e.l||0);for(var i=e.length,c=0,l=0;e.l<i;){c=e.read_shift(1),c&128&&(c=(c&127)+((e.read_shift(1)&127)<<7));var u=cc[c]||cc[65535];for(n=e.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=e.read_shift(1))&127)<<7*a;l=e.l+s;var d=u.f&&u.f(e,s,t);if(e.l=l,r(d,u,c))return}}}function Hl(){var e=[],r=ot?256:2048,t=function(u){var d=Gt(u);return sr(d,0),d},n=t(r),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(a(),n=t(Math.max(u+1,r)))},i=function(){return a(),da(e)},c=function(u){a(),n=u,n.l==null&&(n.l=n.length),s(r)};return{next:s,push:c,end:i,_bufs:e}}function _i(e,r,t){var n=or(e);if(r.s?(n.cRel&&(n.c+=r.s.c),n.rRel&&(n.r+=r.s.r)):(n.cRel&&(n.c+=r.c),n.rRel&&(n.r+=r.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function x0(e,r,t){var n=or(e);return n.s=_i(n.s,r.s,t),n.e=_i(n.e,r.s,t),n}function Di(e,r){if(e.cRel&&e.c<0)for(e=or(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=or(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=Qe(e);return!e.cRel&&e.cRel!=null&&(t=B2(t)),!e.rRel&&e.rRel!=null&&(t=M2(t)),t}function fl(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+qt(e.s.c)+":"+(e.e.cRel?"":"$")+qt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+cr(e.s.r)+":"+(e.e.rRel?"":"$")+cr(e.e.r):Di(e.s,r.biff)+":"+Di(e.e,r.biff)}function Yu(e){return parseInt(L2(e),10)-1}function cr(e){return""+(e+1)}function M2(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function L2(e){return e.replace(/\$(\d+)$/,"$1")}function qu(e){for(var r=$2(e),t=0,n=0;n!==r.length;++n)t=26*t+r.charCodeAt(n)-64;return t-1}function qt(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function B2(e){return e.replace(/^([A-Z])/,"$$$1")}function $2(e){return e.replace(/^\$([A-Z])/,"$1")}function U2(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Tr(e){for(var r=0,t=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?r=10*r+(a-48):a>=65&&a<=90&&(t=26*t+(a-64))}return{c:t-1,r:r-1}}function Qe(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function ai(e){var r=e.indexOf(":");return r==-1?{s:Tr(e),e:Tr(e)}:{s:Tr(e.slice(0,r)),e:Tr(e.slice(r+1))}}function lt(e,r){return typeof r>"u"||typeof r=="number"?lt(e.s,e.e):(typeof e!="string"&&(e=Qe(e)),typeof r!="string"&&(r=Qe(r)),e==r?e:e+":"+r)}function Pt(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,a=0,s=e.length;for(t=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)t=26*t+a;for(r.s.c=--t,t=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)t=10*t+a;if(r.s.r=--t,n===s||a!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++n,t=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)t=26*t+a;for(r.e.c=--t,t=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)t=10*t+a;return r.e.r=--t,r}function g0(e,r){var t=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=an(e.z,t?Cr(r):r)}catch{}try{return e.w=an((e.XF||{}).numFmtId||(t?14:0),t?Cr(r):r)}catch{return""+r}}function Zn(e,r,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?hs[e.v]||e.v:r==null?g0(e,e.v):g0(e,r))}function ba(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",n={};return n[t]=e,{SheetNames:[t],Sheets:n}}function qm(e,r,t){var n=t||{},a=e?Array.isArray(e):n.dense,s=e||(a?[]:{}),i=0,c=0;if(s&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?Tr(n.origin):n.origin;i=l.r,c=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=Pt(s["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),i==-1&&(u.e.r=i=d.e.r+1)}for(var f=0;f!=r.length;++f)if(r[f]){if(!Array.isArray(r[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=r[f].length;++h)if(!(typeof r[f][h]>"u")){var x={v:r[f][h]},p=i+f,m=c+h;if(u.s.r>p&&(u.s.r=p),u.s.c>m&&(u.s.c=m),u.e.r<p&&(u.e.r=p),u.e.c<m&&(u.e.c=m),r[f][h]&&typeof r[f][h]=="object"&&!Array.isArray(r[f][h])&&!(r[f][h]instanceof Date))x=r[f][h];else if(Array.isArray(x.v)&&(x.f=r[f][h][1],x.v=x.v[0]),x.v===null)if(x.f)x.t="n";else if(n.nullError)x.t="e",x.v=0;else if(n.sheetStubs)x.t="z";else continue;else typeof x.v=="number"?x.t="n":typeof x.v=="boolean"?x.t="b":x.v instanceof Date?(x.z=n.dateNF||rt[14],n.cellDates?(x.t="d",x.w=an(x.z,Cr(x.v))):(x.t="n",x.v=Cr(x.v),x.w=an(x.z,x.v))):x.t="s";if(a)s[p]||(s[p]=[]),s[p][m]&&s[p][m].z&&(x.z=s[p][m].z),s[p][m]=x;else{var g=Qe({c:m,r:p});s[g]&&s[g].z&&(x.z=s[g].z),s[g]=x}}}return u.s.c<1e7&&(s["!ref"]=lt(u)),s}function si(e,r){return qm(null,e,r)}function V2(e){return e.read_shift(4,"i")}function yr(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function W2(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Xu(e,r){var t=e.l,n=e.read_shift(1),a=yr(e),s=[],i={t:a,h:a};if(n&1){for(var c=e.read_shift(4),l=0;l!=c;++l)s.push(W2(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=t+r,i}var H2=Xu;function on(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function ds(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}var z2=yr;function Ku(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}var G2=yr,zl=Ku;function Ju(e){var r=e.slice(e.l,e.l+4),t=r[0]&1,n=r[0]&2;e.l+=4;var a=n===0?rc([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):La(r,0)>>2;return t?a/100:a}function Xm(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}var fs=Xm;function xr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Y2(e){var r={},t=e.read_shift(1),n=t>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),i=e.read_shift(1),c=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:r.auto=1;break;case 1:r.index=a;var u=Wa[a];u&&(r.rgb=Gi(u));break;case 2:r.rgb=Gi([i,c,l]);break;case 3:r.theme=a;break}return s!=0&&(r.tint=s>0?s/32767:s/32768),r}function q2(e){var r=e.read_shift(1);e.l++;var t={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return t}function Km(e,r){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,r==1?"lpstr":"lpwstr")}function X2(e){return Km(e,1)}function K2(e){return Km(e,2)}var Qu=2,Ir=3,ko=11,v0=12,nc=19,Ao=64,J2=65,Q2=71,Z2=4108,eS=4126,tr=80,Jm=81,tS=[tr,Jm],rS={1:{n:"CodePage",t:Qu},2:{n:"Category",t:tr},3:{n:"PresentationFormat",t:tr},4:{n:"ByteCount",t:Ir},5:{n:"LineCount",t:Ir},6:{n:"ParagraphCount",t:Ir},7:{n:"SlideCount",t:Ir},8:{n:"NoteCount",t:Ir},9:{n:"HiddenCount",t:Ir},10:{n:"MultimediaClipCount",t:Ir},11:{n:"ScaleCrop",t:ko},12:{n:"HeadingPairs",t:Z2},13:{n:"TitlesOfParts",t:eS},14:{n:"Manager",t:tr},15:{n:"Company",t:tr},16:{n:"LinksUpToDate",t:ko},17:{n:"CharacterCount",t:Ir},19:{n:"SharedDoc",t:ko},22:{n:"HyperlinksChanged",t:ko},23:{n:"AppVersion",t:Ir,p:"version"},24:{n:"DigSig",t:J2},26:{n:"ContentType",t:tr},27:{n:"ContentStatus",t:tr},28:{n:"Language",t:tr},29:{n:"Version",t:tr},255:{},2147483648:{n:"Locale",t:nc},2147483651:{n:"Behavior",t:nc},1919054434:{}},nS={1:{n:"CodePage",t:Qu},2:{n:"Title",t:tr},3:{n:"Subject",t:tr},4:{n:"Author",t:tr},5:{n:"Keywords",t:tr},6:{n:"Comments",t:tr},7:{n:"Template",t:tr},8:{n:"LastAuthor",t:tr},9:{n:"RevNumber",t:tr},10:{n:"EditTime",t:Ao},11:{n:"LastPrinted",t:Ao},12:{n:"CreatedDate",t:Ao},13:{n:"ModifiedDate",t:Ao},14:{n:"PageCount",t:Ir},15:{n:"WordCount",t:Ir},16:{n:"CharCount",t:Ir},17:{n:"Thumbnail",t:Q2},18:{n:"Application",t:tr},19:{n:"DocSecurity",t:Ir},255:{},2147483648:{n:"Locale",t:nc},2147483651:{n:"Behavior",t:nc},1919054434:{}},y0={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},aS=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function sS(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var iS=sS([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Wa=or(iS),hs={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Qm={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},b0={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function oS(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function cS(e){var r=oS();if(!e||!e.match)return r;var t={};if((e.match(wr)||[]).forEach(function(n){var a=Ke(n);switch(a[0].replace(x2,"<")){case"<?xml":break;case"<Types":r.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[a.Extension]=a.ContentType;break;case"<Override":r[b0[a.ContentType]]!==void 0&&r[b0[a.ContentType]].push(a.PartName);break}}),r.xmlns!==C2.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=t,delete r.calcchains,r}var Os={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Gl(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function Fi(e,r){var t={"!id":{}};if(!e)return t;r.charAt(0)!=="/"&&(r="/"+r);var n={};return(e.match(wr)||[]).forEach(function(a){var s=Ke(a);if(s[0]==="<Relationship"){var i={};i.Type=s.Type,i.Target=s.Target,i.Id=s.Id,s.TargetMode&&(i.TargetMode=s.TargetMode);var c=s.TargetMode==="External"?s.Target:Ti(s.Target,r);t[c]=i,n[s.Id]=i}}),t["!id"]=n,t}var lS="application/vnd.oasis.opendocument.spreadsheet";function uS(e,r){for(var t=zu(e),n,a;n=Hi.exec(t);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Ke(n[0],!1),a.path=="/"&&a.type!==lS)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw n}}var Ii=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],dS=function(){for(var e=new Array(Ii.length),r=0;r<Ii.length;++r){var t=Ii[r],n="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[r]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function Zm(e){var r={};e=xt(e);for(var t=0;t<Ii.length;++t){var n=Ii[t],a=e.match(dS[t]);a!=null&&a.length>0&&(r[n[1]]=dt(a[1])),n[2]==="date"&&r[n[1]]&&(r[n[1]]=nr(r[n[1]]))}return r}var fS=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function ex(e,r,t,n){var a=[];if(typeof e=="string")a=u0(e,n);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map(function(d){return{v:d}}));var i=typeof r=="string"?u0(r,n).map(function(d){return d.v}):r,c=0,l=0;if(i.length>0)for(var u=0;u!==a.length;u+=2){switch(l=+a[u+1].v,a[u].v){case"Worksheets":case"å·¥ä½œè¡¨":case"Ð›Ð¸ÑÑ‚Ñ‹":case"Ø£ÙˆØ±Ø§Ù‚ Ø§Ù„Ø¹Ù…Ù„":case"ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆ":case"×’×œ×™×•× ×•×ª ×¢×‘×•×“×”":case"ArbeitsblÃ¤tter":case"Ã‡alÄ±ÅŸma SayfalarÄ±":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cÃ¡lculo":case"Planilhas":case"Regneark":case"Hojas de cÃ¡lculo":case"Werkbladen":t.Worksheets=l,t.SheetNames=i.slice(c,c+l);break;case"Named Ranges":case"Rangos con nombre":case"åå‰ä»˜ãä¸€è¦§":case"Benannte Bereiche":case"Navngivne omrÃ¥der":t.NamedRanges=l,t.DefinedNames=i.slice(c,c+l);break;case"Charts":case"Diagramme":t.Chartsheets=l,t.ChartNames=i.slice(c,c+l);break}c+=l}}function hS(e,r,t){var n={};return r||(r={}),e=xt(e),fS.forEach(function(a){var s=(e.match(Wi(a[0]))||[])[1];switch(a[2]){case"string":s&&(r[a[1]]=dt(s));break;case"bool":r[a[1]]=s==="true";break;case"raw":var i=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));i&&i.length>0&&(n[a[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&ex(n.HeadingPairs,n.TitlesOfParts,r,t),r}var pS=/<[^>]+>[^<]*/g;function mS(e,r){var t={},n="",a=e.match(pS);if(a)for(var s=0;s!=a.length;++s){var i=a[s],c=Ke(i);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":n=dt(c.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var l=i.split(">"),u=l[0].slice(4),d=l[1];switch(u){case"lpstr":case"bstr":case"lpwstr":t[n]=dt(d);break;case"bool":t[n]=bt(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":t[n]=parseFloat(d);break;case"filetime":case"date":t[n]=nr(d);break;case"cy":case"error":t[n]=dt(d);break;default:if(u.slice(-1)=="/")break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",i,u,l)}}else if(i.slice(0,2)!=="</"){if(r.WTF)throw new Error(i)}}}return t}var xS={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},hl;function gS(e,r,t){hl||(hl=Vu(xS)),r=hl[r]||r,e[r]=t}function Zu(e){var r=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function tx(e,r,t){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-n&3;)++e.l;return a}function rx(e,r,t){var n=e.read_shift(0,"lpwstr");return t&&(e.l+=4-(n.length+1&3)&3),n}function nx(e,r,t){return r===31?rx(e):tx(e,r,t)}function Yl(e,r,t){return nx(e,r,t===!1?0:4)}function vS(e,r){if(!r)throw new Error("VtUnalignedString must have positive length");return nx(e,r,0)}function yS(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n){var a=e.l;t[n]=e.read_shift(0,"lpwstr").replace(Ar,""),e.l-a&2&&(e.l+=2)}return t}function bS(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n)t[n]=e.read_shift(0,"lpstr-cp").replace(Ar,"");return t}function wS(e){var r=e.l,t=ac(e,Jm);e[e.l]==0&&e[e.l+1]==0&&e.l-r&2&&(e.l+=2);var n=ac(e,Ir);return[t,n]}function SS(e){for(var r=e.read_shift(4),t=[],n=0;n<r/2;++n)t.push(wS(e));return t}function w0(e,r){for(var t=e.read_shift(4),n={},a=0;a!=t;++a){var s=e.read_shift(4),i=e.read_shift(4);n[s]=e.read_shift(i,r===1200?"utf16le":"utf8").replace(Ar,"").replace(Ei,"!"),r===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>2+1<<2),n}function ax(e){var r=e.read_shift(4),t=e.slice(e.l,e.l+r);return e.l+=r,(r&3)>0&&(e.l+=4-(r&3)&3),t}function ES(e){var r={};return r.Size=e.read_shift(4),e.l+=r.Size+3-(r.Size-1)%4,r}function ac(e,r,t){var n=e.read_shift(2),a,s=t||{};if(e.l+=2,r!==v0&&n!==r&&tS.indexOf(r)===-1&&!((r&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+r+" saw "+n);switch(r===v0?n:r){case 2:return a=e.read_shift(2,"i"),s.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return tx(e,n,4).replace(Ar,"");case 31:return rx(e);case 64:return Zu(e);case 65:return ax(e);case 71:return ES(e);case 80:return Yl(e,n,!s.raw).replace(Ar,"");case 81:return vS(e,n).replace(Ar,"");case 4108:return SS(e);case 4126:case 4127:return n==4127?yS(e):bS(e);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+n)}}function S0(e,r){var t=e.l,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0,c=0,l=-1,u={};for(i=0;i!=a;++i){var d=e.read_shift(4),f=e.read_shift(4);s[i]=[d,f+t]}s.sort(function(y,b){return y[1]-b[1]});var h={};for(i=0;i!=a;++i){if(e.l!==s[i][1]){var x=!0;if(i>0&&r)switch(r[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,x=!1);break;case 80:e.l<=s[i][1]&&(e.l=s[i][1],x=!1);break;case 4108:e.l<=s[i][1]&&(e.l=s[i][1],x=!1);break}if((!r||i==0)&&e.l<=s[i][1]&&(x=!1,e.l=s[i][1]),x)throw new Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(r){var p=r[s[i][0]];if(h[p.n]=ac(e,p.t,{raw:!0}),p.p==="version"&&(h[p.n]=String(h[p.n]>>16)+"."+("0000"+String(h[p.n]&65535)).slice(-4)),p.n=="CodePage")switch(h[p.n]){case 0:h[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:vn(c=h[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[p.n])}}else if(s[i][0]===1){if(c=h.CodePage=ac(e,Qu),vn(c),l!==-1){var m=e.l;e.l=s[l][1],u=w0(e,c),e.l=m}}else if(s[i][0]===0){if(c===0){l=i,e.l=s[i+1][1];continue}u=w0(e,c)}else{var g=u[s[i][0]],v;switch(e[e.l]){case 65:e.l+=4,v=ax(e);break;case 30:e.l+=4,v=Yl(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,v=Yl(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,v=e.read_shift(4,"i");break;case 19:e.l+=4,v=e.read_shift(4);break;case 5:e.l+=4,v=e.read_shift(8,"f");break;case 11:e.l+=4,v=Nt(e,4);break;case 64:e.l+=4,v=nr(Zu(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[g]=v}}return e.l=t+n,h}function E0(e,r,t){var n=e.content;if(!n)return{};sr(n,0);var a,s,i,c,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),d=n.read_shift(16);if(d!==ct.utils.consts.HEADER_CLSID&&d!==t)throw new Error("Bad PropertySet CLSID "+d);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),c=n.read_shift(4),a===1&&c!==n.l)throw new Error("Length mismatch: "+c+" !== "+n.l);a===2&&(i=n.read_shift(16),l=n.read_shift(4));var f=S0(n,r),h={SystemIdentifier:u};for(var x in f)h[x]=f[x];if(h.FMTID=s,a===1)return h;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var p;try{p=S0(n,null)}catch{}for(x in p)h[x]=p[x];return h.FMTID=[s,i],h}function ia(e,r){return e.read_shift(r),null}function TS(e,r,t){for(var n=[],a=e.l+r;e.l<a;)n.push(t(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function Nt(e,r){return e.read_shift(r)===1}function Vt(e){return e.read_shift(2,"u")}function sx(e,r){return TS(e,r,Vt)}function kS(e){var r=e.read_shift(1),t=e.read_shift(1);return t===1?r:r===1}function co(e,r,t){var n=e.read_shift(t&&t.biff>=12?2:1),a="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else t.biff==12&&(a="wstr");t.biff>=2&&t.biff<=5&&(a="cpstr");var i=n?e.read_shift(n,a):"";return i}function AS(e){var r=e.read_shift(2),t=e.read_shift(1),n=t&4,a=t&8,s=1+(t&1),i=0,c,l={};a&&(i=e.read_shift(2)),n&&(c=e.read_shift(4));var u=s==2?"dbcs-cont":"sbcs-cont",d=r===0?"":e.read_shift(r,u);return a&&(e.l+=4*i),n&&(e.l+=c),l.t=d,a||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function is(e,r,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(r,"sbcs-cont"):n=e.read_shift(r,"dbcs-cont"),n}function lo(e,r,t){var n=e.read_shift(t&&t.biff==2?1:2);return n===0?(e.l++,""):is(e,n,t)}function ps(e,r,t){if(t.biff>5)return lo(e,r,t);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function CS(e){var r=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[r,t]}function _S(e){var r=e.read_shift(4),t=e.l,n=!1;r>24&&(e.l+=r-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=t);var a=e.read_shift((n?r-24:r)>>1,"utf16le").replace(Ar,"");return n&&(e.l+=24),a}function DS(e){for(var r=e.read_shift(2),t="";r-- >0;)t+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return t+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(s>>1,"utf16le").replace(Ar,"");return t+i}function FS(e,r){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return _S(e);case"0303000000000000c000000000000046":return DS(e);default:throw new Error("Unsupported Moniker "+t)}}function Co(e){var r=e.read_shift(4),t=r>0?e.read_shift(r,"utf16le").replace(Ar,""):"";return t}function IS(e,r){var t=e.l+r,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var s,i,c,l,u="",d,f;a&16&&(s=Co(e,t-e.l)),a&128&&(i=Co(e,t-e.l)),(a&257)===257&&(c=Co(e,t-e.l)),(a&257)===1&&(l=FS(e,t-e.l)),a&8&&(u=Co(e,t-e.l)),a&32&&(d=e.read_shift(16)),a&64&&(f=Zu(e)),e.l=t;var h=i||c||l||"";h&&u&&(h+="#"+u),h||(h="#"+u),a&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var x={Target:h};return d&&(x.guid=d),f&&(x.time=f),s&&(x.Tooltip=s),x}function ix(e){var r=e.read_shift(1),t=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[r,t,n,a]}function ox(e,r){var t=ix(e);return t[3]=0,t}function Wn(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return{r,c:t,ixfe:n}}function PS(e){var r=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:r,flags:t}}function OS(e,r,t){return r===0?"":ps(e,r,t)}function jS(e,r,t){var n=t.biff>8?4:2,a=e.read_shift(n),s=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[a,s,i]}function cx(e){var r=e.read_shift(2),t=Ju(e);return[r,t]}function RS(e,r,t){e.l+=4,r-=4;var n=e.l+r,a=co(e,r,t),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,a}function Pc(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r},e:{c:a,r:t}}}function lx(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r},e:{c:a,r:t}}}var NS=lx;function ux(e){e.l+=4;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[t,r,n]}function MS(e){var r={};return e.l+=4,e.l+=16,r.fSharedNote=e.read_shift(2),e.l+=4,r}function LS(e){var r={};return e.l+=4,e.cf=e.read_shift(2),r}function dr(e){e.l+=2,e.l+=e.read_shift(2)}var BS={0:dr,4:dr,5:dr,6:dr,7:LS,8:dr,9:dr,10:dr,11:dr,12:dr,13:MS,14:dr,15:dr,16:dr,17:dr,18:dr,19:dr,20:dr,21:ux};function $S(e,r){for(var t=e.l+r,n=[];e.l<t;){var a=e.read_shift(2);e.l-=2;try{n.push(BS[a](e,t-e.l))}catch{return e.l=t,n}}return e.l!=t&&(e.l=t),n}function _o(e,r){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),r-=2,r>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(r),t}function US(e,r){return r===0||e.read_shift(2),1200}function VS(e,r,t){if(t.enc)return e.l+=r,"";var n=e.l,a=ps(e,0,t);return e.read_shift(r+n-e.l),a}function WS(e,r,t){var n=t&&t.biff==8||r==2?e.read_shift(2):(e.l+=r,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function HS(e,r,t){var n=e.read_shift(4),a=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var i=co(e,0,t);return i.length===0&&(i="Sheet1"),{pos:n,hs:a,dt:s,name:i}}function zS(e,r){for(var t=e.l+r,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0;i!=a&&e.l<t;++i)s.push(AS(e));return s.Count=n,s.Unique=a,s}function GS(e,r){var t={};return t.dsst=e.read_shift(2),e.l+=r-2,t}function YS(e){var r={};r.r=e.read_shift(2),r.c=e.read_shift(2),r.cnt=e.read_shift(2)-r.c;var t=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(r.level=n&7),n&32&&(r.hidden=!0),n&64&&(r.hpt=t/20),r}function qS(e){var r=PS(e);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var t=e.read_shift(4);return t!==0}function XS(e){return e.read_shift(2),e.read_shift(4)}function T0(e,r,t){var n=0;t&&t.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);t&&t.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function KS(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),c=e.read_shift(2),l=e.read_shift(2),u=e.read_shift(2);return{Pos:[r,t],Dim:[n,a],Flags:s,CurTab:i,FirstTab:c,Selected:l,TabRatio:u}}function JS(e,r,t){if(t&&t.biff>=2&&t.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function QS(){}function ZS(e,r,t){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=co(e,0,t),n}function eE(e){var r=Wn(e);return r.isst=e.read_shift(4),r}function tE(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=e.l+r,a=Wn(e);t.biff==2&&e.l++;var s=lo(e,n-e.l,t);return a.val=s,a}function rE(e,r,t){var n=e.read_shift(2),a=ps(e,0,t);return[n,a]}var nE=ps;function k0(e,r,t){var n=e.l+r,a=t.biff==8||!t.biff?4:2,s=e.read_shift(a),i=e.read_shift(a),c=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:s,c},e:{r:i,c:l}}}function aE(e){var r=e.read_shift(2),t=e.read_shift(2),n=cx(e);return{r,c:t,ixfe:n[0],rknum:n[1]}}function sE(e,r){for(var t=e.l+r-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<t;)s.push(cx(e));if(e.l!==t)throw new Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:i,rkrec:s}}function iE(e,r){for(var t=e.l+r-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<t;)s.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:i,ixfe:s}}function oE(e,r,t,n){var a={},s=e.read_shift(4),i=e.read_shift(4),c=e.read_shift(4),l=e.read_shift(2);return a.patternType=aS[c>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=i&15,a.dgRight=i>>4&15,a.dgTop=i>>8&15,a.dgBottom=i>>12&15,a.icvLeft=i>>16&127,a.icvRight=i>>23&127,a.grbitDiag=i>>30&3,a.icvTop=c&127,a.icvBottom=c>>7&127,a.icvDiag=c>>14&127,a.dgDiag=c>>21&15,a.icvFore=l&127,a.icvBack=l>>7&127,a.fsxButton=l>>14&1),a}function cE(e,r,t){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,r-=6,n.data=oE(e,r,n.fStyle,t),n}function lE(e){e.l+=4;var r=[e.read_shift(2),e.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function A0(e,r,t){var n=Wn(e);(t.biff==2||r==9)&&++e.l;var a=kS(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function uE(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=Wn(e),a=xr(e);return n.val=a,n}var C0=OS;function dE(e,r,t){var n=e.l+r,a=e.read_shift(2),s=e.read_shift(2);if(t.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var i=is(e,s),c=[];n>e.l;)c.push(lo(e));return[s,a,i,c]}function _0(e,r,t){var n=e.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return t.sbcch===14849&&(a=RS(e,r-2,t)),s.body=a||e.read_shift(r-2),typeof a=="string"&&(s.Name=a),s}var fE=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function D0(e,r,t){var n=e.l+r,a=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1),c=e.read_shift(t&&t.biff==2?1:2),l=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),l=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var u=is(e,i,t);a&32&&(u=fE[u.charCodeAt(0)]);var d=n-e.l;t&&t.biff==2&&--d;var f=n==e.l||c===0||!(d>0)?[]:YA(e,d,t,c);return{chKey:s,Name:u,itab:l,rgce:f}}function dx(e,r,t){if(t.biff<8)return hE(e,r,t);for(var n=[],a=e.l+r,s=e.read_shift(t.biff>8?4:2);s--!==0;)n.push(jS(e,t.biff>8?12:6,t));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function hE(e,r,t){e[e.l+1]==3&&e[e.l]++;var n=co(e,r,t);return n.charCodeAt(0)==3?n.slice(1):n}function pE(e,r,t){if(t.biff<8){e.l+=r;return}var n=e.read_shift(2),a=e.read_shift(2),s=is(e,n,t),i=is(e,a,t);return[s,i]}function mE(e,r,t){var n=lx(e);e.l++;var a=e.read_shift(1);return r-=8,[qA(e,r,t),a,n]}function F0(e,r,t){var n=NS(e);switch(t.biff){case 2:e.l++,r-=7;break;case 3:case 4:e.l+=2,r-=8;break;default:e.l+=6,r-=12}return[n,zA(e,r,t)]}function xE(e){var r=e.read_shift(4)!==0,t=e.read_shift(4)!==0,n=e.read_shift(4);return[r,t,n]}function gE(e,r,t){if(!(t.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),c=ps(e,0,t);return t.biff<8&&e.read_shift(1),[{r:n,c:a},c,i,s]}}function vE(e,r,t){return gE(e,r,t)}function yE(e,r){for(var t=[],n=e.read_shift(2);n--;)t.push(Pc(e));return t}function bE(e,r,t){if(t&&t.biff<8)return SE(e,r,t);var n=ux(e),a=$S(e,r-22,n[1]);return{cmo:n,ft:a}}var wE={8:function(e,r){var t=e.l+r;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=t,{fmt:n}}};function SE(e,r,t){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,r-=36;var i=[];return i.push((wE[n]||br)(e,r,t)),{cmo:[a,n,s],ft:i}}function EE(e,r,t){var n=e.l,a="";try{e.l+=4;var s=(t.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:i=CS(e,6,t);var c=e.read_shift(2);e.read_shift(2),Vt(e,2);var l=e.read_shift(2);e.l+=l;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var d=e[e.l],f=is(e,e.lens[u+1]-e.lens[u]-1);if(a+=f,a.length>=(d?c:2*c))break}if(a.length!==c&&a.length!==c*2)throw new Error("cchText: "+c+" != "+a.length);return e.l=n+r,{t:a}}catch{return e.l=n+r,{t:a}}}function TE(e,r){var t=Pc(e);e.l+=16;var n=IS(e,r-24);return[t,n]}function kE(e,r){e.read_shift(2);var t=Pc(e),n=e.read_shift((r-10)/2,"dbcs-cont");return n=n.replace(Ar,""),[t,n]}function AE(e){var r=[0,0],t;return t=e.read_shift(2),r[0]=y0[t]||t,t=e.read_shift(2),r[1]=y0[t]||t,r}function CE(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(ox(e));return t}function _E(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(ox(e));return t}function DE(e){e.l+=2;var r={cxfs:0,crc:0};return r.cxfs=e.read_shift(2),r.crc=e.read_shift(4),r}function fx(e,r,t){if(!t.cellStyles)return br(e,r);var n=t&&t.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),i=e.read_shift(n),c=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var u={s:a,e:s,w:i,ixfe:c,flags:l};return(t.biff>=5||!t.biff)&&(u.level=l>>8&7),u}function FE(e,r){var t={};return r<32||(e.l+=16,t.header=xr(e),t.footer=xr(e),e.l+=2),t}function IE(e,r,t){var n={area:!1};if(t.biff!=5)return e.l+=r,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}var PE=Wn,OE=sx,jE=lo;function RE(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),a={fmt:r,env:t,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function NE(e,r,t){t.biffguess&&t.biff==5&&(t.biff=2);var n=Wn(e);++e.l;var a=ps(e,r-7,t);return n.t="str",n.val=a,n}function ME(e){var r=Wn(e);++e.l;var t=xr(e);return r.t="n",r.val=t,r}function LE(e){var r=Wn(e);++e.l;var t=e.read_shift(2);return r.t="n",r.val=t,r}function BE(e){var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,"sbcs-cont")}function $E(e,r){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=r-13}function UE(e,r,t){var n=e.l+r,a=Wn(e),s=e.read_shift(2),i=is(e,s,t);return e.l=n,a.t="str",a.val=i,a}var VE=[2,3,48,49,131,139,140,245],I0=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=Vu({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(c,l){var u=[],d=xa(1);switch(l.type){case"base64":d=gn(Kr(c));break;case"binary":d=gn(c);break;case"buffer":case"array":d=c;break}sr(d,0);var f=d.read_shift(1),h=!!(f&136),x=!1,p=!1;switch(f){case 2:break;case 3:break;case 48:x=!0,h=!0;break;case 49:x=!0,h=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var m=0,g=521;f==2&&(m=d.read_shift(2)),d.l+=3,f!=2&&(m=d.read_shift(4)),m>1048576&&(m=1e6),f!=2&&(g=d.read_shift(2));var v=d.read_shift(2),y=l.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(y=e[d[d.l]]),d.l+=1,d.l+=2),p&&(d.l+=36);for(var b=[],S={},I=Math.min(d.length,f==2?521:g-10-(x?264:0)),k=p?32:11;d.l<I&&d[d.l]!=13;)switch(S={},S.name=ua.utils.decode(y,d.slice(d.l,d.l+k)).replace(/[\u0000\r\n].*$/g,""),d.l+=k,S.type=String.fromCharCode(d.read_shift(1)),f!=2&&!p&&(S.offset=d.read_shift(4)),S.len=d.read_shift(1),f==2&&(S.offset=d.read_shift(2)),S.dec=d.read_shift(1),S.name.length&&b.push(S),f!=2&&(d.l+=p?13:14),S.type){case"B":(!x||S.len!=8)&&l.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+S.type)}if(d[d.l]!==13&&(d.l=g-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=g;var E=0,T=0;for(u[0]=[],T=0;T!=b.length;++T)u[0][T]=b[T].name;for(;m-- >0;){if(d[d.l]===42){d.l+=v;continue}for(++d.l,u[++E]=[],T=0,T=0;T!=b.length;++T){var w=d.slice(d.l,d.l+b[T].len);d.l+=b[T].len,sr(w,0);var F=ua.utils.decode(y,w);switch(b[T].type){case"C":F.trim().length&&(u[E][T]=F.replace(/\s+$/,""));break;case"D":F.length===8?u[E][T]=new Date(+F.slice(0,4),+F.slice(4,6)-1,+F.slice(6,8)):u[E][T]=F;break;case"F":u[E][T]=parseFloat(F.trim());break;case"+":case"I":u[E][T]=p?w.read_shift(-4,"i")^2147483648:w.read_shift(4,"i");break;case"L":switch(F.trim().toUpperCase()){case"Y":case"T":u[E][T]=!0;break;case"N":case"F":u[E][T]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+F+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[E][T]="##MEMO##"+(p?parseInt(F.trim(),10):w.read_shift(4));break;case"N":F=F.replace(/\u0000/g,"").trim(),F&&F!="."&&(u[E][T]=+F||0);break;case"@":u[E][T]=new Date(w.read_shift(-8,"f")-621356832e5);break;case"T":u[E][T]=new Date((w.read_shift(4)-2440588)*864e5+w.read_shift(4));break;case"Y":u[E][T]=w.read_shift(4,"i")/1e4+w.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[E][T]=-w.read_shift(-8,"f");break;case"B":if(x&&b[T].len==8){u[E][T]=w.read_shift(8,"f");break}case"G":case"P":w.l+=b[T].len;break;case"0":if(b[T].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[T].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=b,u}function n(c,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var d=si(t(c,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function a(c,l){try{return ba(n(c,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function i(c,l){var u=l||{};if(+u.codepage>=0&&vn(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=Hl(),f=Zl(c,{header:1,raw:!0,cellDates:!0}),h=f[0],x=f.slice(1),p=c["!cols"]||[],m=0,g=0,v=0,y=1;for(m=0;m<h.length;++m){if(((p[m]||{}).DBF||{}).name){h[m]=p[m].DBF.name,++v;continue}if(h[m]!=null){if(++v,typeof h[m]=="number"&&(h[m]=h[m].toString(10)),typeof h[m]!="string")throw new Error("DBF Invalid column name "+h[m]+" |"+typeof h[m]+"|");if(h.indexOf(h[m])!==m){for(g=0;g<1024;++g)if(h.indexOf(h[m]+"_"+g)==-1){h[m]+="_"+g;break}}}}var b=Pt(c["!ref"]),S=[],I=[],k=[];for(m=0;m<=b.e.c-b.s.c;++m){var E="",T="",w=0,F=[];for(g=0;g<x.length;++g)x[g][m]!=null&&F.push(x[g][m]);if(F.length==0||h[m]==null){S[m]="?";continue}for(g=0;g<F.length;++g){switch(typeof F[g]){case"number":T="B";break;case"string":T="C";break;case"boolean":T="L";break;case"object":T=F[g]instanceof Date?"D":"C";break;default:T="C"}w=Math.max(w,String(F[g]).length),E=E&&E!=T?"C":T}w>250&&(w=250),T=((p[m]||{}).DBF||{}).type,T=="C"&&p[m].DBF.len>w&&(w=p[m].DBF.len),E=="B"&&T=="N"&&(E="N",k[m]=p[m].DBF.dec,w=p[m].DBF.len),I[m]=E=="C"||T=="N"?w:s[E]||0,y+=I[m],S[m]=E}var P=d.next(32);for(P.write_shift(4,318902576),P.write_shift(4,x.length),P.write_shift(2,296+32*v),P.write_shift(2,y),m=0;m<4;++m)P.write_shift(4,0);for(P.write_shift(4,0|(+r[um]||3)<<8),m=0,g=0;m<h.length;++m)if(h[m]!=null){var A=d.next(32),L=(h[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);A.write_shift(1,L,"sbcs"),A.write_shift(1,S[m]=="?"?"C":S[m],"sbcs"),A.write_shift(4,g),A.write_shift(1,I[m]||s[S[m]]||0),A.write_shift(1,k[m]||0),A.write_shift(1,2),A.write_shift(4,0),A.write_shift(1,0),A.write_shift(4,0),A.write_shift(4,0),g+=I[m]||s[S[m]]||0}var Y=d.next(264);for(Y.write_shift(4,13),m=0;m<65;++m)Y.write_shift(4,0);for(m=0;m<x.length;++m){var q=d.next(y);for(q.write_shift(1,0),g=0;g<h.length;++g)if(h[g]!=null)switch(S[g]){case"L":q.write_shift(1,x[m][g]==null?63:x[m][g]?84:70);break;case"B":q.write_shift(8,x[m][g]||0,"f");break;case"N":var Q="0";for(typeof x[m][g]=="number"&&(Q=x[m][g].toFixed(k[g]||0)),v=0;v<I[g]-Q.length;++v)q.write_shift(1,32);q.write_shift(1,Q,"sbcs");break;case"D":x[m][g]?(q.write_shift(4,("0000"+x[m][g].getFullYear()).slice(-4),"sbcs"),q.write_shift(2,("00"+(x[m][g].getMonth()+1)).slice(-2),"sbcs"),q.write_shift(2,("00"+x[m][g].getDate()).slice(-2),"sbcs")):q.write_shift(8,"00000000","sbcs");break;case"C":var K=String(x[m][g]!=null?x[m][g]:"").slice(0,I[g]);for(q.write_shift(1,K,"sbcs"),v=0;v<I[g]-K.length;++v)q.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:a,to_sheet:n,from_sheet:i}}(),WE=function(){var e={AA:"Ã€",BA:"Ã",CA:"Ã‚",DA:195,HA:"Ã„",JA:197,AE:"Ãˆ",BE:"Ã‰",CE:"ÃŠ",HE:"Ã‹",AI:"ÃŒ",BI:"Ã",CI:"ÃŽ",HI:"Ã",AO:"Ã’",BO:"Ã“",CO:"Ã”",DO:213,HO:"Ã–",AU:"Ã™",BU:"Ãš",CU:"Ã›",HU:"Ãœ",Aa:"Ã ",Ba:"Ã¡",Ca:"Ã¢",Da:227,Ha:"Ã¤",Ja:229,Ae:"Ã¨",Be:"Ã©",Ce:"Ãª",He:"Ã«",Ai:"Ã¬",Bi:"Ã­",Ci:"Ã®",Hi:"Ã¯",Ao:"Ã²",Bo:"Ã³",Co:"Ã´",Do:245,Ho:"Ã¶",Au:"Ã¹",Bu:"Ãº",Cu:"Ã»",Hu:"Ã¼",KC:"Ã‡",Kc:"Ã§",q:"Ã¦",z:"Å“",a:"Ã†",j:"Å’",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+Bn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(h,x){var p=e[x];return typeof p=="number"?Yf(p):p},n=function(h,x,p){var m=x.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return m==59?h:Yf(m)};e["|"]=254;function a(h,x){switch(x.type){case"base64":return s(Kr(h),x);case"binary":return s(h,x);case"buffer":return s(ot&&Buffer.isBuffer(h)?h.toString("binary"):us(h),x);case"array":return s(ss(h),x)}throw new Error("Unrecognized type "+x.type)}function s(h,x){var p=h.split(/[\n\r]+/),m=-1,g=-1,v=0,y=0,b=[],S=[],I=null,k={},E=[],T=[],w=[],F=0,P;for(+x.codepage>=0&&vn(+x.codepage);v!==p.length;++v){F=0;var A=p[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(r,t),L=A.replace(/;;/g,"\0").split(";").map(function(W){return W.replace(/\u0000/g,";")}),Y=L[0],q;if(A.length>0)switch(Y){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":L[1].charAt(0)=="P"&&S.push(A.slice(3).replace(/;;/g,";"));break;case"C":var Q=!1,K=!1,ye=!1,U=!1,me=-1,J=-1;for(y=1;y<L.length;++y)switch(L[y].charAt(0)){case"A":break;case"X":g=parseInt(L[y].slice(1))-1,K=!0;break;case"Y":for(m=parseInt(L[y].slice(1))-1,K||(g=0),P=b.length;P<=m;++P)b[P]=[];break;case"K":q=L[y].slice(1),q.charAt(0)==='"'?q=q.slice(1,q.length-1):q==="TRUE"?q=!0:q==="FALSE"?q=!1:isNaN(Sn(q))?isNaN(qs(q).getDate())||(q=nr(q)):(q=Sn(q),I!==null&&ni(I)&&(q=Ic(q))),Q=!0;break;case"E":U=!0;var D=Ls(L[y].slice(1),{r:m,c:g});b[m][g]=[b[m][g],D];break;case"S":ye=!0,b[m][g]=[b[m][g],"S5S"];break;case"G":break;case"R":me=parseInt(L[y].slice(1))-1;break;case"C":J=parseInt(L[y].slice(1))-1;break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+A)}if(Q&&(b[m][g]&&b[m][g].length==2?b[m][g][0]=q:b[m][g]=q,I=null),ye){if(U)throw new Error("SYLK shared formula cannot have own formula");var B=me>-1&&b[me][J];if(!B||!B[1])throw new Error("SYLK shared formula cannot find base");b[m][g][1]=Sx(B[1],{r:m-me,c:g-J})}break;case"F":var V=0;for(y=1;y<L.length;++y)switch(L[y].charAt(0)){case"X":g=parseInt(L[y].slice(1))-1,++V;break;case"Y":for(m=parseInt(L[y].slice(1))-1,P=b.length;P<=m;++P)b[P]=[];break;case"M":F=parseInt(L[y].slice(1))/20;break;case"F":break;case"G":break;case"P":I=S[parseInt(L[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(w=L[y].slice(1).split(" "),P=parseInt(w[0],10);P<=parseInt(w[1],10);++P)F=parseInt(w[2],10),T[P-1]=F===0?{hidden:!0}:{wch:F},Xs(T[P-1]);break;case"C":g=parseInt(L[y].slice(1))-1,T[g]||(T[g]={});break;case"R":m=parseInt(L[y].slice(1))-1,E[m]||(E[m]={}),F>0?(E[m].hpt=F,E[m].hpx=Yi(F)):F===0&&(E[m].hidden=!0);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+A)}V<1&&(I=null);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+A)}}return E.length>0&&(k["!rows"]=E),T.length>0&&(k["!cols"]=T),x&&x.sheetRows&&(b=b.slice(0,x.sheetRows)),[b,k]}function i(h,x){var p=a(h,x),m=p[0],g=p[1],v=si(m,x);return Bn(g).forEach(function(y){v[y]=g[y]}),v}function c(h,x){return ba(i(h,x),x)}function l(h,x,p,m){var g="C;Y"+(p+1)+";X"+(m+1)+";K";switch(h.t){case"n":g+=h.v||0,h.f&&!h.F&&(g+=";E"+Dk(h.f,{r:p,c:m}));break;case"b":g+=h.v?"TRUE":"FALSE";break;case"e":g+=h.w||h.v;break;case"d":g+='"'+(h.w||h.v)+'"';break;case"s":g+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function u(h,x){x.forEach(function(p,m){var g="F;W"+(m+1)+" "+(m+1)+" ";p.hidden?g+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=ic(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=oc(p.wpx)),typeof p.wch=="number"&&(g+=Math.round(p.wch))),g.charAt(g.length-1)!=" "&&h.push(g)})}function d(h,x){x.forEach(function(p,m){var g="F;";p.hidden?g+="M0;":p.hpt?g+="M"+20*p.hpt+";":p.hpx&&(g+="M"+20*yx(p.hpx)+";"),g.length>2&&h.push(g+"R"+(m+1))})}function f(h,x){var p=["ID;PWXL;N;E"],m=[],g=Pt(h["!ref"]),v,y=Array.isArray(h),b=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),h["!cols"]&&u(p,h["!cols"]),h["!rows"]&&d(p,h["!rows"]),p.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var S=g.s.r;S<=g.e.r;++S)for(var I=g.s.c;I<=g.e.c;++I){var k=Qe({r:S,c:I});v=y?(h[S]||[])[I]:h[k],!(!v||v.v==null&&(!v.f||v.F))&&m.push(l(v,h,S,I))}return p.join(b)+b+m.join(b)+b+"E"+b}return{to_workbook:c,to_sheet:i,from_sheet:f}}(),HE=function(){function e(s,i){switch(i.type){case"base64":return r(Kr(s),i);case"binary":return r(s,i);case"buffer":return r(ot&&Buffer.isBuffer(s)?s.toString("binary"):us(s),i);case"array":return r(ss(s),i)}throw new Error("Unrecognized type "+i.type)}function r(s,i){for(var c=s.split(`
`),l=-1,u=-1,d=0,f=[];d!==c.length;++d){if(c[d].trim()==="BOT"){f[++l]=[],u=0;continue}if(!(l<0)){var h=c[d].trim().split(","),x=h[0],p=h[1];++d;for(var m=c[d]||"";(m.match(/["]/g)||[]).length&1&&d<c.length-1;)m+=`
`+c[++d];switch(m=m.trim(),+x){case-1:if(m==="BOT"){f[++l]=[],u=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?f[l][u]=!0:m==="FALSE"?f[l][u]=!1:isNaN(Sn(p))?isNaN(qs(p).getDate())?f[l][u]=p:f[l][u]=nr(p):f[l][u]=Sn(p),++u;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),f[l][u++]=m!==""?m:null;break}if(m==="EOD")break}}return i&&i.sheetRows&&(f=f.slice(0,i.sheetRows)),f}function t(s,i){return si(e(s,i),i)}function n(s,i){return ba(t(s,i),i)}var a=function(){var s=function(l,u,d,f,h){l.push(u),l.push(d+","+f),l.push('"'+h.replace(/"/g,'""')+'"')},i=function(l,u,d,f){l.push(u+","+d),l.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var u=[],d=Pt(l["!ref"]),f,h=Array.isArray(l);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,d.e.r-d.s.r+1,""),s(u,"TUPLES",0,d.e.c-d.s.c+1,""),s(u,"DATA",0,0,"");for(var x=d.s.r;x<=d.e.r;++x){i(u,-1,0,"BOT");for(var p=d.s.c;p<=d.e.c;++p){var m=Qe({r:x,c:p});if(f=h?(l[x]||[])[p]:l[m],!f){i(u,1,0,"");continue}switch(f.t){case"n":var g=f.w;!g&&f.v!=null&&(g=f.v),g==null?f.f&&!f.F?i(u,1,0,"="+f.f):i(u,1,0,""):i(u,0,g,"V");break;case"b":i(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":i(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=an(f.z||rt[14],Cr(nr(f.v)))),i(u,0,f.w,"V");break;default:i(u,1,0,"")}}}i(u,-1,0,"EOD");var v=`\r
`,y=u.join(v);return y}}();return{to_workbook:n,to_sheet:t,from_sheet:a}}(),zE=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(f,h){for(var x=f.split(`
`),p=-1,m=-1,g=0,v=[];g!==x.length;++g){var y=x[g].trim().split(":");if(y[0]==="cell"){var b=Tr(y[1]);if(v.length<=b.r)for(p=v.length;p<=b.r;++p)v[p]||(v[p]=[]);switch(p=b.r,m=b.c,y[2]){case"t":v[p][m]=e(y[3]);break;case"v":v[p][m]=+y[3];break;case"vtf":var S=y[y.length-1];case"vtc":switch(y[3]){case"nl":v[p][m]=!!+y[4];break;default:v[p][m]=+y[4];break}y[2]=="vtf"&&(v[p][m]=[v[p][m],S])}}}return h&&h.sheetRows&&(v=v.slice(0,h.sheetRows)),v}function n(f,h){return si(t(f,h),h)}function a(f,h){return ba(n(f,h),h)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var h=[],x=[],p,m="",g=ai(f["!ref"]),v=Array.isArray(f),y=g.s.r;y<=g.e.r;++y)for(var b=g.s.c;b<=g.e.c;++b)if(m=Qe({r:y,c:b}),p=v?(f[y]||[])[b]:f[m],!(!p||p.v==null||p.t==="z")){switch(x=["cell",m,"t"],p.t){case"s":case"str":x.push(r(p.v));break;case"n":p.f?(x[2]="vtf",x[3]="n",x[4]=p.v,x[5]=r(p.f)):(x[2]="v",x[3]=p.v);break;case"b":x[2]="vt"+(p.f?"f":"c"),x[3]="nl",x[4]=p.v?"1":"0",x[5]=r(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var S=Cr(nr(p.v));x[2]="vtc",x[3]="nd",x[4]=""+S,x[5]=p.w||an(p.z||rt[14],S);break;case"e":continue}h.push(x.join(":"))}return h.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function d(f){return[s,i,c,i,u(f),l].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:d}}(),zi=function(){function e(d,f,h,x,p){p.raw?f[h][x]=d:d===""||(d==="TRUE"?f[h][x]=!0:d==="FALSE"?f[h][x]=!1:isNaN(Sn(d))?isNaN(qs(d).getDate())?f[h][x]=d:f[h][x]=nr(d):f[h][x]=Sn(d))}function r(d,f){var h=f||{},x=[];if(!d||d.length===0)return x;for(var p=d.split(/[\r\n]/),m=p.length-1;m>=0&&p[m].length===0;)--m;for(var g=10,v=0,y=0;y<=m;++y)v=p[y].indexOf(" "),v==-1?v=p[y].length:v++,g=Math.max(g,v);for(y=0;y<=m;++y){x[y]=[];var b=0;for(e(p[y].slice(0,g).trim(),x,y,b,h),b=1;b<=(p[y].length-g)/10+1;++b)e(p[y].slice(g+(b-1)*10,g+b*10).trim(),x,y,b,h)}return h.sheetRows&&(x=x.slice(0,h.sheetRows)),x}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(d){for(var f={},h=!1,x=0,p=0;x<d.length;++x)(p=d.charCodeAt(x))==34?h=!h:!h&&p in t&&(f[p]=(f[p]||0)+1);p=[];for(x in f)Object.prototype.hasOwnProperty.call(f,x)&&p.push([f[x],x]);if(!p.length){f=n;for(x in f)Object.prototype.hasOwnProperty.call(f,x)&&p.push([f[x],x])}return p.sort(function(m,g){return m[0]-g[0]||n[m[1]]-n[g[1]]}),t[p.pop()[1]]||44}function s(d,f){var h=f||{},x="",p=h.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(x=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(x=d.charAt(4),d=d.slice(6)):x=a(d.slice(0,1024)):h&&h.FS?x=h.FS:x=a(d.slice(0,1024));var g=0,v=0,y=0,b=0,S=0,I=x.charCodeAt(0),k=!1,E=0,T=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var w=h.dateNF!=null?n2(h.dateNF):null;function F(){var P=d.slice(b,S),A={};if(P.charAt(0)=='"'&&P.charAt(P.length-1)=='"'&&(P=P.slice(1,-1).replace(/""/g,'"')),P.length===0)A.t="z";else if(h.raw)A.t="s",A.v=P;else if(P.trim().length===0)A.t="s",A.v=P;else if(P.charCodeAt(0)==61)P.charCodeAt(1)==34&&P.charCodeAt(P.length-1)==34?(A.t="s",A.v=P.slice(2,-1).replace(/""/g,'"')):Ik(P)?(A.t="n",A.f=P.slice(1)):(A.t="s",A.v=P);else if(P=="TRUE")A.t="b",A.v=!0;else if(P=="FALSE")A.t="b",A.v=!1;else if(!isNaN(y=Sn(P)))A.t="n",h.cellText!==!1&&(A.w=P),A.v=y;else if(!isNaN(qs(P).getDate())||w&&P.match(w)){A.z=h.dateNF||rt[14];var L=0;w&&P.match(w)&&(P=a2(P,h.dateNF,P.match(w)||[]),L=1),h.cellDates?(A.t="d",A.v=nr(P,L)):(A.t="n",A.v=Cr(nr(P,L))),h.cellText!==!1&&(A.w=an(A.z,A.v instanceof Date?Cr(A.v):A.v)),h.cellNF||delete A.z}else A.t="s",A.v=P;if(A.t=="z"||(h.dense?(p[g]||(p[g]=[]),p[g][v]=A):p[Qe({c:v,r:g})]=A),b=S+1,T=d.charCodeAt(b),m.e.c<v&&(m.e.c=v),m.e.r<g&&(m.e.r=g),E==I)++v;else if(v=0,++g,h.sheetRows&&h.sheetRows<=g)return!0}e:for(;S<d.length;++S)switch(E=d.charCodeAt(S)){case 34:T===34&&(k=!k);break;case I:case 10:case 13:if(!k&&F())break e;break}return S-b>0&&F(),p["!ref"]=lt(m),p}function i(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,f):si(r(d,f),f)}function c(d,f){var h="",x=f.type=="string"?[0,0,0,0]:od(d,f);switch(f.type){case"base64":h=Kr(d);break;case"binary":h=d;break;case"buffer":f.codepage==65001?h=d.toString("utf8"):f.codepage&&typeof ua<"u"?h=ua.utils.decode(f.codepage,d):h=ot&&Buffer.isBuffer(d)?d.toString("binary"):us(d);break;case"array":h=ss(d);break;case"string":h=d;break;default:throw new Error("Unrecognized type "+f.type)}return x[0]==239&&x[1]==187&&x[2]==191?h=xt(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=xt(h):f.type=="binary"&&typeof ua<"u"&&f.codepage&&(h=ua.utils.decode(f.codepage,ua.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?zE.to_sheet(f.type=="string"?h:xt(h),f):i(h,f)}function l(d,f){return ba(c(d,f),f)}function u(d){for(var f=[],h=Pt(d["!ref"]),x,p=Array.isArray(d),m=h.s.r;m<=h.e.r;++m){for(var g=[],v=h.s.c;v<=h.e.c;++v){var y=Qe({r:m,c:v});if(x=p?(d[m]||[])[v]:d[y],!x||x.v==null){g.push("          ");continue}for(var b=(x.w||(Zn(x),x.w)||"").slice(0,10);b.length<10;)b+=" ";g.push(b+(v===0?" ":""))}f.push(g.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:c,from_sheet:u}}();function GE(e,r){var t=r||{},n=!!t.WTF;t.WTF=!0;try{var a=WE.to_workbook(e,t);return t.WTF=n,a}catch(s){if(t.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return zi.to_workbook(e,r)}}var Pi=function(){function e(D,B,V){if(D){sr(D,D.l||0);for(var W=V.Enum||me;D.l<D.length;){var Z=D.read_shift(2),fe=W[Z]||W[65535],ne=D.read_shift(2),ee=D.l+ne,se=fe.f&&fe.f(D,ne,V);if(D.l=ee,B(se,fe,Z))return}}}function r(D,B){switch(B.type){case"base64":return t(gn(Kr(D)),B);case"binary":return t(gn(D),B);case"buffer":case"array":return t(D,B)}throw"Unsupported type "+B.type}function t(D,B){if(!D)return D;var V=B||{},W=V.dense?[]:{},Z="Sheet1",fe="",ne=0,ee={},se=[],j=[],_={s:{r:0,c:0},e:{r:0,c:0}},ae=V.sheetRows||0;if(D[2]==0&&(D[3]==8||D[3]==9)&&D.length>=16&&D[14]==5&&D[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(D[2]==2)V.Enum=me,e(D,function(be,pe,Ce){switch(Ce){case 0:V.vers=be,be>=4096&&(V.qpro=!0);break;case 6:_=be;break;case 204:be&&(fe=be);break;case 222:fe=be;break;case 15:case 51:V.qpro||(be[1].v=be[1].v.slice(1));case 13:case 14:case 16:Ce==14&&(be[2]&112)==112&&(be[2]&15)>1&&(be[2]&15)<15&&(be[1].z=V.dateNF||rt[14],V.cellDates&&(be[1].t="d",be[1].v=Ic(be[1].v))),V.qpro&&be[3]>ne&&(W["!ref"]=lt(_),ee[Z]=W,se.push(Z),W=V.dense?[]:{},_={s:{r:0,c:0},e:{r:0,c:0}},ne=be[3],Z=fe||"Sheet"+(ne+1),fe="");var Oe=V.dense?(W[be[0].r]||[])[be[0].c]:W[Qe(be[0])];if(Oe){Oe.t=be[1].t,Oe.v=be[1].v,be[1].z!=null&&(Oe.z=be[1].z),be[1].f!=null&&(Oe.f=be[1].f);break}V.dense?(W[be[0].r]||(W[be[0].r]=[]),W[be[0].r][be[0].c]=be[1]):W[Qe(be[0])]=be[1];break}},V);else if(D[2]==26||D[2]==14)V.Enum=J,D[2]==14&&(V.qpro=!0,D.l=0),e(D,function(be,pe,Ce){switch(Ce){case 204:Z=be;break;case 22:be[1].v=be[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(be[3]>ne&&(W["!ref"]=lt(_),ee[Z]=W,se.push(Z),W=V.dense?[]:{},_={s:{r:0,c:0},e:{r:0,c:0}},ne=be[3],Z="Sheet"+(ne+1)),ae>0&&be[0].r>=ae)break;V.dense?(W[be[0].r]||(W[be[0].r]=[]),W[be[0].r][be[0].c]=be[1]):W[Qe(be[0])]=be[1],_.e.c<be[0].c&&(_.e.c=be[0].c),_.e.r<be[0].r&&(_.e.r=be[0].r);break;case 27:be[14e3]&&(j[be[14e3][0]]=be[14e3][1]);break;case 1537:j[be[0]]=be[1],be[0]==ne&&(Z=be[1]);break}},V);else throw new Error("Unrecognized LOTUS BOF "+D[2]);if(W["!ref"]=lt(_),ee[fe||Z]=W,se.push(fe||Z),!j.length)return{SheetNames:se,Sheets:ee};for(var oe={},Te=[],ce=0;ce<j.length;++ce)ee[se[ce]]?(Te.push(j[ce]||se[ce]),oe[j[ce]]=ee[j[ce]]||ee[se[ce]]):(Te.push(j[ce]),oe[j[ce]]={"!ref":"A1"});return{SheetNames:Te,Sheets:oe}}function n(D,B){var V=B||{};if(+V.codepage>=0&&vn(+V.codepage),V.type=="string")throw new Error("Cannot write WK1 to JS string");var W=Hl(),Z=Pt(D["!ref"]),fe=Array.isArray(D),ne=[];ln(W,0,s(1030)),ln(W,6,l(Z));for(var ee=Math.min(Z.e.r,8191),se=Z.s.r;se<=ee;++se)for(var j=cr(se),_=Z.s.c;_<=Z.e.c;++_){se===Z.s.r&&(ne[_]=qt(_));var ae=ne[_]+j,oe=fe?(D[se]||[])[_]:D[ae];if(!(!oe||oe.t=="z"))if(oe.t=="n")(oe.v|0)==oe.v&&oe.v>=-32768&&oe.v<=32767?ln(W,13,x(se,_,oe.v)):ln(W,14,m(se,_,oe.v));else{var Te=Zn(oe);ln(W,15,f(se,_,Te.slice(0,239)))}}return ln(W,1),W.end()}function a(D,B){var V=B||{};if(+V.codepage>=0&&vn(+V.codepage),V.type=="string")throw new Error("Cannot write WK3 to JS string");var W=Hl();ln(W,0,i(D));for(var Z=0,fe=0;Z<D.SheetNames.length;++Z)(D.Sheets[D.SheetNames[Z]]||{})["!ref"]&&ln(W,27,U(D.SheetNames[Z],fe++));var ne=0;for(Z=0;Z<D.SheetNames.length;++Z){var ee=D.Sheets[D.SheetNames[Z]];if(!(!ee||!ee["!ref"])){for(var se=Pt(ee["!ref"]),j=Array.isArray(ee),_=[],ae=Math.min(se.e.r,8191),oe=se.s.r;oe<=ae;++oe)for(var Te=cr(oe),ce=se.s.c;ce<=se.e.c;++ce){oe===se.s.r&&(_[ce]=qt(ce));var be=_[ce]+Te,pe=j?(ee[oe]||[])[ce]:ee[be];if(!(!pe||pe.t=="z"))if(pe.t=="n")ln(W,23,F(oe,ce,ne,pe.v));else{var Ce=Zn(pe);ln(W,22,E(oe,ce,ne,Ce.slice(0,239)))}}++ne}}return ln(W,1),W.end()}function s(D){var B=Gt(2);return B.write_shift(2,D),B}function i(D){var B=Gt(26);B.write_shift(2,4096),B.write_shift(2,4),B.write_shift(4,0);for(var V=0,W=0,Z=0,fe=0;fe<D.SheetNames.length;++fe){var ne=D.SheetNames[fe],ee=D.Sheets[ne];if(!(!ee||!ee["!ref"])){++Z;var se=ai(ee["!ref"]);V<se.e.r&&(V=se.e.r),W<se.e.c&&(W=se.e.c)}}return V>8191&&(V=8191),B.write_shift(2,V),B.write_shift(1,Z),B.write_shift(1,W),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(1,1),B.write_shift(1,2),B.write_shift(4,0),B.write_shift(4,0),B}function c(D,B,V){var W={s:{c:0,r:0},e:{c:0,r:0}};return B==8&&V.qpro?(W.s.c=D.read_shift(1),D.l++,W.s.r=D.read_shift(2),W.e.c=D.read_shift(1),D.l++,W.e.r=D.read_shift(2),W):(W.s.c=D.read_shift(2),W.s.r=D.read_shift(2),B==12&&V.qpro&&(D.l+=2),W.e.c=D.read_shift(2),W.e.r=D.read_shift(2),B==12&&V.qpro&&(D.l+=2),W.s.c==65535&&(W.s.c=W.e.c=W.s.r=W.e.r=0),W)}function l(D){var B=Gt(8);return B.write_shift(2,D.s.c),B.write_shift(2,D.s.r),B.write_shift(2,D.e.c),B.write_shift(2,D.e.r),B}function u(D,B,V){var W=[{c:0,r:0},{t:"n",v:0},0,0];return V.qpro&&V.vers!=20768?(W[0].c=D.read_shift(1),W[3]=D.read_shift(1),W[0].r=D.read_shift(2),D.l+=2):(W[2]=D.read_shift(1),W[0].c=D.read_shift(2),W[0].r=D.read_shift(2)),W}function d(D,B,V){var W=D.l+B,Z=u(D,B,V);if(Z[1].t="s",V.vers==20768){D.l++;var fe=D.read_shift(1);return Z[1].v=D.read_shift(fe,"utf8"),Z}return V.qpro&&D.l++,Z[1].v=D.read_shift(W-D.l,"cstr"),Z}function f(D,B,V){var W=Gt(7+V.length);W.write_shift(1,255),W.write_shift(2,B),W.write_shift(2,D),W.write_shift(1,39);for(var Z=0;Z<W.length;++Z){var fe=V.charCodeAt(Z);W.write_shift(1,fe>=128?95:fe)}return W.write_shift(1,0),W}function h(D,B,V){var W=u(D,B,V);return W[1].v=D.read_shift(2,"i"),W}function x(D,B,V){var W=Gt(7);return W.write_shift(1,255),W.write_shift(2,B),W.write_shift(2,D),W.write_shift(2,V,"i"),W}function p(D,B,V){var W=u(D,B,V);return W[1].v=D.read_shift(8,"f"),W}function m(D,B,V){var W=Gt(13);return W.write_shift(1,255),W.write_shift(2,B),W.write_shift(2,D),W.write_shift(8,V,"f"),W}function g(D,B,V){var W=D.l+B,Z=u(D,B,V);if(Z[1].v=D.read_shift(8,"f"),V.qpro)D.l=W;else{var fe=D.read_shift(2);S(D.slice(D.l,D.l+fe),Z),D.l+=fe}return Z}function v(D,B,V){var W=B&32768;return B&=-32769,B=(W?D:0)+(B>=8192?B-16384:B),(W?"":"$")+(V?qt(B):cr(B))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function S(D,B){sr(D,0);for(var V=[],W=0,Z="",fe="",ne="",ee="";D.l<D.length;){var se=D[D.l++];switch(se){case 0:V.push(D.read_shift(8,"f"));break;case 1:fe=v(B[0].c,D.read_shift(2),!0),Z=v(B[0].r,D.read_shift(2),!1),V.push(fe+Z);break;case 2:{var j=v(B[0].c,D.read_shift(2),!0),_=v(B[0].r,D.read_shift(2),!1);fe=v(B[0].c,D.read_shift(2),!0),Z=v(B[0].r,D.read_shift(2),!1),V.push(j+_+":"+fe+Z)}break;case 3:if(D.l<D.length){console.error("WK1 premature formula end");return}break;case 4:V.push("("+V.pop()+")");break;case 5:V.push(D.read_shift(2));break;case 6:{for(var ae="";se=D[D.l++];)ae+=String.fromCharCode(se);V.push('"'+ae.replace(/"/g,'""')+'"')}break;case 8:V.push("-"+V.pop());break;case 23:V.push("+"+V.pop());break;case 22:V.push("NOT("+V.pop()+")");break;case 20:case 21:ee=V.pop(),ne=V.pop(),V.push(["AND","OR"][se-20]+"("+ne+","+ee+")");break;default:if(se<32&&b[se])ee=V.pop(),ne=V.pop(),V.push(ne+b[se]+ee);else if(y[se]){if(W=y[se][1],W==69&&(W=D[D.l++]),W>V.length){console.error("WK1 bad formula parse 0x"+se.toString(16)+":|"+V.join("|")+"|");return}var oe=V.slice(-W);V.length-=W,V.push(y[se][0]+"("+oe.join(",")+")")}else return se<=7?console.error("WK1 invalid opcode "+se.toString(16)):se<=24?console.error("WK1 unsupported op "+se.toString(16)):se<=30?console.error("WK1 invalid opcode "+se.toString(16)):se<=115?console.error("WK1 unsupported function opcode "+se.toString(16)):console.error("WK1 unrecognized opcode "+se.toString(16))}}V.length==1?B[1].f=""+V[0]:console.error("WK1 bad formula parse |"+V.join("|")+"|")}function I(D){var B=[{c:0,r:0},{t:"n",v:0},0];return B[0].r=D.read_shift(2),B[3]=D[D.l++],B[0].c=D[D.l++],B}function k(D,B){var V=I(D);return V[1].t="s",V[1].v=D.read_shift(B-4,"cstr"),V}function E(D,B,V,W){var Z=Gt(6+W.length);Z.write_shift(2,D),Z.write_shift(1,V),Z.write_shift(1,B),Z.write_shift(1,39);for(var fe=0;fe<W.length;++fe){var ne=W.charCodeAt(fe);Z.write_shift(1,ne>=128?95:ne)}return Z.write_shift(1,0),Z}function T(D,B){var V=I(D);V[1].v=D.read_shift(2);var W=V[1].v>>1;if(V[1].v&1)switch(W&7){case 0:W=(W>>3)*5e3;break;case 1:W=(W>>3)*500;break;case 2:W=(W>>3)/20;break;case 3:W=(W>>3)/200;break;case 4:W=(W>>3)/2e3;break;case 5:W=(W>>3)/2e4;break;case 6:W=(W>>3)/16;break;case 7:W=(W>>3)/64;break}return V[1].v=W,V}function w(D,B){var V=I(D),W=D.read_shift(4),Z=D.read_shift(4),fe=D.read_shift(2);if(fe==65535)return W===0&&Z===3221225472?(V[1].t="e",V[1].v=15):W===0&&Z===3489660928?(V[1].t="e",V[1].v=42):V[1].v=0,V;var ne=fe&32768;return fe=(fe&32767)-16446,V[1].v=(1-ne*2)*(Z*Math.pow(2,fe+32)+W*Math.pow(2,fe)),V}function F(D,B,V,W){var Z=Gt(14);if(Z.write_shift(2,D),Z.write_shift(1,V),Z.write_shift(1,B),W==0)return Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(2,65535),Z;var fe=0,ne=0,ee=0,se=0;return W<0&&(fe=1,W=-W),ne=Math.log2(W)|0,W/=Math.pow(2,ne-31),se=W>>>0,se&2147483648||(W/=2,++ne,se=W>>>0),W-=se,se|=2147483648,se>>>=0,W*=Math.pow(2,32),ee=W>>>0,Z.write_shift(4,ee),Z.write_shift(4,se),ne+=16383+(fe?32768:0),Z.write_shift(2,ne),Z}function P(D,B){var V=w(D);return D.l+=B-14,V}function A(D,B){var V=I(D),W=D.read_shift(4);return V[1].v=W>>6,V}function L(D,B){var V=I(D),W=D.read_shift(8,"f");return V[1].v=W,V}function Y(D,B){var V=L(D);return D.l+=B-10,V}function q(D,B){return D[D.l+B-1]==0?D.read_shift(B,"cstr"):""}function Q(D,B){var V=D[D.l++];V>B-1&&(V=B-1);for(var W="";W.length<V;)W+=String.fromCharCode(D[D.l++]);return W}function K(D,B,V){if(!(!V.qpro||B<21)){var W=D.read_shift(1);D.l+=17,D.l+=1,D.l+=2;var Z=D.read_shift(B-21,"cstr");return[W,Z]}}function ye(D,B){for(var V={},W=D.l+B;D.l<W;){var Z=D.read_shift(2);if(Z==14e3){for(V[Z]=[0,""],V[Z][0]=D.read_shift(2);D[D.l];)V[Z][1]+=String.fromCharCode(D[D.l]),D.l++;D.l++}}return V}function U(D,B){var V=Gt(5+D.length);V.write_shift(2,14e3),V.write_shift(2,B);for(var W=0;W<D.length;++W){var Z=D.charCodeAt(W);V[V.l++]=Z>127?95:Z}return V[V.l++]=0,V}var me={0:{n:"BOF",f:Vt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:p},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:q},222:{n:"SHEETNAMELP",f:Q},65535:{n:""}},J={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:k},23:{n:"NUMBER17",f:w},24:{n:"NUMBER18",f:T},25:{n:"FORMULA19",f:P},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ye},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:A},38:{n:"??"},39:{n:"NUMBER27",f:L},40:{n:"FORMULA28",f:Y},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:q},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:K},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:r}}();function YE(e){var r={},t=e.match(wr),n=0,a=!1;if(t)for(;n!=t.length;++n){var s=Ke(t[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;r.cp=Mu[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=s.val;break;case"<sz":r.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":s.rgb&&(r.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return r}var qE=function(){var e=Wi("t"),r=Wi("rPr");function t(s){var i=s.match(e);if(!i)return{t:"s",v:""};var c={t:"s",v:dt(i[1])},l=s.match(r);return l&&(c.s=YE(l[1])),c}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(a).map(t).filter(function(c){return c.v})}}(),XE=function(){var r=/(\r\n|\n)/g;function t(a,s,i){var c=[];a.u&&c.push("text-decoration: underline;"),a.uval&&c.push("text-underline-style:"+a.uval+";"),a.sz&&c.push("font-size:"+a.sz+"pt;"),a.outline&&c.push("text-effect: outline;"),a.shadow&&c.push("text-shadow: auto;"),s.push('<span style="'+c.join("")+'">'),a.b&&(s.push("<b>"),i.push("</b>")),a.i&&(s.push("<i>"),i.push("</i>")),a.strike&&(s.push("<s>"),i.push("</s>"));var l=a.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),i.push("</"+l+">")),i.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&t(a.s,s[0],s[2]),s[0].join("")+s[1].replace(r,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),KE=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,JE=/<(?:\w+:)?r>/,QE=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function ed(e,r){var t=r?r.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=dt(xt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=xt(e),t&&(n.h=Hu(n.t))):e.match(JE)&&(n.r=xt(e),n.t=dt(xt((e.replace(QE,"").match(KE)||[]).join("").replace(wr,""))),t&&(n.h=XE(qE(n.r)))),n):{t:""}}var ZE=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,eT=/<(?:\w+:)?(?:si|sstItem)>/g,tT=/<\/(?:\w+:)?(?:si|sstItem)>/;function rT(e,r){var t=[],n="";if(!e)return t;var a=e.match(ZE);if(a){n=a[2].replace(eT,"").split(tT);for(var s=0;s!=n.length;++s){var i=ed(n[s].trim(),r);i!=null&&(t[t.length]=i)}a=Ke(a[1]),t.Count=a.count,t.Unique=a.uniqueCount}return t}function nT(e){return[e.read_shift(4),e.read_shift(4)]}function aT(e,r){var t=[],n=!1;return na(e,function(s,i,c){switch(c){case 159:t.Count=s[0],t.Unique=s[1];break;case 19:t.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||r.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),t}function hx(e){for(var r=[],t=e.split(""),n=0;n<t.length;++n)r[n]=t[n].charCodeAt(0);return r}function Qn(e,r){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),r>=4&&(e.l+=r-4),t}function sT(e){var r={};return r.id=e.read_shift(0,"lpp4"),r.R=Qn(e,4),r.U=Qn(e,4),r.W=Qn(e,4),r}function iT(e){for(var r=e.read_shift(4),t=e.l+r-4,n={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return n}function oT(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(iT(e));return r}function cT(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(e.read_shift(0,"lpp4"));return r}function lT(e){var r={};return e.read_shift(4),e.l+=4,r.id=e.read_shift(0,"lpp4"),r.name=e.read_shift(0,"lpp4"),r.R=Qn(e,4),r.U=Qn(e,4),r.W=Qn(e,4),r}function uT(e){var r=lT(e);if(r.ename=e.read_shift(0,"8lpp4"),r.blksz=e.read_shift(4),r.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function px(e,r){var t=e.l+r,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,n}function mx(e,r){var t={},n=e.l+r;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,n),e.l=n,t}function dT(e){var r=Qn(e);switch(r.Minor){case 2:return[r.Minor,fT(e)];case 3:return[r.Minor,hT()];case 4:return[r.Minor,pT(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function fT(e){var r=e.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),n=px(e,t),a=mx(e,e.length-e.l);return{t:"Std",h:n,v:a}}function hT(){throw new Error("File is password-protected: ECMA-376 Extensible")}function pT(e){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),n={};return t.replace(wr,function(s){var i=Ke(s);switch(Vn(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(c){n[c]=i[c]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function mT(e,r){var t={},n=t.EncryptionVersionInfo=Qn(e,4);if(r-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);t.Flags=e.read_shift(4),r-=4;var a=e.read_shift(4);return r-=4,t.EncryptionHeader=px(e,a),r-=a,t.EncryptionVerifier=mx(e,r),t}function xT(e){var r={},t=r.EncryptionVersionInfo=Qn(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return r.Salt=e.read_shift(16),r.EncryptedVerifier=e.read_shift(16),r.EncryptedVerifierHash=e.read_shift(16),r}function gT(e){var r=0,t,n=hx(e),a=n.length+1,s,i,c,l,u;for(t=xa(a),t[0]=n.length,s=1;s!=a;++s)t[s]=n[s-1];for(s=a-1;s>=0;--s)i=t[s],c=r&16384?1:0,l=r<<1&32767,u=c|l,r=u^i;return r^52811}var xx=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},a=function(i,c){return n(i^c)},s=function(i){for(var c=r[i.length-1],l=104,u=i.length-1;u>=0;--u)for(var d=i[u],f=0;f!=7;++f)d&64&&(c^=t[l]),d*=2,--l;return c};return function(i){for(var c=hx(i),l=s(c),u=c.length,d=xa(16),f=0;f!=16;++f)d[f]=0;var h,x,p;for((u&1)===1&&(h=l>>8,d[u]=a(e[0],h),--u,h=l&255,x=c[c.length-1],d[u]=a(x,h));u>0;)--u,h=l>>8,d[u]=a(c[u],h),--u,h=l&255,d[u]=a(c[u],h);for(u=15,p=15-c.length;p>0;)h=l>>8,d[u]=a(e[p],h),--u,--p,h=l&255,d[u]=a(c[u],h),--u,--p;return d}}(),vT=function(e,r,t,n,a){a||(a=r),n||(n=xx(e));var s,i;for(s=0;s!=r.length;++s)i=r[s],i^=n[t],i=(i>>5|i<<3)&255,a[s]=i,++t;return[a,t,n]},yT=function(e){var r=0,t=xx(e);return function(n){var a=vT("",n,r,t);return r=a[1],a[0]}};function bT(e,r,t,n){var a={key:Vt(e),verificationBytes:Vt(e)};return t.password&&(a.verifier=gT(t.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=yT(t.password)),a}function wT(e,r,t){var n=t||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=xT(e):n.Data=mT(e,r),n}function ST(e,r,t){var n={Type:t.biff>=8?e.read_shift(2):0};return n.Type?wT(e,r-2,n):bT(e,t.biff>=8?r:r-2,t,n),n}var ET=function(){function e(a,s){switch(s.type){case"base64":return r(Kr(a),s);case"binary":return r(a,s);case"buffer":return r(ot&&Buffer.isBuffer(a)?a.toString("binary"):us(a),s);case"array":return r(ss(a),s)}throw new Error("Unrecognized type "+s.type)}function r(a,s){var i=s||{},c=i.dense?[]:{},l=a.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(d,f){Array.isArray(c)&&(c[f]=[]);for(var h=/\\\w+\b/g,x=0,p,m=-1;p=h.exec(d);){switch(p[0]){case"\\cell":var g=d.slice(x,h.lastIndex-p[0].length);if(g[0]==" "&&(g=g.slice(1)),++m,g.length){var v={v:g,t:"s"};Array.isArray(c)?c[f][m]=v:c[Qe({r:f,c:m})]=v}break}x=h.lastIndex}m>u.e.c&&(u.e.c=m)}),c["!ref"]=lt(u),c}function t(a,s){return ba(e(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],i=Pt(a["!ref"]),c,l=Array.isArray(a),u=i.s.r;u<=i.e.r;++u){s.push("\\trowd\\trautofit1");for(var d=i.s.c;d<=i.e.c;++d)s.push("\\cellx"+(d+1));for(s.push("\\pard\\intbl"),d=i.s.c;d<=i.e.c;++d){var f=Qe({r:u,c:d});c=l?(a[u]||[])[d]:a[f],!(!c||c.v==null&&(!c.f||c.F))&&(s.push(" "+(c.w||(Zn(c),c.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:n}}();function TT(e){var r=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function Gi(e){for(var r=0,t=1;r!=3;++r)t=t*256+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}function kT(e){var r=e[0]/255,t=e[1]/255,n=e[2]/255,a=Math.max(r,t,n),s=Math.min(r,t,n),i=a-s;if(i===0)return[0,0,r];var c=0,l=0,u=a+s;switch(l=i/(u>1?2-u:u),a){case r:c=((t-n)/i+6)%6;break;case t:c=(n-r)/i+2;break;case n:c=(r-t)/i+4;break}return[c/6,l,u/2]}function AT(e){var r=e[0],t=e[1],n=e[2],a=t*2*(n<.5?n:1-n),s=n-a/2,i=[s,s,s],c=6*r,l;if(t!==0)switch(c|0){case 0:case 6:l=a*c,i[0]+=a,i[1]+=l;break;case 1:l=a*(2-c),i[0]+=l,i[1]+=a;break;case 2:l=a*(c-2),i[1]+=a,i[2]+=l;break;case 3:l=a*(4-c),i[1]+=l,i[2]+=a;break;case 4:l=a*(c-4),i[2]+=a,i[0]+=l;break;case 5:l=a*(6-c),i[2]+=l,i[0]+=a;break}for(var u=0;u!=3;++u)i[u]=Math.round(i[u]*255);return i}function sc(e,r){if(r===0)return e;var t=kT(TT(e));return r<0?t[2]=t[2]*(1+r):t[2]=1-(1-t[2])*(1-r),Gi(AT(t))}var gx=6,CT=15,_T=1,Er=gx;function ic(e){return Math.floor((e+Math.round(128/Er)/256)*Er)}function oc(e){return Math.floor((e-5)/Er*100+.5)/100}function ql(e){return Math.round((e*Er+5)/Er*256)/256}function pl(e){return ql(oc(ic(e)))}function td(e){var r=Math.abs(e-pl(e)),t=Er;if(r>.005)for(Er=_T;Er<CT;++Er)Math.abs(e-pl(e))<=r&&(r=Math.abs(e-pl(e)),t=Er);Er=t}function Xs(e){e.width?(e.wpx=ic(e.width),e.wch=oc(e.wpx),e.MDW=Er):e.wpx?(e.wch=oc(e.wpx),e.width=ql(e.wch),e.MDW=Er):typeof e.wch=="number"&&(e.width=ql(e.wch),e.wpx=ic(e.width),e.MDW=Er),e.customWidth&&delete e.customWidth}var DT=96,vx=DT;function yx(e){return e*96/vx}function Yi(e){return e*vx/96}var FT={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function IT(e,r,t,n){r.Borders=[];var a={},s=!1;(e[0].match(wr)||[]).forEach(function(i){var c=Ke(i);switch(Vn(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},c.diagonalUp&&(a.diagonalUp=bt(c.diagonalUp)),c.diagonalDown&&(a.diagonalDown=bt(c.diagonalDown)),r.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+c[0]+" in borders")}})}function PT(e,r,t,n){r.Fills=[];var a={},s=!1;(e[0].match(wr)||[]).forEach(function(i){var c=Ke(i);switch(Vn(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},r.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":c.patternType&&(a.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),c.indexed&&(a.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(a.bgColor.theme=parseInt(c.theme,10)),c.tint&&(a.bgColor.tint=parseFloat(c.tint)),c.rgb&&(a.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),c.theme&&(a.fgColor.theme=parseInt(c.theme,10)),c.tint&&(a.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(a.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+c[0]+" in fills")}})}function OT(e,r,t,n){r.Fonts=[];var a={},s=!1;(e[0].match(wr)||[]).forEach(function(i){var c=Ke(i);switch(Vn(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(a),a={};break;case"<name":c.val&&(a.name=xt(c.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=c.val?bt(c.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=c.val?bt(c.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(c.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=c.val?bt(c.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=c.val?bt(c.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=c.val?bt(c.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=c.val?bt(c.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=c.val?bt(c.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":c.val&&(a.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(a.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(a.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(a.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=Mu[parseInt(c.val,10)];break;case"<color":if(a.color||(a.color={}),c.auto&&(a.color.auto=bt(c.auto)),c.rgb)a.color.rgb=c.rgb.slice(-6);else if(c.indexed){a.color.index=parseInt(c.indexed,10);var l=Wa[a.color.index];a.color.index==81&&(l=Wa[1]),l||(l=Wa[1]),a.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else c.theme&&(a.color.theme=parseInt(c.theme,10),c.tint&&(a.color.tint=parseFloat(c.tint)),c.theme&&t.themeElements&&t.themeElements.clrScheme&&(a.color.rgb=sc(t.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+c[0]+" in fonts")}})}function jT(e,r,t){r.NumberFmt=[];for(var n=Bn(rt),a=0;a<n.length;++a)r.NumberFmt[n[a]]=rt[n[a]];var s=e[0].match(wr);if(s)for(a=0;a<s.length;++a){var i=Ke(s[a]);switch(Vn(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=dt(xt(i.formatCode)),l=parseInt(i.numFmtId,10);if(r.NumberFmt[l]=c,l>0){if(l>392){for(l=392;l>60&&r.NumberFmt[l]!=null;--l);r.NumberFmt[l]=c}Va(c,l)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}var Do=["numFmtId","fillId","fontId","borderId","xfId"],Fo=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function RT(e,r,t){r.CellXf=[];var n,a=!1;(e[0].match(wr)||[]).forEach(function(s){var i=Ke(s),c=0;switch(Vn(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],c=0;c<Do.length;++c)n[Do[c]]&&(n[Do[c]]=parseInt(n[Do[c]],10));for(c=0;c<Fo.length;++c)n[Fo[c]]&&(n[Fo[c]]=bt(n[Fo[c]]));if(r.NumberFmt&&n.numFmtId>392){for(c=392;c>60;--c)if(r.NumberFmt[n.numFmtId]==r.NumberFmt[c]){n.numFmtId=c;break}}r.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};i.vertical&&(l.vertical=i.vertical),i.horizontal&&(l.horizontal=i.horizontal),i.textRotation!=null&&(l.textRotation=i.textRotation),i.indent&&(l.indent=i.indent),i.wrapText&&(l.wrapText=bt(i.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(t&&t.WTF&&!a)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}var NT=function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,l,u){var d={};if(!c)return d;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=c.match(r))&&jT(f,d,u),(f=c.match(a))&&OT(f,d,l,u),(f=c.match(n))&&PT(f,d,l,u),(f=c.match(s))&&IT(f,d,l,u),(f=c.match(t))&&RT(f,d,u),d}}();function MT(e,r){var t=e.read_shift(2),n=yr(e);return[t,n]}function LT(e,r,t){var n={};n.sz=e.read_shift(2)/20;var a=q2(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var c=e.read_shift(1);c>0&&(n.family=c);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=Y2(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=yr(e),n}var BT=br;function $T(e,r){var t=e.l+r,n=e.read_shift(2),a=e.read_shift(2);return e.l=t,{ixfe:n,numFmtId:a}}var UT=br;function VT(e,r,t){var n={};n.NumberFmt=[];for(var a in rt)n.NumberFmt[a]=rt[a];n.CellXf=[],n.Fonts=[];var s=[],i=!1;return na(e,function(l,u,d){switch(d){case 44:n.NumberFmt[l[0]]=l[1],Va(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(l.color.rgb=sc(r.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(d),i=!0;break;case 38:s.pop(),i=!1;break;default:if(u.T>0)s.push(d);else if(u.T<0)s.pop();else if(!i||t.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}var WT=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function HT(e,r,t){r.themeElements.clrScheme=[];var n={};(e[0].match(wr)||[]).forEach(function(a){var s=Ke(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(r.themeElements.clrScheme[WT.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function zT(){}function GT(){}var YT=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,qT=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,XT=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function KT(e,r,t){r.themeElements={};var n;[["clrScheme",YT,HT],["fontScheme",qT,zT],["fmtScheme",XT,GT]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,r,t)})}var JT=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function bx(e,r){(!e||e.length===0)&&(e=QT());var t,n={};if(!(t=e.match(JT)))throw new Error("themeElements not found in theme");return KT(t[0],n,r),n.raw=e,n}function QT(e,r){if(r&&r.themeXLSX)return r.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var t=[Im];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯"/>',t[t.length]='<a:font script="Hang" typeface="ë§‘ì€ ê³ ë”•"/>',t[t.length]='<a:font script="Hans" typeface="å®‹ä½“"/>',t[t.length]='<a:font script="Hant" typeface="æ–°ç´°æ˜Žé«”"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯"/>',t[t.length]='<a:font script="Hang" typeface="ë§‘ì€ ê³ ë”•"/>',t[t.length]='<a:font script="Hans" typeface="å®‹ä½“"/>',t[t.length]='<a:font script="Hant" typeface="æ–°ç´°æ˜Žé«”"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function ZT(e,r,t){var n=e.l+r,a=e.read_shift(4);if(a!==124226){if(!t.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var i;try{i=Fm(s,{type:"array"})}catch{return}var c=zr(i,"theme/theme/theme1.xml",!0);if(c)return bx(c,t)}}function ek(e){return e.read_shift(4)}function tk(e){var r={};switch(r.xclrType=e.read_shift(2),r.nTintShade=e.read_shift(2),r.xclrType){case 0:e.l+=4;break;case 1:r.xclrValue=rk(e,4);break;case 2:r.xclrValue=ix(e);break;case 3:r.xclrValue=ek(e);break;case 4:e.l+=4;break}return e.l+=8,r}function rk(e,r){return br(e,r)}function nk(e,r){return br(e,r)}function ak(e){var r=e.read_shift(2),t=e.read_shift(2)-4,n=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=tk(e);break;case 6:n[1]=nk(e,t);break;case 14:case 15:n[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+t)}return n}function sk(e,r){var t=e.l+r;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),s=[];a-- >0;)s.push(ak(e,t-e.l));return{ixfe:n,ext:s}}function ik(e,r){r.forEach(function(t){switch(t[0]){}})}function ok(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:yr(e)}}function ck(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function lk(e){return e.l+=4,e.read_shift(4)!=0}function uk(e,r,t){var n={Types:[],Cell:[],Value:[]},a=t||{},s=[],i=!1,c=2;return na(e,function(l,u,d){switch(d){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(f){c==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):c==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:c=l?1:0;break;case 338:c=2;break;case 35:s.push(d),i=!0;break;case 36:s.pop(),i=!1;break;default:if(!u.T){if(!i||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function dk(e,r,t){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,s=2,i;return e.replace(wr,function(c){var l=Ke(c);switch(Vn(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==l.name&&(i=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+l.i);break;default:if(!a&&t.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return c}),n}function fk(e){var r=[];if(!e)return r;var t=1;return(e.match(wr)||[]).forEach(function(n){var a=Ke(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?t=a.i:a.i=t,r.push(a);break}}),r}function hk(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=Qe(t);var n=e.read_shift(1);return n&2&&(r.l="1"),n&8&&(r.a="1"),r}function pk(e,r,t){var n=[];return na(e,function(s,i,c){switch(c){case 63:n.push(s);break;default:if(!i.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),n}function mk(e,r,t,n){if(!e)return e;var a=n||{},s=!1;na(e,function(c,l,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},a)}function xk(e,r){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][t].Target}function P0(e,r,t,n){var a=Array.isArray(e),s;r.forEach(function(i){var c=Tr(i.ref);if(a?(e[c.r]||(e[c.r]=[]),s=e[c.r][c.c]):s=e[i.ref],!s){s={t:"z"},a?e[c.r][c.c]=s:e[i.ref]=s;var l=Pt(e["!ref"]||"BDWGO1000001:A1");l.s.r>c.r&&(l.s.r=c.r),l.e.r<c.r&&(l.e.r=c.r),l.s.c>c.c&&(l.s.c=c.c),l.e.c<c.c&&(l.e.c=c.c);var u=lt(l);u!==e["!ref"]&&(e["!ref"]=u)}s.c||(s.c=[]);var d={a:i.author,t:i.t,r:i.r,T:t};i.h&&(d.h=i.h);for(var f=s.c.length-1;f>=0;--f){if(!t&&s.c[f].T)return;t&&!s.c[f].T&&s.c.splice(f,1)}if(t&&n){for(f=0;f<n.length;++f)if(d.a==n[f].id){d.a=n[f].name||d.a;break}}s.c.push(d)})}function gk(e,r){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var c=i.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&t.push(c[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var c=i.match(/<(?:\w+:)?comment[^>]*>/);if(c){var l=Ke(c[0]),u={author:l.authorId&&t[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},d=Tr(l.ref);if(!(r.sheetRows&&r.sheetRows<=d.r)){var f=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&ed(f[1])||{r:"",t:"",h:""};u.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),u.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(u.h=h.h),n.push(u)}}}}),n}function vk(e,r){var t=[],n=!1,a={},s=0;return e.replace(wr,function(c,l){var u=Ke(c);switch(Vn(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":a.t!=null&&t.push(a);break;case"<text>":case"<text":s=l+c.length;break;case"</text>":a.t=e.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return c}),t}function yk(e,r){var t=[],n=!1;return e.replace(wr,function(s){var i=Ke(s);switch(Vn(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return s}),t}function bk(e){var r={};r.iauthor=e.read_shift(4);var t=fs(e);return r.rfx=t.s,r.ref=Qe(t.s),e.l+=16,r}var wk=yr;function Sk(e,r){var t=[],n=[],a={},s=!1;return na(e,function(c,l,u){switch(u){case 632:n.push(c);break;case 635:a=c;break;case 637:a.t=c.t,a.h=c.h,a.r=c.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,r.sheetRows&&a.rfx&&r.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,t.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||r.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),t}var Ek="application/vnd.ms-office.vbaProject";function Tk(e){var r=ct.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,n){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var a=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");ct.utils.cfb_add(r,a,e.FileIndex[n].content)}}),ct.write(r)}function kk(){return{"!type":"dialog"}}function Ak(){return{"!type":"dialog"}}function Ck(){return{"!type":"macro"}}function _k(){return{"!type":"macro"}}var Ls=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(n,a,s,i){var c=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,d=i.length>0?parseInt(i,10)|0:0;return c?d+=r.c:--d,l?u+=r.r:--u,a+(c?"":"$")+qt(d)+(l?"":"$")+cr(u)}return function(a,s){return r=s,a.replace(e,t)}}(),wx=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Dk=function(){return function(r,t){return r.replace(wx,function(n,a,s,i,c,l){var u=qu(i)-(s?0:t.c),d=Yu(l)-(c?0:t.r),f=d==0?"":c?d+1:"["+d+"]",h=u==0?"":s?u+1:"["+u+"]";return a+"R"+f+"C"+h})}}();function Sx(e,r){return e.replace(wx,function(t,n,a,s,i,c){return n+(a=="$"?a+s:qt(qu(s)+r.c))+(i=="$"?i+c:cr(Yu(c)+r.r))})}function Fk(e,r,t){var n=ai(r),a=n.s,s=Tr(t),i={r:s.r-a.r,c:s.c-a.c};return Sx(e,i)}function Ik(e){return e.length!=1}function O0(e){return e.replace(/_xlfn\./g,"")}function $t(e){e.l+=1}function ga(e,r){var t=e.read_shift(r==1?1:2);return[t&16383,t>>14&1,t>>15&1]}function Ex(e,r,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return Tx(e);t.biff==12&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),i=ga(e,2),c=ga(e,2);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:c[0],cRel:c[1],rRel:c[2]}}}function Tx(e){var r=ga(e,2),t=ga(e,2),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:r[0],c:n,cRel:r[1],rRel:r[2]},e:{r:t[0],c:a,cRel:t[1],rRel:t[2]}}}function Pk(e,r,t){if(t.biff<8)return Tx(e);var n=e.read_shift(t.biff==12?4:2),a=e.read_shift(t.biff==12?4:2),s=ga(e,2),i=ga(e,2);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:i[0],cRel:i[1],rRel:i[2]}}}function kx(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return Ok(e);var n=e.read_shift(t&&t.biff==12?4:2),a=ga(e,2);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function Ok(e){var r=ga(e,2),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}function jk(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function Rk(e,r,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return Nk(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),i=(s&16384)>>14,c=(s&32768)>>15;if(s&=16383,c==1)for(;a>524287;)a-=1048576;if(i==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:i,rRel:c}}function Nk(e){var r=e.read_shift(2),t=e.read_shift(1),n=(r&32768)>>15,a=(r&16384)>>14;return r&=16383,n==1&&r>=8192&&(r=r-16384),a==1&&t>=128&&(t=t-256),{r,c:t,cRel:a,rRel:n}}function Mk(e,r,t){var n=(e[e.l++]&96)>>5,a=Ex(e,t.biff>=2&&t.biff<=5?6:8,t);return[n,a]}function Lk(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var i=Ex(e,s,t);return[n,a,i]}function Bk(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function $k(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=8;if(t)switch(t.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,a]}function Uk(e,r,t){var n=(e[e.l++]&96)>>5,a=Pk(e,r-1,t);return[n,a]}function Vk(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[n]}function j0(e){var r=e[e.l+1]&1,t=1;return e.l+=4,[r,t]}function Wk(e,r,t){e.l+=2;for(var n=e.read_shift(t&&t.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(t&&t.biff==2?1:2));return a}function Hk(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function zk(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function Gk(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function Yk(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[n]}function Ax(e){var r=e.read_shift(1),t=e.read_shift(1);return[r,t]}function qk(e){return e.read_shift(2),Ax(e)}function Xk(e){return e.read_shift(2),Ax(e)}function Kk(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=kx(e,0,t);return[n,a]}function Jk(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=Rk(e,0,t);return[n,a]}function Qk(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var s=kx(e,0,t);return[n,a,s]}function Zk(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(t&&t.biff<=3?1:2);return[eC[a],Dx[a],n]}function eA(e,r,t){var n=e[e.l++],a=e.read_shift(1),s=t&&t.biff<=3?[n==88?-1:0,e.read_shift(1)]:tA(e);return[a,(s[0]===0?Dx:ZA)[s[1]]]}function tA(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function rA(e,r,t){e.l+=t&&t.biff==2?3:4}function nA(e,r,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function aA(e){return e.l++,hs[e.read_shift(1)]}function sA(e){return e.l++,e.read_shift(2)}function iA(e){return e.l++,e.read_shift(1)!==0}function oA(e){return e.l++,xr(e)}function cA(e,r,t){return e.l++,co(e,r-1,t)}function lA(e,r){var t=[e.read_shift(1)];if(r==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=Nt(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:t[1]=hs[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=xr(e);break;case 2:t[1]=ps(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function uA(e,r,t){for(var n=e.read_shift(t.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((t.biff==12?fs:Pc)(e));return a}function dA(e,r,t){var n=0,a=0;t.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--a==0&&(a=256));for(var s=0,i=[];s!=n&&(i[s]=[]);++s)for(var c=0;c!=a;++c)i[s][c]=lA(e,t.biff);return i}function fA(e,r,t){var n=e.read_shift(1)>>>5&3,a=!t||t.biff>=8?4:2,s=e.read_shift(a);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function hA(e,r,t){if(t.biff==5)return pA(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),s=e.read_shift(4);return[n,a,s]}function pA(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[r,t,n]}function mA(e,r,t){var n=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function xA(e,r,t){var n=e.read_shift(1)>>>5&3,a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function gA(e,r,t){var n=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[n]}function vA(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,a]}var yA=br,bA=br,wA=br;function uo(e,r,t){return e.l+=2,[jk(e)]}function rd(e){return e.l+=6,[]}var SA=uo,EA=rd,TA=rd,kA=uo;function Cx(e){return e.l+=2,[Vt(e),e.read_shift(2)&1]}var AA=uo,CA=Cx,_A=rd,DA=uo,FA=uo,IA=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function PA(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2),i=IA[t>>2&31];return{ixti:r,coltype:t&3,rt:i,idx:n,c:a,C:s}}function OA(e){return e.l+=2,[e.read_shift(4)]}function jA(e,r,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function RA(e,r,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function NA(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function MA(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function LA(e){return e.l+=4,[0,0]}var R0={1:{n:"PtgExp",f:nA},2:{n:"PtgTbl",f:wA},3:{n:"PtgAdd",f:$t},4:{n:"PtgSub",f:$t},5:{n:"PtgMul",f:$t},6:{n:"PtgDiv",f:$t},7:{n:"PtgPower",f:$t},8:{n:"PtgConcat",f:$t},9:{n:"PtgLt",f:$t},10:{n:"PtgLe",f:$t},11:{n:"PtgEq",f:$t},12:{n:"PtgGe",f:$t},13:{n:"PtgGt",f:$t},14:{n:"PtgNe",f:$t},15:{n:"PtgIsect",f:$t},16:{n:"PtgUnion",f:$t},17:{n:"PtgRange",f:$t},18:{n:"PtgUplus",f:$t},19:{n:"PtgUminus",f:$t},20:{n:"PtgPercent",f:$t},21:{n:"PtgParen",f:$t},22:{n:"PtgMissArg",f:$t},23:{n:"PtgStr",f:cA},26:{n:"PtgSheet",f:jA},27:{n:"PtgEndSheet",f:RA},28:{n:"PtgErr",f:aA},29:{n:"PtgBool",f:iA},30:{n:"PtgInt",f:sA},31:{n:"PtgNum",f:oA},32:{n:"PtgArray",f:Vk},33:{n:"PtgFunc",f:Zk},34:{n:"PtgFuncVar",f:eA},35:{n:"PtgName",f:fA},36:{n:"PtgRef",f:Kk},37:{n:"PtgArea",f:Mk},38:{n:"PtgMemArea",f:mA},39:{n:"PtgMemErr",f:yA},40:{n:"PtgMemNoMem",f:bA},41:{n:"PtgMemFunc",f:xA},42:{n:"PtgRefErr",f:gA},43:{n:"PtgAreaErr",f:Bk},44:{n:"PtgRefN",f:Jk},45:{n:"PtgAreaN",f:Uk},46:{n:"PtgMemAreaN",f:NA},47:{n:"PtgMemNoMemN",f:MA},57:{n:"PtgNameX",f:hA},58:{n:"PtgRef3d",f:Qk},59:{n:"PtgArea3d",f:Lk},60:{n:"PtgRefErr3d",f:vA},61:{n:"PtgAreaErr3d",f:$k},255:{}},BA={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},$A={1:{n:"PtgElfLel",f:Cx},2:{n:"PtgElfRw",f:DA},3:{n:"PtgElfCol",f:SA},6:{n:"PtgElfRwV",f:FA},7:{n:"PtgElfColV",f:kA},10:{n:"PtgElfRadical",f:AA},11:{n:"PtgElfRadicalS",f:_A},13:{n:"PtgElfColS",f:EA},15:{n:"PtgElfColSV",f:TA},16:{n:"PtgElfRadicalLel",f:CA},25:{n:"PtgList",f:PA},29:{n:"PtgSxName",f:OA},255:{}},UA={0:{n:"PtgAttrNoop",f:LA},1:{n:"PtgAttrSemi",f:Yk},2:{n:"PtgAttrIf",f:zk},4:{n:"PtgAttrChoose",f:Wk},8:{n:"PtgAttrGoto",f:Hk},16:{n:"PtgAttrSum",f:rA},32:{n:"PtgAttrBaxcel",f:j0},33:{n:"PtgAttrBaxcel",f:j0},64:{n:"PtgAttrSpace",f:qk},65:{n:"PtgAttrSpaceSemi",f:Xk},128:{n:"PtgAttrIfError",f:Gk},255:{}};function fo(e,r,t,n){if(n.biff<8)return br(e,r);for(var a=e.l+r,s=[],i=0;i!==t.length;++i)switch(t[i][0]){case"PtgArray":t[i][1]=dA(e,0,n),s.push(t[i][1]);break;case"PtgMemArea":t[i][2]=uA(e,t[i][1],n),s.push(t[i][2]);break;case"PtgExp":n&&n.biff==12&&(t[i][1][1]=e.read_shift(4),s.push(t[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[i][0]}return r=a-e.l,r!==0&&s.push(br(e,r)),s}function ho(e,r,t){for(var n=e.l+r,a,s,i=[];n!=e.l;)r=n-e.l,s=e[e.l],a=R0[s]||R0[BA[s]],(s===24||s===25)&&(a=(s===24?$A:UA)[e[e.l+1]]),!a||!a.f?br(e,r):i.push([a.n,a.f(e,r,t)]);return i}function VA(e){for(var r=[],t=0;t<e.length;++t){for(var n=e[t],a=[],s=0;s<n.length;++s){var i=n[s];if(i)switch(i[0]){case 2:a.push('"'+i[1].replace(/"/g,'""')+'"');break;default:a.push(i[1])}else a.push("")}r.push(a.join(","))}return r.join(";")}var WA={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function HA(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function _x(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!n)return"SH33TJSERR1";var a="";if(t.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function N0(e,r,t){var n=_x(e,r,t);return n=="#REF"?n:HA(n,t)}function hr(e,r,t,n,a){var s=a&&a.biff||8,i={s:{c:0,r:0},e:{c:0,r:0}},c=[],l,u,d,f=0,h=0,x,p="";if(!e[0]||!e[0][0])return"";for(var m=-1,g="",v=0,y=e[0].length;v<y;++v){var b=e[0][v];switch(b[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=c.pop(),u=c.pop(),m>=0){switch(e[0][m][1][0]){case 0:g=Ft(" ",e[0][m][1][1]);break;case 1:g=Ft("\r",e[0][m][1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}u=u+g,m=-1}c.push(u+WA[b[0]]+l);break;case"PtgIsect":l=c.pop(),u=c.pop(),c.push(u+" "+l);break;case"PtgUnion":l=c.pop(),u=c.pop(),c.push(u+","+l);break;case"PtgRange":l=c.pop(),u=c.pop(),c.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=_i(b[1][1],i,a),c.push(Di(d,s));break;case"PtgRefN":d=t?_i(b[1][1],t,a):b[1][1],c.push(Di(d,s));break;case"PtgRef3d":f=b[1][1],d=_i(b[1][2],i,a),p=N0(n,f,a),c.push(p+"!"+Di(d,s));break;case"PtgFunc":case"PtgFuncVar":var S=b[1][0],I=b[1][1];S||(S=0),S&=127;var k=S==0?[]:c.slice(-S);c.length-=S,I==="User"&&(I=k.shift()),c.push(I+"("+k.join(",")+")");break;case"PtgBool":c.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(b[1]);break;case"PtgNum":c.push(String(b[1]));break;case"PtgStr":c.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(b[1]);break;case"PtgAreaN":x=x0(b[1][1],t?{s:t}:i,a),c.push(fl(x,a));break;case"PtgArea":x=x0(b[1][1],i,a),c.push(fl(x,a));break;case"PtgArea3d":f=b[1][1],x=b[1][2],p=N0(n,f,a),c.push(p+"!"+fl(x,a));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=b[1][2];var E=(n.names||[])[h-1]||(n[0]||[])[h],T=E?E.Name:"SH33TJSNAME"+String(h);T&&T.slice(0,6)=="_xlfn."&&!a.xlfn&&(T=T.slice(6)),c.push(T);break;case"PtgNameX":var w=b[1][1];h=b[1][2];var F;if(a.biff<=5)w<0&&(w=-w),n[w]&&(F=n[w][h]);else{var P="";if(((n[w]||[])[0]||[])[0]==14849||(((n[w]||[])[0]||[])[0]==1025?n[w][h]&&n[w][h].itab>0&&(P=n.SheetNames[n[w][h].itab-1]+"!"):P=n.SheetNames[h-1]+"!"),n[w]&&n[w][h])P+=n[w][h].Name;else if(n[0]&&n[0][h])P+=n[0][h].Name;else{var A=(_x(n,w,a)||"").split(";;");A[h-1]?P=A[h-1]:P+="SH33TJSERRX"}c.push(P);break}F||(F={Name:"SH33TJSERRY"}),c.push(F.Name);break;case"PtgParen":var L="(",Y=")";if(m>=0){switch(g="",e[0][m][1][0]){case 2:L=Ft(" ",e[0][m][1][1])+L;break;case 3:L=Ft("\r",e[0][m][1][1])+L;break;case 4:Y=Ft(" ",e[0][m][1][1])+Y;break;case 5:Y=Ft("\r",e[0][m][1][1])+Y;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}c.push(L+c.pop()+Y);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":d={c:b[1][1],r:b[1][0]};var q={c:t.c,r:t.r};if(n.sharedf[Qe(d)]){var Q=n.sharedf[Qe(d)];c.push(hr(Q,i,q,n,a))}else{var K=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){c.push(hr(u[1],i,q,n,a)),K=!0;break}K||c.push(b[1])}break;case"PtgArray":c.push("{"+VA(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var ye=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&m>=0&&ye.indexOf(e[0][v][0])==-1){b=e[0][m];var U=!0;switch(b[1][0]){case 4:U=!1;case 0:g=Ft(" ",b[1][1]);break;case 5:U=!1;case 1:g=Ft("\r",b[1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}c.push((U?g:"")+c.pop()+(U?"":g)),m=-1}}if(c.length>1&&a.WTF)throw new Error("bad formula stack");return c[0]}function zA(e,r,t){var n=e.l+r,a=t.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],br(e,r-2)];var c=ho(e,i,t);return r!==i+a&&(s=fo(e,r-i-a,c,t)),e.l=n,[c,s]}function GA(e,r,t){var n=e.l+r,a=t.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],br(e,r-2)];var c=ho(e,i,t);return r!==i+a&&(s=fo(e,r-i-a,c,t)),e.l=n,[c,s]}function YA(e,r,t,n){var a=e.l+r,s=ho(e,n,t),i;return a!==e.l&&(i=fo(e,a-e.l,s,t)),[s,i]}function qA(e,r,t){var n=e.l+r,a,s=e.read_shift(2),i=ho(e,s,t);return s==65535?[[],br(e,r-2)]:(r!==s+2&&(a=fo(e,n-s-2,i,t)),[i,a])}function XA(e){var r;if(Xn(e,e.l+6)!==65535)return[xr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return r=e[e.l+2]===1,e.l+=8,[r,"b"];case 2:return r=e[e.l+2],e.l+=8,[r,"e"];case 3:return e.l+=8,["","s"]}return[]}function ml(e,r,t){var n=e.l+r,a=Wn(e);t.biff==2&&++e.l;var s=XA(e),i=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var c=GA(e,n-e.l,t);return{cell:a,val:s[0],formula:c,shared:i>>3&1,tt:s[1]}}function Oc(e,r,t){var n=e.read_shift(4),a=ho(e,n,t),s=e.read_shift(4),i=s>0?fo(e,s,a,t):null;return[a,i]}var KA=Oc,jc=Oc,JA=Oc,QA=Oc,ZA={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Dx={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},eC={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function M0(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function xl(e){var r=e.split(":"),t=r[0].split(".")[0];return[t,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}var Oi={},Bs={};function ji(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function Fx(e,r,t,n,a,s){try{n.cellNF&&(e.z=rt[r])}catch(c){if(n.WTF)throw c}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=nr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(rt[r]==null&&Va(r2[r]||"General",r),e.t==="e")e.w=e.w||hs[e.v];else if(r===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Vi(e.v);else if(e.t==="d"){var i=Cr(e.v);(i|0)===i?e.w=i.toString(10):e.w=Vi(i)}else{if(e.v===void 0)return"";e.w=as(e.v,Bs)}else e.t==="d"?e.w=an(r,Cr(e.v),Bs):e.w=an(r,e.v,Bs)}catch(c){if(n.WTF)throw c}if(n.cellStyles&&t!=null)try{e.s=s.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=sc(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=sc(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(c){if(n.WTF&&s.Fills)throw c}}}function tC(e,r){var t=Pt(r);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=lt(t))}var rC=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,nC=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,aC=/<(?:\w:)?hyperlink [^>]*>/mg,sC=/"(\w*:\w*)"/,iC=/<(?:\w:)?col\b[^>]*[\/]?>/g,oC=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,cC=/<(?:\w:)?pageMargins[^>]*\/>/g,Ix=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,lC=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,uC=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function dC(e,r,t,n,a,s,i){if(!e)return e;n||(n={"!id":{}});var c=r.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",f=e.match(nC);f?(u=e.slice(0,f.index),d=e.slice(f.index+f[0].length)):u=d=e;var h=u.match(Ix);h?nd(h[0],c,a,t):(h=u.match(lC))&&fC(h[0],h[1]||"",c,a,t);var x=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(x>0){var p=u.slice(x,x+50).match(sC);p&&tC(c,p[1])}var m=u.match(uC);m&&m[1]&&vC(m[1],a);var g=[];if(r.cellStyles){var v=u.match(iC);v&&mC(g,v)}f&&yC(f[1],c,r,l,s,i);var y=d.match(oC);y&&(c["!autofilter"]=xC(y[0]));var b=[],S=d.match(rC);if(S)for(x=0;x!=S.length;++x)b[x]=Pt(S[x].slice(S[x].indexOf('"')+1));var I=d.match(aC);I&&hC(c,I,n);var k=d.match(cC);if(k&&(c["!margins"]=pC(Ke(k[0]))),!c["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(c["!ref"]=lt(l)),r.sheetRows>0&&c["!ref"]){var E=Pt(c["!ref"]);r.sheetRows<=+E.e.r&&(E.e.r=r.sheetRows-1,E.e.r>l.e.r&&(E.e.r=l.e.r),E.e.r<E.s.r&&(E.s.r=E.e.r),E.e.c>l.e.c&&(E.e.c=l.e.c),E.e.c<E.s.c&&(E.s.c=E.e.c),c["!fullref"]=c["!ref"],c["!ref"]=lt(E))}return g.length>0&&(c["!cols"]=g),b.length>0&&(c["!merges"]=b),c}function nd(e,r,t,n){var a=Ke(e);t.Sheets[n]||(t.Sheets[n]={}),a.codeName&&(t.Sheets[n].CodeName=dt(xt(a.codeName)))}function fC(e,r,t,n,a){nd(e.slice(0,e.indexOf(">")),t,n,a)}function hC(e,r,t){for(var n=Array.isArray(e),a=0;a!=r.length;++a){var s=Ke(xt(r[a]),!0);if(!s.ref)return;var i=((t||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+dt(s.location))):(s.Target="#"+dt(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var c=Pt(s.ref),l=c.s.r;l<=c.e.r;++l)for(var u=c.s.c;u<=c.e.c;++u){var d=Qe({c:u,r:l});n?(e[l]||(e[l]=[]),e[l][u]||(e[l][u]={t:"z",v:void 0}),e[l][u].l=s):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=s)}}}function pC(e){var r={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(r[t]=parseFloat(e[t]))}),r}function mC(e,r){for(var t=!1,n=0;n!=r.length;++n){var a=Ke(r[n],!0);a.hidden&&(a.hidden=bt(a.hidden));var s=parseInt(a.min,10)-1,i=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!t&&a.width&&(t=!0,td(a.width)),Xs(a);s<=i;)e[s++]=or(a)}}function xC(e){var r={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return r}var gC=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function vC(e,r){r.Views||(r.Views=[{}]),(e.match(gC)||[]).forEach(function(t,n){var a=Ke(t);r.Views[n]||(r.Views[n]={}),+a.zoomScale&&(r.Views[n].zoom=+a.zoomScale),bt(a.rightToLeft)&&(r.Views[n].RTL=!0)})}var yC=function(){var e=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=Wi("v"),i=Wi("f");return function(l,u,d,f,h,x){for(var p=0,m="",g=[],v=[],y=0,b=0,S=0,I="",k,E,T=0,w=0,F,P,A=0,L=0,Y=Array.isArray(x.CellXf),q,Q=[],K=[],ye=Array.isArray(u),U=[],me={},J=!1,D=!!d.sheetStubs,B=l.split(r),V=0,W=B.length;V!=W;++V){m=B[V].trim();var Z=m.length;if(Z!==0){var fe=0;e:for(p=0;p<Z;++p)switch(m[p]){case">":if(m[p-1]!="/"){++p;break e}if(d&&d.cellStyles){if(E=Ke(m.slice(fe,p),!0),T=E.r!=null?parseInt(E.r,10):T+1,w=-1,d.sheetRows&&d.sheetRows<T)continue;me={},J=!1,E.ht&&(J=!0,me.hpt=parseFloat(E.ht),me.hpx=Yi(me.hpt)),E.hidden=="1"&&(J=!0,me.hidden=!0),E.outlineLevel!=null&&(J=!0,me.level=+E.outlineLevel),J&&(U[T-1]=me)}break;case"<":fe=p;break}if(fe>=p)break;if(E=Ke(m.slice(fe,p),!0),T=E.r!=null?parseInt(E.r,10):T+1,w=-1,!(d.sheetRows&&d.sheetRows<T)){f.s.r>T-1&&(f.s.r=T-1),f.e.r<T-1&&(f.e.r=T-1),d&&d.cellStyles&&(me={},J=!1,E.ht&&(J=!0,me.hpt=parseFloat(E.ht),me.hpx=Yi(me.hpt)),E.hidden=="1"&&(J=!0,me.hidden=!0),E.outlineLevel!=null&&(J=!0,me.level=+E.outlineLevel),J&&(U[T-1]=me)),g=m.slice(p).split(e);for(var ne=0;ne!=g.length&&g[ne].trim().charAt(0)=="<";++ne);for(g=g.slice(ne),p=0;p!=g.length;++p)if(m=g[p].trim(),m.length!==0){if(v=m.match(t),y=p,b=0,S=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,v!=null&&v.length===2){for(y=0,I=v[1],b=0;b!=I.length&&!((S=I.charCodeAt(b)-64)<1||S>26);++b)y=26*y+S;--y,w=y}else++w;for(b=0;b!=m.length&&m.charCodeAt(b)!==62;++b);if(++b,E=Ke(m.slice(0,b),!0),E.r||(E.r=Qe({r:T-1,c:w})),I=m.slice(b),k={t:""},(v=I.match(s))!=null&&v[1]!==""&&(k.v=dt(v[1])),d.cellFormula){if((v=I.match(i))!=null&&v[1]!==""){if(k.f=dt(xt(v[1])).replace(/\r\n/g,`
`),d.xlfn||(k.f=O0(k.f)),v[0].indexOf('t="array"')>-1)k.F=(I.match(a)||[])[1],k.F.indexOf(":")>-1&&Q.push([Pt(k.F),k.F]);else if(v[0].indexOf('t="shared"')>-1){P=Ke(v[0]);var ee=dt(xt(v[1]));d.xlfn||(ee=O0(ee)),K[parseInt(P.si,10)]=[P,ee,E.r]}}else(v=I.match(/<f[^>]*\/>/))&&(P=Ke(v[0]),K[P.si]&&(k.f=Fk(K[P.si][1],K[P.si][2],E.r)));var se=Tr(E.r);for(b=0;b<Q.length;++b)se.r>=Q[b][0].s.r&&se.r<=Q[b][0].e.r&&se.c>=Q[b][0].s.c&&se.c<=Q[b][0].e.c&&(k.F=Q[b][1])}if(E.t==null&&k.v===void 0)if(k.f||k.F)k.v=0,k.t="n";else if(D)k.t="z";else continue;else k.t=E.t||"n";switch(f.s.c>w&&(f.s.c=w),f.e.c<w&&(f.e.c=w),k.t){case"n":if(k.v==""||k.v==null){if(!D)continue;k.t="z"}else k.v=parseFloat(k.v);break;case"s":if(typeof k.v>"u"){if(!D)continue;k.t="z"}else F=Oi[parseInt(k.v,10)],k.v=F.t,k.r=F.r,d.cellHTML&&(k.h=F.h);break;case"str":k.t="s",k.v=k.v!=null?xt(k.v):"",d.cellHTML&&(k.h=Hu(k.v));break;case"inlineStr":v=I.match(n),k.t="s",v!=null&&(F=ed(v[1]))?(k.v=F.t,d.cellHTML&&(k.h=F.h)):k.v="";break;case"b":k.v=bt(k.v);break;case"d":d.cellDates?k.v=nr(k.v,1):(k.v=Cr(nr(k.v,1)),k.t="n");break;case"e":(!d||d.cellText!==!1)&&(k.w=k.v),k.v=Qm[k.v];break}if(A=L=0,q=null,Y&&E.s!==void 0&&(q=x.CellXf[E.s],q!=null&&(q.numFmtId!=null&&(A=q.numFmtId),d.cellStyles&&q.fillId!=null&&(L=q.fillId))),Fx(k,A,L,d,h,x),d.cellDates&&Y&&k.t=="n"&&ni(rt[A])&&(k.t="d",k.v=Ic(k.v)),E.cm&&d.xlmeta){var j=(d.xlmeta.Cell||[])[+E.cm-1];j&&j.type=="XLDAPR"&&(k.D=!0)}if(ye){var _=Tr(E.r);u[_.r]||(u[_.r]=[]),u[_.r][_.c]=k}else u[E.r]=k}}}}U.length>0&&(u["!rows"]=U)}}();function bC(e,r){var t={},n=e.l+r;t.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=a/20),t}var wC=fs;function SC(){}function EC(e,r){var t={},n=e[e.l];return++e.l,t.above=!(n&64),t.left=!(n&128),e.l+=18,t.name=z2(e),t}function TC(e){var r=on(e);return[r]}function kC(e){var r=ds(e);return[r]}function AC(e){var r=on(e),t=e.read_shift(1);return[r,t,"b"]}function CC(e){var r=ds(e),t=e.read_shift(1);return[r,t,"b"]}function _C(e){var r=on(e),t=e.read_shift(1);return[r,t,"e"]}function DC(e){var r=ds(e),t=e.read_shift(1);return[r,t,"e"]}function FC(e){var r=on(e),t=e.read_shift(4);return[r,t,"s"]}function IC(e){var r=ds(e),t=e.read_shift(4);return[r,t,"s"]}function PC(e){var r=on(e),t=xr(e);return[r,t,"n"]}function Px(e){var r=ds(e),t=xr(e);return[r,t,"n"]}function OC(e){var r=on(e),t=Ju(e);return[r,t,"n"]}function jC(e){var r=ds(e),t=Ju(e);return[r,t,"n"]}function RC(e){var r=on(e),t=Xu(e);return[r,t,"is"]}function NC(e){var r=on(e),t=yr(e);return[r,t,"str"]}function MC(e){var r=ds(e),t=yr(e);return[r,t,"str"]}function LC(e,r,t){var n=e.l+r,a=on(e);a.r=t["!row"];var s=e.read_shift(1),i=[a,s,"b"];if(t.cellFormula){e.l+=2;var c=jc(e,n-e.l,t);i[3]=hr(c,null,a,t.supbooks,t)}else e.l=n;return i}function BC(e,r,t){var n=e.l+r,a=on(e);a.r=t["!row"];var s=e.read_shift(1),i=[a,s,"e"];if(t.cellFormula){e.l+=2;var c=jc(e,n-e.l,t);i[3]=hr(c,null,a,t.supbooks,t)}else e.l=n;return i}function $C(e,r,t){var n=e.l+r,a=on(e);a.r=t["!row"];var s=xr(e),i=[a,s,"n"];if(t.cellFormula){e.l+=2;var c=jc(e,n-e.l,t);i[3]=hr(c,null,a,t.supbooks,t)}else e.l=n;return i}function UC(e,r,t){var n=e.l+r,a=on(e);a.r=t["!row"];var s=yr(e),i=[a,s,"str"];if(t.cellFormula){e.l+=2;var c=jc(e,n-e.l,t);i[3]=hr(c,null,a,t.supbooks,t)}else e.l=n;return i}var VC=fs;function WC(e,r){var t=e.l+r,n=fs(e),a=Ku(e),s=yr(e),i=yr(e),c=yr(e);e.l=t;var l={rfx:n,relId:a,loc:s,display:c};return i&&(l.Tooltip=i),l}function HC(){}function zC(e,r,t){var n=e.l+r,a=Xm(e),s=e.read_shift(1),i=[a];if(i[2]=s,t.cellFormula){var c=KA(e,n-e.l,t);i[1]=c}else e.l=n;return i}function GC(e,r,t){var n=e.l+r,a=fs(e),s=[a];if(t.cellFormula){var i=QA(e,n-e.l,t);s[1]=i,e.l=n}else e.l=n;return s}var YC=["left","right","top","bottom","header","footer"];function qC(e){var r={};return YC.forEach(function(t){r[t]=xr(e)}),r}function XC(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function KC(){}function JC(){}function QC(e,r,t,n,a,s,i){if(!e)return e;var c=r||{};n||(n={"!id":{}});var l=c.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,x,p,m,g,v,y,b,S,I,k=[];c.biff=12,c["!row"]=0;var E=0,T=!1,w=[],F={},P=c.supbooks||a.supbooks||[[]];if(P.sharedf=F,P.arrayf=w,P.SheetNames=a.SheetNames||a.Sheets.map(function(ye){return ye.name}),!c.supbooks&&(c.supbooks=P,a.Names))for(var A=0;A<a.Names.length;++A)P[0][A+1]=a.Names[A];var L=[],Y=[],q=!1;cc[16]={n:"BrtShortReal",f:Px};var Q;if(na(e,function(U,me,J){if(!h)switch(J){case 148:u=U;break;case 0:x=U,c.sheetRows&&c.sheetRows<=x.r&&(h=!0),S=cr(g=x.r),c["!row"]=x.r,(U.hidden||U.hpt||U.level!=null)&&(U.hpt&&(U.hpx=Yi(U.hpt)),Y[U.r]=U);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(p={t:U[2]},U[2]){case"n":p.v=U[1];break;case"s":b=Oi[U[1]],p.v=b.t,p.r=b.r;break;case"b":p.v=!!U[1];break;case"e":p.v=U[1],c.cellText!==!1&&(p.w=hs[p.v]);break;case"str":p.t="s",p.v=U[1];break;case"is":p.t="s",p.v=U[1].t;break}if((m=i.CellXf[U[0].iStyleRef])&&Fx(p,m.numFmtId,null,c,s,i),v=U[0].c==-1?v+1:U[0].c,c.dense?(l[g]||(l[g]=[]),l[g][v]=p):l[qt(v)+S]=p,c.cellFormula){for(T=!1,E=0;E<w.length;++E){var D=w[E];x.r>=D[0].s.r&&x.r<=D[0].e.r&&v>=D[0].s.c&&v<=D[0].e.c&&(p.F=lt(D[0]),T=!0)}!T&&U.length>3&&(p.f=U[3])}if(d.s.r>x.r&&(d.s.r=x.r),d.s.c>v&&(d.s.c=v),d.e.r<x.r&&(d.e.r=x.r),d.e.c<v&&(d.e.c=v),c.cellDates&&m&&p.t=="n"&&ni(rt[m.numFmtId])){var B=Ua(p.v);B&&(p.t="d",p.v=new Date(B.y,B.m-1,B.d,B.H,B.M,B.S,B.u))}Q&&(Q.type=="XLDAPR"&&(p.D=!0),Q=void 0);break;case 1:case 12:if(!c.sheetStubs||f)break;p={t:"z",v:void 0},v=U[0].c==-1?v+1:U[0].c,c.dense?(l[g]||(l[g]=[]),l[g][v]=p):l[qt(v)+S]=p,d.s.r>x.r&&(d.s.r=x.r),d.s.c>v&&(d.s.c=v),d.e.r<x.r&&(d.e.r=x.r),d.e.c<v&&(d.e.c=v),Q&&(Q.type=="XLDAPR"&&(p.D=!0),Q=void 0);break;case 176:k.push(U);break;case 49:Q=((c.xlmeta||{}).Cell||[])[U-1];break;case 494:var V=n["!id"][U.relId];for(V?(U.Target=V.Target,U.loc&&(U.Target+="#"+U.loc),U.Rel=V):U.relId==""&&(U.Target="#"+U.loc),g=U.rfx.s.r;g<=U.rfx.e.r;++g)for(v=U.rfx.s.c;v<=U.rfx.e.c;++v)c.dense?(l[g]||(l[g]=[]),l[g][v]||(l[g][v]={t:"z",v:void 0}),l[g][v].l=U):(y=Qe({c:v,r:g}),l[y]||(l[y]={t:"z",v:void 0}),l[y].l=U);break;case 426:if(!c.cellFormula)break;w.push(U),I=c.dense?l[g][v]:l[qt(v)+S],I.f=hr(U[1],d,{r:x.r,c:v},P,c),I.F=lt(U[0]);break;case 427:if(!c.cellFormula)break;F[Qe(U[0].s)]=U[1],I=c.dense?l[g][v]:l[qt(v)+S],I.f=hr(U[1],d,{r:x.r,c:v},P,c);break;case 60:if(!c.cellStyles)break;for(;U.e>=U.s;)L[U.e--]={width:U.w/256,hidden:!!(U.flags&1),level:U.level},q||(q=!0,td(U.w/256)),Xs(L[U.e+1]);break;case 161:l["!autofilter"]={ref:lt(U)};break;case 476:l["!margins"]=U;break;case 147:a.Sheets[t]||(a.Sheets[t]={}),U.name&&(a.Sheets[t].CodeName=U.name),(U.above||U.left)&&(l["!outline"]={above:U.above,left:U.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),U.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!me.T){if(!f||c.WTF)throw new Error("Unexpected record 0x"+J.toString(16))}}},c),delete c.supbooks,delete c["!row"],!l["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(l["!ref"]=lt(u||d)),c.sheetRows&&l["!ref"]){var K=Pt(l["!ref"]);c.sheetRows<=+K.e.r&&(K.e.r=c.sheetRows-1,K.e.r>d.e.r&&(K.e.r=d.e.r),K.e.r<K.s.r&&(K.s.r=K.e.r),K.e.c>d.e.c&&(K.e.c=d.e.c),K.e.c<K.s.c&&(K.s.c=K.e.c),l["!fullref"]=l["!ref"],l["!ref"]=lt(K))}return k.length>0&&(l["!merges"]=k),L.length>0&&(l["!cols"]=L),Y.length>0&&(l["!rows"]=Y),l}function ZC(e){var r=[],t=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var i=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(r[+i[1]]=t?+i[2]:i[2])});var a=dt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[r,a,n]}function e_(e,r,t,n,a,s){var i=s||{"!type":"chart"};if(!e)return s;var c=0,l=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=ZC(f);d.s.r=d.s.c=0,d.e.c=c,u=qt(c),h[0].forEach(function(x,p){i[u+cr(p)]={t:"n",v:x,z:h[1]},l=p}),d.e.r<l&&(d.e.r=l),++c}),c>0&&(i["!ref"]=lt(d)),i}function t_(e,r,t,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i,c=e.match(Ix);return c&&nd(c[0],s,a,t),(i=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=i[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function r_(e,r){e.l+=10;var t=yr(e);return{name:t}}function n_(e,r,t,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=!1;return na(e,function(l,u,d){switch(d){case 550:s["!rel"]=l;break;case 651:a.Sheets[t]||(a.Sheets[t]={}),l.name&&(a.Sheets[t].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!i||r.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},r),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var Ox=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],a_=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],s_=[],i_=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function L0(e,r){for(var t=0;t!=e.length;++t)for(var n=e[t],a=0;a!=r.length;++a){var s=r[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=bt(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function B0(e,r){for(var t=0;t!=r.length;++t){var n=r[t];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=bt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function jx(e){B0(e.WBProps,Ox),B0(e.CalcPr,i_),L0(e.WBView,a_),L0(e.Sheets,s_),Bs.date1904=bt(e.WBProps.date1904)}var o_="][*?/\\".split("");function c_(e,r){if(e.length>31){if(r)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var t=!0;return o_.forEach(function(n){if(e.indexOf(n)!=-1){if(!r)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");t=!1}}),t}var l_=/<\w+:workbook/;function u_(e,r){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},i=0;if(e.replace(wr,function(l,u){var d=Ke(l);switch(Vn(d[0])){case"<?xml":break;case"<workbook":l.match(l_)&&(a="xmlns"+l.match(/<(\w+):/)[1]),t.xmlns=d[a];break;case"</workbook>":break;case"<fileVersion":delete d[0],t.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Ox.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":t.WBProps[f[0]]=bt(d[f[0]]);break;case"int":t.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:t.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(t.WBProps.CodeName=xt(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],t.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=dt(xt(d.name)),delete d[0],t.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=xt(d.name),d.comment&&(s.Comment=d.comment),d.localSheetId&&(s.Sheet=+d.localSheetId),bt(d.hidden||"0")&&(s.Hidden=!0),i=u+l.length;break;case"</definedName>":s.Ref=dt(xt(e.slice(i,u))),t.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete d[0],t.CalcPr=d;break;case"<calcPr/>":delete d[0],t.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&r.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return l}),_2.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return jx(t),t}function d_(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=zl(e),t.name=yr(e),t}function f_(e,r){var t={},n=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var a=r>8?yr(e):"";return a.length>0&&(t.CodeName=a),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function h_(e,r){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=r-8,t}function p_(e,r,t){var n=e.l+r;e.l+=4,e.l+=1;var a=e.read_shift(4),s=G2(e),i=JA(e,0,t),c=Ku(e);e.l=n;var l={Name:s,Ptg:i};return a<268435455&&(l.Sheet=a),c&&(l.Comment=c),l}function m_(e,r){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;r||(r={}),r.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],cc[16]={n:"BrtFRTArchID$",f:h_},na(e,function(l,u,d){switch(d){case 156:i.SheetNames.push(l.name),t.Sheets.push(l);break;case 153:t.WBProps=l;break;case 39:l.Sheet!=null&&(r.SID=l.Sheet),l.Ref=hr(l.Ptg,null,null,i,r),delete r.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([d,l]):i[0]=[d,l],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(l),i.XTI=i.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(d),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!u.T){if(!a||r.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},r),jx(t),t.Names=s,t.supbooks=i,t}function x_(e,r,t){return r.slice(-4)===".bin"?m_(e,t):u_(e,t)}function g_(e,r,t,n,a,s,i,c){return r.slice(-4)===".bin"?QC(e,n,t,a,s,i,c):dC(e,n,t,a,s,i,c)}function v_(e,r,t,n,a,s,i,c){return r.slice(-4)===".bin"?n_(e,n,t,a,s):t_(e,n,t,a,s)}function y_(e,r,t,n,a,s,i,c){return r.slice(-4)===".bin"?Ck():_k()}function b_(e,r,t,n,a,s,i,c){return r.slice(-4)===".bin"?kk():Ak()}function w_(e,r,t,n){return r.slice(-4)===".bin"?VT(e,t,n):NT(e,t,n)}function S_(e,r,t){return bx(e,t)}function E_(e,r,t){return r.slice(-4)===".bin"?aT(e,t):rT(e,t)}function T_(e,r,t){return r.slice(-4)===".bin"?Sk(e,t):gk(e,t)}function k_(e,r,t){return r.slice(-4)===".bin"?pk(e):fk(e)}function A_(e,r,t,n){return t.slice(-4)===".bin"?mk(e,r,t,n):void 0}function C_(e,r,t){return r.slice(-4)===".bin"?uk(e,r,t):dk(e,r,t)}var Rx=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Nx=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function cn(e,r){var t=e.split(/\s+/),n=[];if(r||(n[0]=t[0]),t.length===1)return n;var a=e.match(Rx),s,i,c,l;if(a)for(l=0;l!=a.length;++l)s=a[l].match(Nx),(i=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?c="xmlns"+s[1].slice(6):c=s[1].slice(i+1),n[c]=s[2].slice(1,s[2].length-1));return n}function __(e){var r=e.split(/\s+/),t={};if(r.length===1)return t;var n=e.match(Rx),a,s,i,c;if(n)for(c=0;c!=n.length;++c)a=n[c].match(Nx),(s=a[1].indexOf(":"))===-1?t[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?i="xmlns"+a[1].slice(6):i=a[1].slice(s+1),t[i]=a[2].slice(1,a[2].length-1));return t}var Ri;function D_(e,r){var t=Ri[e]||dt(e);return t==="General"?as(r):an(t,r)}function F_(e,r,t,n){var a=n;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=bt(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=nr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[dt(r)]=a}function I_(e,r,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||hs[e.v]:r==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Vi(e.v):e.w=as(e.v):e.w=D_(r||"General",e.v)}catch(s){if(t.WTF)throw s}try{var n=Ri[r]||r||"General";if(t.cellNF&&(e.z=n),t.cellDates&&e.t=="n"&&ni(n)){var a=Ua(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(t.WTF)throw s}}}function P_(e,r,t){if(t.cellStyles&&r.Interior){var n=r.Interior;n.Pattern&&(n.patternType=FT[n.Pattern]||n.Pattern)}e[r.ID]=r}function O_(e,r,t,n,a,s,i,c,l,u){var d="General",f=n.StyleID,h={};u=u||{};var x=[],p=0;for(f===void 0&&c&&(f=c.StyleID),f===void 0&&i&&(f=i.StyleID);s[f]!==void 0&&(s[f].nf&&(d=s[f].nf),s[f].Interior&&x.push(s[f].Interior),!!s[f].Parent);)f=s[f].Parent;switch(t.Type){case"Boolean":n.t="b",n.v=bt(e);break;case"String":n.t="s",n.r=o0(dt(e)),n.v=e.indexOf("<")>-1?dt(r||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(nr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=dt(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Qm[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&r==""?n.t="z":(n.t="s",n.v=o0(r||e));break}if(I_(n,d,u),u.cellFormula!==!1)if(n.Formula){var m=dt(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=Ls(m,a),delete n.Formula,n.ArrayRange=="RC"?n.F=Ls("RC:RC",a):n.ArrayRange&&(n.F=Ls(n.ArrayRange,a),l.push([Pt(n.F),n.F]))}else for(p=0;p<l.length;++p)a.r>=l[p][0].s.r&&a.r<=l[p][0].e.r&&a.c>=l[p][0].s.c&&a.c<=l[p][0].e.c&&(n.F=l[p][1]);u.cellStyles&&(x.forEach(function(g){!h.patternType&&g.patternType&&(h.patternType=g.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function j_(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function gl(e,r){var t=r||{};Em();var n=Si(zu(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(n=xt(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var i=or(t);return i.type="string",zi.to_workbook(n,i)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(pe){a.indexOf("<"+pe)>=0&&(s=!0)}),s)return W_(n,t);Ri={"General Number":"General","General Date":rt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":rt[15],"Short Date":rt[14],"Long Time":rt[19],"Medium Time":rt[18],"Short Time":rt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:rt[2],Standard:rt[4],Percent:rt[10],Scientific:rt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,l=[],u,d={},f=[],h=t.dense?[]:{},x="",p={},m={},g=cn('<Data ss:Type="String">'),v=0,y=0,b=0,S={s:{r:2e6,c:2e6},e:{r:0,c:0}},I={},k={},E="",T=0,w=[],F={},P={},A=0,L=[],Y=[],q={},Q=[],K,ye=!1,U=[],me=[],J={},D=0,B=0,V={Sheets:[],WBProps:{date1904:!1}},W={};Hi.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var Z="";c=Hi.exec(n);)switch(c[3]=(Z=c[3]).toLowerCase()){case"data":if(Z=="data"){if(c[1]==="/"){if((u=l.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&l.push([c[3],!0]);break}if(l[l.length-1][1])break;c[1]==="/"?O_(n.slice(v,c.index),E,g,l[l.length-1][0]=="comment"?q:p,{c:y,r:b},I,Q[y],m,U,t):(E="",g=cn(c[0]),v=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(Y.length>0&&(p.c=Y),(!t.sheetRows||t.sheetRows>b)&&p.v!==void 0&&(t.dense?(h[b]||(h[b]=[]),h[b][y]=p):h[qt(y)+cr(b)]=p),p.HRef&&(p.l={Target:dt(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(D=y+(parseInt(p.MergeAcross,10)|0),B=b+(parseInt(p.MergeDown,10)|0),w.push({s:{c:y,r:b},e:{c:D,r:B}})),!t.sheetStubs)p.MergeAcross?y=D+1:++y;else if(p.MergeAcross||p.MergeDown){for(var fe=y;fe<=D;++fe)for(var ne=b;ne<=B;++ne)(fe>y||ne>b)&&(t.dense?(h[ne]||(h[ne]=[]),h[ne][fe]={t:"z"}):h[qt(fe)+cr(ne)]={t:"z"});y=D+1}else++y;else p=__(c[0]),p.Index&&(y=+p.Index-1),y<S.s.c&&(S.s.c=y),y>S.e.c&&(S.e.c=y),c[0].slice(-2)==="/>"&&++y,Y=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(b<S.s.r&&(S.s.r=b),b>S.e.r&&(S.e.r=b),c[0].slice(-2)==="/>"&&(m=cn(c[0]),m.Index&&(b=+m.Index-1)),y=0,++b):(m=cn(c[0]),m.Index&&(b=+m.Index-1),J={},(m.AutoFitHeight=="0"||m.Height)&&(J.hpx=parseInt(m.Height,10),J.hpt=yx(J.hpx),me[b]=J),m.Hidden=="1"&&(J.hidden=!0,me[b]=J));break;case"worksheet":if(c[1]==="/"){if((u=l.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"));f.push(x),S.s.r<=S.e.r&&S.s.c<=S.e.c&&(h["!ref"]=lt(S),t.sheetRows&&t.sheetRows<=S.e.r&&(h["!fullref"]=h["!ref"],S.e.r=t.sheetRows-1,h["!ref"]=lt(S))),w.length&&(h["!merges"]=w),Q.length>0&&(h["!cols"]=Q),me.length>0&&(h["!rows"]=me),d[x]=h}else S={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=y=0,l.push([c[3],!1]),u=cn(c[0]),x=dt(u.Name),h=t.dense?[]:{},w=[],U=[],me=[],W={name:x,Hidden:0},V.Sheets.push(W);break;case"table":if(c[1]==="/"){if((u=l.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else{if(c[0].slice(-2)=="/>")break;l.push([c[3],!1]),Q=[],ye=!1}break;case"style":c[1]==="/"?P_(I,k,t):k=cn(c[0]);break;case"numberformat":k.nf=dt(cn(c[0]).Format||"General"),Ri[k.nf]&&(k.nf=Ri[k.nf]);for(var ee=0;ee!=392&&rt[ee]!=k.nf;++ee);if(ee==392){for(ee=57;ee!=392;++ee)if(rt[ee]==null){Va(k.nf,ee);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(K=cn(c[0]),K.Hidden&&(K.hidden=!0,delete K.Hidden),K.Width&&(K.wpx=parseInt(K.Width,10)),!ye&&K.wpx>10){ye=!0,Er=gx;for(var se=0;se<Q.length;++se)Q[se]&&Xs(Q[se])}ye&&Xs(K),Q[K.Index-1||Q.length]=K;for(var j=0;j<+K.Span;++j)Q[Q.length]=or(K);break;case"namedrange":if(c[1]==="/")break;V.Names||(V.Names=[]);var _=Ke(c[0]),ae={Name:_.Name,Ref:Ls(_.RefersTo.slice(1),{r:0,c:0})};V.Sheets.length>0&&(ae.Sheet=V.Sheets.length-1),V.Names.push(ae);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?E+=n.slice(T,c.index):T=c.index+c[0].length;break;case"interior":if(!t.cellStyles)break;k.Interior=cn(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?gS(F,Z,n.slice(A,c.index)):A=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((u=l.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else l.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((u=l.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"));j_(q),Y.push(q)}else l.push([c[3],!1]),u=cn(c[0]),q={a:u.Author};break;case"autofilter":if(c[1]==="/"){if((u=l.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var oe=cn(c[0]);h["!autofilter"]={ref:Ls(oe.Range).replace(/\$/g,"")},l.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((u=l.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&l.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((u=l.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&l.push([c[3],!0]);break;case"null":break;default:if(l.length==0&&c[3]=="document"||l.length==0&&c[3]=="uof")return z0(n,t);var Te=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Te=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Te=!1}break;case"excelworkbook":switch(c[3]){case"date1904":V.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Te=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:Te=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(n.slice(A,c.index)){case"SheetHidden":W.Hidden=1;break;case"SheetVeryHidden":W.Hidden=2;break}else A=c.index+c[0].length;break;case"header":h["!margins"]||ji(h["!margins"]={},"xlml"),isNaN(+Ke(c[0]).Margin)||(h["!margins"].header=+Ke(c[0]).Margin);break;case"footer":h["!margins"]||ji(h["!margins"]={},"xlml"),isNaN(+Ke(c[0]).Margin)||(h["!margins"].footer=+Ke(c[0]).Margin);break;case"pagemargins":var ce=Ke(c[0]);h["!margins"]||ji(h["!margins"]={},"xlml"),isNaN(+ce.Top)||(h["!margins"].top=+ce.Top),isNaN(+ce.Left)||(h["!margins"].left=+ce.Left),isNaN(+ce.Right)||(h["!margins"].right=+ce.Right),isNaN(+ce.Bottom)||(h["!margins"].bottom=+ce.Bottom);break;case"displayrighttoleft":V.Views||(V.Views=[]),V.Views[0]||(V.Views[0]={}),V.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Te=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Te=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Te=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Te=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Te=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Te=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Te=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Te=!1}break;case"smarttags":break;default:Te=!1;break}if(Te||c[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?F_(P,Z,L,n.slice(A,c.index)):(L=c,A=c.index+c[0].length);break}if(t.WTF)throw"Unrecognized tag: "+c[3]+"|"+l.join("|")}var be={};return!t.bookSheets&&!t.bookProps&&(be.Sheets=d),be.SheetNames=f,be.Workbook=V,be.SSF=or(rt),be.Props=F,be.Custprops=P,be}function Xl(e,r){switch(id(r=r||{}),r.type||"base64"){case"base64":return gl(Kr(e),r);case"binary":case"buffer":case"file":return gl(e,r);case"array":return gl(us(e),r)}}function R_(e){var r={},t=e.content;if(t.l=28,r.AnsiUserType=t.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=X2(t),t.length-t.l<=4)return r;var n=t.read_shift(4);if(n==0||n>40||(t.l-=4,r.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(n=t.read_shift(4),n!==1907505652)||(r.UnicodeClipboardFormat=K2(t),n=t.read_shift(4),n==0||n>40))return r;t.l-=4,r.Reserved2=t.read_shift(0,"lpwstr")}var N_=[60,1084,2066,2165,2175];function M_(e,r,t,n,a){var s=n,i=[],c=t.slice(t.l,t.l+s);if(a&&a.enc&&a.enc.insitu&&c.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(c)}i.push(c),t.l+=s;for(var l=Xn(t,t.l),u=Kl[l],d=0;u!=null&&N_.indexOf(l)>-1;)s=Xn(t,t.l+2),d=t.l+4,l==2066?d+=4:(l==2165||l==2175)&&(d+=12),c=t.slice(d,t.l+4+s),i.push(c),t.l+=4+s,u=Kl[l=Xn(t,t.l)];var f=da(i);sr(f,0);var h=0;f.lens=[];for(var x=0;x<i.length;++x)f.lens.push(h),h+=i[x].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return r.f(f,f.length,a)}function Cn(e,r,t){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,r.cellNF&&(e.z=rt[n])}catch(s){if(r.WTF)throw s}if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||hs[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Vi(e.v):e.w=as(e.v):e.w=an(n,e.v,{date1904:!!t,dateNF:r&&r.dateNF})}catch(s){if(r.WTF)throw s}if(r.cellDates&&n&&e.t=="n"&&ni(rt[n]||String(n))){var a=Ua(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function Io(e,r,t){return{v:e,ixfe:r,t}}function L_(e,r){var t={opts:{}},n={},a=r.dense?[]:{},s={},i={},c=null,l=[],u="",d={},f,h="",x,p,m,g,v={},y=[],b,S,I=[],k=[],E={Sheets:[],WBProps:{date1904:!1},Views:[{}]},T={},w=function(Pe){return Pe<8?Wa[Pe]:Pe<64&&k[Pe-8]||Wa[Pe]},F=function(Pe,Ve,Ye){var et=Ve.XF.data;if(!(!et||!et.patternType||!Ye||!Ye.cellStyles)){Ve.s={},Ve.s.patternType=et.patternType;var ut;(ut=Gi(w(et.icvFore)))&&(Ve.s.fgColor={rgb:ut}),(ut=Gi(w(et.icvBack)))&&(Ve.s.bgColor={rgb:ut})}},P=function(Pe,Ve,Ye){if(!(J>1)&&!(Ye.sheetRows&&Pe.r>=Ye.sheetRows)){if(Ye.cellStyles&&Ve.XF&&Ve.XF.data&&F(Pe,Ve,Ye),delete Ve.ixfe,delete Ve.XF,f=Pe,h=Qe(Pe),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),Pe.r<i.s.r&&(i.s.r=Pe.r),Pe.c<i.s.c&&(i.s.c=Pe.c),Pe.r+1>i.e.r&&(i.e.r=Pe.r+1),Pe.c+1>i.e.c&&(i.e.c=Pe.c+1),Ye.cellFormula&&Ve.f){for(var et=0;et<y.length;++et)if(!(y[et][0].s.c>Pe.c||y[et][0].s.r>Pe.r)&&!(y[et][0].e.c<Pe.c||y[et][0].e.r<Pe.r)){Ve.F=lt(y[et][0]),(y[et][0].s.c!=Pe.c||y[et][0].s.r!=Pe.r)&&delete Ve.f,Ve.f&&(Ve.f=""+hr(y[et][1],i,Pe,U,A));break}}Ye.dense?(a[Pe.r]||(a[Pe.r]=[]),a[Pe.r][Pe.c]=Ve):a[h]=Ve}},A={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(A.password=r.password);var L,Y=[],q=[],Q=[],K=[],ye=!1,U=[];U.SheetNames=A.snames,U.sharedf=A.sharedf,U.arrayf=A.arrayf,U.names=[],U.XTI=[];var me=0,J=0,D=0,B=[],V=[],W;A.codepage=1200,vn(1200);for(var Z=!1;e.l<e.length-1;){var fe=e.l,ne=e.read_shift(2);if(ne===0&&me===10)break;var ee=e.l===e.length?0:e.read_shift(2),se=Kl[ne];if(se&&se.f){if(r.bookSheets&&me===133&&ne!==133)break;if(me=ne,se.r===2||se.r==12){var j=e.read_shift(2);if(ee-=2,!A.enc&&j!==ne&&((j&255)<<8|j>>8)!==ne)throw new Error("rt mismatch: "+j+"!="+ne);se.r==12&&(e.l+=10,ee-=10)}var _={};if(ne===10?_=se.f(e,ee,A):_=M_(ne,se,e,ee,A),J==0&&[9,521,1033,2057].indexOf(me)===-1)continue;switch(ne){case 34:t.opts.Date1904=E.WBProps.date1904=_;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(A.enc||(e.l=0),A.enc=_,!r.password)throw new Error("File is password-protected");if(_.valid==null)throw new Error("Encryption scheme unsupported");if(!_.valid)throw new Error("Password is incorrect");break;case 92:A.lastuser=_;break;case 66:var ae=Number(_);switch(ae){case 21010:ae=1200;break;case 32768:ae=1e4;break;case 32769:ae=1252;break}vn(A.codepage=ae),Z=!0;break;case 317:A.rrtabid=_;break;case 25:A.winlocked=_;break;case 439:t.opts.RefreshAll=_;break;case 12:t.opts.CalcCount=_;break;case 16:t.opts.CalcDelta=_;break;case 17:t.opts.CalcIter=_;break;case 13:t.opts.CalcMode=_;break;case 14:t.opts.CalcPrecision=_;break;case 95:t.opts.CalcSaveRecalc=_;break;case 15:A.CalcRefMode=_;break;case 2211:t.opts.FullCalc=_;break;case 129:_.fDialog&&(a["!type"]="dialog"),_.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),_.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:I.push(_);break;case 430:U.push([_]),U[U.length-1].XTI=[];break;case 35:case 547:U[U.length-1].push(_);break;case 24:case 536:W={Name:_.Name,Ref:hr(_.rgce,i,null,U,A)},_.itab>0&&(W.Sheet=_.itab-1),U.names.push(W),U[0]||(U[0]=[],U[0].XTI=[]),U[U.length-1].push(_),_.Name=="_xlnm._FilterDatabase"&&_.itab>0&&_.rgce&&_.rgce[0]&&_.rgce[0][0]&&_.rgce[0][0][0]=="PtgArea3d"&&(V[_.itab-1]={ref:lt(_.rgce[0][0][1][2])});break;case 22:A.ExternCount=_;break;case 23:U.length==0&&(U[0]=[],U[0].XTI=[]),U[U.length-1].XTI=U[U.length-1].XTI.concat(_),U.XTI=U.XTI.concat(_);break;case 2196:if(A.biff<8)break;W!=null&&(W.Comment=_[1]);break;case 18:a["!protect"]=_;break;case 19:_!==0&&A.WTF&&console.error("Password verifier: "+_);break;case 133:s[_.pos]=_,A.snames.push(_.name);break;case 10:{if(--J)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,a["!ref"]=lt(i),r.sheetRows&&r.sheetRows<=i.e.r){var oe=i.e.r;i.e.r=r.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=lt(i),i.e.r=oe}i.e.r++,i.e.c++}Y.length>0&&(a["!merges"]=Y),q.length>0&&(a["!objects"]=q),Q.length>0&&(a["!cols"]=Q),K.length>0&&(a["!rows"]=K),E.Sheets.push(T)}u===""?d=a:n[u]=a,a=r.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(A.biff===8&&(A.biff={9:2,521:3,1033:4}[ne]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[_.BIFFVer]||8),A.biffguess=_.BIFFVer==0,_.BIFFVer==0&&_.dt==4096&&(A.biff=5,Z=!0,vn(A.codepage=28591)),A.biff==8&&_.BIFFVer==0&&_.dt==16&&(A.biff=2),J++)break;if(a=r.dense?[]:{},A.biff<8&&!Z&&(Z=!0,vn(A.codepage=r.codepage||1252)),A.biff<5||_.BIFFVer==0&&_.dt==4096){u===""&&(u="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var Te={pos:e.l-ee,name:u};s[Te.pos]=Te,A.snames.push(u)}else u=(s[fe]||{name:""}).name;_.dt==32&&(a["!type"]="chart"),_.dt==64&&(a["!type"]="macro"),Y=[],q=[],A.arrayf=y=[],Q=[],K=[],ye=!1,T={Hidden:(s[fe]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(r.dense?(a[_.r]||[])[_.c]:a[Qe({c:_.c,r:_.r})])&&++_.c,b={ixfe:_.ixfe,XF:I[_.ixfe]||{},v:_.val,t:"n"},D>0&&(b.z=B[b.ixfe>>8&63]),Cn(b,r,t.opts.Date1904),P({c:_.c,r:_.r},b,r);break;case 5:case 517:b={ixfe:_.ixfe,XF:I[_.ixfe],v:_.val,t:_.t},D>0&&(b.z=B[b.ixfe>>8&63]),Cn(b,r,t.opts.Date1904),P({c:_.c,r:_.r},b,r);break;case 638:b={ixfe:_.ixfe,XF:I[_.ixfe],v:_.rknum,t:"n"},D>0&&(b.z=B[b.ixfe>>8&63]),Cn(b,r,t.opts.Date1904),P({c:_.c,r:_.r},b,r);break;case 189:for(var ce=_.c;ce<=_.C;++ce){var be=_.rkrec[ce-_.c][0];b={ixfe:be,XF:I[be],v:_.rkrec[ce-_.c][1],t:"n"},D>0&&(b.z=B[b.ixfe>>8&63]),Cn(b,r,t.opts.Date1904),P({c:ce,r:_.r},b,r)}break;case 6:case 518:case 1030:{if(_.val=="String"){c=_;break}if(b=Io(_.val,_.cell.ixfe,_.tt),b.XF=I[b.ixfe],r.cellFormula){var pe=_.formula;if(pe&&pe[0]&&pe[0][0]&&pe[0][0][0]=="PtgExp"){var Ce=pe[0][0][1][0],Oe=pe[0][0][1][1],He=Qe({r:Ce,c:Oe});v[He]?b.f=""+hr(_.formula,i,_.cell,U,A):b.F=((r.dense?(a[Ce]||[])[Oe]:a[He])||{}).F}else b.f=""+hr(_.formula,i,_.cell,U,A)}D>0&&(b.z=B[b.ixfe>>8&63]),Cn(b,r,t.opts.Date1904),P(_.cell,b,r),c=_}break;case 7:case 519:if(c)c.val=_,b=Io(_,c.cell.ixfe,"s"),b.XF=I[b.ixfe],r.cellFormula&&(b.f=""+hr(c.formula,i,c.cell,U,A)),D>0&&(b.z=B[b.ixfe>>8&63]),Cn(b,r,t.opts.Date1904),P(c.cell,b,r),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(_);var N=Qe(_[0].s);if(x=r.dense?(a[_[0].s.r]||[])[_[0].s.c]:a[N],r.cellFormula&&x){if(!c||!N||!x)break;x.f=""+hr(_[1],i,_[0],U,A),x.F=lt(_[0])}}break;case 1212:{if(!r.cellFormula)break;if(h){if(!c)break;v[Qe(c.cell)]=_[0],x=r.dense?(a[c.cell.r]||[])[c.cell.c]:a[Qe(c.cell)],(x||{}).f=""+hr(_[0],i,f,U,A)}}break;case 253:b=Io(l[_.isst].t,_.ixfe,"s"),l[_.isst].h&&(b.h=l[_.isst].h),b.XF=I[b.ixfe],D>0&&(b.z=B[b.ixfe>>8&63]),Cn(b,r,t.opts.Date1904),P({c:_.c,r:_.r},b,r);break;case 513:r.sheetStubs&&(b={ixfe:_.ixfe,XF:I[_.ixfe],t:"z"},D>0&&(b.z=B[b.ixfe>>8&63]),Cn(b,r,t.opts.Date1904),P({c:_.c,r:_.r},b,r));break;case 190:if(r.sheetStubs)for(var ie=_.c;ie<=_.C;++ie){var le=_.ixfe[ie-_.c];b={ixfe:le,XF:I[le],t:"z"},D>0&&(b.z=B[b.ixfe>>8&63]),Cn(b,r,t.opts.Date1904),P({c:ie,r:_.r},b,r)}break;case 214:case 516:case 4:b=Io(_.val,_.ixfe,"s"),b.XF=I[b.ixfe],D>0&&(b.z=B[b.ixfe>>8&63]),Cn(b,r,t.opts.Date1904),P({c:_.c,r:_.r},b,r);break;case 0:case 512:J===1&&(i=_);break;case 252:l=_;break;case 1054:if(A.biff==4){B[D++]=_[1];for(var we=0;we<D+163&&rt[we]!=_[1];++we);we>=163&&Va(_[1],D+163)}else Va(_[1],_[0]);break;case 30:{B[D++]=_;for(var Ae=0;Ae<D+163&&rt[Ae]!=_;++Ae);Ae>=163&&Va(_,D+163)}break;case 229:Y=Y.concat(_);break;case 93:q[_.cmo[0]]=A.lastobj=_;break;case 438:A.lastobj.TxO=_;break;case 127:A.lastobj.ImData=_;break;case 440:for(g=_[0].s.r;g<=_[0].e.r;++g)for(m=_[0].s.c;m<=_[0].e.c;++m)x=r.dense?(a[g]||[])[m]:a[Qe({c:m,r:g})],x&&(x.l=_[1]);break;case 2048:for(g=_[0].s.r;g<=_[0].e.r;++g)for(m=_[0].s.c;m<=_[0].e.c;++m)x=r.dense?(a[g]||[])[m]:a[Qe({c:m,r:g})],x&&x.l&&(x.l.Tooltip=_[1]);break;case 28:{if(A.biff<=5&&A.biff>=2)break;x=r.dense?(a[_[0].r]||[])[_[0].c]:a[Qe(_[0])];var Le=q[_[2]];x||(r.dense?(a[_[0].r]||(a[_[0].r]=[]),x=a[_[0].r][_[0].c]={t:"z"}):x=a[Qe(_[0])]={t:"z"},i.e.r=Math.max(i.e.r,_[0].r),i.s.r=Math.min(i.s.r,_[0].r),i.e.c=Math.max(i.e.c,_[0].c),i.s.c=Math.min(i.s.c,_[0].c)),x.c||(x.c=[]),p={a:_[1],t:Le.TxO.t},x.c.push(p)}break;case 2173:ik(I[_.ixfe],_.ext);break;case 125:{if(!A.cellStyles)break;for(;_.e>=_.s;)Q[_.e--]={width:_.w/256,level:_.level||0,hidden:!!(_.flags&1)},ye||(ye=!0,td(_.w/256)),Xs(Q[_.e+1])}break;case 520:{var Ue={};_.level!=null&&(K[_.r]=Ue,Ue.level=_.level),_.hidden&&(K[_.r]=Ue,Ue.hidden=!0),_.hpt&&(K[_.r]=Ue,Ue.hpt=_.hpt,Ue.hpx=Yi(_.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||ji(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ne]]=_;break;case 161:a["!margins"]||ji(a["!margins"]={}),a["!margins"].header=_.header,a["!margins"].footer=_.footer;break;case 574:_.RTL&&(E.Views[0].RTL=!0);break;case 146:k=_;break;case 2198:L=_;break;case 140:S=_;break;case 442:u?T.CodeName=_||T.name:E.WBProps.CodeName=_||"ThisWorkbook";break}}else se||console.error("Missing Info for XLS Record 0x"+ne.toString(16)),e.l+=ee}return t.SheetNames=Bn(s).sort(function(Fe,Pe){return Number(Fe)-Number(Pe)}).map(function(Fe){return s[Fe].name}),r.bookSheets||(t.Sheets=n),!t.SheetNames.length&&d["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=d)):t.Preamble=d,t.Sheets&&V.forEach(function(Fe,Pe){t.Sheets[t.SheetNames[Pe]]["!autofilter"]=Fe}),t.Strings=l,t.SSF=or(rt),A.enc&&(t.Encryption=A.enc),L&&(t.Themes=L),t.Metadata={},S!==void 0&&(t.Metadata.Country=S),U.names.length>0&&(E.Names=U.names),t.Workbook=E,t}var $0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function B_(e,r,t){var n=ct.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=E0(n,rS,$0.DSI);for(var s in a)r[s]=a[s]}catch(u){if(t.WTF)throw u}var i=ct.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var c=E0(i,nS,$0.SI);for(var l in c)r[l]==null&&(r[l]=c[l])}catch(u){if(t.WTF)throw u}r.HeadingPairs&&r.TitlesOfParts&&(ex(r.HeadingPairs,r.TitlesOfParts,r,t),delete r.HeadingPairs,delete r.TitlesOfParts)}function Mx(e,r){r||(r={}),id(r),dm(),r.codepage&&Lu(r.codepage);var t,n;if(e.FullPaths){if(ct.find(e,"/encryption"))throw new Error("File is password-protected");t=ct.find(e,"!CompObj"),n=ct.find(e,"/Workbook")||ct.find(e,"/Book")}else{switch(r.type){case"base64":e=gn(Kr(e));break;case"binary":e=gn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}sr(e,0),n={content:e}}var a,s;if(t&&R_(t),r.bookProps&&!r.bookSheets)a={};else{var i=ot?"buffer":"array";if(n&&n.content)a=L_(n.content,r);else if((s=ct.find(e,"PerfectOffice_MAIN"))&&s.content)a=Pi.to_workbook(s.content,(r.type=i,r));else if((s=ct.find(e,"NativeContent_MAIN"))&&s.content)a=Pi.to_workbook(s.content,(r.type=i,r));else throw(s=ct.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&e.FullPaths&&ct.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=Tk(e))}var c={};return e.FullPaths&&B_(e,c,r),a.Props=a.Custprops=c,r.bookFiles&&(a.cfb=e),a}var cc={0:{f:bC},1:{f:TC},2:{f:OC},3:{f:_C},4:{f:AC},5:{f:PC},6:{f:NC},7:{f:FC},8:{f:UC},9:{f:$C},10:{f:LC},11:{f:BC},12:{f:kC},13:{f:jC},14:{f:DC},15:{f:CC},16:{f:Px},17:{f:MC},18:{f:IC},19:{f:Xu},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:p_},40:{},42:{},43:{f:LT},44:{f:MT},45:{f:BT},46:{f:UT},47:{f:$T},48:{},49:{f:V2},50:{},51:{f:ck},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:fx},62:{f:RC},63:{f:hk},64:{f:KC},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:br,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:XC},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:EC},148:{f:wC,p:16},151:{f:HC},152:{},153:{f:f_},154:{},155:{},156:{f:d_},157:{},158:{},159:{T:1,f:nT},160:{T:-1},161:{T:1,f:fs},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:VC},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:ok},336:{T:-1},337:{f:lk,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:zl},357:{},358:{},359:{},360:{T:1},361:{},362:{f:dx},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:zC},427:{f:GC},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:qC},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:SC},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:WC},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:zl},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:wk},633:{T:1},634:{T:-1},635:{T:1,f:bk},636:{T:-1},637:{f:H2},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:r_},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:JC},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Kl={6:{f:ml},10:{f:ia},12:{f:Vt},13:{f:Vt},14:{f:Nt},15:{f:Nt},16:{f:xr},17:{f:Nt},18:{f:Nt},19:{f:Vt},20:{f:C0},21:{f:C0},23:{f:dx},24:{f:D0},25:{f:Nt},26:{},27:{},28:{f:vE},29:{},34:{f:Nt},35:{f:_0},38:{f:xr},39:{f:xr},40:{f:xr},41:{f:xr},42:{f:Nt},43:{f:Nt},47:{f:ST},49:{f:ZS},51:{f:Vt},60:{},61:{f:KS},64:{f:Nt},65:{f:QS},66:{f:Vt},77:{},80:{},81:{},82:{},85:{f:Vt},89:{},90:{},91:{},92:{f:VS},93:{f:bE},94:{},95:{f:Nt},96:{},97:{},99:{f:Nt},125:{f:fx},128:{f:lE},129:{f:WS},130:{f:Vt},131:{f:Nt},132:{f:Nt},133:{f:HS},134:{},140:{f:AE},141:{f:Vt},144:{},146:{f:_E},151:{},152:{},153:{},154:{},155:{},156:{f:Vt},157:{},158:{},160:{f:OE},161:{f:FE},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:sE},190:{f:iE},193:{f:ia},197:{},198:{},199:{},200:{},201:{},202:{f:Nt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Vt},220:{},221:{f:Nt},222:{},224:{f:cE},225:{f:US},226:{f:ia},227:{},229:{f:yE},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:zS},253:{f:eE},255:{f:GS},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:sx},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Nt},353:{f:ia},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:dE},431:{f:Nt},432:{},433:{},434:{},437:{},438:{f:EE},439:{f:Nt},440:{f:TE},441:{},442:{f:lo},443:{},444:{f:Vt},445:{},446:{},448:{f:ia},449:{f:XS,r:2},450:{f:ia},512:{f:k0},513:{f:PE},515:{f:uE},516:{f:tE},517:{f:A0},519:{f:jE},520:{f:YS},523:{},545:{f:F0},549:{f:T0},566:{},574:{f:JS},638:{f:aE},659:{},1048:{},1054:{f:rE},1084:{},1212:{f:mE},2048:{f:kE},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:_o},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ia},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:DE,r:12},2173:{f:sk,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Nt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:pE,r:12},2197:{},2198:{f:ZT,r:12},2199:{},2200:{},2201:{},2202:{f:xE,r:12},2203:{f:ia},2204:{},2205:{},2206:{},2207:{},2211:{f:qS},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Vt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:IE},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:CE},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:k0},1:{},2:{f:LE},3:{f:ME},4:{f:NE},5:{f:A0},7:{f:BE},8:{},9:{f:_o},11:{},22:{f:Vt},30:{f:nE},31:{},32:{},33:{f:F0},36:{},37:{f:T0},50:{f:$E},62:{},52:{},67:{},68:{f:Vt},69:{},86:{},126:{},127:{f:RE},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:UE},223:{},234:{},354:{},421:{},518:{f:ml},521:{f:_o},536:{f:D0},547:{f:_0},561:{},579:{},1030:{f:ml},1033:{f:_o},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ln(e,r,t,n){var a=r;if(!isNaN(a)){var s=n||(t||[]).length||0,i=e.next(4);i.write_shift(2,a),i.write_shift(2,s),s>0&&Gm(t)&&e.push(t)}}function U0(e,r){var t=r||{},n=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),i=a.index,c=s&&s.index||e.length,l=d2(e.slice(i,c),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,f=0,h=0,x={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(i=0;i<l.length;++i){var m=l[i].trim(),g=m.slice(0,3).toLowerCase();if(g=="<tr"){if(++u,t.sheetRows&&t.sheetRows<=u){--u;break}d=0;continue}if(!(g!="<td"&&g!="<th")){var v=m.split(/<\/t[dh]>/i);for(c=0;c<v.length;++c){var y=v[c].trim();if(y.match(/<t[dh]/i)){for(var b=y,S=0;b.charAt(0)=="<"&&(S=b.indexOf(">"))>-1;)b=b.slice(S+1);for(var I=0;I<p.length;++I){var k=p[I];k.s.c==d&&k.s.r<u&&u<=k.e.r&&(d=k.e.c+1,I=-1)}var E=Ke(y.slice(0,y.indexOf(">")));h=E.colspan?+E.colspan:1,((f=+E.rowspan)>1||h>1)&&p.push({s:{r:u,c:d},e:{r:u+(f||1)-1,c:d+h-1}});var T=E.t||E["data-t"]||"";if(!b.length){d+=h;continue}if(b=Om(b),x.s.r>u&&(x.s.r=u),x.e.r<u&&(x.e.r=u),x.s.c>d&&(x.s.c=d),x.e.c<d&&(x.e.c=d),!b.length){d+=h;continue}var w={t:"s",v:b};t.raw||!b.trim().length||T=="s"||(b==="TRUE"?w={t:"b",v:!0}:b==="FALSE"?w={t:"b",v:!1}:isNaN(Sn(b))?isNaN(qs(b).getDate())||(w={t:"d",v:nr(b)},t.cellDates||(w={t:"n",v:Cr(w.v)}),w.z=t.dateNF||rt[14]):w={t:"n",v:Sn(b)}),t.dense?(n[u]||(n[u]=[]),n[u][d]=w):n[Qe({r:u,c:d})]=w,d+=h}}}}return n["!ref"]=lt(x),p.length&&(n["!merges"]=p),n}function $_(e,r,t,n){for(var a=e["!merges"]||[],s=[],i=r.s.c;i<=r.e.c;++i){for(var c=0,l=0,u=0;u<a.length;++u)if(!(a[u].s.r>t||a[u].s.c>i)&&!(a[u].e.r<t||a[u].e.c<i)){if(a[u].s.r<t||a[u].s.c<i){c=-1;break}c=a[u].e.r-a[u].s.r+1,l=a[u].e.c-a[u].s.c+1;break}if(!(c<0)){var d=Qe({r:t,c:i}),f=n.dense?(e[t]||[])[i]:e[d],h=f&&f.v!=null&&(f.h||Hu(f.w||(Zn(f),f.w)||""))||"",x={};c>1&&(x.rowspan=c),l>1&&(x.colspan=l),n.editable?h='<span contenteditable="true">'+h+"</span>":f&&(x["data-t"]=f&&f.t||"z",f.v!=null&&(x["data-v"]=f.v),f.z!=null&&(x["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),x.id=(n.id||"sjs")+"-"+d,s.push(A2("td",h,x))}}var p="<tr>";return p+s.join("")+"</tr>"}var U_='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',V_="</body></html>";function W_(e,r){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return ba(U0(t[0],r),r);var n=cd();return t.forEach(function(a,s){ld(n,U0(a,r),"Sheet"+(s+1))}),n}function H_(e,r,t){var n=[];return n.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function z_(e,r){var t=r||{},n=t.header!=null?t.header:U_,a=t.footer!=null?t.footer:V_,s=[n],i=ai(e["!ref"]);t.dense=Array.isArray(e),s.push(H_(e,i,t));for(var c=i.s.r;c<=i.e.r;++c)s.push($_(e,i,c,t));return s.push("</table>"+a),s.join("")}function Lx(e,r,t){var n=t||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var i=typeof n.origin=="string"?Tr(n.origin):n.origin;a=i.r,s=i.c}var c=r.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,c.length),u={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var d=ai(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),a==-1&&(u.e.r=a=d.e.r+1)}var f=[],h=0,x=e["!rows"]||(e["!rows"]=[]),p=0,m=0,g=0,v=0,y=0,b=0;for(e["!cols"]||(e["!cols"]=[]);p<c.length&&m<l;++p){var S=c[p];if(V0(S)){if(n.display)continue;x[m]={hidden:!0}}var I=S.children;for(g=v=0;g<I.length;++g){var k=I[g];if(!(n.display&&V0(k))){var E=k.hasAttribute("data-v")?k.getAttribute("data-v"):k.hasAttribute("v")?k.getAttribute("v"):Om(k.innerHTML),T=k.getAttribute("data-z")||k.getAttribute("z");for(h=0;h<f.length;++h){var w=f[h];w.s.c==v+s&&w.s.r<m+a&&m+a<=w.e.r&&(v=w.e.c+1-s,h=-1)}b=+k.getAttribute("colspan")||1,((y=+k.getAttribute("rowspan")||1)>1||b>1)&&f.push({s:{r:m+a,c:v+s},e:{r:m+a+(y||1)-1,c:v+s+(b||1)-1}});var F={t:"s",v:E},P=k.getAttribute("data-t")||k.getAttribute("t")||"";E!=null&&(E.length==0?F.t=P||"z":n.raw||E.trim().length==0||P=="s"||(E==="TRUE"?F={t:"b",v:!0}:E==="FALSE"?F={t:"b",v:!1}:isNaN(Sn(E))?isNaN(qs(E).getDate())||(F={t:"d",v:nr(E)},n.cellDates||(F={t:"n",v:Cr(F.v)}),F.z=n.dateNF||rt[14]):F={t:"n",v:Sn(E)})),F.z===void 0&&T!=null&&(F.z=T);var A="",L=k.getElementsByTagName("A");if(L&&L.length)for(var Y=0;Y<L.length&&!(L[Y].hasAttribute("href")&&(A=L[Y].getAttribute("href"),A.charAt(0)!="#"));++Y);A&&A.charAt(0)!="#"&&(F.l={Target:A}),n.dense?(e[m+a]||(e[m+a]=[]),e[m+a][v+s]=F):e[Qe({c:v+s,r:m+a})]=F,u.e.c<v+s&&(u.e.c=v+s),v+=b}}++m}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,m-1+a),e["!ref"]=lt(u),m>=l&&(e["!fullref"]=lt((u.e.r=c.length-p+m-1+a,u))),e}function Bx(e,r){var t=r||{},n=t.dense?[]:{};return Lx(n,e,r)}function G_(e,r){return ba(Bx(e,r),r)}function V0(e){var r="",t=Y_(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function Y_(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function q_(e){var r=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=dt(r.replace(/<[^>]*>/g,""));return[t]}var W0={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function $x(e,r){var t=r||{},n=zu(e),a=[],s,i,c={name:""},l="",u=0,d,f,h={},x=[],p=t.dense?[]:{},m,g,v={value:""},y="",b=0,S=[],I=-1,k=-1,E={s:{r:1e6,c:1e7},e:{r:0,c:0}},T=0,w={},F=[],P={},A=0,L=0,Y=[],q=1,Q=1,K=[],ye={Names:[]},U={},me=["",""],J=[],D={},B="",V=0,W=!1,Z=!1,fe=0;for(Hi.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=Hi.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"å·¥ä½œè¡¨":m[1]==="/"?(E.e.c>=E.s.c&&E.e.r>=E.s.r?p["!ref"]=lt(E):p["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=E.e.r&&(p["!fullref"]=p["!ref"],E.e.r=t.sheetRows-1,p["!ref"]=lt(E)),F.length&&(p["!merges"]=F),Y.length&&(p["!rows"]=Y),d.name=d.åç§°||d.name,typeof JSON<"u"&&JSON.stringify(d),x.push(d.name),h[d.name]=p,Z=!1):m[0].charAt(m[0].length-2)!=="/"&&(d=Ke(m[0],!1),I=k=-1,E.s.r=E.s.c=1e7,E.e.r=E.e.c=0,p=t.dense?[]:{},F=[],Y=[],Z=!0);break;case"table-row-group":m[1]==="/"?--T:++T;break;case"table-row":case"è¡Œ":if(m[1]==="/"){I+=q,q=1;break}if(f=Ke(m[0],!1),f.è¡Œå·?I=f.è¡Œå·-1:I==-1&&(I=0),q=+f["number-rows-repeated"]||1,q<10)for(fe=0;fe<q;++fe)T>0&&(Y[I+fe]={level:T});k=-1;break;case"covered-table-cell":m[1]!=="/"&&++k,t.sheetStubs&&(t.dense?(p[I]||(p[I]=[]),p[I][k]={t:"z"}):p[Qe({r:I,c:k})]={t:"z"}),y="",S=[];break;case"table-cell":case"æ•°æ®":if(m[0].charAt(m[0].length-2)==="/")++k,v=Ke(m[0],!1),Q=parseInt(v["number-columns-repeated"]||"1",10),g={t:"z",v:null},v.formula&&t.cellFormula!=!1&&(g.f=M0(dt(v.formula))),(v.æ•°æ®ç±»åž‹||v["value-type"])=="string"&&(g.t="s",g.v=dt(v["string-value"]||""),t.dense?(p[I]||(p[I]=[]),p[I][k]=g):p[Qe({r:I,c:k})]=g),k+=Q-1;else if(m[1]!=="/"){++k,y="",b=0,S=[],Q=1;var ne=q?I+q-1:I;if(k>E.e.c&&(E.e.c=k),k<E.s.c&&(E.s.c=k),I<E.s.r&&(E.s.r=I),ne>E.e.r&&(E.e.r=ne),v=Ke(m[0],!1),J=[],D={},g={t:v.æ•°æ®ç±»åž‹||v["value-type"],v:null},t.cellFormula)if(v.formula&&(v.formula=dt(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(A=parseInt(v["number-matrix-rows-spanned"],10)||0,L=parseInt(v["number-matrix-columns-spanned"],10)||0,P={s:{r:I,c:k},e:{r:I+A-1,c:k+L-1}},g.F=lt(P),K.push([P,g.F])),v.formula)g.f=M0(v.formula);else for(fe=0;fe<K.length;++fe)I>=K[fe][0].s.r&&I<=K[fe][0].e.r&&k>=K[fe][0].s.c&&k<=K[fe][0].e.c&&(g.F=K[fe][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(A=parseInt(v["number-rows-spanned"],10)||0,L=parseInt(v["number-columns-spanned"],10)||0,P={s:{r:I,c:k},e:{r:I+A-1,c:k+L-1}},F.push(P)),v["number-columns-repeated"]&&(Q=parseInt(v["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=bt(v["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(v.value);break;case"percentage":g.t="n",g.v=parseFloat(v.value);break;case"currency":g.t="n",g.v=parseFloat(v.value);break;case"date":g.t="d",g.v=nr(v["date-value"]),t.cellDates||(g.t="n",g.v=Cr(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=c2(v["time-value"])/86400,t.cellDates&&(g.t="d",g.v=Ic(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(v.æ•°æ®æ•°å€¼);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",v["string-value"]!=null&&(y=dt(v["string-value"]),S=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(W=!1,g.t==="s"&&(g.v=y||"",S.length&&(g.R=S),W=b==0),U.Target&&(g.l=U),J.length>0&&(g.c=J,J=[]),y&&t.cellText!==!1&&(g.w=y),W&&(g.t="z",delete g.v),(!W||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=I))for(var ee=0;ee<q;++ee){if(Q=parseInt(v["number-columns-repeated"]||"1",10),t.dense)for(p[I+ee]||(p[I+ee]=[]),p[I+ee][k]=ee==0?g:or(g);--Q>0;)p[I+ee][k+Q]=or(g);else for(p[Qe({r:I+ee,c:k})]=g;--Q>0;)p[Qe({r:I+ee,c:k+Q})]=or(g);E.e.c<=k&&(E.e.c=k)}Q=parseInt(v["number-columns-repeated"]||"1",10),k+=Q-1,Q=0,g={},y="",S=[]}U={};break;case"document":case"document-content":case"ç”µå­è¡¨æ ¼æ–‡æ¡£":case"spreadsheet":case"ä¸»ä½“":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((s=a.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((s=a.pop())[0]!==m[3])throw"Bad state: "+s;D.t=y,S.length&&(D.R=S),D.a=B,J.push(D)}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!1]);B="",V=0,y="",b=0,S=[];break;case"creator":m[1]==="/"?B=n.slice(V,m.index):V=m.index+m[0].length;break;case"meta":case"å…ƒæ•°æ®":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((s=a.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!1]);y="",b=0,S=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(w[c.name]=l,(s=a.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&(l="",c=Ke(m[0],!1),a.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":i=Ke(m[0],!1),l+=W0[m[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":i=Ke(m[0],!1),l+=W0[m[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(u,m.index);break}else u=m.index+m[0].length;break;case"named-range":i=Ke(m[0],!1),me=xl(i["cell-range-address"]);var se={Name:i.name,Ref:me[0]+"!"+me[1]};Z&&(se.Sheet=x.length),ye.Names.push(se);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"ç”µå­è¡¨æ ¼":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"æ–‡æœ¬ä¸²":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(m[1]==="/"&&(!v||!v["string-value"])){var j=q_(n.slice(b,m.index));y=(y.length>0?y+`
`:"")+j[0]}else Ke(m[0],!1),b=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{me=xl(Ke(m[0])["target-range-address"]),h[me[0]]["!autofilter"]={ref:me[1]}}catch{}break;case"date":break;case"object":break;case"title":case"æ ‡é¢˜":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(U=Ke(m[0],!1),!U.href)break;U.Target=dt(U.href),delete U.href,U.Target.charAt(0)=="#"&&U.Target.indexOf(".")>-1?(me=xl(U.Target.slice(1)),U.Target="#"+me[0]+"!"+me[1]):U.Target.match(/^\.\.[\\\/]/)&&(U.Target=U.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"è¡¨:":case"å­—:":break;default:if(t.WTF)throw new Error(m)}}var _={Sheets:h,SheetNames:x,Workbook:ye};return t.bookSheets&&delete _.Sheets,_}function H0(e,r){r=r||{},nn(e,"META-INF/manifest.xml")&&uS(Ut(e,"META-INF/manifest.xml"),r);var t=zr(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var n=$x(xt(t),r);return nn(e,"meta.xml")&&(n.Props=Zm(Ut(e,"meta.xml"))),n}function z0(e,r){return $x(e,r)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function ad(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Jl(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):xt(us(e))}function Ql(e){var r=e.reduce(function(a,s){return a+s.length},0),t=new Uint8Array(r),n=0;return e.forEach(function(a){t.set(a,n),n+=a.length}),t}function G0(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function X_(e,r){for(var t=(e[r+15]&127)<<7|e[r+14]>>1,n=e[r+14]&1,a=r+13;a>=r;--a)n=n*256+e[a];return(e[r+15]&128?-n:n)*Math.pow(10,t-6176)}function qi(e,r){var t=r?r[0]:0,n=e[t]&127;e:if(e[t++]>=128&&(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return r&&(r[0]=t),n}function Kt(e){var r=0,t=e[r]&127;e:if(e[r++]>=128){if(t|=(e[r]&127)<<7,e[r++]<128||(t|=(e[r]&127)<<14,e[r++]<128)||(t|=(e[r]&127)<<21,e[r++]<128))break e;t|=(e[r]&127)<<28}return t}function gr(e){for(var r=[],t=[0];t[0]<e.length;){var n=t[0],a=qi(e,t),s=a&7;a=Math.floor(a/8);var i=0,c;if(a==0)break;switch(s){case 0:{for(var l=t[0];e[t[0]++]>=128;);c=e.slice(l,t[0])}break;case 5:i=4,c=e.slice(t[0],t[0]+i),t[0]+=i;break;case 1:i=8,c=e.slice(t[0],t[0]+i),t[0]+=i;break;case 2:i=qi(e,t),c=e.slice(t[0],t[0]+i),t[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var u={data:c,type:s};r[a]==null?r[a]=[u]:r[a].push(u)}return r}function sd(e,r){return(e==null?void 0:e.map(function(t){return r(t.data)}))||[]}function K_(e){for(var r,t=[],n=[0];n[0]<e.length;){var a=qi(e,n),s=gr(e.slice(n[0],n[0]+a));n[0]+=a;var i={id:Kt(s[1][0].data),messages:[]};s[2].forEach(function(c){var l=gr(c.data),u=Kt(l[3][0].data);i.messages.push({meta:l,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(r=s[3])!=null&&r[0]&&(i.merge=Kt(s[3][0].data)>>>0>0),t.push(i)}return t}function J_(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],n=qi(r,t),a=[];t[0]<r.length;){var s=r[t[0]]&3;if(s==0){var i=r[t[0]++]>>2;if(i<60)++i;else{var c=i-59;i=r[t[0]],c>1&&(i|=r[t[0]+1]<<8),c>2&&(i|=r[t[0]+2]<<16),c>3&&(i|=r[t[0]+3]<<24),i>>>=0,i++,t[0]+=c}a.push(r.slice(t[0],t[0]+i)),t[0]+=i;continue}else{var l=0,u=0;if(s==1?(u=(r[t[0]]>>2&7)+4,l=(r[t[0]++]&224)<<3,l|=r[t[0]++]):(u=(r[t[0]++]>>2)+1,s==2?(l=r[t[0]]|r[t[0]+1]<<8,t[0]+=2):(l=(r[t[0]]|r[t[0]+1]<<8|r[t[0]+2]<<16|r[t[0]+3]<<24)>>>0,t[0]+=4)),a=[Ql(a)],l==0)throw new Error("Invalid offset 0");if(l>a[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(a.push(a[0].slice(-l)),u-=l;u>=a[a.length-1].length;)a.push(a[a.length-1]),u-=a[a.length-1].length;a.push(a[0].slice(-l,-l+u))}}var d=Ql(a);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function Q_(e){for(var r=[],t=0;t<e.length;){var n=e[t++],a=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,r.push(J_(n,e.slice(t,t+a))),t+=a}if(t!==e.length)throw new Error("data is not a valid framed stream!");return Ql(r)}function Z_(e,r,t,n){var a=ad(e),s=a.getUint32(4,!0),i=(n>1?12:8)+G0(s&(n>1?3470:398))*4,c=-1,l=-1,u=NaN,d=new Date(2001,0,1);s&512&&(c=a.getUint32(i,!0),i+=4),i+=G0(s&(n>1?12288:4096))*4,s&16&&(l=a.getUint32(i,!0),i+=4),s&32&&(u=a.getFloat64(i,!0),i+=8),s&64&&(d.setTime(d.getTime()+a.getFloat64(i,!0)*1e3),i+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:r[l]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(c>-1)f={t:"s",v:t[c]};else if(l>-1)f={t:"s",v:r[l]};else if(!isNaN(u))f={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function eD(e,r,t){var n=ad(e),a=n.getUint32(8,!0),s=12,i=-1,c=-1,l=NaN,u=NaN,d=new Date(2001,0,1);a&1&&(l=X_(e,s),s+=16),a&2&&(u=n.getFloat64(s,!0),s+=8),a&4&&(d.setTime(d.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(c=n.getUint32(s,!0),s+=4),a&16&&(i=n.getUint32(s,!0),s+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:l};break;case 3:f={t:"s",v:r[c]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(i>-1)f={t:"s",v:t[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return f}function tD(e,r,t){switch(e[0]){case 0:case 1:case 2:case 3:return Z_(e,r,t,e[0]);case 5:return eD(e,r,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function pa(e){var r=gr(e);return qi(r[1][0].data)}function Y0(e,r){var t=gr(r.data),n=Kt(t[1][0].data),a=t[3],s=[];return(a||[]).forEach(function(i){var c=gr(i.data),l=Kt(c[1][0].data)>>>0;switch(n){case 1:s[l]=Jl(c[3][0].data);break;case 8:{var u=e[pa(c[9][0].data)][0],d=gr(u.data),f=e[pa(d[1][0].data)][0],h=Kt(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var x=gr(f.data);s[l]=x[3].map(function(p){return Jl(p.data)}).join("")}break}}),s}function rD(e,r){var t,n,a,s,i,c,l,u,d,f,h,x,p,m,g=gr(e),v=Kt(g[1][0].data)>>>0,y=Kt(g[2][0].data)>>>0,b=((n=(t=g[8])==null?void 0:t[0])==null?void 0:n.data)&&Kt(g[8][0].data)>0||!1,S,I;if((s=(a=g[7])==null?void 0:a[0])!=null&&s.data&&r!=0)S=(c=(i=g[7])==null?void 0:i[0])==null?void 0:c.data,I=(u=(l=g[6])==null?void 0:l[0])==null?void 0:u.data;else if((f=(d=g[4])==null?void 0:d[0])!=null&&f.data&&r!=1)S=(x=(h=g[4])==null?void 0:h[0])==null?void 0:x.data,I=(m=(p=g[3])==null?void 0:p[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var k=b?4:1,E=ad(S),T=[],w=0;w<S.length/2;++w){var F=E.getUint16(w*2,!0);F<65535&&T.push([w,F])}if(T.length!=y)throw"Expected ".concat(y," cells, found ").concat(T.length);var P=[];for(w=0;w<T.length-1;++w)P[T[w][0]]=I.subarray(T[w][1]*k,T[w+1][1]*k);return T.length>=1&&(P[T[T.length-1][0]]=I.subarray(T[T.length-1][1]*k)),{R:v,cells:P}}function nD(e,r){var t,n=gr(r.data),a=(t=n==null?void 0:n[7])!=null&&t[0]?Kt(n[7][0].data)>>>0>0?1:0:-1,s=sd(n[5],function(i){return rD(i,a)});return{nrows:Kt(n[4][0].data)>>>0,data:s.reduce(function(i,c){return i[c.R]||(i[c.R]=[]),c.cells.forEach(function(l,u){if(i[c.R][u])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(u));i[c.R][u]=l}),i},[])}}function aD(e,r,t){var n,a=gr(r.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Kt(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(Kt(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));t["!ref"]=lt(s);var i=gr(a[4][0].data),c=Y0(e,e[pa(i[4][0].data)][0]),l=(n=i[17])!=null&&n[0]?Y0(e,e[pa(i[17][0].data)][0]):[],u=gr(i[3][0].data),d=0;u[1].forEach(function(f){var h=gr(f.data),x=e[pa(h[2][0].data)][0],p=Kt(x.meta[1][0].data);if(p!=6002)throw new Error("6001 unexpected reference to ".concat(p));var m=nD(e,x);m.data.forEach(function(g,v){g.forEach(function(y,b){var S=Qe({r:d+v,c:b}),I=tD(y,c,l);I&&(t[S]=I)})}),d+=m.nrows})}function sD(e,r){var t=gr(r.data),n={"!ref":"A1"},a=e[pa(t[2][0].data)],s=Kt(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return aD(e,a[0],n),n}function iD(e,r){var t,n=gr(r.data),a={name:(t=n[1])!=null&&t[0]?Jl(n[1][0].data):"",sheets:[]},s=sd(n[2],pa);return s.forEach(function(i){e[i].forEach(function(c){var l=Kt(c.meta[1][0].data);l==6e3&&a.sheets.push(sD(e,c))})}),a}function oD(e,r){var t=cd(),n=gr(r.data),a=sd(n[1],pa);if(a.forEach(function(s){e[s].forEach(function(i){var c=Kt(i.meta[1][0].data);if(c==2){var l=iD(e,i);l.sheets.forEach(function(u,d){ld(t,u,d==0?l.name:l.name+"_"+d,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function vl(e){var r,t,n,a,s={},i=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var u;try{u=Q_(l.content)}catch(f){return console.log("?? "+l.content.length+" "+(f.message||f))}var d;try{d=K_(u)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){s[f.id]=f.messages,i.push(f.id)})}}),!i.length)throw new Error("File has no messages");var c=((a=(n=(t=(r=s==null?void 0:s[1])==null?void 0:r[0])==null?void 0:t.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Kt(s[1][0].meta[1][0].data)==1&&s[1][0];if(c||i.forEach(function(l){s[l].forEach(function(u){var d=Kt(u.meta[1][0].data)>>>0;if(d==1)if(!c)c=u;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return oD(s,c)}function cD(e){return function(t){for(var n=0;n!=e.length;++n){var a=e[n];t[a[0]]===void 0&&(t[a[0]]=a[1]),a[2]==="n"&&(t[a[0]]=Number(t[a[0]]))}}}function id(e){cD([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function lD(e){return Os.WS.indexOf(e)>-1?"sheet":e==Os.CS?"chart":e==Os.DS?"dialog":e==Os.MS?"macro":e&&e.length?e:"sheet"}function uD(e,r){if(!e)return 0;try{e=r.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,lD(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function dD(e,r,t,n,a,s,i,c,l,u,d,f){try{s[n]=Fi(zr(e,t,!0),r);var h=Ut(e,r),x;switch(c){case"sheet":x=g_(h,r,a,l,s[n],u,d,f);break;case"chart":if(x=v_(h,r,a,l,s[n],u,d,f),!x||!x["!drawel"])break;var p=Ti(x["!drawel"].Target,r),m=Gl(p),g=xk(zr(e,p,!0),Fi(zr(e,m,!0),p)),v=Ti(g,p),y=Gl(v);x=e_(zr(e,v,!0),v,l,Fi(zr(e,y,!0),v),u,x);break;case"macro":x=y_(h,r,a,l,s[n],u,d,f);break;case"dialog":x=b_(h,r,a,l,s[n],u,d,f);break;default:throw new Error("Unrecognized sheet type "+c)}i[n]=x;var b=[];s&&s[n]&&Bn(s[n]).forEach(function(S){var I="";if(s[n][S].Type==Os.CMNT){I=Ti(s[n][S].Target,r);var k=T_(Ut(e,I,!0),I,l);if(!k||!k.length)return;P0(x,k,!1)}s[n][S].Type==Os.TCMNT&&(I=Ti(s[n][S].Target,r),b=b.concat(vk(Ut(e,I,!0),l)))}),b&&b.length&&P0(x,b,!0,l.people||[])}catch(S){if(l.WTF)throw S}}function Jr(e){return e.charAt(0)=="/"?e.slice(1):e}function fD(e,r){if(Em(),r=r||{},id(r),nn(e,"META-INF/manifest.xml")||nn(e,"objectdata.xml"))return H0(e,r);if(nn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof vl<"u"){if(e.FileIndex)return vl(e);var t=ct.utils.cfb_new();return s0(e).forEach(function(Y){h2(t,Y,Dm(e,Y))}),vl(t)}throw new Error("Unsupported NUMBERS file")}if(!nn(e,"[Content_Types].xml"))throw nn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):nn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=s0(e),a=cS(zr(e,"[Content_Types].xml")),s=!1,i,c;if(a.workbooks.length===0&&(c="xl/workbook.xml",Ut(e,c,!0)&&a.workbooks.push(c)),a.workbooks.length===0){if(c="xl/workbook.bin",!Ut(e,c,!0))throw new Error("Could not find workbook");a.workbooks.push(c),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},u={};if(!r.bookSheets&&!r.bookProps){if(Oi=[],a.sst)try{Oi=E_(Ut(e,Jr(a.sst)),a.sst,r)}catch(Y){if(r.WTF)throw Y}r.cellStyles&&a.themes.length&&(l=S_(zr(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],r)),a.style&&(u=w_(Ut(e,Jr(a.style)),a.style,l,r))}a.links.map(function(Y){try{var q=Fi(zr(e,Gl(Jr(Y))),Y);return A_(Ut(e,Jr(Y)),q,Y,r)}catch{}});var d=x_(Ut(e,Jr(a.workbooks[0])),a.workbooks[0],r),f={},h="";a.coreprops.length&&(h=Ut(e,Jr(a.coreprops[0]),!0),h&&(f=Zm(h)),a.extprops.length!==0&&(h=Ut(e,Jr(a.extprops[0]),!0),h&&hS(h,f,r)));var x={};(!r.bookSheets||r.bookProps)&&a.custprops.length!==0&&(h=zr(e,Jr(a.custprops[0]),!0),h&&(x=mS(h,r)));var p={};if((r.bookSheets||r.bookProps)&&(d.Sheets?i=d.Sheets.map(function(q){return q.name}):f.Worksheets&&f.SheetNames.length>0&&(i=f.SheetNames),r.bookProps&&(p.Props=f,p.Custprops=x),r.bookSheets&&typeof i<"u"&&(p.SheetNames=i),r.bookSheets?p.SheetNames:r.bookProps))return p;i={};var m={};r.bookDeps&&a.calcchain&&(m=k_(Ut(e,Jr(a.calcchain)),a.calcchain));var g=0,v={},y,b;{var S=d.Sheets;f.Worksheets=S.length,f.SheetNames=[];for(var I=0;I!=S.length;++I)f.SheetNames[I]=S[I].name}var k=s?"bin":"xml",E=a.workbooks[0].lastIndexOf("/"),T=(a.workbooks[0].slice(0,E+1)+"_rels/"+a.workbooks[0].slice(E+1)+".rels").replace(/^\//,"");nn(e,T)||(T="xl/_rels/workbook."+k+".rels");var w=Fi(zr(e,T,!0),T.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(r.xlmeta=C_(Ut(e,Jr(a.metadata[0])),a.metadata[0],r)),(a.people||[]).length>=1&&(r.people=yk(Ut(e,Jr(a.people[0])),r)),w&&(w=uD(w,d.Sheets));var F=Ut(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=f.Worksheets;++g){var P="sheet";if(w&&w[g]?(y="xl/"+w[g][1].replace(/[\/]?xl\//,""),nn(e,y)||(y=w[g][1]),nn(e,y)||(y=T.replace(/_rels\/.*$/,"")+w[g][1]),P=w[g][2]):(y="xl/worksheets/sheet"+(g+1-F)+"."+k,y=y.replace(/sheet0\./,"sheet.")),b=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(g!=r.sheets)continue e;break;case"string":if(f.SheetNames[g].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var A=!1,L=0;L!=r.sheets.length;++L)typeof r.sheets[L]=="number"&&r.sheets[L]==g&&(A=1),typeof r.sheets[L]=="string"&&r.sheets[L].toLowerCase()==f.SheetNames[g].toLowerCase()&&(A=1);if(!A)continue e}}dD(e,y,b,f.SheetNames[g],g,v,i,P,r,d,l,u)}return p={Directory:a,Workbook:d,Props:f,Custprops:x,Deps:m,Sheets:i,SheetNames:f.SheetNames,Strings:Oi,Styles:u,Themes:l,SSF:or(rt)},r&&r.bookFiles&&(e.files?(p.keys=n,p.files=e.files):(p.keys=[],p.files={},e.FullPaths.forEach(function(Y,q){Y=Y.replace(/^Root Entry[\/]/,""),p.keys.push(Y),p.files[Y]=e.FileIndex[q]}))),r&&r.bookVBA&&(a.vba.length>0?p.vbaraw=Ut(e,Jr(a.vba[0]),!0):a.defaults&&a.defaults.bin===Ek&&(p.vbaraw=Ut(e,"xl/vbaProject.bin",!0))),p}function hD(e,r){var t=r||{},n="Workbook",a=ct.find(e,n);try{if(n="/!DataSpaces/Version",a=ct.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(sT(a.content),n="/!DataSpaces/DataSpaceMap",a=ct.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=oT(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=ct.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=cT(a.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=ct.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);uT(a.content)}catch{}if(n="/EncryptionInfo",a=ct.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var c=dT(a.content);if(n="/EncryptedPackage",a=ct.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],a.content,t.password||"",t);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],a.content,t.password||"",t);throw new Error("File is password-protected")}function od(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=Kr(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function pD(e,r){return ct.find(e,"EncryptedPackage")?hD(e,r):Mx(e,r)}function mD(e,r){var t,n=e,a=r||{};return a.type||(a.type=ot&&Buffer.isBuffer(e)?"buffer":"base64"),t=Fm(n,a),fD(t,a)}function Ux(e,r){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return Xl(e.slice(t),r);default:break e}return zi.to_workbook(e,r)}function xD(e,r){var t="",n=od(e,r);switch(r.type){case"base64":t=Kr(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=ss(e);break;default:throw new Error("Unrecognized type "+r.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(t=xt(t)),r.type="binary",Ux(t,r)}function gD(e,r){var t=e;return r.type=="base64"&&(t=Kr(t)),t=ua.utils.decode(1200,t.slice(2),"str"),r.type="binary",Ux(t,r)}function vD(e){return e.match(/[^\x00-\x7F]/)?ki(e):e}function yl(e,r,t,n){return n?(t.type="string",zi.to_workbook(e,t)):zi.to_workbook(r,t)}function lc(e,r){dm();var t=r||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return lc(new Uint8Array(e),(t=or(t),t.type="array",t));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],s=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),Bs={},t.dateNF&&(Bs.dateNF=t.dateNF),t.type||(t.type=ot&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=ot?"buffer":"binary",n=i2(e),typeof Uint8Array<"u"&&!ot&&(t.type="array")),t.type=="string"&&(s=!0,t.type="binary",t.codepage=65001,n=vD(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),c=new Uint8Array(i);if(c.foo="bar",!c.foo)return t=or(t),t.type="array",lc(Bu(n),t)}switch((a=od(n,t))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return pD(ct.read(n,t),t);break;case 9:if(a[1]<=8)return Mx(n,t);break;case 60:return Xl(n,t);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return GE(n,t);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return HE.to_workbook(n,t);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?mD(n,t):yl(e,n,t,s);case 239:return a[3]===60?Xl(n,t):yl(e,n,t,s);case 255:if(a[1]===254)return gD(n,t);if(a[1]===0&&a[2]===2&&a[3]===0)return Pi.to_workbook(n,t);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Pi.to_workbook(n,t);break;case 3:case 131:case 139:case 140:return I0.to_workbook(n,t);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return ET.to_workbook(n,t);break;case 10:case 13:case 32:return xD(n,t);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return VE.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?I0.to_workbook(n,t):yl(e,n,t,s)}function yD(e,r,t,n,a,s,i,c){var l=cr(t),u=c.defval,d=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),f=!0,h=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:t,enumerable:!1})}catch{h.__rowNum__=t}else h.__rowNum__=t;if(!i||e[t])for(var x=r.s.c;x<=r.e.c;++x){var p=i?e[t][x]:e[n[x]+l];if(p===void 0||p.t===void 0){if(u===void 0)continue;s[x]!=null&&(h[s[x]]=u);continue}var m=p.v;switch(p.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(s[x]!=null){if(m==null)if(p.t=="e"&&m===null)h[s[x]]=null;else if(u!==void 0)h[s[x]]=u;else if(d&&m===null)h[s[x]]=null;else continue;else h[s[x]]=d&&(p.t!=="n"||p.t==="n"&&c.rawNumbers!==!1)?m:Zn(p,m,c);m!=null&&(f=!1)}}return{row:h,isempty:f}}function Zl(e,r){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},n=0,a=1,s=[],i=0,c="",l={s:{r:0,c:0},e:{r:0,c:0}},u=r||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":l=Pt(d);break;case"number":l=Pt(e["!ref"]),l.s.r=d;break;default:l=d}n>0&&(a=0);var f=cr(l.s.r),h=[],x=[],p=0,m=0,g=Array.isArray(e),v=l.s.r,y=0,b={};g&&!e[v]&&(e[v]=[]);var S=u.skipHidden&&e["!cols"]||[],I=u.skipHidden&&e["!rows"]||[];for(y=l.s.c;y<=l.e.c;++y)if(!(S[y]||{}).hidden)switch(h[y]=qt(y),t=g?e[v][y]:e[h[y]+f],n){case 1:s[y]=y-l.s.c;break;case 2:s[y]=h[y];break;case 3:s[y]=u.header[y-l.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),c=i=Zn(t,null,u),m=b[i]||0,!m)b[i]=1;else{do c=i+"_"+m++;while(b[c]);b[i]=m,b[c]=1}s[y]=c}for(v=l.s.r+a;v<=l.e.r;++v)if(!(I[v]||{}).hidden){var k=yD(e,l,v,h,n,s,g,u);(k.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(x[p++]=k.row)}return x.length=p,x}var q0=/"/g;function bD(e,r,t,n,a,s,i,c){for(var l=!0,u=[],d="",f=cr(t),h=r.s.c;h<=r.e.c;++h)if(n[h]){var x=c.dense?(e[t]||[])[h]:e[n[h]+f];if(x==null)d="";else if(x.v!=null){l=!1,d=""+(c.rawNumbers&&x.t=="n"?x.v:Zn(x,null,c));for(var p=0,m=0;p!==d.length;++p)if((m=d.charCodeAt(p))===a||m===s||m===34||c.forceQuotes){d='"'+d.replace(q0,'""')+'"';break}d=="ID"&&(d='"ID"')}else x.f!=null&&!x.F?(l=!1,d="="+x.f,d.indexOf(",")>=0&&(d='"'+d.replace(q0,'""')+'"')):d="";u.push(d)}return c.blankrows===!1&&l?null:u.join(i)}function Vx(e,r){var t=[],n=r??{};if(e==null||e["!ref"]==null)return"";var a=Pt(e["!ref"]),s=n.FS!==void 0?n.FS:",",i=s.charCodeAt(0),c=n.RS!==void 0?n.RS:`
`,l=c.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),d="",f=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],x=n.skipHidden&&e["!rows"]||[],p=a.s.c;p<=a.e.c;++p)(h[p]||{}).hidden||(f[p]=qt(p));for(var m=0,g=a.s.r;g<=a.e.r;++g)(x[g]||{}).hidden||(d=bD(e,a,g,f,i,l,s,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&t.push((m++?c:"")+d)));return delete n.dense,t.join("")}function wD(e,r){r||(r={}),r.FS="	",r.RS=`
`;var t=Vx(e,r);return t}function SD(e){var r="",t,n="";if(e==null||e["!ref"]==null)return[];var a=Pt(e["!ref"]),s="",i=[],c,l=[],u=Array.isArray(e);for(c=a.s.c;c<=a.e.c;++c)i[c]=qt(c);for(var d=a.s.r;d<=a.e.r;++d)for(s=cr(d),c=a.s.c;c<=a.e.c;++c)if(r=i[c]+s,t=u?(e[d]||[])[c]:e[r],n="",t!==void 0){if(t.F!=null){if(r=t.F,!t.f)continue;n=t.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(t.f!=null)n=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)n=""+t.v;else if(t.t=="b")n=t.v?"TRUE":"FALSE";else if(t.w!==void 0)n="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?n="'"+t.v:n=""+t.v}}l[l.length]=r+"="+n}return l}function Wx(e,r,t){var n=t||{},a=+!n.skipHeader,s=e||{},i=0,c=0;if(s&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?Tr(n.origin):n.origin;i=l.r,c=l.c}var u,d={s:{c:0,r:0},e:{c,r:i+r.length-1+a}};if(s["!ref"]){var f=Pt(s["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),i==-1&&(i=f.e.r+1,d.e.r=i+r.length-1+a)}else i==-1&&(i=0,d.e.r=r.length-1+a);var h=n.header||[],x=0;r.forEach(function(m,g){Bn(m).forEach(function(v){(x=h.indexOf(v))==-1&&(h[x=h.length]=v);var y=m[v],b="z",S="",I=Qe({c:c+x,r:i+g+a});u=Xi(s,I),y&&typeof y=="object"&&!(y instanceof Date)?s[I]=y:(typeof y=="number"?b="n":typeof y=="boolean"?b="b":typeof y=="string"?b="s":y instanceof Date?(b="d",n.cellDates||(b="n",y=Cr(y)),S=n.dateNF||rt[14]):y===null&&n.nullError&&(b="e",y=0),u?(u.t=b,u.v=y,delete u.w,delete u.R,S&&(u.z=S)):s[I]=u={t:b,v:y},S&&(u.z=S))})}),d.e.c=Math.max(d.e.c,c+h.length-1);var p=cr(i);if(a)for(x=0;x<h.length;++x)s[qt(x+c)+p]={t:"s",v:h[x]};return s["!ref"]=lt(d),s}function ED(e,r){return Wx(null,e,r)}function Xi(e,r,t){if(typeof r=="string"){if(Array.isArray(e)){var n=Tr(r);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?Xi(e,Qe(r)):Xi(e,Qe({r,c:t||0}))}function TD(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function cd(){return{SheetNames:[],Sheets:{}}}function ld(e,r,t,n){var a=1;if(!t)for(;a<=65535&&e.SheetNames.indexOf(t="Sheet"+a)!=-1;++a,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(t)>=0){var s=t.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var i=s&&s[1]||t;for(++a;a<=65535&&e.SheetNames.indexOf(t=i+a)!=-1;++a);}if(c_(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function kD(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=TD(e,r);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[n].Hidden=t}function AD(e,r){return e.z=r,e}function Hx(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}function CD(e,r,t){return Hx(e,"#"+r,t)}function _D(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})}function DD(e,r,t,n){for(var a=typeof r!="string"?r:Pt(r),s=typeof r=="string"?r:lt(r),i=a.s.r;i<=a.e.r;++i)for(var c=a.s.c;c<=a.e.c;++c){var l=Xi(e,i,c);l.t="n",l.F=s,delete l.v,i==a.s.r&&c==a.s.c&&(l.f=t,n&&(l.D=!0))}return e}var zx={encode_col:qt,encode_row:cr,encode_cell:Qe,encode_range:lt,decode_col:qu,decode_row:Yu,split_cell:U2,decode_cell:Tr,decode_range:ai,format_cell:Zn,sheet_add_aoa:qm,sheet_add_json:Wx,sheet_add_dom:Lx,aoa_to_sheet:si,json_to_sheet:ED,table_to_sheet:Bx,table_to_book:G_,sheet_to_csv:Vx,sheet_to_txt:wD,sheet_to_json:Zl,sheet_to_html:z_,sheet_to_formulae:SD,sheet_to_row_object_array:Zl,sheet_get_cell:Xi,book_new:cd,book_append_sheet:ld,book_set_sheet_visibility:kD,cell_set_number_format:AD,cell_set_hyperlink:Hx,cell_set_internal_link:CD,cell_add_comment:_D,sheet_set_array_formula:DD,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const FD=["studentId","name","email","grade","phoneNumber"],ID=`studentId,name,grade,section,email,phoneNumber,dateOfBirth,gender,address,parentName,parentEmail,parentPhone
S001,John Smith,9,A,john.smith@example.com,1234567890,2010-05-15,MALE,123 Main St,Robert Smith,robert.smith@example.com,9876543210
S002,Jane Doe,9,A,jane.doe@example.com,0987654321,2010-03-20,FEMALE,456 Oak Ave,Mary Doe,mary.doe@example.com,1234567890`,PD=({open:e,onClose:r,onSubmit:t,loading:n})=>{const[a,s]=C.useState(""),[i,c]=C.useState([]),[l,u]=C.useState([]),[d,f]=C.useState("initial"),[h,x]=C.useState(""),p=C.useRef(null),m=k=>{s(k.target.value),f("initial"),c([]),u([]),x("")},g=(k,E)=>{const T=[];return FD.forEach(w=>{k[w]||T.push({index:E,field:w,message:`Missing required field: ${w}`})}),k.email&&!/^\S+@\S+\.\S+$/.test(k.email)&&T.push({index:E,field:"email",message:"Invalid email format"}),T},v=()=>{try{const k=lm.parse(a,{header:!0,skipEmptyLines:!0});if(k.errors.length>0){u(k.errors.map((w,F)=>({index:F,field:"csv",message:w.message}))),f("error");return}const E=k.data,T=[];E.forEach((w,F)=>{const P=g(w,F);T.push(...P)}),T.length>0?(u(T),f("error")):(c(E),f("success"))}catch(k){console.error("Error parsing CSV:",k),u([{index:0,field:"csv",message:"Failed to parse CSV: "+(k instanceof Error?k.message:String(k))}]),f("error")}},y=async()=>{if(!(i.length===0||d!=="success"))try{await t(i),s(""),c([]),f("initial"),x("")}catch(k){console.error("Failed to submit students:",k)}},b=()=>{const k=new Blob([ID],{type:"text/csv;charset=utf-8;"}),E=document.createElement("a");E.href=URL.createObjectURL(k),E.setAttribute("download","student_upload_template.csv"),document.body.appendChild(E),E.click(),document.body.removeChild(E)},S=()=>{p.current&&p.current.click()},I=k=>{var w;const E=(w=k.target.files)==null?void 0:w[0];if(!E)return;x(E.name);const T=new FileReader;T.onload=F=>{var A;const P=(A=F.target)==null?void 0:A.result;try{if(E.name.endsWith(".xlsx")||E.name.endsWith(".xls")){const L=lc(P,{type:"binary"}),Y=L.SheetNames[0],q=L.Sheets[Y],Q=zx.sheet_to_csv(q);s(Q)}else if(E.name.endsWith(".csv"))s(P);else throw new Error("Unsupported file format. Please use CSV, XLSX, or XLS files.");f("initial"),c([]),u([])}catch(L){console.error("Error reading file:",L),u([{index:0,field:"file",message:"Failed to read file: "+(L instanceof Error?L.message:String(L))}]),f("error")}},E.name.endsWith(".csv")?T.readAsText(E):T.readAsBinaryString(E),k.target&&(k.target.value="")};return o.jsxs(kr,{open:e,onClose:r,maxWidth:"md",fullWidth:!0,children:[o.jsx(Xr,{children:"Bulk Student Upload"}),o.jsxs(Rr,{children:[o.jsxs(Se,{sx:{mb:2},children:[o.jsx(te,{variant:"body1",gutterBottom:!0,children:"Upload your CSV/Excel file or paste CSV data below to add multiple students at once."}),o.jsx(te,{variant:"body2",color:"text.secondary",children:"Required fields: Student ID, Name, Grade, Email, and Phone Number"})]}),o.jsxs(Se,{sx:{mb:2,display:"flex",gap:1},children:[o.jsx(at,{title:"Download sample CSV template",children:o.jsx(Me,{variant:"outlined",size:"small",onClick:b,startIcon:o.jsx(ju,{}),children:"Download Template"})}),o.jsx("input",{type:"file",accept:".csv,.xlsx,.xls",style:{display:"none"},ref:p,onChange:I}),o.jsx(at,{title:"Upload CSV or Excel file",children:o.jsx(Me,{variant:"contained",size:"small",onClick:S,startIcon:o.jsx(Nu,{}),color:"primary",children:"Upload File"})})]}),h&&o.jsxs(jr,{severity:"info",sx:{mb:2},children:["File loaded: ",h]}),o.jsx(ke,{label:"CSV Data",multiline:!0,rows:10,value:a,onChange:m,fullWidth:!0,variant:"outlined",placeholder:"studentId,name,grade,section,email,phoneNumber,dateOfBirth,gender,address,parentName,parentEmail,parentPhone",sx:{mb:2}}),o.jsx(Se,{sx:{mb:2},children:o.jsx(Me,{variant:"contained",color:"secondary",onClick:v,disabled:!a.trim()||n,children:"Parse Data"})}),d==="success"&&o.jsxs(jr,{severity:"success",sx:{mb:2},children:[o.jsx($i,{children:"Data Successfully Parsed"}),"Found ",i.length," valid student records ready to be imported."]}),d==="error"&&o.jsxs(jr,{severity:"error",sx:{mb:2},children:[o.jsx($i,{children:"Validation Errors"}),o.jsx(Se,{component:"ul",sx:{pl:2,mt:1},children:l.map((k,E)=>o.jsx("li",{children:`Row ${k.index+1}, ${k.field}: ${k.message}`},E))})]}),i.length>0&&o.jsxs(st,{variant:"outlined",sx:{p:2,mt:2,maxHeight:"200px",overflow:"auto"},children:[o.jsxs(te,{variant:"subtitle1",gutterBottom:!0,children:["Preview of Parsed Data (",i.length," students)"]}),o.jsx(vr,{sx:{mb:2}}),i.slice(0,5).map((k,E)=>o.jsx(Se,{sx:{mb:1,p:1,bgcolor:"background.paper"},children:o.jsxs(te,{variant:"body2",children:[o.jsx("strong",{children:"ID:"})," ",k.studentId,",",o.jsx("strong",{children:" Name:"})," ",k.name,",",o.jsx("strong",{children:" Grade:"})," ",k.grade,k.section?`-${k.section}`:"",",",o.jsx("strong",{children:" Email:"})," ",k.email]})},E)),i.length>5&&o.jsx(Yt,{label:`${i.length-5} more students`,size:"small",sx:{mt:1}})]})]}),o.jsxs(Nr,{children:[o.jsx(Me,{onClick:r,disabled:n,children:"Cancel"}),o.jsx(Me,{onClick:y,color:"primary",disabled:i.length===0||d!=="success"||n,startIcon:n?o.jsx(ta,{size:20}):o.jsx(Pu,{}),children:n?"Importing...":"Import Students"})]})]})},Gx=e=>new Date(e).toLocaleDateString(),OD=(e,r,t)=>({id:"actions",label:"Actions",format:(n,a)=>o.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e&&o.jsx(at,{title:"Edit",children:o.jsx(Ze,{size:"small",color:"primary",onClick:()=>e(a),children:o.jsx(no,{fontSize:"small"})})}),r&&o.jsx(at,{title:"Delete",children:o.jsx(Ze,{size:"small",color:"error",onClick:()=>r(a),children:o.jsx(ei,{fontSize:"small"})})}),t&&t(a)]})}),bn=({children:e,permission:r,permissions:t=[],requireAll:n=!1})=>{const{user:a}=kn();if(C.useEffect(()=>{r&&console.log(`ðŸ”’ Checking permission "${r}" for user role: "${(a==null?void 0:a.role)||"unknown"}"`,{hasPermission:a&&a.role?rr(a.role,r):!1}),t.length>0&&console.log(`ðŸ”’ Checking permissions [${t.join(", ")}] for user role: "${(a==null?void 0:a.role)||"unknown"}"`,{requireAll:n,hasPermissions:a&&a.role?n?Vf(a.role,t):Uf(a.role,t):!1})},[a,r,t,n]),!a)return console.warn("âš ï¸ Permission check failed: No user data available"),null;if(r){const s=a.role?rr(a.role,r):!1;if(console.log(`ðŸ”‘ Permission "${r}" check result: ${s?"granted âœ…":"denied âŒ"}`),!s)return null}if(t.length>0){const s=a.role?n?Vf(a.role,t):Uf(a.role,t):!1;if(console.log(`ðŸ”‘ Permissions [${t.join(", ")}] check result: ${s?"granted âœ…":"denied âŒ"}`),!s)return null}return o.jsx(o.Fragment,{children:e})},X0={getCommonEndpoints(e){return[{name:`Get all ${e} (api prefix)`,fn:()=>De.get(`/${e}`)},{name:`Get all ${e} (singular)`,fn:()=>De.get(`/${e.slice(0,-1)}`)},{name:"Check auth status",fn:()=>De.get("/auth/status")}]},async runApiTests(e){const r=[];for(const t of e)try{console.log(`ðŸ§ª Testing endpoint: ${t.name}`);const n=await t.fn();r.push({name:t.name,success:!0,status:"OK",data:n})}catch(n){r.push({name:t.name,success:!1,status:n.status||"Error",error:n.message||JSON.stringify(n)})}return r}},jD=({open:e,onClose:r,entityType:t,customEndpoints:n=[]})=>{const[a,s]=C.useState(!1),[i,c]=C.useState([]),l=async()=>{s(!0),c([]);const u=[...X0.getCommonEndpoints(t),...n],d=await X0.runApiTests(u);c(d),s(!1)};return o.jsxs(kr,{open:e,onClose:r,maxWidth:"md",fullWidth:!0,children:[o.jsx(Xr,{children:"API Endpoint Diagnostics"}),o.jsxs(Rr,{children:[o.jsx(te,{variant:"body2",gutterBottom:!0,children:"Testing different API endpoints to find which one works with your backend."}),a&&o.jsx(Se,{sx:{display:"flex",justifyContent:"center",my:4},children:o.jsx(ta,{})}),i.length>0&&o.jsx(Ga,{children:i.map((u,d)=>o.jsxs(Mn.Fragment,{children:[d>0&&o.jsx(vr,{}),o.jsx(Ya,{children:o.jsx(qa,{primary:`${u.name} - ${u.success?"âœ… Success":"âŒ Failed"} (${u.status})`,secondary:o.jsx(Se,{component:"pre",sx:{mt:1,p:1,bgcolor:"grey.100",borderRadius:1,fontSize:"0.75rem",overflow:"auto",maxHeight:200},children:u.success?JSON.stringify(u.data,null,2):u.error})})})]},d))})]}),o.jsxs(Nr,{children:[o.jsx(Me,{onClick:l,disabled:a,color:"primary",children:"Run API Tests"}),o.jsx(Me,{onClick:r,color:"secondary",children:"Close"})]})]})},RD=()=>{const[e,r]=C.useState(!1),[t,n]=C.useState(!1),[a,s]=C.useState(void 0),[i,c]=C.useState(!1),[l,u]=C.useState(null),[d,f]=C.useState(void 0),{showNotification:h}=sn(),{user:x}=kn(),[p,m]=C.useState(!1),[g,v]=C.useState(null),{data:y,loading:b,error:S,refresh:I}=Nn(()=>rn.getAllStudents(),{cacheKey:"students",onError:D=>{console.error("Error in useApi for students:",D),v(D)}}),{mutate:k,loading:E}=Pr(D=>rn.create(D),{onSuccess:()=>{h({type:"success",message:"Student created successfully"}),r(!1),I()},onError:D=>{var V,W;console.error("Error saving student:",D);const B=D;B.response&&(console.error("Server response:",B.response.data),console.error("Status code:",B.response.status)),h({type:"error",message:`Failed to create student: ${((W=(V=B.response)==null?void 0:V.data)==null?void 0:W.message)||(D==null?void 0:D.message)||"Unknown error"}`})}}),{mutate:T,loading:w}=Pr(D=>rn.update(D.id,D),{onSuccess:()=>{h({type:"success",message:"Student updated successfully"}),r(!1),s(void 0),I()}}),{mutate:F}=Pr(D=>rn.delete(D),{onSuccess:()=>{h({type:"success",message:"Student deleted successfully"}),I()}}),{mutate:P,loading:A}=Pr(D=>rn.createBulk(D),{onSuccess:D=>{h({type:"success",message:`${D.length} students created successfully`}),n(!1),I()},onError:D=>{console.error("Error creating students in bulk:",D),h({type:"error",message:`Failed to create students: ${D.message||"Unknown error"}`})}}),{mutate:L}=Pr(D=>rn.updateStatus(D.id,D.status),{onSuccess:D=>{h({type:"success",message:`Student status updated to ${D.status}`}),I()},onError:D=>{h({type:"error",message:`Failed to update student status: ${D.message}`})}}),Y=async(D,B)=>{try{D.id&&await L({id:D.id,status:B}),u(null)}catch(V){console.error("Error updating student status:",V)}},q=D=>{s(D),r(!0)},Q=async D=>{f(D),c(!0)},K=async()=>{if(d)try{await F(d.id),c(!1),f(void 0)}catch(D){console.error("Error deleting student:",D),h({type:"error",message:`Failed to delete student: ${(D==null?void 0:D.message)||"Unknown error"}`})}},ye=()=>{r(!1),s(void 0)},U=async D=>{var B,V;try{if(a)await T({...D,id:a.id});else{console.log("Creating new student with properly structured data:",D);try{await k(D)}catch(W){console.error("Standard API approach failed, trying with elevated permissions:",W);try{await rn.createWithElevatedPermissions(D),h({type:"success",message:"Student created successfully with admin permissions"}),r(!1),I()}catch(Z){throw console.error("Failed with elevated permissions too:",Z),Z}}}}catch(W){console.error("Error in handleSubmit:",W),h({type:"error",message:`Error: ${((V=(B=W.response)==null?void 0:B.data)==null?void 0:V.message)||(W==null?void 0:W.message)||"Unknown error occurred"}`})}},me=async D=>{try{await P(D)}catch(B){console.error("Standard API approach failed, trying with elevated permissions:",B);try{await rn.createBulkWithElevatedPermissions(D),h({type:"success",message:`${D.length} students created successfully with admin permissions`}),n(!1),I()}catch(V){throw console.error("Failed with elevated permissions too:",V),V}}},J=[{id:"studentId",label:"ID",sortable:!0},{id:"name",label:"Name",sortable:!0},{id:"grade",label:"Grade",sortable:!0},{id:"section",label:"Section",sortable:!0},{id:"dateOfBirth",label:"Date of Birth",sortable:!0,format:Gx},{id:"email",label:"Email",sortable:!0},{id:"phoneNumber",label:"Contact",sortable:!0},{id:"status",label:"Status",sortable:!0,format:(D,B)=>{const V=String(D).toUpperCase();if(rr((x==null?void 0:x.role)||"","EDIT_STUDENT"))return o.jsx(Tt,{size:"small",fullWidth:!0,children:o.jsxs(It,{value:V,onChange:W=>Y(B,W.target.value),displayEmpty:!0,variant:"standard",sx:{"& .MuiSelect-select":{py:0,color:()=>{switch(V){case"ACTIVE":return"success.main";case"INACTIVE":return"error.main";case"GRADUATED":return"info.main";case"SUSPENDED":return"warning.dark";default:return"text.primary"}}}},children:[o.jsx(Xe,{value:"ACTIVE",children:"Active"}),o.jsx(Xe,{value:"INACTIVE",children:"Inactive"}),o.jsx(Xe,{value:"GRADUATED",children:"Graduated"}),o.jsx(Xe,{value:"SUSPENDED",children:"Suspended"})]})});{let W="default";return V==="ACTIVE"?W="success":V==="INACTIVE"?W="error":V==="GRADUATED"?W="info":V==="SUSPENDED"&&(W="warning"),o.jsxs(te,{variant:"body2",sx:{color:`${W}.main`,fontWeight:"medium",display:"inline-flex",alignItems:"center",gap:.5},children:[V==="ACTIVE"&&o.jsx(Ov,{fontSize:"small"}),V==="INACTIVE"&&o.jsx(Sp,{fontSize:"small"}),V==="GRADUATED"&&o.jsx(Xa,{fontSize:"small"}),V==="SUSPENDED"&&o.jsx(jv,{fontSize:"small"}),V]})}}},{id:"actions",label:"Actions",sortable:!1,format:(D,B)=>o.jsxs(Se,{sx:{display:"flex",gap:1},children:[rr((x==null?void 0:x.role)||"","EDIT_STUDENT")&&o.jsx(at,{title:"Edit",children:o.jsx(Ze,{size:"small",onClick:()=>q(B),color:"primary",children:o.jsx(no,{fontSize:"small"})})}),rr((x==null?void 0:x.role)||"","DELETE_STUDENT")&&o.jsx(at,{title:"Delete",children:o.jsx(Ze,{size:"small",onClick:()=>Q(B),color:"error",children:o.jsx(ei,{fontSize:"small"})})}),rr((x==null?void 0:x.role)||"","MANAGE_ATTENDANCE")&&o.jsx(at,{title:"Attendance",children:o.jsx(Ze,{size:"small",color:"info",children:o.jsx(Yo,{fontSize:"small"})})}),rr((x==null?void 0:x.role)||"","MANAGE_EXAMS")&&o.jsx(at,{title:"Academic Records",children:o.jsx(Ze,{size:"small",color:"success",children:o.jsx(Xa,{fontSize:"small"})})}),rr((x==null?void 0:x.role)||"","MANAGE_FEES")&&o.jsx(at,{title:"Fee Details",children:o.jsx(Ze,{size:"small",color:"secondary",children:o.jsx(Rv,{fontSize:"small"})})})]})}];if(b)return o.jsx(Rn,{});if(S){const D=typeof S=="string"?S:(S==null?void 0:S.message)||String(S)||"Couldn't load student data";return o.jsxs(Se,{sx:{p:3},children:["        ",o.jsx(Ln,{title:"Error Loading Students",message:D,onRetry:I}),o.jsxs(Se,{sx:{mt:3,display:"flex",gap:2},children:[o.jsx(Me,{variant:"contained",onClick:I,children:"Try Again"}),o.jsx(Me,{variant:"outlined",color:"secondary",onClick:()=>m(!0),children:"Diagnostics"})]}),g&&o.jsxs(st,{elevation:0,variant:"outlined",sx:{p:3,mt:4},children:[o.jsxs(jr,{severity:"error",sx:{mb:2},children:[o.jsxs(te,{variant:"subtitle1",children:["HTTP Status: ",g.status||"Unknown"]}),g.message]}),o.jsx(te,{variant:"subtitle1",children:"Debug Information:"}),o.jsx(Se,{component:"pre",sx:{p:2,bgcolor:"grey.100",borderRadius:1,overflowX:"auto"},children:JSON.stringify(g.originalError||g,null,2)}),o.jsxs(Se,{sx:{mt:2},children:[o.jsx(te,{variant:"subtitle2",gutterBottom:!0,children:"Possible Solutions:"}),o.jsxs("ul",{children:[o.jsx("li",{children:"Verify the API endpoint path is correct"}),o.jsx("li",{children:"Check that your user account has permission to access student data"}),o.jsx("li",{children:"Ensure your authentication token is valid and not expired"}),o.jsx("li",{children:"Verify the backend server is running and accessible"})]})]})]})]})}return o.jsxs(Se,{sx:{p:3},children:[o.jsxs(Se,{sx:{mb:3,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx(te,{variant:"h4",children:"Students"}),o.jsxs(Se,{children:[o.jsx(Me,{variant:"text",color:"secondary",onClick:()=>m(!0),sx:{mr:2},children:"Debug"}),o.jsx(bn,{permission:"CREATE_STUDENT",children:o.jsxs(gc,{direction:"row",spacing:2,children:[o.jsx(Me,{variant:"outlined",color:"primary",startIcon:o.jsx(Ep,{}),onClick:()=>n(!0),children:"Bulk Upload"}),o.jsx(Me,{variant:"contained",color:"primary",startIcon:o.jsx(Gs,{}),onClick:()=>r(!0),children:"New Student"})]})})]})]}),o.jsx(st,{children:o.jsx(_c,{columns:J,data:y||[],loading:b,onRefresh:I,searchPlaceholder:"Search students..."})}),o.jsx(bw,{open:e,onClose:ye,onSubmit:U,initialData:a,loading:E||w}),o.jsx(PD,{open:t,onClose:()=>n(!1),onSubmit:me,loading:A}),o.jsx(jD,{open:p,onClose:()=>m(!1),entityType:"students",customEndpoints:[{name:"Get student entities",fn:()=>rn.getAllStudents()}]}),o.jsxs(kr,{open:i,onClose:()=>c(!1),children:[o.jsx(Xr,{children:"Confirm Deletion"}),o.jsx(Rr,{children:o.jsx(Tp,{children:"Are you sure you want to delete this student?"})}),o.jsxs(Nr,{children:[o.jsx(Me,{onClick:()=>c(!1),color:"primary",children:"Cancel"}),o.jsx(Me,{onClick:K,color:"secondary",children:"Delete"})]})]}),o.jsxs(vp,{anchorEl:l,open:!!l,onClose:()=>u(null),children:[o.jsx(Xe,{onClick:()=>Y(a,"ACTIVE"),children:"Set Active"}),o.jsx(Xe,{onClick:()=>Y(a,"INACTIVE"),children:"Set Inactive"}),o.jsx(Xe,{onClick:()=>Y(a,"GRADUATED"),children:"Set Graduated"}),o.jsx(Xe,{onClick:()=>Y(a,"SUSPENDED"),children:"Set Suspended"})]})]})},ND=({open:e,onClose:r,onSubmit:t,initialData:n,loading:a})=>{const[s,i]=C.useState({name:"",department:"",teacherId:0,credits:0,capacity:30,enrolled:0});C.useEffect(()=>{i(n?{...n}:{name:"",department:"",teacherId:0,credits:0,capacity:30,enrolled:0})},[n,e]);const[c,l]=C.useState({}),{data:u}=Nn(()=>_u.getAll(),{cacheKey:"teachers"}),d=h=>x=>{const p=h==="teacherId"||h==="credits"||h==="capacity"||h==="enrolled"?Number(x.target.value):x.target.value;i(m=>({...m,[h]:p})),c[h]&&l(m=>({...m,[h]:""}))},f=()=>{const h=mw(s);if(Object.keys(h).length>0){l(h);return}t(s)};return o.jsx(Fc,{open:e,onClose:r,title:n?"Edit Course":"New Course",onSubmit:f,submitLabel:n?"Update":"Create",loading:a,children:o.jsxs(X,{container:!0,spacing:2,children:[o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Course Name",value:s.name,onChange:d("name"),error:!!c.name,helperText:c.name,required:!0})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Department",value:s.department,onChange:d("department"),error:!!c.department,helperText:c.department,required:!0})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsxs(Tt,{fullWidth:!0,children:[o.jsx(Wt,{children:"Teacher"}),o.jsx(It,{value:s.teacherId,onChange:d("teacherId"),label:"Teacher",required:!0,children:u==null?void 0:u.map(h=>o.jsx(Xe,{value:h.id,children:h.name},h.id))})]})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Credits",type:"number",value:s.credits,onChange:d("credits"),error:!!c.credits,helperText:c.credits,required:!0,inputProps:{min:0}})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Capacity",type:"number",value:s.capacity,onChange:d("capacity"),error:!!c.capacity,helperText:c.capacity,required:!0,inputProps:{min:1}})}),n&&o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Currently Enrolled",type:"number",value:s.enrolled,onChange:d("enrolled"),error:!!c.enrolled,helperText:c.enrolled,inputProps:{min:0,max:s.capacity}})})]})})},MD=()=>{const[e,r]=C.useState(!1),[t,n]=C.useState(null),{showNotification:a}=sn(),{user:s}=kn(),{data:i,loading:c,error:l,refresh:u}=Nn(()=>Ps.getAll(),{cacheKey:"courses"}),{mutate:d,loading:f}=Pr(S=>Ps.create(S),{onSuccess:()=>{a({type:"success",message:"Course created successfully"}),r(!1),u()}}),{mutate:h,loading:x}=Pr(S=>Ps.update(S.id,S),{onSuccess:()=>{a({type:"success",message:"Course updated successfully"}),r(!1),n(null),u()}}),{mutate:p}=Pr(S=>Ps.delete(S),{onSuccess:()=>{a({type:"success",message:"Course deleted successfully"}),u()}}),m=S=>{n(S),r(!0)},g=async S=>{window.confirm("Are you sure you want to delete this course?")&&await p(S.id)},v=()=>{r(!1),n(null)},y=async S=>{t?await h({...S,id:t.id}):await d(S)},b=[{id:"id",label:"ID",sortable:!0},{id:"name",label:"Name",sortable:!0},{id:"department",label:"Department",sortable:!0},{id:"teacherId",label:"Teacher ID",sortable:!0},{id:"credits",label:"Credits",sortable:!0},{id:"capacity",label:"Capacity",sortable:!0},{id:"enrolled",label:"Enrolled",sortable:!0},OD(S=>rr((s==null?void 0:s.role)||"","EDIT_COURSE")&&m(S),S=>rr((s==null?void 0:s.role)||"","DELETE_COURSE")&&g(S),S=>o.jsxs(o.Fragment,{children:[o.jsx(bn,{permissions:["MANAGE_ENROLLMENTS","VIEW_ENROLLMENTS"],children:o.jsx(at,{title:"Students",children:o.jsx(Ze,{size:"small",onClick:()=>{},children:o.jsx(Hs,{})})})}),o.jsx(bn,{permissions:["MANAGE_ASSIGNMENTS"],children:o.jsx(at,{title:"Assignments",children:o.jsx(Ze,{size:"small",onClick:()=>{},children:o.jsx(Yo,{})})})}),o.jsx(bn,{permissions:["MANAGE_SCHEDULE"],children:o.jsx(at,{title:"Schedule",children:o.jsx(Ze,{size:"small",onClick:()=>{},children:o.jsx(kp,{})})})})]}))];return c&&!i?o.jsx(Rn,{}):l?o.jsx(Ln,{message:l,onRetry:u}):o.jsxs(Se,{children:[o.jsxs(Se,{sx:{mb:3,display:"flex",justifyContent:"space-between"},children:[o.jsx(te,{variant:"h4",children:"Courses"}),o.jsx(bn,{permission:"CREATE_COURSE",children:o.jsx(Me,{variant:"contained",color:"primary",startIcon:o.jsx(Gs,{}),onClick:()=>r(!0),children:"New Course"})})]}),o.jsx(st,{children:o.jsx(_c,{columns:b,data:i||[],loading:c,onRefresh:u,searchPlaceholder:"Search courses..."})}),o.jsx(ND,{open:e,onClose:v,onSubmit:y,initialData:t,loading:f||x})]})},K0=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8"],LD=()=>{const{showNotification:e}=sn(),[r,t]=C.useState(!0),[n,a]=C.useState(null),[s,i]=C.useState([]),[c,l]=C.useState([]),[u,d]=C.useState([]),[f,h]=C.useState("enrollment"),x=async()=>{try{t(!0),a(null);const v=await Ps.getAll(),y=await rn.getAll(),b=await _u.getAll();if(Array.isArray(v))i(v);else{const S=v;i(Array.isArray(S.data)?S.data:[])}if(Array.isArray(y))l(y);else{const S=y;l(Array.isArray(S.data)?S.data:[])}if(Array.isArray(b))d(b);else{const S=b;d(Array.isArray(S.data)?S.data:[])}}catch(v){console.error("Error loading report data:",v),a("Failed to load report data. Please try again."),e({type:"error",message:"Failed to load report data"})}finally{t(!1)}};C.useEffect(()=>{x()},[]);const p=s.map(v=>({courseName:v.name,enrolled:v.enrolled,capacity:v.capacity,availableSeats:v.capacity-v.enrolled})),m=s.reduce((v,y)=>{const b=v.find(S=>S.name===y.department);return b?(b.courses+=1,b.students=s.filter(S=>S.department===y.department).reduce((S,I)=>S+I.enrolled,0)):v.push({name:y.department,courses:1,students:s.filter(S=>S.department===y.department).reduce((S,I)=>S+I.enrolled,0),teachers:u.filter(S=>S.department===y.department).length}),v},[]),g=()=>{let v=[],y="";switch(f){case"enrollment":v=p,y="enrollment-report.csv";break;case"department":v=m,y="department-stats.csv";break;default:return}const b="data:text/csv;charset=utf-8,"+Object.keys(v[0]).join(",")+"\\n"+v.map(I=>Object.values(I).join(",")).join("\\n"),S=document.createElement("a");S.href=encodeURI(b),S.download=y,document.body.appendChild(S),S.click(),document.body.removeChild(S)};return r?o.jsx(Rn,{message:"Loading report data..."}):n?o.jsx(Ln,{message:n,onRetry:x}):o.jsxs(Se,{children:[o.jsxs(Se,{sx:{display:"flex",justifyContent:"space-between",mb:4},children:[o.jsx(te,{variant:"h4",children:"Reports & Analytics"}),o.jsx(Me,{variant:"contained",startIcon:o.jsx(Nv,{}),onClick:g,children:"Export Report"})]}),o.jsxs(Tt,{sx:{mb:4,minWidth:200},children:[o.jsx(Wt,{children:"Report Type"}),o.jsxs(It,{value:f,label:"Report Type",onChange:v=>h(v.target.value),children:[o.jsx(Xe,{value:"enrollment",children:"Course Enrollment"}),o.jsx(Xe,{value:"department",children:"Department Statistics"})]})]}),f==="enrollment"&&o.jsxs(X,{container:!0,spacing:4,children:[o.jsx(X,{item:!0,xs:12,children:o.jsxs(st,{sx:{p:3},children:[o.jsx(te,{variant:"h6",sx:{mb:2},children:"Course Enrollment Distribution"}),o.jsx(bf,{width:"100%",height:400,children:o.jsxs(ry,{data:p,children:[o.jsx(ny,{strokeDasharray:"3 3"}),o.jsx(ay,{dataKey:"courseName"}),o.jsx(sy,{}),o.jsx(wf,{}),o.jsx(Sf,{}),o.jsx(Ef,{dataKey:"enrolled",fill:"#8884d8",name:"Enrolled"}),o.jsx(Ef,{dataKey:"availableSeats",fill:"#82ca9d",name:"Available Seats"})]})})]})}),o.jsx(X,{item:!0,xs:12,children:o.jsx(zs,{component:st,children:o.jsxs(Za,{children:[o.jsx(es,{children:o.jsxs(ir,{children:[o.jsx(ze,{children:"Course"}),o.jsx(ze,{align:"right",children:"Enrolled"}),o.jsx(ze,{align:"right",children:"Capacity"}),o.jsx(ze,{align:"right",children:"Available Seats"}),o.jsx(ze,{align:"right",children:"Fill Rate (%)"})]})}),o.jsx(ts,{children:p.map(v=>o.jsxs(ir,{children:[o.jsx(ze,{children:v.courseName}),o.jsx(ze,{align:"right",children:v.enrolled}),o.jsx(ze,{align:"right",children:v.capacity}),o.jsx(ze,{align:"right",children:v.availableSeats}),o.jsxs(ze,{align:"right",children:[(v.enrolled/v.capacity*100).toFixed(1),"%"]})]},v.courseName))})]})})})]}),f==="department"&&o.jsxs(X,{container:!0,spacing:4,children:[o.jsx(X,{item:!0,xs:12,md:6,children:o.jsxs(st,{sx:{p:3},children:[o.jsx(te,{variant:"h6",sx:{mb:2},children:"Department Distribution"}),o.jsx(bf,{width:"100%",height:400,children:o.jsxs(iy,{children:[o.jsx(oy,{data:m,dataKey:"courses",nameKey:"name",cx:"50%",cy:"50%",label:!0,children:m.map((v,y)=>o.jsx(cy,{fill:K0[y%K0.length]},v.name))}),o.jsx(wf,{}),o.jsx(Sf,{})]})})]})}),o.jsx(X,{item:!0,xs:12,md:6,children:o.jsx(zs,{component:st,children:o.jsxs(Za,{children:[o.jsx(es,{children:o.jsxs(ir,{children:[o.jsx(ze,{children:"Department"}),o.jsx(ze,{align:"right",children:"Courses"}),o.jsx(ze,{align:"right",children:"Teachers"})]})}),o.jsx(ts,{children:m.map(v=>o.jsxs(ir,{children:[o.jsx(ze,{children:v.name}),o.jsx(ze,{align:"right",children:v.courses}),o.jsx(ze,{align:"right",children:v.teachers})]},v.name))})]})})})]})]})},fn={getAllApplications:async()=>{const e=await De.get("/api/admissions");return console.log("API Response for getAllApplications:",e),e.map(J0)},getApplicationById:async e=>{try{console.log(`Fetching admission details for ID: ${e}`);const r=await De.get(`/api/admissions/${e}`);console.log("Admission details from backend:",r);const t=J0(r);if(r.studentId)try{console.log(`Admission has associated student ID: ${r.studentId}, fetching student details`);const n=await rn.getById(r.studentId);console.log("Student data retrieved:",n),n&&n.address&&(console.log("Found address in student record:",n.address),t.address=n.address)}catch(n){console.warn("Could not fetch student data:",n)}else console.log("No associated student ID found for this admission");return t}catch(r){throw console.error(`Failed to get admission details for ID ${e}:`,r),r}},createApplication:e=>{let r=e.dateOfBirth;if(r&&!r.includes("-")){const n=new Date(r);isNaN(n.getTime())||(r=n.toISOString().split("T")[0])}const t={applicantName:e.studentName,dateOfBirth:r,email:e.email,contactNumber:e.contactNumber,guardianName:e.parentName,guardianContact:e.contactNumber,guardianEmail:e.email,address:e.address,gradeApplying:parseInt(e.gradeApplying,10)||1,previousSchool:e.previousSchool||"Not Available",previousGrade:e.previousGrade||"Not Available",previousPercentage:e.previousPercentage||75,documents:e.documents,documentsFormat:e.documentsFormat};return console.log("Sending admission request with structured data:",t),console.log("Date format checking - original:",e.dateOfBirth,"formatted:",r),console.log("Address value being sent:",e.address),De.post("/api/admissions",t)},updateApplication:async(e,r)=>{if(console.log(`Updating admission application with ID: ${e}`,r),!localStorage.getItem("token"))throw new Error("You must be logged in to update applications");try{const n={applicantName:r.studentName,dateOfBirth:r.dateOfBirth,email:r.email,contactNumber:r.contactNumber,guardianName:r.parentName,guardianContact:r.contactNumber,guardianEmail:r.email,address:r.address,gradeApplying:parseInt(r.gradeApplying,10),previousSchool:r.previousSchool||"Not Available",previousGrade:r.previousGrade||"Not Available",previousPercentage:r.previousPercentage||75,documents:r.documents,documentsFormat:r.documentsFormat};console.log("Sending general update request with data:",n);const a=await De.put(`/api/admissions/${e}`,n);return console.log("Update response:",a),a}catch(n){throw console.error("Update attempt failed:",n),n}},updateStatus:async(e,r,t)=>{console.log(`Updating admission status ${e} to ${r}`);const n=new URLSearchParams;return n.append("status",r),t&&n.append("remarks",t),De.put(`/api/admissions/${e}/status?${n.toString()}`)},getByStatus:e=>De.get(`/api/admissions/status/${e}`),searchApplications:e=>De.get(`/api/admissions/search?query=${e}`),getByDateRange:(e,r)=>De.get(`/api/admissions/date-range?startDate=${e}&endDate=${r}`),getByGrade:e=>De.get(`/api/admissions/grade/${e}`),deleteApplication:e=>De.delete(`/api/admissions/${e}`),processAdmission:async(e,r,t)=>{console.log(`Processing admission ${e} with action: ${r}`);try{const n=r==="APPROVE"?"APPROVED":"REJECTED",a=new URLSearchParams;a.append("status",n),r==="REJECT"&&t&&a.append("remarks",t);const s=await De.put(`/api/admissions/${e}/status?${a.toString()}`);return console.log(`Admission ${e} processed with response:`,s),s}catch(n){throw console.error(`Error processing admission ${e}:`,n),n}},createStudentFromAdmission:async(e,r={})=>{console.log(`Creating student from admission ${e}`);const t=await fn.getApplicationById(e);if(!t)throw new Error(`Admission record ${e} not found`);if(t.status!=="APPROVED")throw new Error(`Cannot create student from admission with status ${t.status}`);return{studentId:`STU${new Date().getFullYear()}${Math.floor(1e3+Math.random()*9e3)}`,name:t.studentName,email:t.email,phoneNumber:t.contactNumber,dateOfBirth:t.dateOfBirth,grade:String(parseInt(t.gradeApplying,10)),section:r.section||"A",address:t.address||"",parentName:t.parentName,parentPhone:t.contactNumber,parentEmail:t.email,status:"ACTIVE",admissionDate:new Date().toISOString().split("T")[0],gender:r.gender||"MALE",...r}},hasStudentRecord:async e=>{try{const r=await De.get(`/api/admissions/${e}/student-status`);return r&&r.hasStudent}catch(r){return console.warn(`Error checking if admission ${e} has student record:`,r),!1}},getDebugInfo:async()=>{const e=localStorage.getItem("user"),r=localStorage.getItem("token");let t=null,n=null;try{if(e&&(t=JSON.parse(e)),r){const a=r.split(".");if(a.length===3){const s=JSON.parse(atob(a[1]));n={exp:new Date(s.exp*1e3).toLocaleString(),roles:s.roles||s.authorities||s.role||"Not found in token",sub:s.sub||s.username}}}}catch(a){console.error("Error parsing user/token data",a)}return{user:t,token:r?`${r.substring(0,20)}...`:null,tokenInfo:n,endpoints:{getAllApplications:"/api/admissions",getApplicationById:"/api/admissions/:id",createApplication:"/api/admissions",updateApplication:"/api/admissions/:id",updateStatus:"/api/admissions/:id/status",deleteApplication:"/api/admissions/:id",getByStatus:"/api/admissions/status/:status",searchApplications:"/api/admissions/search?query=:query",getByDateRange:"/api/admissions/date-range",getByGrade:"/api/admissions/grade/:grade",checkStudentStatus:"/api/admissions/:id/student-status"}}}};function J0(e){var n;console.log("Transforming response to application:",e);const r=["PENDING","UNDER_REVIEW","APPROVED","REJECTED","WAITLISTED","CANCELLED","ENROLLED"],t=e.status&&r.includes(e.status)?e.status:"PENDING";return{id:e.id,studentName:e.applicantName,dateOfBirth:e.dateOfBirth,gradeApplying:((n=e.gradeApplying)==null?void 0:n.toString())||"",parentName:e.guardianName,contactNumber:e.contactNumber||e.guardianContact||"",email:e.email||e.guardianEmail||"",address:e.address||"",status:t,submissionDate:e.applicationDate,rejectionReason:e.rejectionReason,previousSchool:e.previousSchool||"",previousGrade:e.previousGrade||"",previousPercentage:e.previousPercentage,documents:e.documents,documentsFormat:e.documentsFormat||""}}const ud={email:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,phone:/^\+?[\d\s-]{10,}$/,name:/^[a-zA-Z\s-']{2,}$/},BD=e=>ud.email.test(e),$D=e=>ud.phone.test(e),Q0=e=>ud.name.test(e),UD=e=>!isNaN(Date.parse(e)),VD=e=>{const r={};return(!e.studentName||!Q0(e.studentName))&&(r.studentName="Please enter a valid student name"),(!e.dateOfBirth||!UD(e.dateOfBirth))&&(r.dateOfBirth="Please enter a valid date of birth"),e.gradeApplying||(r.gradeApplying="Grade is required"),(!e.parentName||!Q0(e.parentName))&&(r.parentName="Please enter a valid parent/guardian name"),(!e.contactNumber||!$D(e.contactNumber))&&(r.contactNumber="Please enter a valid phone number"),(!e.email||!BD(e.email))&&(r.email="Please enter a valid email address"),(!e.address||e.address.length<10)&&(r.address="Please enter a complete address (minimum 10 characters)"),r},WD=["1","2","3","4","5","6","7","8","9","10","11","12"],HD=["A","B","C","D"],zD=["MALE","FEMALE","OTHER"],GD=["A+","A-","B+","B-","AB+","AB-","O+","O-"],YD=({open:e,onClose:r,onSubmit:t,initialData:n,loading:a})=>{const[s,i]=C.useState(n||{studentName:"",firstName:"",lastName:"",dateOfBirth:"",gradeApplying:"1",section:"A",parentName:"",contactNumber:"",email:"",address:"",gender:"MALE",bloodGroup:"",medicalConditions:"",previousSchool:"",previousGrade:"",previousPercentage:75,status:"PENDING"}),[c,l]=C.useState(!1),[u,d]=C.useState({}),[f,h]=C.useState(!1);C.useEffect(()=>{if(e){const m=(n==null?void 0:n.id)||n&&Object.keys(n).length>0&&n.studentName;if(l(!!m),n&&Object.keys(n).length>0){let g=n.firstName||"",v=n.lastName||"";if((!g||!v)&&n.studentName){const y=n.studentName.split(" ");g=y[0]||"",v=y.length>1?y.slice(1).join(" "):""}i({...n,id:n.id,firstName:g,lastName:v,studentName:n.studentName||"",dateOfBirth:n.dateOfBirth||"",gradeApplying:n.gradeApplying||"1",section:n.section||"A",parentName:n.parentName||"",contactNumber:n.contactNumber||"",email:n.email||"",address:n.address||"",gender:n.gender||"MALE",bloodGroup:n.bloodGroup||"",medicalConditions:n.medicalConditions||"",previousSchool:n.previousSchool||"",previousGrade:n.previousGrade||"",previousPercentage:n.previousPercentage||75,status:n.status||"PENDING"})}else i({studentName:"",firstName:"",lastName:"",dateOfBirth:"",gradeApplying:"1",section:"A",parentName:"",contactNumber:"",email:"",address:"",gender:"MALE",bloodGroup:"",medicalConditions:"",previousSchool:"",previousGrade:"",previousPercentage:75,status:"PENDING"});d({})}},[e,n]),C.useEffect(()=>{if(s.firstName||s.lastName){const m=`${s.firstName||""} ${s.lastName||""}`.trim();i(g=>({...g,studentName:m}))}},[s.firstName,s.lastName]);const x=m=>g=>{i(v=>({...v,[m]:g.target.value})),u[m]&&d(v=>({...v,[m]:""}))},p=()=>{const m={...s,submissionDate:s.submissionDate||new Date().toISOString().split("T")[0]},g=VD(m);if(Object.keys(g).length>0){d(g);return}t(m)};return o.jsx(Fc,{open:e,onClose:r,title:c?"Edit Application":"New Admission Application",onSubmit:p,submitLabel:c?"Update":"Submit",loading:a,maxWidth:"md",fullWidth:!0,children:o.jsxs(X,{container:!0,spacing:3,children:[o.jsx(X,{item:!0,xs:12,children:o.jsxs(st,{elevation:1,sx:{p:3,mb:2,borderRadius:2,borderTop:"5px solid #1976d2",bgcolor:"#f5f9ff"},children:[o.jsxs(Se,{sx:{display:"flex",alignItems:"center",mb:3,pb:1,borderBottom:"1px solid #e0e0e0"},children:[o.jsx(yp,{sx:{fontSize:28,mr:1,color:"#1976d2"}}),o.jsx(te,{variant:"h6",fontWeight:"500",color:"#1976d2",children:"STUDENT INFORMATION"})]}),o.jsxs(X,{container:!0,spacing:2,children:[o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"First Name",value:s.firstName||"",onChange:x("firstName"),error:!!u.firstName,helperText:u.firstName,required:!0})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Last Name",value:s.lastName||"",onChange:x("lastName"),error:!!u.lastName,helperText:u.lastName,required:!0})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Date of Birth",type:"date",value:s.dateOfBirth||"",onChange:x("dateOfBirth"),error:!!u.dateOfBirth,helperText:u.dateOfBirth||"Select date from calendar",InputLabelProps:{shrink:!0},required:!0})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsxs(Tt,{fullWidth:!0,required:!0,children:[o.jsx(Wt,{id:"gender-label",children:"Gender"}),o.jsx(It,{labelId:"gender-label",value:s.gender||"MALE",onChange:x("gender"),label:"Gender",children:zD.map(m=>o.jsx(Xe,{value:m,children:m},m))})]})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,select:!0,label:"Grade Applying",value:s.gradeApplying||"",onChange:x("gradeApplying"),error:!!u.gradeApplying,helperText:u.gradeApplying,required:!0,children:WD.map(m=>o.jsxs(Xe,{value:m,children:["Grade ",m]},m))})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,select:!0,label:"Section",value:s.section||"A",onChange:x("section"),children:HD.map(m=>o.jsxs(Xe,{value:m,children:["Section ",m]},m))})})]})]})}),o.jsx(X,{item:!0,xs:12,children:o.jsxs(st,{elevation:1,sx:{p:3,mb:2,borderRadius:2,borderTop:"5px solid #f50057",bgcolor:"#fff9fb"},children:[o.jsxs(Se,{sx:{display:"flex",alignItems:"center",mb:3,pb:1,borderBottom:"1px solid #e0e0e0"},children:[o.jsx(Hs,{sx:{fontSize:28,mr:1,color:"#f50057"}}),o.jsx(te,{variant:"h6",fontWeight:"500",color:"#f50057",children:"PARENT/GUARDIAN INFORMATION"})]}),o.jsxs(X,{container:!0,spacing:2,children:[o.jsx(X,{item:!0,xs:12,children:o.jsx(ke,{fullWidth:!0,label:"Parent/Guardian Name",value:s.parentName||"",onChange:x("parentName"),error:!!u.parentName,helperText:u.parentName||"Full name of parent or guardian",required:!0})}),o.jsx(X,{item:!0,xs:12,md:6,children:o.jsxs(Se,{sx:{p:2,border:"1px dashed #f50057",borderRadius:1,mb:2},children:[o.jsx(te,{variant:"subtitle2",fontWeight:"500",color:"#f50057",sx:{mb:2},children:"Contact Information"}),o.jsxs(gc,{spacing:2,children:[o.jsx(ke,{fullWidth:!0,label:"Phone Number",value:s.contactNumber||"",onChange:x("contactNumber"),error:!!u.contactNumber,helperText:u.contactNumber||"e.g. +1234567890",required:!0}),o.jsx(ke,{fullWidth:!0,label:"Email Address",type:"email",value:s.email||"",onChange:x("email"),error:!!u.email,helperText:u.email,required:!0})]})]})}),o.jsx(X,{item:!0,xs:12,md:6,children:o.jsxs(Se,{sx:{p:2,border:"1px dashed #f50057",borderRadius:1},children:[o.jsx(te,{variant:"subtitle2",fontWeight:"500",color:"#f50057",sx:{mb:2},children:"Residence Information"}),o.jsx(ke,{fullWidth:!0,label:"Home Address",multiline:!0,rows:4,value:s.address||"",onChange:x("address"),error:!!u.address,helperText:u.address||"Complete residential address",required:!0})]})})]})]})}),o.jsx(X,{item:!0,xs:12,children:o.jsxs(st,{elevation:1,sx:{p:3,borderRadius:2,borderTop:"5px solid #4caf50",bgcolor:"#f5fbf5"},children:[o.jsxs(Se,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:1,borderBottom:"1px solid #e0e0e0",mb:2},children:[o.jsxs(Se,{sx:{display:"flex",alignItems:"center"},children:[o.jsx(Xa,{sx:{fontSize:28,mr:1,color:"#4caf50"}}),o.jsx(te,{variant:"h6",fontWeight:"500",color:"#4caf50",children:"ADDITIONAL INFORMATION"})]}),o.jsx(te,{variant:"body2",color:"primary",sx:{cursor:"pointer",fontWeight:500,textDecoration:"underline"},onClick:()=>h(!f),children:f?"Hide Additional Fields":"Show More Fields"})]}),f&&o.jsxs(X,{container:!0,spacing:2,children:[o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsxs(ke,{fullWidth:!0,select:!0,label:"Blood Group",value:s.bloodGroup||"",onChange:x("bloodGroup"),children:[o.jsx(Xe,{value:"",children:"Not Specified"}),GD.map(m=>o.jsx(Xe,{value:m,children:m},m))]})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Medical Conditions",multiline:!0,rows:2,value:s.medicalConditions||"",onChange:x("medicalConditions")})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Previous School",value:s.previousSchool||"",onChange:x("previousSchool")})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Previous Grade",value:s.previousGrade||"",onChange:x("previousGrade")})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Previous Percentage/GPA",type:"number",inputProps:{min:0,max:100,step:.1},value:s.previousPercentage||75,onChange:x("previousPercentage")})})]})]})}),o.jsx(X,{item:!0,xs:12,children:o.jsx(rs,{sx:{textAlign:"center"},children:"Fields marked with * are required. Submission date will be set automatically."})})]})})},qD=({error:e,onClose:r})=>{const[t,n]=C.useState(!1);return o.jsx("div",{className:"auth-error-dialog",children:o.jsxs("div",{className:"auth-error-content",children:[o.jsx("h3",{children:"Authentication Error"}),o.jsxs("div",{className:"error-message",children:[o.jsx("strong",{children:e.message||"Access Denied"}),o.jsxs("p",{children:["Status code: ",e.status]})]}),e.tokenInfo&&o.jsxs("div",{className:"token-info",children:[o.jsx("h4",{children:"Token Information:"}),o.jsxs("ul",{children:[o.jsxs("li",{children:[o.jsx("strong",{children:"Username:"})," ",e.tokenInfo.username]}),o.jsxs("li",{children:[o.jsx("strong",{children:"Roles:"})," ",e.tokenInfo.roles]}),o.jsxs("li",{children:[o.jsx("strong",{children:"Expiration:"})," ",e.tokenInfo.exp]})]})]}),o.jsxs("div",{className:"troubleshooting",children:[o.jsx("h4",{children:"Troubleshooting:"}),o.jsxs("ul",{children:[o.jsx("li",{children:"Verify you have the required role (ADMIN) for this operation"}),o.jsx("li",{children:"Try logging out and logging back in"}),o.jsx("li",{children:"Check that your token has not expired"})]})]}),o.jsxs("div",{className:"buttons",children:[o.jsx("button",{onClick:()=>n(!t),children:t?"Hide Technical Details":"Show Technical Details"}),o.jsx("button",{onClick:r,children:"Close"})]}),t&&o.jsxs("div",{className:"technical-details",children:[o.jsx("h4",{children:"Technical Details:"}),o.jsx("pre",{children:JSON.stringify(e,null,2)})]})]})})};var dd={},XD=At;Object.defineProperty(dd,"__esModule",{value:!0});var Yx=dd.default=void 0,KD=XD(_t()),JD=o;Yx=dd.default=(0,KD.default)((0,JD.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit");var fd={},QD=At;Object.defineProperty(fd,"__esModule",{value:!0});var hd=fd.default=void 0,ZD=QD(_t()),eF=o;hd=fd.default=(0,ZD.default)((0,eF.jsx)("path",{d:"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m-9-2V7H4v3H1v2h3v3h2v-3h3v-2zm9 4c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"PersonAdd");var pd={},tF=At;Object.defineProperty(pd,"__esModule",{value:!0});var qx=pd.default=void 0,rF=tF(_t()),nF=o;qx=pd.default=(0,rF.default)((0,nF.jsx)("path",{d:"M4.25 5.61C6.27 8.2 10 13 10 13v6c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-6s3.72-4.8 5.74-7.39c.51-.66.04-1.61-.79-1.61H5.04c-.83 0-1.3.95-.79 1.61"}),"FilterAlt");var md={},aF=At;Object.defineProperty(md,"__esModule",{value:!0});var Xx=md.default=void 0,sF=aF(_t()),iF=o;Xx=md.default=(0,sF.default)((0,iF.jsx)("path",{d:"M19 9h-4V3H9v6H5l7 7zM5 18v2h14v-2z"}),"FileDownload");var xd={},oF=At;Object.defineProperty(xd,"__esModule",{value:!0});var Kx=xd.default=void 0,cF=oF(_t()),lF=o;Kx=xd.default=(0,cF.default)((0,lF.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Clear");const uF=(e,r,t)=>({id:"actions",label:"Actions",sortable:!1,align:"right",format:(n,a)=>a?o.jsxs(Se,{sx:{display:"flex",alignItems:"center",justifyContent:"flex-end"},children:[e&&o.jsx(at,{title:"Edit",children:o.jsx(Ze,{size:"small",onClick:()=>{a&&e(a)},sx:{mr:.5},children:o.jsx(Yx,{fontSize:"small"})})}),r&&a&&o.jsx(Me,{size:"small",color:"error",onClick:()=>{a&&r(a)},children:"Delete"}),t&&a&&t(a)]}):(console.warn("Action column received undefined row data"),null)}),fi=[{value:"PENDING",label:"Submitted"},{value:"UNDER_REVIEW",label:"Under Review"},{value:"APPROVED",label:"Approved"},{value:"REJECTED",label:"Rejected"},{value:"WAITLISTED",label:"Waitlisted"}],dF=Array.from({length:12},(e,r)=>({value:(r+1).toString(),label:`Grade ${r+1}`})),fF=()=>{const{user:e}=kn(),{showNotification:r}=sn(),[t,n]=C.useState(null),[a,s]=C.useState(!1),[i,c]=C.useState(!1),[l,u]=C.useState(!1),[d,f]=C.useState([]),[h,x]=C.useState(null),[p,m]=C.useState(!1),[g,v]=C.useState(null),[y,b]=C.useState([]),[S,I]=C.useState("PENDING"),[k,E]=C.useState(!1),[T,w]=C.useState(""),[F,P]=C.useState(()=>Promise.resolve()),[A,L]=C.useState(!1),[Y,q]=C.useState({name:"",grade:[],status:[],dateRange:{start:"",end:""}}),[Q,K]=C.useState(!1);C.useEffect(()=>{console.log("ðŸ” Admissions component mounted"),console.log("ðŸ‘¤ User:",e);const N=localStorage.getItem("token");if(N)try{const ie=JSON.parse(atob(N.split(".")[1]));console.log("ðŸ”‘ Token payload:",{exp:new Date(ie.exp*1e3).toLocaleString(),roles:ie.roles||ie.authorities||ie.role||"Not found in token",sub:ie.sub||ie.username})}catch{console.log("âš ï¸ Could not parse token")}return fn.getDebugInfo().then(ie=>{console.log("ðŸ“ API connection info:",ie)}),()=>{console.log("ðŸ” Admissions component unmounted")}},[e]);const{data:ye,loading:U,error:me,refresh:J}=Nn(()=>(console.log("ðŸ”„ Calling admissionService.getAllApplications() with multiple fallbacks"),console.log("ðŸ”‘ Current user role:",e==null?void 0:e.role),console.log("ðŸ”’ Auth token present:",!!localStorage.getItem("token")),fn.getAllApplications()),{onError:N=>(console.error("âŒ Error in useApi for admissions:",N),x(N),[])}),D=C.useMemo(()=>ye?Q?ye.filter(N=>{var Le,Ue,Fe,Pe;const ie=!Y.name||((Le=N.studentName)==null?void 0:Le.toLowerCase().includes(Y.name.toLowerCase()))||((Ue=N.email)==null?void 0:Ue.toLowerCase().includes(Y.name.toLowerCase()))||((Fe=N.parentName)==null?void 0:Fe.toLowerCase().includes(Y.name.toLowerCase())),le=Y.grade.length===0||Y.grade.includes((Pe=N.gradeApplying)==null?void 0:Pe.toString()),we=Y.status.length===0||Y.status.includes(N.status);let Ae=!0;if(Y.dateRange.start||Y.dateRange.end){const Ve=N.submissionDate?new Date(N.submissionDate):null;if(Ve){if(Y.dateRange.start){const Ye=new Date(Y.dateRange.start);Ve<Ye&&(Ae=!1)}if(Y.dateRange.end&&Ae){const Ye=new Date(Y.dateRange.end);Ye.setHours(23,59,59),Ve>Ye&&(Ae=!1)}}}return ie&&le&&we&&Ae}):ye:[],[ye,Y,Q]),B=()=>{n({studentName:"",dateOfBirth:"",gradeApplying:"",parentName:"",contactNumber:"",email:"",address:"",status:"PENDING"}),s(!0)},V=async N=>{if(console.log("Edit clicked for application:",N),!N){console.error("Error: Attempted to edit undefined application");return}m(!0);try{const ie={...N,id:N.id,studentName:N.studentName||"",dateOfBirth:N.dateOfBirth||"2005-01-01",gradeApplying:N.gradeApplying||"1",parentName:N.parentName!=="Not available"?N.parentName:"",contactNumber:N.contactNumber||"",email:N.email||"",address:N.address||"",status:N.status||"PENDING"};if(console.log("Enhanced application object for editing:",ie),n(ie),N.id)try{const le=await fn.getApplicationById(N.id);console.log("Retrieved detailed application data:",le),le&&le.studentName&&n(le)}catch(le){console.warn("Could not fetch complete details, using basic data:",le)}}catch(ie){console.error("Error preparing application for edit:",ie),r({type:"warning",message:"Could not load complete application details. Some fields may be missing."})}finally{m(!1),s(!0)}},W=async N=>{var ie,le;try{if(N.id)console.log("Attempting to update application:",N),await fn.updateApplication(N.id,N),r({type:"success",message:"Application updated successfully"});else{console.log("Submitting application data:",N);const we=[];if(N.studentName||we.push("Student Name"),N.dateOfBirth||we.push("Date of Birth"),N.gradeApplying||we.push("Grade"),N.parentName||we.push("Parent/Guardian Name"),N.contactNumber||we.push("Contact Number"),N.email||we.push("Email"),N.address||we.push("Address"),we.length>0)throw new Error(`Missing required fields: ${we.join(", ")}`);if(!/^\d{4}-\d{2}-\d{2}$/.test(N.dateOfBirth))throw new Error("Date of Birth must be in YYYY-MM-DD format");const Le=await fn.createApplication(N);console.log("Submission successful, response:",Le),r({type:"success",message:"New application created successfully"})}s(!1),J()}catch(we){if(console.error("Error saving application:",we),we.status===403)v(we);else{let Ae=we.message||"An error occurred while saving the application";if((le=(ie=we.originalError)==null?void 0:ie.response)!=null&&le.data&&(console.log("Backend validation errors:",we.originalError.response.data),we.originalError.response.data.message&&(Ae=`Validation error: ${we.originalError.response.data.message}`),we.originalError.response.data.errors))try{if(Array.isArray(we.originalError.response.data.errors))Ae=`Validation errors: ${we.originalError.response.data.errors.map(Ue=>Ue.defaultMessage||Ue.field).join(", ")}`;else if(typeof we.originalError.response.data.errors=="object"){const Le=we.originalError.response.data.errors,Ue=[];for(const Fe in Le)Le.hasOwnProperty(Fe)&&Ue.push(`${Fe}: ${Le[Fe]}`);Ue.length>0&&(Ae=`Validation errors: ${Ue.join(", ")}`)}}catch(Le){console.error("Error parsing validation errors:",Le)}r({type:"error",message:Ae})}}},Z=async(N,ie)=>{try{m(!0);let le="";ie==="REJECTED"&&(le=prompt("Please provide a reason for rejection:")||""),console.log(`Processing admission ${N.id} with status: ${ie}, reason: ${le}`);const we=ie==="APPROVED"?"APPROVE":"REJECT";if(N.id!==void 0)await fn.processAdmission(N.id,we,le);else throw new Error("Application ID is undefined");r({type:"success",message:`Application status changed to ${ie.toLowerCase()} successfully`}),J()}catch(le){console.error(`Error updating application status to ${ie}:`,le),le.status===403?v(le):r({type:"error",message:`Failed to update application status: ${le.message}`})}finally{m(!1)}},fe=async N=>{try{if(m(!0),N.status!=="APPROVED")if(N.id!==void 0)await fn.processAdmission(N.id,"APPROVE");else throw new Error("Application ID is undefined");if(N.id!==void 0){const ie=await fn.createStudentFromAdmission(N.id)}else throw new Error("Application ID is undefined");r({type:"success",message:"Student created successfully from application"}),J()}catch(ie){console.error("Error creating student from application:",ie),r({type:"error",message:`Failed to create student: ${ie.message||"Unknown error"}`})}finally{m(!1)}},ne=(N,ie)=>{b(ie?le=>[...le,N]:le=>le.filter(we=>we.id!==N.id))},ee=N=>{b(N&&ye?[...ye]:[])},se=N=>{I(N.target.value)},j=async()=>{var N;try{m(!0),w(`Are you sure you want to change the status of ${y.length} application(s) to ${((N=fi.find(ie=>ie.value===S))==null?void 0:N.label)||S}?`),P(()=>async()=>{const ie=await Promise.allSettled(y.map(Ae=>{if(Ae.status===S)return Promise.resolve();const Le=S==="REJECTED"?"Rejected in bulk update":void 0,Ue=S==="APPROVED"?"APPROVE":"REJECT";if(Ae.id!==void 0)return fn.processAdmission(Ae.id,Ue,Le);throw new Error("Application ID is undefined")})),le=ie.filter(Ae=>Ae.status==="fulfilled").length,we=ie.filter(Ae=>Ae.status==="rejected").length;r({type:we>0?"warning":"success",message:`Status update complete: ${le} successful, ${we} failed`}),b([]),J()}),E(!0)}catch(ie){r({type:"error",message:`Failed to process bulk action: ${ie.message||"Unknown error"}`})}finally{m(!1)}},_=(N,ie)=>{ie==="APPROVED"?Z(N,"APPROVED"):ie==="REJECTED"?Z(N,"REJECTED"):(async()=>{try{if(m(!0),N.id!==void 0)await fn.updateStatus(N.id,ie);else throw new Error("Application ID is undefined");r({type:"success",message:`Status updated to ${ie.toLowerCase()}`}),J()}catch(le){r({type:"error",message:`Failed to update status: ${le.message||"Unknown error"}`})}finally{m(!1)}})()},ae=(N,ie)=>{q(le=>({...le,[N]:ie}))},oe=()=>{K(!0),L(!1)},Te=()=>{q({name:"",grade:[],status:[],dateRange:{start:"",end:""}}),K(!1)},ce=()=>{try{const N=Q?D:ye||[];if(N.length===0){r({type:"warning",message:"No data to export"});return}const we=[["ID","Student Name","Date of Birth","Email","Contact Number","Parent/Guardian Name","Parent/Guardian Contact","Address","Grade Applying","Previous School","Previous Grade","Previous Percentage","Submission Date","Status"].join(","),...N.map(Fe=>[Fe.id||"",`"${Fe.studentName||""}"`,Fe.dateOfBirth||"",`"${Fe.email||""}"`,Fe.contactNumber||"",`"${Fe.parentName||""}"`,Fe.guardianContact||Fe.contactNumber||"",`"${Fe.address||""}"`,Fe.gradeApplying||"",`"${Fe.previousSchool||""}"`,Fe.previousGrade||"",Fe.previousPercentage||"",Fe.submissionDate?new Date(Fe.submissionDate).toISOString().split("T")[0]:"",Fe.status||"PENDING"].join(","))].join(`
`),Ae=new Blob([we],{type:"text/csv;charset=utf-8;"}),Le=URL.createObjectURL(Ae),Ue=document.createElement("a");Ue.setAttribute("href",Le),Ue.setAttribute("download",`admissions_export_${new Date().toISOString().slice(0,10)}.csv`),document.body.appendChild(Ue),Ue.click(),document.body.removeChild(Ue),r({type:"success",message:`Exported ${N.length} records to CSV`})}catch(N){console.error("Error exporting CSV:",N),r({type:"error",message:"Failed to export CSV: "+(N.message||"Unknown error")})}},be=async()=>{u(!0),f([]);const N=[{name:"Get all admissions (singular)",fn:()=>De.get("/admission")},{name:"Get all admissions (plural)",fn:()=>De.get("/admissions")},{name:"Get health check",fn:()=>De.get("/health")},{name:"Get auth status",fn:()=>De.get("/auth/status")}],ie=[];for(const le of N)try{console.log(`ðŸ§ª Testing endpoint: ${le.name}`);const we=await le.fn();ie.push({name:le.name,success:!0,status:"OK",data:we})}catch(we){ie.push({name:le.name,success:!1,status:we.status||"Error",error:we.message||JSON.stringify(we)})}f(ie),u(!1)},pe=[{id:"selector",label:"Select",sortable:!1,width:50,format:(N,ie)=>o.jsx(xf,{checked:y.some(le=>le.id===ie.id),onChange:le=>ne(ie,le.target.checked),size:"small"}),renderHeader:()=>o.jsx(xf,{checked:!!(ye&&ye.length>0&&y.length===ye.length),indeterminate:y.length>0&&y.length<((ye==null?void 0:ye.length)||0),onChange:N=>ee(N.target.checked),size:"small"})},{id:"id",label:"ID",sortable:!0},{id:"studentName",label:"Student Name",sortable:!0},{id:"gradeApplying",label:"Grade",sortable:!0},{id:"parentName",label:"Parent Name",sortable:!0},{id:"submissionDate",label:"Submitted On",sortable:!0,format:Gx},{id:"status",label:"Status",sortable:!0,format:(N,ie)=>o.jsx(bn,{permission:"MANAGE_ADMISSIONS",children:o.jsx(Tt,{size:"small",fullWidth:!0,children:o.jsx(It,{value:N||"PENDING",onChange:le=>_(ie,le.target.value),displayEmpty:!0,variant:"standard",sx:{"& .MuiSelect-select":{py:0,color:()=>{switch(N==null?void 0:N.toUpperCase()){case"APPROVED":return"success.main";case"REJECTED":return"error.main";case"UNDER_REVIEW":return"info.main";case"WAITLISTED":return"warning.dark";default:return"warning.main"}}}},children:fi.map(le=>o.jsx(Xe,{value:le.value,children:le.label},le.value))})})})},uF(N=>V(N),void 0,N=>o.jsx(bn,{permission:"MANAGE_ADMISSIONS",children:o.jsx(at,{title:"Create Student",children:o.jsx(Ze,{size:"small",onClick:()=>fe(N),color:"secondary",children:o.jsx(hd,{fontSize:"small"})})})}))],Ce=()=>o.jsxs(kr,{open:A,onClose:()=>L(!1),maxWidth:"md",fullWidth:!0,children:[o.jsx(Xr,{children:"Filter Admissions"}),o.jsx(Rr,{children:o.jsxs(X,{container:!0,spacing:3,sx:{mt:.5},children:[o.jsx(X,{item:!0,xs:12,children:o.jsx(ke,{label:"Search by Name or Email",fullWidth:!0,value:Y.name,onChange:N=>ae("name",N.target.value),placeholder:"Enter student name, email, or parent name",variant:"outlined"})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsxs(Tt,{fullWidth:!0,children:[o.jsx(Wt,{id:"grade-filter-label",children:"Filter by Grade"}),o.jsx(It,{labelId:"grade-filter-label",multiple:!0,value:Y.grade,onChange:N=>ae("grade",N.target.value),input:o.jsx(gf,{label:"Filter by Grade"}),renderValue:N=>o.jsx(Se,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:N.map(ie=>o.jsx(Yt,{label:`Grade ${ie}`,size:"small"},ie))}),children:dF.map(N=>o.jsx(Xe,{value:N.value,children:N.label},N.value))})]})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsxs(Tt,{fullWidth:!0,children:[o.jsx(Wt,{id:"status-filter-label",children:"Filter by Status"}),o.jsx(It,{labelId:"status-filter-label",multiple:!0,value:Y.status,onChange:N=>ae("status",N.target.value),input:o.jsx(gf,{label:"Filter by Status"}),renderValue:N=>o.jsx(Se,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:N.map(ie=>{var le;return o.jsx(Yt,{label:((le=fi.find(we=>we.value===ie))==null?void 0:le.label)||ie,size:"small"},ie)})}),children:fi.map(N=>o.jsx(Xe,{value:N.value,children:N.label},N.value))})]})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{label:"Date Range From",type:"date",InputLabelProps:{shrink:!0},fullWidth:!0,value:Y.dateRange.start,onChange:N=>ae("dateRange",{...Y.dateRange,start:N.target.value})})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{label:"Date Range To",type:"date",InputLabelProps:{shrink:!0},fullWidth:!0,value:Y.dateRange.end,onChange:N=>ae("dateRange",{...Y.dateRange,end:N.target.value})})})]})}),o.jsxs(Nr,{children:[o.jsx(Me,{onClick:Te,color:"secondary",children:"Clear All Filters"}),o.jsx(Me,{onClick:()=>L(!1),children:"Cancel"}),o.jsx(Me,{onClick:oe,variant:"contained",color:"primary",children:"Apply Filters"})]})]}),Oe=()=>o.jsxs(kr,{open:k,onClose:()=>E(!1),children:[o.jsx(Xr,{children:"Confirm Action"}),o.jsx(Rr,{children:o.jsx(te,{children:T})}),o.jsxs(Nr,{children:[o.jsx(Me,{onClick:()=>E(!1),children:"Cancel"}),o.jsx(Me,{onClick:async()=>{E(!1),await F()},color:"primary",variant:"contained",autoFocus:!0,children:"Confirm"})]})]}),He=()=>o.jsxs(kr,{open:i,onClose:()=>c(!1),maxWidth:"md",fullWidth:!0,children:[o.jsx(Xr,{children:"API Endpoint Diagnostics"}),o.jsxs(Rr,{children:[o.jsx(te,{variant:"body2",gutterBottom:!0,children:"Testing different API endpoints to find which one works with your backend."}),l&&o.jsx(Se,{sx:{display:"flex",justifyContent:"center",my:4},children:o.jsx(ta,{})}),d.length>0&&o.jsx(Ga,{children:d.map((N,ie)=>o.jsxs(Mn.Fragment,{children:[ie>0&&o.jsx(vr,{}),o.jsx(Ya,{children:o.jsx(qa,{primary:`${N.name} - ${N.success?"âœ… Success":"âŒ Failed"} (${N.status})`,secondary:o.jsx(Se,{component:"pre",sx:{mt:1,p:1,bgcolor:"grey.100",borderRadius:1,fontSize:"0.75rem",overflow:"auto",maxHeight:200},children:N.success?JSON.stringify(N.data,null,2):N.error?`Error: ${N.error}`:"No response data"})})})]},ie))}),o.jsxs(Se,{sx:{mt:3},children:[o.jsx(te,{variant:"h6",gutterBottom:!0,children:"Authentication Information"}),o.jsxs(st,{sx:{p:2},children:[o.jsxs(te,{variant:"body2",children:[o.jsx("strong",{children:"User:"})," ",e?JSON.stringify(e):"Not logged in"]}),o.jsxs(te,{variant:"body2",children:[o.jsx("strong",{children:"Token present:"})," ",localStorage.getItem("token")?"Yes":"No"]}),o.jsxs(te,{variant:"body2",children:[o.jsx("strong",{children:"API URL:"})," ",wt.apiUrl]})]})]})]}),o.jsxs(Nr,{children:[o.jsx(Me,{onClick:be,disabled:l,color:"primary",children:"Run API Tests"}),o.jsx(Me,{onClick:()=>c(!1),color:"secondary",children:"Close"})]})]});return U?o.jsx(Rn,{}):me?o.jsxs(Se,{sx:{p:3},children:[o.jsx(Ln,{title:"Error Loading Admissions",message:typeof me=="string"?me:me.message||"Couldn't load admissions data"}),o.jsxs(Se,{sx:{mt:3,display:"flex",gap:2},children:[o.jsx(Me,{variant:"contained",onClick:J,children:"Try Again"}),o.jsx(Me,{variant:"outlined",color:"secondary",onClick:()=>c(!0),children:"Diagnostics"})]}),h&&o.jsxs(st,{elevation:0,variant:"outlined",sx:{p:3,mt:4},children:[o.jsxs(jr,{severity:"error",sx:{mb:2},children:[o.jsxs($i,{children:["HTTP Status: ",h.status||"Unknown"]}),h.message]}),o.jsx(te,{variant:"subtitle1",children:"Debug Information:"}),o.jsx(Se,{component:"pre",sx:{p:2,bgcolor:"grey.100",borderRadius:1,overflowX:"auto"},children:JSON.stringify(h.originalError||h,null,2)}),o.jsxs(Se,{sx:{mt:2},children:[o.jsx(te,{variant:"subtitle2",gutterBottom:!0,children:"Possible Solutions:"}),o.jsxs("ul",{children:[o.jsx("li",{children:"Verify the API endpoint path is correct"}),o.jsx("li",{children:"Check that your user account has permission to access admissions"}),o.jsx("li",{children:"Ensure your authentication token is valid and not expired"}),o.jsx("li",{children:"Verify the backend server is running and accessible"})]})]})]}),He()]}):o.jsxs(Se,{sx:{p:3},children:[o.jsxs(Se,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[o.jsx(te,{variant:"h4",component:"h1",children:"Admission Applications"}),o.jsxs(Se,{sx:{display:"flex",gap:1},children:[o.jsx(at,{title:"Export to CSV",children:o.jsx(Ze,{color:"primary",onClick:ce,disabled:(!D||D.length===0)&&(!ye||ye.length===0),children:o.jsx(Xx,{})})}),o.jsx(at,{title:Q?"Edit Filters":"Filter Applications",children:o.jsx(Ze,{color:Q?"secondary":"default",onClick:()=>L(!0),children:o.jsx(qx,{})})}),Q&&o.jsx(at,{title:"Clear All Filters",children:o.jsx(Ze,{color:"error",onClick:Te,children:o.jsx(Kx,{})})}),o.jsx(Me,{variant:"text",color:"secondary",onClick:()=>c(!0),sx:{ml:1},children:"Debug"}),o.jsx(bn,{permission:"MANAGE_ADMISSIONS",children:o.jsx(Me,{variant:"contained",onClick:B,children:"New Application"})})]})]}),Q&&o.jsxs(st,{sx:{p:1.5,mb:2,bgcolor:"background.default",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[o.jsxs(Se,{sx:{display:"flex",alignItems:"center",flexWrap:"wrap",gap:1},children:[o.jsx(te,{variant:"body2",sx:{fontWeight:"medium",mr:1},children:"Filters:"}),Y.name&&o.jsx(Yt,{label:`Search: "${Y.name}"`,size:"small",onDelete:()=>ae("name",""),color:"primary",variant:"outlined"}),Y.status.length>0&&o.jsx(Yt,{label:`Status: ${Y.status.length} selected`,size:"small",onDelete:()=>ae("status",[]),color:"primary",variant:"outlined"}),Y.grade.length>0&&o.jsx(Yt,{label:`Grade: ${Y.grade.length} selected`,size:"small",onDelete:()=>ae("grade",[]),color:"primary",variant:"outlined"}),(Y.dateRange.start||Y.dateRange.end)&&o.jsx(Yt,{label:`Date Range: ${Y.dateRange.start||"Any"} to ${Y.dateRange.end||"Any"}`,size:"small",onDelete:()=>ae("dateRange",{start:"",end:""}),color:"primary",variant:"outlined"})]}),o.jsxs(te,{variant:"body2",sx:{ml:2,color:"text.secondary"},children:[D.length," record",D.length!==1?"s":""," found"]})]}),y.length>0&&o.jsxs(st,{sx:{p:2,mb:3,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[o.jsxs(Se,{sx:{display:"flex",alignItems:"center"},children:[o.jsxs(te,{variant:"body1",sx:{mr:2},children:[y.length," application(s) selected"]}),o.jsxs(Tt,{size:"small",sx:{minWidth:200,mr:2},children:[o.jsx(Wt,{id:"bulk-status-select-label",children:"Change Status To"}),o.jsx(It,{labelId:"bulk-status-select-label",id:"bulk-status-select",value:S,label:"Change Status To",onChange:se,children:fi.map(N=>o.jsx(Xe,{value:N.value,children:N.label},N.value))})]}),o.jsx(Me,{variant:"contained",onClick:j,disabled:p||y.length===0,children:"Apply Status Change"})]}),o.jsx(Me,{variant:"outlined",onClick:()=>b([]),color:"secondary",children:"Clear Selection"})]}),"      ",o.jsx(_c,{columns:pe,data:D||[],defaultRowsPerPage:10}),He(),Oe(),Ce(),o.jsx(YD,{open:a,onClose:()=>s(!1),onSubmit:W,initialData:t||void 0,loading:p}),g&&o.jsx(qD,{error:g,onClose:()=>v(null)})]})},xn={getAllFeeStructures:async()=>await De.get("/api/fees/structures"),getFeeStructureById:async e=>await De.get(`/api/fees/structures/${e}`),getFeeStructureByGrade:async e=>await De.get(`/api/fees/structures/grade/${e}`),createFeeStructure:async e=>await De.post("/api/fees/structures",e),updateFeeStructure:async(e,r)=>await De.put(`/api/fees/structures/${e}`,r),deleteFeeStructure:async e=>await De.delete(`/api/fees/structures/${e}`),getAllTransportRoutes:async()=>await De.get("/api/fees/transport-routes"),getTransportRouteById:async e=>await De.get(`/api/fees/transport-routes/${e}`),createTransportRoute:async e=>await De.post("/api/fees/transport-routes",e),updateTransportRoute:async(e,r)=>await De.put(`/api/fees/transport-routes/${e}`,r),deleteTransportRoute:async e=>await De.delete(`/api/fees/transport-routes/${e}`),getAllPayments:async()=>await De.get("/api/fees/payments"),getPaymentById:async e=>await De.get(`/api/fees/payments/${e}`),getPaymentsByStudentId:async e=>await De.get(`/api/fees/payments/student/${e}`),getPaymentSummaryByStudent:async e=>await De.get(`/api/fees/payments/summary/student/${e}`),createPayment:async e=>await De.post("/api/fees/payments",e),updatePayment:async(e,r)=>await De.put(`/api/fees/payments/${e}`,r),voidPayment:async(e,r)=>await De.put(`/api/fees/payments/${e}/void`,{reason:r}),getPaymentReceipt:async e=>await De.get(`/api/fees/payments/${e}/receipt`),getPaymentAnalytics:async(e,r)=>{let t="/api/fees/analytics/payments";return e&&r&&(t+=`?startDate=${e}&endDate=${r}`),await De.get(t)},getPaymentDistribution:async e=>{let r="/api/fees/analytics/distribution";return e&&(r+=`?academicYear=${e}`),await De.get(r)},getRevenueTrend:async(e="monthly",r)=>{let t=`/api/fees/analytics/revenue-trend?period=${e}`;return r&&(t+=`&year=${r}`),await De.get(t)},getOverdueAnalytics:async()=>await De.get("/api/fees/analytics/overdue"),getStudentsWithOutstandingFees:async e=>{let r="/api/fees/analytics/outstanding";return e!==void 0&&(r+=`?gradeLevel=${e}`),await De.get(r)},exportPaymentData:async e=>{var r;try{const t=await qn.post(`${wt.apiUrl}/api/payments/export`,e,{responseType:"blob",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}}),n=window.URL.createObjectURL(new Blob([t.data])),a=document.createElement("a");a.href=n,a.setAttribute("download",`Payments-${new Date().toISOString().split("T")[0]}.xlsx`),document.body.appendChild(a),a.click(),(r=a.parentNode)==null||r.removeChild(a)}catch(t){throw console.error("Error exporting payment data:",t),t}},getStudentFeeDetails:async e=>await De.get(`/api/students/${e}/fee-details`),getStudentPaymentHistory:async e=>await De.get(`/api/students/${e}/payment-history`),downloadReceipt:async e=>{var r;try{const t=await qn.get(`${wt.apiUrl}/api/payments/${e}/receipt`,{responseType:"blob",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),n=window.URL.createObjectURL(new Blob([t.data])),a=document.createElement("a");a.href=n,a.setAttribute("download",`Receipt-${e}.pdf`),document.body.appendChild(a),a.click(),(r=a.parentNode)==null||r.removeChild(a)}catch(t){throw console.error("Error downloading receipt:",t),t}}},hF=({transportRoutes:e,onEdit:r,onDelete:t,onRefresh:n})=>!e||e.length===0?o.jsxs(Se,{sx:{p:2,textAlign:"center"},children:[o.jsx(te,{variant:"body1",color:"text.secondary",children:"No transport routes available."}),o.jsx(Ze,{onClick:n,sx:{mt:1},color:"primary",children:o.jsx(Ka,{})})]}):o.jsxs(st,{sx:{width:"100%",overflow:"hidden"},children:[o.jsx(Se,{sx:{display:"flex",justifyContent:"flex-end",p:1},children:o.jsx(at,{title:"Refresh",children:o.jsx(Ze,{onClick:n,children:o.jsx(Ka,{})})})}),o.jsx(zs,{sx:{maxHeight:440},children:o.jsxs(Za,{stickyHeader:!0,"aria-label":"transport routes table",children:[o.jsx(es,{children:o.jsxs(ir,{children:[o.jsx(ze,{children:"ID"}),o.jsx(ze,{children:"Route Name"}),o.jsx(ze,{children:"Description"}),o.jsx(ze,{children:"Fee Amount"}),o.jsx(ze,{children:"Actions"})]})}),o.jsx(ts,{children:e.map(a=>{var s;return o.jsxs(ir,{children:[o.jsx(ze,{children:a.id}),o.jsx(ze,{children:a.routeName}),o.jsx(ze,{children:a.routeDescription}),o.jsxs(ze,{children:["$",(s=a.feeAmount)==null?void 0:s.toFixed(2)]}),o.jsxs(ze,{children:[o.jsx(at,{title:"Edit",children:o.jsx(Ze,{size:"small",onClick:()=>a.id&&r(a.id),children:o.jsx(no,{fontSize:"small"})})}),o.jsx(at,{title:"Delete",children:o.jsx(Ze,{size:"small",onClick:()=>a.id&&t(a.id),children:o.jsx(ei,{fontSize:"small"})})})]})]},a.id)})})]})})]}),pF=({feeStructures:e,onEdit:r,onDelete:t,onRefresh:n})=>!e||e.length===0?o.jsxs(Se,{sx:{p:2,textAlign:"center"},children:[o.jsx(te,{variant:"body1",color:"text.secondary",children:"No fee structures available."}),o.jsx(Ze,{onClick:n,sx:{mt:1},color:"primary",children:o.jsx(Ka,{})})]}):o.jsxs(st,{sx:{width:"100%",overflow:"hidden"},children:[o.jsx(Se,{sx:{display:"flex",justifyContent:"flex-end",p:1},children:o.jsx(at,{title:"Refresh",children:o.jsx(Ze,{onClick:n,children:o.jsx(Ka,{})})})}),o.jsx(zs,{sx:{maxHeight:440},children:o.jsxs(Za,{stickyHeader:!0,"aria-label":"fee structures table",children:[o.jsx(es,{children:o.jsxs(ir,{children:[o.jsx(ze,{children:"ID"}),o.jsx(ze,{children:"Class Grade"}),o.jsx(ze,{children:"Annual Fees"}),o.jsx(ze,{children:"Building Fees"}),o.jsx(ze,{children:"Lab Fees"}),o.jsx(ze,{children:"Total Fees"}),o.jsx(ze,{children:"Actions"})]})}),o.jsx(ts,{children:e.map(a=>{var s,i,c,l;return o.jsxs(ir,{children:[o.jsx(ze,{children:a.id}),o.jsx(ze,{children:a.classGrade}),o.jsxs(ze,{children:["$",(s=a.annualFees)==null?void 0:s.toFixed(2)]}),o.jsxs(ze,{children:["$",(i=a.buildingFees)==null?void 0:i.toFixed(2)]}),o.jsxs(ze,{children:["$",(c=a.labFees)==null?void 0:c.toFixed(2)]}),o.jsxs(ze,{children:["$",(l=a.totalFees)==null?void 0:l.toFixed(2)]}),o.jsxs(ze,{children:[o.jsx(at,{title:"Edit",children:o.jsx(Ze,{size:"small",onClick:()=>a.id&&r(a.id),children:o.jsx(no,{fontSize:"small"})})}),o.jsx(at,{title:"Delete",children:o.jsx(Ze,{size:"small",onClick:()=>a.id&&t(a.id),children:o.jsx(ei,{fontSize:"small"})})})]})]},a.id)})})]})})]});function bl(e){const{children:r,value:t,index:n,...a}=e;return o.jsx("div",{role:"tabpanel",hidden:t!==n,id:`fee-dialog-tabpanel-${n}`,"aria-labelledby":`fee-dialog-tab-${n}`,...a,children:t===n&&o.jsx(Se,{sx:{pt:2},children:r})})}const mF=({open:e,onClose:r,onSubmit:t,initialData:n,loading:a})=>{const s=!!(n!=null&&n.id),[i,c]=C.useState(0),[l,u]=C.useState({classGrade:0,annualFees:0,buildingFees:0,labFees:0,paymentSchedules:[],lateFees:[]}),[d,f]=C.useState({});C.useEffect(()=>{u(n?{id:n.id,classGrade:n.classGrade,annualFees:n.annualFees,buildingFees:n.buildingFees,labFees:n.labFees,paymentSchedules:n.paymentSchedules||[],lateFees:n.lateFees||[],totalFees:n.totalFees}:{classGrade:1,annualFees:0,buildingFees:0,labFees:0,paymentSchedules:[{scheduleType:"MONTHLY",amount:0,isEnabled:!0},{scheduleType:"QUARTERLY",amount:0,isEnabled:!0},{scheduleType:"YEARLY",amount:0,isEnabled:!0}],lateFees:[]}),c(0)},[n,e]);const h=(E,T)=>{c(T)},x=E=>T=>{const w=T.target.type==="number"?Number(T.target.value):T.target.value;u(F=>({...F,[E]:w})),d[E]&&f(F=>({...F,[E]:""}))},p=(E,T,w)=>{const F=[...l.paymentSchedules];F[E]={...F[E],[T]:w},u(P=>({...P,paymentSchedules:F}))},m=(E,T,w)=>{const F=[...l.lateFees];F[E]={...F[E],[T]:w},u(P=>({...P,lateFees:F}))},g=()=>{u(E=>({...E,lateFees:[...E.lateFees,{month:1,lateFeeAmount:0,lateFeeDescription:"",fineAmount:0,fineDescription:""}]}))},v=E=>{const T=[...l.lateFees];T.splice(E,1),u(w=>({...w,lateFees:T}))},y=E=>{const T=l.paymentSchedules.map(w=>{let F=0;switch(w.scheduleType){case"MONTHLY":F=parseFloat((E/12).toFixed(2));break;case"QUARTERLY":F=parseFloat((E/4).toFixed(2));break;case"YEARLY":F=E;break}return{...w,amount:F}});u(w=>({...w,paymentSchedules:T}))},b=E=>{const T=Number(E.target.value);u(w=>({...w,annualFees:T})),y(T)},S=()=>{const E={};return l.classGrade||(E.classGrade="Class/Grade is required"),l.annualFees<0&&(E.annualFees="Annual fees cannot be negative"),l.buildingFees<0&&(E.buildingFees="Building fees cannot be negative"),l.labFees<0&&(E.labFees="Lab fees cannot be negative"),l.paymentSchedules.some(T=>T.isEnabled)||(E.paymentSchedules="At least one payment schedule must be enabled"),f(E),Object.keys(E).length===0},I=()=>{S()&&t(l)},k=E=>["January","February","March","April","May","June","July","August","September","October","November","December"][E-1]||"";return o.jsxs(kr,{open:e,onClose:r,fullWidth:!0,maxWidth:"md","aria-labelledby":"fee-structure-dialog-title",children:[o.jsx(Xr,{id:"fee-structure-dialog-title",children:n?"Edit Fee Structure":"Create Fee Structure"}),o.jsxs(Rr,{children:[o.jsx(Se,{sx:{borderBottom:1,borderColor:"divider",mb:2},children:o.jsxs(Ap,{value:i,onChange:h,"aria-label":"fee structure tabs",children:[o.jsx(Ns,{label:"Basic Information"}),o.jsx(Ns,{label:"Payment Schedules"}),o.jsx(Ns,{label:"Late Fees & Fines"})]})}),o.jsx(bl,{value:i,index:0,children:o.jsxs(X,{container:!0,spacing:3,children:[o.jsx(X,{item:!0,xs:12,sm:4,children:o.jsx(ke,{fullWidth:!0,required:!0,label:"Class/Grade",type:"number",value:l.classGrade,onChange:x("classGrade"),InputProps:{inputProps:{min:1,max:12}},disabled:s,error:!!d.classGrade,helperText:d.classGrade})}),o.jsx(X,{item:!0,xs:12,sm:8,children:o.jsx(ke,{fullWidth:!0,required:!0,label:"Annual Fees",type:"number",value:l.annualFees,onChange:b,InputProps:{startAdornment:o.jsx(Fn,{position:"start",children:"â‚¹"}),inputProps:{min:0}},error:!!d.annualFees,helperText:d.annualFees})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Building Fees",type:"number",value:l.buildingFees,onChange:x("buildingFees"),InputProps:{startAdornment:o.jsx(Fn,{position:"start",children:"â‚¹"}),inputProps:{min:0}},error:!!d.buildingFees,helperText:d.buildingFees})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Lab Fees",type:"number",value:l.labFees,onChange:x("labFees"),InputProps:{startAdornment:o.jsx(Fn,{position:"start",children:"â‚¹"}),inputProps:{min:0}},error:!!d.labFees,helperText:d.labFees})}),o.jsx(X,{item:!0,xs:12,children:o.jsxs(te,{variant:"subtitle1",color:"text.secondary",children:["Total Fees: â‚¹",(Number(l.annualFees)+Number(l.buildingFees)+Number(l.labFees)).toLocaleString()]})})]})}),o.jsxs(bl,{value:i,index:1,children:[o.jsx(te,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Configure payment schedules and amounts. Enable or disable payment options as needed."}),d.paymentSchedules&&o.jsx(rs,{error:!0,children:d.paymentSchedules}),o.jsx(X,{container:!0,spacing:3,sx:{mt:1},children:l.paymentSchedules.map((E,T)=>o.jsx(X,{item:!0,xs:12,children:o.jsx(Ja,{variant:"outlined",children:o.jsx(Qa,{children:o.jsxs(X,{container:!0,spacing:2,alignItems:"center",children:[o.jsx(X,{item:!0,xs:12,sm:3,children:o.jsxs(te,{variant:"subtitle1",children:[E.scheduleType.charAt(0)+E.scheduleType.slice(1).toLowerCase()," Payment"]})}),o.jsx(X,{item:!0,xs:12,sm:5,children:o.jsx(ke,{fullWidth:!0,label:"Amount",type:"number",value:E.amount,onChange:w=>p(T,"amount",Number(w.target.value)),InputProps:{startAdornment:o.jsx(Fn,{position:"start",children:"â‚¹"}),inputProps:{min:0}}})}),o.jsx(X,{item:!0,xs:12,sm:4,children:o.jsx(jl,{control:o.jsx(Rl,{checked:E.isEnabled,onChange:w=>p(T,"isEnabled",w.target.checked),color:"primary"}),label:"Enable this payment option"})})]})})})},T))})]}),o.jsxs(bl,{value:i,index:2,children:[o.jsxs(Se,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[o.jsx(te,{variant:"subtitle1",children:"Define late fees and fines for specific months"}),o.jsx(Me,{variant:"outlined",startIcon:o.jsx(Gs,{}),onClick:g,children:"Add Late Fee"})]}),l.lateFees.length===0?o.jsx(te,{variant:"body2",color:"text.secondary",sx:{my:4,textAlign:"center"},children:'No late fees or fines defined. Click "Add Late Fee" to create one.'}):l.lateFees.map((E,T)=>o.jsxs(Ja,{variant:"outlined",sx:{mb:2},children:[o.jsx(Mv,{title:`Late Fee for ${k(E.month)}`,action:o.jsx(Ze,{onClick:()=>v(T),color:"error",size:"small",children:o.jsx(ei,{})})}),o.jsx(Qa,{children:o.jsxs(X,{container:!0,spacing:2,children:[o.jsx(X,{item:!0,xs:12,sm:4,children:o.jsxs(Tt,{fullWidth:!0,children:[o.jsx(Wt,{children:"Month"}),o.jsx(It,{value:E.month,label:"Month",onChange:w=>m(T,"month",w.target.value),children:Array.from({length:12},(w,F)=>F+1).map(w=>o.jsx(Xe,{value:w,children:k(w)},w))})]})}),o.jsx(X,{item:!0,xs:12,sm:4,children:o.jsx(ke,{fullWidth:!0,label:"Late Fee Amount",type:"number",value:E.lateFeeAmount,onChange:w=>m(T,"lateFeeAmount",Number(w.target.value)),InputProps:{startAdornment:o.jsx(Fn,{position:"start",children:"â‚¹"}),inputProps:{min:0}}})}),o.jsx(X,{item:!0,xs:12,sm:4,children:o.jsx(ke,{fullWidth:!0,label:"Fine Amount",type:"number",value:E.fineAmount,onChange:w=>m(T,"fineAmount",Number(w.target.value)),InputProps:{startAdornment:o.jsx(Fn,{position:"start",children:"â‚¹"}),inputProps:{min:0}}})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Late Fee Description",value:E.lateFeeDescription,onChange:w=>m(T,"lateFeeDescription",w.target.value)})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Fine Description",value:E.fineDescription,onChange:w=>m(T,"fineDescription",w.target.value)})})]})})]},T))]})]}),o.jsxs(Nr,{children:[o.jsx(Me,{onClick:r,children:"Cancel"}),o.jsx(Me,{onClick:I,variant:"contained",color:"primary",disabled:a,children:a?"Saving...":s?"Update":"Create"})]})]})},xF=({open:e,onClose:r,onSubmit:t,initialData:n,loading:a})=>{const s=!!(n!=null&&n.id),[i,c]=C.useState({routeName:"",routeDescription:"",feeAmount:0}),[l,u]=C.useState({});C.useEffect(()=>{c(n?{id:n.id,routeName:n.routeName,routeDescription:n.routeDescription,feeAmount:n.feeAmount}:{routeName:"",routeDescription:"",feeAmount:0})},[n,e]);const d=x=>p=>{const m=x==="feeAmount"?Number(p.target.value):p.target.value;c(g=>({...g,[x]:m})),l[x]&&u(g=>({...g,[x]:""}))},f=()=>{const x={};return i.routeName.trim()||(x.routeName="Route name is required"),i.feeAmount<0&&(x.feeAmount="Fee amount cannot be negative"),u(x),Object.keys(x).length===0},h=()=>{f()&&t(i)};return o.jsxs(kr,{open:e,onClose:r,fullWidth:!0,maxWidth:"sm","aria-labelledby":"transport-route-dialog-title",children:[o.jsx(Xr,{id:"transport-route-dialog-title",children:n?"Edit Transport Route":"Create Transport Route"}),o.jsx(Rr,{children:o.jsxs(X,{container:!0,spacing:3,sx:{mt:.5},children:[o.jsx(X,{item:!0,xs:12,children:o.jsx(ke,{fullWidth:!0,required:!0,label:"Route Name",value:i.routeName,onChange:d("routeName"),error:!!l.routeName,helperText:l.routeName})}),o.jsx(X,{item:!0,xs:12,children:o.jsx(ke,{fullWidth:!0,label:"Route Description",multiline:!0,rows:2,value:i.routeDescription,onChange:d("routeDescription")})}),o.jsx(X,{item:!0,xs:12,children:o.jsx(ke,{fullWidth:!0,required:!0,label:"Fee Amount",type:"number",value:i.feeAmount,onChange:d("feeAmount"),InputProps:{startAdornment:o.jsx(Fn,{position:"start",children:"â‚¹"}),inputProps:{min:0}},error:!!l.feeAmount,helperText:l.feeAmount})})]})}),o.jsxs(Nr,{children:[o.jsx(Me,{onClick:r,children:"Cancel"}),o.jsx(Me,{onClick:h,variant:"contained",color:"primary",disabled:a,children:a?"Saving...":s?"Update":"Create"})]})]})};function gF(e,...r){const t=new URL(`https://mui.com/production-error/?code=${e}`);return r.forEach(n=>t.searchParams.append("args[]",n)),`Minified MUI error #${e}; visit ${t} for the full message.`}const vF=ve.oneOfType([ve.func,ve.object]),Jx=vF;function yF(e){if(typeof e!="string")throw new Error(gF(7));return e.charAt(0).toUpperCase()+e.slice(1)}function wl(e){return e&&e.ownerDocument||document}const bF=typeof window<"u"?C.useLayoutEffect:C.useEffect,$n=bF;let Z0=0;function wF(e){const[r,t]=C.useState(e),n=e||r;return C.useEffect(()=>{r==null&&(Z0+=1,t(`mui-${Z0}`))},[r]),n}const SF={...ey},eh=SF.useId;function Rc(e){if(eh!==void 0){const r=eh();return e??r}return wF(e)}function Ks(e){const{controlled:r,default:t,name:n,state:a="value"}=e,{current:s}=C.useRef(r!==void 0),[i,c]=C.useState(t),l=s?r:i,u=C.useCallback(d=>{s||c(d)},[]);return[l,u]}function $e(e){const r=C.useRef(e);return $n(()=>{r.current=e}),C.useRef((...t)=>(0,r.current)(...t)).current}function Lr(...e){const r=C.useRef(void 0),t=C.useCallback(n=>{const a=e.map(s=>{if(s==null)return null;if(typeof s=="function"){const i=s,c=i(n);return typeof c=="function"?c:()=>{i(null)}}return s.current=n,()=>{s.current=null}});return()=>{a.forEach(s=>s==null?void 0:s())}},e);return C.useMemo(()=>e.every(n=>n==null)?null:n=>{r.current&&(r.current(),r.current=void 0),n!=null&&(r.current=t(n))},e)}const th={};function EF(e,r){const t=C.useRef(th);return t.current===th&&(t.current=e(r)),t}const TF=[];function kF(e){C.useEffect(e,TF)}class gd{constructor(){Ne(this,"currentId",null);Ne(this,"clear",()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)});Ne(this,"disposeEffect",()=>this.clear)}static create(){return new gd}start(r,t){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,t()},r)}}function $s(){const e=EF(gd.create).current;return kF(e.disposeEffect),e}const AF={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:"1px"},CF=AF;function jt(e,r,t=void 0){const n={};for(const a in e){const s=e[a];let i="",c=!0;for(let l=0;l<s.length;l+=1){const u=s[l];u&&(i+=(c===!0?"":" ")+r(u),c=!1,t&&t[u]&&(i+=" "+t[u]))}n[a]=i}return n}const rh=e=>e,_F=()=>{let e=rh;return{configure(r){e=r},generate(r){return e(r)},reset(){e=rh}}},DF=_F(),FF=DF,IF={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function zt(e,r,t="Mui"){const n=IF[r];return n?`${t}-${n}`:`${FF.generate(e)}-${r}`}function Jt(e,r,t="Mui"){const n={};return r.forEach(a=>{n[a]=zt(e,a,t)}),n}function PF(e){return typeof e=="string"}function OF(e,r,t){return e===void 0||PF(e)?r:{...r,ownerState:{...r.ownerState,...t}}}function jF(e,r=[]){if(e===void 0)return{};const t={};return Object.keys(e).filter(n=>n.match(/^on[A-Z]/)&&typeof e[n]=="function"&&!r.includes(n)).forEach(n=>{t[n]=e[n]}),t}function nh(e){if(e===void 0)return{};const r={};return Object.keys(e).filter(t=>!(t.match(/^on[A-Z]/)&&typeof e[t]=="function")).forEach(t=>{r[t]=e[t]}),r}function RF(e){const{getSlotProps:r,additionalProps:t,externalSlotProps:n,externalForwardedProps:a,className:s}=e;if(!r){const x=Xt(t==null?void 0:t.className,s,a==null?void 0:a.className,n==null?void 0:n.className),p={...t==null?void 0:t.style,...a==null?void 0:a.style,...n==null?void 0:n.style},m={...t,...a,...n};return x.length>0&&(m.className=x),Object.keys(p).length>0&&(m.style=p),{props:m,internalRef:void 0}}const i=jF({...a,...n}),c=nh(n),l=nh(a),u=r(i),d=Xt(u==null?void 0:u.className,t==null?void 0:t.className,s,a==null?void 0:a.className,n==null?void 0:n.className),f={...u==null?void 0:u.style,...t==null?void 0:t.style,...a==null?void 0:a.style,...n==null?void 0:n.style},h={...u,...t,...l,...c};return d.length>0&&(h.className=d),Object.keys(f).length>0&&(h.style=f),{props:h,internalRef:u.ref}}function Ki(e,r,t){return typeof e=="function"?e(r,t):e}function ht(e){var f;const{elementType:r,externalSlotProps:t,ownerState:n,skipResolvingSlotProps:a=!1,...s}=e,i=a?{}:Ki(t,n),{props:c,internalRef:l}=RF({...s,externalSlotProps:i}),u=Lr(l,i==null?void 0:i.ref,(f=e.additionalProps)==null?void 0:f.ref);return OF(r,{...c,ref:u},n)}const NF=["localeText"],eu=C.createContext(null),Qx=function(r){const{localeText:t}=r,n=Je(r,NF),{utils:a,localeText:s}=C.useContext(eu)??{utils:void 0,localeText:void 0},i=Ct({props:n,name:"MuiLocalizationProvider"}),{children:c,dateAdapter:l,dateFormats:u,dateLibInstance:d,adapterLocale:f,localeText:h}=i,x=C.useMemo(()=>re({},h,s,t),[h,s,t]),p=C.useMemo(()=>{if(!l)return a||null;const v=new l({locale:f,formats:u,instance:d});if(!v.isMUIAdapter)throw new Error(["MUI X: The date adapter should be imported from `@mui/x-date-pickers` or `@mui/x-date-pickers-pro`, not from `@date-io`","For example, `import { AdapterDayjs } from '@mui/x-date-pickers/AdapterDayjs'` instead of `import AdapterDayjs from '@date-io/dayjs'`","More information on the installation documentation: https://mui.com/x/react-date-pickers/quickstart/#installation"].join(`
`));return v},[l,f,u,d,a]),m=C.useMemo(()=>p?{minDate:p.date("1900-01-01T00:00:00.000"),maxDate:p.date("2099-12-31T00:00:00.000")}:null,[p]),g=C.useMemo(()=>({utils:p,defaultDates:m,localeText:x}),[m,p,x]);return o.jsx(eu.Provider,{value:g,children:c})},MF=e=>({components:{MuiLocalizationProvider:{defaultProps:{localeText:re({},e)}}}}),Zx={previousMonth:"Previous month",nextMonth:"Next month",openPreviousView:"Open previous view",openNextView:"Open next view",calendarViewSwitchingButtonAriaLabel:e=>e==="year"?"year view is open, switch to calendar view":"calendar view is open, switch to year view",start:"Start",end:"End",startDate:"Start date",startTime:"Start time",endDate:"End date",endTime:"End time",cancelButtonLabel:"Cancel",clearButtonLabel:"Clear",okButtonLabel:"OK",todayButtonLabel:"Today",nextStepButtonLabel:"Next",datePickerToolbarTitle:"Select date",dateTimePickerToolbarTitle:"Select date & time",timePickerToolbarTitle:"Select time",dateRangePickerToolbarTitle:"Select date range",timeRangePickerToolbarTitle:"Select time range",clockLabelText:(e,r)=>`Select ${e}. ${r?`Selected time is ${r}`:"No time selected"}`,hoursClockNumberText:e=>`${e} hours`,minutesClockNumberText:e=>`${e} minutes`,secondsClockNumberText:e=>`${e} seconds`,selectViewText:e=>`Select ${e}`,calendarWeekNumberHeaderLabel:"Week number",calendarWeekNumberHeaderText:"#",calendarWeekNumberAriaLabelText:e=>`Week ${e}`,calendarWeekNumberText:e=>`${e}`,openDatePickerDialogue:e=>e?`Choose date, selected date is ${e}`:"Choose date",openTimePickerDialogue:e=>e?`Choose time, selected time is ${e}`:"Choose time",openRangePickerDialogue:e=>e?`Choose range, selected range is ${e}`:"Choose range",fieldClearLabel:"Clear",timeTableLabel:"pick time",dateTableLabel:"pick date",fieldYearPlaceholder:e=>"Y".repeat(e.digitAmount),fieldMonthPlaceholder:e=>e.contentType==="letter"?"MMMM":"MM",fieldDayPlaceholder:()=>"DD",fieldWeekDayPlaceholder:e=>e.contentType==="letter"?"EEEE":"EE",fieldHoursPlaceholder:()=>"hh",fieldMinutesPlaceholder:()=>"mm",fieldSecondsPlaceholder:()=>"ss",fieldMeridiemPlaceholder:()=>"aa",year:"Year",month:"Month",day:"Day",weekDay:"Week day",hours:"Hours",minutes:"Minutes",seconds:"Seconds",meridiem:"Meridiem",empty:"Empty"},LF=Zx;MF(Zx);const ms=()=>{const e=C.useContext(eu);if(e===null)throw new Error(["MUI X: Can not find the date and time pickers localization context.","It looks like you forgot to wrap your component in LocalizationProvider.","This can also happen if you are bundling multiple versions of the `@mui/x-date-pickers` package"].join(`
`));if(e.utils===null)throw new Error(["MUI X: Can not find the date and time pickers adapter from its localization context.","It looks like you forgot to pass a `dateAdapter` to your LocalizationProvider."].join(`
`));const r=C.useMemo(()=>re({},LF,e.localeText),[e.localeText]);return C.useMemo(()=>re({},e,{localeText:r}),[e,r])},yt=()=>ms().utils,BF=()=>ms().defaultDates,Nc=e=>{const r=yt(),t=C.useRef(void 0);return t.current===void 0&&(t.current=r.date(void 0,e)),t.current},wa=()=>ms().localeText,$F=ya(o.jsx("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),UF=ya(o.jsx("path",{d:"M15.41 16.59L10.83 12l4.58-4.59L14 6l-6 6 6 6 1.41-1.41z"}),"ArrowLeft"),VF=ya(o.jsx("path",{d:"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"}),"ArrowRight"),WF=ya(o.jsx("path",{d:"M17 12h-5v5h5v-5zM16 1v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-1V1h-2zm3 18H5V8h14v11z"}),"Calendar");ya(o.jsxs(C.Fragment,{children:[o.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),o.jsx("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"})]}),"Clock");ya(o.jsx("path",{d:"M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z"}),"DateRange");ya(o.jsxs(C.Fragment,{children:[o.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),o.jsx("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"})]}),"Time");const HF=ya(o.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Clear");function zF(e){return zt("MuiPickersArrowSwitcher",e)}Jt("MuiPickersArrowSwitcher",["root","spacer","button","previousIconButton","nextIconButton","leftArrowIcon","rightArrowIcon"]);const eg=C.createContext(()=>!0);function GF(){return C.useContext(eg)}const tg=C.createContext(null);function rg(){return C.useContext(tg)}const vd=C.createContext(null),ii=()=>{const e=C.useContext(vd);if(e==null)throw new Error("MUI X: The `usePickerContext` hook can only be called inside the context of a Picker component");return e},ng=C.createContext(null),ag=C.createContext({ownerState:{isPickerDisabled:!1,isPickerReadOnly:!1,isPickerValueEmpty:!1,isPickerOpen:!1,pickerVariant:"desktop",pickerOrientation:"portrait"},rootRefObject:{current:null},labelId:void 0,dismissViews:()=>{},hasUIView:!0,getCurrentViewMode:()=>"UI",triggerElement:null,viewContainerRole:null,defaultActionBarActions:[],onPopperExited:void 0});function sg(e){const{contextValue:r,actionsContextValue:t,privateContextValue:n,fieldPrivateContextValue:a,isValidContextValue:s,localeText:i,children:c}=e;return o.jsx(vd.Provider,{value:r,children:o.jsx(ng.Provider,{value:t,children:o.jsx(ag.Provider,{value:n,children:o.jsx(tg.Provider,{value:a,children:o.jsx(eg.Provider,{value:s,children:o.jsx(Qx,{localeText:i,children:c})})})})})})}const lr=()=>C.useContext(ag),YF=["children","className","slots","slotProps","isNextDisabled","isNextHidden","onGoToNext","nextLabel","isPreviousDisabled","isPreviousHidden","onGoToPrevious","previousLabel","labelId","classes"],qF=["ownerState"],XF=["ownerState"],KF=Ge("div",{name:"MuiPickersArrowSwitcher",slot:"Root"})({display:"flex"}),JF=Ge("div",{name:"MuiPickersArrowSwitcher",slot:"Spacer"})(({theme:e})=>({width:e.spacing(3)})),ah=Ge(Ze,{name:"MuiPickersArrowSwitcher",slot:"Button"})({variants:[{props:{isButtonHidden:!0},style:{visibility:"hidden"}}]}),QF=e=>jt({root:["root"],spacer:["spacer"],button:["button"],previousIconButton:["previousIconButton"],nextIconButton:["nextIconButton"],leftArrowIcon:["leftArrowIcon"],rightArrowIcon:["rightArrowIcon"]},zF,e),ZF=C.forwardRef(function(r,t){const n=ra(),a=Ct({props:r,name:"MuiPickersArrowSwitcher"}),{children:s,className:i,slots:c,slotProps:l,isNextDisabled:u,isNextHidden:d,onGoToNext:f,nextLabel:h,isPreviousDisabled:x,isPreviousHidden:p,onGoToPrevious:m,previousLabel:g,labelId:v,classes:y}=a,b=Je(a,YF),{ownerState:S}=lr(),I=QF(y),k={isDisabled:u,isHidden:d,goTo:f,label:h},E={isDisabled:x,isHidden:p,goTo:m,label:g},T=(c==null?void 0:c.previousIconButton)??ah,w=ht({elementType:T,externalSlotProps:l==null?void 0:l.previousIconButton,additionalProps:{size:"medium",title:E.label,"aria-label":E.label,disabled:E.isDisabled,edge:"end",onClick:E.goTo},ownerState:re({},S,{isButtonHidden:E.isHidden??!1}),className:Xt(I.button,I.previousIconButton)}),F=(c==null?void 0:c.nextIconButton)??ah,P=ht({elementType:F,externalSlotProps:l==null?void 0:l.nextIconButton,additionalProps:{size:"medium",title:k.label,"aria-label":k.label,disabled:k.isDisabled,edge:"start",onClick:k.goTo},ownerState:re({},S,{isButtonHidden:k.isHidden??!1}),className:Xt(I.button,I.nextIconButton)}),A=(c==null?void 0:c.leftArrowIcon)??UF,L=ht({elementType:A,externalSlotProps:l==null?void 0:l.leftArrowIcon,additionalProps:{fontSize:"inherit"},ownerState:S,className:I.leftArrowIcon}),Y=Je(L,qF),q=(c==null?void 0:c.rightArrowIcon)??VF,Q=ht({elementType:q,externalSlotProps:l==null?void 0:l.rightArrowIcon,additionalProps:{fontSize:"inherit"},ownerState:S,className:I.rightArrowIcon}),K=Je(Q,XF);return o.jsxs(KF,re({ref:t,className:Xt(I.root,i),ownerState:S},b,{children:[o.jsx(T,re({},w,{children:n?o.jsx(q,re({},K)):o.jsx(A,re({},Y))})),s?o.jsx(te,{variant:"subtitle1",component:"span",id:v,children:s}):o.jsx(JF,{className:I.spacer,ownerState:S}),o.jsx(F,re({},P,{children:n?o.jsx(A,re({},Y)):o.jsx(q,re({},K))}))]}))}),hi=(e,r)=>e.length!==r.length?!1:r.every(t=>e.includes(t)),eI=({openTo:e,defaultOpenTo:r,views:t,defaultViews:n})=>{const a=t??n;let s;if(e!=null)s=e;else if(a.includes(r))s=r;else if(a.length>0)s=a[0];else throw new Error("MUI X: The `views` prop must contain at least one view.");return{views:a,openTo:s}},tI=["hours","minutes","seconds"],rI=e=>tI.includes(e),sh=(e,r)=>r.getHours(e)*3600+r.getMinutes(e)*60+r.getSeconds(e),nI=(e,r)=>(t,n)=>e?r.isAfter(t,n):sh(t,r)>sh(n,r),ig={hasNextStep:!1,hasSeveralSteps:!1,goToNextStep:()=>{},areViewsInSameStep:()=>!0};function aI(e){const{steps:r,isViewMatchingStep:t,onStepChange:n}=e;return a=>{if(r==null)return ig;const s=r.findIndex(c=>t(a.view,c)),i=s===-1||s===r.length-1?null:r[s+1];return{hasNextStep:i!=null,hasSeveralSteps:r.length>1,goToNextStep:()=>{i!=null&&n(re({},a,{step:i}))},areViewsInSameStep:(c,l)=>{const u=r.find(f=>t(c,f)),d=r.find(f=>t(l,f));return u===d}}}}function og({onChange:e,onViewChange:r,openTo:t,view:n,views:a,autoFocus:s,focusedView:i,onFocusedViewChange:c,getStepNavigation:l}){const u=C.useRef(t),d=C.useRef(a),f=C.useRef(a.includes(t)?t:a[0]),[h,x]=Ks({name:"useViews",state:"view",controlled:n,default:f.current}),p=C.useRef(s?h:null),[m,g]=Ks({name:"useViews",state:"focusedView",controlled:i,default:p.current}),v=l?l({setView:x,view:h,defaultView:f.current,views:a}):ig;C.useEffect(()=>{(u.current&&u.current!==t||d.current&&d.current.some(w=>!a.includes(w)))&&(x(a.includes(t)?t:a[0]),d.current=a,u.current=t)},[t,x,h,a]);const y=a.indexOf(h),b=a[y-1]??null,S=a[y+1]??null,I=$e((w,F)=>{g(F?w:P=>w===P?null:P),c==null||c(w,F)}),k=$e(w=>{I(w,!0),w!==h&&(x(w),r&&r(w))}),E=$e(()=>{S&&k(S)}),T=$e((w,F,P)=>{const A=F==="finish",L=P?a.indexOf(P)<a.length-1:!!S;e(w,A&&L?"partial":F,P);let q=null;if(P!=null&&P!==h?q=P:A&&(q=h),q==null)return;const Q=a[a.indexOf(q)+1];Q==null||!v.areViewsInSameStep(q,Q)||k(Q)});return re({},v,{view:h,setView:k,focusedView:m,setFocusedView:I,nextView:S,previousView:b,defaultView:a.includes(t)?t:a[0],goToNextView:E,setValueAndGoToNextView:T})}function sI(e,{disableFuture:r,maxDate:t,timezone:n}){const a=yt();return C.useMemo(()=>{const s=a.date(void 0,n),i=a.startOfMonth(r&&a.isBefore(s,t)?s:t);return!a.isAfter(i,e)},[r,t,e,a,n])}function iI(e,{disablePast:r,minDate:t,timezone:n}){const a=yt();return C.useMemo(()=>{const s=a.date(void 0,n),i=a.startOfMonth(r&&a.isAfter(s,t)?s:t);return!a.isBefore(i,e)},[r,t,e,a,n])}const Ji=36,Mc=2,Lc=320,oI=280,yd=336,cI=Ge("div")({overflow:"hidden",width:Lc,maxHeight:yd,display:"flex",flexDirection:"column",margin:"0 auto"}),uc=(e,r,t)=>{let n=r;return n=e.setHours(n,e.getHours(t)),n=e.setMinutes(n,e.getMinutes(t)),n=e.setSeconds(n,e.getSeconds(t)),n=e.setMilliseconds(n,e.getMilliseconds(t)),n},Qi=({date:e,disableFuture:r,disablePast:t,maxDate:n,minDate:a,isDateDisabled:s,utils:i,timezone:c})=>{const l=uc(i,i.date(void 0,c),e);t&&i.isBefore(a,l)&&(a=l),r&&i.isAfter(n,l)&&(n=l);let u=e,d=e;for(i.isBefore(e,a)&&(u=a,d=null),i.isAfter(e,n)&&(d&&(d=n),u=null);u||d;){if(u&&i.isAfter(u,n)&&(u=null),d&&i.isBefore(d,a)&&(d=null),u){if(!s(u))return u;u=i.addDays(u,1)}if(d){if(!s(d))return d;d=i.addDays(d,-1)}}return null},lI=(e,r)=>e.isValid(r)?r:null,ih=(e,r,t)=>r==null||!e.isValid(r)?t:r,uI=(e,r,t)=>!e.isValid(r)&&r!=null&&!e.isValid(t)&&t!=null?!0:e.isEqual(r,t),bd=(e,r)=>{const n=[e.startOfYear(r)];for(;n.length<12;){const a=n[n.length-1];n.push(e.addMonths(a,1))}return n},cg=(e,r,t)=>t==="date"?e.startOfDay(e.date(void 0,r)):e.date(void 0,r),dI=["year","month","day"],oh=e=>dI.includes(e),wd=(e,{format:r,views:t},n)=>{if(r!=null)return r;const a=e.formats;return hi(t,["year"])?a.year:hi(t,["month"])?a.month:hi(t,["day"])?a.dayOfMonth:hi(t,["month","year"])?`${a.month} ${a.year}`:hi(t,["day","month"])?`${a.month} ${a.dayOfMonth}`:n?/en/.test(e.getCurrentLocaleCode())?a.normalDateWithWeekday:a.normalDate:a.keyboardDate},fI=(e,r)=>{const t=e.startOfWeek(r);return[0,1,2,3,4,5,6].map(n=>e.addDays(t,n))},po=({name:e,timezone:r,value:t,defaultValue:n,referenceDate:a,onChange:s,valueManager:i})=>{const c=yt(),[l,u]=Ks({name:e,state:"value",controlled:t,default:n??i.emptyValue}),d=C.useMemo(()=>i.getTimezone(c,l),[c,i,l]),f=$e(m=>d==null?m:i.setTimezone(c,d,m)),h=C.useMemo(()=>r||d||(a?c.getTimezone(a):"default"),[r,d,a,c]),x=C.useMemo(()=>i.setTimezone(c,h,l),[i,c,h,l]),p=$e((m,...g)=>{const v=f(m);u(v),s==null||s(v,...g)});return{value:x,handleValueChange:p,timezone:h}},Pn={year:1,month:2,day:3,hours:4,minutes:5,seconds:6,milliseconds:7},hI=e=>Math.max(...e.map(r=>Pn[r.type]??1)),pi=(e,r,t)=>{if(r===Pn.year)return e.startOfYear(t);if(r===Pn.month)return e.startOfMonth(t);if(r===Pn.day)return e.startOfDay(t);let n=t;return r<Pn.minutes&&(n=e.setMinutes(n,0)),r<Pn.seconds&&(n=e.setSeconds(n,0)),r<Pn.milliseconds&&(n=e.setMilliseconds(n,0)),n},pI=({props:e,utils:r,granularity:t,timezone:n,getTodayDate:a})=>{let s=a?a():pi(r,t,cg(r,n));e.minDate!=null&&r.isAfterDay(e.minDate,s)&&(s=pi(r,t,e.minDate)),e.maxDate!=null&&r.isBeforeDay(e.maxDate,s)&&(s=pi(r,t,e.maxDate));const i=nI(e.disableIgnoringDatePartForTimeValidation??!1,r);return e.minTime!=null&&i(e.minTime,s)&&(s=pi(r,t,e.disableIgnoringDatePartForTimeValidation?e.minTime:uc(r,s,e.minTime))),e.maxTime!=null&&i(s,e.maxTime)&&(s=pi(r,t,e.disableIgnoringDatePartForTimeValidation?e.maxTime:uc(r,s,e.maxTime))),s},lg=(e,r)=>{const t=e.formatTokenMap[r];if(t==null)throw new Error([`MUI X: The token "${r}" is not supported by the Date and Time Pickers.`,"Please try using another token or open an issue on https://github.com/mui/mui-x/issues/new/choose if you think it should be supported."].join(`
`));return typeof t=="string"?{type:t,contentType:t==="meridiem"?"letter":"digit",maxLength:void 0}:{type:t.sectionType,contentType:t.contentType,maxLength:t.maxLength}},Bc=(e,r)=>{const t=[],n=e.date(void 0,"default"),a=e.startOfWeek(n),s=e.endOfWeek(n);let i=a;for(;e.isBefore(i,s);)t.push(i),i=e.addDays(i,1);return t.map(c=>e.formatByString(c,r))},ug=(e,r,t,n)=>{switch(t){case"month":return bd(e,e.date(void 0,r)).map(a=>e.formatByString(a,n));case"weekDay":return Bc(e,n);case"meridiem":{const a=e.date(void 0,r);return[e.startOfDay(a),e.endOfDay(a)].map(s=>e.formatByString(s,n))}default:return[]}},ch="s",mI=["0","1","2","3","4","5","6","7","8","9"],xI=e=>{const r=e.date(void 0);return e.formatByString(e.setSeconds(r,0),ch)==="0"?mI:Array.from({length:10}).map((n,a)=>e.formatByString(e.setSeconds(r,a),ch))},os=(e,r)=>{if(r[0]==="0")return e;const t=[];let n="";for(let a=0;a<e.length;a+=1){n+=e[a];const s=r.indexOf(n);s>-1&&(t.push(s.toString()),n="")}return t.join("")},Sd=(e,r)=>r[0]==="0"?e:e.split("").map(t=>r[Number(t)]).join(""),lh=(e,r)=>{const t=os(e,r);return t!==" "&&!Number.isNaN(Number(t))},Ed=(e,r)=>Number(e).toString().padStart(r,"0"),dg=(e,r,t,n,a)=>{if(a.type==="day"&&a.contentType==="digit-with-letter"){const i=e.setDate(t.longestMonth,r);return e.formatByString(i,a.format)}let s=r.toString();return a.hasLeadingZerosInInput&&(s=Ed(s,a.maxLength)),Sd(s,n)},Td=(e,r,t)=>{let n=e.value||e.placeholder;const a=r==="non-input"?e.hasLeadingZerosInFormat:e.hasLeadingZerosInInput;return r==="non-input"&&e.hasLeadingZerosInInput&&!e.hasLeadingZerosInFormat&&(n=Number(os(n,t)).toString()),["input-rtl","input-ltr"].includes(r)&&e.contentType==="digit"&&!a&&n.length===1&&(n=`${n}â€Ž`),r==="input-rtl"&&(n=`â¨${n}â©`),n},uh=(e,r,t,n)=>e.formatByString(e.parse(r,t),n),gI=(e,r)=>e.formatByString(e.date(void 0,"system"),r).length===4,fg=(e,r,t,n)=>{if(r!=="digit")return!1;const a=e.date(void 0,"default");switch(t){case"year":return e.lib==="dayjs"&&n==="YY"?!0:e.formatByString(e.setYear(a,1),n).startsWith("0");case"month":return e.formatByString(e.startOfYear(a),n).length>1;case"day":return e.formatByString(e.startOfMonth(a),n).length>1;case"weekDay":return e.formatByString(e.startOfWeek(a),n).length>1;case"hours":return e.formatByString(e.setHours(a,1),n).length>1;case"minutes":return e.formatByString(e.setMinutes(a,1),n).length>1;case"seconds":return e.formatByString(e.setSeconds(a,1),n).length>1;default:throw new Error("Invalid section type")}},vI=(e,r,t)=>{const n=r.some(l=>l.type==="day"),a=[],s=[];for(let l=0;l<r.length;l+=1){const u=r[l];n&&u.type==="weekDay"||(a.push(u.format),s.push(Td(u,"non-input",t)))}const i=a.join(" "),c=s.join(" ");return e.parse(c,i)},yI=e=>e.map(r=>`${r.startSeparator}${r.value||r.placeholder}${r.endSeparator}`).join(""),bI=(e,r,t)=>{const a=e.map(s=>{const i=Td(s,t?"input-rtl":"input-ltr",r);return`${s.startSeparator}${i}${s.endSeparator}`}).join("");return t?`â¦${a}â©`:a},wI=(e,r,t)=>{const n=e.date(void 0,t),a=e.endOfYear(n),s=e.endOfDay(n),{maxDaysInMonth:i,longestMonth:c}=bd(e,n).reduce((l,u)=>{const d=e.getDaysInMonth(u);return d>l.maxDaysInMonth?{maxDaysInMonth:d,longestMonth:u}:l},{maxDaysInMonth:0,longestMonth:null});return{year:({format:l})=>({minimum:0,maximum:gI(e,l)?9999:99}),month:()=>({minimum:1,maximum:e.getMonth(a)+1}),day:({currentDate:l})=>({minimum:1,maximum:e.isValid(l)?e.getDaysInMonth(l):i,longestMonth:c}),weekDay:({format:l,contentType:u})=>{if(u==="digit"){const d=Bc(e,l).map(Number);return{minimum:Math.min(...d),maximum:Math.max(...d)}}return{minimum:1,maximum:7}},hours:({format:l})=>{const u=e.getHours(s);return os(e.formatByString(e.endOfDay(n),l),r)!==u.toString()?{minimum:1,maximum:Number(os(e.formatByString(e.startOfDay(n),l),r))}:{minimum:0,maximum:u}},minutes:()=>({minimum:0,maximum:e.getMinutes(s)}),seconds:()=>({minimum:0,maximum:e.getSeconds(s)}),meridiem:()=>({minimum:0,maximum:1}),empty:()=>({minimum:0,maximum:0})}},SI=(e,r,t,n)=>{switch(r.type){case"year":return e.setYear(n,e.getYear(t));case"month":return e.setMonth(n,e.getMonth(t));case"weekDay":{let a=e.formatByString(t,r.format);r.hasLeadingZerosInInput&&(a=Ed(a,r.maxLength));const s=Bc(e,r.format),i=s.indexOf(a),l=s.indexOf(r.value)-i;return e.addDays(t,l)}case"day":return e.setDate(n,e.getDate(t));case"meridiem":{const a=e.getHours(t)<12,s=e.getHours(n);return a&&s>=12?e.addHours(n,-12):!a&&s<12?e.addHours(n,12):n}case"hours":return e.setHours(n,e.getHours(t));case"minutes":return e.setMinutes(n,e.getMinutes(t));case"seconds":return e.setSeconds(n,e.getSeconds(t));default:return n}},dh={year:1,month:2,day:3,weekDay:4,hours:5,minutes:6,seconds:7,meridiem:8,empty:9},fh=(e,r,t,n,a)=>[...t].sort((s,i)=>dh[s.type]-dh[i.type]).reduce((s,i)=>!a||i.modified?SI(e,i,r,s):s,n),EI=()=>navigator.userAgent.toLowerCase().includes("android"),TI=(e,r)=>{const t={};if(!r)return e.forEach((l,u)=>{const d=u===0?null:u-1,f=u===e.length-1?null:u+1;t[u]={leftIndex:d,rightIndex:f}}),{neighbors:t,startIndex:0,endIndex:e.length-1};const n={},a={};let s=0,i=0,c=e.length-1;for(;c>=0;){i=e.findIndex((l,u)=>{var d;return u>=s&&((d=l.endSeparator)==null?void 0:d.includes(" "))&&l.endSeparator!==" / "}),i===-1&&(i=e.length-1);for(let l=i;l>=s;l-=1)a[l]=c,n[c]=l,c-=1;s=i+1}return e.forEach((l,u)=>{const d=a[u],f=d===0?null:n[d-1],h=d===e.length-1?null:n[d+1];t[u]={leftIndex:f,rightIndex:h}}),{neighbors:t,startIndex:n[0],endIndex:n[e.length-1]}},tu=(e,r)=>{if(e==null)return null;if(e==="all")return"all";if(typeof e=="string"){const t=r.findIndex(n=>n.type===e);return t===-1?null:t}return e},kI=["value","referenceDate"],Un={emptyValue:null,getTodayValue:cg,getInitialReferenceValue:e=>{let{value:r,referenceDate:t}=e,n=Je(e,kI);return n.utils.isValid(r)?r:t??pI(n)},cleanValue:lI,areValuesEqual:uI,isSameError:(e,r)=>e===r,hasError:e=>e!=null,defaultErrorState:null,getTimezone:(e,r)=>e.isValid(r)?e.getTimezone(r):null,setTimezone:(e,r,t)=>t==null?null:e.setTimezone(t,r)},AI={updateReferenceValue:(e,r,t)=>e.isValid(r)?r:t,getSectionsFromValue:(e,r)=>r(e),getV7HiddenInputValueFromSections:yI,getV6InputValueFromSections:bI,parseValueStr:(e,r,t)=>t(e.trim(),r),getDateFromSection:e=>e,getDateSectionsFromValue:e=>e,updateDateInValue:(e,r,t)=>t,clearDateSections:e=>e.map(r=>re({},r,{value:""}))};function CI(e,r){return Array.isArray(r)?r.every(t=>e.indexOf(t)!==-1):e.indexOf(r)!==-1}const _I=e=>{setTimeout(e,0)},pr=(e=document)=>{const r=e.activeElement;return r?r.shadowRoot?pr(r.shadowRoot):r:null},DI="@media (pointer: fine)";function FI(e){return zt("MuiPickersDay",e)}const Aa=Jt("MuiPickersDay",["root","dayWithMargin","dayOutsideMonth","hiddenDaySpacingFiller","today","selected","disabled"]);function hg(e){const{disabled:r,selected:t,today:n,outsideCurrentMonth:a,day:s,disableMargin:i,disableHighlightToday:c,showDaysOutsideCurrentMonth:l}=e,u=yt(),{ownerState:d}=lr();return C.useMemo(()=>re({},d,{day:s,isDaySelected:t??!1,isDayDisabled:r??!1,isDayCurrent:n??!1,isDayOutsideMonth:a??!1,isDayStartOfWeek:u.isSameDay(s,u.startOfWeek(s)),isDayEndOfWeek:u.isSameDay(s,u.endOfWeek(s)),disableMargin:i??!1,disableHighlightToday:c??!1,showDaysOutsideCurrentMonth:l??!1}),[u,d,s,t,r,n,a,i,c,l])}const II=["autoFocus","className","classes","hidden","isAnimating","onClick","onDaySelect","onFocus","onBlur","onKeyDown","onMouseDown","onMouseEnter","children","isFirstVisibleCell","isLastVisibleCell","day","selected","disabled","today","outsideCurrentMonth","disableMargin","disableHighlightToday","showDaysOutsideCurrentMonth"],PI=(e,r)=>{const{isDaySelected:t,isDayDisabled:n,isDayCurrent:a,isDayOutsideMonth:s,disableMargin:i,disableHighlightToday:c,showDaysOutsideCurrentMonth:l}=r,u=s&&!l;return jt({root:["root",t&&!u&&"selected",n&&"disabled",!i&&"dayWithMargin",!c&&a&&"today",s&&l&&"dayOutsideMonth",u&&"hiddenDaySpacingFiller"],hiddenDaySpacingFiller:["hiddenDaySpacingFiller"]},FI,e)},pg=({theme:e})=>re({},e.typography.caption,{width:Ji,height:Ji,borderRadius:"50%",padding:0,backgroundColor:"transparent",transition:e.transitions.create("background-color",{duration:e.transitions.duration.short}),color:(e.vars||e).palette.text.primary,"@media (pointer: fine)":{"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.hoverOpacity})`:Ys(e.palette.primary.main,e.palette.action.hoverOpacity)}},"&:focus":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.focusOpacity})`:Ys(e.palette.primary.main,e.palette.action.focusOpacity),[`&.${Aa.selected}`]:{willChange:"background-color",backgroundColor:(e.vars||e).palette.primary.dark}},[`&.${Aa.selected}`]:{color:(e.vars||e).palette.primary.contrastText,backgroundColor:(e.vars||e).palette.primary.main,fontWeight:e.typography.fontWeightMedium,"&:hover":{willChange:"background-color",backgroundColor:(e.vars||e).palette.primary.dark}},[`&.${Aa.disabled}:not(.${Aa.selected})`]:{color:(e.vars||e).palette.text.disabled},[`&.${Aa.disabled}&.${Aa.selected}`]:{opacity:.6},variants:[{props:{disableMargin:!1},style:{margin:`0 ${Mc}px`}},{props:{isDayOutsideMonth:!0,showDaysOutsideCurrentMonth:!0},style:{color:(e.vars||e).palette.text.secondary}},{props:{disableHighlightToday:!1,isDayCurrent:!0},style:{[`&:not(.${Aa.selected})`]:{border:`1px solid ${(e.vars||e).palette.text.secondary}`}}}]}),mg=(e,r)=>{const{ownerState:t}=e;return[r.root,!t.disableMargin&&r.dayWithMargin,!t.disableHighlightToday&&t.isDayCurrent&&r.today,!t.isDayOutsideMonth&&t.showDaysOutsideCurrentMonth&&r.dayOutsideMonth,t.isDayOutsideMonth&&!t.showDaysOutsideCurrentMonth&&r.hiddenDaySpacingFiller]},OI=Ge(Lv,{name:"MuiPickersDay",slot:"Root",overridesResolver:mg})(pg),jI=Ge("div",{name:"MuiPickersDay",slot:"Root",overridesResolver:mg})(({theme:e})=>re({},pg({theme:e}),{opacity:0,pointerEvents:"none"})),mi=()=>{},RI=C.forwardRef(function(r,t){const n=Ct({props:r,name:"MuiPickersDay"}),{autoFocus:a=!1,className:s,classes:i,isAnimating:c,onClick:l,onDaySelect:u,onFocus:d=mi,onBlur:f=mi,onKeyDown:h=mi,onMouseDown:x=mi,onMouseEnter:p=mi,children:m,day:g,selected:v,disabled:y,today:b,outsideCurrentMonth:S,disableMargin:I,disableHighlightToday:k,showDaysOutsideCurrentMonth:E}=n,T=Je(n,II),w=hg({day:g,selected:v,disabled:y,today:b,outsideCurrentMonth:S,disableMargin:I,disableHighlightToday:k,showDaysOutsideCurrentMonth:E}),F=PI(i,w),P=yt(),A=C.useRef(null),L=Lr(A,t);$n(()=>{a&&!y&&!c&&!S&&A.current.focus()},[a,y,c,S]);const Y=Q=>{x(Q),S&&Q.preventDefault()},q=Q=>{y||u(g),S&&Q.currentTarget.focus(),l&&l(Q)};return S&&!E?o.jsx(jI,{className:Xt(F.root,F.hiddenDaySpacingFiller,s),ownerState:w,role:T.role}):o.jsx(OI,re({className:Xt(F.root,s),ref:L,centerRipple:!0,disabled:y,tabIndex:v?0:-1,onKeyDown:Q=>h(Q,g),onFocus:Q=>d(Q,g),onBlur:Q=>f(Q,g),onMouseEnter:Q=>p(Q,g),onClick:q,onMouseDown:Y},T,{ownerState:w,children:m||P.format(g,"dayOfMonth")}))}),NI=C.memo(RI),ru=["disablePast","disableFuture","minDate","maxDate","shouldDisableDate","shouldDisableMonth","shouldDisableYear"],nu=["disablePast","disableFuture","minTime","maxTime","shouldDisableTime","minutesStep","ampm","disableIgnoringDatePartForTimeValidation"],xg=["minDateTime","maxDateTime"],MI=[...ru,...nu,...xg],gg=e=>MI.reduce((r,t)=>(e.hasOwnProperty(t)&&(r[t]=e[t]),r),{}),LI=["value","defaultValue","referenceDate","format","formatDensity","onChange","timezone","onError","shouldRespectLeadingZeros","selectedSections","onSelectedSectionsChange","unstableFieldRef","unstableStartFieldRef","unstableEndFieldRef","enableAccessibleFieldDOMStructure","disabled","readOnly","dateSeparator","autoFocus","focused"],vg=(e,r)=>C.useMemo(()=>{const t=re({},e),n={},a=s=>{t.hasOwnProperty(s)&&(n[s]=t[s],delete t[s])};return LI.forEach(a),r==="date"?ru.forEach(a):r==="time"?nu.forEach(a):r==="date-time"&&(ru.forEach(a),nu.forEach(a),xg.forEach(a)),{forwardedProps:t,internalProps:n}},[e,r]),BI=({utils:e,format:r})=>{let t=10,n=r,a=e.expandFormat(r);for(;a!==n;)if(n=a,a=e.expandFormat(n),t-=1,t<0)throw new Error("MUI X: The format expansion seems to be in an infinite loop. Please open an issue with the format passed to the component.");return a},$I=({utils:e,expandedFormat:r})=>{const t=[],{start:n,end:a}=e.escapedCharacters,s=new RegExp(`(\\${n}[^\\${a}]*\\${a})+`,"g");let i=null;for(;i=s.exec(r);)t.push({start:i.index,end:s.lastIndex-1});return t},UI=(e,r,t,n)=>{switch(t.type){case"year":return r.fieldYearPlaceholder({digitAmount:e.formatByString(e.date(void 0,"default"),n).length,format:n});case"month":return r.fieldMonthPlaceholder({contentType:t.contentType,format:n});case"day":return r.fieldDayPlaceholder({format:n});case"weekDay":return r.fieldWeekDayPlaceholder({contentType:t.contentType,format:n});case"hours":return r.fieldHoursPlaceholder({format:n});case"minutes":return r.fieldMinutesPlaceholder({format:n});case"seconds":return r.fieldSecondsPlaceholder({format:n});case"meridiem":return r.fieldMeridiemPlaceholder({format:n});default:return n}},VI=({utils:e,date:r,shouldRespectLeadingZeros:t,localeText:n,localizedDigits:a,now:s,token:i,startSeparator:c})=>{if(i==="")throw new Error("MUI X: Should not call `commitToken` with an empty token");const l=lg(e,i),u=fg(e,l.contentType,l.type,i),d=t?u:l.contentType==="digit",f=e.isValid(r);let h=f?e.formatByString(r,i):"",x=null;if(d)if(u)x=h===""?e.formatByString(s,i).length:h.length;else{if(l.maxLength==null)throw new Error(`MUI X: The token ${i} should have a 'maxLength' property on it's adapter`);x=l.maxLength,f&&(h=Sd(Ed(os(h,a),x),a))}return re({},l,{format:i,maxLength:x,value:h,placeholder:UI(e,n,l,i),hasLeadingZerosInFormat:u,hasLeadingZerosInInput:d,startSeparator:c,endSeparator:"",modified:!1})},WI=e=>{var x;const{utils:r,expandedFormat:t,escapedParts:n}=e,a=r.date(void 0),s=[];let i="";const c=Object.keys(r.formatTokenMap).sort((p,m)=>m.length-p.length),l=/^([a-zA-Z]+)/,u=new RegExp(`^(${c.join("|")})*$`),d=new RegExp(`^(${c.join("|")})`),f=p=>n.find(m=>m.start<=p&&m.end>=p);let h=0;for(;h<t.length;){const p=f(h),m=p!=null,g=(x=l.exec(t.slice(h)))==null?void 0:x[1];if(!m&&g!=null&&u.test(g)){let v=g;for(;v.length>0;){const y=d.exec(v)[1];v=v.slice(y.length),s.push(VI(re({},e,{now:a,token:y,startSeparator:i}))),i=""}h+=g.length}else{const v=t[h];m&&(p==null?void 0:p.start)===h||(p==null?void 0:p.end)===h||(s.length===0?i+=v:(s[s.length-1].endSeparator+=v,s[s.length-1].isEndFormatSeparator=!0)),h+=1}}return s.length===0&&i.length>0&&s.push({type:"empty",contentType:"letter",maxLength:null,format:"",value:"",placeholder:"",hasLeadingZerosInFormat:!1,hasLeadingZerosInInput:!1,startSeparator:i,endSeparator:"",modified:!1}),s},HI=({isRtl:e,formatDensity:r,sections:t})=>t.map(n=>{const a=s=>{let i=s;return e&&i!==null&&i.includes(" ")&&(i=`â©${i}â¦`),r==="spacious"&&["/",".","-"].includes(i)&&(i=` ${i} `),i};return n.startSeparator=a(n.startSeparator),n.endSeparator=a(n.endSeparator),n}),hh=e=>{let r=BI(e);e.isRtl&&e.enableAccessibleFieldDOMStructure&&(r=r.split(" ").reverse().join(" "));const t=$I(re({},e,{expandedFormat:r})),n=WI(re({},e,{expandedFormat:r,escapedParts:t}));return HI(re({},e,{sections:n}))},kd=()=>C.useContext(vd),zI=()=>{const e=C.useContext(ng);if(e==null)throw new Error(["MUI X: The `usePickerActionsContext` can only be called in fields that are used as a slot of a Picker component"].join(`
`));return e},_s=e=>e.saveQuery!=null,yg=({stateResponse:{localizedDigits:e,sectionsValueBoundaries:r,state:t,timezone:n,setCharacterQuery:a,setTempAndroidValueStr:s,updateSectionValue:i}})=>{const c=yt(),l=({keyPressed:f,sectionIndex:h},x,p)=>{const m=f.toLowerCase(),g=t.sections[h];if(t.characterQuery!=null&&(!p||p(t.characterQuery.value))&&t.characterQuery.sectionIndex===h){const y=`${t.characterQuery.value}${m}`,b=x(y,g);if(!_s(b))return a({sectionIndex:h,value:y,sectionType:g.type}),b}const v=x(m,g);return _s(v)&&!v.saveQuery?(a(null),null):(a({sectionIndex:h,value:m,sectionType:g.type}),_s(v)?null:v)},u=f=>{const h=(m,g,v)=>{const y=g.filter(b=>b.toLowerCase().startsWith(v));return y.length===0?{saveQuery:!1}:{sectionValue:y[0],shouldGoToNextSection:y.length===1}},x=(m,g,v,y)=>{const b=S=>ug(c,n,g.type,S);if(g.contentType==="letter")return h(g.format,b(g.format),m);if(v&&y!=null&&lg(c,v).contentType==="letter"){const S=b(v),I=h(v,S,m);return _s(I)?{saveQuery:!1}:re({},I,{sectionValue:y(I.sectionValue,S)})}return{saveQuery:!1}};return l(f,(m,g)=>{switch(g.type){case"month":{const v=y=>uh(c,y,c.formats.month,g.format);return x(m,g,c.formats.month,v)}case"weekDay":{const v=(y,b)=>b.indexOf(y).toString();return x(m,g,c.formats.weekday,v)}case"meridiem":return x(m,g);default:return{saveQuery:!1}}})},d=f=>{const h=(p,m)=>{const g=os(p,e),v=Number(g),y=r[m.type]({currentDate:null,format:m.format,contentType:m.contentType});if(v>y.maximum)return{saveQuery:!1};if(v<y.minimum)return{saveQuery:!0};const b=v*10>y.maximum||g.length===y.maximum.toString().length;return{sectionValue:dg(c,v,y,e,m),shouldGoToNextSection:b}};return l(f,(p,m)=>{if(m.contentType==="digit"||m.contentType==="digit-with-letter")return h(p,m);if(m.type==="month"){const g=fg(c,"digit","month","MM"),v=h(p,{type:m.type,format:"MM",hasLeadingZerosInFormat:g,hasLeadingZerosInInput:!0,contentType:"digit",maxLength:2});if(_s(v))return v;const y=uh(c,v.sectionValue,"MM",m.format);return re({},v,{sectionValue:y})}if(m.type==="weekDay"){const g=h(p,m);if(_s(g))return g;const v=Bc(c,m.format)[Number(g.sectionValue)-1];return re({},g,{sectionValue:v})}return{saveQuery:!1}},p=>lh(p,e))};return $e(f=>{const h=t.sections[f.sectionIndex],p=lh(f.keyPressed,e)?d(re({},f,{keyPressed:Sd(f.keyPressed,e)})):u(f);if(p==null){s(null);return}i({section:h,newSectionValue:p.sectionValue,shouldGoToNextSection:p.shouldGoToNextSection})})},mo=({props:e,value:r,timezone:t,adapter:n})=>{if(r===null)return null;const{shouldDisableDate:a,shouldDisableMonth:s,shouldDisableYear:i,disablePast:c,disableFuture:l,minDate:u,maxDate:d}=e,f=n.utils.date(void 0,t);switch(!0){case!n.utils.isValid(r):return"invalidDate";case!!(a&&a(r)):return"shouldDisableDate";case!!(s&&s(r)):return"shouldDisableMonth";case!!(i&&i(r)):return"shouldDisableYear";case!!(l&&n.utils.isAfterDay(r,f)):return"disableFuture";case!!(c&&n.utils.isBeforeDay(r,f)):return"disablePast";case!!(u&&n.utils.isBeforeDay(r,u)):return"minDate";case!!(d&&n.utils.isAfterDay(r,d)):return"maxDate";default:return null}};mo.valueManager=Un;function bg(e){const{props:r,validator:t,value:n,timezone:a,onError:s}=e,i=ms(),c=C.useRef(t.valueManager.defaultErrorState),l=t({adapter:i,value:n,timezone:a,props:r}),u=t.valueManager.hasError(l);C.useEffect(()=>{s&&!t.valueManager.isSameError(l,c.current)&&s(l,n),c.current=l},[t,s,l,n]);const d=$e(f=>t({adapter:i,value:f,timezone:a,props:r}));return{validationError:l,hasValidationError:u,getValidationErrorForNewValue:d}}const GI=5e3,wg=e=>{var be;const r=yt(),t=wa(),n=ms(),a=ra(),{manager:{validator:s,valueType:i,internal_valueManager:c,internal_fieldValueManager:l},internalPropsWithDefaults:u,internalPropsWithDefaults:{value:d,defaultValue:f,referenceDate:h,onChange:x,format:p,formatDensity:m="dense",selectedSections:g,onSelectedSectionsChange:v,shouldRespectLeadingZeros:y=!1,timezone:b,enableAccessibleFieldDOMStructure:S=!0},forwardedProps:{error:I}}=e,{value:k,handleValueChange:E,timezone:T}=po({name:"a field component",timezone:b,value:d,defaultValue:f,referenceDate:h,onChange:x,valueManager:c}),w=C.useRef(k);C.useEffect(()=>{w.current=k},[k]);const{hasValidationError:F}=bg({props:u,validator:s,timezone:T,value:k,onError:u.onError}),P=C.useMemo(()=>I!==void 0?I:F,[F,I]),A=C.useMemo(()=>xI(r),[r]),L=C.useMemo(()=>wI(r,A,T),[r,A,T]),Y=C.useCallback(pe=>l.getSectionsFromValue(pe,Ce=>hh({utils:r,localeText:t,localizedDigits:A,format:p,date:Ce,formatDensity:m,shouldRespectLeadingZeros:y,enableAccessibleFieldDOMStructure:S,isRtl:a})),[l,p,t,A,a,y,r,m,S]),[q,Q]=C.useState(()=>{const pe=Y(k),Ce={sections:pe,lastExternalValue:k,lastSectionsDependencies:{format:p,isRtl:a,locale:r.locale},tempValueStrAndroid:null,characterQuery:null},Oe=hI(pe),He=c.getInitialReferenceValue({referenceDate:h,value:k,utils:r,props:u,granularity:Oe,timezone:T});return re({},Ce,{referenceValue:He})}),[K,ye]=Ks({controlled:g,default:null,name:"useField",state:"selectedSections"}),U=pe=>{ye(pe),v==null||v(pe)},me=C.useMemo(()=>tu(K,q.sections),[K,q.sections]),J=me==="all"?0:me,D=C.useMemo(()=>TI(q.sections,a&&!S),[q.sections,a,S]),B=C.useMemo(()=>q.sections.every(pe=>pe.value===""),[q.sections]),V=pe=>{const Ce={validationError:s({adapter:n,value:pe,timezone:T,props:u})};E(pe,Ce)},W=(pe,Ce)=>{const Oe=[...q.sections];return Oe[pe]=re({},Oe[pe],{value:Ce,modified:!0}),Oe},Z=C.useRef(null),fe=$s(),ne=pe=>{J!=null&&(Z.current={sectionIndex:J,value:pe},fe.start(0,()=>{Z.current=null}))},ee=()=>{c.areValuesEqual(r,k,c.emptyValue)?Q(pe=>re({},pe,{sections:pe.sections.map(Ce=>re({},Ce,{value:""})),tempValueStrAndroid:null,characterQuery:null})):(Q(pe=>re({},pe,{characterQuery:null})),V(c.emptyValue))},se=()=>{if(J==null)return;const pe=q.sections[J];pe.value!==""&&(ne(""),l.getDateFromSection(k,pe)===null?Q(Ce=>re({},Ce,{sections:W(J,""),tempValueStrAndroid:null,characterQuery:null})):(Q(Ce=>re({},Ce,{characterQuery:null})),V(l.updateDateInValue(k,pe,null))))},j=pe=>{const Ce=(He,N)=>{const ie=r.parse(He,p);if(!r.isValid(ie))return null;const le=hh({utils:r,localeText:t,localizedDigits:A,format:p,date:ie,formatDensity:m,shouldRespectLeadingZeros:y,enableAccessibleFieldDOMStructure:S,isRtl:a});return fh(r,ie,le,N,!1)},Oe=l.parseValueStr(pe,q.referenceValue,Ce);V(Oe)},_=$s(),ae=({section:pe,newSectionValue:Ce,shouldGoToNextSection:Oe})=>{fe.clear(),_.clear();const He=l.getDateFromSection(k,pe);Oe&&J<q.sections.length-1&&U(J+1);const N=W(J,Ce),ie=l.getDateSectionsFromValue(N,pe),le=vI(r,ie,A);if(r.isValid(le)){const we=fh(r,le,ie,l.getDateFromSection(q.referenceValue,pe),!0);return He==null&&_.start(0,()=>{w.current===k&&Q(Ae=>re({},Ae,{sections:l.clearDateSections(q.sections,pe),tempValueStrAndroid:null}))}),V(l.updateDateInValue(k,pe,we))}return ie.every(we=>we.value!=="")?(ne(Ce),V(l.updateDateInValue(k,pe,le))):He!=null?(ne(Ce),V(l.updateDateInValue(k,pe,null))):Q(we=>re({},we,{sections:N,tempValueStrAndroid:null}))},oe=pe=>Q(Ce=>re({},Ce,{tempValueStrAndroid:pe})),Te=$e(pe=>{Q(Ce=>re({},Ce,{characterQuery:pe}))});if(k!==q.lastExternalValue){let pe;Z.current!=null&&!r.isValid(l.getDateFromSection(k,q.sections[Z.current.sectionIndex]))?pe=W(Z.current.sectionIndex,Z.current.value):pe=Y(k),Q(Ce=>re({},Ce,{lastExternalValue:k,sections:pe,sectionsDependencies:{format:p,isRtl:a,locale:r.locale},referenceValue:l.updateReferenceValue(r,k,Ce.referenceValue),tempValueStrAndroid:null}))}if(a!==q.lastSectionsDependencies.isRtl||p!==q.lastSectionsDependencies.format||r.locale!==q.lastSectionsDependencies.locale){const pe=Y(k);Q(Ce=>re({},Ce,{lastSectionsDependencies:{format:p,isRtl:a,locale:r.locale},sections:pe,tempValueStrAndroid:null,characterQuery:null}))}q.characterQuery!=null&&!P&&J==null&&Te(null),q.characterQuery!=null&&((be=q.sections[q.characterQuery.sectionIndex])==null?void 0:be.type)!==q.characterQuery.sectionType&&Te(null),C.useEffect(()=>{Z.current!=null&&(Z.current=null)});const ce=$s();return C.useEffect(()=>(q.characterQuery!=null&&ce.start(GI,()=>Te(null)),()=>{}),[q.characterQuery,Te,ce]),C.useEffect(()=>{q.tempValueStrAndroid!=null&&J!=null&&se()},[q.sections]),{activeSectionIndex:J,areAllSectionsEmpty:B,error:P,localizedDigits:A,parsedSelectedSections:me,sectionOrder:D,sectionsValueBoundaries:L,state:q,timezone:T,value:k,clearValue:ee,clearActiveSection:se,setCharacterQuery:Te,setSelectedSections:U,setTempAndroidValueStr:oe,updateSectionValue:ae,updateValueFromValueStr:j,getSectionsFromValue:Y}};function Sg(e){const{manager:{internal_useApplyDefaultValuesToFieldInternalProps:r},internalProps:t,skipContextFieldRefAssignment:n}=e,a=kd(),s=rg(),i=Lr(t.unstableFieldRef,n?null:s==null?void 0:s.fieldRef),c=a==null?void 0:a.setValue,l=C.useCallback((d,f)=>c==null?void 0:c(d,{validationError:f.validationError,shouldClose:!1}),[c]),u=C.useMemo(()=>s!=null&&a!=null?re({value:a.value,onChange:l,timezone:a.timezone,disabled:a.disabled,readOnly:a.readOnly,autoFocus:a.autoFocus&&!a.open,focused:a.open?!0:void 0,format:a.fieldFormat,formatDensity:s.formatDensity,enableAccessibleFieldDOMStructure:s.enableAccessibleFieldDOMStructure,selectedSections:s.selectedSections,onSelectedSectionsChange:s.onSelectedSectionsChange,unstableFieldRef:i},t):t,[a,s,t,l,i]);return r(u)}function Ad(e){const{focused:r,domGetters:t,stateResponse:{parsedSelectedSections:n,state:a}}=e;if(!t.isReady())return;const s=document.getSelection();if(!s)return;if(n==null){s.rangeCount>0&&t.getRoot().contains(s.getRangeAt(0).startContainer)&&s.removeAllRanges(),r&&t.getRoot().blur();return}if(!t.getRoot().contains(pr(document)))return;const i=new window.Range;let c;n==="all"?c=t.getRoot():a.sections[n].type==="empty"?c=t.getSectionContainer(n):c=t.getSectionContent(n),i.selectNodeContents(c),c.focus(),s.removeAllRanges(),s.addRange(i)}function Eg(e){const r=yt(),{manager:{internal_fieldValueManager:t},internalPropsWithDefaults:{minutesStep:n,disabled:a,readOnly:s},stateResponse:{state:i,value:c,activeSectionIndex:l,parsedSelectedSections:u,sectionsValueBoundaries:d,localizedDigits:f,timezone:h,sectionOrder:x,clearValue:p,clearActiveSection:m,setSelectedSections:g,updateSectionValue:v}}=e;return $e(y=>{if(!a)switch(!0){case((y.ctrlKey||y.metaKey)&&String.fromCharCode(y.keyCode)==="A"&&!y.shiftKey&&!y.altKey):{y.preventDefault(),g("all");break}case y.key==="ArrowRight":{if(y.preventDefault(),u==null)g(x.startIndex);else if(u==="all")g(x.endIndex);else{const b=x.neighbors[u].rightIndex;b!==null&&g(b)}break}case y.key==="ArrowLeft":{if(y.preventDefault(),u==null)g(x.endIndex);else if(u==="all")g(x.startIndex);else{const b=x.neighbors[u].leftIndex;b!==null&&g(b)}break}case y.key==="Delete":{if(y.preventDefault(),s)break;u==null||u==="all"?p():m();break}case["ArrowUp","ArrowDown","Home","End","PageUp","PageDown"].includes(y.key):{if(y.preventDefault(),s||l==null)break;u==="all"&&g(l);const b=i.sections[l],S=qI(r,h,b,y.key,d,f,t.getDateFromSection(c,b),{minutesStep:n});v({section:b,newSectionValue:S,shouldGoToNextSection:!1});break}}})}function YI(e){switch(e){case"ArrowUp":return 1;case"ArrowDown":return-1;case"PageUp":return 5;case"PageDown":return-5;default:return 0}}function qI(e,r,t,n,a,s,i,c){const l=YI(n),u=n==="Home",d=n==="End",f=t.value===""||u||d,h=()=>{const p=a[t.type]({currentDate:i,format:t.format,contentType:t.contentType}),m=y=>dg(e,y,p,s,t),g=t.type==="minutes"&&(c!=null&&c.minutesStep)?c.minutesStep:1;let v;if(f){if(t.type==="year"&&!d&&!u)return e.formatByString(e.date(void 0,r),t.format);l>0||u?v=p.minimum:v=p.maximum}else v=parseInt(os(t.value,s),10)+l*g;return v%g!==0&&((l<0||u)&&(v+=g-(g+v)%g),(l>0||d)&&(v-=v%g)),v>p.maximum?m(p.minimum+(v-p.maximum-1)%(p.maximum-p.minimum+1)):v<p.minimum?m(p.maximum-(p.minimum-v-1)%(p.maximum-p.minimum+1)):m(v)},x=()=>{const p=ug(e,r,t.type,t.format);if(p.length===0)return t.value;if(f)return l>0||u?p[0]:p[p.length-1];const v=((p.indexOf(t.value)+l)%p.length+p.length)%p.length;return p[v]};return t.contentType==="digit"||t.contentType==="digit-with-letter"?h():x()}function XI(e){const{manager:r,focused:t,setFocused:n,domGetters:a,stateResponse:s,applyCharacterEditing:i,internalPropsWithDefaults:c,stateResponse:{parsedSelectedSections:l,sectionOrder:u,state:d,clearValue:f,setCharacterQuery:h,setSelectedSections:x,updateValueFromValueStr:p},internalPropsWithDefaults:{disabled:m=!1,readOnly:g=!1}}=e,v=Eg({manager:r,internalPropsWithDefaults:c,stateResponse:s}),y=$s(),b=$e(T=>{m||!a.isReady()||(n(!0),l==="all"?y.start(0,()=>{const w=document.getSelection().getRangeAt(0).startOffset;if(w===0){x(u.startIndex);return}let F=0,P=0;for(;P<w&&F<d.sections.length;){const A=d.sections[F];F+=1,P+=`${A.startSeparator}${A.value||A.placeholder}${A.endSeparator}`.length}x(F-1)}):t?a.getRoot().contains(T.target)||x(u.startIndex):(n(!0),x(u.startIndex)))}),S=$e(T=>{if(!a.isReady()||l!=="all")return;const F=T.target.textContent??"";a.getRoot().innerHTML=d.sections.map(P=>`${P.startSeparator}${P.value||P.placeholder}${P.endSeparator}`).join(""),Ad({focused:t,domGetters:a,stateResponse:s}),F.length===0||F.charCodeAt(0)===10?(f(),x("all")):F.length>1?p(F):(l==="all"&&x(0),i({keyPressed:F,sectionIndex:0}))}),I=$e(T=>{if(g||l!=="all"){T.preventDefault();return}const w=T.clipboardData.getData("text");T.preventDefault(),h(null),p(w)}),k=$e(()=>{if(t||m||!a.isReady())return;const T=pr(document);n(!0),a.getSectionIndexFromDOMElement(T)!=null||x(u.startIndex)}),E=$e(()=>{setTimeout(()=>{if(!a.isReady())return;const T=pr(document);!a.getRoot().contains(T)&&(n(!1),x(null))})});return{onKeyDown:v,onBlur:E,onFocus:k,onClick:b,onPaste:I,onInput:S,contentEditable:l==="all",tabIndex:l===0?-1:0}}function KI(e){const{manager:{internal_fieldValueManager:r},stateResponse:{areAllSectionsEmpty:t,state:n,updateValueFromValueStr:a}}=e,s=$e(c=>{a(c.target.value)});return{value:C.useMemo(()=>t?"":r.getV7HiddenInputValueFromSections(n.sections),[t,n.sections,r]),onChange:s}}function JI(e){const{stateResponse:{setSelectedSections:r},internalPropsWithDefaults:{disabled:t=!1}}=e,n=$e(a=>s=>{t||s.isDefaultPrevented()||r(a)});return C.useCallback(a=>({"data-sectionindex":a,onClick:n(a)}),[n])}function QI(e){const r=yt(),t=wa(),n=Rc(),{focused:a,domGetters:s,stateResponse:i,applyCharacterEditing:c,manager:{internal_fieldValueManager:l},stateResponse:{parsedSelectedSections:u,sectionsValueBoundaries:d,state:f,value:h,clearActiveSection:x,setCharacterQuery:p,setSelectedSections:m,updateSectionValue:g,updateValueFromValueStr:v},internalPropsWithDefaults:{disabled:y=!1,readOnly:b=!1}}=e,S=u==="all",I=!S&&!y&&!b,k=$e(A=>{if(!s.isReady())return;const L=f.sections[A];s.getSectionContent(A).innerHTML=L.value||L.placeholder,Ad({focused:a,domGetters:s,stateResponse:i})}),E=$e(A=>{if(!s.isReady())return;const L=A.target,Y=L.textContent??"",q=s.getSectionIndexFromDOMElement(L),Q=f.sections[q];if(b){k(q);return}if(Y.length===0){if(Q.value===""){k(q);return}const K=A.nativeEvent.inputType;if(K==="insertParagraph"||K==="insertLineBreak"){k(q);return}k(q),x();return}c({keyPressed:Y,sectionIndex:q}),k(q)}),T=$e(A=>{A.preventDefault()}),w=$e(A=>{if(A.preventDefault(),b||y||typeof u!="number")return;const L=f.sections[u],Y=A.clipboardData.getData("text"),q=/^[a-zA-Z]+$/.test(Y),Q=/^[0-9]+$/.test(Y),K=/^(([a-zA-Z]+)|)([0-9]+)(([a-zA-Z]+)|)$/.test(Y);L.contentType==="letter"&&q||L.contentType==="digit"&&Q||L.contentType==="digit-with-letter"&&K?(p(null),g({section:L,newSectionValue:Y,shouldGoToNextSection:!0})):!q&&!Q&&(p(null),v(Y))}),F=$e(A=>{A.preventDefault(),A.dataTransfer.dropEffect="none"}),P=$e(A=>()=>{y||m(A)});return C.useCallback((A,L)=>{const Y=d[A.type]({currentDate:l.getDateFromSection(h,A),contentType:A.contentType,format:A.format});return{onInput:E,onPaste:w,onMouseUp:T,onDragOver:F,onFocus:P(L),"aria-labelledby":`${n}-${A.type}`,"aria-readonly":b,"aria-valuenow":eP(A,r),"aria-valuemin":Y.minimum,"aria-valuemax":Y.maximum,"aria-valuetext":A.value?ZI(A,r):t.empty,"aria-label":t[A.type],"aria-disabled":y,tabIndex:S||L>0?-1:0,contentEditable:!S&&!y&&!b,role:"spinbutton",id:`${n}-${A.type}`,"data-range-position":A.dateName||void 0,spellCheck:I?!1:void 0,autoCapitalize:I?"off":void 0,autoCorrect:I?"off":void 0,children:A.value||A.placeholder,inputMode:A.contentType==="letter"?"text":"numeric"}},[d,n,S,y,b,I,t,r,E,w,T,F,P,l,h])}function ZI(e,r){if(e.value)switch(e.type){case"month":{if(e.contentType==="digit")return r.format(r.setMonth(r.date(),Number(e.value)-1),"month");const t=r.parse(e.value,e.format);return t?r.format(t,"month"):void 0}case"day":return e.contentType==="digit"?r.format(r.setDate(r.startOfYear(r.date()),Number(e.value)),"dayOfMonthFull"):e.value;case"weekDay":return;default:return}}function eP(e,r){if(e.value)switch(e.type){case"weekDay":return e.contentType==="letter"?void 0:Number(e.value);case"meridiem":{const t=r.parse(`01:00 ${e.value}`,`${r.formats.hours12h}:${r.formats.minutes} ${e.format}`);return t?r.getHours(t)>=12?1:0:void 0}case"day":return e.contentType==="digit-with-letter"?parseInt(e.value,10):Number(e.value);case"month":{if(e.contentType==="digit")return Number(e.value);const t=r.parse(e.value,e.format);return t?r.getMonth(t)+1:void 0}default:return e.contentType!=="letter"?Number(e.value):void 0}}const tP=e=>{const{props:r,manager:t,skipContextFieldRefAssignment:n,manager:{valueType:a,internal_useOpenPickerButtonAriaLabel:s}}=e,{internalProps:i,forwardedProps:c}=vg(r,a),l=Sg({manager:t,internalProps:i,skipContextFieldRefAssignment:n}),{sectionListRef:u,onBlur:d,onClick:f,onFocus:h,onInput:x,onPaste:p,onKeyDown:m,onClear:g,clearable:v}=c,{disabled:y=!1,readOnly:b=!1,autoFocus:S=!1,focused:I,unstableFieldRef:k}=l,E=C.useRef(null),T=Lr(u,E),w=C.useMemo(()=>({isReady:()=>E.current!=null,getRoot:()=>E.current.getRoot(),getSectionContainer:ce=>E.current.getSectionContainer(ce),getSectionContent:ce=>E.current.getSectionContent(ce),getSectionIndexFromDOMElement:ce=>E.current.getSectionIndexFromDOMElement(ce)}),[E]),F=wg({manager:t,internalPropsWithDefaults:l,forwardedProps:c}),{areAllSectionsEmpty:P,error:A,parsedSelectedSections:L,sectionOrder:Y,state:q,value:Q,clearValue:K,setSelectedSections:ye}=F,U=yg({stateResponse:F}),me=s(Q),[J,D]=C.useState(!1);function B(ce=0){if(y||!E.current||ph(E)!=null)return;const be=tu(ce,q.sections);D(!0),E.current.getSectionContent(be).focus()}const V=XI({manager:t,internalPropsWithDefaults:l,stateResponse:F,applyCharacterEditing:U,focused:J,setFocused:D,domGetters:w}),W=KI({manager:t,stateResponse:F}),Z=JI({stateResponse:F,internalPropsWithDefaults:l}),fe=QI({manager:t,stateResponse:F,applyCharacterEditing:U,internalPropsWithDefaults:l,domGetters:w,focused:J}),ne=$e(ce=>{m==null||m(ce),V.onKeyDown(ce)}),ee=$e(ce=>{d==null||d(ce),V.onBlur(ce)}),se=$e(ce=>{h==null||h(ce),V.onFocus(ce)}),j=$e(ce=>{ce.isDefaultPrevented()||(f==null||f(ce),V.onClick(ce))}),_=$e(ce=>{p==null||p(ce),V.onPaste(ce)}),ae=$e(ce=>{x==null||x(ce),V.onInput(ce)}),oe=$e((ce,...be)=>{ce.preventDefault(),g==null||g(ce,...be),K(),mh(E)?ye(Y.startIndex):B(0)}),Te=C.useMemo(()=>q.sections.map((ce,be)=>{const pe=fe(ce,be);return{container:Z(be),content:fe(ce,be),before:{children:ce.startSeparator},after:{children:ce.endSeparator,"data-range-position":ce.isEndFormatSeparator?pe["data-range-position"]:void 0}}}),[q.sections,Z,fe]);return C.useEffect(()=>{if(E.current==null)throw new Error(["MUI X: The `sectionListRef` prop has not been initialized by `PickersSectionList`","You probably tried to pass a component to the `textField` slot that contains an `<input />` element instead of a `PickersSectionList`.","","If you want to keep using an `<input />` HTML element for the editing, please add the `enableAccessibleFieldDOMStructure={false}` prop to your Picker or Field component:","","<DatePicker enableAccessibleFieldDOMStructure={false} slots={{ textField: MyCustomTextField }} />","","Learn more about the field accessible DOM structure on the MUI documentation: https://mui.com/x/react-date-pickers/fields/#fields-to-edit-a-single-element"].join(`
`));S&&!y&&E.current&&E.current.getSectionContent(Y.startIndex).focus()},[]),$n(()=>{if(!(!J||!E.current)){if(L==="all")E.current.getRoot().focus();else if(typeof L=="number"){const ce=E.current.getSectionContent(L);ce&&ce.focus()}}},[L,J]),$n(()=>{Ad({focused:J,domGetters:w,stateResponse:F})}),C.useImperativeHandle(k,()=>({getSections:()=>q.sections,getActiveSectionIndex:()=>ph(E),setSelectedSections:ce=>{if(y||!E.current)return;const be=tu(ce,q.sections);D((be==="all"?0:be)!==null),ye(ce)},focusField:B,isFieldFocused:()=>mh(E)})),re({},c,V,{onBlur:ee,onClick:j,onFocus:se,onInput:ae,onPaste:_,onKeyDown:ne,onClear:oe},W,{error:A,clearable:!!(v&&!P&&!b&&!y),focused:I??J,sectionListRef:T,enableAccessibleFieldDOMStructure:!0,elements:Te,areAllSectionsEmpty:P,disabled:y,readOnly:b,autoFocus:S,openPickerAriaLabel:me})};function ph(e){const r=pr(document);return!r||!e.current||!e.current.getRoot().contains(r)?null:e.current.getSectionIndexFromDOMElement(r)}function mh(e){const r=pr(document);return!!e.current&&e.current.getRoot().contains(r)}const js=e=>e.replace(/[\u2066\u2067\u2068\u2069]/g,""),rP=(e,r,t)=>{let n=0,a=t?1:0;const s=[];for(let i=0;i<e.length;i+=1){const c=e[i],l=Td(c,t?"input-rtl":"input-ltr",r),u=`${c.startSeparator}${l}${c.endSeparator}`,d=js(u).length,f=u.length,h=js(l),x=a+(h===""?0:l.indexOf(h[0]))+c.startSeparator.length,p=x+h.length;s.push(re({},c,{start:n,end:n+d,startInInput:x,endInInput:p})),n+=d,a+=f}return s},nP=e=>{const r=ra(),t=$s(),n=$s(),{props:a,manager:s,skipContextFieldRefAssignment:i,manager:{valueType:c,internal_valueManager:l,internal_fieldValueManager:u,internal_useOpenPickerButtonAriaLabel:d}}=e,{internalProps:f,forwardedProps:h}=vg(a,c),x=Sg({manager:s,internalProps:f,skipContextFieldRefAssignment:i}),{onFocus:p,onClick:m,onPaste:g,onBlur:v,onKeyDown:y,onClear:b,clearable:S,inputRef:I,placeholder:k}=h,{readOnly:E=!1,disabled:T=!1,autoFocus:w=!1,focused:F,unstableFieldRef:P}=x,A=C.useRef(null),L=Lr(I,A),Y=wg({manager:s,internalPropsWithDefaults:x,forwardedProps:h}),{activeSectionIndex:q,areAllSectionsEmpty:Q,error:K,localizedDigits:ye,parsedSelectedSections:U,sectionOrder:me,state:J,value:D,clearValue:B,clearActiveSection:V,setCharacterQuery:W,setSelectedSections:Z,setTempAndroidValueStr:fe,updateSectionValue:ne,updateValueFromValueStr:ee,getSectionsFromValue:se}=Y,j=yg({stateResponse:Y}),_=d(D),ae=C.useMemo(()=>rP(J.sections,ye,r),[J.sections,ye,r]);function oe(){const Fe=A.current.selectionStart??0;let Pe;Fe<=ae[0].startInInput||Fe>=ae[ae.length-1].endInInput?Pe=1:Pe=ae.findIndex(Ye=>Ye.startInInput-Ye.startSeparator.length>Fe);const Ve=Pe===-1?ae.length-1:Pe-1;Z(Ve)}function Te(Fe=0){var Pe;pr(document)!==A.current&&((Pe=A.current)==null||Pe.focus(),Z(Fe))}const ce=$e(Fe=>{p==null||p(Fe);const Pe=A.current;t.start(0,()=>{!Pe||Pe!==A.current||q==null&&(Pe.value.length&&Number(Pe.selectionEnd)-Number(Pe.selectionStart)===Pe.value.length?Z("all"):oe())})}),be=$e((Fe,...Pe)=>{Fe.isDefaultPrevented()||(m==null||m(Fe,...Pe),oe())}),pe=$e(Fe=>{if(g==null||g(Fe),Fe.preventDefault(),E||T)return;const Pe=Fe.clipboardData.getData("text");if(typeof U=="number"){const Ve=J.sections[U],Ye=/^[a-zA-Z]+$/.test(Pe),et=/^[0-9]+$/.test(Pe),ut=/^(([a-zA-Z]+)|)([0-9]+)(([a-zA-Z]+)|)$/.test(Pe);if(Ve.contentType==="letter"&&Ye||Ve.contentType==="digit"&&et||Ve.contentType==="digit-with-letter"&&ut){W(null),ne({section:Ve,newSectionValue:Pe,shouldGoToNextSection:!0});return}if(Ye||et)return}W(null),ee(Pe)}),Ce=$e(Fe=>{v==null||v(Fe),Z(null)}),Oe=$e(Fe=>{if(E)return;const Pe=Fe.target.value;if(Pe===""){B();return}const Ve=Fe.nativeEvent.data,Ye=Ve&&Ve.length>1,et=Ye?Ve:Pe,ut=js(et);if(U==="all"&&Z(q),q==null||Ye){ee(Ye?Ve:ut);return}let ar;if(U==="all"&&ut.length===1)ar=ut;else{const Bt=js(u.getV6InputValueFromSections(ae,ye,r));let it=-1,Rt=-1;for(let Dr=0;Dr<Bt.length;Dr+=1)it===-1&&Bt[Dr]!==ut[Dr]&&(it=Dr),Rt===-1&&Bt[Bt.length-Dr-1]!==ut[ut.length-Dr-1]&&(Rt=Dr);const Qt=ae[q];if(it<Qt.start||Bt.length-Rt-1>Qt.end)return;const Es=ut.length-Bt.length+Qt.end-js(Qt.endSeparator||"").length;ar=ut.slice(Qt.start+js(Qt.startSeparator||"").length,Es)}if(ar.length===0){EI()&&fe(et),V();return}j({keyPressed:ar,sectionIndex:q})}),He=$e((Fe,...Pe)=>{Fe.preventDefault(),b==null||b(Fe,...Pe),B(),xh(A)?Z(me.startIndex):Te(0)}),N=Eg({manager:s,internalPropsWithDefaults:x,stateResponse:Y}),ie=$e(Fe=>{y==null||y(Fe),N(Fe)}),le=C.useMemo(()=>k!==void 0?k:u.getV6InputValueFromSections(se(l.emptyValue),ye,r),[k,u,se,l.emptyValue,ye,r]),we=C.useMemo(()=>J.tempValueStrAndroid??u.getV6InputValueFromSections(J.sections,ye,r),[J.sections,u,J.tempValueStrAndroid,ye,r]);C.useEffect(()=>{A.current&&A.current===pr(document)&&Z("all")},[]),$n(()=>{function Fe(){if(!A.current)return;if(U==null){A.current.scrollLeft&&(A.current.scrollLeft=0);return}if(A.current!==pr(document))return;const Pe=A.current.scrollTop;if(U==="all")A.current.select();else{const Ve=ae[U],Ye=Ve.type==="empty"?Ve.startInInput-Ve.startSeparator.length:Ve.startInInput,et=Ve.type==="empty"?Ve.endInInput+Ve.endSeparator.length:Ve.endInInput;(Ye!==A.current.selectionStart||et!==A.current.selectionEnd)&&A.current===pr(document)&&A.current.setSelectionRange(Ye,et),n.start(0,()=>{A.current&&A.current===pr(document)&&A.current.selectionStart===A.current.selectionEnd&&(A.current.selectionStart!==Ye||A.current.selectionEnd!==et)&&Fe()})}A.current.scrollTop=Pe}Fe()});const Ae=C.useMemo(()=>q==null||J.sections[q].contentType==="letter"?"text":"numeric",[q,J.sections]),Ue=!(A.current&&A.current===pr(document))&&Q;return C.useImperativeHandle(P,()=>({getSections:()=>J.sections,getActiveSectionIndex:()=>{const Fe=A.current.selectionStart??0,Pe=A.current.selectionEnd??0;if(Fe===0&&Pe===0)return null;const Ve=Fe<=ae[0].startInInput?1:ae.findIndex(Ye=>Ye.startInInput-Ye.startSeparator.length>Fe);return Ve===-1?ae.length-1:Ve-1},setSelectedSections:Fe=>Z(Fe),focusField:Te,isFieldFocused:()=>xh(A)})),re({},h,{error:K,clearable:!!(S&&!Q&&!E&&!T),onBlur:Ce,onClick:be,onFocus:ce,onPaste:pe,onKeyDown:ie,onClear:He,inputRef:L,enableAccessibleFieldDOMStructure:!1,placeholder:le,inputMode:Ae,autoComplete:"off",value:Ue?"":we,onChange:Oe,focused:F,disabled:T,readOnly:E,autoFocus:w,openPickerAriaLabel:_})};function xh(e){return e.current===pr(document)}const aP=e=>{const r=rg();return(e.props.enableAccessibleFieldDOMStructure??(r==null?void 0:r.enableAccessibleFieldDOMStructure)??!0?tP:nP)(e)};function sP(e={}){const{enableAccessibleFieldDOMStructure:r=!0}=e;return C.useMemo(()=>({valueType:"date",validator:mo,internal_valueManager:Un,internal_fieldValueManager:AI,internal_enableAccessibleFieldDOMStructure:r,internal_useApplyDefaultValuesToFieldInternalProps:oP,internal_useOpenPickerButtonAriaLabel:iP}),[r])}function iP(e){const r=yt(),t=wa();return C.useMemo(()=>{const n=r.isValid(e)?r.format(e,"fullDate"):null;return t.openDatePickerDialogue(n)},[e,t,r])}function oP(e){const r=yt(),t=xo(e);return C.useMemo(()=>re({},e,t,{format:e.format??r.formats.keyboardDate}),[e,t,r])}function xo(e){const r=yt(),t=BF();return C.useMemo(()=>({disablePast:e.disablePast??!1,disableFuture:e.disableFuture??!1,minDate:ih(r,e.minDate,t.minDate),maxDate:ih(r,e.maxDate,t.maxDate)}),[e.minDate,e.maxDate,e.disableFuture,e.disablePast,r,t])}const cP=e=>{const r=sP(e);return aP({manager:r,props:e})};function Cd(e){const{ownerState:r}=lr(),t=ra();return C.useMemo(()=>re({},r,{isFieldDisabled:e.disabled??!1,isFieldReadOnly:e.readOnly??!1,isFieldRequired:e.required??!1,fieldDirection:t?"rtl":"ltr"}),[r,e.disabled,e.readOnly,e.required,t])}function lP(e){return zt("MuiPickersTextField",e)}Jt("MuiPickersTextField",["root","focused","disabled","error","required"]);function uP(e){return zt("MuiPickersInputBase",e)}const Us=Jt("MuiPickersInputBase",["root","focused","disabled","error","notchedOutline","sectionContent","sectionBefore","sectionAfter","adornedStart","adornedEnd","input","activeBar"]);function dP(e){return zt("MuiPickersSectionList",e)}const xi=Jt("MuiPickersSectionList",["root","section","sectionContent"]),fP=["slots","slotProps","elements","sectionListRef","classes"],Tg=Ge("div",{name:"MuiPickersSectionList",slot:"Root"})({direction:"ltr /*! @noflip */",outline:"none"}),kg=Ge("span",{name:"MuiPickersSectionList",slot:"Section"})({}),Ag=Ge("span",{name:"MuiPickersSectionList",slot:"SectionSeparator"})({whiteSpace:"pre"}),Cg=Ge("span",{name:"MuiPickersSectionList",slot:"SectionContent"})({outline:"none"}),hP=e=>jt({root:["root"],section:["section"],sectionContent:["sectionContent"]},dP,e);function pP(e){const{slots:r,slotProps:t,element:n,classes:a}=e,{ownerState:s}=lr(),i=(r==null?void 0:r.section)??kg,c=ht({elementType:i,externalSlotProps:t==null?void 0:t.section,externalForwardedProps:n.container,className:a.section,ownerState:s}),l=(r==null?void 0:r.sectionContent)??Cg,u=ht({elementType:l,externalSlotProps:t==null?void 0:t.sectionContent,externalForwardedProps:n.content,additionalProps:{suppressContentEditableWarning:!0},className:a.sectionContent,ownerState:s}),d=(r==null?void 0:r.sectionSeparator)??Ag,f=ht({elementType:d,externalSlotProps:t==null?void 0:t.sectionSeparator,externalForwardedProps:n.before,ownerState:re({},s,{separatorPosition:"before"})}),h=ht({elementType:d,externalSlotProps:t==null?void 0:t.sectionSeparator,externalForwardedProps:n.after,ownerState:re({},s,{separatorPosition:"after"})});return o.jsxs(i,re({},c,{children:[o.jsx(d,re({},f)),o.jsx(l,re({},u)),o.jsx(d,re({},h))]}))}const mP=C.forwardRef(function(r,t){const n=Ct({props:r,name:"MuiPickersSectionList"}),{slots:a,slotProps:s,elements:i,sectionListRef:c,classes:l}=n,u=Je(n,fP),d=hP(l),{ownerState:f}=lr(),h=C.useRef(null),x=Lr(t,h),p=v=>{if(!h.current)throw new Error(`MUI X: Cannot call sectionListRef.${v} before the mount of the component.`);return h.current};C.useImperativeHandle(c,()=>({getRoot(){return p("getRoot")},getSectionContainer(v){return p("getSectionContainer").querySelector(`.${xi.section}[data-sectionindex="${v}"]`)},getSectionContent(v){return p("getSectionContent").querySelector(`.${xi.section}[data-sectionindex="${v}"] .${xi.sectionContent}`)},getSectionIndexFromDOMElement(v){const y=p("getSectionIndexFromDOMElement");if(v==null||!y.contains(v))return null;let b=null;return v.classList.contains(xi.section)?b=v:v.classList.contains(xi.sectionContent)&&(b=v.parentElement),b==null?null:Number(b.dataset.sectionindex)}}));const m=(a==null?void 0:a.root)??Tg,g=ht({elementType:m,externalSlotProps:s==null?void 0:s.root,externalForwardedProps:u,additionalProps:{ref:x,suppressContentEditableWarning:!0},className:d.root,ownerState:f});return o.jsx(m,re({},g,{children:g.contentEditable?i.map(({content:v,before:y,after:b})=>`${y.children}${v.children}${b.children}`).join(""):o.jsx(C.Fragment,{children:i.map((v,y)=>o.jsx(pP,{slots:a,slotProps:s,element:v,classes:d},y))})}))}),_g=C.createContext(null),$c=()=>{const e=C.useContext(_g);if(e==null)throw new Error(["MUI X: The `usePickerTextFieldOwnerState` can only be called in components that are used inside a PickerTextField component"].join(`
`));return e},xP=["elements","areAllSectionsEmpty","defaultValue","label","value","onChange","id","autoFocus","endAdornment","startAdornment","renderSuffix","slots","slotProps","contentEditable","tabIndex","onInput","onPaste","onKeyDown","fullWidth","name","readOnly","inputProps","inputRef","sectionListRef","onFocus","onBlur","classes","ownerState"],gP=e=>Math.round(e*1e5)/1e5,Uc=Ge("div",{name:"MuiPickersInputBase",slot:"Root"})(({theme:e})=>re({},e.typography.body1,{color:(e.vars||e).palette.text.primary,cursor:"text",padding:0,display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",boxSizing:"border-box",letterSpacing:`${gP(.15/16)}em`,variants:[{props:{isInputInFullWidth:!0},style:{width:"100%"}}]})),_d=Ge(Tg,{name:"MuiPickersInputBase",slot:"SectionsContainer"})(({theme:e})=>({padding:"4px 0 5px",fontFamily:e.typography.fontFamily,fontSize:"inherit",lineHeight:"1.4375em",flexGrow:1,outline:"none",display:"flex",flexWrap:"nowrap",overflow:"hidden",letterSpacing:"inherit",width:"182px",variants:[{props:{fieldDirection:"rtl"},style:{textAlign:"right /*! @noflip */"}},{props:{inputSize:"small"},style:{paddingTop:1}},{props:{hasStartAdornment:!1,isFieldFocused:!1,isFieldValueEmpty:!0},style:{color:"currentColor",opacity:0}},{props:{hasStartAdornment:!1,isFieldFocused:!1,isFieldValueEmpty:!0,inputHasLabel:!1},style:e.vars?{opacity:e.vars.opacity.inputPlaceholder}:{opacity:e.palette.mode==="light"?.42:.5}}]})),vP=Ge(kg,{name:"MuiPickersInputBase",slot:"Section"})(({theme:e})=>({fontFamily:e.typography.fontFamily,fontSize:"inherit",letterSpacing:"inherit",lineHeight:"1.4375em",display:"inline-block",whiteSpace:"nowrap"})),yP=Ge(Cg,{name:"MuiPickersInputBase",slot:"SectionContent",overridesResolver:(e,r)=>r.content})(({theme:e})=>({fontFamily:e.typography.fontFamily,lineHeight:"1.4375em",letterSpacing:"inherit",width:"fit-content",outline:"none"})),bP=Ge(Ag,{name:"MuiPickersInputBase",slot:"Separator"})(()=>({whiteSpace:"pre",letterSpacing:"inherit"})),wP=Ge("input",{name:"MuiPickersInputBase",slot:"Input",overridesResolver:(e,r)=>r.hiddenInput})(re({},CF)),SP=Ge("div",{name:"MuiPickersInputBase",slot:"ActiveBar"})(({theme:e,ownerState:r})=>({display:"none",position:"absolute",height:2,bottom:2,borderTopLeftRadius:2,borderTopRightRadius:2,transition:e.transitions.create(["width","left"],{duration:e.transitions.duration.shortest}),backgroundColor:(e.vars||e).palette.primary.main,'[data-active-range-position="start"] &, [data-active-range-position="end"] &':{display:"block"},'[data-active-range-position="start"] &':{left:r.sectionOffsets[0]},'[data-active-range-position="end"] &':{left:r.sectionOffsets[1]}})),EP=(e,r)=>{const{isFieldFocused:t,isFieldDisabled:n,isFieldReadOnly:a,hasFieldError:s,inputSize:i,isInputInFullWidth:c,inputColor:l,hasStartAdornment:u,hasEndAdornment:d}=r,f={root:["root",t&&!n&&"focused",n&&"disabled",a&&"readOnly",s&&"error",c&&"fullWidth",`color${yF(l)}`,i==="small"&&"inputSizeSmall",u&&"adornedStart",d&&"adornedEnd"],notchedOutline:["notchedOutline"],input:["input"],sectionsContainer:["sectionsContainer"],sectionContent:["sectionContent"],sectionBefore:["sectionBefore"],sectionAfter:["sectionAfter"],activeBar:["activeBar"]};return jt(f,uP,e)};function gh(e,r,t,n){var a;if(e.content.id){const s=(a=r.current)==null?void 0:a.querySelectorAll(`[data-sectionindex="${t}"] [data-range-position="${n}"]`);if(s)return Array.from(s).reduce((i,c)=>i+c.offsetWidth,0)}return 0}function TP(e,r){var a,s,i,c,l;let t=0;if(((a=r.current)==null?void 0:a.getAttribute("data-active-range-position"))==="end")for(let u=e.length-1;u>=e.length/2;u-=1)t+=gh(e[u],r,u,"end");else for(let u=0;u<e.length/2;u+=1)t+=gh(e[u],r,u,"start");return{activeBarWidth:t,sectionOffsets:[((i=(s=r.current)==null?void 0:s.querySelector('[data-sectionindex="0"]'))==null?void 0:i.offsetLeft)||0,((l=(c=r.current)==null?void 0:c.querySelector(`[data-sectionindex="${e.length/2}"]`))==null?void 0:l.offsetLeft)||0]}}const Dd=C.forwardRef(function(r,t){const n=Ct({props:r,name:"MuiPickersInputBase"}),{elements:a,areAllSectionsEmpty:s,value:i,onChange:c,id:l,endAdornment:u,startAdornment:d,renderSuffix:f,slots:h,slotProps:x,contentEditable:p,tabIndex:m,onInput:g,onPaste:v,onKeyDown:y,name:b,readOnly:S,inputProps:I,inputRef:k,sectionListRef:E,onFocus:T,onBlur:w,classes:F,ownerState:P}=n,A=Je(n,xP),L=$c(),Y=C.useRef(null),q=C.useRef(null),Q=C.useRef([]),K=Lr(t,Y),ye=Lr(I==null?void 0:I.ref,k),U=Cp();if(!U)throw new Error("MUI X: PickersInputBase should always be used inside a PickersTextField component");const me=P??L,J=se=>{var j;(j=U.onFocus)==null||j.call(U,se),T==null||T(se)},D=se=>{J(se)},B=se=>{var j,_;if(y==null||y(se),se.key==="Enter"&&!se.defaultMuiPrevented){if((j=Y.current)!=null&&j.dataset.multiInput)return;const ae=(_=Y.current)==null?void 0:_.closest("form"),oe=ae==null?void 0:ae.querySelector('[type="submit"]');if(!ae||!oe)return;se.preventDefault(),ae.requestSubmit(oe)}},V=se=>{var j;(j=U.onBlur)==null||j.call(U,se),w==null||w(se)};C.useEffect(()=>{U&&U.setAdornedStart(!!d)},[U,d]),C.useEffect(()=>{U&&(s?U.onEmpty():U.onFilled())},[U,s]);const W=EP(F,me),Z=(h==null?void 0:h.root)||Uc,fe=ht({elementType:Z,externalSlotProps:x==null?void 0:x.root,externalForwardedProps:A,additionalProps:{"aria-invalid":U.error,ref:K},className:W.root,ownerState:me}),ne=(h==null?void 0:h.input)||_d,ee=a.some(se=>se.content["data-range-position"]!==void 0);return C.useEffect(()=>{if(!ee||!me.isPickerOpen)return;const{activeBarWidth:se,sectionOffsets:j}=TP(a,Y);Q.current=[j[0],j[1]],q.current&&(q.current.style.width=`${se}px`)},[a,ee,me.isPickerOpen]),o.jsxs(Z,re({},fe,{children:[d,o.jsx(mP,{sectionListRef:E,elements:a,contentEditable:p,tabIndex:m,className:W.sectionsContainer,onFocus:J,onBlur:V,onInput:g,onPaste:v,onKeyDown:B,slots:{root:ne,section:vP,sectionContent:yP,sectionSeparator:bP},slotProps:{root:re({},x==null?void 0:x.input,{ownerState:me}),sectionContent:{className:Us.sectionContent},sectionSeparator:({separatorPosition:se})=>({className:se==="before"?Us.sectionBefore:Us.sectionAfter})}}),u,f?f(re({},U)):null,o.jsx(wP,re({name:b,className:W.input,value:i,onChange:c,id:l,"aria-hidden":"true",tabIndex:-1,readOnly:S,required:U.required,disabled:U.disabled,onFocus:D},I,{ref:ye})),ee&&o.jsx(SP,{className:W.activeBar,ref:q,ownerState:{sectionOffsets:Q.current}})]}))});function kP(e){return zt("MuiPickersOutlinedInput",e)}const un=re({},Us,Jt("MuiPickersOutlinedInput",["root","notchedOutline","input"])),AP=["children","className","label","notched","shrink"],CP=Ge("fieldset",{name:"MuiPickersOutlinedInput",slot:"NotchedOutline"})(({theme:e})=>{const r=e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%",borderColor:e.vars?`rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:r}}),vh=Ge("span")(({theme:e})=>({fontFamily:e.typography.fontFamily,fontSize:"inherit"})),_P=Ge("legend",{shouldForwardProp:e=>ao(e)&&e!=="notched"})(({theme:e})=>({float:"unset",width:"auto",overflow:"hidden",variants:[{props:{inputHasLabel:!1},style:{padding:0,lineHeight:"11px",transition:e.transitions.create("width",{duration:150,easing:e.transitions.easing.easeOut})}},{props:{inputHasLabel:!0},style:{display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:e.transitions.create("max-width",{duration:50,easing:e.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}}},{props:{inputHasLabel:!0,notched:!0},style:{maxWidth:"100%",transition:e.transitions.create("max-width",{duration:100,easing:e.transitions.easing.easeOut,delay:50})}}]}));function DP(e){const{className:r,label:t,notched:n}=e,a=Je(e,AP),s=$c();return o.jsx(CP,re({"aria-hidden":!0,className:r},a,{ownerState:s,children:o.jsx(_P,{ownerState:s,notched:n,children:t?o.jsx(vh,{children:t}):o.jsx(vh,{className:"notranslate",children:"â€‹"})})}))}const FP=["label","autoFocus","ownerState","classes","notched"],IP=Ge(Uc,{name:"MuiPickersOutlinedInput",slot:"Root"})(({theme:e})=>{const r=e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{padding:"0 14px",borderRadius:(e.vars||e).shape.borderRadius,[`&:hover .${un.notchedOutline}`]:{borderColor:(e.vars||e).palette.text.primary},"@media (hover: none)":{[`&:hover .${un.notchedOutline}`]:{borderColor:e.vars?`rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:r}},[`&.${un.focused} .${un.notchedOutline}`]:{borderStyle:"solid",borderWidth:2},[`&.${un.disabled}`]:{[`& .${un.notchedOutline}`]:{borderColor:(e.vars||e).palette.action.disabled},"*":{color:(e.vars||e).palette.action.disabled}},[`&.${un.error} .${un.notchedOutline}`]:{borderColor:(e.vars||e).palette.error.main},variants:Object.keys((e.vars??e).palette).filter(t=>{var n;return((n=(e.vars??e).palette[t])==null?void 0:n.main)??!1}).map(t=>({props:{inputColor:t},style:{[`&.${un.focused}:not(.${un.error}) .${un.notchedOutline}`]:{borderColor:(e.vars||e).palette[t].main}}}))}}),PP=Ge(_d,{name:"MuiPickersOutlinedInput",slot:"SectionsContainer"})({padding:"16.5px 0",variants:[{props:{inputSize:"small"},style:{padding:"8.5px 0"}}]}),OP=e=>{const t=jt({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},kP,e);return re({},e,t)},Dg=C.forwardRef(function(r,t){const n=Ct({props:r,name:"MuiPickersOutlinedInput"}),{label:a,classes:s,notched:i}=n,c=Je(n,FP),l=Cp(),u=OP(s);return o.jsx(Dd,re({slots:{root:IP,input:PP},renderSuffix:d=>o.jsx(DP,{shrink:!!(i||d.adornedStart||d.focused||d.filled),notched:!!(i||d.adornedStart||d.focused||d.filled),className:u.notchedOutline,label:a!=null&&a!==""&&(l!=null&&l.required)?o.jsxs(C.Fragment,{children:[a,"â€‰","*"]}):a})},c,{label:a,classes:u,ref:t}))});Dg.muiName="Input";function jP(e){return zt("MuiPickersFilledInput",e)}const Ca=re({},Us,Jt("MuiPickersFilledInput",["root","underline","input"])),RP=["label","autoFocus","disableUnderline","hiddenLabel","classes"],NP=Ge(Uc,{name:"MuiPickersFilledInput",slot:"Root",shouldForwardProp:e=>_p(e)&&e!=="disableUnderline"})(({theme:e})=>{const r=e.palette.mode==="light",t=r?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",n=r?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",a=r?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",s=r?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return{backgroundColor:e.vars?e.vars.palette.FilledInput.bg:n,borderTopLeftRadius:(e.vars||e).shape.borderRadius,borderTopRightRadius:(e.vars||e).shape.borderRadius,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),"&:hover":{backgroundColor:e.vars?e.vars.palette.FilledInput.hoverBg:a,"@media (hover: none)":{backgroundColor:e.vars?e.vars.palette.FilledInput.bg:n}},[`&.${Ca.focused}`]:{backgroundColor:e.vars?e.vars.palette.FilledInput.bg:n},[`&.${Ca.disabled}`]:{backgroundColor:e.vars?e.vars.palette.FilledInput.disabledBg:s},variants:[...Object.keys((e.vars??e).palette).filter(i=>(e.vars??e).palette[i].main).map(i=>{var c;return{props:{inputColor:i,disableUnderline:!1},style:{"&::after":{borderBottom:`2px solid ${(c=(e.vars||e).palette[i])==null?void 0:c.main}`}}}}),{props:{disableUnderline:!1},style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${Ca.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${Ca.error}`]:{"&:before, &:after":{borderBottomColor:(e.vars||e).palette.error.main}},"&::before":{borderBottom:`1px solid ${e.vars?`rgba(${e.vars.palette.common.onBackgroundChannel} / ${e.vars.opacity.inputUnderline})`:t}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:e.transitions.create("border-bottom-color",{duration:e.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${Ca.disabled}, .${Ca.error}):before`]:{borderBottom:`1px solid ${(e.vars||e).palette.text.primary}`},[`&.${Ca.disabled}:before`]:{borderBottomStyle:"dotted"}}},{props:{hasStartAdornment:!0},style:{paddingLeft:12}},{props:{hasEndAdornment:!0},style:{paddingRight:12}}]}}),MP=Ge(_d,{name:"MuiPickersFilledInput",slot:"sectionsContainer",shouldForwardProp:e=>_p(e)&&e!=="hiddenLabel"})({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12,variants:[{props:{inputSize:"small"},style:{paddingTop:21,paddingBottom:4}},{props:{hasStartAdornment:!0},style:{paddingLeft:0}},{props:{hasEndAdornment:!0},style:{paddingRight:0}},{props:{hiddenLabel:!0},style:{paddingTop:16,paddingBottom:17}},{props:{hiddenLabel:!0,inputSize:"small"},style:{paddingTop:8,paddingBottom:9}}]}),LP=(e,r)=>{const{inputHasUnderline:t}=r,a=jt({root:["root",t&&"underline"],input:["input"]},jP,e);return re({},e,a)},Fg=C.forwardRef(function(r,t){const n=Ct({props:r,name:"MuiPickersFilledInput"}),{label:a,disableUnderline:s=!1,hiddenLabel:i=!1,classes:c}=n,l=Je(n,RP),u=$c(),d=re({},u,{inputHasUnderline:!s}),f=LP(c,d);return o.jsx(Dd,re({slots:{root:NP,input:MP},slotProps:{root:{disableUnderline:s},input:{hiddenLabel:i}}},l,{label:a,classes:f,ref:t,ownerState:d}))});Fg.muiName="Input";function BP(e){return zt("MuiPickersFilledInput",e)}const gi=re({},Us,Jt("MuiPickersInput",["root","underline","input"])),$P=["label","autoFocus","disableUnderline","ownerState","classes"],UP=Ge(Uc,{name:"MuiPickersInput",slot:"Root",shouldForwardProp:e=>ao(e)&&e!=="disableUnderline"})(({theme:e})=>{let t=e.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return e.vars&&(t=`rgba(${e.vars.palette.common.onBackgroundChannel} / ${e.vars.opacity.inputUnderline})`),{"label + &":{marginTop:16},variants:[...Object.keys((e.vars??e).palette).filter(n=>(e.vars??e).palette[n].main).map(n=>({props:{inputColor:n},style:{"&::after":{borderBottom:`2px solid ${(e.vars||e).palette[n].main}`}}})),{props:{disableUnderline:!1},style:{"&::after":{background:"red",left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${gi.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${gi.error}`]:{"&:before, &:after":{borderBottomColor:(e.vars||e).palette.error.main}},"&::before":{borderBottom:`1px solid ${t}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:e.transitions.create("border-bottom-color",{duration:e.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${gi.disabled}, .${gi.error}):before`]:{borderBottom:`2px solid ${(e.vars||e).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${t}`}},[`&.${gi.disabled}:before`]:{borderBottomStyle:"dotted"}}}]}}),VP=(e,r)=>{const{inputHasUnderline:t}=r,a=jt({root:["root",!t&&"underline"],input:["input"]},BP,e);return re({},e,a)},Ig=C.forwardRef(function(r,t){const n=Ct({props:r,name:"MuiPickersInput"}),{label:a,disableUnderline:s=!1,classes:i}=n,c=Je(n,$P),l=$c(),u=re({},l,{inputHasUnderline:!s}),d=VP(i,u);return o.jsx(Dd,re({slots:{root:UP},slotProps:{root:{disableUnderline:s}}},c,{label:a,classes:d,ref:t}))});Ig.muiName="Input";const WP=["onFocus","onBlur","className","classes","color","disabled","error","variant","required","InputProps","inputProps","inputRef","sectionListRef","elements","areAllSectionsEmpty","onClick","onKeyDown","onKeyUp","onPaste","onInput","endAdornment","startAdornment","tabIndex","contentEditable","focused","value","onChange","fullWidth","id","name","helperText","FormHelperTextProps","label","InputLabelProps","data-active-range-position"],HP={standard:Ig,filled:Fg,outlined:Dg},zP=Ge(Tt,{name:"MuiPickersTextField",slot:"Root"})({}),GP=(e,r)=>{const{isFieldFocused:t,isFieldDisabled:n,isFieldRequired:a}=r;return jt({root:["root",t&&!n&&"focused",n&&"disabled",a&&"required"]},lP,e)},Pg=C.forwardRef(function(r,t){const n=Ct({props:r,name:"MuiPickersTextField"}),{onFocus:a,onBlur:s,className:i,classes:c,color:l="primary",disabled:u=!1,error:d=!1,variant:f="outlined",required:h=!1,InputProps:x,inputProps:p,inputRef:m,sectionListRef:g,elements:v,areAllSectionsEmpty:y,onClick:b,onKeyDown:S,onKeyUp:I,onPaste:k,onInput:E,endAdornment:T,startAdornment:w,tabIndex:F,contentEditable:P,focused:A,value:L,onChange:Y,fullWidth:q,id:Q,name:K,helperText:ye,FormHelperTextProps:U,label:me,InputLabelProps:J,"data-active-range-position":D}=n,B=Je(n,WP),V=C.useRef(null),W=Lr(t,V),Z=Rc(Q),fe=ye&&Z?`${Z}-helper-text`:void 0,ne=me&&Z?`${Z}-label`:void 0,ee=Cd({disabled:n.disabled,required:n.required,readOnly:x==null?void 0:x.readOnly}),se=C.useMemo(()=>re({},ee,{isFieldValueEmpty:y,isFieldFocused:A??!1,hasFieldError:d??!1,inputSize:n.size??"medium",inputColor:l??"primary",isInputInFullWidth:q??!1,hasStartAdornment:!!(w??(x==null?void 0:x.startAdornment)),hasEndAdornment:!!(T??(x==null?void 0:x.endAdornment)),inputHasLabel:!!me}),[ee,y,A,d,n.size,l,q,w,T,x==null?void 0:x.startAdornment,x==null?void 0:x.endAdornment,me]),j=GP(c,se),_=HP[f];return o.jsx(_g.Provider,{value:se,children:o.jsxs(zP,re({className:Xt(j.root,i),ref:W,focused:A,disabled:u,variant:f,error:d,color:l,fullWidth:q,required:h,ownerState:se},B,{children:[me!=null&&me!==""&&o.jsx(Wt,re({htmlFor:Z,id:ne},J,{children:me})),o.jsx(_,re({elements:v,areAllSectionsEmpty:y,onClick:b,onKeyDown:S,onKeyUp:I,onInput:E,onPaste:k,onFocus:a,onBlur:s,endAdornment:T,startAdornment:w,tabIndex:F,contentEditable:P,value:L,onChange:Y,id:Z,fullWidth:q,inputProps:p,inputRef:m,sectionListRef:g,label:me,name:K,role:"group","aria-labelledby":ne,"aria-describedby":fe,"aria-live":fe?"polite":void 0,"data-active-range-position":D},x)),ye&&o.jsx(rs,re({id:fe},U,{children:ye}))]}))})}),YP=["enableAccessibleFieldDOMStructure"],qP=["InputProps","readOnly","onClear","clearable","clearButtonPosition","openPickerButtonPosition","openPickerAriaLabel"],XP=["onPaste","onKeyDown","inputMode","readOnly","InputProps","inputProps","inputRef","onClear","clearable","clearButtonPosition","openPickerButtonPosition","openPickerAriaLabel"],KP=["ownerState"],JP=["ownerState"],QP=["ownerState"],ZP=["ownerState"],eO=["InputProps","inputProps"],tO=e=>{let{enableAccessibleFieldDOMStructure:r}=e,t=Je(e,YP);if(r){const{InputProps:g,readOnly:v,onClear:y,clearable:b,clearButtonPosition:S,openPickerButtonPosition:I,openPickerAriaLabel:k}=t,E=Je(t,qP);return{clearable:b,onClear:y,clearButtonPosition:S,openPickerButtonPosition:I,openPickerAriaLabel:k,textFieldProps:re({},E,{InputProps:re({},g??{},{readOnly:v})})}}const{onPaste:n,onKeyDown:a,inputMode:s,readOnly:i,InputProps:c,inputProps:l,inputRef:u,onClear:d,clearable:f,clearButtonPosition:h,openPickerButtonPosition:x,openPickerAriaLabel:p}=t,m=Je(t,XP);return{clearable:f,onClear:d,clearButtonPosition:h,openPickerButtonPosition:x,openPickerAriaLabel:p,textFieldProps:re({},m,{InputProps:re({},c??{},{readOnly:i}),inputProps:re({},l??{},{inputMode:s,onPaste:n,onKeyDown:a,ref:u})})}},Fd=C.createContext({slots:{},slotProps:{},inputRef:void 0});function rO(e){var U,me;const{slots:r,slotProps:t,fieldResponse:n,defaultOpenPickerIcon:a}=e,s=wa(),i=kd(),c=C.useContext(Fd),{textFieldProps:l,onClear:u,clearable:d,openPickerAriaLabel:f,clearButtonPosition:h="end",openPickerButtonPosition:x="end"}=tO(n),p=Cd(l),m=$e(J=>{J.preventDefault(),i==null||i.setOpen(D=>!D)}),g=i?i.triggerStatus:"hidden",v=d?h:null,y=g!=="hidden"?x:null,b=(r==null?void 0:r.textField)??c.slots.textField??(n.enableAccessibleFieldDOMStructure===!1?ke:Pg),S=(r==null?void 0:r.inputAdornment)??c.slots.inputAdornment??Fn,I=ht({elementType:S,externalSlotProps:Ho(c.slotProps.inputAdornment,t==null?void 0:t.inputAdornment),additionalProps:{position:"start"},ownerState:re({},p,{position:"start"})}),k=Je(I,KP),E=ht({elementType:S,externalSlotProps:t==null?void 0:t.inputAdornment,additionalProps:{position:"end"},ownerState:re({},p,{position:"end"})}),T=Je(E,JP),w=c.slots.openPickerButton??Ze,F=ht({elementType:w,externalSlotProps:c.slotProps.openPickerButton,additionalProps:{disabled:g==="disabled",onClick:m,"aria-label":f,edge:l.variant!=="standard"?y:!1},ownerState:p}),P=Je(F,QP),A=c.slots.openPickerIcon??a,L=ht({elementType:A,externalSlotProps:c.slotProps.openPickerIcon,ownerState:p}),Y=(r==null?void 0:r.clearButton)??c.slots.clearButton??Ze,q=ht({elementType:Y,externalSlotProps:Ho(c.slotProps.clearButton,t==null?void 0:t.clearButton),className:"clearButton",additionalProps:{title:s.fieldClearLabel,tabIndex:-1,onClick:u,disabled:n.disabled||n.readOnly,edge:l.variant!=="standard"&&v!==y?v:!1},ownerState:p}),Q=Je(q,ZP),K=(r==null?void 0:r.clearIcon)??c.slots.clearIcon??HF,ye=ht({elementType:K,externalSlotProps:Ho(c.slotProps.clearIcon,t==null?void 0:t.clearIcon),additionalProps:{fontSize:"small"},ownerState:p});return l.ref=Lr(l.ref,i==null?void 0:i.rootRef),l.InputProps||(l.InputProps={}),i&&(l.InputProps.ref=i.triggerRef),!((U=l.InputProps)!=null&&U.startAdornment)&&(v==="start"||y==="start")&&(l.InputProps.startAdornment=o.jsxs(S,re({},k,{children:[y==="start"&&o.jsx(w,re({},P,{children:o.jsx(A,re({},L))})),v==="start"&&o.jsx(Y,re({},Q,{children:o.jsx(K,re({},ye))}))]}))),!((me=l.InputProps)!=null&&me.endAdornment)&&(v==="end"||y==="end")&&(l.InputProps.endAdornment=o.jsxs(S,re({},T,{children:[v==="end"&&o.jsx(Y,re({},Q,{children:o.jsx(K,re({},ye))})),y==="end"&&o.jsx(w,re({},P,{children:o.jsx(A,re({},L))}))]}))),v!=null&&(l.sx=[{"& .clearButton":{opacity:1},"@media (pointer: fine)":{"& .clearButton":{opacity:0},"&:hover, &:focus-within":{".clearButton":{opacity:1}}}},...Array.isArray(l.sx)?l.sx:[l.sx]]),o.jsx(b,re({},l))}function Ho(e,r){return e?r?t=>re({},Ki(r,t),Ki(e,t)):e:r}function nO(e){const{ref:r,externalForwardedProps:t,slotProps:n}=e,a=C.useContext(Fd),s=kd(),i=Cd(t),{InputProps:c,inputProps:l}=t,u=Je(t,eO),d=ht({elementType:Pg,externalSlotProps:Ho(a.slotProps.textField,n==null?void 0:n.textField),externalForwardedProps:u,additionalProps:{ref:r,sx:s==null?void 0:s.rootSx,label:s==null?void 0:s.label,name:s==null?void 0:s.name,className:s==null?void 0:s.rootClassName,inputRef:a.inputRef},ownerState:i});return d.inputProps=re({},l,d.inputProps),d.InputProps=re({},c,d.InputProps),d}function Og(e){const{slots:r={},slotProps:t={},inputRef:n,children:a}=e,s=C.useMemo(()=>({inputRef:n,slots:{openPickerButton:r.openPickerButton,openPickerIcon:r.openPickerIcon,textField:r.textField,inputAdornment:r.inputAdornment,clearIcon:r.clearIcon,clearButton:r.clearButton},slotProps:{openPickerButton:t.openPickerButton,openPickerIcon:t.openPickerIcon,textField:t.textField,inputAdornment:t.inputAdornment,clearIcon:t.clearIcon,clearButton:t.clearButton}}),[n,r.openPickerButton,r.openPickerIcon,r.textField,r.inputAdornment,r.clearIcon,r.clearButton,t.openPickerButton,t.openPickerIcon,t.textField,t.inputAdornment,t.clearIcon,t.clearButton]);return o.jsx(Fd.Provider,{value:s,children:a})}const aO=["slots","slotProps"],jg=C.forwardRef(function(r,t){const n=Ct({props:r,name:"MuiDateField"}),{slots:a,slotProps:s}=n,i=Je(n,aO),c=nO({slotProps:s,ref:t,externalForwardedProps:i}),l=cP(c);return o.jsx(rO,{slots:a,slotProps:s,fieldResponse:l,defaultOpenPickerIcon:WF})}),Rg=({shouldDisableDate:e,shouldDisableMonth:r,shouldDisableYear:t,minDate:n,maxDate:a,disableFuture:s,disablePast:i,timezone:c})=>{const l=ms();return C.useCallback(u=>mo({adapter:l,value:u,timezone:c,props:{shouldDisableDate:e,shouldDisableMonth:r,shouldDisableYear:t,minDate:n,maxDate:a,disableFuture:s,disablePast:i}})!==null,[l,e,r,t,n,a,s,i,c])},sO=(e,r)=>(t,n)=>{switch(n.type){case"setVisibleDate":return re({},t,{slideDirection:n.direction,currentMonth:n.month,isMonthSwitchingAnimating:!r.isSameMonth(n.month,t.currentMonth)&&!e&&!n.skipAnimation,focusedDay:n.focusedDay});case"changeMonthTimezone":{const a=n.newTimezone;if(r.getTimezone(t.currentMonth)===a)return t;let s=r.setTimezone(t.currentMonth,a);return r.getMonth(s)!==r.getMonth(t.currentMonth)&&(s=r.setMonth(s,r.getMonth(t.currentMonth))),re({},t,{currentMonth:s})}case"finishMonthSwitchingAnimation":return re({},t,{isMonthSwitchingAnimating:!1});default:throw new Error("missing support")}},iO=e=>{const{value:r,referenceDate:t,disableFuture:n,disablePast:a,maxDate:s,minDate:i,onMonthChange:c,onYearChange:l,reduceAnimations:u,shouldDisableDate:d,timezone:f,getCurrentMonthFromVisibleDate:h}=e,x=yt(),p=C.useRef(sO(!!u,x)).current,m=C.useMemo(()=>Un.getInitialReferenceValue({value:r,utils:x,timezone:f,props:e,referenceDate:t,granularity:Pn.day}),[t,f]),[g,v]=C.useReducer(p,{isMonthSwitchingAnimating:!1,focusedDay:m,currentMonth:x.startOfMonth(m),slideDirection:"left"}),y=Rg({shouldDisableDate:d,minDate:i,maxDate:s,disableFuture:n,disablePast:a,timezone:f});C.useEffect(()=>{v({type:"changeMonthTimezone",newTimezone:x.getTimezone(m)})},[m,x]);const b=$e(({target:I,reason:k})=>{if(k==="cell-interaction"&&g.focusedDay!=null&&x.isSameDay(I,g.focusedDay))return;const E=k==="cell-interaction";let T,w;if(k==="cell-interaction")T=h(I,g.currentMonth),w=I;else if(T=x.isSameMonth(I,g.currentMonth)?g.currentMonth:x.startOfMonth(I),w=I,y(w)){const A=x.startOfMonth(I),L=x.endOfMonth(I);w=Qi({utils:x,date:w,minDate:x.isBefore(i,A)?A:i,maxDate:x.isAfter(s,L)?L:s,disablePast:a,disableFuture:n,isDateDisabled:y,timezone:f})}const F=!x.isSameMonth(g.currentMonth,T),P=!x.isSameYear(g.currentMonth,T);F&&(c==null||c(T)),P&&(l==null||l(x.startOfYear(T))),v({type:"setVisibleDate",month:T,direction:x.isAfterDay(T,g.currentMonth)?"left":"right",focusedDay:g.focusedDay!=null&&w!=null&&x.isSameDay(w,g.focusedDay)?g.focusedDay:w,skipAnimation:E})}),S=C.useCallback(()=>{v({type:"finishMonthSwitchingAnimation"})},[]);return{referenceDate:m,calendarState:g,setVisibleDate:b,isDateDisabled:y,onMonthSwitchingAnimationEnd:S}},oO=e=>zt("MuiPickersFadeTransitionGroup",e);Jt("MuiPickersFadeTransitionGroup",["root"]);const cO=["children"],lO=e=>jt({root:["root"]},oO,e),uO=Ge(Dp,{name:"MuiPickersFadeTransitionGroup",slot:"Root"})({display:"block",position:"relative"});function Ng(e){const r=Ct({props:e,name:"MuiPickersFadeTransitionGroup"}),{className:t,reduceAnimations:n,transKey:a,classes:s}=r,{children:i}=r,c=Je(r,cO),l=lO(s),u=gu();return n?i:o.jsx(uO,{className:Xt(l.root,t),ownerState:c,children:o.jsx(vc,{appear:!1,mountOnEnter:!0,unmountOnExit:!0,timeout:{appear:u.transitions.duration.enteringScreen,enter:u.transitions.duration.enteringScreen,exit:0},children:i},a)})}const dO=e=>zt("MuiPickersSlideTransition",e),Qr=Jt("MuiPickersSlideTransition",["root","slideEnter-left","slideEnter-right","slideEnterActive","slideExit","slideExitActiveLeft-left","slideExitActiveLeft-right"]),fO=["children","className","reduceAnimations","slideDirection","transKey","classes"],hO=(e,r)=>{const{slideDirection:t}=r,n={root:["root"],exit:["slideExit"],enterActive:["slideEnterActive"],enter:[`slideEnter-${t}`],exitActive:[`slideExitActiveLeft-${t}`]};return jt(n,dO,e)},pO=Ge(Dp,{name:"MuiPickersSlideTransition",slot:"Root",overridesResolver:(e,r)=>[r.root,{[`.${Qr["slideEnter-left"]}`]:r["slideEnter-left"]},{[`.${Qr["slideEnter-right"]}`]:r["slideEnter-right"]},{[`.${Qr.slideEnterActive}`]:r.slideEnterActive},{[`.${Qr.slideExit}`]:r.slideExit},{[`.${Qr["slideExitActiveLeft-left"]}`]:r["slideExitActiveLeft-left"]},{[`.${Qr["slideExitActiveLeft-right"]}`]:r["slideExitActiveLeft-right"]}]})(({theme:e})=>{const r=e.transitions.create("transform",{duration:e.transitions.duration.complex,easing:"cubic-bezier(0.35, 0.8, 0.4, 1)"});return{display:"block",position:"relative",overflowX:"hidden","& > *":{position:"absolute",top:0,right:0,left:0},[`& .${Qr["slideEnter-left"]}`]:{willChange:"transform",transform:"translate(100%)",zIndex:1},[`& .${Qr["slideEnter-right"]}`]:{willChange:"transform",transform:"translate(-100%)",zIndex:1},[`& .${Qr.slideEnterActive}`]:{transform:"translate(0%)",transition:r},[`& .${Qr.slideExit}`]:{transform:"translate(0%)"},[`& .${Qr["slideExitActiveLeft-left"]}`]:{willChange:"transform",transform:"translate(-100%)",transition:r,zIndex:0},[`& .${Qr["slideExitActiveLeft-right"]}`]:{willChange:"transform",transform:"translate(100%)",transition:r,zIndex:0}}});function mO(e){const r=Ct({props:e,name:"MuiPickersSlideTransition"}),{children:t,className:n,reduceAnimations:a,slideDirection:s,transKey:i,classes:c}=r,l=Je(r,fO),{ownerState:u}=lr(),d=re({},u,{slideDirection:s}),f=hO(c,d),h=gu();if(a)return o.jsx("div",{className:Xt(f.root,n),children:t});const x={exit:f.exit,enterActive:f.enterActive,enter:f.enter,exitActive:f.exitActive};return o.jsx(pO,{className:Xt(f.root,n),childFactory:p=>C.cloneElement(p,{classNames:x}),role:"presentation",ownerState:d,children:o.jsx(Bv,re({mountOnEnter:!0,unmountOnExit:!0,timeout:h.transitions.duration.complex,classNames:x},l,{children:t}),i)})}const xO=e=>zt("MuiDayCalendar",e);Jt("MuiDayCalendar",["root","header","weekDayLabel","loadingContainer","slideTransition","monthContainer","weekContainer","weekNumberLabel","weekNumber"]);const gO=["parentProps","day","focusedDay","selectedDays","isDateDisabled","currentMonthNumber","isViewFocused"],vO=["ownerState"],yO=e=>jt({root:["root"],header:["header"],weekDayLabel:["weekDayLabel"],loadingContainer:["loadingContainer"],slideTransition:["slideTransition"],monthContainer:["monthContainer"],weekContainer:["weekContainer"],weekNumberLabel:["weekNumberLabel"],weekNumber:["weekNumber"]},xO,e),Mg=(Ji+Mc*2)*6,bO=Ge("div",{name:"MuiDayCalendar",slot:"Root"})({}),wO=Ge("div",{name:"MuiDayCalendar",slot:"Header"})({display:"flex",justifyContent:"center",alignItems:"center"}),SO=Ge(te,{name:"MuiDayCalendar",slot:"WeekDayLabel"})(({theme:e})=>({width:36,height:40,margin:"0 2px",textAlign:"center",display:"flex",justifyContent:"center",alignItems:"center",color:(e.vars||e).palette.text.secondary})),EO=Ge(te,{name:"MuiDayCalendar",slot:"WeekNumberLabel"})(({theme:e})=>({width:36,height:40,margin:"0 2px",textAlign:"center",display:"flex",justifyContent:"center",alignItems:"center",color:(e.vars||e).palette.text.disabled})),TO=Ge(te,{name:"MuiDayCalendar",slot:"WeekNumber"})(({theme:e})=>re({},e.typography.caption,{width:Ji,height:Ji,padding:0,margin:`0 ${Mc}px`,color:(e.vars||e).palette.text.disabled,fontSize:"0.75rem",alignItems:"center",justifyContent:"center",display:"inline-flex"})),kO=Ge("div",{name:"MuiDayCalendar",slot:"LoadingContainer"})({display:"flex",justifyContent:"center",alignItems:"center",minHeight:Mg}),AO=Ge(mO,{name:"MuiDayCalendar",slot:"SlideTransition"})({minHeight:Mg}),CO=Ge("div",{name:"MuiDayCalendar",slot:"MonthContainer"})({overflow:"hidden"}),_O=Ge("div",{name:"MuiDayCalendar",slot:"WeekContainer"})({margin:`${Mc}px 0`,display:"flex",justifyContent:"center"});function DO(e){let{parentProps:r,day:t,focusedDay:n,selectedDays:a,isDateDisabled:s,currentMonthNumber:i,isViewFocused:c}=e,l=Je(e,gO);const{disabled:u,disableHighlightToday:d,isMonthSwitchingAnimating:f,showDaysOutsideCurrentMonth:h,slots:x,slotProps:p,timezone:m}=r,g=yt(),v=Nc(m),y=n!=null&&g.isSameDay(t,n),b=c&&y,S=a.some(Y=>g.isSameDay(Y,t)),I=g.isSameDay(t,v),k=C.useMemo(()=>u||s(t),[u,s,t]),E=C.useMemo(()=>g.getMonth(t)!==i,[g,t,i]),T=hg({day:t,selected:S,disabled:k,today:I,outsideCurrentMonth:E,disableMargin:void 0,disableHighlightToday:d,showDaysOutsideCurrentMonth:h}),w=(x==null?void 0:x.day)??NI,F=ht({elementType:w,externalSlotProps:p==null?void 0:p.day,additionalProps:re({disableHighlightToday:d,showDaysOutsideCurrentMonth:h,role:"gridcell",isAnimating:f,"data-timestamp":g.toJsDate(t).valueOf()},l),ownerState:re({},T,{day:t,isDayDisabled:k,isDaySelected:S})}),P=Je(F,vO),A=C.useMemo(()=>{const Y=g.startOfMonth(g.setMonth(t,i));return h?g.isSameDay(t,g.startOfWeek(Y)):g.isSameDay(t,Y)},[i,t,h,g]),L=C.useMemo(()=>{const Y=g.endOfMonth(g.setMonth(t,i));return h?g.isSameDay(t,g.endOfWeek(Y)):g.isSameDay(t,Y)},[i,t,h,g]);return o.jsx(w,re({},P,{day:t,disabled:k,autoFocus:!E&&b,today:I,outsideCurrentMonth:E,isFirstVisibleCell:A,isLastVisibleCell:L,selected:S,tabIndex:y?0:-1,"aria-selected":S,"aria-current":I?"date":void 0}))}function FO(e){const r=Ct({props:e,name:"MuiDayCalendar"}),t=yt(),{onFocusedDayChange:n,className:a,classes:s,currentMonth:i,selectedDays:c,focusedDay:l,loading:u,onSelectedDaysChange:d,onMonthSwitchingAnimationEnd:f,readOnly:h,reduceAnimations:x,renderLoading:p=()=>o.jsx("span",{children:"..."}),slideDirection:m,TransitionProps:g,disablePast:v,disableFuture:y,minDate:b,maxDate:S,shouldDisableDate:I,shouldDisableMonth:k,shouldDisableYear:E,dayOfWeekFormatter:T=j=>t.format(j,"weekdayShort").charAt(0).toUpperCase(),hasFocus:w,onFocusedViewChange:F,gridLabelId:P,displayWeekNumber:A,fixedWeekNumber:L,timezone:Y}=r,q=Nc(Y),Q=yO(s),K=ra(),ye=Rg({shouldDisableDate:I,shouldDisableMonth:k,shouldDisableYear:E,minDate:b,maxDate:S,disablePast:v,disableFuture:y,timezone:Y}),U=wa(),me=$e(j=>{h||d(j)}),J=j=>{ye(j)||(n(j),F==null||F(!0))},D=$e((j,_)=>{switch(j.key){case"ArrowUp":J(t.addDays(_,-7)),j.preventDefault();break;case"ArrowDown":J(t.addDays(_,7)),j.preventDefault();break;case"ArrowLeft":{const ae=t.addDays(_,K?1:-1),oe=t.addMonths(_,K?1:-1),Te=Qi({utils:t,date:ae,minDate:K?ae:t.startOfMonth(oe),maxDate:K?t.endOfMonth(oe):ae,isDateDisabled:ye,timezone:Y});J(Te||ae),j.preventDefault();break}case"ArrowRight":{const ae=t.addDays(_,K?-1:1),oe=t.addMonths(_,K?-1:1),Te=Qi({utils:t,date:ae,minDate:K?t.startOfMonth(oe):ae,maxDate:K?ae:t.endOfMonth(oe),isDateDisabled:ye,timezone:Y});J(Te||ae),j.preventDefault();break}case"Home":J(t.startOfWeek(_)),j.preventDefault();break;case"End":J(t.endOfWeek(_)),j.preventDefault();break;case"PageUp":J(t.addMonths(_,1)),j.preventDefault();break;case"PageDown":J(t.addMonths(_,-1)),j.preventDefault();break}}),B=$e((j,_)=>J(_)),V=$e((j,_)=>{l!=null&&t.isSameDay(l,_)&&(F==null||F(!1))}),W=t.getMonth(i),Z=t.getYear(i),fe=C.useMemo(()=>c.filter(j=>!!j).map(j=>t.startOfDay(j)),[t,c]),ne=`${Z}-${W}`,ee=C.useMemo(()=>C.createRef(),[ne]),se=C.useMemo(()=>{const j=t.getWeekArray(i);let _=t.addMonths(i,1);for(;L&&j.length<L;){const ae=t.getWeekArray(_),oe=t.isSameDay(j[j.length-1][0],ae[0][0]);ae.slice(oe?1:0).forEach(Te=>{j.length<L&&j.push(Te)}),_=t.addMonths(_,1)}return j},[i,L,t]);return o.jsxs(bO,{role:"grid","aria-labelledby":P,className:Q.root,children:[o.jsxs(wO,{role:"row",className:Q.header,children:[A&&o.jsx(EO,{variant:"caption",role:"columnheader","aria-label":U.calendarWeekNumberHeaderLabel,className:Q.weekNumberLabel,children:U.calendarWeekNumberHeaderText}),fI(t,q).map((j,_)=>o.jsx(SO,{variant:"caption",role:"columnheader","aria-label":t.format(j,"weekday"),className:Q.weekDayLabel,children:T(j)},_.toString()))]}),u?o.jsx(kO,{className:Q.loadingContainer,children:p()}):o.jsx(AO,re({transKey:ne,onExited:f,reduceAnimations:x,slideDirection:m,className:Xt(a,Q.slideTransition)},g,{nodeRef:ee,children:o.jsx(CO,{ref:ee,role:"rowgroup",className:Q.monthContainer,children:se.map((j,_)=>o.jsxs(_O,{role:"row",className:Q.weekContainer,"aria-rowindex":_+1,children:[A&&o.jsx(TO,{className:Q.weekNumber,role:"rowheader","aria-label":U.calendarWeekNumberAriaLabelText(t.getWeekNumber(j[0])),children:U.calendarWeekNumberText(t.getWeekNumber(j[0]))}),j.map((ae,oe)=>o.jsx(DO,{parentProps:r,day:ae,selectedDays:fe,isViewFocused:w,focusedDay:l,onKeyDown:D,onFocus:B,onBlur:V,onDaySelect:me,isDateDisabled:ye,currentMonthNumber:W,"aria-colindex":oe+1},ae.toString()))]},`week-${j[0]}`))})}))]})}function Lg(e){return zt("MuiMonthCalendar",e)}const Po=Jt("MuiMonthCalendar",["root","button","disabled","selected"]),IO=["autoFocus","classes","disabled","selected","value","onClick","onKeyDown","onFocus","onBlur","slots","slotProps"],PO=(e,r)=>{const t={button:["button",r.isMonthDisabled&&"disabled",r.isMonthSelected&&"selected"]};return jt(t,Lg,e)},OO=Ge("button",{name:"MuiMonthCalendar",slot:"Button",overridesResolver:(e,r)=>[r.button,{[`&.${Po.disabled}`]:r.disabled},{[`&.${Po.selected}`]:r.selected}]})(({theme:e})=>re({color:"unset",backgroundColor:"transparent",border:0,outline:0},e.typography.subtitle1,{height:36,width:72,borderRadius:18,cursor:"pointer","&:focus":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:Ys(e.palette.action.active,e.palette.action.hoverOpacity)},"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:Ys(e.palette.action.active,e.palette.action.hoverOpacity)},"&:disabled":{cursor:"auto",pointerEvents:"none"},[`&.${Po.disabled}`]:{color:(e.vars||e).palette.text.secondary},[`&.${Po.selected}`]:{color:(e.vars||e).palette.primary.contrastText,backgroundColor:(e.vars||e).palette.primary.main,"&:focus, &:hover":{backgroundColor:(e.vars||e).palette.primary.dark}}})),jO=C.memo(function(r){const{autoFocus:t,classes:n,disabled:a,selected:s,value:i,onClick:c,onKeyDown:l,onFocus:u,onBlur:d,slots:f,slotProps:h}=r,x=Je(r,IO),p=C.useRef(null),{ownerState:m}=lr(),g=re({},m,{isMonthDisabled:a,isMonthSelected:s}),v=PO(n,g);$n(()=>{var S;t&&((S=p.current)==null||S.focus())},[t]);const y=(f==null?void 0:f.monthButton)??OO,b=ht({elementType:y,externalSlotProps:h==null?void 0:h.monthButton,externalForwardedProps:x,additionalProps:{disabled:a,ref:p,type:"button",role:"radio","aria-checked":s,onClick:S=>c(S,i),onKeyDown:S=>l(S,i),onFocus:S=>u(S,i),onBlur:S=>d(S,i)},ownerState:g,className:v.button});return o.jsx(y,re({},b))}),RO=["autoFocus","className","classes","value","defaultValue","referenceDate","disabled","disableFuture","disablePast","maxDate","minDate","onChange","shouldDisableMonth","readOnly","disableHighlightToday","onMonthFocus","hasFocus","onFocusedViewChange","monthsPerRow","timezone","gridLabelId","slots","slotProps"],NO=e=>jt({root:["root"]},Lg,e);function MO(e,r){const t=Ct({props:e,name:r}),n=xo(t);return re({},t,n,{monthsPerRow:t.monthsPerRow??3})}const LO=Ge("div",{name:"MuiMonthCalendar",slot:"Root",shouldForwardProp:e=>ao(e)&&e!=="monthsPerRow"})({display:"flex",flexWrap:"wrap",justifyContent:"space-evenly",rowGap:16,padding:"8px 0",width:Lc,boxSizing:"border-box",variants:[{props:{monthsPerRow:3},style:{columnGap:24}},{props:{monthsPerRow:4},style:{columnGap:0}}]}),BO=C.forwardRef(function(r,t){const n=MO(r,"MuiMonthCalendar"),{autoFocus:a,className:s,classes:i,value:c,defaultValue:l,referenceDate:u,disabled:d,disableFuture:f,disablePast:h,maxDate:x,minDate:p,onChange:m,shouldDisableMonth:g,readOnly:v,onMonthFocus:y,hasFocus:b,onFocusedViewChange:S,monthsPerRow:I,timezone:k,gridLabelId:E,slots:T,slotProps:w}=n,F=Je(n,RO),{value:P,handleValueChange:A,timezone:L}=po({name:"MonthCalendar",timezone:k,value:c,defaultValue:l,referenceDate:u,onChange:m,valueManager:Un}),Y=Nc(L),q=ra(),Q=yt(),{ownerState:K}=lr(),ye=C.useMemo(()=>Un.getInitialReferenceValue({value:P,utils:Q,props:n,timezone:L,referenceDate:u,granularity:Pn.month}),[]),U=NO(i),me=C.useMemo(()=>Q.getMonth(Y),[Q,Y]),J=C.useMemo(()=>P!=null?Q.getMonth(P):null,[P,Q]),[D,B]=C.useState(()=>J||Q.getMonth(ye)),[V,W]=Ks({name:"MonthCalendar",state:"hasFocus",controlled:b,default:a??!1}),Z=$e(ae=>{W(ae),S&&S(ae)}),fe=C.useCallback(ae=>{const oe=Q.startOfMonth(h&&Q.isAfter(Y,p)?Y:p),Te=Q.startOfMonth(f&&Q.isBefore(Y,x)?Y:x),ce=Q.startOfMonth(ae);return Q.isBefore(ce,oe)||Q.isAfter(ce,Te)?!0:g?g(ce):!1},[f,h,x,p,Y,g,Q]),ne=$e((ae,oe)=>{if(v)return;const Te=Q.setMonth(P??ye,oe);A(Te)}),ee=$e(ae=>{fe(Q.setMonth(P??ye,ae))||(B(ae),Z(!0),y&&y(ae))});C.useEffect(()=>{B(ae=>J!==null&&ae!==J?J:ae)},[J]);const se=$e((ae,oe)=>{switch(ae.key){case"ArrowUp":ee((12+oe-3)%12),ae.preventDefault();break;case"ArrowDown":ee((12+oe+3)%12),ae.preventDefault();break;case"ArrowLeft":ee((12+oe+(q?1:-1))%12),ae.preventDefault();break;case"ArrowRight":ee((12+oe+(q?-1:1))%12),ae.preventDefault();break}}),j=$e((ae,oe)=>{ee(oe)}),_=$e((ae,oe)=>{D===oe&&Z(!1)});return o.jsx(LO,re({ref:t,className:Xt(U.root,s),ownerState:K,role:"radiogroup","aria-labelledby":E,monthsPerRow:I},F,{children:bd(Q,P??ye).map(ae=>{const oe=Q.getMonth(ae),Te=Q.format(ae,"monthShort"),ce=Q.format(ae,"month"),be=oe===J,pe=d||fe(ae);return o.jsx(jO,{selected:be,value:oe,onClick:ne,onKeyDown:se,autoFocus:V&&oe===D,disabled:pe,tabIndex:oe===D&&!pe?0:-1,onFocus:j,onBlur:_,"aria-current":me===oe?"date":void 0,"aria-label":ce,slots:T,slotProps:w,classes:i,children:Te},Te)})}))});function Bg(e){return zt("MuiYearCalendar",e)}const Oo=Jt("MuiYearCalendar",["root","button","disabled","selected"]),$O=["autoFocus","classes","disabled","selected","value","onClick","onKeyDown","onFocus","onBlur","slots","slotProps"],UO=(e,r)=>{const t={button:["button",r.isYearDisabled&&"disabled",r.isYearSelected&&"selected"]};return jt(t,Bg,e)},VO=Ge("button",{name:"MuiYearCalendar",slot:"Button",overridesResolver:(e,r)=>[r.button,{[`&.${Oo.disabled}`]:r.disabled},{[`&.${Oo.selected}`]:r.selected}]})(({theme:e})=>re({color:"unset",backgroundColor:"transparent",border:0,outline:0},e.typography.subtitle1,{height:36,width:72,borderRadius:18,cursor:"pointer","&:focus":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.focusOpacity})`:Ys(e.palette.action.active,e.palette.action.focusOpacity)},"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:Ys(e.palette.action.active,e.palette.action.hoverOpacity)},"&:disabled":{cursor:"auto",pointerEvents:"none"},[`&.${Oo.disabled}`]:{color:(e.vars||e).palette.text.secondary},[`&.${Oo.selected}`]:{color:(e.vars||e).palette.primary.contrastText,backgroundColor:(e.vars||e).palette.primary.main,"&:focus, &:hover":{backgroundColor:(e.vars||e).palette.primary.dark}}})),WO=C.memo(function(r){const{autoFocus:t,classes:n,disabled:a,selected:s,value:i,onClick:c,onKeyDown:l,onFocus:u,onBlur:d,slots:f,slotProps:h}=r,x=Je(r,$O),p=C.useRef(null),{ownerState:m}=lr(),g=re({},m,{isYearDisabled:a,isYearSelected:s}),v=UO(n,g);$n(()=>{var S;t&&((S=p.current)==null||S.focus())},[t]);const y=(f==null?void 0:f.yearButton)??VO,b=ht({elementType:y,externalSlotProps:h==null?void 0:h.yearButton,externalForwardedProps:x,additionalProps:{disabled:a,ref:p,type:"button",role:"radio","aria-checked":s,onClick:S=>c(S,i),onKeyDown:S=>l(S,i),onFocus:S=>u(S,i),onBlur:S=>d(S,i)},ownerState:g,className:v.button});return o.jsx(y,re({},b))}),HO=["autoFocus","className","classes","value","defaultValue","referenceDate","disabled","disableFuture","disablePast","maxDate","minDate","onChange","readOnly","shouldDisableYear","disableHighlightToday","onYearFocus","hasFocus","onFocusedViewChange","yearsOrder","yearsPerRow","timezone","gridLabelId","slots","slotProps"],zO=e=>jt({root:["root"]},Bg,e);function GO(e,r){const t=Ct({props:e,name:r}),n=xo(t);return re({},t,n,{yearsPerRow:t.yearsPerRow??3,yearsOrder:t.yearsOrder??"asc"})}const YO=Ge("div",{name:"MuiYearCalendar",slot:"Root",shouldForwardProp:e=>ao(e)&&e!=="yearsPerRow"})({display:"flex",flexWrap:"wrap",justifyContent:"space-evenly",rowGap:12,padding:"6px 0",overflowY:"auto",height:"100%",width:Lc,maxHeight:oI,boxSizing:"border-box",position:"relative",variants:[{props:{yearsPerRow:3},style:{columnGap:24}},{props:{yearsPerRow:4},style:{columnGap:0,padding:"0 2px"}}]}),qO=Ge("div",{name:"MuiYearCalendar",slot:"ButtonFiller"})({height:36,width:72}),XO=C.forwardRef(function(r,t){const n=GO(r,"MuiYearCalendar"),{autoFocus:a,className:s,classes:i,value:c,defaultValue:l,referenceDate:u,disabled:d,disableFuture:f,disablePast:h,maxDate:x,minDate:p,onChange:m,readOnly:g,shouldDisableYear:v,onYearFocus:y,hasFocus:b,onFocusedViewChange:S,yearsOrder:I,yearsPerRow:k,timezone:E,gridLabelId:T,slots:w,slotProps:F}=n,P=Je(n,HO),{value:A,handleValueChange:L,timezone:Y}=po({name:"YearCalendar",timezone:E,value:c,defaultValue:l,referenceDate:u,onChange:m,valueManager:Un}),q=Nc(Y),Q=ra(),K=yt(),{ownerState:ye}=lr(),U=C.useMemo(()=>Un.getInitialReferenceValue({value:A,utils:K,props:n,timezone:Y,referenceDate:u,granularity:Pn.year}),[]),me=zO(i),J=C.useMemo(()=>K.getYear(q),[K,q]),D=C.useMemo(()=>A!=null?K.getYear(A):null,[A,K]),[B,V]=C.useState(()=>D||K.getYear(U)),[W,Z]=Ks({name:"YearCalendar",state:"hasFocus",controlled:b,default:a??!1}),fe=$e(Oe=>{Z(Oe),S&&S(Oe)}),ne=C.useCallback(Oe=>{if(h&&K.isBeforeYear(Oe,q)||f&&K.isAfterYear(Oe,q)||p&&K.isBeforeYear(Oe,p)||x&&K.isAfterYear(Oe,x))return!0;if(!v)return!1;const He=K.startOfYear(Oe);return v(He)},[f,h,x,p,q,v,K]),ee=$e((Oe,He)=>{if(g)return;const N=K.setYear(A??U,He);L(N)}),se=$e(Oe=>{ne(K.setYear(A??U,Oe))||(V(Oe),fe(!0),y==null||y(Oe))});C.useEffect(()=>{V(Oe=>D!==null&&Oe!==D?D:Oe)},[D]);const j=I!=="desc"?k*1:k*-1,_=Q&&I==="asc"||!Q&&I==="desc"?-1:1,ae=$e((Oe,He)=>{switch(Oe.key){case"ArrowUp":se(He-j),Oe.preventDefault();break;case"ArrowDown":se(He+j),Oe.preventDefault();break;case"ArrowLeft":se(He-_),Oe.preventDefault();break;case"ArrowRight":se(He+_),Oe.preventDefault();break}}),oe=$e((Oe,He)=>{se(He)}),Te=$e((Oe,He)=>{B===He&&fe(!1)}),ce=C.useRef(null),be=Lr(t,ce);C.useEffect(()=>{if(a||ce.current===null)return;const Oe=ce.current.querySelector('[tabindex="0"]');if(!Oe)return;const He=Oe.offsetHeight,N=Oe.offsetTop,ie=ce.current.clientHeight,le=ce.current.scrollTop,we=N+He;He>ie||N<le||(ce.current.scrollTop=we-ie/2-He/2)},[a]);const pe=K.getYearRange([p,x]);I==="desc"&&pe.reverse();let Ce=k-pe.length%k;return Ce===k&&(Ce=0),o.jsxs(YO,re({ref:be,className:Xt(me.root,s),ownerState:ye,role:"radiogroup","aria-labelledby":T,yearsPerRow:k},P,{children:[pe.map(Oe=>{const He=K.getYear(Oe),N=He===D,ie=d||ne(Oe);return o.jsx(WO,{selected:N,value:He,onClick:ee,onKeyDown:ae,autoFocus:W&&He===B,disabled:ie,tabIndex:He===B&&!ie?0:-1,onFocus:oe,onBlur:Te,"aria-current":J===He?"date":void 0,slots:w,slotProps:F,classes:i,children:K.format(Oe,"year")},K.format(Oe,"year"))}),Array.from({length:Ce},(Oe,He)=>o.jsx(qO,{},He))]}))}),KO=e=>zt("MuiPickersCalendarHeader",e),JO=Jt("MuiPickersCalendarHeader",["root","labelContainer","label","switchViewButton","switchViewIcon"]),QO=["slots","slotProps","currentMonth","disabled","disableFuture","disablePast","maxDate","minDate","onMonthChange","onViewChange","view","reduceAnimations","views","labelId","className","classes","timezone","format"],ZO=["ownerState"],ej=e=>jt({root:["root"],labelContainer:["labelContainer"],label:["label"],switchViewButton:["switchViewButton"],switchViewIcon:["switchViewIcon"]},KO,e),tj=Ge("div",{name:"MuiPickersCalendarHeader",slot:"Root"})({display:"flex",alignItems:"center",marginTop:12,marginBottom:4,paddingLeft:24,paddingRight:12,maxHeight:40,minHeight:40}),rj=Ge("div",{name:"MuiPickersCalendarHeader",slot:"LabelContainer"})(({theme:e})=>re({display:"flex",overflow:"hidden",alignItems:"center",cursor:"pointer",marginRight:"auto"},e.typography.body1,{fontWeight:e.typography.fontWeightMedium})),nj=Ge("div",{name:"MuiPickersCalendarHeader",slot:"Label"})({marginRight:6}),aj=Ge(Ze,{name:"MuiPickersCalendarHeader",slot:"SwitchViewButton"})({marginRight:"auto",variants:[{props:{view:"year"},style:{[`.${JO.switchViewIcon}`]:{transform:"rotate(180deg)"}}}]}),sj=Ge($F,{name:"MuiPickersCalendarHeader",slot:"SwitchViewIcon"})(({theme:e})=>({willChange:"transform",transition:e.transitions.create("transform"),transform:"rotate(0deg)"})),ij=C.forwardRef(function(r,t){const n=wa(),a=yt(),s=Ct({props:r,name:"MuiPickersCalendarHeader"}),{slots:i,slotProps:c,currentMonth:l,disabled:u,disableFuture:d,disablePast:f,maxDate:h,minDate:x,onMonthChange:p,onViewChange:m,view:g,reduceAnimations:v,views:y,labelId:b,className:S,classes:I,timezone:k,format:E=`${a.formats.month} ${a.formats.year}`}=s,T=Je(s,QO),{ownerState:w}=lr(),F=ej(I),P=(i==null?void 0:i.switchViewButton)??aj,A=ht({elementType:P,externalSlotProps:c==null?void 0:c.switchViewButton,additionalProps:{size:"small","aria-label":n.calendarViewSwitchingButtonAriaLabel(g)},ownerState:w,className:F.switchViewButton}),L=(i==null?void 0:i.switchViewIcon)??sj,Y=ht({elementType:L,externalSlotProps:c==null?void 0:c.switchViewIcon,ownerState:w,className:F.switchViewIcon}),q=Je(Y,ZO),Q=()=>p(a.addMonths(l,1)),K=()=>p(a.addMonths(l,-1)),ye=sI(l,{disableFuture:d,maxDate:h,timezone:k}),U=iI(l,{disablePast:f,minDate:x,timezone:k}),me=()=>{if(!(y.length===1||!m||u))if(y.length===2)m(y.find(D=>D!==g)||y[0]);else{const D=y.indexOf(g)!==0?0:1;m(y[D])}};if(y.length===1&&y[0]==="year")return null;const J=a.formatByString(l,E);return o.jsxs(tj,re({},T,{ownerState:w,className:Xt(F.root,S),ref:t,children:[o.jsxs(rj,{role:"presentation",onClick:me,ownerState:w,"aria-live":"polite",className:F.labelContainer,children:[o.jsx(Ng,{reduceAnimations:v,transKey:J,children:o.jsx(nj,{id:b,ownerState:w,className:F.label,children:J})}),y.length>1&&!u&&o.jsx(P,re({},A,{children:o.jsx(L,re({},q))}))]}),o.jsx(vc,{in:g==="day",appear:!v,enter:!v,children:o.jsx(ZF,{slots:i,slotProps:c,onGoToPrevious:K,isPreviousDisabled:U,previousLabel:n.previousMonth,onGoToNext:Q,isNextDisabled:ye,nextLabel:n.nextMonth})})]}))}),oj="@media (prefers-reduced-motion: reduce)",Vs=typeof navigator<"u"&&navigator.userAgent.match(/android\s(\d+)|OS\s(\d+)/i),yh=Vs&&Vs[1]?parseInt(Vs[1],10):null,bh=Vs&&Vs[2]?parseInt(Vs[2],10):null,cj=yh&&yh<10||bh&&bh<13||!1;function $g(e){const r=vu(oj,{defaultMatches:!1});return e??(r||cj)}const lj=e=>zt("MuiDateCalendar",e);Jt("MuiDateCalendar",["root","viewTransitionContainer"]);const uj=["autoFocus","onViewChange","value","defaultValue","referenceDate","disableFuture","disablePast","onChange","onYearChange","onMonthChange","reduceAnimations","shouldDisableDate","shouldDisableMonth","shouldDisableYear","view","views","openTo","className","classes","disabled","readOnly","minDate","maxDate","disableHighlightToday","focusedView","onFocusedViewChange","showDaysOutsideCurrentMonth","fixedWeekNumber","dayOfWeekFormatter","slots","slotProps","loading","renderLoading","displayWeekNumber","yearsOrder","yearsPerRow","monthsPerRow","timezone"],dj=e=>jt({root:["root"],viewTransitionContainer:["viewTransitionContainer"]},lj,e);function fj(e,r){const t=Ct({props:e,name:r}),n=$g(t.reduceAnimations),a=xo(t);return re({},t,a,{loading:t.loading??!1,openTo:t.openTo??"day",views:t.views??["year","day"],reduceAnimations:n,renderLoading:t.renderLoading??(()=>o.jsx("span",{children:"..."}))})}const hj=Ge(cI,{name:"MuiDateCalendar",slot:"Root"})({display:"flex",flexDirection:"column",height:yd}),pj=Ge(Ng,{name:"MuiDateCalendar",slot:"ViewTransitionContainer"})({}),mj=C.forwardRef(function(r,t){const n=yt(),{ownerState:a}=lr(),s=Rc(),i=fj(r,"MuiDateCalendar"),{autoFocus:c,onViewChange:l,value:u,defaultValue:d,referenceDate:f,disableFuture:h,disablePast:x,onChange:p,onMonthChange:m,reduceAnimations:g,shouldDisableDate:v,shouldDisableMonth:y,shouldDisableYear:b,view:S,views:I,openTo:k,className:E,classes:T,disabled:w,readOnly:F,minDate:P,maxDate:A,disableHighlightToday:L,focusedView:Y,onFocusedViewChange:q,showDaysOutsideCurrentMonth:Q,fixedWeekNumber:K,dayOfWeekFormatter:ye,slots:U,slotProps:me,loading:J,renderLoading:D,displayWeekNumber:B,yearsOrder:V,yearsPerRow:W,monthsPerRow:Z,timezone:fe}=i,ne=Je(i,uj),{value:ee,handleValueChange:se,timezone:j}=po({name:"DateCalendar",timezone:fe,value:u,defaultValue:d,referenceDate:f,onChange:p,valueManager:Un}),{view:_,setView:ae,focusedView:oe,setFocusedView:Te,goToNextView:ce,setValueAndGoToNextView:be}=og({view:S,views:I,openTo:k,onChange:se,onViewChange:l,autoFocus:c,focusedView:Y,onFocusedViewChange:q}),{referenceDate:pe,calendarState:Ce,setVisibleDate:Oe,isDateDisabled:He,onMonthSwitchingAnimationEnd:N}=iO({value:ee,referenceDate:f,reduceAnimations:g,onMonthChange:m,minDate:P,maxDate:A,shouldDisableDate:v,disablePast:x,disableFuture:h,timezone:j,getCurrentMonthFromVisibleDate:(it,Rt)=>n.isSameMonth(it,Rt)?Rt:n.startOfMonth(it)}),ie=w&&ee||P,le=w&&ee||A,we=`${s}-grid-label`,Ae=oe!==null,Le=(U==null?void 0:U.calendarHeader)??ij,Ue=ht({elementType:Le,externalSlotProps:me==null?void 0:me.calendarHeader,additionalProps:{views:I,view:_,currentMonth:Ce.currentMonth,onViewChange:ae,onMonthChange:it=>Oe({target:it,reason:"header-navigation"}),minDate:ie,maxDate:le,disabled:w,disablePast:x,disableFuture:h,reduceAnimations:g,timezone:j,labelId:we},ownerState:a}),Fe=$e(it=>{const Rt=n.startOfMonth(it),Qt=n.endOfMonth(it),_r=He(it)?Qi({utils:n,date:it,minDate:n.isBefore(P,Rt)?Rt:P,maxDate:n.isAfter(A,Qt)?Qt:A,disablePast:x,disableFuture:h,isDateDisabled:He,timezone:j}):it;_r?(be(_r,"finish"),Oe({target:_r,reason:"cell-interaction"})):(ce(),Oe({target:Rt,reason:"cell-interaction"}))}),Pe=$e(it=>{const Rt=n.startOfYear(it),Qt=n.endOfYear(it),_r=He(it)?Qi({utils:n,date:it,minDate:n.isBefore(P,Rt)?Rt:P,maxDate:n.isAfter(A,Qt)?Qt:A,disablePast:x,disableFuture:h,isDateDisabled:He,timezone:j}):it;_r?(be(_r,"finish"),Oe({target:_r,reason:"cell-interaction"})):(ce(),Oe({target:Rt,reason:"cell-interaction"}))}),Ve=$e(it=>se(it&&uc(n,it,ee??pe),"finish",_));C.useEffect(()=>{n.isValid(ee)&&Oe({target:ee,reason:"controlled-value-change"})},[ee]);const Ye=dj(T),et={disablePast:x,disableFuture:h,maxDate:A,minDate:P},ut={disableHighlightToday:L,readOnly:F,disabled:w,timezone:j,gridLabelId:we,slots:U,slotProps:me},ar=C.useRef(_);C.useEffect(()=>{ar.current!==_&&(oe===ar.current&&Te(_,!0),ar.current=_)},[oe,Te,_]);const Bt=C.useMemo(()=>[ee],[ee]);return o.jsxs(hj,re({ref:t,className:Xt(Ye.root,E),ownerState:a},ne,{children:[o.jsx(Le,re({},Ue,{slots:U,slotProps:me})),o.jsx(pj,{reduceAnimations:g,className:Ye.viewTransitionContainer,transKey:_,ownerState:a,children:o.jsxs("div",{children:[_==="year"&&o.jsx(XO,re({},et,ut,{value:ee,onChange:Pe,shouldDisableYear:b,hasFocus:Ae,onFocusedViewChange:it=>Te("year",it),yearsOrder:V,yearsPerRow:W,referenceDate:pe})),_==="month"&&o.jsx(BO,re({},et,ut,{hasFocus:Ae,className:E,value:ee,onChange:Fe,shouldDisableMonth:y,onFocusedViewChange:it=>Te("month",it),monthsPerRow:Z,referenceDate:pe})),_==="day"&&o.jsx(FO,re({},Ce,et,ut,{onMonthSwitchingAnimationEnd:N,hasFocus:Ae,onFocusedDayChange:it=>Oe({target:it,reason:"cell-interaction"}),reduceAnimations:g,selectedDays:Bt,onSelectedDaysChange:Ve,shouldDisableDate:v,shouldDisableMonth:y,shouldDisableYear:b,onFocusedViewChange:it=>Te("day",it),showDaysOutsideCurrentMonth:Q,fixedWeekNumber:K,dayOfWeekFormatter:ye,displayWeekNumber:B,loading:J,renderLoading:D}))]})})]}))});function xj(e){return zt("MuiPickersToolbar",e)}Jt("MuiPickersToolbar",["root","title","content"]);function Ug(){const{ownerState:e}=lr(),r=ra();return C.useMemo(()=>re({},e,{toolbarDirection:r?"rtl":"ltr"}),[e,r])}const gj=["children","className","classes","toolbarTitle","hidden","titleId","classes","landscapeDirection"],vj=e=>jt({root:["root"],title:["title"],content:["content"]},xj,e),yj=Ge("div",{name:"MuiPickersToolbar",slot:"Root"})(({theme:e})=>({display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"space-between",padding:e.spacing(2,3),variants:[{props:{pickerOrientation:"landscape"},style:{height:"auto",maxWidth:160,padding:16,justifyContent:"flex-start",flexWrap:"wrap"}}]})),bj=Ge("div",{name:"MuiPickersToolbar",slot:"Content",shouldForwardProp:e=>ao(e)&&e!=="landscapeDirection"})({display:"flex",flexWrap:"wrap",width:"100%",flex:1,justifyContent:"space-between",alignItems:"center",flexDirection:"row",variants:[{props:{pickerOrientation:"landscape"},style:{justifyContent:"flex-start",alignItems:"flex-start",flexDirection:"column"}},{props:{pickerOrientation:"landscape",landscapeDirection:"row"},style:{flexDirection:"row"}}]}),wj=C.forwardRef(function(r,t){const n=Ct({props:r,name:"MuiPickersToolbar"}),{children:a,className:s,classes:i,toolbarTitle:c,hidden:l,titleId:u,landscapeDirection:d}=n,f=Je(n,gj),h=Ug(),x=vj(i);return l?null:o.jsxs(yj,re({ref:t,className:Xt(x.root,s),ownerState:h},f,{children:[o.jsx(te,{color:"text.secondary",variant:"overline",id:u,className:x.title,children:c}),o.jsx(bj,{className:x.content,ownerState:h,landscapeDirection:d,children:a})]}))});function Sj(e){return zt("MuiDatePickerToolbar",e)}Jt("MuiDatePickerToolbar",["root","title"]);const Ej=["toolbarFormat","toolbarPlaceholder","className","classes"],Tj=e=>jt({root:["root"],title:["title"]},Sj,e),kj=Ge(wj,{name:"MuiDatePickerToolbar",slot:"Root"})({}),Aj=Ge(te,{name:"MuiDatePickerToolbar",slot:"Title"})({variants:[{props:{pickerOrientation:"landscape"},style:{margin:"auto 16px auto auto"}}]}),Cj=C.forwardRef(function(r,t){const n=Ct({props:r,name:"MuiDatePickerToolbar"}),{toolbarFormat:a,toolbarPlaceholder:s="â€“â€“",className:i,classes:c}=n,l=Je(n,Ej),u=yt(),{value:d,views:f,orientation:h}=ii(),x=wa(),p=Ug(),m=Tj(c),g=C.useMemo(()=>{if(!u.isValid(d))return s;const v=wd(u,{format:a,views:f},!0);return u.formatByString(d,v)},[d,a,s,u,f]);return o.jsx(kj,re({ref:t,toolbarTitle:x.datePickerToolbarTitle,className:Xt(m.root,i)},l,{children:o.jsx(Aj,{variant:"h4",align:h==="landscape"?"left":"center",ownerState:p,className:m.title,children:g})}))});function Vg(e,r){const t=Ct({props:e,name:r}),n=xo(t),a=C.useMemo(()=>{var s;return((s=t.localeText)==null?void 0:s.toolbarTitle)==null?t.localeText:re({},t.localeText,{datePickerToolbarTitle:t.localeText.toolbarTitle})},[t.localeText]);return re({},t,n,{localeText:a},eI({views:t.views,openTo:t.openTo,defaultViews:["year","day"],defaultOpenTo:"day"}),{slots:re({toolbar:Cj},t.slots)})}function _j(e){return zt("MuiPickerPopper",e)}Jt("MuiPickerPopper",["root","paper"]);const Dj=["PaperComponent","ownerState","children","paperSlotProps","paperClasses","onPaperClick","onPaperTouchStart"],Fj=e=>jt({root:["root"],paper:["paper"]},_j,e),Ij=Ge($v,{name:"MuiPickerPopper",slot:"Root"})(({theme:e})=>({zIndex:e.zIndex.modal})),Pj=Ge(st,{name:"MuiPickerPopper",slot:"Paper"})({outline:0,transformOrigin:"top center",variants:[{props:({popperPlacement:e})=>["top","top-start","top-end"].includes(e),style:{transformOrigin:"bottom center"}}]});function Oj(e,r){return r.documentElement.clientWidth<e.clientX||r.documentElement.clientHeight<e.clientY}function jj(e,r){const t=C.useRef(!1),n=C.useRef(!1),a=C.useRef(null),s=C.useRef(!1);C.useEffect(()=>{if(!e)return;function l(){s.current=!0}return document.addEventListener("mousedown",l,!0),document.addEventListener("touchstart",l,!0),()=>{document.removeEventListener("mousedown",l,!0),document.removeEventListener("touchstart",l,!0),s.current=!1}},[e]);const i=$e(l=>{if(!s.current)return;const u=n.current;n.current=!1;const d=wl(a.current);if(!a.current||"clientX"in l&&Oj(l,d))return;if(t.current){t.current=!1;return}let f;l.composedPath?f=l.composedPath().indexOf(a.current)>-1:f=!d.documentElement.contains(l.target)||a.current.contains(l.target),!f&&!u&&r(l)}),c=()=>{n.current=!0};return C.useEffect(()=>{if(e){const l=wl(a.current),u=()=>{t.current=!0};return l.addEventListener("touchstart",i),l.addEventListener("touchmove",u),()=>{l.removeEventListener("touchstart",i),l.removeEventListener("touchmove",u)}}},[e,i]),C.useEffect(()=>{if(e){const l=wl(a.current);return l.addEventListener("click",i),()=>{l.removeEventListener("click",i),n.current=!1}}},[e,i]),[a,c,c]}const Rj=C.forwardRef((e,r)=>{const{PaperComponent:t,ownerState:n,children:a,paperSlotProps:s,paperClasses:i,onPaperClick:c,onPaperTouchStart:l}=e,u=Je(e,Dj),d=ht({elementType:t,externalSlotProps:s,additionalProps:{tabIndex:-1,elevation:8,ref:r},className:i,ownerState:n});return o.jsx(t,re({},u,d,{onClick:f=>{var h;c(f),(h=d.onClick)==null||h.call(d,f)},onTouchStart:f=>{var h;l(f),(h=d.onTouchStart)==null||h.call(d,f)},ownerState:n,children:a}))});function Nj(e){const r=Ct({props:e,name:"MuiPickerPopper"}),{children:t,placement:n="bottom-start",slots:a,slotProps:s,classes:i}=r,{open:c,popupRef:l,reduceAnimations:u}=ii(),{dismissViews:d,getCurrentViewMode:f,onPopperExited:h,triggerElement:x,viewContainerRole:p}=lr();C.useEffect(()=>{function K(ye){c&&ye.key==="Escape"&&d()}return document.addEventListener("keydown",K),()=>{document.removeEventListener("keydown",K)}},[d,c]);const m=C.useRef(null);C.useEffect(()=>{p==="tooltip"||f()==="field"||(c?m.current=pr(document):m.current&&m.current instanceof HTMLElement&&setTimeout(()=>{m.current instanceof HTMLElement&&m.current.focus()}))},[c,p,f]);const g=Fj(i),{ownerState:v,rootRefObject:y}=lr(),b=re({},v,{popperPlacement:n}),S=$e(()=>{p==="tooltip"?_I(()=>{var K,ye;(K=y.current)!=null&&K.contains(pr(document))||(ye=l.current)!=null&&ye.contains(pr(document))||d()}):d()}),[I,k,E]=jj(c,S),T=C.useRef(null),w=Lr(T,l),F=Lr(w,I),P=K=>{K.key==="Escape"&&(K.stopPropagation(),d())},A=(a==null?void 0:a.desktopTransition)??u?vc:Uv,L=(a==null?void 0:a.desktopTrapFocus)??Vv,Y=(a==null?void 0:a.desktopPaper)??Pj,q=(a==null?void 0:a.popper)??Ij,Q=ht({elementType:q,externalSlotProps:s==null?void 0:s.popper,additionalProps:{transition:!0,role:p??void 0,open:c,placement:n,anchorEl:x,onKeyDown:P},className:g.root,ownerState:b});return o.jsx(q,re({},Q,{children:({TransitionProps:K})=>o.jsx(L,re({open:c,disableAutoFocus:!0,disableRestoreFocus:!0,disableEnforceFocus:p==="tooltip",isEnabled:()=>!0},s==null?void 0:s.desktopTrapFocus,{children:o.jsx(A,re({},K,s==null?void 0:s.desktopTransition,{onExited:ye=>{var U,me,J;h==null||h(),(me=(U=s==null?void 0:s.desktopTransition)==null?void 0:U.onExited)==null||me.call(U,ye),(J=K==null?void 0:K.onExited)==null||J.call(K)},children:o.jsx(Rj,{PaperComponent:Y,ownerState:b,ref:F,onPaperClick:k,onPaperTouchStart:E,paperClasses:g.paper,paperSlotProps:s==null?void 0:s.desktopPaper,children:t})}))}))}))}function wh(){return typeof window>"u"?"portrait":window.screen&&window.screen.orientation&&window.screen.orientation.angle?Math.abs(window.screen.orientation.angle)===90?"landscape":"portrait":window.orientation&&Math.abs(Number(window.orientation))===90?"landscape":"portrait"}function Mj(e,r){const[t,n]=C.useState(wh);return $n(()=>{const a=()=>{n(wh())};return window.addEventListener("orientationchange",a),()=>{window.removeEventListener("orientationchange",a)}},[]),CI(e,["hours","minutes","seconds"])?"portrait":r??t}function Lj(e){const{props:r,valueManager:t,validator:n}=e,{value:a,defaultValue:s,onChange:i,referenceDate:c,timezone:l,onAccept:u,closeOnSelect:d,open:f,onOpen:h,onClose:x}=r,{current:p}=C.useRef(s),{current:m}=C.useRef(a!==void 0),{current:g}=C.useRef(f!==void 0),v=yt(),{timezone:y,value:b,handleValueChange:S}=po({name:"a picker component",timezone:l,value:a,defaultValue:p,referenceDate:c,onChange:i,valueManager:t}),[I,k]=C.useState(()=>({open:!1,lastExternalValue:b,clockShallowValue:void 0,lastCommittedValue:b,hasBeenModifiedSinceMount:!1})),{getValidationErrorForNewValue:E}=bg({props:r,validator:n,timezone:y,value:b,onError:r.onError}),T=$e(A=>{const L=typeof A=="function"?A(I.open):A;g||k(Y=>re({},Y,{open:L})),L&&h&&h(),L||x==null||x()}),w=$e((A,L)=>{const{changeImportance:Y="accept",skipPublicationIfPristine:q=!1,validationError:Q,shortcut:K,shouldClose:ye=Y==="accept"}=L??{};let U,me;!q&&!m&&!I.hasBeenModifiedSinceMount?(U=!0,me=Y==="accept"):(U=!t.areValuesEqual(v,A,b),me=Y==="accept"&&!t.areValuesEqual(v,A,I.lastCommittedValue)),k(B=>re({},B,{clockShallowValue:U?void 0:B.clockShallowValue,lastCommittedValue:me?b:B.lastCommittedValue,hasBeenModifiedSinceMount:!0}));let J=null;const D=()=>(J||(J={validationError:Q??E(A)},K&&(J.shortcut=K)),J);U&&S(A,D()),me&&u&&u(A,D()),ye&&T(!1)});b!==I.lastExternalValue&&k(A=>re({},A,{lastExternalValue:b,clockShallowValue:void 0,hasBeenModifiedSinceMount:!0}));const F=$e((A,L="partial")=>{if(L==="shallow"){k(Y=>re({},Y,{clockShallowValue:A,hasBeenModifiedSinceMount:!0}));return}w(A,{changeImportance:L==="finish"&&d?"accept":"set"})});C.useEffect(()=>{if(g){if(f===void 0)throw new Error("You must not mix controlling and uncontrolled mode for `open` prop");k(A=>re({},A,{open:f}))}},[g,f]);const P=C.useMemo(()=>t.cleanValue(v,I.clockShallowValue===void 0?b:I.clockShallowValue),[v,t,I.clockShallowValue,b]);return{timezone:y,state:I,setValue:w,setValueFromView:F,setOpen:T,value:b,viewValue:P}}const Bj=["className","sx"],Wg=({ref:e,props:r,valueManager:t,valueType:n,variant:a,validator:s,onPopperExited:i,autoFocusView:c,rendererInterceptor:l,localeText:u,viewContainerRole:d,getStepNavigation:f})=>{const{views:h,view:x,openTo:p,onViewChange:m,viewRenderers:g,reduceAnimations:v,orientation:y,disableOpenPicker:b,closeOnSelect:S,disabled:I,readOnly:k,formatDensity:E,enableAccessibleFieldDOMStructure:T,selectedSections:w,onSelectedSectionsChange:F,format:P,label:A,autoFocus:L,name:Y}=r,{className:q,sx:Q}=r,K=Je(r,Bj),ye=Rc(),U=yt(),me=ms(),J=$g(v),D=Mj(h,y),{current:B}=C.useRef(p??null),[V,W]=C.useState(null),Z=C.useRef(null),fe=C.useRef(null),ne=C.useRef(null),ee=Lr(e,ne),{timezone:se,state:j,setOpen:_,setValue:ae,setValueFromView:oe,value:Te,viewValue:ce}=Lj({props:r,valueManager:t,validator:s}),{view:be,setView:pe,defaultView:Ce,focusedView:Oe,setFocusedView:He,setValueAndGoToNextView:N,goToNextStep:ie,hasNextStep:le,hasSeveralSteps:we}=og({view:x,views:h,openTo:p,onChange:oe,onViewChange:m,autoFocus:c,getStepNavigation:f}),Ae=$e(()=>ae(t.emptyValue)),Le=$e(()=>ae(t.getTodayValue(U,se,n))),Ue=$e(()=>ae(Te)),Fe=$e(()=>ae(j.lastCommittedValue,{skipPublicationIfPristine:!0})),Pe=$e(()=>{ae(Te,{skipPublicationIfPristine:!0})}),{hasUIView:Ve,viewModeLookup:Ye,timeViewsCount:et}=C.useMemo(()=>h.reduce((Dt,Br)=>{const wo=g[Br]==null?"field":"UI";return Dt.viewModeLookup[Br]=wo,wo==="UI"&&(Dt.hasUIView=!0,rI(Br)&&(Dt.timeViewsCount+=1)),Dt},{hasUIView:!1,viewModeLookup:{},timeViewsCount:0}),[g,h]),ut=Ye[be],ar=$e(()=>ut),[Bt,it]=C.useState(ut==="UI"?be:null);Bt!==be&&Ye[be]==="UI"&&it(be),$n(()=>{ut==="field"&&j.open&&(_(!1),setTimeout(()=>{var Dt,Br;(Dt=fe==null?void 0:fe.current)==null||Dt.setSelectedSections(be),(Br=fe==null?void 0:fe.current)==null||Br.focusField(be)}))},[be]),$n(()=>{if(!j.open)return;let Dt=be;ut==="field"&&Bt!=null&&(Dt=Bt),Dt!==Ce&&Ye[Dt]==="UI"&&Ye[Ce]==="UI"&&(Dt=Ce),Dt!==be&&pe(Dt),He(Dt,!0)},[j.open]);const Rt=C.useMemo(()=>({isPickerValueEmpty:t.areValuesEqual(U,Te,t.emptyValue),isPickerOpen:j.open,isPickerDisabled:r.disabled??!1,isPickerReadOnly:r.readOnly??!1,pickerOrientation:D,pickerVariant:a}),[U,t,Te,j.open,D,a,r.disabled,r.readOnly]),Qt=C.useMemo(()=>b||!Ve?"hidden":I||k?"disabled":"enabled",[b,Ve,I,k]),_r=$e(ie),Es=C.useMemo(()=>S&&!we?[]:["cancel","nextOrAccept"],[S,we]),Dr=C.useMemo(()=>({setValue:ae,setOpen:_,clearValue:Ae,setValueToToday:Le,acceptValueChanges:Ue,cancelValueChanges:Fe,setView:pe,goToNextStep:_r}),[ae,_,Ae,Le,Ue,Fe,pe,_r]),Ts=C.useMemo(()=>re({},Dr,{value:Te,timezone:se,open:j.open,views:h,view:Bt,initialView:B,disabled:I??!1,readOnly:k??!1,autoFocus:L??!1,variant:a,orientation:D,popupRef:Z,reduceAnimations:J,triggerRef:W,triggerStatus:Qt,hasNextStep:le,fieldFormat:P??"",name:Y,label:A,rootSx:Q,rootRef:ee,rootClassName:q}),[Dr,Te,ee,a,D,J,I,k,P,q,Y,A,Q,Qt,le,se,j.open,Bt,h,B,L]),Qc=C.useMemo(()=>({dismissViews:Pe,ownerState:Rt,hasUIView:Ve,getCurrentViewMode:ar,rootRefObject:ne,labelId:ye,triggerElement:V,viewContainerRole:d,defaultActionBarActions:Es,onPopperExited:i}),[Pe,Rt,Ve,ar,ye,V,d,Es,i]),Zc=C.useMemo(()=>({formatDensity:E,enableAccessibleFieldDOMStructure:T,selectedSections:w,onSelectedSectionsChange:F,fieldRef:fe}),[E,T,w,F,fe]);return{providerProps:{localeText:u,contextValue:Ts,privateContextValue:Qc,actionsContextValue:Dr,fieldPrivateContextValue:Zc,isValidContextValue:Dt=>{const Br=s({adapter:me,value:Dt,timezone:se,props:r});return!t.hasError(Br)}},renderCurrentView:()=>{if(Bt==null)return null;const Dt=g[Bt];if(Dt==null)return null;const Br=re({},K,{views:h,timezone:se,value:ce,onChange:N,view:Bt,onViewChange:pe,showViewSwitcher:et>1,timeViewsCount:et},d==="tooltip"?{focusedView:null,onFocusedViewChange:()=>{}}:{focusedView:Oe,onFocusedViewChange:He});return l?o.jsx(l,{viewRenderers:g,popperView:Bt,rendererProps:Br}):Dt(Br)},ownerState:Rt}};function Hg(e){return zt("MuiPickersLayout",e)}const _a=Jt("MuiPickersLayout",["root","landscape","contentWrapper","toolbar","actionBar","tabs","shortcuts"]),$j=["actions"],Uj=Ge(Nr,{name:"MuiPickersLayout",slot:"ActionBar"})({});function Vj(e){const{actions:r}=e,t=Je(e,$j),n=wa(),{clearValue:a,setValueToToday:s,acceptValueChanges:i,cancelValueChanges:c,goToNextStep:l,hasNextStep:u}=ii();if(r==null||r.length===0)return null;const d=r==null?void 0:r.map(f=>{switch(f){case"clear":return o.jsx(Me,{onClick:a,children:n.clearButtonLabel},f);case"cancel":return o.jsx(Me,{onClick:c,children:n.cancelButtonLabel},f);case"accept":return o.jsx(Me,{onClick:i,children:n.okButtonLabel},f);case"today":return o.jsx(Me,{onClick:s,children:n.todayButtonLabel},f);case"next":return o.jsx(Me,{onClick:l,children:n.nextStepButtonLabel},f);case"nextOrAccept":return u?o.jsx(Me,{onClick:l,children:n.nextStepButtonLabel},f):o.jsx(Me,{onClick:i,children:n.okButtonLabel},f);default:return null}});return o.jsx(Uj,re({},t,{children:d}))}const Wj=C.memo(Vj),Hj=["items","changeImportance"],zj=["getValue"],Gj=Ge(Ga,{name:"MuiPickersLayout",slot:"Shortcuts"})({});function Yj(e){const{items:r,changeImportance:t="accept"}=e,n=Je(e,Hj),{setValue:a}=zI(),s=GF();if(r==null||r.length===0)return null;const i=r.map(c=>{let{getValue:l}=c,u=Je(c,zj);const d=l({isValid:s});return re({},u,{label:u.label,onClick:()=>{a(d,{changeImportance:t,shortcut:u})},disabled:!s(d)})});return o.jsx(Gj,re({dense:!0,sx:[{maxHeight:yd,maxWidth:200,overflow:"auto"},...Array.isArray(n.sx)?n.sx:[n.sx]]},n,{children:i.map(c=>o.jsx(Ya,{children:o.jsx(Yt,re({},c))},c.id??c.label))}))}const qj=["ownerState"];function Xj(e){return e.view!==null}const Kj=(e,r)=>{const{pickerOrientation:t}=r;return jt({root:["root",t==="landscape"&&"landscape"],contentWrapper:["contentWrapper"],toolbar:["toolbar"],actionBar:["actionBar"],tabs:["tabs"],landscape:["landscape"],shortcuts:["shortcuts"]},Hg,e)},Jj=e=>{const{ownerState:r,defaultActionBarActions:t}=lr(),{view:n}=ii(),a=ra(),{children:s,slots:i,slotProps:c,classes:l}=e,u=C.useMemo(()=>re({},r,{layoutDirection:a?"rtl":"ltr"}),[r,a]),d=Kj(l,u),f=(i==null?void 0:i.actionBar)??Wj,h=ht({elementType:f,externalSlotProps:c==null?void 0:c.actionBar,additionalProps:{actions:t},className:d.actionBar,ownerState:u}),x=Je(h,qj),p=o.jsx(f,re({},x)),m=i==null?void 0:i.toolbar,g=ht({elementType:m,externalSlotProps:c==null?void 0:c.toolbar,className:d.toolbar,ownerState:u}),v=Xj(g)&&m?o.jsx(m,re({},g)):null,y=s,b=i==null?void 0:i.tabs,S=n&&b?o.jsx(b,re({className:d.tabs},c==null?void 0:c.tabs)):null,I=(i==null?void 0:i.shortcuts)??Yj,k=ht({elementType:I,externalSlotProps:c==null?void 0:c.shortcuts,className:d.shortcuts,ownerState:u}),E=n&&I?o.jsx(I,re({},k)):null;return{toolbar:v,content:y,tabs:S,actionBar:p,shortcuts:E,ownerState:u}},Qj=Jj,Zj=(e,r)=>{const{pickerOrientation:t}=r;return jt({root:["root",t==="landscape"&&"landscape"],contentWrapper:["contentWrapper"]},Hg,e)},e4=Ge("div",{name:"MuiPickersLayout",slot:"Root"})({display:"grid",gridAutoColumns:"max-content auto max-content",gridAutoRows:"max-content auto max-content",[`& .${_a.actionBar}`]:{gridColumn:"1 / 4",gridRow:3},variants:[{props:{pickerOrientation:"landscape"},style:{[`& .${_a.toolbar}`]:{gridColumn:1,gridRow:"2 / 3"},[`.${_a.shortcuts}`]:{gridColumn:"2 / 4",gridRow:1}}},{props:{pickerOrientation:"landscape",layoutDirection:"rtl"},style:{[`& .${_a.toolbar}`]:{gridColumn:3}}},{props:{pickerOrientation:"portrait"},style:{[`& .${_a.toolbar}`]:{gridColumn:"2 / 4",gridRow:1},[`& .${_a.shortcuts}`]:{gridColumn:1,gridRow:"2 / 3"}}},{props:{pickerOrientation:"portrait",layoutDirection:"rtl"},style:{[`& .${_a.shortcuts}`]:{gridColumn:3}}}]}),t4=Ge("div",{name:"MuiPickersLayout",slot:"ContentWrapper"})({gridColumn:"2 / 4",gridRow:2,display:"flex",flexDirection:"column"}),zg=C.forwardRef(function(r,t){const n=Ct({props:r,name:"MuiPickersLayout"}),{toolbar:a,content:s,tabs:i,actionBar:c,shortcuts:l,ownerState:u}=Qj(n),{orientation:d,variant:f}=ii(),{sx:h,className:x,classes:p}=n,m=Zj(p,u);return o.jsxs(e4,{ref:t,sx:h,className:Xt(m.root,x),ownerState:u,children:[d==="landscape"?l:a,d==="landscape"?a:l,o.jsx(t4,{className:m.contentWrapper,ownerState:u,children:f==="desktop"?o.jsxs(C.Fragment,{children:[s,i]}):o.jsxs(C.Fragment,{children:[i,s]})}),c]})});function Gg(e){const{steps:r}=e;return aI({steps:r,isViewMatchingStep:(t,n)=>n.views==null||n.views.includes(t),onStepChange:({step:t,defaultView:n,setView:a,view:s,views:i})=>{const c=t.views==null?n:t.views.find(l=>i.includes(l));c!==s&&a(c)}})}const r4=["props","steps"],n4=["ownerState"],a4=e=>{var k;let{props:r,steps:t}=e,n=Je(e,r4);const{slots:a,slotProps:s,label:i,inputRef:c,localeText:l}=r,u=Gg({steps:t}),{providerProps:d,renderCurrentView:f,ownerState:h}=Wg(re({},n,{props:r,localeText:l,autoFocusView:!0,viewContainerRole:"dialog",variant:"desktop",getStepNavigation:u})),x=d.privateContextValue.labelId,p=((k=s==null?void 0:s.toolbar)==null?void 0:k.hidden)??!1,m=a.field,g=ht({elementType:m,externalSlotProps:s==null?void 0:s.field,additionalProps:re({},p&&{id:x}),ownerState:h}),v=Je(g,n4),y=a.layout??zg;let b=x;p&&(i?b=`${x}-label`:b=void 0);const S=re({},s,{toolbar:re({},s==null?void 0:s.toolbar,{titleId:x}),popper:re({"aria-labelledby":b},s==null?void 0:s.popper)});return{renderPicker:()=>o.jsx(sg,re({},d,{children:o.jsxs(Og,{slots:a,slotProps:S,inputRef:c,children:[o.jsx(m,re({},v)),o.jsx(Nj,{slots:a,slotProps:S,children:o.jsx(y,re({},S==null?void 0:S.layout,{slots:a,slotProps:S,children:f()}))})]})}))}},Ws=({view:e,onViewChange:r,views:t,focusedView:n,onFocusedViewChange:a,value:s,defaultValue:i,referenceDate:c,onChange:l,className:u,classes:d,disableFuture:f,disablePast:h,minDate:x,maxDate:p,shouldDisableDate:m,shouldDisableMonth:g,shouldDisableYear:v,reduceAnimations:y,onMonthChange:b,monthsPerRow:S,onYearChange:I,yearsOrder:k,yearsPerRow:E,slots:T,slotProps:w,loading:F,renderLoading:P,disableHighlightToday:A,readOnly:L,disabled:Y,showDaysOutsideCurrentMonth:q,dayOfWeekFormatter:Q,sx:K,autoFocus:ye,fixedWeekNumber:U,displayWeekNumber:me,timezone:J})=>o.jsx(mj,{view:e,onViewChange:r,views:t.filter(oh),focusedView:n&&oh(n)?n:null,onFocusedViewChange:a,value:s,defaultValue:i,referenceDate:c,onChange:l,className:u,classes:d,disableFuture:f,disablePast:h,minDate:x,maxDate:p,shouldDisableDate:m,shouldDisableMonth:g,shouldDisableYear:v,reduceAnimations:y,onMonthChange:b,monthsPerRow:S,onYearChange:I,yearsOrder:k,yearsPerRow:E,slots:T,slotProps:w,loading:F,renderLoading:P,disableHighlightToday:A,readOnly:L,disabled:Y,showDaysOutsideCurrentMonth:q,dayOfWeekFormatter:Q,sx:K,autoFocus:ye,fixedWeekNumber:U,displayWeekNumber:me,timezone:J}),Yg=C.forwardRef(function(r,t){var l;const n=yt(),a=Vg(r,"MuiDesktopDatePicker"),s=re({day:Ws,month:Ws,year:Ws},a.viewRenderers),i=re({},a,{closeOnSelect:a.closeOnSelect??!0,viewRenderers:s,format:wd(n,a,!1),yearsPerRow:a.yearsPerRow??4,slots:re({field:jg},a.slots),slotProps:re({},a.slotProps,{field:u=>{var d;return re({},Ki((d=a.slotProps)==null?void 0:d.field,u),gg(a))},toolbar:re({hidden:!0},(l=a.slotProps)==null?void 0:l.toolbar)})}),{renderPicker:c}=a4({ref:t,props:i,valueManager:Un,valueType:"date",validator:mo,steps:null});return c()});Yg.propTypes={autoFocus:ve.bool,className:ve.string,closeOnSelect:ve.bool,dayOfWeekFormatter:ve.func,defaultValue:ve.object,disabled:ve.bool,disableFuture:ve.bool,disableHighlightToday:ve.bool,disableOpenPicker:ve.bool,disablePast:ve.bool,displayWeekNumber:ve.bool,enableAccessibleFieldDOMStructure:ve.any,fixedWeekNumber:ve.number,format:ve.string,formatDensity:ve.oneOf(["dense","spacious"]),inputRef:Jx,label:ve.node,loading:ve.bool,localeText:ve.object,maxDate:ve.object,minDate:ve.object,monthsPerRow:ve.oneOf([3,4]),name:ve.string,onAccept:ve.func,onChange:ve.func,onClose:ve.func,onError:ve.func,onMonthChange:ve.func,onOpen:ve.func,onSelectedSectionsChange:ve.func,onViewChange:ve.func,onYearChange:ve.func,open:ve.bool,openTo:ve.oneOf(["day","month","year"]),orientation:ve.oneOf(["landscape","portrait"]),readOnly:ve.bool,reduceAnimations:ve.bool,referenceDate:ve.object,renderLoading:ve.func,selectedSections:ve.oneOfType([ve.oneOf(["all","day","empty","hours","meridiem","minutes","month","seconds","weekDay","year"]),ve.number]),shouldDisableDate:ve.func,shouldDisableMonth:ve.func,shouldDisableYear:ve.func,showDaysOutsideCurrentMonth:ve.bool,slotProps:ve.object,slots:ve.object,sx:ve.oneOfType([ve.arrayOf(ve.oneOfType([ve.func,ve.object,ve.bool])),ve.func,ve.object]),timezone:ve.string,value:ve.object,view:ve.oneOf(["day","month","year"]),viewRenderers:ve.shape({day:ve.func,month:ve.func,year:ve.func}),views:ve.arrayOf(ve.oneOf(["day","month","year"]).isRequired),yearsOrder:ve.oneOf(["asc","desc"]),yearsPerRow:ve.oneOf([3,4])};const s4=Ge(kr)({[`& .${vf.container}`]:{outline:0},[`& .${vf.paper}`]:{outline:0,minWidth:Lc}}),i4=Ge(Rr)({"&:first-of-type":{padding:0}});function o4(e){const{children:r,slots:t,slotProps:n}=e,{open:a}=ii(),{dismissViews:s,onPopperExited:i}=lr(),c=(t==null?void 0:t.dialog)??s4,l=(t==null?void 0:t.mobileTransition)??vc;return o.jsx(c,re({open:a,onClose:()=>{s(),i==null||i()}},n==null?void 0:n.dialog,{TransitionComponent:l,TransitionProps:n==null?void 0:n.mobileTransition,PaperComponent:t==null?void 0:t.mobilePaper,PaperProps:n==null?void 0:n.mobilePaper,children:o.jsx(i4,{children:r})}))}const c4=["props","steps"],l4=["ownerState"],u4=e=>{var k;let{props:r,steps:t}=e,n=Je(e,c4);const{slots:a,slotProps:s,label:i,inputRef:c,localeText:l}=r,u=Gg({steps:t}),{providerProps:d,renderCurrentView:f,ownerState:h}=Wg(re({},n,{props:r,localeText:l,autoFocusView:!0,viewContainerRole:"dialog",variant:"mobile",getStepNavigation:u})),x=d.privateContextValue.labelId,p=((k=s==null?void 0:s.toolbar)==null?void 0:k.hidden)??!1,m=a.field,g=ht({elementType:m,externalSlotProps:s==null?void 0:s.field,additionalProps:re({},p&&{id:x}),ownerState:h}),v=Je(g,l4),y=a.layout??zg;let b=x;p&&(i?b=`${x}-label`:b=void 0);const S=re({},s,{toolbar:re({},s==null?void 0:s.toolbar,{titleId:x}),mobilePaper:re({"aria-labelledby":b},s==null?void 0:s.mobilePaper)});return{renderPicker:()=>o.jsx(sg,re({},d,{children:o.jsxs(Og,{slots:a,slotProps:S,inputRef:c,children:[o.jsx(m,re({},v)),o.jsx(o4,{slots:a,slotProps:S,children:o.jsx(y,re({},S==null?void 0:S.layout,{slots:a,slotProps:S,children:f()}))})]})}))}},qg=C.forwardRef(function(r,t){var l;const n=yt(),a=Vg(r,"MuiMobileDatePicker"),s=re({day:Ws,month:Ws,year:Ws},a.viewRenderers),i=re({},a,{viewRenderers:s,format:wd(n,a,!1),slots:re({field:jg},a.slots),slotProps:re({},a.slotProps,{field:u=>{var d;return re({},Ki((d=a.slotProps)==null?void 0:d.field,u),gg(a))},toolbar:re({hidden:!1},(l=a.slotProps)==null?void 0:l.toolbar)})}),{renderPicker:c}=u4({ref:t,props:i,valueManager:Un,valueType:"date",validator:mo,steps:null});return c()});qg.propTypes={autoFocus:ve.bool,className:ve.string,closeOnSelect:ve.bool,dayOfWeekFormatter:ve.func,defaultValue:ve.object,disabled:ve.bool,disableFuture:ve.bool,disableHighlightToday:ve.bool,disableOpenPicker:ve.bool,disablePast:ve.bool,displayWeekNumber:ve.bool,enableAccessibleFieldDOMStructure:ve.any,fixedWeekNumber:ve.number,format:ve.string,formatDensity:ve.oneOf(["dense","spacious"]),inputRef:Jx,label:ve.node,loading:ve.bool,localeText:ve.object,maxDate:ve.object,minDate:ve.object,monthsPerRow:ve.oneOf([3,4]),name:ve.string,onAccept:ve.func,onChange:ve.func,onClose:ve.func,onError:ve.func,onMonthChange:ve.func,onOpen:ve.func,onSelectedSectionsChange:ve.func,onViewChange:ve.func,onYearChange:ve.func,open:ve.bool,openTo:ve.oneOf(["day","month","year"]),orientation:ve.oneOf(["landscape","portrait"]),readOnly:ve.bool,reduceAnimations:ve.bool,referenceDate:ve.object,renderLoading:ve.func,selectedSections:ve.oneOfType([ve.oneOf(["all","day","empty","hours","meridiem","minutes","month","seconds","weekDay","year"]),ve.number]),shouldDisableDate:ve.func,shouldDisableMonth:ve.func,shouldDisableYear:ve.func,showDaysOutsideCurrentMonth:ve.bool,slotProps:ve.object,slots:ve.object,sx:ve.oneOfType([ve.arrayOf(ve.oneOfType([ve.func,ve.object,ve.bool])),ve.func,ve.object]),timezone:ve.string,value:ve.object,view:ve.oneOf(["day","month","year"]),viewRenderers:ve.shape({day:ve.func,month:ve.func,year:ve.func}),views:ve.arrayOf(ve.oneOf(["day","month","year"]).isRequired),yearsOrder:ve.oneOf(["asc","desc"]),yearsPerRow:ve.oneOf([3,4])};const d4=["desktopModeMediaQuery"],f4=C.forwardRef(function(r,t){const n=Ct({props:r,name:"MuiDatePicker"}),{desktopModeMediaQuery:a=DI}=n,s=Je(n,d4);return vu(a,{defaultMatches:!0})?o.jsx(Yg,re({ref:t},s)):o.jsx(qg,re({ref:t},s))}),Xg=6048e5,h4=864e5,Vc=6e4,Wc=36e5,p4=1e3,Sh=Symbol.for("constructDateFrom");function vt(e,r){return typeof e=="function"?e(r):e&&typeof e=="object"&&Sh in e?e[Sh](r):e instanceof Date?new e.constructor(r):new Date(r)}function qe(e,r){return vt(r||e,e)}function Hc(e,r,t){const n=qe(e,t==null?void 0:t.in);return isNaN(r)?vt((t==null?void 0:t.in)||e,NaN):(r&&n.setDate(n.getDate()+r),n)}function Kg(e,r,t){return vt((t==null?void 0:t.in)||e,+qe(e)+r)}function m4(e,r,t){return Kg(e,r*1e3,t)}function x4(e,r,t){const n=qe(e,t==null?void 0:t.in);return n.setTime(n.getTime()+r*Vc),n}function g4(e,r,t){return Kg(e,r*Wc,t)}function v4(e,r,t){return Hc(e,r*7,t)}function Jg(e,r,t){const n=qe(e,t==null?void 0:t.in);if(isNaN(r))return vt((t==null?void 0:t.in)||e,NaN);if(!r)return n;const a=n.getDate(),s=vt((t==null?void 0:t.in)||e,n.getTime());s.setMonth(n.getMonth()+r+1,0);const i=s.getDate();return a>=i?s:(n.setFullYear(s.getFullYear(),s.getMonth(),a),n)}function y4(e,r,t){return Jg(e,r*12,t)}function Eh(e,r){const t=qe(e,r==null?void 0:r.in);return t.setHours(23,59,59,999),t}let b4={};function xs(){return b4}function w4(e,r){var c,l,u,d;const t=xs(),n=(r==null?void 0:r.weekStartsOn)??((l=(c=r==null?void 0:r.locale)==null?void 0:c.options)==null?void 0:l.weekStartsOn)??t.weekStartsOn??((d=(u=t.locale)==null?void 0:u.options)==null?void 0:d.weekStartsOn)??0,a=qe(e,r==null?void 0:r.in),s=a.getDay(),i=(s<n?-7:0)+6-(s-n);return a.setDate(a.getDate()+i),a.setHours(23,59,59,999),a}function Th(e,r){const t=qe(e,r==null?void 0:r.in),n=t.getFullYear();return t.setFullYear(n+1,0,0),t.setHours(23,59,59,999),t}const S4={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},E4=(e,r,t)=>{let n;const a=S4[e];return typeof a=="string"?n=a:r===1?n=a.one:n=a.other.replace("{{count}}",r.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+n:n+" ago":n};function Sl(e){return(r={})=>{const t=r.width?String(r.width):e.defaultWidth;return e.formats[t]||e.formats[e.defaultWidth]}}const T4={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},k4={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},A4={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},C4={date:Sl({formats:T4,defaultWidth:"full"}),time:Sl({formats:k4,defaultWidth:"full"}),dateTime:Sl({formats:A4,defaultWidth:"full"})},_4={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},D4=(e,r,t,n)=>_4[e];function vi(e){return(r,t)=>{const n=t!=null&&t.context?String(t.context):"standalone";let a;if(n==="formatting"&&e.formattingValues){const i=e.defaultFormattingWidth||e.defaultWidth,c=t!=null&&t.width?String(t.width):i;a=e.formattingValues[c]||e.formattingValues[i]}else{const i=e.defaultWidth,c=t!=null&&t.width?String(t.width):e.defaultWidth;a=e.values[c]||e.values[i]}const s=e.argumentCallback?e.argumentCallback(r):r;return a[s]}}const F4={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},I4={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},P4={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},O4={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},j4={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},R4={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},N4=(e,r)=>{const t=Number(e),n=t%100;if(n>20||n<10)switch(n%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},M4={ordinalNumber:N4,era:vi({values:F4,defaultWidth:"wide"}),quarter:vi({values:I4,defaultWidth:"wide",argumentCallback:e=>e-1}),month:vi({values:P4,defaultWidth:"wide"}),day:vi({values:O4,defaultWidth:"wide"}),dayPeriod:vi({values:j4,defaultWidth:"wide",formattingValues:R4,defaultFormattingWidth:"wide"})};function yi(e){return(r,t={})=>{const n=t.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],s=r.match(a);if(!s)return null;const i=s[0],c=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(c)?B4(c,f=>f.test(i)):L4(c,f=>f.test(i));let u;u=e.valueCallback?e.valueCallback(l):l,u=t.valueCallback?t.valueCallback(u):u;const d=r.slice(i.length);return{value:u,rest:d}}}function L4(e,r){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&r(e[t]))return t}function B4(e,r){for(let t=0;t<e.length;t++)if(r(e[t]))return t}function $4(e){return(r,t={})=>{const n=r.match(e.matchPattern);if(!n)return null;const a=n[0],s=r.match(e.parsePattern);if(!s)return null;let i=e.valueCallback?e.valueCallback(s[0]):s[0];i=t.valueCallback?t.valueCallback(i):i;const c=r.slice(a.length);return{value:i,rest:c}}}const U4=/^(\d+)(th|st|nd|rd)?/i,V4=/\d+/i,W4={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},H4={any:[/^b/i,/^(a|c)/i]},z4={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},G4={any:[/1/i,/2/i,/3/i,/4/i]},Y4={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},q4={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},X4={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},K4={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},J4={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Q4={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Z4={ordinalNumber:$4({matchPattern:U4,parsePattern:V4,valueCallback:e=>parseInt(e,10)}),era:yi({matchPatterns:W4,defaultMatchWidth:"wide",parsePatterns:H4,defaultParseWidth:"any"}),quarter:yi({matchPatterns:z4,defaultMatchWidth:"wide",parsePatterns:G4,defaultParseWidth:"any",valueCallback:e=>e+1}),month:yi({matchPatterns:Y4,defaultMatchWidth:"wide",parsePatterns:q4,defaultParseWidth:"any"}),day:yi({matchPatterns:X4,defaultMatchWidth:"wide",parsePatterns:K4,defaultParseWidth:"any"}),dayPeriod:yi({matchPatterns:J4,defaultMatchWidth:"any",parsePatterns:Q4,defaultParseWidth:"any"})},Id={code:"en-US",formatDistance:E4,formatLong:C4,formatRelative:D4,localize:M4,match:Z4,options:{weekStartsOn:0,firstWeekContainsDate:1}};function dc(e){const r=qe(e),t=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()));return t.setUTCFullYear(r.getFullYear()),+e-+t}function go(e,...r){const t=vt.bind(null,e||r.find(n=>typeof n=="object"));return r.map(t)}function Zi(e,r){const t=qe(e,r==null?void 0:r.in);return t.setHours(0,0,0,0),t}function eR(e,r,t){const[n,a]=go(t==null?void 0:t.in,e,r),s=Zi(n),i=Zi(a),c=+s-dc(s),l=+i-dc(i);return Math.round((c-l)/h4)}function Qg(e,r){const t=qe(e,r==null?void 0:r.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}function tR(e,r){const t=qe(e,r==null?void 0:r.in);return eR(t,Qg(t))+1}function ea(e,r){var c,l,u,d;const t=xs(),n=(r==null?void 0:r.weekStartsOn)??((l=(c=r==null?void 0:r.locale)==null?void 0:c.options)==null?void 0:l.weekStartsOn)??t.weekStartsOn??((d=(u=t.locale)==null?void 0:u.options)==null?void 0:d.weekStartsOn)??0,a=qe(e,r==null?void 0:r.in),s=a.getDay(),i=(s<n?7:0)+s-n;return a.setDate(a.getDate()-i),a.setHours(0,0,0,0),a}function Js(e,r){return ea(e,{...r,weekStartsOn:1})}function Zg(e,r){const t=qe(e,r==null?void 0:r.in),n=t.getFullYear(),a=vt(t,0);a.setFullYear(n+1,0,4),a.setHours(0,0,0,0);const s=Js(a),i=vt(t,0);i.setFullYear(n,0,4),i.setHours(0,0,0,0);const c=Js(i);return t.getTime()>=s.getTime()?n+1:t.getTime()>=c.getTime()?n:n-1}function rR(e,r){const t=Zg(e,r),n=vt((r==null?void 0:r.in)||e,0);return n.setFullYear(t,0,4),n.setHours(0,0,0,0),Js(n)}function e1(e,r){const t=qe(e,r==null?void 0:r.in),n=+Js(t)-+rR(t);return Math.round(n/Xg)+1}function Pd(e,r){var d,f,h,x;const t=qe(e,r==null?void 0:r.in),n=t.getFullYear(),a=xs(),s=(r==null?void 0:r.firstWeekContainsDate)??((f=(d=r==null?void 0:r.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??a.firstWeekContainsDate??((x=(h=a.locale)==null?void 0:h.options)==null?void 0:x.firstWeekContainsDate)??1,i=vt((r==null?void 0:r.in)||e,0);i.setFullYear(n+1,0,s),i.setHours(0,0,0,0);const c=ea(i,r),l=vt((r==null?void 0:r.in)||e,0);l.setFullYear(n,0,s),l.setHours(0,0,0,0);const u=ea(l,r);return+t>=+c?n+1:+t>=+u?n:n-1}function nR(e,r){var c,l,u,d;const t=xs(),n=(r==null?void 0:r.firstWeekContainsDate)??((l=(c=r==null?void 0:r.locale)==null?void 0:c.options)==null?void 0:l.firstWeekContainsDate)??t.firstWeekContainsDate??((d=(u=t.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??1,a=Pd(e,r),s=vt((r==null?void 0:r.in)||e,0);return s.setFullYear(a,0,n),s.setHours(0,0,0,0),ea(s,r)}function Od(e,r){const t=qe(e,r==null?void 0:r.in),n=+ea(t,r)-+nR(t,r);return Math.round(n/Xg)+1}function pt(e,r){const t=e<0?"-":"",n=Math.abs(e).toString().padStart(r,"0");return t+n}const oa={y(e,r){const t=e.getFullYear(),n=t>0?t:1-t;return pt(r==="yy"?n%100:n,r.length)},M(e,r){const t=e.getMonth();return r==="M"?String(t+1):pt(t+1,2)},d(e,r){return pt(e.getDate(),r.length)},a(e,r){const t=e.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(e,r){return pt(e.getHours()%12||12,r.length)},H(e,r){return pt(e.getHours(),r.length)},m(e,r){return pt(e.getMinutes(),r.length)},s(e,r){return pt(e.getSeconds(),r.length)},S(e,r){const t=r.length,n=e.getMilliseconds(),a=Math.trunc(n*Math.pow(10,t-3));return pt(a,r.length)}},Ds={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},kh={G:function(e,r,t){const n=e.getFullYear()>0?1:0;switch(r){case"G":case"GG":case"GGG":return t.era(n,{width:"abbreviated"});case"GGGGG":return t.era(n,{width:"narrow"});case"GGGG":default:return t.era(n,{width:"wide"})}},y:function(e,r,t){if(r==="yo"){const n=e.getFullYear(),a=n>0?n:1-n;return t.ordinalNumber(a,{unit:"year"})}return oa.y(e,r)},Y:function(e,r,t,n){const a=Pd(e,n),s=a>0?a:1-a;if(r==="YY"){const i=s%100;return pt(i,2)}return r==="Yo"?t.ordinalNumber(s,{unit:"year"}):pt(s,r.length)},R:function(e,r){const t=Zg(e);return pt(t,r.length)},u:function(e,r){const t=e.getFullYear();return pt(t,r.length)},Q:function(e,r,t){const n=Math.ceil((e.getMonth()+1)/3);switch(r){case"Q":return String(n);case"QQ":return pt(n,2);case"Qo":return t.ordinalNumber(n,{unit:"quarter"});case"QQQ":return t.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,r,t){const n=Math.ceil((e.getMonth()+1)/3);switch(r){case"q":return String(n);case"qq":return pt(n,2);case"qo":return t.ordinalNumber(n,{unit:"quarter"});case"qqq":return t.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,r,t){const n=e.getMonth();switch(r){case"M":case"MM":return oa.M(e,r);case"Mo":return t.ordinalNumber(n+1,{unit:"month"});case"MMM":return t.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(n,{width:"wide",context:"formatting"})}},L:function(e,r,t){const n=e.getMonth();switch(r){case"L":return String(n+1);case"LL":return pt(n+1,2);case"Lo":return t.ordinalNumber(n+1,{unit:"month"});case"LLL":return t.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(n,{width:"wide",context:"standalone"})}},w:function(e,r,t,n){const a=Od(e,n);return r==="wo"?t.ordinalNumber(a,{unit:"week"}):pt(a,r.length)},I:function(e,r,t){const n=e1(e);return r==="Io"?t.ordinalNumber(n,{unit:"week"}):pt(n,r.length)},d:function(e,r,t){return r==="do"?t.ordinalNumber(e.getDate(),{unit:"date"}):oa.d(e,r)},D:function(e,r,t){const n=tR(e);return r==="Do"?t.ordinalNumber(n,{unit:"dayOfYear"}):pt(n,r.length)},E:function(e,r,t){const n=e.getDay();switch(r){case"E":case"EE":case"EEE":return t.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(n,{width:"short",context:"formatting"});case"EEEE":default:return t.day(n,{width:"wide",context:"formatting"})}},e:function(e,r,t,n){const a=e.getDay(),s=(a-n.weekStartsOn+8)%7||7;switch(r){case"e":return String(s);case"ee":return pt(s,2);case"eo":return t.ordinalNumber(s,{unit:"day"});case"eee":return t.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(a,{width:"short",context:"formatting"});case"eeee":default:return t.day(a,{width:"wide",context:"formatting"})}},c:function(e,r,t,n){const a=e.getDay(),s=(a-n.weekStartsOn+8)%7||7;switch(r){case"c":return String(s);case"cc":return pt(s,r.length);case"co":return t.ordinalNumber(s,{unit:"day"});case"ccc":return t.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(a,{width:"narrow",context:"standalone"});case"cccccc":return t.day(a,{width:"short",context:"standalone"});case"cccc":default:return t.day(a,{width:"wide",context:"standalone"})}},i:function(e,r,t){const n=e.getDay(),a=n===0?7:n;switch(r){case"i":return String(a);case"ii":return pt(a,r.length);case"io":return t.ordinalNumber(a,{unit:"day"});case"iii":return t.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(n,{width:"short",context:"formatting"});case"iiii":default:return t.day(n,{width:"wide",context:"formatting"})}},a:function(e,r,t){const a=e.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,r,t){const n=e.getHours();let a;switch(n===12?a=Ds.noon:n===0?a=Ds.midnight:a=n/12>=1?"pm":"am",r){case"b":case"bb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,r,t){const n=e.getHours();let a;switch(n>=17?a=Ds.evening:n>=12?a=Ds.afternoon:n>=4?a=Ds.morning:a=Ds.night,r){case"B":case"BB":case"BBB":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,r,t){if(r==="ho"){let n=e.getHours()%12;return n===0&&(n=12),t.ordinalNumber(n,{unit:"hour"})}return oa.h(e,r)},H:function(e,r,t){return r==="Ho"?t.ordinalNumber(e.getHours(),{unit:"hour"}):oa.H(e,r)},K:function(e,r,t){const n=e.getHours()%12;return r==="Ko"?t.ordinalNumber(n,{unit:"hour"}):pt(n,r.length)},k:function(e,r,t){let n=e.getHours();return n===0&&(n=24),r==="ko"?t.ordinalNumber(n,{unit:"hour"}):pt(n,r.length)},m:function(e,r,t){return r==="mo"?t.ordinalNumber(e.getMinutes(),{unit:"minute"}):oa.m(e,r)},s:function(e,r,t){return r==="so"?t.ordinalNumber(e.getSeconds(),{unit:"second"}):oa.s(e,r)},S:function(e,r){return oa.S(e,r)},X:function(e,r,t){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(r){case"X":return Ch(n);case"XXXX":case"XX":return Pa(n);case"XXXXX":case"XXX":default:return Pa(n,":")}},x:function(e,r,t){const n=e.getTimezoneOffset();switch(r){case"x":return Ch(n);case"xxxx":case"xx":return Pa(n);case"xxxxx":case"xxx":default:return Pa(n,":")}},O:function(e,r,t){const n=e.getTimezoneOffset();switch(r){case"O":case"OO":case"OOO":return"GMT"+Ah(n,":");case"OOOO":default:return"GMT"+Pa(n,":")}},z:function(e,r,t){const n=e.getTimezoneOffset();switch(r){case"z":case"zz":case"zzz":return"GMT"+Ah(n,":");case"zzzz":default:return"GMT"+Pa(n,":")}},t:function(e,r,t){const n=Math.trunc(+e/1e3);return pt(n,r.length)},T:function(e,r,t){return pt(+e,r.length)}};function Ah(e,r=""){const t=e>0?"-":"+",n=Math.abs(e),a=Math.trunc(n/60),s=n%60;return s===0?t+String(a):t+String(a)+r+pt(s,2)}function Ch(e,r){return e%60===0?(e>0?"-":"+")+pt(Math.abs(e)/60,2):Pa(e,r)}function Pa(e,r=""){const t=e>0?"-":"+",n=Math.abs(e),a=pt(Math.trunc(n/60),2),s=pt(n%60,2);return t+a+r+s}const _h=(e,r)=>{switch(e){case"P":return r.date({width:"short"});case"PP":return r.date({width:"medium"});case"PPP":return r.date({width:"long"});case"PPPP":default:return r.date({width:"full"})}},t1=(e,r)=>{switch(e){case"p":return r.time({width:"short"});case"pp":return r.time({width:"medium"});case"ppp":return r.time({width:"long"});case"pppp":default:return r.time({width:"full"})}},aR=(e,r)=>{const t=e.match(/(P+)(p+)?/)||[],n=t[1],a=t[2];if(!a)return _h(e,r);let s;switch(n){case"P":s=r.dateTime({width:"short"});break;case"PP":s=r.dateTime({width:"medium"});break;case"PPP":s=r.dateTime({width:"long"});break;case"PPPP":default:s=r.dateTime({width:"full"});break}return s.replace("{{date}}",_h(n,r)).replace("{{time}}",t1(a,r))},fc={p:t1,P:aR},sR=/^D+$/,iR=/^Y+$/,oR=["D","DD","YY","YYYY"];function r1(e){return sR.test(e)}function n1(e){return iR.test(e)}function au(e,r,t){const n=cR(e,r,t);if(console.warn(n),oR.includes(e))throw new RangeError(n)}function cR(e,r,t){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${r}\`) for formatting ${n} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}function lR(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function a1(e){return!(!lR(e)&&typeof e!="number"||isNaN(+qe(e)))}const uR=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,dR=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,fR=/^'([^]*?)'?$/,hR=/''/g,pR=/[a-zA-Z]/;function Qs(e,r,t){var d,f,h,x,p,m,g,v;const n=xs(),a=(t==null?void 0:t.locale)??n.locale??Id,s=(t==null?void 0:t.firstWeekContainsDate)??((f=(d=t==null?void 0:t.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??n.firstWeekContainsDate??((x=(h=n.locale)==null?void 0:h.options)==null?void 0:x.firstWeekContainsDate)??1,i=(t==null?void 0:t.weekStartsOn)??((m=(p=t==null?void 0:t.locale)==null?void 0:p.options)==null?void 0:m.weekStartsOn)??n.weekStartsOn??((v=(g=n.locale)==null?void 0:g.options)==null?void 0:v.weekStartsOn)??0,c=qe(e,t==null?void 0:t.in);if(!a1(c))throw new RangeError("Invalid time value");let l=r.match(dR).map(y=>{const b=y[0];if(b==="p"||b==="P"){const S=fc[b];return S(y,a.formatLong)}return y}).join("").match(uR).map(y=>{if(y==="''")return{isToken:!1,value:"'"};const b=y[0];if(b==="'")return{isToken:!1,value:mR(y)};if(kh[b])return{isToken:!0,value:y};if(b.match(pR))throw new RangeError("Format string contains an unescaped latin alphabet character `"+b+"`");return{isToken:!1,value:y}});a.localize.preprocessor&&(l=a.localize.preprocessor(c,l));const u={firstWeekContainsDate:s,weekStartsOn:i,locale:a};return l.map(y=>{if(!y.isToken)return y.value;const b=y.value;(!(t!=null&&t.useAdditionalWeekYearTokens)&&n1(b)||!(t!=null&&t.useAdditionalDayOfYearTokens)&&r1(b))&&au(b,r,String(e));const S=kh[b[0]];return S(c,b,a.localize,u)}).join("")}function mR(e){const r=e.match(fR);return r?r[1].replace(hR,"'"):e}function xR(e,r){return qe(e,r==null?void 0:r.in).getDate()}function s1(e,r){const t=qe(e,r==null?void 0:r.in),n=t.getFullYear(),a=t.getMonth(),s=vt(t,0);return s.setFullYear(n,a+1,0),s.setHours(0,0,0,0),s.getDate()}function gR(e,r){return qe(e,r==null?void 0:r.in).getHours()}function vR(e,r){return qe(e,r==null?void 0:r.in).getMinutes()}function yR(e,r){return qe(e,r==null?void 0:r.in).getMonth()}function bR(e){return qe(e).getSeconds()}function wR(e){return qe(e).getMilliseconds()}function SR(e,r){return qe(e,r==null?void 0:r.in).getFullYear()}function El(e,r){return+qe(e)>+qe(r)}function Tl(e,r){return+qe(e)<+qe(r)}function ER(e,r){return+qe(e)==+qe(r)}function TR(e,r,t){const[n,a]=go(t==null?void 0:t.in,e,r);return+Zi(n)==+Zi(a)}function kR(e,r,t){const[n,a]=go(t==null?void 0:t.in,e,r);return n.getFullYear()===a.getFullYear()}function AR(e,r,t){const[n,a]=go(t==null?void 0:t.in,e,r);return n.getFullYear()===a.getFullYear()&&n.getMonth()===a.getMonth()}function Dh(e,r){const t=qe(e,r==null?void 0:r.in);return t.setMinutes(0,0,0),t}function CR(e,r,t){const[n,a]=go(t==null?void 0:t.in,e,r);return+Dh(n)==+Dh(a)}function _R(){return Object.assign({},xs())}function DR(e,r){const t=FR(r)?new r(0):vt(r,0);return t.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),t.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),t}function FR(e){var r;return typeof e=="function"&&((r=e.prototype)==null?void 0:r.constructor)===e}const IR=10;class i1{constructor(){Ne(this,"subPriority",0)}validate(r,t){return!0}}class PR extends i1{constructor(r,t,n,a,s){super(),this.value=r,this.validateValue=t,this.setValue=n,this.priority=a,s&&(this.subPriority=s)}validate(r,t){return this.validateValue(r,this.value,t)}set(r,t,n){return this.setValue(r,t,this.value,n)}}class OR extends i1{constructor(t,n){super();Ne(this,"priority",IR);Ne(this,"subPriority",-1);this.context=t||(a=>vt(n,a))}set(t,n){return n.timestampIsSet?t:vt(t,DR(t,this.context))}}class ft{run(r,t,n,a){const s=this.parse(r,t,n,a);return s?{setter:new PR(s.value,this.validate,this.set,this.priority,this.subPriority),rest:s.rest}:null}validate(r,t,n){return!0}}class jR extends ft{constructor(){super(...arguments);Ne(this,"priority",140);Ne(this,"incompatibleTokens",["R","u","t","T"])}parse(t,n,a){switch(n){case"G":case"GG":case"GGG":return a.era(t,{width:"abbreviated"})||a.era(t,{width:"narrow"});case"GGGGG":return a.era(t,{width:"narrow"});case"GGGG":default:return a.era(t,{width:"wide"})||a.era(t,{width:"abbreviated"})||a.era(t,{width:"narrow"})}}set(t,n,a){return n.era=a,t.setFullYear(a,0,1),t.setHours(0,0,0,0),t}}const Mt={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},On={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function Lt(e,r){return e&&{value:r(e.value),rest:e.rest}}function kt(e,r){const t=r.match(e);return t?{value:parseInt(t[0],10),rest:r.slice(t[0].length)}:null}function jn(e,r){const t=r.match(e);if(!t)return null;if(t[0]==="Z")return{value:0,rest:r.slice(1)};const n=t[1]==="+"?1:-1,a=t[2]?parseInt(t[2],10):0,s=t[3]?parseInt(t[3],10):0,i=t[5]?parseInt(t[5],10):0;return{value:n*(a*Wc+s*Vc+i*p4),rest:r.slice(t[0].length)}}function o1(e){return kt(Mt.anyDigitsSigned,e)}function Ot(e,r){switch(e){case 1:return kt(Mt.singleDigit,r);case 2:return kt(Mt.twoDigits,r);case 3:return kt(Mt.threeDigits,r);case 4:return kt(Mt.fourDigits,r);default:return kt(new RegExp("^\\d{1,"+e+"}"),r)}}function hc(e,r){switch(e){case 1:return kt(Mt.singleDigitSigned,r);case 2:return kt(Mt.twoDigitsSigned,r);case 3:return kt(Mt.threeDigitsSigned,r);case 4:return kt(Mt.fourDigitsSigned,r);default:return kt(new RegExp("^-?\\d{1,"+e+"}"),r)}}function jd(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function c1(e,r){const t=r>0,n=t?r:1-r;let a;if(n<=50)a=e||100;else{const s=n+50,i=Math.trunc(s/100)*100,c=e>=s%100;a=e+i-(c?100:0)}return t?a:1-a}function l1(e){return e%400===0||e%4===0&&e%100!==0}class RR extends ft{constructor(){super(...arguments);Ne(this,"priority",130);Ne(this,"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"])}parse(t,n,a){const s=i=>({year:i,isTwoDigitYear:n==="yy"});switch(n){case"y":return Lt(Ot(4,t),s);case"yo":return Lt(a.ordinalNumber(t,{unit:"year"}),s);default:return Lt(Ot(n.length,t),s)}}validate(t,n){return n.isTwoDigitYear||n.year>0}set(t,n,a){const s=t.getFullYear();if(a.isTwoDigitYear){const c=c1(a.year,s);return t.setFullYear(c,0,1),t.setHours(0,0,0,0),t}const i=!("era"in n)||n.era===1?a.year:1-a.year;return t.setFullYear(i,0,1),t.setHours(0,0,0,0),t}}class NR extends ft{constructor(){super(...arguments);Ne(this,"priority",130);Ne(this,"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"])}parse(t,n,a){const s=i=>({year:i,isTwoDigitYear:n==="YY"});switch(n){case"Y":return Lt(Ot(4,t),s);case"Yo":return Lt(a.ordinalNumber(t,{unit:"year"}),s);default:return Lt(Ot(n.length,t),s)}}validate(t,n){return n.isTwoDigitYear||n.year>0}set(t,n,a,s){const i=Pd(t,s);if(a.isTwoDigitYear){const l=c1(a.year,i);return t.setFullYear(l,0,s.firstWeekContainsDate),t.setHours(0,0,0,0),ea(t,s)}const c=!("era"in n)||n.era===1?a.year:1-a.year;return t.setFullYear(c,0,s.firstWeekContainsDate),t.setHours(0,0,0,0),ea(t,s)}}class MR extends ft{constructor(){super(...arguments);Ne(this,"priority",130);Ne(this,"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"])}parse(t,n){return hc(n==="R"?4:n.length,t)}set(t,n,a){const s=vt(t,0);return s.setFullYear(a,0,4),s.setHours(0,0,0,0),Js(s)}}class LR extends ft{constructor(){super(...arguments);Ne(this,"priority",130);Ne(this,"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"])}parse(t,n){return hc(n==="u"?4:n.length,t)}set(t,n,a){return t.setFullYear(a,0,1),t.setHours(0,0,0,0),t}}class BR extends ft{constructor(){super(...arguments);Ne(this,"priority",120);Ne(this,"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"])}parse(t,n,a){switch(n){case"Q":case"QQ":return Ot(n.length,t);case"Qo":return a.ordinalNumber(t,{unit:"quarter"});case"QQQ":return a.quarter(t,{width:"abbreviated",context:"formatting"})||a.quarter(t,{width:"narrow",context:"formatting"});case"QQQQQ":return a.quarter(t,{width:"narrow",context:"formatting"});case"QQQQ":default:return a.quarter(t,{width:"wide",context:"formatting"})||a.quarter(t,{width:"abbreviated",context:"formatting"})||a.quarter(t,{width:"narrow",context:"formatting"})}}validate(t,n){return n>=1&&n<=4}set(t,n,a){return t.setMonth((a-1)*3,1),t.setHours(0,0,0,0),t}}class $R extends ft{constructor(){super(...arguments);Ne(this,"priority",120);Ne(this,"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"])}parse(t,n,a){switch(n){case"q":case"qq":return Ot(n.length,t);case"qo":return a.ordinalNumber(t,{unit:"quarter"});case"qqq":return a.quarter(t,{width:"abbreviated",context:"standalone"})||a.quarter(t,{width:"narrow",context:"standalone"});case"qqqqq":return a.quarter(t,{width:"narrow",context:"standalone"});case"qqqq":default:return a.quarter(t,{width:"wide",context:"standalone"})||a.quarter(t,{width:"abbreviated",context:"standalone"})||a.quarter(t,{width:"narrow",context:"standalone"})}}validate(t,n){return n>=1&&n<=4}set(t,n,a){return t.setMonth((a-1)*3,1),t.setHours(0,0,0,0),t}}class UR extends ft{constructor(){super(...arguments);Ne(this,"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]);Ne(this,"priority",110)}parse(t,n,a){const s=i=>i-1;switch(n){case"M":return Lt(kt(Mt.month,t),s);case"MM":return Lt(Ot(2,t),s);case"Mo":return Lt(a.ordinalNumber(t,{unit:"month"}),s);case"MMM":return a.month(t,{width:"abbreviated",context:"formatting"})||a.month(t,{width:"narrow",context:"formatting"});case"MMMMM":return a.month(t,{width:"narrow",context:"formatting"});case"MMMM":default:return a.month(t,{width:"wide",context:"formatting"})||a.month(t,{width:"abbreviated",context:"formatting"})||a.month(t,{width:"narrow",context:"formatting"})}}validate(t,n){return n>=0&&n<=11}set(t,n,a){return t.setMonth(a,1),t.setHours(0,0,0,0),t}}class VR extends ft{constructor(){super(...arguments);Ne(this,"priority",110);Ne(this,"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"])}parse(t,n,a){const s=i=>i-1;switch(n){case"L":return Lt(kt(Mt.month,t),s);case"LL":return Lt(Ot(2,t),s);case"Lo":return Lt(a.ordinalNumber(t,{unit:"month"}),s);case"LLL":return a.month(t,{width:"abbreviated",context:"standalone"})||a.month(t,{width:"narrow",context:"standalone"});case"LLLLL":return a.month(t,{width:"narrow",context:"standalone"});case"LLLL":default:return a.month(t,{width:"wide",context:"standalone"})||a.month(t,{width:"abbreviated",context:"standalone"})||a.month(t,{width:"narrow",context:"standalone"})}}validate(t,n){return n>=0&&n<=11}set(t,n,a){return t.setMonth(a,1),t.setHours(0,0,0,0),t}}function WR(e,r,t){const n=qe(e,t==null?void 0:t.in),a=Od(n,t)-r;return n.setDate(n.getDate()-a*7),qe(n,t==null?void 0:t.in)}class HR extends ft{constructor(){super(...arguments);Ne(this,"priority",100);Ne(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"])}parse(t,n,a){switch(n){case"w":return kt(Mt.week,t);case"wo":return a.ordinalNumber(t,{unit:"week"});default:return Ot(n.length,t)}}validate(t,n){return n>=1&&n<=53}set(t,n,a,s){return ea(WR(t,a,s),s)}}function zR(e,r,t){const n=qe(e,t==null?void 0:t.in),a=e1(n,t)-r;return n.setDate(n.getDate()-a*7),n}class GR extends ft{constructor(){super(...arguments);Ne(this,"priority",100);Ne(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"])}parse(t,n,a){switch(n){case"I":return kt(Mt.week,t);case"Io":return a.ordinalNumber(t,{unit:"week"});default:return Ot(n.length,t)}}validate(t,n){return n>=1&&n<=53}set(t,n,a){return Js(zR(t,a))}}const YR=[31,28,31,30,31,30,31,31,30,31,30,31],qR=[31,29,31,30,31,30,31,31,30,31,30,31];class XR extends ft{constructor(){super(...arguments);Ne(this,"priority",90);Ne(this,"subPriority",1);Ne(this,"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"])}parse(t,n,a){switch(n){case"d":return kt(Mt.date,t);case"do":return a.ordinalNumber(t,{unit:"date"});default:return Ot(n.length,t)}}validate(t,n){const a=t.getFullYear(),s=l1(a),i=t.getMonth();return s?n>=1&&n<=qR[i]:n>=1&&n<=YR[i]}set(t,n,a){return t.setDate(a),t.setHours(0,0,0,0),t}}class KR extends ft{constructor(){super(...arguments);Ne(this,"priority",90);Ne(this,"subpriority",1);Ne(this,"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"])}parse(t,n,a){switch(n){case"D":case"DD":return kt(Mt.dayOfYear,t);case"Do":return a.ordinalNumber(t,{unit:"date"});default:return Ot(n.length,t)}}validate(t,n){const a=t.getFullYear();return l1(a)?n>=1&&n<=366:n>=1&&n<=365}set(t,n,a){return t.setMonth(0,a),t.setHours(0,0,0,0),t}}function Rd(e,r,t){var f,h,x,p;const n=xs(),a=(t==null?void 0:t.weekStartsOn)??((h=(f=t==null?void 0:t.locale)==null?void 0:f.options)==null?void 0:h.weekStartsOn)??n.weekStartsOn??((p=(x=n.locale)==null?void 0:x.options)==null?void 0:p.weekStartsOn)??0,s=qe(e,t==null?void 0:t.in),i=s.getDay(),l=(r%7+7)%7,u=7-a,d=r<0||r>6?r-(i+u)%7:(l+u)%7-(i+u)%7;return Hc(s,d,t)}class JR extends ft{constructor(){super(...arguments);Ne(this,"priority",90);Ne(this,"incompatibleTokens",["D","i","e","c","t","T"])}parse(t,n,a){switch(n){case"E":case"EE":case"EEE":return a.day(t,{width:"abbreviated",context:"formatting"})||a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"});case"EEEEE":return a.day(t,{width:"narrow",context:"formatting"});case"EEEEEE":return a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"});case"EEEE":default:return a.day(t,{width:"wide",context:"formatting"})||a.day(t,{width:"abbreviated",context:"formatting"})||a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"})}}validate(t,n){return n>=0&&n<=6}set(t,n,a,s){return t=Rd(t,a,s),t.setHours(0,0,0,0),t}}class QR extends ft{constructor(){super(...arguments);Ne(this,"priority",90);Ne(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"])}parse(t,n,a,s){const i=c=>{const l=Math.floor((c-1)/7)*7;return(c+s.weekStartsOn+6)%7+l};switch(n){case"e":case"ee":return Lt(Ot(n.length,t),i);case"eo":return Lt(a.ordinalNumber(t,{unit:"day"}),i);case"eee":return a.day(t,{width:"abbreviated",context:"formatting"})||a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"});case"eeeee":return a.day(t,{width:"narrow",context:"formatting"});case"eeeeee":return a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"});case"eeee":default:return a.day(t,{width:"wide",context:"formatting"})||a.day(t,{width:"abbreviated",context:"formatting"})||a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"})}}validate(t,n){return n>=0&&n<=6}set(t,n,a,s){return t=Rd(t,a,s),t.setHours(0,0,0,0),t}}class ZR extends ft{constructor(){super(...arguments);Ne(this,"priority",90);Ne(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"])}parse(t,n,a,s){const i=c=>{const l=Math.floor((c-1)/7)*7;return(c+s.weekStartsOn+6)%7+l};switch(n){case"c":case"cc":return Lt(Ot(n.length,t),i);case"co":return Lt(a.ordinalNumber(t,{unit:"day"}),i);case"ccc":return a.day(t,{width:"abbreviated",context:"standalone"})||a.day(t,{width:"short",context:"standalone"})||a.day(t,{width:"narrow",context:"standalone"});case"ccccc":return a.day(t,{width:"narrow",context:"standalone"});case"cccccc":return a.day(t,{width:"short",context:"standalone"})||a.day(t,{width:"narrow",context:"standalone"});case"cccc":default:return a.day(t,{width:"wide",context:"standalone"})||a.day(t,{width:"abbreviated",context:"standalone"})||a.day(t,{width:"short",context:"standalone"})||a.day(t,{width:"narrow",context:"standalone"})}}validate(t,n){return n>=0&&n<=6}set(t,n,a,s){return t=Rd(t,a,s),t.setHours(0,0,0,0),t}}function eN(e,r){const t=qe(e,r==null?void 0:r.in).getDay();return t===0?7:t}function tN(e,r,t){const n=qe(e,t==null?void 0:t.in),a=eN(n,t),s=r-a;return Hc(n,s,t)}class rN extends ft{constructor(){super(...arguments);Ne(this,"priority",90);Ne(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"])}parse(t,n,a){const s=i=>i===0?7:i;switch(n){case"i":case"ii":return Ot(n.length,t);case"io":return a.ordinalNumber(t,{unit:"day"});case"iii":return Lt(a.day(t,{width:"abbreviated",context:"formatting"})||a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"}),s);case"iiiii":return Lt(a.day(t,{width:"narrow",context:"formatting"}),s);case"iiiiii":return Lt(a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"}),s);case"iiii":default:return Lt(a.day(t,{width:"wide",context:"formatting"})||a.day(t,{width:"abbreviated",context:"formatting"})||a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"}),s)}}validate(t,n){return n>=1&&n<=7}set(t,n,a){return t=tN(t,a),t.setHours(0,0,0,0),t}}class nN extends ft{constructor(){super(...arguments);Ne(this,"priority",80);Ne(this,"incompatibleTokens",["b","B","H","k","t","T"])}parse(t,n,a){switch(n){case"a":case"aa":case"aaa":return a.dayPeriod(t,{width:"abbreviated",context:"formatting"})||a.dayPeriod(t,{width:"narrow",context:"formatting"});case"aaaaa":return a.dayPeriod(t,{width:"narrow",context:"formatting"});case"aaaa":default:return a.dayPeriod(t,{width:"wide",context:"formatting"})||a.dayPeriod(t,{width:"abbreviated",context:"formatting"})||a.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,n,a){return t.setHours(jd(a),0,0,0),t}}class aN extends ft{constructor(){super(...arguments);Ne(this,"priority",80);Ne(this,"incompatibleTokens",["a","B","H","k","t","T"])}parse(t,n,a){switch(n){case"b":case"bb":case"bbb":return a.dayPeriod(t,{width:"abbreviated",context:"formatting"})||a.dayPeriod(t,{width:"narrow",context:"formatting"});case"bbbbb":return a.dayPeriod(t,{width:"narrow",context:"formatting"});case"bbbb":default:return a.dayPeriod(t,{width:"wide",context:"formatting"})||a.dayPeriod(t,{width:"abbreviated",context:"formatting"})||a.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,n,a){return t.setHours(jd(a),0,0,0),t}}class sN extends ft{constructor(){super(...arguments);Ne(this,"priority",80);Ne(this,"incompatibleTokens",["a","b","t","T"])}parse(t,n,a){switch(n){case"B":case"BB":case"BBB":return a.dayPeriod(t,{width:"abbreviated",context:"formatting"})||a.dayPeriod(t,{width:"narrow",context:"formatting"});case"BBBBB":return a.dayPeriod(t,{width:"narrow",context:"formatting"});case"BBBB":default:return a.dayPeriod(t,{width:"wide",context:"formatting"})||a.dayPeriod(t,{width:"abbreviated",context:"formatting"})||a.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,n,a){return t.setHours(jd(a),0,0,0),t}}class iN extends ft{constructor(){super(...arguments);Ne(this,"priority",70);Ne(this,"incompatibleTokens",["H","K","k","t","T"])}parse(t,n,a){switch(n){case"h":return kt(Mt.hour12h,t);case"ho":return a.ordinalNumber(t,{unit:"hour"});default:return Ot(n.length,t)}}validate(t,n){return n>=1&&n<=12}set(t,n,a){const s=t.getHours()>=12;return s&&a<12?t.setHours(a+12,0,0,0):!s&&a===12?t.setHours(0,0,0,0):t.setHours(a,0,0,0),t}}class oN extends ft{constructor(){super(...arguments);Ne(this,"priority",70);Ne(this,"incompatibleTokens",["a","b","h","K","k","t","T"])}parse(t,n,a){switch(n){case"H":return kt(Mt.hour23h,t);case"Ho":return a.ordinalNumber(t,{unit:"hour"});default:return Ot(n.length,t)}}validate(t,n){return n>=0&&n<=23}set(t,n,a){return t.setHours(a,0,0,0),t}}class cN extends ft{constructor(){super(...arguments);Ne(this,"priority",70);Ne(this,"incompatibleTokens",["h","H","k","t","T"])}parse(t,n,a){switch(n){case"K":return kt(Mt.hour11h,t);case"Ko":return a.ordinalNumber(t,{unit:"hour"});default:return Ot(n.length,t)}}validate(t,n){return n>=0&&n<=11}set(t,n,a){return t.getHours()>=12&&a<12?t.setHours(a+12,0,0,0):t.setHours(a,0,0,0),t}}class lN extends ft{constructor(){super(...arguments);Ne(this,"priority",70);Ne(this,"incompatibleTokens",["a","b","h","H","K","t","T"])}parse(t,n,a){switch(n){case"k":return kt(Mt.hour24h,t);case"ko":return a.ordinalNumber(t,{unit:"hour"});default:return Ot(n.length,t)}}validate(t,n){return n>=1&&n<=24}set(t,n,a){const s=a<=24?a%24:a;return t.setHours(s,0,0,0),t}}class uN extends ft{constructor(){super(...arguments);Ne(this,"priority",60);Ne(this,"incompatibleTokens",["t","T"])}parse(t,n,a){switch(n){case"m":return kt(Mt.minute,t);case"mo":return a.ordinalNumber(t,{unit:"minute"});default:return Ot(n.length,t)}}validate(t,n){return n>=0&&n<=59}set(t,n,a){return t.setMinutes(a,0,0),t}}class dN extends ft{constructor(){super(...arguments);Ne(this,"priority",50);Ne(this,"incompatibleTokens",["t","T"])}parse(t,n,a){switch(n){case"s":return kt(Mt.second,t);case"so":return a.ordinalNumber(t,{unit:"second"});default:return Ot(n.length,t)}}validate(t,n){return n>=0&&n<=59}set(t,n,a){return t.setSeconds(a,0),t}}class fN extends ft{constructor(){super(...arguments);Ne(this,"priority",30);Ne(this,"incompatibleTokens",["t","T"])}parse(t,n){const a=s=>Math.trunc(s*Math.pow(10,-n.length+3));return Lt(Ot(n.length,t),a)}set(t,n,a){return t.setMilliseconds(a),t}}class hN extends ft{constructor(){super(...arguments);Ne(this,"priority",10);Ne(this,"incompatibleTokens",["t","T","x"])}parse(t,n){switch(n){case"X":return jn(On.basicOptionalMinutes,t);case"XX":return jn(On.basic,t);case"XXXX":return jn(On.basicOptionalSeconds,t);case"XXXXX":return jn(On.extendedOptionalSeconds,t);case"XXX":default:return jn(On.extended,t)}}set(t,n,a){return n.timestampIsSet?t:vt(t,t.getTime()-dc(t)-a)}}class pN extends ft{constructor(){super(...arguments);Ne(this,"priority",10);Ne(this,"incompatibleTokens",["t","T","X"])}parse(t,n){switch(n){case"x":return jn(On.basicOptionalMinutes,t);case"xx":return jn(On.basic,t);case"xxxx":return jn(On.basicOptionalSeconds,t);case"xxxxx":return jn(On.extendedOptionalSeconds,t);case"xxx":default:return jn(On.extended,t)}}set(t,n,a){return n.timestampIsSet?t:vt(t,t.getTime()-dc(t)-a)}}class mN extends ft{constructor(){super(...arguments);Ne(this,"priority",40);Ne(this,"incompatibleTokens","*")}parse(t){return o1(t)}set(t,n,a){return[vt(t,a*1e3),{timestampIsSet:!0}]}}class xN extends ft{constructor(){super(...arguments);Ne(this,"priority",20);Ne(this,"incompatibleTokens","*")}parse(t){return o1(t)}set(t,n,a){return[vt(t,a),{timestampIsSet:!0}]}}const gN={G:new jR,y:new RR,Y:new NR,R:new MR,u:new LR,Q:new BR,q:new $R,M:new UR,L:new VR,w:new HR,I:new GR,d:new XR,D:new KR,E:new JR,e:new QR,c:new ZR,i:new rN,a:new nN,b:new aN,B:new sN,h:new iN,H:new oN,K:new cN,k:new lN,m:new uN,s:new dN,S:new fN,X:new hN,x:new pN,t:new mN,T:new xN},vN=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,yN=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,bN=/^'([^]*?)'?$/,wN=/''/g,SN=/\S/,EN=/[a-zA-Z]/;function TN(e,r,t,n){var g,v,y,b,S,I,k,E;const a=()=>vt((n==null?void 0:n.in)||t,NaN),s=_R(),i=(n==null?void 0:n.locale)??s.locale??Id,c=(n==null?void 0:n.firstWeekContainsDate)??((v=(g=n==null?void 0:n.locale)==null?void 0:g.options)==null?void 0:v.firstWeekContainsDate)??s.firstWeekContainsDate??((b=(y=s.locale)==null?void 0:y.options)==null?void 0:b.firstWeekContainsDate)??1,l=(n==null?void 0:n.weekStartsOn)??((I=(S=n==null?void 0:n.locale)==null?void 0:S.options)==null?void 0:I.weekStartsOn)??s.weekStartsOn??((E=(k=s.locale)==null?void 0:k.options)==null?void 0:E.weekStartsOn)??0;if(!r)return e?a():qe(t,n==null?void 0:n.in);const u={firstWeekContainsDate:c,weekStartsOn:l,locale:i},d=[new OR(n==null?void 0:n.in,t)],f=r.match(yN).map(T=>{const w=T[0];if(w in fc){const F=fc[w];return F(T,i.formatLong)}return T}).join("").match(vN),h=[];for(let T of f){!(n!=null&&n.useAdditionalWeekYearTokens)&&n1(T)&&au(T,r,e),!(n!=null&&n.useAdditionalDayOfYearTokens)&&r1(T)&&au(T,r,e);const w=T[0],F=gN[w];if(F){const{incompatibleTokens:P}=F;if(Array.isArray(P)){const L=h.find(Y=>P.includes(Y.token)||Y.token===w);if(L)throw new RangeError(`The format string mustn't contain \`${L.fullToken}\` and \`${T}\` at the same time`)}else if(F.incompatibleTokens==="*"&&h.length>0)throw new RangeError(`The format string mustn't contain \`${T}\` and any other token at the same time`);h.push({token:w,fullToken:T});const A=F.run(e,T,i.match,u);if(!A)return a();d.push(A.setter),e=A.rest}else{if(w.match(EN))throw new RangeError("Format string contains an unescaped latin alphabet character `"+w+"`");if(T==="''"?T="'":w==="'"&&(T=kN(T)),e.indexOf(T)===0)e=e.slice(T.length);else return a()}}if(e.length>0&&SN.test(e))return a();const x=d.map(T=>T.priority).sort((T,w)=>w-T).filter((T,w,F)=>F.indexOf(T)===w).map(T=>d.filter(w=>w.priority===T).sort((w,F)=>F.subPriority-w.subPriority)).map(T=>T[0]);let p=qe(t,n==null?void 0:n.in);if(isNaN(+p))return a();const m={};for(const T of x){if(!T.validate(p,u))return a();const w=T.set(p,m,u);Array.isArray(w)?(p=w[0],Object.assign(m,w[1])):p=w}return p}function kN(e){return e.match(bN)[1].replace(wN,"'")}function AN(e,r,t){const n=qe(e,t==null?void 0:t.in);return n.setDate(r),n}function CN(e,r,t){const n=qe(e,t==null?void 0:t.in);return n.setHours(r),n}function _N(e,r,t){const n=qe(e,t==null?void 0:t.in);return n.setMinutes(r),n}function DN(e,r,t){const n=qe(e,t==null?void 0:t.in),a=n.getFullYear(),s=n.getDate(),i=vt((t==null?void 0:t.in)||e,0);i.setFullYear(a,r,15),i.setHours(0,0,0,0);const c=s1(i);return n.setMonth(r,Math.min(s,c)),n}function FN(e,r,t){const n=qe(e,t==null?void 0:t.in);return n.setSeconds(r),n}function IN(e,r,t){const n=qe(e,t==null?void 0:t.in);return n.setMilliseconds(r),n}function PN(e,r,t){const n=qe(e,t==null?void 0:t.in);return isNaN(+n)?vt((t==null?void 0:t.in)||e,NaN):(n.setFullYear(r),n)}function ON(e,r){const t=qe(e,r==null?void 0:r.in);return t.setDate(1),t.setHours(0,0,0,0),t}function jN(e,r){const t=qe(e,r==null?void 0:r.in),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}function RN(e,r,t){const n=+qe(e,t==null?void 0:t.in),[a,s]=[+qe(r.start,t==null?void 0:t.in),+qe(r.end,t==null?void 0:t.in)].sort((i,c)=>i-c);return n>=a&&n<=s}const NN={y:{sectionType:"year",contentType:"digit",maxLength:4},yy:"year",yyy:{sectionType:"year",contentType:"digit",maxLength:4},yyyy:"year",M:{sectionType:"month",contentType:"digit",maxLength:2},MM:"month",MMMM:{sectionType:"month",contentType:"letter"},MMM:{sectionType:"month",contentType:"letter"},L:{sectionType:"month",contentType:"digit",maxLength:2},LL:"month",LLL:{sectionType:"month",contentType:"letter"},LLLL:{sectionType:"month",contentType:"letter"},d:{sectionType:"day",contentType:"digit",maxLength:2},dd:"day",do:{sectionType:"day",contentType:"digit-with-letter"},E:{sectionType:"weekDay",contentType:"letter"},EE:{sectionType:"weekDay",contentType:"letter"},EEE:{sectionType:"weekDay",contentType:"letter"},EEEE:{sectionType:"weekDay",contentType:"letter"},EEEEE:{sectionType:"weekDay",contentType:"letter"},i:{sectionType:"weekDay",contentType:"digit",maxLength:1},ii:"weekDay",iii:{sectionType:"weekDay",contentType:"letter"},iiii:{sectionType:"weekDay",contentType:"letter"},e:{sectionType:"weekDay",contentType:"digit",maxLength:1},ee:"weekDay",eee:{sectionType:"weekDay",contentType:"letter"},eeee:{sectionType:"weekDay",contentType:"letter"},eeeee:{sectionType:"weekDay",contentType:"letter"},eeeeee:{sectionType:"weekDay",contentType:"letter"},c:{sectionType:"weekDay",contentType:"digit",maxLength:1},cc:"weekDay",ccc:{sectionType:"weekDay",contentType:"letter"},cccc:{sectionType:"weekDay",contentType:"letter"},ccccc:{sectionType:"weekDay",contentType:"letter"},cccccc:{sectionType:"weekDay",contentType:"letter"},a:"meridiem",aa:"meridiem",aaa:"meridiem",H:{sectionType:"hours",contentType:"digit",maxLength:2},HH:"hours",h:{sectionType:"hours",contentType:"digit",maxLength:2},hh:"hours",m:{sectionType:"minutes",contentType:"digit",maxLength:2},mm:"minutes",s:{sectionType:"seconds",contentType:"digit",maxLength:2},ss:"seconds"},MN={year:"yyyy",month:"LLLL",monthShort:"MMM",dayOfMonth:"d",dayOfMonthFull:"do",weekday:"EEEE",weekdayShort:"EEEEEE",hours24h:"HH",hours12h:"hh",meridiem:"aa",minutes:"mm",seconds:"ss",fullDate:"PP",keyboardDate:"P",shortDate:"MMM d",normalDate:"d MMMM",normalDateWithWeekday:"EEE, MMM d",fullTime12h:"hh:mm aa",fullTime24h:"HH:mm",keyboardDateTime12h:"P hh:mm aa",keyboardDateTime24h:"P HH:mm"};class LN{constructor(r){this.isMUIAdapter=!0,this.isTimezoneCompatible=!1,this.lib=void 0,this.locale=void 0,this.formats=void 0,this.formatTokenMap=NN,this.escapedCharacters={start:"'",end:"'"},this.longFormatters=void 0,this.date=i=>typeof i>"u"?new Date:i===null?null:new Date(i),this.getInvalidDate=()=>new Date("Invalid Date"),this.getTimezone=()=>"default",this.setTimezone=i=>i,this.toJsDate=i=>i,this.getCurrentLocaleCode=()=>this.locale.code,this.is12HourCycleInCurrentLocale=()=>/a/.test(this.locale.formatLong.time({width:"short"})),this.expandFormat=i=>{const c=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g;return i.match(c).map(l=>{const u=l[0];if(u==="p"||u==="P"){const d=this.longFormatters[u];return d(l,this.locale.formatLong)}return l}).join("")},this.formatNumber=i=>i,this.getDayOfWeek=i=>i.getDay()+1;const{locale:t,formats:n,longFormatters:a,lib:s}=r;this.locale=t,this.formats=re({},MN,n),this.longFormatters=a,this.lib=s||"date-fns"}}class BN extends LN{constructor({locale:r,formats:t}={}){super({locale:r??Id,formats:t,longFormatters:fc}),this.parse=(n,a)=>n===""?null:TN(n,a,new Date,{locale:this.locale}),this.isValid=n=>n==null?!1:a1(n),this.format=(n,a)=>this.formatByString(n,this.formats[a]),this.formatByString=(n,a)=>Qs(n,a,{locale:this.locale}),this.isEqual=(n,a)=>n===null&&a===null?!0:n===null||a===null?!1:ER(n,a),this.isSameYear=(n,a)=>kR(n,a),this.isSameMonth=(n,a)=>AR(n,a),this.isSameDay=(n,a)=>TR(n,a),this.isSameHour=(n,a)=>CR(n,a),this.isAfter=(n,a)=>El(n,a),this.isAfterYear=(n,a)=>El(n,Th(a)),this.isAfterDay=(n,a)=>El(n,Eh(a)),this.isBefore=(n,a)=>Tl(n,a),this.isBeforeYear=(n,a)=>Tl(n,this.startOfYear(a)),this.isBeforeDay=(n,a)=>Tl(n,this.startOfDay(a)),this.isWithinRange=(n,[a,s])=>RN(n,{start:a,end:s}),this.startOfYear=n=>Qg(n),this.startOfMonth=n=>ON(n),this.startOfWeek=n=>ea(n,{locale:this.locale}),this.startOfDay=n=>Zi(n),this.endOfYear=n=>Th(n),this.endOfMonth=n=>jN(n),this.endOfWeek=n=>w4(n,{locale:this.locale}),this.endOfDay=n=>Eh(n),this.addYears=(n,a)=>y4(n,a),this.addMonths=(n,a)=>Jg(n,a),this.addWeeks=(n,a)=>v4(n,a),this.addDays=(n,a)=>Hc(n,a),this.addHours=(n,a)=>g4(n,a),this.addMinutes=(n,a)=>x4(n,a),this.addSeconds=(n,a)=>m4(n,a),this.getYear=n=>SR(n),this.getMonth=n=>yR(n),this.getDate=n=>xR(n),this.getHours=n=>gR(n),this.getMinutes=n=>vR(n),this.getSeconds=n=>bR(n),this.getMilliseconds=n=>wR(n),this.setYear=(n,a)=>PN(n,a),this.setMonth=(n,a)=>DN(n,a),this.setDate=(n,a)=>AN(n,a),this.setHours=(n,a)=>CN(n,a),this.setMinutes=(n,a)=>_N(n,a),this.setSeconds=(n,a)=>FN(n,a),this.setMilliseconds=(n,a)=>IN(n,a),this.getDaysInMonth=n=>s1(n),this.getWeekArray=n=>{const a=this.startOfWeek(this.startOfMonth(n)),s=this.endOfWeek(this.endOfMonth(n));let i=0,c=a;const l=[];for(;this.isBefore(c,s);){const u=Math.floor(i/7);l[u]=l[u]||[],l[u].push(c),c=this.addDays(c,1),i+=1}return l},this.getWeekNumber=n=>Od(n,{locale:this.locale}),this.getYearRange=([n,a])=>{const s=this.startOfYear(n),i=this.endOfYear(a),c=[];let l=s;for(;this.isBefore(l,i);)c.push(l),l=this.addYears(l,1);return c}}}var $N=function(r){return UN(r)&&!VN(r)};function UN(e){return!!e&&typeof e=="object"}function VN(e){var r=Object.prototype.toString.call(e);return r==="[object RegExp]"||r==="[object Date]"||zN(e)}var WN=typeof Symbol=="function"&&Symbol.for,HN=WN?Symbol.for("react.element"):60103;function zN(e){return e.$$typeof===HN}function GN(e){return Array.isArray(e)?[]:{}}function pc(e,r){return r.clone!==!1&&r.isMergeableObject(e)?eo(GN(e),e,r):e}function YN(e,r,t){return e.concat(r).map(function(n){return pc(n,t)})}function qN(e,r,t){var n={};return t.isMergeableObject(e)&&Object.keys(e).forEach(function(a){n[a]=pc(e[a],t)}),Object.keys(r).forEach(function(a){!t.isMergeableObject(r[a])||!e[a]?n[a]=pc(r[a],t):n[a]=eo(e[a],r[a],t)}),n}function eo(e,r,t){t=t||{},t.arrayMerge=t.arrayMerge||YN,t.isMergeableObject=t.isMergeableObject||$N;var n=Array.isArray(r),a=Array.isArray(e),s=n===a;return s?n?t.arrayMerge(e,r,t):qN(e,r,t):pc(r,t)}eo.all=function(r,t){if(!Array.isArray(r))throw new Error("first argument should be an array");return r.reduce(function(n,a){return eo(n,a,t)},{})};var su=eo,XN=typeof global=="object"&&global&&global.Object===Object&&global;const u1=XN;var KN=typeof self=="object"&&self&&self.Object===Object&&self,JN=u1||KN||Function("return this")();const Hn=JN;var QN=Hn.Symbol;const va=QN;var d1=Object.prototype,ZN=d1.hasOwnProperty,e3=d1.toString,bi=va?va.toStringTag:void 0;function t3(e){var r=ZN.call(e,bi),t=e[bi];try{e[bi]=void 0;var n=!0}catch{}var a=e3.call(e);return n&&(r?e[bi]=t:delete e[bi]),a}var r3=Object.prototype,n3=r3.toString;function a3(e){return n3.call(e)}var s3="[object Null]",i3="[object Undefined]",Fh=va?va.toStringTag:void 0;function gs(e){return e==null?e===void 0?i3:s3:Fh&&Fh in Object(e)?t3(e):a3(e)}function f1(e,r){return function(t){return e(r(t))}}var o3=f1(Object.getPrototypeOf,Object);const Nd=o3;function vs(e){return e!=null&&typeof e=="object"}var c3="[object Object]",l3=Function.prototype,u3=Object.prototype,h1=l3.toString,d3=u3.hasOwnProperty,f3=h1.call(Object);function Ih(e){if(!vs(e)||gs(e)!=c3)return!1;var r=Nd(e);if(r===null)return!0;var t=d3.call(r,"constructor")&&r.constructor;return typeof t=="function"&&t instanceof t&&h1.call(t)==f3}function h3(){this.__data__=[],this.size=0}function p1(e,r){return e===r||e!==e&&r!==r}function zc(e,r){for(var t=e.length;t--;)if(p1(e[t][0],r))return t;return-1}var p3=Array.prototype,m3=p3.splice;function x3(e){var r=this.__data__,t=zc(r,e);if(t<0)return!1;var n=r.length-1;return t==n?r.pop():m3.call(r,t,1),--this.size,!0}function g3(e){var r=this.__data__,t=zc(r,e);return t<0?void 0:r[t][1]}function v3(e){return zc(this.__data__,e)>-1}function y3(e,r){var t=this.__data__,n=zc(t,e);return n<0?(++this.size,t.push([e,r])):t[n][1]=r,this}function aa(e){var r=-1,t=e==null?0:e.length;for(this.clear();++r<t;){var n=e[r];this.set(n[0],n[1])}}aa.prototype.clear=h3;aa.prototype.delete=x3;aa.prototype.get=g3;aa.prototype.has=v3;aa.prototype.set=y3;function b3(){this.__data__=new aa,this.size=0}function w3(e){var r=this.__data__,t=r.delete(e);return this.size=r.size,t}function S3(e){return this.__data__.get(e)}function E3(e){return this.__data__.has(e)}function vo(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}var T3="[object AsyncFunction]",k3="[object Function]",A3="[object GeneratorFunction]",C3="[object Proxy]";function m1(e){if(!vo(e))return!1;var r=gs(e);return r==k3||r==A3||r==T3||r==C3}var _3=Hn["__core-js_shared__"];const kl=_3;var Ph=function(){var e=/[^.]+$/.exec(kl&&kl.keys&&kl.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function D3(e){return!!Ph&&Ph in e}var F3=Function.prototype,I3=F3.toString;function ys(e){if(e!=null){try{return I3.call(e)}catch{}try{return e+""}catch{}}return""}var P3=/[\\^$.*+?()[\]{}|]/g,O3=/^\[object .+?Constructor\]$/,j3=Function.prototype,R3=Object.prototype,N3=j3.toString,M3=R3.hasOwnProperty,L3=RegExp("^"+N3.call(M3).replace(P3,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function B3(e){if(!vo(e)||D3(e))return!1;var r=m1(e)?L3:O3;return r.test(ys(e))}function $3(e,r){return e==null?void 0:e[r]}function bs(e,r){var t=$3(e,r);return B3(t)?t:void 0}var U3=bs(Hn,"Map");const to=U3;var V3=bs(Object,"create");const ro=V3;function W3(){this.__data__=ro?ro(null):{},this.size=0}function H3(e){var r=this.has(e)&&delete this.__data__[e];return this.size-=r?1:0,r}var z3="__lodash_hash_undefined__",G3=Object.prototype,Y3=G3.hasOwnProperty;function q3(e){var r=this.__data__;if(ro){var t=r[e];return t===z3?void 0:t}return Y3.call(r,e)?r[e]:void 0}var X3=Object.prototype,K3=X3.hasOwnProperty;function J3(e){var r=this.__data__;return ro?r[e]!==void 0:K3.call(r,e)}var Q3="__lodash_hash_undefined__";function Z3(e,r){var t=this.__data__;return this.size+=this.has(e)?0:1,t[e]=ro&&r===void 0?Q3:r,this}function cs(e){var r=-1,t=e==null?0:e.length;for(this.clear();++r<t;){var n=e[r];this.set(n[0],n[1])}}cs.prototype.clear=W3;cs.prototype.delete=H3;cs.prototype.get=q3;cs.prototype.has=J3;cs.prototype.set=Z3;function eM(){this.size=0,this.__data__={hash:new cs,map:new(to||aa),string:new cs}}function tM(e){var r=typeof e;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?e!=="__proto__":e===null}function Gc(e,r){var t=e.__data__;return tM(r)?t[typeof r=="string"?"string":"hash"]:t.map}function rM(e){var r=Gc(this,e).delete(e);return this.size-=r?1:0,r}function nM(e){return Gc(this,e).get(e)}function aM(e){return Gc(this,e).has(e)}function sM(e,r){var t=Gc(this,e),n=t.size;return t.set(e,r),this.size+=t.size==n?0:1,this}function Sa(e){var r=-1,t=e==null?0:e.length;for(this.clear();++r<t;){var n=e[r];this.set(n[0],n[1])}}Sa.prototype.clear=eM;Sa.prototype.delete=rM;Sa.prototype.get=nM;Sa.prototype.has=aM;Sa.prototype.set=sM;var iM=200;function oM(e,r){var t=this.__data__;if(t instanceof aa){var n=t.__data__;if(!to||n.length<iM-1)return n.push([e,r]),this.size=++t.size,this;t=this.__data__=new Sa(n)}return t.set(e,r),this.size=t.size,this}function oi(e){var r=this.__data__=new aa(e);this.size=r.size}oi.prototype.clear=b3;oi.prototype.delete=w3;oi.prototype.get=S3;oi.prototype.has=E3;oi.prototype.set=oM;function cM(e,r){for(var t=-1,n=e==null?0:e.length;++t<n&&r(e[t],t,e)!==!1;);return e}var lM=function(){try{var e=bs(Object,"defineProperty");return e({},"",{}),e}catch{}}();const Oh=lM;function x1(e,r,t){r=="__proto__"&&Oh?Oh(e,r,{configurable:!0,enumerable:!0,value:t,writable:!0}):e[r]=t}var uM=Object.prototype,dM=uM.hasOwnProperty;function g1(e,r,t){var n=e[r];(!(dM.call(e,r)&&p1(n,t))||t===void 0&&!(r in e))&&x1(e,r,t)}function Yc(e,r,t,n){var a=!t;t||(t={});for(var s=-1,i=r.length;++s<i;){var c=r[s],l=n?n(t[c],e[c],c,t,e):void 0;l===void 0&&(l=e[c]),a?x1(t,c,l):g1(t,c,l)}return t}function fM(e,r){for(var t=-1,n=Array(e);++t<e;)n[t]=r(t);return n}var hM="[object Arguments]";function jh(e){return vs(e)&&gs(e)==hM}var v1=Object.prototype,pM=v1.hasOwnProperty,mM=v1.propertyIsEnumerable,xM=jh(function(){return arguments}())?jh:function(e){return vs(e)&&pM.call(e,"callee")&&!mM.call(e,"callee")};const gM=xM;var vM=Array.isArray;const yo=vM;function yM(){return!1}var y1=typeof Yr=="object"&&Yr&&!Yr.nodeType&&Yr,Rh=y1&&typeof qr=="object"&&qr&&!qr.nodeType&&qr,bM=Rh&&Rh.exports===y1,Nh=bM?Hn.Buffer:void 0,wM=Nh?Nh.isBuffer:void 0,SM=wM||yM;const b1=SM;var EM=9007199254740991,TM=/^(?:0|[1-9]\d*)$/;function kM(e,r){var t=typeof e;return r=r??EM,!!r&&(t=="number"||t!="symbol"&&TM.test(e))&&e>-1&&e%1==0&&e<r}var AM=9007199254740991;function w1(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=AM}var CM="[object Arguments]",_M="[object Array]",DM="[object Boolean]",FM="[object Date]",IM="[object Error]",PM="[object Function]",OM="[object Map]",jM="[object Number]",RM="[object Object]",NM="[object RegExp]",MM="[object Set]",LM="[object String]",BM="[object WeakMap]",$M="[object ArrayBuffer]",UM="[object DataView]",VM="[object Float32Array]",WM="[object Float64Array]",HM="[object Int8Array]",zM="[object Int16Array]",GM="[object Int32Array]",YM="[object Uint8Array]",qM="[object Uint8ClampedArray]",XM="[object Uint16Array]",KM="[object Uint32Array]",gt={};gt[VM]=gt[WM]=gt[HM]=gt[zM]=gt[GM]=gt[YM]=gt[qM]=gt[XM]=gt[KM]=!0;gt[CM]=gt[_M]=gt[$M]=gt[DM]=gt[UM]=gt[FM]=gt[IM]=gt[PM]=gt[OM]=gt[jM]=gt[RM]=gt[NM]=gt[MM]=gt[LM]=gt[BM]=!1;function JM(e){return vs(e)&&w1(e.length)&&!!gt[gs(e)]}function Md(e){return function(r){return e(r)}}var S1=typeof Yr=="object"&&Yr&&!Yr.nodeType&&Yr,Ni=S1&&typeof qr=="object"&&qr&&!qr.nodeType&&qr,QM=Ni&&Ni.exports===S1,Al=QM&&u1.process,ZM=function(){try{var e=Ni&&Ni.require&&Ni.require("util").types;return e||Al&&Al.binding&&Al.binding("util")}catch{}}();const Zs=ZM;var Mh=Zs&&Zs.isTypedArray,e6=Mh?Md(Mh):JM;const t6=e6;var r6=Object.prototype,n6=r6.hasOwnProperty;function E1(e,r){var t=yo(e),n=!t&&gM(e),a=!t&&!n&&b1(e),s=!t&&!n&&!a&&t6(e),i=t||n||a||s,c=i?fM(e.length,String):[],l=c.length;for(var u in e)(r||n6.call(e,u))&&!(i&&(u=="length"||a&&(u=="offset"||u=="parent")||s&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||kM(u,l)))&&c.push(u);return c}var a6=Object.prototype;function Ld(e){var r=e&&e.constructor,t=typeof r=="function"&&r.prototype||a6;return e===t}var s6=f1(Object.keys,Object);const i6=s6;var o6=Object.prototype,c6=o6.hasOwnProperty;function l6(e){if(!Ld(e))return i6(e);var r=[];for(var t in Object(e))c6.call(e,t)&&t!="constructor"&&r.push(t);return r}function T1(e){return e!=null&&w1(e.length)&&!m1(e)}function Bd(e){return T1(e)?E1(e):l6(e)}function u6(e,r){return e&&Yc(r,Bd(r),e)}function d6(e){var r=[];if(e!=null)for(var t in Object(e))r.push(t);return r}var f6=Object.prototype,h6=f6.hasOwnProperty;function p6(e){if(!vo(e))return d6(e);var r=Ld(e),t=[];for(var n in e)n=="constructor"&&(r||!h6.call(e,n))||t.push(n);return t}function $d(e){return T1(e)?E1(e,!0):p6(e)}function m6(e,r){return e&&Yc(r,$d(r),e)}var k1=typeof Yr=="object"&&Yr&&!Yr.nodeType&&Yr,Lh=k1&&typeof qr=="object"&&qr&&!qr.nodeType&&qr,x6=Lh&&Lh.exports===k1,Bh=x6?Hn.Buffer:void 0,$h=Bh?Bh.allocUnsafe:void 0;function g6(e,r){if(r)return e.slice();var t=e.length,n=$h?$h(t):new e.constructor(t);return e.copy(n),n}function A1(e,r){var t=-1,n=e.length;for(r||(r=Array(n));++t<n;)r[t]=e[t];return r}function v6(e,r){for(var t=-1,n=e==null?0:e.length,a=0,s=[];++t<n;){var i=e[t];r(i,t,e)&&(s[a++]=i)}return s}function C1(){return[]}var y6=Object.prototype,b6=y6.propertyIsEnumerable,Uh=Object.getOwnPropertySymbols,w6=Uh?function(e){return e==null?[]:(e=Object(e),v6(Uh(e),function(r){return b6.call(e,r)}))}:C1;const Ud=w6;function S6(e,r){return Yc(e,Ud(e),r)}function _1(e,r){for(var t=-1,n=r.length,a=e.length;++t<n;)e[a+t]=r[t];return e}var E6=Object.getOwnPropertySymbols,T6=E6?function(e){for(var r=[];e;)_1(r,Ud(e)),e=Nd(e);return r}:C1;const D1=T6;function k6(e,r){return Yc(e,D1(e),r)}function F1(e,r,t){var n=r(e);return yo(e)?n:_1(n,t(e))}function A6(e){return F1(e,Bd,Ud)}function C6(e){return F1(e,$d,D1)}var _6=bs(Hn,"DataView");const iu=_6;var D6=bs(Hn,"Promise");const ou=D6;var F6=bs(Hn,"Set");const cu=F6;var I6=bs(Hn,"WeakMap");const lu=I6;var Vh="[object Map]",P6="[object Object]",Wh="[object Promise]",Hh="[object Set]",zh="[object WeakMap]",Gh="[object DataView]",O6=ys(iu),j6=ys(to),R6=ys(ou),N6=ys(cu),M6=ys(lu),Oa=gs;(iu&&Oa(new iu(new ArrayBuffer(1)))!=Gh||to&&Oa(new to)!=Vh||ou&&Oa(ou.resolve())!=Wh||cu&&Oa(new cu)!=Hh||lu&&Oa(new lu)!=zh)&&(Oa=function(e){var r=gs(e),t=r==P6?e.constructor:void 0,n=t?ys(t):"";if(n)switch(n){case O6:return Gh;case j6:return Vh;case R6:return Wh;case N6:return Hh;case M6:return zh}return r});const Vd=Oa;var L6=Object.prototype,B6=L6.hasOwnProperty;function $6(e){var r=e.length,t=new e.constructor(r);return r&&typeof e[0]=="string"&&B6.call(e,"index")&&(t.index=e.index,t.input=e.input),t}var U6=Hn.Uint8Array;const Yh=U6;function Wd(e){var r=new e.constructor(e.byteLength);return new Yh(r).set(new Yh(e)),r}function V6(e,r){var t=r?Wd(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.byteLength)}var W6=/\w*$/;function H6(e){var r=new e.constructor(e.source,W6.exec(e));return r.lastIndex=e.lastIndex,r}var qh=va?va.prototype:void 0,Xh=qh?qh.valueOf:void 0;function z6(e){return Xh?Object(Xh.call(e)):{}}function G6(e,r){var t=r?Wd(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.length)}var Y6="[object Boolean]",q6="[object Date]",X6="[object Map]",K6="[object Number]",J6="[object RegExp]",Q6="[object Set]",Z6="[object String]",eL="[object Symbol]",tL="[object ArrayBuffer]",rL="[object DataView]",nL="[object Float32Array]",aL="[object Float64Array]",sL="[object Int8Array]",iL="[object Int16Array]",oL="[object Int32Array]",cL="[object Uint8Array]",lL="[object Uint8ClampedArray]",uL="[object Uint16Array]",dL="[object Uint32Array]";function fL(e,r,t){var n=e.constructor;switch(r){case tL:return Wd(e);case Y6:case q6:return new n(+e);case rL:return V6(e,t);case nL:case aL:case sL:case iL:case oL:case cL:case lL:case uL:case dL:return G6(e,t);case X6:return new n;case K6:case Z6:return new n(e);case J6:return H6(e);case Q6:return new n;case eL:return z6(e)}}var Kh=Object.create,hL=function(){function e(){}return function(r){if(!vo(r))return{};if(Kh)return Kh(r);e.prototype=r;var t=new e;return e.prototype=void 0,t}}();const pL=hL;function mL(e){return typeof e.constructor=="function"&&!Ld(e)?pL(Nd(e)):{}}var xL="[object Map]";function gL(e){return vs(e)&&Vd(e)==xL}var Jh=Zs&&Zs.isMap,vL=Jh?Md(Jh):gL;const yL=vL;var bL="[object Set]";function wL(e){return vs(e)&&Vd(e)==bL}var Qh=Zs&&Zs.isSet,SL=Qh?Md(Qh):wL;const EL=SL;var TL=1,kL=2,AL=4,I1="[object Arguments]",CL="[object Array]",_L="[object Boolean]",DL="[object Date]",FL="[object Error]",P1="[object Function]",IL="[object GeneratorFunction]",PL="[object Map]",OL="[object Number]",O1="[object Object]",jL="[object RegExp]",RL="[object Set]",NL="[object String]",ML="[object Symbol]",LL="[object WeakMap]",BL="[object ArrayBuffer]",$L="[object DataView]",UL="[object Float32Array]",VL="[object Float64Array]",WL="[object Int8Array]",HL="[object Int16Array]",zL="[object Int32Array]",GL="[object Uint8Array]",YL="[object Uint8ClampedArray]",qL="[object Uint16Array]",XL="[object Uint32Array]",mt={};mt[I1]=mt[CL]=mt[BL]=mt[$L]=mt[_L]=mt[DL]=mt[UL]=mt[VL]=mt[WL]=mt[HL]=mt[zL]=mt[PL]=mt[OL]=mt[O1]=mt[jL]=mt[RL]=mt[NL]=mt[ML]=mt[GL]=mt[YL]=mt[qL]=mt[XL]=!0;mt[FL]=mt[P1]=mt[LL]=!1;function Mi(e,r,t,n,a,s){var i,c=r&TL,l=r&kL,u=r&AL;if(t&&(i=a?t(e,n,a,s):t(e)),i!==void 0)return i;if(!vo(e))return e;var d=yo(e);if(d){if(i=$6(e),!c)return A1(e,i)}else{var f=Vd(e),h=f==P1||f==IL;if(b1(e))return g6(e,c);if(f==O1||f==I1||h&&!a){if(i=l||h?{}:mL(e),!c)return l?k6(e,m6(i,e)):S6(e,u6(i,e))}else{if(!mt[f])return a?e:{};i=fL(e,f,c)}}s||(s=new oi);var x=s.get(e);if(x)return x;s.set(e,i),EL(e)?e.forEach(function(g){i.add(Mi(g,r,t,g,e,s))}):yL(e)&&e.forEach(function(g,v){i.set(v,Mi(g,r,t,v,e,s))});var p=u?l?C6:A6:l?$d:Bd,m=d?void 0:p(e);return cM(m||e,function(g,v){m&&(v=g,g=e[v]),g1(i,v,Mi(g,r,t,v,e,s))}),i}var KL=1,JL=4;function jo(e){return Mi(e,KL|JL)}var Zh=Array.isArray,ep=Object.keys,QL=Object.prototype.hasOwnProperty,ZL=typeof Element<"u";function uu(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){var t=Zh(e),n=Zh(r),a,s,i;if(t&&n){if(s=e.length,s!=r.length)return!1;for(a=s;a--!==0;)if(!uu(e[a],r[a]))return!1;return!0}if(t!=n)return!1;var c=e instanceof Date,l=r instanceof Date;if(c!=l)return!1;if(c&&l)return e.getTime()==r.getTime();var u=e instanceof RegExp,d=r instanceof RegExp;if(u!=d)return!1;if(u&&d)return e.toString()==r.toString();var f=ep(e);if(s=f.length,s!==ep(r).length)return!1;for(a=s;a--!==0;)if(!QL.call(r,f[a]))return!1;if(ZL&&e instanceof Element&&r instanceof Element)return e===r;for(a=s;a--!==0;)if(i=f[a],!(i==="_owner"&&e.$$typeof)&&!uu(e[i],r[i]))return!1;return!0}return e!==e&&r!==r}var e5=function(r,t){try{return uu(r,t)}catch(n){if(n.message&&n.message.match(/stack|recursion/i)||n.number===-2146828260)return console.warn("Warning: react-fast-compare does not handle circular references.",n.name,n.message),!1;throw n}};const ja=Pp(e5);var t5=!0;function r5(e,r){if(!t5){if(e)return;var t="Warning: "+r;typeof console<"u"&&console.warn(t);try{throw Error(t)}catch{}}}var n5=4;function tp(e){return Mi(e,n5)}function j1(e,r){for(var t=-1,n=e==null?0:e.length,a=Array(n);++t<n;)a[t]=r(e[t],t,e);return a}var a5="[object Symbol]";function Hd(e){return typeof e=="symbol"||vs(e)&&gs(e)==a5}var s5="Expected a function";function zd(e,r){if(typeof e!="function"||r!=null&&typeof r!="function")throw new TypeError(s5);var t=function(){var n=arguments,a=r?r.apply(this,n):n[0],s=t.cache;if(s.has(a))return s.get(a);var i=e.apply(this,n);return t.cache=s.set(a,i)||s,i};return t.cache=new(zd.Cache||Sa),t}zd.Cache=Sa;var i5=500;function o5(e){var r=zd(e,function(n){return t.size===i5&&t.clear(),n}),t=r.cache;return r}var c5=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,l5=/\\(\\)?/g,u5=o5(function(e){var r=[];return e.charCodeAt(0)===46&&r.push(""),e.replace(c5,function(t,n,a,s){r.push(a?s.replace(l5,"$1"):n||t)}),r});const d5=u5;var f5=1/0;function h5(e){if(typeof e=="string"||Hd(e))return e;var r=e+"";return r=="0"&&1/e==-f5?"-0":r}var p5=1/0,rp=va?va.prototype:void 0,np=rp?rp.toString:void 0;function R1(e){if(typeof e=="string")return e;if(yo(e))return j1(e,R1)+"";if(Hd(e))return np?np.call(e):"";var r=e+"";return r=="0"&&1/e==-p5?"-0":r}function m5(e){return e==null?"":R1(e)}function N1(e){return yo(e)?j1(e,h5):Hd(e)?[e]:A1(d5(m5(e)))}function er(){return er=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},er.apply(this,arguments)}function M1(e,r){if(e==null)return{};var t={},n=Object.keys(e),a,s;for(s=0;s<n.length;s++)a=n[s],!(r.indexOf(a)>=0)&&(t[a]=e[a]);return t}var qc=C.createContext(void 0);qc.displayName="FormikContext";qc.Provider;qc.Consumer;function x5(){var e=C.useContext(qc);return e||r5(!1),e}var hn=function(r){return typeof r=="function"},Xc=function(r){return r!==null&&typeof r=="object"},g5=function(r){return String(Math.floor(Number(r)))===r},Cl=function(r){return Object.prototype.toString.call(r)==="[object String]"},_l=function(r){return Xc(r)&&hn(r.then)};function Wr(e,r,t,n){n===void 0&&(n=0);for(var a=N1(r);e&&n<a.length;)e=e[a[n++]];return n!==a.length&&!e||e===void 0?t:e}function Ha(e,r,t){for(var n=tp(e),a=n,s=0,i=N1(r);s<i.length-1;s++){var c=i[s],l=Wr(e,i.slice(0,s+1));if(l&&(Xc(l)||Array.isArray(l)))a=a[c]=tp(l);else{var u=i[s+1];a=a[c]=g5(u)&&Number(u)>=0?[]:{}}}return(s===0?e:a)[i[s]]===t?e:(t===void 0?delete a[i[s]]:a[i[s]]=t,s===0&&t===void 0&&delete n[i[s]],n)}function L1(e,r,t,n){t===void 0&&(t=new WeakMap),n===void 0&&(n={});for(var a=0,s=Object.keys(e);a<s.length;a++){var i=s[a],c=e[i];Xc(c)?t.get(c)||(t.set(c,!0),n[i]=Array.isArray(c)?[]:{},L1(c,r,t,n[i])):n[i]=r}return n}function v5(e,r){switch(r.type){case"SET_VALUES":return er({},e,{values:r.payload});case"SET_TOUCHED":return er({},e,{touched:r.payload});case"SET_ERRORS":return ja(e.errors,r.payload)?e:er({},e,{errors:r.payload});case"SET_STATUS":return er({},e,{status:r.payload});case"SET_ISSUBMITTING":return er({},e,{isSubmitting:r.payload});case"SET_ISVALIDATING":return er({},e,{isValidating:r.payload});case"SET_FIELD_VALUE":return er({},e,{values:Ha(e.values,r.payload.field,r.payload.value)});case"SET_FIELD_TOUCHED":return er({},e,{touched:Ha(e.touched,r.payload.field,r.payload.value)});case"SET_FIELD_ERROR":return er({},e,{errors:Ha(e.errors,r.payload.field,r.payload.value)});case"RESET_FORM":return er({},e,r.payload);case"SET_FORMIK_STATE":return r.payload(e);case"SUBMIT_ATTEMPT":return er({},e,{touched:L1(e.values,!0),isSubmitting:!0,submitCount:e.submitCount+1});case"SUBMIT_FAILURE":return er({},e,{isSubmitting:!1});case"SUBMIT_SUCCESS":return er({},e,{isSubmitting:!1});default:return e}}var Da={},Ro={};function y5(e){var r=e.validateOnChange,t=r===void 0?!0:r,n=e.validateOnBlur,a=n===void 0?!0:n,s=e.validateOnMount,i=s===void 0?!1:s,c=e.isInitialValid,l=e.enableReinitialize,u=l===void 0?!1:l,d=e.onSubmit,f=M1(e,["validateOnChange","validateOnBlur","validateOnMount","isInitialValid","enableReinitialize","onSubmit"]),h=er({validateOnChange:t,validateOnBlur:a,validateOnMount:i,onSubmit:d},f),x=C.useRef(h.initialValues),p=C.useRef(h.initialErrors||Da),m=C.useRef(h.initialTouched||Ro),g=C.useRef(h.initialStatus),v=C.useRef(!1),y=C.useRef({});C.useEffect(function(){return v.current=!0,function(){v.current=!1}},[]);var b=C.useState(0),S=b[1],I=C.useRef({values:jo(h.initialValues),errors:jo(h.initialErrors)||Da,touched:jo(h.initialTouched)||Ro,status:jo(h.initialStatus),isSubmitting:!1,isValidating:!1,submitCount:0}),k=I.current,E=C.useCallback(function(N){var ie=I.current;I.current=v5(ie,N),ie!==I.current&&S(function(le){return le+1})},[]),T=C.useCallback(function(N,ie){return new Promise(function(le,we){var Ae=h.validate(N,ie);Ae==null?le(Da):_l(Ae)?Ae.then(function(Le){le(Le||Da)},function(Le){we(Le)}):le(Ae)})},[h.validate]),w=C.useCallback(function(N,ie){var le=h.validationSchema,we=hn(le)?le(ie):le,Ae=ie&&we.validateAt?we.validateAt(ie,N):w5(N,we);return new Promise(function(Le,Ue){Ae.then(function(){Le(Da)},function(Fe){Fe.name==="ValidationError"?Le(b5(Fe)):Ue(Fe)})})},[h.validationSchema]),F=C.useCallback(function(N,ie){return new Promise(function(le){return le(y.current[N].validate(ie))})},[]),P=C.useCallback(function(N){var ie=Object.keys(y.current).filter(function(we){return hn(y.current[we].validate)}),le=ie.length>0?ie.map(function(we){return F(we,Wr(N,we))}):[Promise.resolve("DO_NOT_DELETE_YOU_WILL_BE_FIRED")];return Promise.all(le).then(function(we){return we.reduce(function(Ae,Le,Ue){return Le==="DO_NOT_DELETE_YOU_WILL_BE_FIRED"||Le&&(Ae=Ha(Ae,ie[Ue],Le)),Ae},{})})},[F]),A=C.useCallback(function(N){return Promise.all([P(N),h.validationSchema?w(N):{},h.validate?T(N):{}]).then(function(ie){var le=ie[0],we=ie[1],Ae=ie[2],Le=su.all([le,we,Ae],{arrayMerge:S5});return Le})},[h.validate,h.validationSchema,P,T,w]),L=Zr(function(N){return N===void 0&&(N=k.values),E({type:"SET_ISVALIDATING",payload:!0}),A(N).then(function(ie){return v.current&&(E({type:"SET_ISVALIDATING",payload:!1}),E({type:"SET_ERRORS",payload:ie})),ie})});C.useEffect(function(){i&&v.current===!0&&ja(x.current,h.initialValues)&&L(x.current)},[i,L]);var Y=C.useCallback(function(N){var ie=N&&N.values?N.values:x.current,le=N&&N.errors?N.errors:p.current?p.current:h.initialErrors||{},we=N&&N.touched?N.touched:m.current?m.current:h.initialTouched||{},Ae=N&&N.status?N.status:g.current?g.current:h.initialStatus;x.current=ie,p.current=le,m.current=we,g.current=Ae;var Le=function(){E({type:"RESET_FORM",payload:{isSubmitting:!!N&&!!N.isSubmitting,errors:le,touched:we,status:Ae,values:ie,isValidating:!!N&&!!N.isValidating,submitCount:N&&N.submitCount&&typeof N.submitCount=="number"?N.submitCount:0}})};if(h.onReset){var Ue=h.onReset(k.values,ae);_l(Ue)?Ue.then(Le):Le()}else Le()},[h.initialErrors,h.initialStatus,h.initialTouched,h.onReset]);C.useEffect(function(){v.current===!0&&!ja(x.current,h.initialValues)&&u&&(x.current=h.initialValues,Y(),i&&L(x.current))},[u,h.initialValues,Y,i,L]),C.useEffect(function(){u&&v.current===!0&&!ja(p.current,h.initialErrors)&&(p.current=h.initialErrors||Da,E({type:"SET_ERRORS",payload:h.initialErrors||Da}))},[u,h.initialErrors]),C.useEffect(function(){u&&v.current===!0&&!ja(m.current,h.initialTouched)&&(m.current=h.initialTouched||Ro,E({type:"SET_TOUCHED",payload:h.initialTouched||Ro}))},[u,h.initialTouched]),C.useEffect(function(){u&&v.current===!0&&!ja(g.current,h.initialStatus)&&(g.current=h.initialStatus,E({type:"SET_STATUS",payload:h.initialStatus}))},[u,h.initialStatus,h.initialTouched]);var q=Zr(function(N){if(y.current[N]&&hn(y.current[N].validate)){var ie=Wr(k.values,N),le=y.current[N].validate(ie);return _l(le)?(E({type:"SET_ISVALIDATING",payload:!0}),le.then(function(we){return we}).then(function(we){E({type:"SET_FIELD_ERROR",payload:{field:N,value:we}}),E({type:"SET_ISVALIDATING",payload:!1})})):(E({type:"SET_FIELD_ERROR",payload:{field:N,value:le}}),Promise.resolve(le))}else if(h.validationSchema)return E({type:"SET_ISVALIDATING",payload:!0}),w(k.values,N).then(function(we){return we}).then(function(we){E({type:"SET_FIELD_ERROR",payload:{field:N,value:Wr(we,N)}}),E({type:"SET_ISVALIDATING",payload:!1})});return Promise.resolve()}),Q=C.useCallback(function(N,ie){var le=ie.validate;y.current[N]={validate:le}},[]),K=C.useCallback(function(N){delete y.current[N]},[]),ye=Zr(function(N,ie){E({type:"SET_TOUCHED",payload:N});var le=ie===void 0?a:ie;return le?L(k.values):Promise.resolve()}),U=C.useCallback(function(N){E({type:"SET_ERRORS",payload:N})},[]),me=Zr(function(N,ie){var le=hn(N)?N(k.values):N;E({type:"SET_VALUES",payload:le});var we=ie===void 0?t:ie;return we?L(le):Promise.resolve()}),J=C.useCallback(function(N,ie){E({type:"SET_FIELD_ERROR",payload:{field:N,value:ie}})},[]),D=Zr(function(N,ie,le){E({type:"SET_FIELD_VALUE",payload:{field:N,value:ie}});var we=le===void 0?t:le;return we?L(Ha(k.values,N,ie)):Promise.resolve()}),B=C.useCallback(function(N,ie){var le=ie,we=N,Ae;if(!Cl(N)){N.persist&&N.persist();var Le=N.target?N.target:N.currentTarget,Ue=Le.type,Fe=Le.name,Pe=Le.id,Ve=Le.value,Ye=Le.checked,et=Le.outerHTML,ut=Le.options,ar=Le.multiple;le=ie||Fe||Pe,we=/number|range/.test(Ue)?(Ae=parseFloat(Ve),isNaN(Ae)?"":Ae):/checkbox/.test(Ue)?T5(Wr(k.values,le),Ye,Ve):ut&&ar?E5(ut):Ve}le&&D(le,we)},[D,k.values]),V=Zr(function(N){if(Cl(N))return function(ie){return B(ie,N)};B(N)}),W=Zr(function(N,ie,le){ie===void 0&&(ie=!0),E({type:"SET_FIELD_TOUCHED",payload:{field:N,value:ie}});var we=le===void 0?a:le;return we?L(k.values):Promise.resolve()}),Z=C.useCallback(function(N,ie){N.persist&&N.persist();var le=N.target,we=le.name,Ae=le.id,Le=le.outerHTML,Ue=ie||we||Ae;W(Ue,!0)},[W]),fe=Zr(function(N){if(Cl(N))return function(ie){return Z(ie,N)};Z(N)}),ne=C.useCallback(function(N){hn(N)?E({type:"SET_FORMIK_STATE",payload:N}):E({type:"SET_FORMIK_STATE",payload:function(){return N}})},[]),ee=C.useCallback(function(N){E({type:"SET_STATUS",payload:N})},[]),se=C.useCallback(function(N){E({type:"SET_ISSUBMITTING",payload:N})},[]),j=Zr(function(){return E({type:"SUBMIT_ATTEMPT"}),L().then(function(N){var ie=N instanceof Error,le=!ie&&Object.keys(N).length===0;if(le){var we;try{if(we=oe(),we===void 0)return}catch(Ae){throw Ae}return Promise.resolve(we).then(function(Ae){return v.current&&E({type:"SUBMIT_SUCCESS"}),Ae}).catch(function(Ae){if(v.current)throw E({type:"SUBMIT_FAILURE"}),Ae})}else if(v.current&&(E({type:"SUBMIT_FAILURE"}),ie))throw N})}),_=Zr(function(N){N&&N.preventDefault&&hn(N.preventDefault)&&N.preventDefault(),N&&N.stopPropagation&&hn(N.stopPropagation)&&N.stopPropagation(),j().catch(function(ie){console.warn("Warning: An unhandled error was caught from submitForm()",ie)})}),ae={resetForm:Y,validateForm:L,validateField:q,setErrors:U,setFieldError:J,setFieldTouched:W,setFieldValue:D,setStatus:ee,setSubmitting:se,setTouched:ye,setValues:me,setFormikState:ne,submitForm:j},oe=Zr(function(){return d(k.values,ae)}),Te=Zr(function(N){N&&N.preventDefault&&hn(N.preventDefault)&&N.preventDefault(),N&&N.stopPropagation&&hn(N.stopPropagation)&&N.stopPropagation(),Y()}),ce=C.useCallback(function(N){return{value:Wr(k.values,N),error:Wr(k.errors,N),touched:!!Wr(k.touched,N),initialValue:Wr(x.current,N),initialTouched:!!Wr(m.current,N),initialError:Wr(p.current,N)}},[k.errors,k.touched,k.values]),be=C.useCallback(function(N){return{setValue:function(le,we){return D(N,le,we)},setTouched:function(le,we){return W(N,le,we)},setError:function(le){return J(N,le)}}},[D,W,J]),pe=C.useCallback(function(N){var ie=Xc(N),le=ie?N.name:N,we=Wr(k.values,le),Ae={name:le,value:we,onChange:V,onBlur:fe};if(ie){var Le=N.type,Ue=N.value,Fe=N.as,Pe=N.multiple;Le==="checkbox"?Ue===void 0?Ae.checked=!!we:(Ae.checked=!!(Array.isArray(we)&&~we.indexOf(Ue)),Ae.value=Ue):Le==="radio"?(Ae.checked=we===Ue,Ae.value=Ue):Fe==="select"&&Pe&&(Ae.value=Ae.value||[],Ae.multiple=!0)}return Ae},[fe,V,k.values]),Ce=C.useMemo(function(){return!ja(x.current,k.values)},[x.current,k.values]),Oe=C.useMemo(function(){return typeof c<"u"?Ce?k.errors&&Object.keys(k.errors).length===0:c!==!1&&hn(c)?c(h):c:k.errors&&Object.keys(k.errors).length===0},[c,Ce,k.errors,h]),He=er({},k,{initialValues:x.current,initialErrors:p.current,initialTouched:m.current,initialStatus:g.current,handleBlur:fe,handleChange:V,handleReset:Te,handleSubmit:_,resetForm:Y,setErrors:U,setFormikState:ne,setFieldTouched:W,setFieldValue:D,setFieldError:J,setStatus:ee,setSubmitting:se,setTouched:ye,setValues:me,submitForm:j,validateForm:L,validateField:q,isValid:Oe,dirty:Ce,unregisterField:K,registerField:Q,getFieldProps:pe,getFieldMeta:ce,getFieldHelpers:be,validateOnBlur:a,validateOnChange:t,validateOnMount:i});return He}function b5(e){var r={};if(e.inner){if(e.inner.length===0)return Ha(r,e.path,e.message);for(var a=e.inner,t=Array.isArray(a),n=0,a=t?a:a[Symbol.iterator]();;){var s;if(t){if(n>=a.length)break;s=a[n++]}else{if(n=a.next(),n.done)break;s=n.value}var i=s;Wr(r,i.path)||(r=Ha(r,i.path,i.message))}}return r}function w5(e,r,t,n){t===void 0&&(t=!1);var a=du(e);return r[t?"validateSync":"validate"](a,{abortEarly:!1,context:n||a})}function du(e){var r=Array.isArray(e)?[]:{};for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=String(t);Array.isArray(e[n])===!0?r[n]=e[n].map(function(a){return Array.isArray(a)===!0||Ih(a)?du(a):a!==""?a:void 0}):Ih(e[n])?r[n]=du(e[n]):r[n]=e[n]!==""?e[n]:void 0}return r}function S5(e,r,t){var n=e.slice();return r.forEach(function(s,i){if(typeof n[i]>"u"){var c=t.clone!==!1,l=c&&t.isMergeableObject(s);n[i]=l?su(Array.isArray(s)?[]:{},s,t):s}else t.isMergeableObject(s)?n[i]=su(e[i],s,t):e.indexOf(s)===-1&&n.push(s)}),n}function E5(e){return Array.from(e).filter(function(r){return r.selected}).map(function(r){return r.value})}function T5(e,r,t){if(typeof e=="boolean")return!!r;var n=[],a=!1,s=-1;if(Array.isArray(e))n=e,s=e.indexOf(t),a=s>=0;else if(!t||t=="true"||t=="false")return!!r;return r&&t&&!a?n.concat(t):a?n.slice(0,s).concat(n.slice(s+1)):n}var k5=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?C.useLayoutEffect:C.useEffect;function Zr(e){var r=C.useRef(e);return k5(function(){r.current=e}),C.useCallback(function(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return r.current.apply(void 0,n)},[])}var A5=C.forwardRef(function(e,r){var t=e.action,n=M1(e,["action"]),a=t??"#",s=x5(),i=s.handleReset,c=s.handleSubmit;return C.createElement("form",er({onSubmit:c,ref:r,onReset:i,action:a},n))});A5.displayName="Form";function ws(e){this._maxSize=e,this.clear()}ws.prototype.clear=function(){this._size=0,this._values=Object.create(null)};ws.prototype.get=function(e){return this._values[e]};ws.prototype.set=function(e,r){return this._size>=this._maxSize&&this.clear(),e in this._values||this._size++,this._values[e]=r};var C5=/[^.^\]^[]+|(?=\[\]|\.\.)/g,B1=/^\d+$/,_5=/^\d/,D5=/[~`!#$%\^&*+=\-\[\]\\';,/{}|\\":<>\?]/g,F5=/^\s*(['"]?)(.*?)(\1)\s*$/,Gd=512,ap=new ws(Gd),sp=new ws(Gd),ip=new ws(Gd),za={Cache:ws,split:fu,normalizePath:Dl,setter:function(e){var r=Dl(e);return sp.get(e)||sp.set(e,function(n,a){for(var s=0,i=r.length,c=n;s<i-1;){var l=r[s];if(l==="__proto__"||l==="constructor"||l==="prototype")return n;c=c[r[s++]]}c[r[s]]=a})},getter:function(e,r){var t=Dl(e);return ip.get(e)||ip.set(e,function(a){for(var s=0,i=t.length;s<i;)if(a!=null||!r)a=a[t[s++]];else return;return a})},join:function(e){return e.reduce(function(r,t){return r+(Yd(t)||B1.test(t)?"["+t+"]":(r?".":"")+t)},"")},forEach:function(e,r,t){I5(Array.isArray(e)?e:fu(e),r,t)}};function Dl(e){return ap.get(e)||ap.set(e,fu(e).map(function(r){return r.replace(F5,"$2")}))}function fu(e){return e.match(C5)||[""]}function I5(e,r,t){var n=e.length,a,s,i,c;for(s=0;s<n;s++)a=e[s],a&&(j5(a)&&(a='"'+a+'"'),c=Yd(a),i=!c&&/^\d+$/.test(a),r.call(t,a,c,i,s,e))}function Yd(e){return typeof e=="string"&&e&&["'",'"'].indexOf(e.charAt(0))!==-1}function P5(e){return e.match(_5)&&!e.match(B1)}function O5(e){return D5.test(e)}function j5(e){return!Yd(e)&&(P5(e)||O5(e))}const R5=/[A-Z\xc0-\xd6\xd8-\xde]?[a-z\xdf-\xf6\xf8-\xff]+(?:['â€™](?:d|ll|m|re|s|t|ve))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde]|$)|(?:[A-Z\xc0-\xd6\xd8-\xde]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['â€™](?:D|LL|M|RE|S|T|VE))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde](?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])|$)|[A-Z\xc0-\xd6\xd8-\xde]?(?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['â€™](?:d|ll|m|re|s|t|ve))?|[A-Z\xc0-\xd6\xd8-\xde]+(?:['â€™](?:D|LL|M|RE|S|T|VE))?|\d*(?:1ST|2ND|3RD|(?![123])\dTH)(?=\b|[a-z_])|\d*(?:1st|2nd|3rd|(?![123])\dth)(?=\b|[A-Z_])|\d+|(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?)*/g,Kc=e=>e.match(R5)||[],Jc=e=>e[0].toUpperCase()+e.slice(1),qd=(e,r)=>Kc(e).join(r).toLowerCase(),$1=e=>Kc(e).reduce((r,t)=>`${r}${r?t[0].toUpperCase()+t.slice(1).toLowerCase():t.toLowerCase()}`,""),N5=e=>Jc($1(e)),M5=e=>qd(e,"_"),L5=e=>qd(e,"-"),B5=e=>Jc(qd(e," ")),$5=e=>Kc(e).map(Jc).join(" ");var Fl={words:Kc,upperFirst:Jc,camelCase:$1,pascalCase:N5,snakeCase:M5,kebabCase:L5,sentenceCase:B5,titleCase:$5},Xd={exports:{}};Xd.exports=function(e){return U1(U5(e),e)};Xd.exports.array=U1;function U1(e,r){var t=e.length,n=new Array(t),a={},s=t,i=V5(r),c=W5(e);for(r.forEach(function(u){if(!c.has(u[0])||!c.has(u[1]))throw new Error("Unknown node. There is an unknown node in the supplied edges.")});s--;)a[s]||l(e[s],s,new Set);return n;function l(u,d,f){if(f.has(u)){var h;try{h=", node was:"+JSON.stringify(u)}catch{h=""}throw new Error("Cyclic dependency"+h)}if(!c.has(u))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(u));if(!a[d]){a[d]=!0;var x=i.get(u)||new Set;if(x=Array.from(x),d=x.length){f.add(u);do{var p=x[--d];l(p,c.get(p),f)}while(d);f.delete(u)}n[--t]=u}}}function U5(e){for(var r=new Set,t=0,n=e.length;t<n;t++){var a=e[t];r.add(a[0]),r.add(a[1])}return Array.from(r)}function V5(e){for(var r=new Map,t=0,n=e.length;t<n;t++){var a=e[t];r.has(a[0])||r.set(a[0],new Set),r.has(a[1])||r.set(a[1],new Set),r.get(a[0]).add(a[1])}return r}function W5(e){for(var r=new Map,t=0,n=e.length;t<n;t++)r.set(e[t],t);return r}var H5=Xd.exports;const z5=Pp(H5),G5=Object.prototype.toString,Y5=Error.prototype.toString,q5=RegExp.prototype.toString,X5=typeof Symbol<"u"?Symbol.prototype.toString:()=>"",K5=/^Symbol\((.*)\)(.*)$/;function J5(e){return e!=+e?"NaN":e===0&&1/e<0?"-0":""+e}function op(e,r=!1){if(e==null||e===!0||e===!1)return""+e;const t=typeof e;if(t==="number")return J5(e);if(t==="string")return r?`"${e}"`:e;if(t==="function")return"[Function "+(e.name||"anonymous")+"]";if(t==="symbol")return X5.call(e).replace(K5,"Symbol($1)");const n=G5.call(e).slice(8,-1);return n==="Date"?isNaN(e.getTime())?""+e:e.toISOString(e):n==="Error"||e instanceof Error?"["+Y5.call(e)+"]":n==="RegExp"?q5.call(e):null}function ma(e,r){let t=op(e,r);return t!==null?t:JSON.stringify(e,function(n,a){let s=op(this[n],r);return s!==null?s:a},2)}function V1(e){return e==null?[]:[].concat(e)}let W1,H1,z1,Q5=/\$\{\s*(\w+)\s*\}/g;W1=Symbol.toStringTag;class cp{constructor(r,t,n,a){this.name=void 0,this.message=void 0,this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=void 0,this.inner=void 0,this[W1]="Error",this.name="ValidationError",this.value=t,this.path=n,this.type=a,this.errors=[],this.inner=[],V1(r).forEach(s=>{if(Or.isError(s)){this.errors.push(...s.errors);const i=s.inner.length?s.inner:[s];this.inner.push(...i)}else this.errors.push(s)}),this.message=this.errors.length>1?`${this.errors.length} errors occurred`:this.errors[0]}}H1=Symbol.hasInstance;z1=Symbol.toStringTag;class Or extends Error{static formatError(r,t){const n=t.label||t.path||"this";return t=Object.assign({},t,{path:n,originalPath:t.path}),typeof r=="string"?r.replace(Q5,(a,s)=>ma(t[s])):typeof r=="function"?r(t):r}static isError(r){return r&&r.name==="ValidationError"}constructor(r,t,n,a,s){const i=new cp(r,t,n,a);if(s)return i;super(),this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=[],this.inner=[],this[z1]="Error",this.name=i.name,this.message=i.message,this.type=i.type,this.value=i.value,this.path=i.path,this.errors=i.errors,this.inner=i.inner,Error.captureStackTrace&&Error.captureStackTrace(this,Or)}static[H1](r){return cp[Symbol.hasInstance](r)||super[Symbol.hasInstance](r)}}let Dn={default:"${path} is invalid",required:"${path} is a required field",defined:"${path} must be defined",notNull:"${path} cannot be null",oneOf:"${path} must be one of the following values: ${values}",notOneOf:"${path} must not be one of the following values: ${values}",notType:({path:e,type:r,value:t,originalValue:n})=>{const a=n!=null&&n!==t?` (cast from the value \`${ma(n,!0)}\`).`:".";return r!=="mixed"?`${e} must be a \`${r}\` type, but the final value was: \`${ma(t,!0)}\``+a:`${e} must match the configured type. The validated value was: \`${ma(t,!0)}\``+a}},Fr={length:"${path} must be exactly ${length} characters",min:"${path} must be at least ${min} characters",max:"${path} must be at most ${max} characters",matches:'${path} must match the following: "${regex}"',email:"${path} must be a valid email",url:"${path} must be a valid URL",uuid:"${path} must be a valid UUID",datetime:"${path} must be a valid ISO date-time",datetime_precision:"${path} must be a valid ISO date-time with a sub-second precision of exactly ${precision} digits",datetime_offset:'${path} must be a valid ISO date-time with UTC "Z" timezone',trim:"${path} must be a trimmed string",lowercase:"${path} must be a lowercase string",uppercase:"${path} must be a upper case string"},ca={min:"${path} must be greater than or equal to ${min}",max:"${path} must be less than or equal to ${max}",lessThan:"${path} must be less than ${less}",moreThan:"${path} must be greater than ${more}",positive:"${path} must be a positive number",negative:"${path} must be a negative number",integer:"${path} must be an integer"},hu={min:"${path} field must be later than ${min}",max:"${path} field must be at earlier than ${max}"},Z5={isValue:"${path} field must be ${value}"},zo={noUnknown:"${path} field has unspecified keys: ${unknown}",exact:"${path} object contains unknown properties: ${properties}"},e8={min:"${path} field must have at least ${min} items",max:"${path} field must have less than or equal to ${max} items",length:"${path} must have ${length} items"},t8={notType:e=>{const{path:r,value:t,spec:n}=e,a=n.types.length;if(Array.isArray(t)){if(t.length<a)return`${r} tuple value has too few items, expected a length of ${a} but got ${t.length} for value: \`${ma(t,!0)}\``;if(t.length>a)return`${r} tuple value has too many items, expected a length of ${a} but got ${t.length} for value: \`${ma(t,!0)}\``}return Or.formatError(Dn.notType,e)}};Object.assign(Object.create(null),{mixed:Dn,string:Fr,number:ca,date:hu,object:zo,array:e8,boolean:Z5,tuple:t8});const Kd=e=>e&&e.__isYupSchema__;class mc{static fromOptions(r,t){if(!t.then&&!t.otherwise)throw new TypeError("either `then:` or `otherwise:` is required for `when()` conditions");let{is:n,then:a,otherwise:s}=t,i=typeof n=="function"?n:(...c)=>c.every(l=>l===n);return new mc(r,(c,l)=>{var u;let d=i(...c)?a:s;return(u=d==null?void 0:d(l))!=null?u:l})}constructor(r,t){this.fn=void 0,this.refs=r,this.refs=r,this.fn=t}resolve(r,t){let n=this.refs.map(s=>s.getValue(t==null?void 0:t.value,t==null?void 0:t.parent,t==null?void 0:t.context)),a=this.fn(n,r,t);if(a===void 0||a===r)return r;if(!Kd(a))throw new TypeError("conditions must return a schema object");return a.resolve(t)}}const No={context:"$",value:"."};class Ss{constructor(r,t={}){if(this.key=void 0,this.isContext=void 0,this.isValue=void 0,this.isSibling=void 0,this.path=void 0,this.getter=void 0,this.map=void 0,typeof r!="string")throw new TypeError("ref must be a string, got: "+r);if(this.key=r.trim(),r==="")throw new TypeError("ref must be a non-empty string");this.isContext=this.key[0]===No.context,this.isValue=this.key[0]===No.value,this.isSibling=!this.isContext&&!this.isValue;let n=this.isContext?No.context:this.isValue?No.value:"";this.path=this.key.slice(n.length),this.getter=this.path&&za.getter(this.path,!0),this.map=t.map}getValue(r,t,n){let a=this.isContext?n:this.isValue?r:t;return this.getter&&(a=this.getter(a||{})),this.map&&(a=this.map(a)),a}cast(r,t){return this.getValue(r,t==null?void 0:t.parent,t==null?void 0:t.context)}resolve(){return this}describe(){return{type:"ref",key:this.key}}toString(){return`Ref(${this.key})`}static isRef(r){return r&&r.__isYupRef}}Ss.prototype.__isYupRef=!0;const Kn=e=>e==null;function Fs(e){function r({value:t,path:n="",options:a,originalValue:s,schema:i},c,l){const{name:u,test:d,params:f,message:h,skipAbsent:x}=e;let{parent:p,context:m,abortEarly:g=i.spec.abortEarly,disableStackTrace:v=i.spec.disableStackTrace}=a;function y(P){return Ss.isRef(P)?P.getValue(t,p,m):P}function b(P={}){const A=Object.assign({value:t,originalValue:s,label:i.spec.label,path:P.path||n,spec:i.spec,disableStackTrace:P.disableStackTrace||v},f,P.params);for(const Y of Object.keys(A))A[Y]=y(A[Y]);const L=new Or(Or.formatError(P.message||h,A),t,A.path,P.type||u,A.disableStackTrace);return L.params=A,L}const S=g?c:l;let I={path:n,parent:p,type:u,from:a.from,createError:b,resolve:y,options:a,originalValue:s,schema:i};const k=P=>{Or.isError(P)?S(P):P?l(null):S(b())},E=P=>{Or.isError(P)?S(P):c(P)};if(x&&Kn(t))return k(!0);let w;try{var F;if(w=d.call(I,t,I),typeof((F=w)==null?void 0:F.then)=="function"){if(a.sync)throw new Error(`Validation test of type: "${I.type}" returned a Promise during a synchronous validate. This test will finish after the validate call has returned`);return Promise.resolve(w).then(k,E)}}catch(P){E(P);return}k(w)}return r.OPTIONS=e,r}function r8(e,r,t,n=t){let a,s,i;return r?(za.forEach(r,(c,l,u)=>{let d=l?c.slice(1,c.length-1):c;e=e.resolve({context:n,parent:a,value:t});let f=e.type==="tuple",h=u?parseInt(d,10):0;if(e.innerType||f){if(f&&!u)throw new Error(`Yup.reach cannot implicitly index into a tuple type. the path part "${i}" must contain an index to the tuple element, e.g. "${i}[0]"`);if(t&&h>=t.length)throw new Error(`Yup.reach cannot resolve an array item at index: ${c}, in the path: ${r}. because there is no value at that index. `);a=t,t=t&&t[h],e=f?e.spec.types[h]:e.innerType}if(!u){if(!e.fields||!e.fields[d])throw new Error(`The schema does not contain the path: ${r}. (failed at: ${i} which is a type: "${e.type}")`);a=t,t=t&&t[d],e=e.fields[d]}s=d,i=l?"["+c+"]":"."+c}),{schema:e,parent:a,parentPath:s}):{parent:a,parentPath:r,schema:e}}class xc extends Set{describe(){const r=[];for(const t of this.values())r.push(Ss.isRef(t)?t.describe():t);return r}resolveAll(r){let t=[];for(const n of this.values())t.push(r(n));return t}clone(){return new xc(this.values())}merge(r,t){const n=this.clone();return r.forEach(a=>n.add(a)),t.forEach(a=>n.delete(a)),n}}function Rs(e,r=new Map){if(Kd(e)||!e||typeof e!="object")return e;if(r.has(e))return r.get(e);let t;if(e instanceof Date)t=new Date(e.getTime()),r.set(e,t);else if(e instanceof RegExp)t=new RegExp(e),r.set(e,t);else if(Array.isArray(e)){t=new Array(e.length),r.set(e,t);for(let n=0;n<e.length;n++)t[n]=Rs(e[n],r)}else if(e instanceof Map){t=new Map,r.set(e,t);for(const[n,a]of e.entries())t.set(n,Rs(a,r))}else if(e instanceof Set){t=new Set,r.set(e,t);for(const n of e)t.add(Rs(n,r))}else if(e instanceof Object){t={},r.set(e,t);for(const[n,a]of Object.entries(e))t[n]=Rs(a,r)}else throw Error(`Unable to clone ${e}`);return t}class En{constructor(r){this.type=void 0,this.deps=[],this.tests=void 0,this.transforms=void 0,this.conditions=[],this._mutate=void 0,this.internalTests={},this._whitelist=new xc,this._blacklist=new xc,this.exclusiveTests=Object.create(null),this._typeCheck=void 0,this.spec=void 0,this.tests=[],this.transforms=[],this.withMutation(()=>{this.typeError(Dn.notType)}),this.type=r.type,this._typeCheck=r.check,this.spec=Object.assign({strip:!1,strict:!1,abortEarly:!0,recursive:!0,disableStackTrace:!1,nullable:!1,optional:!0,coerce:!0},r==null?void 0:r.spec),this.withMutation(t=>{t.nonNullable()})}get _type(){return this.type}clone(r){if(this._mutate)return r&&Object.assign(this.spec,r),this;const t=Object.create(Object.getPrototypeOf(this));return t.type=this.type,t._typeCheck=this._typeCheck,t._whitelist=this._whitelist.clone(),t._blacklist=this._blacklist.clone(),t.internalTests=Object.assign({},this.internalTests),t.exclusiveTests=Object.assign({},this.exclusiveTests),t.deps=[...this.deps],t.conditions=[...this.conditions],t.tests=[...this.tests],t.transforms=[...this.transforms],t.spec=Rs(Object.assign({},this.spec,r)),t}label(r){let t=this.clone();return t.spec.label=r,t}meta(...r){if(r.length===0)return this.spec.meta;let t=this.clone();return t.spec.meta=Object.assign(t.spec.meta||{},r[0]),t}withMutation(r){let t=this._mutate;this._mutate=!0;let n=r(this);return this._mutate=t,n}concat(r){if(!r||r===this)return this;if(r.type!==this.type&&this.type!=="mixed")throw new TypeError(`You cannot \`concat()\` schema's of different types: ${this.type} and ${r.type}`);let t=this,n=r.clone();const a=Object.assign({},t.spec,n.spec);return n.spec=a,n.internalTests=Object.assign({},t.internalTests,n.internalTests),n._whitelist=t._whitelist.merge(r._whitelist,r._blacklist),n._blacklist=t._blacklist.merge(r._blacklist,r._whitelist),n.tests=t.tests,n.exclusiveTests=t.exclusiveTests,n.withMutation(s=>{r.tests.forEach(i=>{s.test(i.OPTIONS)})}),n.transforms=[...t.transforms,...n.transforms],n}isType(r){return r==null?!!(this.spec.nullable&&r===null||this.spec.optional&&r===void 0):this._typeCheck(r)}resolve(r){let t=this;if(t.conditions.length){let n=t.conditions;t=t.clone(),t.conditions=[],t=n.reduce((a,s)=>s.resolve(a,r),t),t=t.resolve(r)}return t}resolveOptions(r){var t,n,a,s;return Object.assign({},r,{from:r.from||[],strict:(t=r.strict)!=null?t:this.spec.strict,abortEarly:(n=r.abortEarly)!=null?n:this.spec.abortEarly,recursive:(a=r.recursive)!=null?a:this.spec.recursive,disableStackTrace:(s=r.disableStackTrace)!=null?s:this.spec.disableStackTrace})}cast(r,t={}){let n=this.resolve(Object.assign({value:r},t)),a=t.assert==="ignore-optionality",s=n._cast(r,t);if(t.assert!==!1&&!n.isType(s)){if(a&&Kn(s))return s;let i=ma(r),c=ma(s);throw new TypeError(`The value of ${t.path||"field"} could not be cast to a value that satisfies the schema type: "${n.type}". 

attempted value: ${i} 
`+(c!==i?`result of cast: ${c}`:""))}return s}_cast(r,t){let n=r===void 0?r:this.transforms.reduce((a,s)=>s.call(this,a,r,this),r);return n===void 0&&(n=this.getDefault(t)),n}_validate(r,t={},n,a){let{path:s,originalValue:i=r,strict:c=this.spec.strict}=t,l=r;c||(l=this._cast(l,Object.assign({assert:!1},t)));let u=[];for(let d of Object.values(this.internalTests))d&&u.push(d);this.runTests({path:s,value:l,originalValue:i,options:t,tests:u},n,d=>{if(d.length)return a(d,l);this.runTests({path:s,value:l,originalValue:i,options:t,tests:this.tests},n,a)})}runTests(r,t,n){let a=!1,{tests:s,value:i,originalValue:c,path:l,options:u}=r,d=m=>{a||(a=!0,t(m,i))},f=m=>{a||(a=!0,n(m,i))},h=s.length,x=[];if(!h)return f([]);let p={value:i,originalValue:c,path:l,options:u,schema:this};for(let m=0;m<s.length;m++){const g=s[m];g(p,d,function(y){y&&(Array.isArray(y)?x.push(...y):x.push(y)),--h<=0&&f(x)})}}asNestedTest({key:r,index:t,parent:n,parentPath:a,originalParent:s,options:i}){const c=r??t;if(c==null)throw TypeError("Must include `key` or `index` for nested validations");const l=typeof c=="number";let u=n[c];const d=Object.assign({},i,{strict:!0,parent:n,value:u,originalValue:s[c],key:void 0,[l?"index":"key"]:c,path:l||c.includes(".")?`${a||""}[${l?c:`"${c}"`}]`:(a?`${a}.`:"")+r});return(f,h,x)=>this.resolve(d)._validate(u,d,h,x)}validate(r,t){var n;let a=this.resolve(Object.assign({},t,{value:r})),s=(n=t==null?void 0:t.disableStackTrace)!=null?n:a.spec.disableStackTrace;return new Promise((i,c)=>a._validate(r,t,(l,u)=>{Or.isError(l)&&(l.value=u),c(l)},(l,u)=>{l.length?c(new Or(l,u,void 0,void 0,s)):i(u)}))}validateSync(r,t){var n;let a=this.resolve(Object.assign({},t,{value:r})),s,i=(n=t==null?void 0:t.disableStackTrace)!=null?n:a.spec.disableStackTrace;return a._validate(r,Object.assign({},t,{sync:!0}),(c,l)=>{throw Or.isError(c)&&(c.value=l),c},(c,l)=>{if(c.length)throw new Or(c,r,void 0,void 0,i);s=l}),s}isValid(r,t){return this.validate(r,t).then(()=>!0,n=>{if(Or.isError(n))return!1;throw n})}isValidSync(r,t){try{return this.validateSync(r,t),!0}catch(n){if(Or.isError(n))return!1;throw n}}_getDefault(r){let t=this.spec.default;return t==null?t:typeof t=="function"?t.call(this,r):Rs(t)}getDefault(r){return this.resolve(r||{})._getDefault(r)}default(r){return arguments.length===0?this._getDefault():this.clone({default:r})}strict(r=!0){return this.clone({strict:r})}nullability(r,t){const n=this.clone({nullable:r});return n.internalTests.nullable=Fs({message:t,name:"nullable",test(a){return a===null?this.schema.spec.nullable:!0}}),n}optionality(r,t){const n=this.clone({optional:r});return n.internalTests.optionality=Fs({message:t,name:"optionality",test(a){return a===void 0?this.schema.spec.optional:!0}}),n}optional(){return this.optionality(!0)}defined(r=Dn.defined){return this.optionality(!1,r)}nullable(){return this.nullability(!0)}nonNullable(r=Dn.notNull){return this.nullability(!1,r)}required(r=Dn.required){return this.clone().withMutation(t=>t.nonNullable(r).defined(r))}notRequired(){return this.clone().withMutation(r=>r.nullable().optional())}transform(r){let t=this.clone();return t.transforms.push(r),t}test(...r){let t;if(r.length===1?typeof r[0]=="function"?t={test:r[0]}:t=r[0]:r.length===2?t={name:r[0],test:r[1]}:t={name:r[0],message:r[1],test:r[2]},t.message===void 0&&(t.message=Dn.default),typeof t.test!="function")throw new TypeError("`test` is a required parameters");let n=this.clone(),a=Fs(t),s=t.exclusive||t.name&&n.exclusiveTests[t.name]===!0;if(t.exclusive&&!t.name)throw new TypeError("Exclusive tests must provide a unique `name` identifying the test");return t.name&&(n.exclusiveTests[t.name]=!!t.exclusive),n.tests=n.tests.filter(i=>!(i.OPTIONS.name===t.name&&(s||i.OPTIONS.test===a.OPTIONS.test))),n.tests.push(a),n}when(r,t){!Array.isArray(r)&&typeof r!="string"&&(t=r,r=".");let n=this.clone(),a=V1(r).map(s=>new Ss(s));return a.forEach(s=>{s.isSibling&&n.deps.push(s.key)}),n.conditions.push(typeof t=="function"?new mc(a,t):mc.fromOptions(a,t)),n}typeError(r){let t=this.clone();return t.internalTests.typeError=Fs({message:r,name:"typeError",skipAbsent:!0,test(n){return this.schema._typeCheck(n)?!0:this.createError({params:{type:this.schema.type}})}}),t}oneOf(r,t=Dn.oneOf){let n=this.clone();return r.forEach(a=>{n._whitelist.add(a),n._blacklist.delete(a)}),n.internalTests.whiteList=Fs({message:t,name:"oneOf",skipAbsent:!0,test(a){let s=this.schema._whitelist,i=s.resolveAll(this.resolve);return i.includes(a)?!0:this.createError({params:{values:Array.from(s).join(", "),resolved:i}})}}),n}notOneOf(r,t=Dn.notOneOf){let n=this.clone();return r.forEach(a=>{n._blacklist.add(a),n._whitelist.delete(a)}),n.internalTests.blacklist=Fs({message:t,name:"notOneOf",test(a){let s=this.schema._blacklist,i=s.resolveAll(this.resolve);return i.includes(a)?this.createError({params:{values:Array.from(s).join(", "),resolved:i}}):!0}}),n}strip(r=!0){let t=this.clone();return t.spec.strip=r,t}describe(r){const t=(r?this.resolve(r):this).clone(),{label:n,meta:a,optional:s,nullable:i}=t.spec;return{meta:a,label:n,optional:s,nullable:i,default:t.getDefault(r),type:t.type,oneOf:t._whitelist.describe(),notOneOf:t._blacklist.describe(),tests:t.tests.map(l=>({name:l.OPTIONS.name,params:l.OPTIONS.params})).filter((l,u,d)=>d.findIndex(f=>f.name===l.name)===u)}}}En.prototype.__isYupSchema__=!0;for(const e of["validate","validateSync"])En.prototype[`${e}At`]=function(r,t,n={}){const{parent:a,parentPath:s,schema:i}=r8(this,r,t,n.context);return i[e](a&&a[s],Object.assign({},n,{parent:a,path:r}))};for(const e of["equals","is"])En.prototype[e]=En.prototype.oneOf;for(const e of["not","nope"])En.prototype[e]=En.prototype.notOneOf;const n8=/^(\d{4}|[+-]\d{6})(?:-?(\d{2})(?:-?(\d{2}))?)?(?:[ T]?(\d{2}):?(\d{2})(?::?(\d{2})(?:[,.](\d{1,}))?)?(?:(Z)|([+-])(\d{2})(?::?(\d{2}))?)?)?$/;function a8(e){const r=pu(e);if(!r)return Date.parse?Date.parse(e):Number.NaN;if(r.z===void 0&&r.plusMinus===void 0)return new Date(r.year,r.month,r.day,r.hour,r.minute,r.second,r.millisecond).valueOf();let t=0;return r.z!=="Z"&&r.plusMinus!==void 0&&(t=r.hourOffset*60+r.minuteOffset,r.plusMinus==="+"&&(t=0-t)),Date.UTC(r.year,r.month,r.day,r.hour,r.minute+t,r.second,r.millisecond)}function pu(e){var r,t;const n=n8.exec(e);return n?{year:Gn(n[1]),month:Gn(n[2],1)-1,day:Gn(n[3],1),hour:Gn(n[4]),minute:Gn(n[5]),second:Gn(n[6]),millisecond:n[7]?Gn(n[7].substring(0,3)):0,precision:(r=(t=n[7])==null?void 0:t.length)!=null?r:void 0,z:n[8]||void 0,plusMinus:n[9]||void 0,hourOffset:Gn(n[10]),minuteOffset:Gn(n[11])}:null}function Gn(e,r=0){return Number(e)||r}let s8=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,i8=/^((https?|ftp):)?\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,o8=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,c8="^\\d{4}-\\d{2}-\\d{2}",l8="\\d{2}:\\d{2}:\\d{2}",u8="(([+-]\\d{2}(:?\\d{2})?)|Z)",d8=new RegExp(`${c8}T${l8}(\\.\\d+)?${u8}$`),f8=e=>Kn(e)||e===e.trim(),h8={}.toString();function Ai(){return new G1}class G1 extends En{constructor(){super({type:"string",check(r){return r instanceof String&&(r=r.valueOf()),typeof r=="string"}}),this.withMutation(()=>{this.transform((r,t,n)=>{if(!n.spec.coerce||n.isType(r)||Array.isArray(r))return r;const a=r!=null&&r.toString?r.toString():r;return a===h8?r:a})})}required(r){return super.required(r).withMutation(t=>t.test({message:r||Dn.required,name:"required",skipAbsent:!0,test:n=>!!n.length}))}notRequired(){return super.notRequired().withMutation(r=>(r.tests=r.tests.filter(t=>t.OPTIONS.name!=="required"),r))}length(r,t=Fr.length){return this.test({message:t,name:"length",exclusive:!0,params:{length:r},skipAbsent:!0,test(n){return n.length===this.resolve(r)}})}min(r,t=Fr.min){return this.test({message:t,name:"min",exclusive:!0,params:{min:r},skipAbsent:!0,test(n){return n.length>=this.resolve(r)}})}max(r,t=Fr.max){return this.test({name:"max",exclusive:!0,message:t,params:{max:r},skipAbsent:!0,test(n){return n.length<=this.resolve(r)}})}matches(r,t){let n=!1,a,s;return t&&(typeof t=="object"?{excludeEmptyString:n=!1,message:a,name:s}=t:a=t),this.test({name:s||"matches",message:a||Fr.matches,params:{regex:r},skipAbsent:!0,test:i=>i===""&&n||i.search(r)!==-1})}email(r=Fr.email){return this.matches(s8,{name:"email",message:r,excludeEmptyString:!0})}url(r=Fr.url){return this.matches(i8,{name:"url",message:r,excludeEmptyString:!0})}uuid(r=Fr.uuid){return this.matches(o8,{name:"uuid",message:r,excludeEmptyString:!1})}datetime(r){let t="",n,a;return r&&(typeof r=="object"?{message:t="",allowOffset:n=!1,precision:a=void 0}=r:t=r),this.matches(d8,{name:"datetime",message:t||Fr.datetime,excludeEmptyString:!0}).test({name:"datetime_offset",message:t||Fr.datetime_offset,params:{allowOffset:n},skipAbsent:!0,test:s=>{if(!s||n)return!0;const i=pu(s);return i?!!i.z:!1}}).test({name:"datetime_precision",message:t||Fr.datetime_precision,params:{precision:a},skipAbsent:!0,test:s=>{if(!s||a==null)return!0;const i=pu(s);return i?i.precision===a:!1}})}ensure(){return this.default("").transform(r=>r===null?"":r)}trim(r=Fr.trim){return this.transform(t=>t!=null?t.trim():t).test({message:r,name:"trim",test:f8})}lowercase(r=Fr.lowercase){return this.transform(t=>Kn(t)?t:t.toLowerCase()).test({message:r,name:"string_case",exclusive:!0,skipAbsent:!0,test:t=>Kn(t)||t===t.toLowerCase()})}uppercase(r=Fr.uppercase){return this.transform(t=>Kn(t)?t:t.toUpperCase()).test({message:r,name:"string_case",exclusive:!0,skipAbsent:!0,test:t=>Kn(t)||t===t.toUpperCase()})}}Ai.prototype=G1.prototype;let p8=e=>e!=+e;function Y1(){return new q1}class q1 extends En{constructor(){super({type:"number",check(r){return r instanceof Number&&(r=r.valueOf()),typeof r=="number"&&!p8(r)}}),this.withMutation(()=>{this.transform((r,t,n)=>{if(!n.spec.coerce)return r;let a=r;if(typeof a=="string"){if(a=a.replace(/\s/g,""),a==="")return NaN;a=+a}return n.isType(a)||a===null?a:parseFloat(a)})})}min(r,t=ca.min){return this.test({message:t,name:"min",exclusive:!0,params:{min:r},skipAbsent:!0,test(n){return n>=this.resolve(r)}})}max(r,t=ca.max){return this.test({message:t,name:"max",exclusive:!0,params:{max:r},skipAbsent:!0,test(n){return n<=this.resolve(r)}})}lessThan(r,t=ca.lessThan){return this.test({message:t,name:"max",exclusive:!0,params:{less:r},skipAbsent:!0,test(n){return n<this.resolve(r)}})}moreThan(r,t=ca.moreThan){return this.test({message:t,name:"min",exclusive:!0,params:{more:r},skipAbsent:!0,test(n){return n>this.resolve(r)}})}positive(r=ca.positive){return this.moreThan(0,r)}negative(r=ca.negative){return this.lessThan(0,r)}integer(r=ca.integer){return this.test({name:"integer",message:r,skipAbsent:!0,test:t=>Number.isInteger(t)})}truncate(){return this.transform(r=>Kn(r)?r:r|0)}round(r){var t;let n=["ceil","floor","round","trunc"];if(r=((t=r)==null?void 0:t.toLowerCase())||"round",r==="trunc")return this.truncate();if(n.indexOf(r.toLowerCase())===-1)throw new TypeError("Only valid options for round() are: "+n.join(", "));return this.transform(a=>Kn(a)?a:Math[r](a))}}Y1.prototype=q1.prototype;let X1=new Date(""),m8=e=>Object.prototype.toString.call(e)==="[object Date]";function Jd(){return new bo}class bo extends En{constructor(){super({type:"date",check(r){return m8(r)&&!isNaN(r.getTime())}}),this.withMutation(()=>{this.transform((r,t,n)=>!n.spec.coerce||n.isType(r)||r===null?r:(r=a8(r),isNaN(r)?bo.INVALID_DATE:new Date(r)))})}prepareParam(r,t){let n;if(Ss.isRef(r))n=r;else{let a=this.cast(r);if(!this._typeCheck(a))throw new TypeError(`\`${t}\` must be a Date or a value that can be \`cast()\` to a Date`);n=a}return n}min(r,t=hu.min){let n=this.prepareParam(r,"min");return this.test({message:t,name:"min",exclusive:!0,params:{min:r},skipAbsent:!0,test(a){return a>=this.resolve(n)}})}max(r,t=hu.max){let n=this.prepareParam(r,"max");return this.test({message:t,name:"max",exclusive:!0,params:{max:r},skipAbsent:!0,test(a){return a<=this.resolve(n)}})}}bo.INVALID_DATE=X1;Jd.prototype=bo.prototype;Jd.INVALID_DATE=X1;function x8(e,r=[]){let t=[],n=new Set,a=new Set(r.map(([i,c])=>`${i}-${c}`));function s(i,c){let l=za.split(i)[0];n.add(l),a.has(`${c}-${l}`)||t.push([c,l])}for(const i of Object.keys(e)){let c=e[i];n.add(i),Ss.isRef(c)&&c.isSibling?s(c.path,i):Kd(c)&&"deps"in c&&c.deps.forEach(l=>s(l,i))}return z5.array(Array.from(n),t).reverse()}function lp(e,r){let t=1/0;return e.some((n,a)=>{var s;if((s=r.path)!=null&&s.includes(n))return t=a,!0}),t}function K1(e){return(r,t)=>lp(e,r)-lp(e,t)}const g8=(e,r,t)=>{if(typeof e!="string")return e;let n=e;try{n=JSON.parse(e)}catch{}return t.isType(n)?n:e};function Go(e){if("fields"in e){const r={};for(const[t,n]of Object.entries(e.fields))r[t]=Go(n);return e.setFields(r)}if(e.type==="array"){const r=e.optional();return r.innerType&&(r.innerType=Go(r.innerType)),r}return e.type==="tuple"?e.optional().clone({types:e.spec.types.map(Go)}):"optional"in e?e.optional():e}const v8=(e,r)=>{const t=[...za.normalizePath(r)];if(t.length===1)return t[0]in e;let n=t.pop(),a=za.getter(za.join(t),!0)(e);return!!(a&&n in a)};let up=e=>Object.prototype.toString.call(e)==="[object Object]";function dp(e,r){let t=Object.keys(e.fields);return Object.keys(r).filter(n=>t.indexOf(n)===-1)}const y8=K1([]);function J1(e){return new Q1(e)}class Q1 extends En{constructor(r){super({type:"object",check(t){return up(t)||typeof t=="function"}}),this.fields=Object.create(null),this._sortErrors=y8,this._nodes=[],this._excludedEdges=[],this.withMutation(()=>{r&&this.shape(r)})}_cast(r,t={}){var n;let a=super._cast(r,t);if(a===void 0)return this.getDefault(t);if(!this._typeCheck(a))return a;let s=this.fields,i=(n=t.stripUnknown)!=null?n:this.spec.noUnknown,c=[].concat(this._nodes,Object.keys(a).filter(f=>!this._nodes.includes(f))),l={},u=Object.assign({},t,{parent:l,__validating:t.__validating||!1}),d=!1;for(const f of c){let h=s[f],x=f in a;if(h){let p,m=a[f];u.path=(t.path?`${t.path}.`:"")+f,h=h.resolve({value:m,context:t.context,parent:l});let g=h instanceof En?h.spec:void 0,v=g==null?void 0:g.strict;if(g!=null&&g.strip){d=d||f in a;continue}p=!t.__validating||!v?h.cast(a[f],u):a[f],p!==void 0&&(l[f]=p)}else x&&!i&&(l[f]=a[f]);(x!==f in l||l[f]!==a[f])&&(d=!0)}return d?l:a}_validate(r,t={},n,a){let{from:s=[],originalValue:i=r,recursive:c=this.spec.recursive}=t;t.from=[{schema:this,value:i},...s],t.__validating=!0,t.originalValue=i,super._validate(r,t,n,(l,u)=>{if(!c||!up(u)){a(l,u);return}i=i||u;let d=[];for(let f of this._nodes){let h=this.fields[f];!h||Ss.isRef(h)||d.push(h.asNestedTest({options:t,key:f,parent:u,parentPath:t.path,originalParent:i}))}this.runTests({tests:d,value:u,originalValue:i,options:t},n,f=>{a(f.sort(this._sortErrors).concat(l),u)})})}clone(r){const t=super.clone(r);return t.fields=Object.assign({},this.fields),t._nodes=this._nodes,t._excludedEdges=this._excludedEdges,t._sortErrors=this._sortErrors,t}concat(r){let t=super.concat(r),n=t.fields;for(let[a,s]of Object.entries(this.fields)){const i=n[a];n[a]=i===void 0?s:i}return t.withMutation(a=>a.setFields(n,[...this._excludedEdges,...r._excludedEdges]))}_getDefault(r){if("default"in this.spec)return super._getDefault(r);if(!this._nodes.length)return;let t={};return this._nodes.forEach(n=>{var a;const s=this.fields[n];let i=r;(a=i)!=null&&a.value&&(i=Object.assign({},i,{parent:i.value,value:i.value[n]})),t[n]=s&&"getDefault"in s?s.getDefault(i):void 0}),t}setFields(r,t){let n=this.clone();return n.fields=r,n._nodes=x8(r,t),n._sortErrors=K1(Object.keys(r)),t&&(n._excludedEdges=t),n}shape(r,t=[]){return this.clone().withMutation(n=>{let a=n._excludedEdges;return t.length&&(Array.isArray(t[0])||(t=[t]),a=[...n._excludedEdges,...t]),n.setFields(Object.assign(n.fields,r),a)})}partial(){const r={};for(const[t,n]of Object.entries(this.fields))r[t]="optional"in n&&n.optional instanceof Function?n.optional():n;return this.setFields(r)}deepPartial(){return Go(this)}pick(r){const t={};for(const n of r)this.fields[n]&&(t[n]=this.fields[n]);return this.setFields(t,this._excludedEdges.filter(([n,a])=>r.includes(n)&&r.includes(a)))}omit(r){const t=[];for(const n of Object.keys(this.fields))r.includes(n)||t.push(n);return this.pick(t)}from(r,t,n){let a=za.getter(r,!0);return this.transform(s=>{if(!s)return s;let i=s;return v8(s,r)&&(i=Object.assign({},s),n||delete i[r],i[t]=a(s)),i})}json(){return this.transform(g8)}exact(r){return this.test({name:"exact",exclusive:!0,message:r||zo.exact,test(t){if(t==null)return!0;const n=dp(this.schema,t);return n.length===0||this.createError({params:{properties:n.join(", ")}})}})}stripUnknown(){return this.clone({noUnknown:!0})}noUnknown(r=!0,t=zo.noUnknown){typeof r!="boolean"&&(t=r,r=!0);let n=this.test({name:"noUnknown",exclusive:!0,message:t,test(a){if(a==null)return!0;const s=dp(this.schema,a);return!r||s.length===0||this.createError({params:{unknown:s.join(", ")}})}});return n.spec.noUnknown=r,n}unknown(r=!0,t=zo.noUnknown){return this.noUnknown(!r,t)}transformKeys(r){return this.transform(t=>{if(!t)return t;const n={};for(const a of Object.keys(t))n[r(a)]=t[a];return n})}camelCase(){return this.transformKeys(Fl.camelCase)}snakeCase(){return this.transformKeys(Fl.snakeCase)}constantCase(){return this.transformKeys(r=>Fl.snakeCase(r).toUpperCase())}describe(r){const t=(r?this.resolve(r):this).clone(),n=super.describe(r);n.fields={};for(const[s,i]of Object.entries(t.fields)){var a;let c=r;(a=c)!=null&&a.value&&(c=Object.assign({},c,{parent:c.value,value:c.value[s]})),n.fields[s]=i.describe(c)}return n}}J1.prototype=Q1.prototype;function b8(e,r){const t=()=>vt(r==null?void 0:r.in,NaN),n=(r==null?void 0:r.additionalDigits)??2,a=T8(e);let s;if(a.date){const u=k8(a.date,n);s=A8(u.restDateString,u.year)}if(!s||isNaN(+s))return t();const i=+s;let c=0,l;if(a.time&&(c=C8(a.time),isNaN(c)))return t();if(a.timezone){if(l=_8(a.timezone),isNaN(l))return t()}else{const u=new Date(i+c),d=qe(0,r==null?void 0:r.in);return d.setFullYear(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()),d.setHours(u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()),d}return qe(i+c+l,r==null?void 0:r.in)}const Mo={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},w8=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,S8=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,E8=/^([+-])(\d{2})(?::?(\d{2}))?$/;function T8(e){const r={},t=e.split(Mo.dateTimeDelimiter);let n;if(t.length>2)return r;if(/:/.test(t[0])?n=t[0]:(r.date=t[0],n=t[1],Mo.timeZoneDelimiter.test(r.date)&&(r.date=e.split(Mo.timeZoneDelimiter)[0],n=e.substr(r.date.length,e.length))),n){const a=Mo.timezone.exec(n);a?(r.time=n.replace(a[1],""),r.timezone=a[1]):r.time=n}return r}function k8(e,r){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+r)+"})|(\\d{2}|[+-]\\d{"+(2+r)+"})$)"),n=e.match(t);if(!n)return{year:NaN,restDateString:""};const a=n[1]?parseInt(n[1]):null,s=n[2]?parseInt(n[2]):null;return{year:s===null?a:s*100,restDateString:e.slice((n[1]||n[2]).length)}}function A8(e,r){if(r===null)return new Date(NaN);const t=e.match(w8);if(!t)return new Date(NaN);const n=!!t[4],a=wi(t[1]),s=wi(t[2])-1,i=wi(t[3]),c=wi(t[4]),l=wi(t[5])-1;if(n)return O8(r,c,l)?D8(r,c,l):new Date(NaN);{const u=new Date(0);return!I8(r,s,i)||!P8(r,a)?new Date(NaN):(u.setUTCFullYear(r,s,Math.max(a,i)),u)}}function wi(e){return e?parseInt(e):1}function C8(e){const r=e.match(S8);if(!r)return NaN;const t=Il(r[1]),n=Il(r[2]),a=Il(r[3]);return j8(t,n,a)?t*Wc+n*Vc+a*1e3:NaN}function Il(e){return e&&parseFloat(e.replace(",","."))||0}function _8(e){if(e==="Z")return 0;const r=e.match(E8);if(!r)return 0;const t=r[1]==="+"?-1:1,n=parseInt(r[2]),a=r[3]&&parseInt(r[3])||0;return R8(n,a)?t*(n*Wc+a*Vc):NaN}function D8(e,r,t){const n=new Date(0);n.setUTCFullYear(e,0,4);const a=n.getUTCDay()||7,s=(r-1)*7+t+1-a;return n.setUTCDate(n.getUTCDate()+s),n}const F8=[31,null,31,30,31,30,31,31,30,31,30,31];function Z1(e){return e%400===0||e%4===0&&e%100!==0}function I8(e,r,t){return r>=0&&r<=11&&t>=1&&t<=(F8[r]||(Z1(e)?29:28))}function P8(e,r){return r>=1&&r<=(Z1(e)?366:365)}function O8(e,r,t){return r>=1&&r<=53&&t>=0&&t<=6}function j8(e,r,t){return e===24?r===0&&t===0:t>=0&&t<60&&r>=0&&r<60&&e>=0&&e<25}function R8(e,r){return r>=0&&r<=59}var Vr=(e=>(e.CASH="CASH",e.CHEQUE="CHEQUE",e.CHECK="CHECK",e.BANK_TRANSFER="BANK_TRANSFER",e.UPI="UPI",e.CREDIT_CARD="CREDIT_CARD",e.ONLINE="ONLINE",e))(Vr||{}),pn=(e=>(e.MONTHLY="MONTHLY",e.QUARTERLY="QUARTERLY",e.HALF_YEARLY="HALF_YEARLY",e.YEARLY="YEARLY",e))(pn||{});const N8=({open:e,studentId:r,onClose:t,onSubmit:n,loading:a,initialData:s})=>{const[i,c]=C.useState((s==null?void 0:s.frequency)||pn.MONTHLY),{data:l,loading:u,error:d,refetch:f}=Nn(()=>r?xn.getStudentFeeDetails(r):Promise.reject("No student selected"),{dependencies:[r],skip:!r}),{data:h,loading:x}=Nn(()=>r?xn.getStudentPaymentHistory(r):Promise.reject("No student selected"),{dependencies:[r],skip:!r}),p=(S,I)=>{if(!S)return 0;const k=S.totalFees||S.annualFees||0;switch(I){case pn.MONTHLY:return k/12;case pn.QUARTERLY:return k/4;case pn.HALF_YEARLY:return k/2;case pn.YEARLY:return k;default:return k/12}},g=(()=>{if(!(l!=null&&l.feeStructure)||!h)return{paid:0,remaining:0,totalAnnualFee:0};const S=l.feeStructure.totalFees||l.feeStructure.annualFees||0,I=Array.isArray(h)?h.reduce((E,T)=>E+(T.amount||0),0):0,k=S-I;return{paid:I,remaining:k,totalAnnualFee:S}})(),v=J1({amount:Y1().positive("Amount must be positive").required("Amount is required").test("not-exceeding-pending","Amount exceeds remaining fees",function(S){return s!=null&&s.id?!0:S<=g.remaining}),paymentMethod:Ai().required("Payment method is required"),paymentDate:Jd().required("Payment date is required").max(new Date,"Payment date cannot be in the future"),frequency:Ai().required("Payment frequency is required"),reference:Ai().when("paymentMethod",{is:S=>S!==Vr.CASH,then:S=>S.required("Reference number is required for non-cash payments")}),notes:Ai().max(200,"Notes must be less than 200 characters")}),y=y5({initialValues:{amount:(s==null?void 0:s.amount)??p(l==null?void 0:l.feeStructure,i),paymentMethod:(s==null?void 0:s.paymentMethod)??Vr.CASH,paymentDate:(s==null?void 0:s.paymentDate)??Qs(new Date,"yyyy-MM-dd"),frequency:(s==null?void 0:s.frequency)??pn.MONTHLY,reference:(s==null?void 0:s.reference)??"",notes:(s==null?void 0:s.notes)??""},validationSchema:v,enableReinitialize:!0,onSubmit:S=>{if(r){const I={studentId:r,id:s==null?void 0:s.id,paymentDate:typeof S.paymentDate=="string"?S.paymentDate:Qs(S.paymentDate,"yyyy-MM-dd"),amount:S.amount,amountPaid:S.amount,paymentMethod:S.paymentMethod,frequency:S.frequency,reference:S.reference,notes:S.notes,paymentStatus:"PAID",academicYear:new Date().getFullYear().toString(),academicTerm:"CURRENT"};l!=null&&l.studentFeeId&&(I.studentFeeId=l.studentFeeId),n(I)}}});C.useEffect(()=>{if(!(s!=null&&s.id)){const S=p(l==null?void 0:l.feeStructure,y.values.frequency);y.setFieldValue("amount",S)}},[y.values.frequency,l==null?void 0:l.feeStructure]);const b=S=>{const I=S.target.value;c(I),y.setFieldValue("frequency",I)};return o.jsxs(kr,{open:e,onClose:t,maxWidth:"md",fullWidth:!0,children:[o.jsxs(Xr,{sx:{display:"flex",alignItems:"center",mb:1},children:[o.jsx(yc,{sx:{mr:1}}),s!=null&&s.id?"Edit Payment":"Record New Payment"]}),o.jsxs("form",{onSubmit:y.handleSubmit,children:[o.jsxs(Rr,{children:[d&&o.jsx(Ln,{message:"Error loading student fees information"}),!u&&l&&o.jsxs(Se,{sx:{mb:3,p:2,bgcolor:"#f8f9fa",borderRadius:1},children:[o.jsx(te,{variant:"subtitle1",gutterBottom:!0,children:"Fee Status"}),o.jsxs(X,{container:!0,spacing:2,children:[o.jsxs(X,{item:!0,xs:4,children:[o.jsx(te,{variant:"body2",color:"textSecondary",children:"Total Annual Fee"}),o.jsxs(te,{variant:"h6",children:["â‚¹",g.totalAnnualFee.toLocaleString()]})]}),o.jsxs(X,{item:!0,xs:4,children:[o.jsx(te,{variant:"body2",color:"textSecondary",children:"Paid"}),o.jsxs(te,{variant:"h6",color:"success.main",children:["â‚¹",g.paid.toLocaleString()]})]}),o.jsxs(X,{item:!0,xs:4,children:[o.jsx(te,{variant:"body2",color:"textSecondary",children:"Remaining"}),o.jsxs(te,{variant:"h6",color:"error.main",children:["â‚¹",g.remaining.toLocaleString()]})]})]})]}),o.jsxs(X,{container:!0,spacing:3,children:[o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsxs(Tt,{fullWidth:!0,error:y.touched.frequency&&!!y.errors.frequency,children:[o.jsx(Wt,{id:"frequency-label",children:"Payment Frequency"}),o.jsxs(It,{labelId:"frequency-label",id:"frequency",name:"frequency",value:y.values.frequency,onChange:b,label:"Payment Frequency",children:[o.jsx(Xe,{value:pn.MONTHLY,children:"Monthly"}),o.jsx(Xe,{value:pn.QUARTERLY,children:"Quarterly"}),o.jsx(Xe,{value:pn.HALF_YEARLY,children:"Half Yearly"}),o.jsx(Xe,{value:pn.YEARLY,children:"Yearly"})]}),y.touched.frequency&&y.errors.frequency&&o.jsx(rs,{children:y.errors.frequency})]})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,id:"amount",name:"amount",label:"Amount",type:"number",value:y.values.amount,onChange:y.handleChange,onBlur:y.handleBlur,error:y.touched.amount&&!!y.errors.amount,helperText:y.touched.amount&&y.errors.amount,InputProps:{startAdornment:o.jsx(Fn,{position:"start",children:"â‚¹"})}})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsxs(Tt,{fullWidth:!0,error:y.touched.paymentMethod&&!!y.errors.paymentMethod,children:[o.jsx(Wt,{id:"payment-method-label",children:"Payment Method"}),o.jsxs(It,{labelId:"payment-method-label",id:"paymentMethod",name:"paymentMethod",value:y.values.paymentMethod,onChange:y.handleChange,label:"Payment Method",children:[o.jsx(Xe,{value:Vr.CASH,children:"Cash"}),o.jsx(Xe,{value:Vr.CHEQUE,children:"Cheque"}),o.jsx(Xe,{value:Vr.BANK_TRANSFER,children:"Bank Transfer"}),o.jsx(Xe,{value:Vr.UPI,children:"UPI"}),o.jsx(Xe,{value:Vr.CREDIT_CARD,children:"Credit Card"})]}),y.touched.paymentMethod&&y.errors.paymentMethod&&o.jsx(rs,{children:y.errors.paymentMethod})]})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(Qx,{dateAdapter:BN,children:o.jsx(f4,{label:"Payment Date",value:y.values.paymentDate?typeof y.values.paymentDate=="string"?b8(y.values.paymentDate):y.values.paymentDate:null,onChange:S=>{y.setFieldValue("paymentDate",S)},slotProps:{textField:{fullWidth:!0,error:y.touched.paymentDate&&!!y.errors.paymentDate,helperText:y.touched.paymentDate&&y.errors.paymentDate}}})})}),y.values.paymentMethod!==Vr.CASH&&o.jsx(X,{item:!0,xs:12,children:o.jsx(ke,{fullWidth:!0,id:"reference",name:"reference",label:y.values.paymentMethod===Vr.CHEQUE?"Cheque Number":y.values.paymentMethod===Vr.BANK_TRANSFER?"Transaction Reference":y.values.paymentMethod===Vr.UPI?"UPI Reference ID":y.values.paymentMethod===Vr.CREDIT_CARD?"Transaction ID":"Reference Number",value:y.values.reference,onChange:y.handleChange,onBlur:y.handleBlur,error:y.touched.reference&&!!y.errors.reference,helperText:y.touched.reference&&y.errors.reference})}),o.jsx(X,{item:!0,xs:12,children:o.jsx(ke,{fullWidth:!0,id:"notes",name:"notes",label:"Notes",multiline:!0,rows:2,value:y.values.notes,onChange:y.handleChange,onBlur:y.handleBlur,error:y.touched.notes&&!!y.errors.notes,helperText:y.touched.notes&&y.errors.notes||`${y.values.notes.length}/200 characters`})})]})]}),o.jsxs(Nr,{children:[o.jsx(Me,{onClick:t,children:"Cancel"}),o.jsx(Me,{type:"submit",variant:"contained",color:"primary",disabled:a||!y.isValid,startIcon:a?o.jsx(ta,{size:20}):o.jsx(Wv,{}),children:s!=null&&s.id?"Update Payment":"Complete Payment"})]})]})]})},M8=({payments:e,onViewReceipt:r,onDownloadReceipt:t,onVoidPayment:n,isAdmin:a=!1})=>{var y;const[s,i]=C.useState(0),[c,l]=C.useState(5),[u,d]=C.useState(null),[f,h]=C.useState(!1),x=(b,S)=>{i(S)},p=b=>{l(parseInt(b.target.value,10)),i(0)},m=b=>{d(b),h(!0)},g=()=>{h(!1)},v=b=>{let S="default";switch(b){case"COMPLETED":S="success";break;case"PENDING":S="warning";break;case"FAILED":S="error";break;case"VOID":S="default";break}return o.jsx(Yt,{size:"small",label:b,color:S})};return o.jsxs(o.Fragment,{children:[o.jsxs(zs,{component:st,elevation:1,children:[o.jsxs(Za,{size:"small",children:[o.jsx(es,{children:o.jsxs(ir,{children:[o.jsx(ze,{children:"Receipt #"}),o.jsx(ze,{children:"Date"}),o.jsx(ze,{children:"Amount"}),o.jsx(ze,{children:"Method"}),o.jsx(ze,{children:"Status"}),o.jsx(ze,{align:"right",children:"Actions"})]})}),o.jsx(ts,{children:e.length===0?o.jsx(ir,{children:o.jsx(ze,{colSpan:6,align:"center",children:o.jsx(te,{variant:"body2",color:"textSecondary",children:"No payment records found"})})}):e.slice(s*c,s*c+c).map(b=>o.jsxs(ir,{children:[o.jsx(ze,{children:b.receiptNumber||"-"}),o.jsx(ze,{children:b.paymentDate?Qs(new Date(b.paymentDate),"dd MMM yyyy"):"-"}),o.jsxs(ze,{children:["â‚¹",b.amountPaid.toLocaleString()]}),o.jsx(ze,{children:b.paymentMethod}),o.jsx(ze,{children:v(b.paymentStatus)}),o.jsxs(ze,{align:"right",children:[o.jsx(at,{title:"View Details",children:o.jsx(Ze,{size:"small",onClick:()=>m(b),children:o.jsx(Hv,{fontSize:"small"})})}),o.jsx(at,{title:"View Receipt",children:o.jsx(Ze,{size:"small",onClick:()=>r(b.id),disabled:b.paymentStatus==="VOID",children:o.jsx(yc,{fontSize:"small"})})}),o.jsx(at,{title:"Download Receipt",children:o.jsx(Ze,{size:"small",onClick:()=>t(b.id),disabled:b.paymentStatus==="VOID",children:o.jsx(yf,{fontSize:"small"})})}),a&&n&&b.paymentStatus!=="VOID"&&o.jsx(at,{title:"Void Payment",children:o.jsx(Ze,{size:"small",onClick:()=>n(b.id),color:"error",children:o.jsx(zv,{fontSize:"small"})})})]})]},b.id))})]}),e.length>0&&o.jsx(wp,{rowsPerPageOptions:[5,10,25],component:"div",count:e.length,rowsPerPage:c,page:s,onPageChange:x,onRowsPerPageChange:p})]}),o.jsx(kr,{open:f,onClose:g,maxWidth:"sm",fullWidth:!0,children:u&&o.jsxs(o.Fragment,{children:[o.jsxs(Se,{sx:{p:3},children:[o.jsx(te,{variant:"h6",gutterBottom:!0,children:"Payment Details"}),o.jsxs(Se,{sx:{mt:2},children:[o.jsx(te,{variant:"subtitle2",color:"textSecondary",children:"Receipt Number"}),o.jsx(te,{variant:"body1",gutterBottom:!0,children:u.receiptNumber||"N/A"}),o.jsx(te,{variant:"subtitle2",color:"textSecondary",children:"Academic Year/Term"}),o.jsxs(te,{variant:"body1",gutterBottom:!0,children:[u.academicYear," (",u.academicTerm,")"]}),o.jsx(te,{variant:"subtitle2",color:"textSecondary",children:"Payment Date"}),o.jsx(te,{variant:"body1",gutterBottom:!0,children:Qs(new Date(u.paymentDate),"dd MMMM yyyy")}),o.jsx(te,{variant:"subtitle2",color:"textSecondary",children:"Payment Method"}),o.jsxs(te,{variant:"body1",gutterBottom:!0,children:[u.paymentMethod,u.transactionReference&&` (Ref: ${u.transactionReference})`]}),o.jsx(te,{variant:"subtitle2",color:"textSecondary",children:"Amount Paid"}),o.jsxs(te,{variant:"h6",color:"primary",gutterBottom:!0,children:["â‚¹",u.amountPaid.toLocaleString()]}),u.notes&&o.jsxs(o.Fragment,{children:[o.jsx(te,{variant:"subtitle2",color:"textSecondary",children:"Notes"}),o.jsx(te,{variant:"body2",gutterBottom:!0,children:u.notes})]}),o.jsx(te,{variant:"subtitle2",color:"textSecondary",sx:{mt:2},children:"Fee Breakdown"}),o.jsxs(Za,{size:"small",sx:{mt:1},children:[o.jsx(es,{children:o.jsxs(ir,{children:[o.jsx(ze,{children:"Fee Type"}),o.jsx(ze,{children:"Description"}),o.jsx(ze,{align:"right",children:"Amount"})]})}),"                  ",o.jsx(ts,{children:(y=u.feeBreakdown)==null?void 0:y.map((b,S)=>o.jsxs(ir,{children:[o.jsx(ze,{children:b.feeType}),o.jsx(ze,{children:b.description||"-"}),o.jsxs(ze,{align:"right",children:["â‚¹",b.amount.toLocaleString()]})]},S))})]})]})]}),o.jsxs(Se,{sx:{display:"flex",justifyContent:"flex-end",p:2},children:[o.jsx(Me,{onClick:g,children:"Close"}),o.jsx(Me,{startIcon:o.jsx(yf,{}),onClick:()=>t(u.id),disabled:u.paymentStatus==="VOID",sx:{ml:1},children:"Download Receipt"})]})]})})]})},L8=({feeDetails:e})=>{var t,n,a,s;if(!e||!e.feeStructure)return o.jsx(te,{children:"No fee details available"});const{feeStructure:r}=e;return o.jsx(Se,{children:o.jsxs(X,{container:!0,spacing:2,children:[o.jsx(X,{item:!0,xs:12,md:6,children:o.jsxs(st,{elevation:0,sx:{p:2,bgcolor:"background.paper"},children:[o.jsx(te,{variant:"subtitle1",fontWeight:"bold",gutterBottom:!0,children:"Fee Structure Details"}),o.jsx(vr,{sx:{my:1}}),o.jsxs(X,{container:!0,spacing:1,children:[o.jsx(X,{item:!0,xs:6,children:o.jsx(te,{variant:"body2",color:"text.secondary",children:"Class Grade:"})}),o.jsx(X,{item:!0,xs:6,children:o.jsx(te,{variant:"body2",children:r.classGrade})}),o.jsx(X,{item:!0,xs:6,children:o.jsx(te,{variant:"body2",color:"text.secondary",children:"Annual Fees:"})}),o.jsx(X,{item:!0,xs:6,children:o.jsxs(te,{variant:"body2",children:["$",(t=r.annualFees)==null?void 0:t.toFixed(2)]})}),o.jsx(X,{item:!0,xs:6,children:o.jsx(te,{variant:"body2",color:"text.secondary",children:"Building Fees:"})}),o.jsx(X,{item:!0,xs:6,children:o.jsxs(te,{variant:"body2",children:["$",(n=r.buildingFees)==null?void 0:n.toFixed(2)]})}),o.jsx(X,{item:!0,xs:6,children:o.jsx(te,{variant:"body2",color:"text.secondary",children:"Lab Fees:"})}),o.jsx(X,{item:!0,xs:6,children:o.jsxs(te,{variant:"body2",children:["$",(a=r.labFees)==null?void 0:a.toFixed(2)]})}),o.jsx(X,{item:!0,xs:6,children:o.jsx(te,{variant:"body2",color:"text.secondary",fontWeight:"bold",children:"Total Fees:"})}),o.jsx(X,{item:!0,xs:6,children:o.jsxs(te,{variant:"body2",fontWeight:"bold",children:["$",(s=r.totalFees)==null?void 0:s.toFixed(2)]})})]})]})}),o.jsx(X,{item:!0,xs:12,md:6,children:o.jsxs(st,{elevation:0,sx:{p:2,bgcolor:"background.paper"},children:[o.jsx(te,{variant:"subtitle1",fontWeight:"bold",gutterBottom:!0,children:"Student Fee Assignment"}),o.jsx(vr,{sx:{my:1}}),o.jsxs(X,{container:!0,spacing:1,children:[o.jsx(X,{item:!0,xs:6,children:o.jsx(te,{variant:"body2",color:"text.secondary",children:"Student ID:"})}),o.jsx(X,{item:!0,xs:6,children:o.jsx(te,{variant:"body2",children:e.studentId})}),o.jsx(X,{item:!0,xs:6,children:o.jsx(te,{variant:"body2",color:"text.secondary",children:"Student Fee ID:"})}),o.jsx(X,{item:!0,xs:6,children:o.jsx(te,{variant:"body2",children:e.studentFeeId||"N/A"})})]})]})})]})})};var ev={exports:{}};(function(e,r){(function(t,n){e.exports=n(C)})(typeof self<"u"?self:Ip,function(t){return function(){var n={155:function(v){v.exports=t}},a={};function s(v){var y=a[v];if(y!==void 0)return y.exports;var b=a[v]={exports:{}};return n[v](b,b.exports,s),b.exports}s.d=function(v,y){for(var b in y)s.o(y,b)&&!s.o(v,b)&&Object.defineProperty(v,b,{enumerable:!0,get:y[b]})},s.o=function(v,y){return Object.prototype.hasOwnProperty.call(v,y)},s.r=function(v){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(v,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(v,"__esModule",{value:!0})};var i={};s.r(i),s.d(i,{useReactToPrint:function(){return g}});var c=s(155);function l({level:v="error",messages:y,suppressErrors:b=!1}){b||(v==="error"?console.error(y):v==="warning"?console.warn(y):console.debug(y))}function u(v,y){if(y||!v){const b=document.getElementById("printWindow");b&&document.body.removeChild(b)}}function d(v){return v instanceof Error?v:new Error("Unknown Error")}function f(v,y){const{documentTitle:b,onAfterPrint:S,onPrintError:I,preserveAfterPrint:k,print:E,suppressErrors:T}=y;setTimeout(()=>{var w,F;if(v.contentWindow){let P=function(){S==null||S(),u(k)};if(v.contentWindow.focus(),E)E(v).then(P).catch(A=>{I?I("print",d(A)):l({messages:["An error was thrown by the specified `print` function"],suppressErrors:T})});else{if(v.contentWindow.print){const A=(F=(w=v.contentDocument)===null||w===void 0?void 0:w.title)!==null&&F!==void 0?F:"",L=v.ownerDocument.title;b&&(v.ownerDocument.title=b,v.contentDocument&&(v.contentDocument.title=b)),v.contentWindow.print(),b&&(v.ownerDocument.title=L,v.contentDocument&&(v.contentDocument.title=A))}else l({messages:["Printing for this browser is not currently possible: the browser does not have a `print` method available for iframes."],suppressErrors:T});[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i].some(A=>{var L,Y;return((Y=(L=navigator.userAgent)!==null&&L!==void 0?L:navigator.vendor)!==null&&Y!==void 0?Y:"opera"in window&&window.opera).match(A)})?setTimeout(P,500):P()}}else l({messages:["Printing failed because the `contentWindow` of the print iframe did not load. This is possibly an error with `react-to-print`. Please file an issue: https://github.com/MatthewHerbst/react-to-print/issues/"],suppressErrors:T})},500)}function h(v){const y=[],b=document.createTreeWalker(v,NodeFilter.SHOW_ELEMENT,null);let S=b.nextNode();for(;S;)y.push(S),S=b.nextNode();return y}function x(v,y,b){const S=h(v),I=h(y);if(S.length===I.length)for(let k=0;k<S.length;k++){const E=S[k],T=I[k],w=E.shadowRoot;if(w!==null){const F=T.attachShadow({mode:w.mode});F.innerHTML=w.innerHTML,x(w,F,b)}}else l({messages:["When cloning shadow root content, source and target elements have different size. `onBeforePrint` likely resolved too early.",v,y],suppressErrors:b})}const p=`
    @page {
        /* Remove browser default header (title) and footer (url) */
        margin: 0;
    }
    @media print {
        body {
            /* Tell browsers to print background colors */
            color-adjust: exact; /* Firefox. This is an older version of "print-color-adjust" */
            print-color-adjust: exact; /* Firefox/Safari */
            -webkit-print-color-adjust: exact; /* Chrome/Safari/Edge/Opera */
        }
    }
`;function m(v,y,b,S){var I,k,E,T,w;const{contentNode:F,clonedContentNode:P,clonedImgNodes:A,clonedVideoNodes:L,numResourcesToLoad:Y,originalCanvasNodes:q}=b,{bodyClass:Q,fonts:K,ignoreGlobalStyles:ye,pageStyle:U,nonce:me,suppressErrors:J,copyShadowRoots:D}=S;v.onload=null;const B=(I=v.contentDocument)!==null&&I!==void 0?I:(k=v.contentWindow)===null||k===void 0?void 0:k.document;if(B){const V=B.body.appendChild(P);D&&x(F,V,!!J),K&&(!((E=v.contentDocument)===null||E===void 0)&&E.fonts&&(!((T=v.contentWindow)===null||T===void 0)&&T.FontFace)?K.forEach(j=>{const _=new FontFace(j.family,j.source,{weight:j.weight,style:j.style});v.contentDocument.fonts.add(_),_.loaded.then(()=>{y(_)}).catch(ae=>{y(_,["Failed loading the font:",_,"Load error:",d(ae)])})}):(K.forEach(j=>{y(j)}),l({messages:['"react-to-print" is not able to load custom fonts because the browser does not support the FontFace API but will continue attempting to print the page'],suppressErrors:J})));const W=U??p,Z=B.createElement("style");me&&(Z.setAttribute("nonce",me),B.head.setAttribute("nonce",me)),Z.appendChild(B.createTextNode(W)),B.head.appendChild(Z),Q&&B.body.classList.add(...Q.split(" "));const fe=B.querySelectorAll("canvas");for(let j=0;j<q.length;++j){const _=q[j],ae=fe[j];if(ae===void 0){l({messages:["A canvas element could not be copied for printing, has it loaded? `onBeforePrint` likely resolved too early.",_],suppressErrors:J});continue}const oe=ae.getContext("2d");oe&&oe.drawImage(_,0,0)}for(let j=0;j<A.length;j++){const _=A[j],ae=_.getAttribute("src");if(ae){const oe=new Image;oe.onload=()=>{y(_)},oe.onerror=(Te,ce,be,pe,Ce)=>{y(_,["Error loading <img>",_,"Error",Ce])},oe.src=ae}else y(_,['Found an <img> tag with an empty "src" attribute. This prevents pre-loading it.',_])}for(let j=0;j<L.length;j++){const _=L[j];_.preload="auto";const ae=_.getAttribute("poster");if(ae){const oe=new Image;oe.onload=()=>{y(_)},oe.onerror=(Te,ce,be,pe,Ce)=>{y(_,["Error loading video poster",ae,"for video",_,"Error:",Ce])},oe.src=ae}else _.readyState>=2?y(_):_.src?(_.onloadeddata=()=>{y(_)},_.onerror=(oe,Te,ce,be,pe)=>{y(_,["Error loading video",_,"Error",pe])},_.onstalled=()=>{y(_,["Loading video stalled, skipping",_])}):y(_,["Error loading video, `src` is empty",_])}const ne="select",ee=F.querySelectorAll(ne),se=B.querySelectorAll(ne);for(let j=0;j<ee.length;j++)se[j].value=ee[j].value;if(!ye){const j=document.querySelectorAll("style, link[rel~='stylesheet'], link[as='style']");for(let _=0,ae=j.length;_<ae;++_){const oe=j[_];if(oe.tagName.toLowerCase()==="style"){const Te=B.createElement(oe.tagName),ce=oe.sheet;if(ce){let be="";try{const pe=ce.cssRules.length;for(let Ce=0;Ce<pe;++Ce)typeof ce.cssRules[Ce].cssText=="string"&&(be+=`${ce.cssRules[Ce].cssText}\r
`)}catch(pe){l({messages:["A stylesheet could not be accessed. This is likely due to the stylesheet having cross-origin imports, and many browsers block script access to cross-origin stylesheets. See https://github.com/MatthewHerbst/react-to-print/issues/429 for details. You may be able to load the sheet by both marking the stylesheet with the cross `crossorigin` attribute, and setting the `Access-Control-Allow-Origin` header on the server serving the stylesheet. Alternatively, host the stylesheet on your domain to avoid this issue entirely.",oe,`Original error: ${d(pe).message}`],level:"warning"})}Te.setAttribute("id",`react-to-print-${_}`),me&&Te.setAttribute("nonce",me),Te.appendChild(B.createTextNode(be)),B.head.appendChild(Te)}}else if(oe.getAttribute("href"))if(oe.hasAttribute("disabled"))l({messages:["`react-to-print` encountered a <link> tag with a `disabled` attribute and will ignore it. Note that the `disabled` attribute is deprecated, and some browsers ignore it. You should stop using it. https://developer.mozilla.org/en-US/docs/Web/HTML/Element/link#attr-disabled. The <link> is:",oe],level:"warning"}),y(oe);else{const Te=B.createElement(oe.tagName);for(let ce=0,be=oe.attributes.length;ce<be;++ce){const pe=oe.attributes[ce];pe&&Te.setAttribute(pe.nodeName,(w=pe.nodeValue)!==null&&w!==void 0?w:"")}Te.onload=()=>{y(Te)},Te.onerror=(ce,be,pe,Ce,Oe)=>{y(Te,["Failed to load",Te,"Error:",Oe])},me&&Te.setAttribute("nonce",me),B.head.appendChild(Te)}else l({messages:["`react-to-print` encountered a <link> tag with an empty `href` attribute. In addition to being invalid HTML, this can cause problems in many browsers, and so the <link> was not loaded. The <link> is:",oe],level:"warning"}),y(oe)}}}Y===0&&f(v,S)}function g({bodyClass:v,contentRef:y,copyShadowRoots:b,documentTitle:S,fonts:I,ignoreGlobalStyles:k,nonce:E,onAfterPrint:T,onBeforePrint:w,onPrintError:F,pageStyle:P,preserveAfterPrint:A,print:L,suppressErrors:Y}){return(0,c.useCallback)(q=>{function Q(){const K={bodyClass:v,contentRef:y,copyShadowRoots:b,documentTitle:S,fonts:I,ignoreGlobalStyles:k,nonce:E,onAfterPrint:T,onBeforePrint:w,onPrintError:F,pageStyle:P,preserveAfterPrint:A,print:L,suppressErrors:Y},ye=function(){const J=document.createElement("iframe");return J.width=`${document.documentElement.clientWidth}px`,J.height=`${document.documentElement.clientHeight}px`,J.style.position="absolute",J.style.top=`-${document.documentElement.clientHeight+100}px`,J.style.left=`-${document.documentElement.clientWidth+100}px`,J.id="printWindow",J.srcdoc="<!DOCTYPE html>",J}(),U=function(J,D){const{contentRef:B,fonts:V,ignoreGlobalStyles:W,suppressErrors:Z}=D,fe=function({contentRef:ae,optionalContent:oe,suppressErrors:Te}){return!oe||oe instanceof Event||(ae&&l({level:"warning",messages:['"react-to-print" received a `contentRef` option and a optional-content param passed to its callback. The `contentRef` option will be ignored.']}),typeof oe!="function")?ae?ae.current:void l({messages:['"react-to-print" did not receive a `contentRef` option or a optional-content param pass to its callback.'],suppressErrors:Te}):oe()}({contentRef:B,optionalContent:J,suppressErrors:Z});if(!fe)return;const ne=fe.cloneNode(!0),ee=document.querySelectorAll("link[rel~='stylesheet'], link[as='style']"),se=ne.querySelectorAll("img"),j=ne.querySelectorAll("video"),_=V?V.length:0;return{contentNode:fe,clonedContentNode:ne,clonedImgNodes:se,clonedVideoNodes:j,numResourcesToLoad:(W?0:ee.length)+se.length+j.length+_,originalCanvasNodes:fe.querySelectorAll("canvas")}}(q,K);if(!U)return void l({messages:["There is nothing to print"],suppressErrors:Y});const me=function(J,D,B){const{suppressErrors:V}=J,W=[],Z=[];return function(fe,ne){W.includes(fe)?l({level:"debug",messages:["Tried to mark a resource that has already been handled",fe],suppressErrors:V}):(ne?(l({messages:['"react-to-print" was unable to load a resource but will continue attempting to print the page',...ne],suppressErrors:V}),Z.push(fe)):W.push(fe),W.length+Z.length===D&&f(B,J))}}(K,U.numResourcesToLoad,ye);(function(J,D,B,V){J.onload=()=>{m(J,D,B,V)},document.body.appendChild(J)})(ye,me,U,K)}u(A,!0),w?w().then(()=>{Q()}).catch(K=>{F==null||F("onBeforePrint",d(K))}):Q()},[v,y,b,S,I,k,E,T,w,F,P,A,L,Y])}return i}()})})(ev);var B8=ev.exports;const Gr=qn.create({baseURL:wt.apiUrl,timeout:wt.apiTimeout,headers:{"Content-Type":"application/json"}});Gr.interceptors.request.use(e=>{var t;const r=localStorage.getItem("token");if(console.log("API Request:",{url:e.url,method:(t=e.method)==null?void 0:t.toUpperCase(),timestamp:new Date().toISOString(),hasToken:!!r,tokenFirstChars:r?`${r.substring(0,10)}...`:"none"}),r&&e.headers){e.headers.Authorization=`Bearer ${r}`;try{const n=r.split(".");if(n.length===3){const a=JSON.parse(atob(n[1])),s=a.exp*1e3,i=Date.now();console.log("Token status:",{isValid:i<s,expiresIn:`${Math.round((s-i)/1e3/60)} minutes`,expTime:new Date(s).toISOString(),currentTime:new Date(i).toISOString(),roles:a.roles||a.authorities||a.role||"Not found"}),s-i<3e5&&console.warn("Token is expired or about to expire soon")}}catch(n){console.error("Failed to decode token:",n)}}return e},e=>(console.error("Request interceptor error:",e),Promise.reject(e)));Gr.interceptors.response.use(e=>{var r;return console.log("API Success Response:",{url:e.config.url,method:(r=e.config.method)==null?void 0:r.toUpperCase(),status:e.status,timestamp:new Date().toISOString()}),e},async e=>{var n,a,s,i,c,l,u,d,f,h,x,p,m,g,v,y,b,S,I,k,E,T;const r=e.config;if(console.error("API Error Details:",{url:r==null?void 0:r.url,method:(n=r==null?void 0:r.method)==null?void 0:n.toUpperCase(),status:(a=e.response)==null?void 0:a.status,statusText:(s=e.response)==null?void 0:s.statusText,timestamp:new Date().toISOString(),requestHeaders:{contentType:(i=r==null?void 0:r.headers)==null?void 0:i["Content-Type"],hasAuthHeader:!!((c=r==null?void 0:r.headers)!=null&&c.Authorization),authHeader:(l=r==null?void 0:r.headers)!=null&&l.Authorization?`${String((u=r==null?void 0:r.headers)==null?void 0:u.Authorization).substring(0,20)}...`:"none"},requestData:r==null?void 0:r.data,responseData:(d=e.response)==null?void 0:d.data,isAuthError:((f=e.response)==null?void 0:f.status)===401||((h=e.response)==null?void 0:h.status)===403}),!r._retry&&r.url!=="/api/auth/login"&&(!e.response||e.response.status>=500&&e.response.status<600)&&(r._retryCount||(r._retryCount=0),r._retryCount<wt.retryAttempts)){r._retry=!0,r._retryCount++;const w=Math.pow(2,r._retryCount)*1e3;return await new Promise(F=>setTimeout(F,w)),console.log(`Retrying request (attempt ${r._retryCount}):`,{url:r.url,method:(x=r.method)==null?void 0:x.toUpperCase(),timestamp:new Date().toISOString()}),Gr(r)}if(!e.response)return r.baseURL===wt.apiUrl&&!r._usedFallback?(r.baseURL=wt.fallbackApiUrl,r._usedFallback=!0,Gr(r)):Promise.reject({message:"Network error. Please check your connection.",status:"network_error"});const t={message:"",status:e.response.status,originalError:e};if(e.response.status===403){const w=localStorage.getItem("token");let F=null;const P=`${r.baseURL}${r.url}`;try{if(w){const A=w.split(".");if(A.length===3){const L=JSON.parse(atob(A[1]));F={exp:new Date(L.exp*1e3).toISOString(),roles:L.roles||L.authorities||L.role||"Not found in token",username:L.sub||L.username||"Not found in token",iat:L.iat?new Date(L.iat*1e3).toISOString():"Not available",jti:L.jti||"Not available",claims:L,scope:L.scope||L.scopes||"Not found"},Date.now()>L.exp*1e3&&console.error("Permission denied with EXPIRED token",{expiredSince:`${Math.round((Date.now()-L.exp*1e3)/1e3/60)} minutes ago`})}}}catch(A){console.error("Error parsing token:",A)}t.message="Access denied. You don't have permission to perform this action.",t.tokenInfo=F,console.error("Permission Error (403 Forbidden):",{endpoint:r==null?void 0:r.url,fullUrl:P,method:(p=r==null?void 0:r.method)==null?void 0:p.toUpperCase(),tokenPresent:!!w,tokenInfo:F,requestData:r==null?void 0:r.data,requestPath:(m=r==null?void 0:r.url)==null?void 0:m.split("?")[0],requestParams:r==null?void 0:r.params,requestBody:JSON.stringify(r==null?void 0:r.data),responseData:(g=e.response)==null?void 0:g.data,responseHeaders:(v=e.response)==null?void 0:v.headers,timestamp:new Date().toISOString(),errorDetail:((b=(y=e.response)==null?void 0:y.data)==null?void 0:b.error)||((I=(S=e.response)==null?void 0:S.data)==null?void 0:I.message)||"No error details"}),w&&wt&&typeof wt=="object"&&(localStorage.setItem("last_403_url",P),localStorage.setItem("last_403_time",new Date().toISOString()),localStorage.setItem("last_403_data",JSON.stringify((r==null?void 0:r.data)||{})))}else e.response.status===401?(t.message="Unauthorized. Please log in again.",console.error("Authentication Error (401 Unauthorized):",{endpoint:r==null?void 0:r.url,method:(k=r==null?void 0:r.method)==null?void 0:k.toUpperCase(),tokenPresent:!!localStorage.getItem("token"),responseData:(E=e.response)==null?void 0:E.data,timestamp:new Date().toISOString()}),localStorage.removeItem("token"),window.location.href="/login"):t.message=((T=e.response.data)==null?void 0:T.message)||"An unexpected error occurred.";return Promise.reject(t)});Gr.get;Gr.post;Gr.put;Gr.delete;const $8={sendEmail:async e=>{try{return(await Gr.post("/api/notifications/email",e)).data}catch(r){throw console.error("Failed to send email notification:",r),r}},sendFeeReceiptEmail:async(e,r,t)=>{try{return(await Gr.post(`/api/notifications/fee-receipt/${r}`,{studentId:e,recipientEmail:t})).data}catch(n){throw console.error("Failed to send fee receipt email:",n),n}},getNotificationSettings:async()=>{try{return(await Gr.get("/api/notifications/settings")).data}catch(e){throw console.error("Failed to fetch notification settings:",e),e}},updateNotificationSettings:async e=>{try{return(await Gr.put("/api/notifications/settings",e)).data}catch(r){throw console.error("Failed to update notification settings:",r),r}},sendPaymentReminders:async()=>{try{return(await Gr.post("/api/notifications/payment-reminders")).data}catch(e){throw console.error("Failed to send payment reminders:",e),e}}},fp={CASH:"Cash",CHEQUE:"Cheque",CHECK:"Check",BANK_TRANSFER:"Bank Transfer",UPI:"UPI",ONLINE:"Online",CREDIT_CARD:"Credit Card"},Lo={MONTHLY:"Monthly",QUARTERLY:"Quarterly",HALF_YEARLY:"Half-Yearly",YEARLY:"Annual"},U8=({open:e,onClose:r,payment:t,studentName:n,className:a,studentId:s,parentEmail:i=""})=>{const c=C.useRef(null),[l,u]=C.useState(i),[d,f]=C.useState(!1),[h,x]=C.useState(!1),[p,m]=C.useState({open:!1,message:"",severity:"success"}),g=B8.useReactToPrint({documentTitle:`Receipt_${(t==null?void 0:t.id)||"Unknown"}_${(n==null?void 0:n.replace(/\s+/g,"_"))||"Student"}`,onAfterPrint:()=>{console.log("Print complete")},content:()=>c.current}),v=async()=>{if(!(!t||!s))try{x(!0);const S=await $8.sendFeeReceiptEmail(s,t.id,l);m({open:!0,message:"Receipt has been sent successfully to "+l,severity:"success"}),f(!1)}catch(S){console.error("Failed to send receipt email:",S),m({open:!0,message:"Failed to send email. Please try again.",severity:"error"})}finally{x(!1)}},y=()=>{m({...p,open:!1})};if(!t)return null;const b=`R${String(t.id).padStart(6,"0")}`;return o.jsxs(kr,{open:e,onClose:r,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{minHeight:"60vh"}},children:[o.jsxs(Xr,{sx:{display:"flex",alignItems:"center"},children:[o.jsx(yc,{sx:{mr:1}}),"Payment Receipt"]}),o.jsxs(Rr,{children:[o.jsx(Se,{ref:c,sx:{p:2},children:o.jsx(st,{elevation:0,sx:{p:3,border:"1px dashed #ccc"},children:o.jsxs(X,{container:!0,spacing:2,children:[o.jsxs(X,{item:!0,xs:12,sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[o.jsxs(Se,{children:[o.jsx(te,{variant:"h5",gutterBottom:!0,children:"SCHOOL MANAGEMENT SYSTEM"}),o.jsx(te,{variant:"body2",color:"textSecondary",children:"123 Education Street, City, Country"}),o.jsx(te,{variant:"body2",color:"textSecondary",children:"Phone: +91 1234567890"}),o.jsx(te,{variant:"body2",color:"textSecondary",children:"Email: info@schoolms.com"})]}),o.jsxs(Se,{sx:{textAlign:"right"},children:[o.jsx(te,{variant:"h6",children:"RECEIPT"}),o.jsx(te,{variant:"body1",children:b}),o.jsxs(te,{variant:"body2",children:["Date: ",Qs(new Date(t.paymentDate),"dd MMM yyyy")]})]})]}),o.jsx(X,{item:!0,xs:12,children:o.jsx(vr,{})}),o.jsxs(X,{item:!0,xs:12,sm:6,children:[o.jsx(te,{variant:"subtitle2",gutterBottom:!0,children:"STUDENT DETAILS"}),o.jsx(te,{variant:"body1",children:n}),o.jsxs(te,{variant:"body2",children:["Class: ",a]}),o.jsxs(te,{variant:"body2",children:["Student ID: ",t.studentId]})]}),o.jsxs(X,{item:!0,xs:12,sm:6,children:[o.jsx(te,{variant:"subtitle2",gutterBottom:!0,children:"PAYMENT DETAILS"}),"                ",o.jsxs(te,{variant:"body2",children:[o.jsx("strong",{children:"Payment Type:"})," ",t.frequency&&Lo[t.frequency]?Lo[t.frequency]:t.frequency," Fee"]}),o.jsxs(te,{variant:"body2",children:[o.jsx("strong",{children:"Payment Method:"})," ",t.paymentMethod&&fp[t.paymentMethod]?fp[t.paymentMethod]:t.paymentMethod]}),t.reference&&o.jsxs(te,{variant:"body2",children:[o.jsx("strong",{children:"Reference:"})," ",t.reference]})]}),o.jsx(X,{item:!0,xs:12,children:o.jsx(vr,{})}),o.jsx(X,{item:!0,xs:12,children:o.jsx(Se,{sx:{backgroundColor:"#f5f5f5",p:2,borderRadius:1,mt:2},children:o.jsxs(X,{container:!0,spacing:2,children:[o.jsxs(X,{item:!0,xs:8,children:["                      ",o.jsxs(te,{variant:"subtitle1",children:[t.frequency&&Lo[t.frequency]?Lo[t.frequency]:t.frequency," Fee Payment"]}),t.notes&&o.jsxs(te,{variant:"body2",color:"textSecondary",sx:{mt:1},children:["Notes: ",t.notes]})]}),o.jsx(X,{item:!0,xs:4,sx:{textAlign:"right"},children:o.jsxs(te,{variant:"subtitle1",children:["â‚¹",t.amount.toLocaleString()]})})]})})}),o.jsx(X,{item:!0,xs:12,sx:{display:"flex",justifyContent:"flex-end",mt:2},children:o.jsx(Se,{children:o.jsxs(te,{variant:"h6",children:["TOTAL PAID: â‚¹",t.amount.toLocaleString()]})})}),o.jsxs(X,{item:!0,xs:12,sx:{mt:4},children:[o.jsx(vr,{}),o.jsxs(Se,{sx:{display:"flex",justifyContent:"space-between",mt:3,alignItems:"flex-end"},children:[o.jsxs(Se,{sx:{maxWidth:"50%"},children:[o.jsx(te,{variant:"body2",gutterBottom:!0,children:o.jsx("strong",{children:"Received with thanks"})}),o.jsx(te,{variant:"caption",color:"textSecondary",children:"This is a computer generated receipt and doesn't require a signature."})]}),o.jsx(Se,{sx:{textAlign:"center",borderTop:"1px solid #000",pt:1,minWidth:"150px"},children:o.jsx(te,{variant:"body2",children:"Authorized Signature"})})]})]})]})})}),d&&o.jsxs(Se,{sx:{mt:2,p:2,border:"1px solid #eee",borderRadius:1},children:[o.jsx(te,{variant:"subtitle2",gutterBottom:!0,children:"Send Receipt via Email"}),o.jsx(ke,{fullWidth:!0,size:"small",label:"Email Address",variant:"outlined",value:l,onChange:S=>u(S.target.value),placeholder:"parent@example.com",sx:{mb:2}}),o.jsxs(Se,{sx:{display:"flex",justifyContent:"flex-end"},children:[o.jsx(Me,{size:"small",onClick:()=>f(!1),sx:{mr:1},children:"Cancel"}),o.jsx(Me,{size:"small",variant:"contained",onClick:v,disabled:!l||h,children:h?"Sending...":"Send"})]})]})]}),o.jsxs(Nr,{sx:{justifyContent:"space-between",p:2},children:[o.jsx(Me,{onClick:r,children:"Close"}),o.jsxs(Se,{children:[!d&&s&&o.jsx(Me,{startIcon:o.jsx(Fp,{}),onClick:()=>f(!0),sx:{mr:1},children:"Email Receipt"}),o.jsx(Me,{startIcon:o.jsx(Gv,{}),variant:"contained",onClick:g,children:"Print Receipt"})]})]}),o.jsx(xu,{open:p.open,autoHideDuration:6e3,onClose:y,anchorOrigin:{vertical:"bottom",horizontal:"center"},children:o.jsx(jr,{onClose:y,severity:p.severity,variant:"filled",children:p.message})})]})},Pl=e=>{const{children:r,value:t,index:n,...a}=e;return o.jsx("div",{role:"tabpanel",hidden:t!==n,id:`fee-tabpanel-${n}`,"aria-labelledby":`fee-tab-${n}`,...a,children:t===n&&o.jsx(Se,{sx:{p:3},children:r})})},V8=()=>{var fe;const[e,r]=C.useState(0),[t,n]=C.useState(!1),[a,s]=C.useState(!1),[i,c]=C.useState(!1),[l,u]=C.useState(!1),[d,f]=C.useState(null),[h,x]=C.useState(""),[p,m]=C.useState(null),[g,v]=C.useState(null),[y,b]=C.useState([]),[S,I]=C.useState({open:!1,message:"",severity:"success"}),{user:k}=kn(),E=(k==null?void 0:k.role)==="ADMIN"||(k==null?void 0:k.role)==="ACCOUNTS",{data:T,loading:w,error:F,refetch:P}=Nn(()=>xn.getAllFeeStructures()),{data:A,loading:L,error:Y,refetch:q}=Nn(()=>xn.getAllTransportRoutes()),{data:Q,loading:K}=Nn(()=>require("../services/studentService").default.getAll()),ye=(ne,ee)=>{r(ee)},U=async()=>{if(h.trim())try{const ee=await require("../services/studentService").default.search(h);ee?(m(ee),await me(ee.id),await J(ee.id)):(I({open:!0,message:"Student not found",severity:"error"}),m(null))}catch{I({open:!0,message:"Error searching for student",severity:"error"})}},me=async ne=>{try{const ee=await xn.getStudentFeeDetails(ne);v(ee)}catch{I({open:!0,message:"Error fetching student fee details",severity:"error"})}},J=async ne=>{try{const ee=await xn.getPaymentsByStudentId(ne);b(ee)}catch{I({open:!0,message:"Error fetching student payments",severity:"error"})}},D=async()=>{c(!1),I({open:!0,message:"Payment processed successfully",severity:"success"}),p!=null&&p.id&&(await me(p.id),await J(p.id))},B=ne=>{f(ne),u(!0)},V=async ne=>{try{await xn.downloadReceipt(ne),I({open:!0,message:"Receipt downloaded successfully",severity:"success"})}catch{I({open:!0,message:"Error downloading receipt",severity:"error"})}},W=async ne=>{if(window.confirm("Are you sure you want to void this payment? This action cannot be undone."))try{await xn.voidPayment(ne,"Voided by admin"),I({open:!0,message:"Payment voided successfully",severity:"success"}),p!=null&&p.id&&(await me(p.id),await J(p.id))}catch{I({open:!0,message:"Error voiding payment",severity:"error"})}},Z=()=>{m(null),x(""),v(null),b([])};return o.jsxs(Se,{sx:{width:"100%"},children:[o.jsx(Se,{sx:{borderBottom:1,borderColor:"divider"},children:o.jsxs(Ap,{value:e,onChange:ye,"aria-label":"fee management tabs",children:[o.jsx(Ns,{label:"Fee Structures"}),o.jsx(Ns,{label:"Transport Routes"}),o.jsx(Ns,{label:"Payments"})]})}),o.jsxs(Pl,{value:e,index:0,children:[o.jsxs(Se,{sx:{mb:2,display:"flex",justifyContent:"space-between"},children:[o.jsx(te,{variant:"h6",children:"Fee Structures"}),"          ",o.jsx(bn,{permissions:["MANAGE_FEES"],children:o.jsx(Me,{variant:"contained",startIcon:o.jsx(Gs,{}),onClick:()=>n(!0),children:"Add Fee Structure"})})]}),w?o.jsx(Rn,{}):F?o.jsx(Ln,{message:"Error loading fee structures"}):T?o.jsx(pF,{feeStructures:T,onEdit:ne=>console.log("Edit fee structure:",ne),onDelete:ne=>console.log("Delete fee structure:",ne),onRefresh:P}):null]}),o.jsxs(Pl,{value:e,index:1,children:[o.jsxs(Se,{sx:{mb:2,display:"flex",justifyContent:"space-between"},children:[o.jsx(te,{variant:"h6",children:"Transport Routes"}),"          ",o.jsx(bn,{permissions:["MANAGE_FEES"],children:o.jsx(Me,{variant:"contained",startIcon:o.jsx(Gs,{}),onClick:()=>s(!0),children:"Add Transport Route"})})]}),L?o.jsx(Rn,{}):Y?o.jsx(Ln,{message:"Error loading transport routes"}):A?o.jsx(hF,{transportRoutes:A,onEdit:ne=>console.log("Edit route:",ne),onDelete:ne=>console.log("Delete route:",ne),onRefresh:q}):null]}),o.jsxs(Pl,{value:e,index:2,children:[o.jsxs(Se,{sx:{mb:3},children:[o.jsx(te,{variant:"h6",gutterBottom:!0,children:"Student Fee Management"}),o.jsx(st,{sx:{p:2},children:o.jsxs(X,{container:!0,spacing:2,alignItems:"center",children:[o.jsx(X,{item:!0,xs:12,sm:6,md:4,children:o.jsx(Yv,{options:Q||[],getOptionLabel:ne=>`${ne.name} (${ne.id})`,value:p,onChange:(ne,ee)=>{m(ee),ee!=null&&ee.id&&(me(ee.id),J(ee.id))},renderInput:ne=>o.jsx(ke,{...ne,label:"Search Student",variant:"outlined",fullWidth:!0,onChange:ee=>x(ee.target.value),InputProps:{...ne.InputProps,endAdornment:o.jsx(o.Fragment,{children:K?o.jsx(Rn,{size:20}):ne.InputProps.endAdornment})}})})}),o.jsx(X,{item:!0,children:o.jsx(Me,{variant:"contained",startIcon:o.jsx(bp,{}),onClick:U,children:"Search"})}),o.jsx(X,{item:!0,children:o.jsx(at,{title:"Reset",children:o.jsx(Ze,{onClick:Z,children:o.jsx(Ka,{})})})})]})})]}),p&&o.jsxs(o.Fragment,{children:[o.jsx(Se,{sx:{mt:3},children:o.jsxs(st,{sx:{p:2,mb:3},children:[o.jsxs(Se,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[o.jsxs(te,{variant:"h6",children:[p.name,"'s Fee Details"]}),"                  ",o.jsx(bn,{permissions:["MANAGE_FEES"],children:o.jsx(Me,{variant:"contained",startIcon:o.jsx(yc,{}),onClick:()=>c(!0),disabled:!g,children:"Record Payment"})})]}),"                ",g?o.jsx(L8,{feeDetails:g}):o.jsx(te,{children:"No fee details available for this student"})]})}),o.jsxs(Se,{sx:{mt:3},children:[o.jsx(te,{variant:"h6",gutterBottom:!0,children:"Payment History"}),o.jsx(M8,{payments:y,onViewReceipt:B,onDownloadReceipt:V,onVoidPayment:W,isAdmin:E})]})]})]}),"      ",t&&o.jsx(mF,{open:t,onClose:()=>n(!1),onSubmit:async ne=>{await xn.createFeeStructure(ne),n(!1),P(),I({open:!0,message:"Fee structure created successfully",severity:"success"})}}),a&&o.jsx(xF,{open:a,onClose:()=>s(!1),onSubmit:async ne=>{await xn.createTransportRoute(ne),s(!1),q(),I({open:!0,message:"Transport route created successfully",severity:"success"})}}),i&&p&&g&&o.jsx(N8,{open:i,onClose:()=>c(!1),studentId:p.id??null,onSubmit:async ne=>{try{await xn.createPayment(ne),D()}catch{I({open:!0,message:"Error processing payment",severity:"error"})}},loading:!1}),"      ",l&&d!==null&&o.jsx(U8,{open:l,payment:{id:d,studentId:(p==null?void 0:p.id)||0,paymentDate:new Date().toISOString(),amount:0,amountPaid:0,paymentMethod:"CASH",frequency:"MONTHLY",paymentStatus:"PAID",academicYear:"2024-2025",academicTerm:"TERM1"},studentName:(p==null?void 0:p.name)||"Student",className:`Grade ${((fe=g==null?void 0:g.feeStructure)==null?void 0:fe.classGrade)||"N/A"}`,onClose:()=>{u(!1),f(null)},onDownload:()=>{d!==null&&V(d)}}),o.jsx(xu,{open:S.open,autoHideDuration:6e3,onClose:()=>I({...S,open:!1}),children:o.jsx(jr,{onClose:()=>I({...S,open:!1}),severity:S.severity,sx:{width:"100%"},children:S.message})})]})},W8=()=>{const{login:e}=kn(),[r,t]=C.useState(""),[n,a]=C.useState(""),[s,i]=C.useState(!1),[c,l]=C.useState(null),[u,d]=C.useState(null),[f,h]=C.useState(!1),[x,p]=C.useState(!1),[m,g]=C.useState(null);C.useEffect(()=>{try{console.log("ðŸ” Login component mounted"),console.log("âš™ï¸ API URL from environment config:",{}.VITE_API_URL||"https://api.schoolms.com")}catch(S){console.error("Error in debug collection:",S)}},[]);const v=async S=>{S.preventDefault(),l(null),d(null),g(null);try{if(i(!0),console.log(`ðŸ” Attempting login with username: ${r}`),f){console.log("ðŸ§ª Debug mode: Making direct API call instead of using auth context");try{const I=await Jo.login({username:r,password:n});console.log("âœ… Direct login API call successful:",I),g("Direct API call successful! Proceeding with normal login flow...")}catch(I){throw console.error("âŒ Direct login API call failed:",I),d(I),g(`Direct API call failed: ${(I==null?void 0:I.message)||JSON.stringify(I)}`),I}}await e(r,n),console.log("âœ… Login successful through auth context")}catch(I){console.error("âŒ Login error:",I),l(I.message||"Login failed. Please try again."),d(I)}finally{i(!1)}},y=async()=>{try{i(!0),g(null);const S={}.VITE_API_URL||"https://api.schoolms.com";console.log(`ðŸ§ª Testing server connection to ${S}/health`);const I=await fetch(`${S}/health`,{method:"GET"});if(I.ok){const k=`Server connection successful: ${await I.text()}`;g(k),console.log("âœ…",k)}else{const k=`Server returned status: ${I.status} ${I.statusText}`;g(k),console.warn("âš ï¸",k)}}catch(S){const I=`Server connection failed: ${S.message}`;g(I),console.error("âŒ",I)}finally{i(!1)}},b=async()=>{if(!r||!n){g("Please enter username and password before testing");return}i(!0),l(null),d(null),g("Testing login with /api/auth/login endpoint...");try{const S={}.VITE_API_URL||"https://api.schoolms.com";console.log(`ðŸ§ª Testing login with ${S}/api/auth/login`);const I=await Jo.login({username:r,password:n});I&&I.data&&(g("Login successful! Received token and user details."),console.log("âœ… Test login successful:",I.data))}catch(S){const I=`Login test failed: ${S.message||JSON.stringify(S)}`;g(I),console.error("âŒ",I),d(S)}finally{i(!1)}};return o.jsx(Se,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",bgcolor:"background.default",py:4},children:o.jsx(Ja,{sx:{width:"100%",maxWidth:450,boxShadow:3},children:o.jsxs(Qa,{sx:{p:4},children:[o.jsx(te,{variant:"h4",component:"h1",gutterBottom:!0,textAlign:"center",children:"Login"}),c&&o.jsx(jr,{severity:"error",sx:{mb:2},children:c}),m&&o.jsx(jr,{severity:"info",sx:{mb:2,whiteSpace:"pre-line"},children:m}),o.jsxs(Se,{component:"form",onSubmit:v,noValidate:!0,sx:{mt:1},children:[o.jsx(ke,{margin:"normal",required:!0,fullWidth:!0,id:"username",label:"Username",name:"username",autoComplete:"username",autoFocus:!0,value:r,onChange:S=>t(S.target.value),disabled:s}),o.jsx(ke,{margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",value:n,onChange:S=>a(S.target.value),disabled:s}),o.jsx(Me,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},disabled:s||!r||!n,children:s?o.jsx(ta,{size:24}):"Sign In"}),o.jsx(Se,{sx:{mt:2},children:o.jsx(jl,{control:o.jsx(Rl,{checked:x,onChange:()=>p(!x)}),label:"Show debugging tools"})}),o.jsx(qv,{in:x,children:o.jsxs(st,{variant:"outlined",sx:{p:2,mt:2},children:[o.jsx(te,{variant:"subtitle2",gutterBottom:!0,children:"Debugging Tools"}),o.jsx(jl,{control:o.jsx(Rl,{checked:f,onChange:()=>h(!f),disabled:s}),label:"Debug mode (direct API calls)"}),o.jsx(vr,{sx:{my:2}}),o.jsxs(X,{container:!0,spacing:2,children:[o.jsx(X,{item:!0,xs:6,children:o.jsx(Me,{fullWidth:!0,variant:"outlined",disabled:s,onClick:y,children:"Test Server Connection"})}),o.jsx(X,{item:!0,xs:6,children:o.jsx(Me,{fullWidth:!0,variant:"outlined",disabled:s||!r||!n,onClick:b,children:"Test Login"})})]}),u&&o.jsxs(Se,{sx:{mt:2,overflow:"auto"},children:[o.jsx(te,{variant:"subtitle2",color:"error",children:"Detailed Error:"}),o.jsx(st,{variant:"outlined",sx:{p:1,bgcolor:"grey.100"},children:o.jsx("pre",{style:{margin:0,whiteSpace:"pre-wrap",fontSize:12},children:JSON.stringify(u,null,2)})})]})]})}),o.jsx(Se,{sx:{mt:3,textAlign:"center"},children:o.jsx(tn,{component:Yn,to:"/register",variant:"body2",children:"Don't have an account? Sign Up"})})]})]})})})},H8=[{value:"ADMIN",label:"ADMIN - Full system administrative access"},{value:"TEACHER",label:"TEACHER - Access to teaching-related functions"},{value:"STUDENT",label:"STUDENT - Access to student-specific features"},{value:"STAFF",label:"STAFF - General staff access"},{value:"PARENT",label:"PARENT - Parent/guardian access"}],z8=()=>{const e=so(),{showNotification:r}=sn(),[t,n]=C.useState({username:"",password:"",email:"",role:"",fullName:""}),[a,s]=C.useState(!1),[i,c]=C.useState(null),l=d=>f=>{n(h=>({...h,[d]:f.target.value})),i&&c(null)},u=async d=>{d.preventDefault();try{s(!0),c(null),await Jo.register(t),r({type:"success",message:"Registration successful! Please login."}),e("/login")}catch(f){console.error("Registration error:",f);let h="Registration failed. Please try again.";f.message&&typeof f.message=="string"?h=f.message:f.response&&(f.response.data&&f.response.data.message?h=f.response.data.message:f.response.data&&typeof f.response.data=="string"&&(h=f.response.data)),c(h),r({type:"error",message:h})}finally{s(!1)}};return o.jsx(Se,{sx:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"background.default"},children:o.jsx(Ja,{sx:{maxWidth:400,width:"100%",mx:2},children:o.jsx(Qa,{sx:{p:4},children:o.jsxs(Se,{component:"form",onSubmit:u,children:[o.jsx(te,{variant:"h4",align:"center",gutterBottom:!0,children:"Create Account"}),o.jsx(te,{variant:"h6",align:"center",color:"textSecondary",sx:{mb:4},children:"Register for a new account"}),i&&o.jsx(jr,{severity:"error",sx:{mb:2},children:i}),o.jsx(ke,{fullWidth:!0,label:"Full Name",value:t.fullName,onChange:l("fullName"),margin:"normal",required:!0,disabled:a}),o.jsx(ke,{fullWidth:!0,label:"Username",value:t.username,onChange:l("username"),margin:"normal",required:!0,disabled:a,error:!!i&&i.toLowerCase().includes("username"),helperText:i&&i.toLowerCase().includes("username")?i:""}),o.jsx(ke,{fullWidth:!0,type:"email",label:"Email",value:t.email,onChange:l("email"),margin:"normal",required:!0,disabled:a,error:!!i&&i.toLowerCase().includes("email"),helperText:i&&i.toLowerCase().includes("email")?i:""}),o.jsx(ke,{fullWidth:!0,select:!0,label:"Role",value:t.role,onChange:l("role"),margin:"normal",required:!0,disabled:a,children:H8.map(d=>o.jsx(Xe,{value:d.value,children:d.label},d.value))}),o.jsx(ke,{fullWidth:!0,type:"password",label:"Password",value:t.password,onChange:l("password"),margin:"normal",required:!0,disabled:a,error:!!i&&i.toLowerCase().includes("password"),helperText:i&&i.toLowerCase().includes("password")?i:""}),o.jsx(Me,{fullWidth:!0,variant:"contained",color:"primary",size:"large",type:"submit",disabled:a,sx:{mt:3},children:a?o.jsx(ta,{size:24}):"Register"}),o.jsx(Se,{sx:{mt:2,textAlign:"center"},children:o.jsxs(te,{variant:"body2",color:"textSecondary",children:["Already have an account?"," ",o.jsx(tn,{component:Yn,to:"/login",children:"Sign in"})]})})]})})})})};var Qd={},G8=At;Object.defineProperty(Qd,"__esModule",{value:!0});var tv=Qd.default=void 0,Y8=G8(_t()),q8=o;tv=Qd.default=(0,Y8.default)((0,q8.jsx)("path",{d:"M5 13.18v4L12 21l7-3.82v-4L12 17zM12 3 1 9l11 6 9-4.91V17h2V9z"}),"School");var Zd={},X8=At;Object.defineProperty(Zd,"__esModule",{value:!0});var ef=Zd.default=void 0,K8=X8(_t()),J8=o;ef=Zd.default=(0,K8.default)((0,J8.jsx)("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3m-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3m0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5m8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5"}),"People");var tf={},Q8=At;Object.defineProperty(tf,"__esModule",{value:!0});var rv=tf.default=void 0,Z8=Q8(_t()),hp=o;rv=tf.default=(0,Z8.default)([(0,hp.jsx)("path",{d:"M21 5c-1.11-.35-2.33-.5-3.5-.5-1.95 0-4.05.4-5.5 1.5-1.45-1.1-3.55-1.5-5.5-1.5S2.45 4.9 1 6v14.65c0 .25.25.5.5.5.1 0 .15-.05.25-.05C3.1 20.45 5.05 20 6.5 20c1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.3 4.75 1.05.1.05.15.05.25.05.25 0 .5-.25.5-.5V6c-.6-.45-1.25-.75-2-1m0 13.5c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V8c1.35-.85 3.8-1.5 5.5-1.5 1.2 0 2.4.15 3.5.5z"},"0"),(0,hp.jsx)("path",{d:"M17.5 10.5c.88 0 1.73.09 2.5.26V9.24c-.79-.15-1.64-.24-2.5-.24-1.7 0-3.24.29-4.5.83v1.66c1.13-.64 2.7-.99 4.5-.99M13 12.49v1.66c1.13-.64 2.7-.99 4.5-.99.88 0 1.73.09 2.5.26V11.9c-.79-.15-1.64-.24-2.5-.24-1.7 0-3.24.3-4.5.83m4.5 1.84c-1.7 0-3.24.29-4.5.83v1.66c1.13-.64 2.7-.99 4.5-.99.88 0 1.73.09 2.5.26v-1.52c-.79-.16-1.64-.24-2.5-.24"},"1")],"MenuBook");var rf={},eB=At;Object.defineProperty(rf,"__esModule",{value:!0});var nv=rf.default=void 0,tB=eB(_t()),rB=o;nv=rf.default=(0,tB.default)((0,rB.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2M9 17H7v-7h2zm4 0h-2V7h2zm4 0h-2v-4h2z"}),"Assessment");var nf={},nB=At;Object.defineProperty(nf,"__esModule",{value:!0});var av=nf.default=void 0,aB=nB(_t()),sB=o;av=nf.default=(0,aB.default)((0,sB.jsx)("path",{d:"M3 13h8V3H3zm0 8h8v-6H3zm10 0h8V11h-8zm0-18v6h8V3z"}),"Dashboard");var af={},iB=At;Object.defineProperty(af,"__esModule",{value:!0});var sv=af.default=void 0,oB=iB(_t()),cB=o;sv=af.default=(0,oB.default)((0,cB.jsx)("path",{d:"M6 17h3l2-4V7H5v6h3zm8 0h3l2-4V7h-6v6h3z"}),"FormatQuote");var sf={},lB=At;Object.defineProperty(sf,"__esModule",{value:!0});var iv=sf.default=void 0,uB=lB(_t()),dB=o;iv=sf.default=(0,uB.default)((0,dB.jsx)("path",{d:"M17 10H7v2h10zm2-7h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m0 16H5V8h14zm-5-5H7v2h7z"}),"EventNote");var of={},fB=At;Object.defineProperty(of,"__esModule",{value:!0});var ov=of.default=void 0,hB=fB(_t()),pB=o;ov=of.default=(0,hB.default)((0,pB.jsx)("path",{d:"M14.06 9.94 12 9l2.06-.94L15 6l.94 2.06L18 9l-2.06.94L15 12zM4 14l.94-2.06L7 11l-2.06-.94L4 8l-.94 2.06L1 11l2.06.94zm4.5-5 1.09-2.41L12 5.5 9.59 4.41 8.5 2 7.41 4.41 5 5.5l2.41 1.09zm-4 11.5 6-6.01 4 4L23 8.93l-1.41-1.41-7.09 7.97-4-4L3 19z"}),"AutoGraph");var cf={},mB=At;Object.defineProperty(cf,"__esModule",{value:!0});var cv=cf.default=void 0,xB=mB(_t()),gB=o;cv=cf.default=(0,xB.default)((0,gB.jsx)("path",{d:"M19 5h-2V3H7v2H5c-1.1 0-2 .9-2 2v1c0 2.55 1.92 4.63 4.39 4.94.63 1.5 1.98 2.63 3.61 2.96V19H7v2h10v-2h-4v-3.1c1.63-.33 2.98-1.46 3.61-2.96C19.08 12.63 21 10.55 21 8V7c0-1.1-.9-2-2-2M5 8V7h2v3.82C5.84 10.4 5 9.3 5 8m14 0c0 1.3-.84 2.4-2 2.82V7h2z"}),"EmojiEvents");const vB=[{icon:o.jsx(av,{fontSize:"large",color:"primary"}),title:"Interactive Dashboard",description:"Get a comprehensive view of school performance with our intuitive dashboard"},{icon:o.jsx(ef,{fontSize:"large",color:"primary"}),title:"Student Management",description:"Manage student profiles, attendance, performance and more in one place"},{icon:o.jsx(tv,{fontSize:"large",color:"primary"}),title:"Teacher Management",description:"Streamline teacher scheduling, performance tracking, and professional development"},{icon:o.jsx(rv,{fontSize:"large",color:"primary"}),title:"Course Management",description:"Create and manage courses, curriculum planning and resource allocation"},{icon:o.jsx(nv,{fontSize:"large",color:"primary"}),title:"Detailed Reports",description:"Generate insightful reports on attendance, grades, and overall performance"},{icon:o.jsx(hd,{fontSize:"large",color:"primary"}),title:"Admissions",description:"Simplify the admission process with online applications and tracking"}],yB=[{name:"Sarah Johnson",position:"Principal, Westfield Academy",comment:"Implementing this School Management System has transformed our administrative processes. We've reduced paperwork by 80% and our staff can focus more on what matters - the students.",rating:5},{name:"Michael Chen",position:"IT Director, Riverdale High School",comment:"After evaluating several systems, this platform stood out for its intuitive interface and comprehensive feature set. The support team has been exceptional throughout our onboarding.",rating:5},{name:"Dr. Amelia Patel",position:"Superintendent, Springfield District",comment:"The analytics and reporting capabilities have given us unprecedented insights into student performance trends. It's helping us make data-driven decisions to improve educational outcomes.",rating:4.5}],bB=[{question:"How easy is it to migrate from our current system?",answer:"Our team provides comprehensive migration support. We have experience integrating with most popular school management systems and can transfer your data seamlessly with minimal disruption to your operations."},{question:"Is the platform secure for handling student data?",answer:"Absolutely. We prioritize data security with end-to-end encryption, regular security audits, and full compliance with educational data protection regulations including FERPA and GDPR."},{question:"Can we customize the platform for our school's specific needs?",answer:"Yes, our system is highly customizable. You can configure user roles, permission sets, and workflows to match your institution's processes. For more specialized needs, our development team can build custom modules."},{question:"What kind of training and support do you provide?",answer:"We offer comprehensive onboarding training for administrators, teachers, and staff. Our support team is available via email, chat, and phone. We also provide an extensive knowledge base with tutorials and best practices."},{question:"Do you offer mobile access for parents and students?",answer:"Yes, our platform is fully mobile-responsive and we offer dedicated mobile apps for both iOS and Android. Parents and students can access grades, attendance, announcements, and more on the go."}],wB=[{icon:o.jsx(ov,{fontSize:"large",color:"primary"}),value:"95%",label:"Administrative Efficiency Increase"},{icon:o.jsx(ef,{fontSize:"large",color:"primary"}),value:"250+",label:"Schools Onboarded"},{icon:o.jsx(iv,{fontSize:"large",color:"primary"}),value:"68%",label:"Reduction in Paperwork"},{icon:o.jsx(cv,{fontSize:"large",color:"primary"}),value:"4.8/5",label:"Customer Satisfaction"}],lv=()=>{const e=gu();vu(e.breakpoints.down("sm"));const[r,t]=C.useState(!1),n=a=>(s,i)=>{t(i?a:!1)};return o.jsxs(Se,{sx:{minHeight:"100vh"},children:[o.jsx(st,{sx:{position:"relative",backgroundColor:e.palette.primary.main,color:e.palette.primary.contrastText,pt:8,pb:12},elevation:0,children:o.jsx(Ta,{maxWidth:"lg",children:o.jsxs(X,{container:!0,spacing:4,alignItems:"center",children:[o.jsxs(X,{item:!0,md:7,xs:12,children:[o.jsx(te,{variant:"h1",gutterBottom:!0,sx:{fontWeight:700,fontSize:{xs:"2.5rem",md:"3.5rem"}},children:"Modern School Management System"}),o.jsx(te,{variant:"h5",paragraph:!0,sx:{mb:4,opacity:.9},children:"Streamline educational administration with our comprehensive, user-friendly platform designed for modern schools."}),o.jsxs(gc,{direction:{xs:"column",sm:"row"},spacing:2,children:[o.jsx(Me,{component:Yn,to:"/login",variant:"contained",size:"large",color:"secondary",sx:{px:4,py:1.5},children:"Sign In"}),o.jsx(Me,{component:Yn,to:"/register",variant:"outlined",size:"large",sx:{px:4,py:1.5,color:"white",borderColor:"white","&:hover":{borderColor:"white",backgroundColor:"rgba(255,255,255,0.1)"}},children:"Register"})]})]}),o.jsx(X,{item:!0,md:5,xs:12,sx:{display:{xs:"none",md:"block"}},children:o.jsx(Se,{component:"img",src:"/school-illustration.svg",alt:"School Management",sx:{width:"100%",maxHeight:400,objectFit:"contain",filter:"drop-shadow(0px 4px 8px rgba(0,0,0,0.2))"}})})]})})}),o.jsxs(Ta,{maxWidth:"lg",sx:{py:8},children:[o.jsx(te,{variant:"h3",align:"center",gutterBottom:!0,sx:{mb:6,fontWeight:700},children:"Transforming Education Administration"}),o.jsx(X,{container:!0,spacing:4,justifyContent:"center",children:wB.map((a,s)=>o.jsx(X,{item:!0,xs:6,md:3,children:o.jsxs(st,{elevation:3,sx:{p:3,textAlign:"center",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",transition:"0.3s","&:hover":{transform:"translateY(-5px)",boxShadow:e.shadows[8]}},children:[o.jsx(Se,{sx:{mb:2},children:a.icon}),o.jsx(te,{variant:"h3",component:"div",sx:{fontWeight:"bold",mb:1},children:a.value}),o.jsx(te,{variant:"body1",color:"text.secondary",children:a.label})]})},s))})]}),o.jsxs(Ta,{maxWidth:"lg",sx:{py:8},children:[o.jsx(te,{variant:"h3",align:"center",gutterBottom:!0,sx:{mb:6,fontWeight:700},children:"Features that Transform Education Management"}),o.jsx(X,{container:!0,spacing:4,children:vB.map((a,s)=>o.jsx(X,{item:!0,xs:12,sm:6,md:4,children:o.jsx(Ja,{sx:{height:"100%",display:"flex",flexDirection:"column",transition:"0.3s","&:hover":{transform:"translateY(-5px)",boxShadow:e.shadows[10]}},elevation:2,children:o.jsxs(Qa,{sx:{flexGrow:1,textAlign:"center",p:3},children:[o.jsx(Se,{sx:{mb:2},children:a.icon}),o.jsx(te,{variant:"h5",component:"h2",gutterBottom:!0,fontWeight:"bold",children:a.title}),o.jsx(te,{variant:"body1",color:"text.secondary",children:a.description})]})})},s))})]}),o.jsx(Se,{sx:{py:8,bgcolor:"background.default"},children:o.jsxs(Ta,{maxWidth:"lg",children:[o.jsx(te,{variant:"h3",align:"center",gutterBottom:!0,sx:{mb:6,fontWeight:700},children:"Trusted by Educational Leaders"}),o.jsx(X,{container:!0,spacing:4,children:yB.map((a,s)=>o.jsx(X,{item:!0,xs:12,md:4,children:o.jsxs(Ja,{elevation:3,sx:{height:"100%",display:"flex",flexDirection:"column",position:"relative",pt:6,pb:3,px:3},children:[o.jsx(Se,{sx:{position:"absolute",top:-20,left:"calc(50% - 25px)",width:50,height:50,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",bgcolor:e.palette.primary.main,color:"white"},children:o.jsx(sv,{})}),o.jsxs(Qa,{sx:{textAlign:"center",flexGrow:1},children:[o.jsxs(te,{variant:"body1",sx:{mb:3,fontStyle:"italic"},children:['"',a.comment,'"']}),o.jsxs(Se,{sx:{mt:"auto"},children:[o.jsx(te,{variant:"h6",component:"div",fontWeight:"bold",children:a.name}),o.jsx(te,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:a.position}),o.jsx(Xv,{value:a.rating,precision:.5,readOnly:!0,sx:{mt:1}})]})]})]})},s))})]})}),o.jsxs(Ta,{maxWidth:"md",sx:{py:8},children:[o.jsx(te,{variant:"h3",align:"center",gutterBottom:!0,sx:{mb:6,fontWeight:700},children:"Frequently Asked Questions"}),o.jsx(st,{elevation:2,sx:{p:{xs:2,md:4},borderRadius:2},children:bB.map((a,s)=>o.jsxs(Ra,{expanded:r===`panel${s}`,onChange:n(`panel${s}`),disableGutters:!0,elevation:0,sx:{border:0,"&:not(:last-child)":{borderBottom:1,borderColor:"divider"},"&:before":{display:"none"}},children:[o.jsx(Na,{expandIcon:o.jsx(la,{}),"aria-controls":`panel${s}-content`,id:`panel${s}-header`,sx:{py:2},children:o.jsx(te,{variant:"h6",fontWeight:"medium",children:a.question})}),o.jsx(Ma,{children:o.jsx(te,{variant:"body1",color:"text.secondary",children:a.answer})})]},s))})]}),o.jsx(Se,{sx:{py:8,bgcolor:"background.default"},children:o.jsx(Ta,{maxWidth:"md",children:o.jsxs(st,{elevation:4,sx:{p:{xs:4,md:6},textAlign:"center",borderRadius:4,backgroundColor:e.palette.background.paper,backgroundImage:"linear-gradient(rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.9))"},children:[o.jsx(te,{variant:"h4",gutterBottom:!0,fontWeight:"bold",children:"Ready to Transform Your School's Administration?"}),o.jsx(te,{variant:"body1",paragraph:!0,sx:{mb:4,maxWidth:"80%",mx:"auto"},children:"Join thousands of educational institutions that have streamlined their operations with our comprehensive School Management System."}),o.jsx(Me,{component:Yn,to:"/register",variant:"contained",color:"primary",size:"large",sx:{px:5,py:1.5},children:"Get Started Today"})]})})}),o.jsx(Se,{component:"footer",sx:{py:6,bgcolor:"background.paper",borderTop:`1px solid ${e.palette.divider}`},children:o.jsx(Ta,{maxWidth:"lg",children:o.jsxs(X,{container:!0,spacing:4,justifyContent:"space-between",children:[o.jsxs(X,{item:!0,xs:12,sm:6,md:3,children:[o.jsx(te,{variant:"h6",color:"text.primary",gutterBottom:!0,children:"School MS"}),o.jsx(te,{variant:"body2",color:"text.secondary",children:"Simplifying education management for a better learning experience."}),o.jsx(Se,{sx:{mt:2},children:o.jsxs(te,{variant:"body2",color:"text.secondary",children:["Â© ",new Date().getFullYear()," School Management System"]})})]}),o.jsxs(X,{item:!0,xs:12,sm:6,md:3,children:[o.jsx(te,{variant:"h6",color:"text.primary",gutterBottom:!0,children:"Features"}),o.jsx(tn,{component:Yn,to:"/login",color:"text.secondary",display:"block",sx:{mb:1},children:"Dashboard"}),o.jsx(tn,{component:Yn,to:"/login",color:"text.secondary",display:"block",sx:{mb:1},children:"Student Management"}),o.jsx(tn,{component:Yn,to:"/login",color:"text.secondary",display:"block",sx:{mb:1},children:"Teacher Management"}),o.jsx(tn,{component:Yn,to:"/login",color:"text.secondary",display:"block",children:"Reports"})]}),o.jsxs(X,{item:!0,xs:12,sm:6,md:3,children:[o.jsx(te,{variant:"h6",color:"text.primary",gutterBottom:!0,children:"Resources"}),o.jsx(tn,{href:"#",color:"text.secondary",display:"block",sx:{mb:1},children:"Documentation"}),o.jsx(tn,{href:"#",color:"text.secondary",display:"block",sx:{mb:1},children:"Support"}),o.jsx(tn,{href:"#",color:"text.secondary",display:"block",children:"Blog"})]}),o.jsxs(X,{item:!0,xs:12,sm:6,md:3,children:[o.jsx(te,{variant:"h6",color:"text.primary",gutterBottom:!0,children:"Company"}),o.jsx(tn,{href:"#",color:"text.secondary",display:"block",sx:{mb:1},children:"About Us"}),o.jsx(tn,{href:"#",color:"text.secondary",display:"block",sx:{mb:1},children:"Contact"}),o.jsx(tn,{href:"#",color:"text.secondary",display:"block",children:"Privacy Policy"})]})]})})})]})};var fr=(e=>(e.ACTIVE="ACTIVE",e.ON_LEAVE="ON_LEAVE",e.SUSPENDED="SUSPENDED",e.TERMINATED="TERMINATED",e.RETIRED="RETIRED",e.RESIGNED="RESIGNED",e))(fr||{});const pp={Teacher:1,Principal:2,"Admin Officer":3,Librarian:4,Management:5,"Account Officer":6},Ol=e=>{const r={...e};return r.role&&pp[r.role]&&(r.roleId=pp[r.role]),r.joinDate&&!r.joiningDate&&(r.joiningDate=r.joinDate),r.phoneNumber&&!r.phone?r.phone=r.phoneNumber:r.phone&&!r.phoneNumber&&(r.phoneNumber=r.phone),r},SB=(e,r,t)=>{const n=()=>{const s={staff:r,expectedCount:r.length};return console.log("Trying Format 1: Wrapped in staff property with expectedCount",s),fetch(e,{method:"POST",headers:t,body:JSON.stringify(s)}).then(i=>{if(!i.ok)throw new Error(`HTTP error! Status: ${i.status}`);return i.json()}).then(i=>(console.log("Bulk upload successful with Format 1",i),i))},a=()=>(console.log("Trying Format 2: Direct array of staff members"),fetch(e,{method:"POST",headers:t,body:JSON.stringify(r)}).then(s=>{if(!s.ok)throw new Error(`HTTP error! Status: ${s.status}`);return s.json()}).then(s=>(console.log("Bulk upload successful with Format 2",s),s)));return n().catch(s=>(console.log("Format 1 failed:",s.message),a().catch(i=>{throw console.log("Format 2 failed:",i.message),{message:"Failed to import staff data after trying multiple formats",details:"The server may not be correctly configured to accept bulk staff data",originalError:i}})))},Fa={getAll:()=>De.get("staff"),getById:e=>De.get(`staff/${e}`),create:e=>{const r=Ol(e);return De.post("staff",r)},createBulk:e=>{const r=e.map(i=>{const c=Ol(i);return c.joinDate&&(c.joiningDate=c.joinDate,c.joinDate=c.joinDate),c.phoneNumber&&!c.phone&&(c.phone=c.phoneNumber),c});console.log("Sending bulk staff data to server:",JSON.stringify(r,null,2));const n=`${wt.apiUrl.endsWith("/")?wt.apiUrl.slice(0,-1):wt.apiUrl}/api/staff/bulk`;console.log("Using URL:",n);const a=localStorage.getItem("token"),s={"Content-Type":"application/json"};return a?(s.Authorization=`Bearer ${a}`,console.log("Using authentication token")):console.warn("No authentication token found in localStorage"),SB(n,r,s)},bulkCreate:function(e){return this.createBulk(e)},update:(e,r)=>{const t=Ol(r);return De.put(`staff/${e}`,t)},toggleStatus:(e,r)=>De.patch(`staff/${e}/status`,{isActive:r}),updateEmploymentStatus:(e,r)=>{console.log(`[staffService] Updating employment status for staff ID ${e} to ${r}`);const t=localStorage.getItem("token"),n=t?`Token present (${t.substring(0,15)}...)`:"Token missing";let a=[];if(t)try{const s=JSON.parse(atob(t.split(".")[1]));a=s.roles||s.authorities||[],console.log("[staffService] User roles from token:",a),console.log("[staffService] Token expires:",new Date(s.exp*1e3).toLocaleString())}catch(s){console.error("[staffService] Error decoding token:",s)}return console.log("[staffService] Request details:",{endpoint:`staff/${e}/employment-status`,method:"PATCH",payload:{employmentStatus:r},authStatus:n,userRoles:a,timestamp:new Date().toISOString()}),De.patch(`staff/${e}/employment-status`,{employmentStatus:r}).then(s=>(console.log("[staffService] Status update successful:",{statusCode:200,responseData:s,timestamp:new Date().toISOString()}),s)).catch(s=>{var i,c,l;throw console.error("[staffService] Status update failed:",{statusCode:((i=s.response)==null?void 0:i.status)||"No status",errorMessage:((l=(c=s.response)==null?void 0:c.data)==null?void 0:l.message)||s.message,requestDetails:{url:`staff/${e}/employment-status`,method:"PATCH",payload:{employmentStatus:r},authStatus:n,userRoles:a},timestamp:new Date().toISOString()}),s})},delete:e=>De.delete(`staff/${e}`)},EB=["TEACHER","PRINCIPAL","ADMIN_OFFICER","MANAGEMENT","ACCOUNT_OFFICER","LIBRARIAN"],TB=["Mathematics","Science","English","Social Studies","Physical Education","Arts","Music","Computer Science","Languages"],kB=["A+","A-","B+","B-","AB+","AB-","O+","O-"],AB=({open:e,onClose:r,onSubmit:t,initialData:n,loading:a})=>{var m,g,v,y,b;const[s,i]=C.useState(n||{staffId:"",firstName:"",lastName:"",email:"",phoneNumber:"",address:"",dateOfBirth:"",gender:"MALE",joinDate:new Date().toISOString().split("T")[0],role:"TEACHER",isActive:!0,qualifications:"",bloodGroup:"",pfUAN:"",gratuity:"",serviceEndDate:"",basicSalary:0,hra:0,da:0,ta:0,otherAllowances:0,pfContribution:0,taxDeduction:0,netSalary:0,salaryAccountNumber:"",bankName:"",ifscCode:"",teacherDetails:{department:"",specialization:"",subjects:"",teachingExperience:0,isClassTeacher:!1}}),[c,l]=C.useState({}),u=S=>I=>{i(k=>({...k,[S]:I.target.value})),c[S]&&l(k=>({...k,[S]:""}))},d=S=>I=>{i(k=>({...k,teacherDetails:{...k.teacherDetails,[S]:I.target.value}})),c[`teacherDetails.${S}`]&&l(k=>({...k,[`teacherDetails.${S}`]:""}))},f=S=>I=>{i(k=>({...k,teacherDetails:{...k.teacherDetails,[S]:I.target.checked}}))},h=()=>{var I,k;const S={};return s.firstName||(S.firstName="First name is required"),s.lastName||(S.lastName="Last name is required"),s.staffId||(S.staffId="Staff ID is required"),s.email?/^\S+@\S+\.\S+$/.test(s.email)||(S.email="Invalid email format"):S.email="Email is required",s.phoneNumber?/^\+?[\d\s-]{10,}$/.test(s.phoneNumber)||(S.phoneNumber="Invalid phone number"):S.phoneNumber="Phone number is required",s.pfUAN&&!/^[a-zA-Z0-9]+$/.test(s.pfUAN)&&(S.pfUAN="PF UAN must be alphanumeric only"),s.gratuity&&!/^[a-zA-Z0-9]+$/.test(s.gratuity)&&(S.gratuity="Gratuity must be alphanumeric only"),s.role==="TEACHER"&&((I=s.teacherDetails)!=null&&I.department||(S["teacherDetails.department"]="Department is required"),(k=s.teacherDetails)!=null&&k.subjects||(S["teacherDetails.subjects"]="At least one subject is required")),l(S),Object.keys(S).length===0},x=()=>{var I,k,E,T,w,F,P,A;if(!h())return;const S={id:s.id||0,staffId:s.staffId||"",firstName:s.firstName||"",lastName:s.lastName||"",fullName:`${s.firstName||""} ${s.lastName||""}`.trim(),email:s.email||"",phoneNumber:s.phoneNumber||"",address:s.address||"",dateOfBirth:s.dateOfBirth||"",gender:s.gender||"MALE",joinDate:s.joinDate||new Date().toISOString().split("T")[0],role:s.role||"TEACHER",isActive:s.isActive!==void 0?s.isActive:!0,qualifications:s.qualifications||"",emergencyContact:s.emergencyContact||"",bloodGroup:s.bloodGroup||"",profileImage:s.profileImage||"",designations:[],pfUAN:s.pfUAN||"",gratuity:s.gratuity||"",serviceEndDate:s.serviceEndDate||"",basicSalary:s.basicSalary||0,hra:s.hra||0,da:s.da||0,ta:s.ta||0,otherAllowances:s.otherAllowances||0,pfContribution:s.pfContribution||0,taxDeduction:s.taxDeduction||0,netSalary:s.netSalary||0,salaryAccountNumber:s.salaryAccountNumber||"",bankName:s.bankName||"",ifscCode:s.ifscCode||""};S.role==="TEACHER"&&(S.teacherDetails={id:((I=s.teacherDetails)==null?void 0:I.id)||0,department:((k=s.teacherDetails)==null?void 0:k.department)||"",specialization:((E=s.teacherDetails)==null?void 0:E.specialization)||"",subjects:((T=s.teacherDetails)==null?void 0:T.subjects)||"",teachingExperience:((w=s.teacherDetails)==null?void 0:w.teachingExperience)||0,isClassTeacher:((F=s.teacherDetails)==null?void 0:F.isClassTeacher)||!1,classAssignedId:((P=s.teacherDetails)==null?void 0:P.classAssignedId)||0,className:((A=s.teacherDetails)==null?void 0:A.className)||""}),t(S)},p=s.role==="TEACHER";return o.jsx(Fc,{open:e,onClose:r,title:n?"Edit Staff Member":"Add Staff Member",onSubmit:x,submitLabel:n?"Update":"Create",loading:a,maxWidth:"md",children:o.jsxs(X,{container:!0,spacing:2,children:[o.jsxs(X,{item:!0,xs:12,children:[o.jsx(te,{variant:"h6",children:"Personal Information"}),o.jsx(vr,{sx:{mb:2}})]}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"First Name",value:s.firstName,onChange:u("firstName"),error:!!c.firstName,helperText:c.firstName,required:!0})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Last Name",value:s.lastName,onChange:u("lastName"),error:!!c.lastName,helperText:c.lastName,required:!0})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Staff ID",value:s.staffId,onChange:u("staffId"),error:!!c.staffId,helperText:c.staffId,required:!0,disabled:!!(n!=null&&n.id)})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsxs(Tt,{fullWidth:!0,required:!0,children:[o.jsx(Wt,{children:"Role"}),o.jsx(It,{value:s.role||"TEACHER",onChange:u("role"),label:"Role",children:EB.map(S=>o.jsx(Xe,{value:S,children:S.replace("_"," ")},S))})]})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Email",type:"email",value:s.email,onChange:u("email"),error:!!c.email,helperText:c.email,required:!0})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Phone Number",value:s.phoneNumber,onChange:u("phoneNumber"),error:!!c.phoneNumber,helperText:c.phoneNumber,required:!0})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Date of Birth",type:"date",value:s.dateOfBirth,onChange:u("dateOfBirth"),InputLabelProps:{shrink:!0}})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsxs(Tt,{fullWidth:!0,children:[o.jsx(Wt,{children:"Gender"}),o.jsxs(It,{value:s.gender||"MALE",onChange:u("gender"),label:"Gender",children:[o.jsx(Xe,{value:"MALE",children:"Male"}),o.jsx(Xe,{value:"FEMALE",children:"Female"}),o.jsx(Xe,{value:"OTHER",children:"Other"})]})]})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Join Date",type:"date",value:s.joinDate,onChange:u("joinDate"),InputLabelProps:{shrink:!0},required:!0})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsxs(Tt,{fullWidth:!0,children:[o.jsx(Wt,{children:"Blood Group"}),o.jsx(It,{value:s.bloodGroup||"",onChange:u("bloodGroup"),label:"Blood Group",children:kB.map(S=>o.jsx(Xe,{value:S,children:S},S))})]})}),o.jsx(X,{item:!0,xs:12,children:o.jsx(ke,{fullWidth:!0,label:"Qualifications",multiline:!0,rows:2,value:s.qualifications,onChange:u("qualifications"),placeholder:"E.g., Bachelor of Education, Master's in Mathematics"})}),o.jsx(X,{item:!0,xs:12,children:o.jsx(ke,{fullWidth:!0,label:"Address",multiline:!0,rows:2,value:s.address,onChange:u("address")})}),o.jsx(X,{item:!0,xs:12,children:o.jsx(ke,{fullWidth:!0,label:"Emergency Contact",value:s.emergencyContact,onChange:u("emergencyContact")})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"PF UAN",value:s.pfUAN,onChange:u("pfUAN"),placeholder:"Enter PF UAN"})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Gratuity",value:s.gratuity,onChange:u("gratuity"),placeholder:"Enter Gratuity"})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Service End Date",type:"date",value:s.serviceEndDate,onChange:u("serviceEndDate"),InputLabelProps:{shrink:!0}})}),o.jsxs(X,{item:!0,xs:12,children:[o.jsx(te,{variant:"h6",sx:{mt:2},children:"Salary Details"}),o.jsx(vr,{sx:{mb:2}})]}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Basic Salary",type:"number",value:s.basicSalary,onChange:u("basicSalary"),InputProps:{inputProps:{min:0}}})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"HRA",type:"number",value:s.hra,onChange:u("hra"),InputProps:{inputProps:{min:0}}})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"DA",type:"number",value:s.da,onChange:u("da"),InputProps:{inputProps:{min:0}}})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"TA",type:"number",value:s.ta,onChange:u("ta"),InputProps:{inputProps:{min:0}}})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Other Allowances",type:"number",value:s.otherAllowances,onChange:u("otherAllowances"),InputProps:{inputProps:{min:0}}})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"PF Contribution",type:"number",value:s.pfContribution,onChange:u("pfContribution"),InputProps:{inputProps:{min:0}}})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Tax Deduction",type:"number",value:s.taxDeduction,onChange:u("taxDeduction"),InputProps:{inputProps:{min:0}}})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Net Salary",type:"number",value:s.netSalary,onChange:u("netSalary"),InputProps:{inputProps:{min:0}}})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Salary Account Number",value:s.salaryAccountNumber,onChange:u("salaryAccountNumber")})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Bank Name",value:s.bankName,onChange:u("bankName")})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"IFSC Code",value:s.ifscCode,onChange:u("ifscCode")})}),p&&o.jsxs(o.Fragment,{children:[o.jsxs(X,{item:!0,xs:12,children:[o.jsx(te,{variant:"h6",sx:{mt:2},children:"Teacher Details"}),o.jsx(vr,{sx:{mb:2}})]}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsxs(Tt,{fullWidth:!0,error:!!c["teacherDetails.department"],children:[o.jsx(Wt,{children:"Department"}),o.jsx(It,{value:((m=s.teacherDetails)==null?void 0:m.department)||"",onChange:d("department"),label:"Department",required:!0,children:TB.map(S=>o.jsx(Xe,{value:S,children:S},S))}),c["teacherDetails.department"]&&o.jsx(rs,{children:c["teacherDetails.department"]})]})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Specialization",value:(g=s.teacherDetails)==null?void 0:g.specialization,onChange:d("specialization"),placeholder:"E.g., Calculus, Algebra, Literature"})}),o.jsx(X,{item:!0,xs:12,children:o.jsx(ke,{fullWidth:!0,label:"Subjects",value:(v=s.teacherDetails)==null?void 0:v.subjects,onChange:d("subjects"),error:!!c["teacherDetails.subjects"],helperText:c["teacherDetails.subjects"]||"Enter comma-separated subjects, e.g., 'Mathematics, Physics'",required:!0})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsx(ke,{fullWidth:!0,label:"Teaching Experience (years)",type:"number",value:((y=s.teacherDetails)==null?void 0:y.teachingExperience)||0,onChange:d("teachingExperience"),InputProps:{inputProps:{min:0}}})}),o.jsx(X,{item:!0,xs:12,sm:6,children:o.jsxs(Tt,{fullWidth:!0,children:[o.jsx(Wt,{children:"Class Teacher"}),o.jsxs(It,{value:(b=s.teacherDetails)!=null&&b.isClassTeacher?"yes":"no",onChange:S=>{f("isClassTeacher")({target:{checked:String(S.target.value)==="yes"}})},label:"Class Teacher",children:[o.jsx(Xe,{value:"yes",children:"Yes"}),o.jsx(Xe,{value:"no",children:"No"})]})]})})]})]})})};var lf={},CB=At;Object.defineProperty(lf,"__esModule",{value:!0});var uv=lf.default=void 0,_B=CB(_t()),DB=o;uv=lf.default=(0,_B.default)((0,DB.jsx)("path",{d:"M11 18h2v-2h-2zm1-16C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8m0-14c-2.21 0-4 1.79-4 4h2c0-1.1.9-2 2-2s2 .9 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5 0-2.21-1.79-4-4-4"}),"HelpOutline");const FB=["staffId","firstName","lastName","email","phoneNumber","role","joinDate"],IB=`staffId,firstName,lastName,email,phoneNumber,role,joinDate,address,dateOfBirth,gender,qualifications,emergencyContact,bloodGroup,isActive
EMP001,John,Smith,john.smith@example.com,1234567890,Teacher,2022-05-15,123 Main St,1985-03-20,MALE,B.Ed in Mathematics,9876543210,A+,true
EMP002,Jane,Doe,jane.doe@example.com,9876543210,Librarian,2021-06-10,456 Elm St,1990-07-12,FEMALE,Master in Library Science,1234567890,O+,true
EMP003,Robert,Johnson,robert.johnson@example.com,5551234567,Admin Officer,2020-03-15,789 Oak Ave,1982-11-30,MALE,MBA,7778889999,B-,true`,PB=({open:e,onClose:r,onSubmit:t,loading:n})=>{const[a,s]=C.useState(""),[i,c]=C.useState([]),[l,u]=C.useState([]),[d,f]=C.useState("initial"),[h,x]=C.useState(""),p=C.useRef(null),m=k=>{s(k.target.value),f("initial"),c([]),u([]),x("")},g=(k,E)=>{const T=[];FB.forEach(F=>{k[F]||T.push({index:E,field:F,message:`Missing required field: ${F}`})}),k.email&&!/^\S+@\S+\.\S+$/.test(k.email)&&T.push({index:E,field:"email",message:"Invalid email format"});const w=["Teacher","Principal","Admin Officer","Management","Account Officer","Librarian"];return k.role&&!w.includes(k.role)&&T.push({index:E,field:"role",message:`Invalid role: ${k.role}. Must be one of: ${w.join(", ")}`}),k.joinDate&&!/^\d{4}-\d{2}-\d{2}$/.test(k.joinDate)&&T.push({index:E,field:"joinDate",message:"Invalid date format for joinDate. Use YYYY-MM-DD"}),k.dateOfBirth&&!/^\d{4}-\d{2}-\d{2}$/.test(k.dateOfBirth)&&T.push({index:E,field:"dateOfBirth",message:"Invalid date format for dateOfBirth. Use YYYY-MM-DD"}),T},v=()=>{try{const k=lm.parse(a,{header:!0,skipEmptyLines:!0});if(k.errors.length>0){u(k.errors.map((w,F)=>({index:F,field:"csv",message:w.message}))),f("error");return}const E=k.data,T=[];if(E.forEach((w,F)=>{const P=g(w,F);T.push(...P)}),T.length>0)u(T),f("error");else{const w=E.map(F=>({...F,isActive:typeof F.isActive=="string"&&F.isActive?String(F.isActive).toLowerCase()==="true":!!F.isActive}));c(w),f("success")}}catch(k){console.error("Error parsing CSV:",k),u([{index:0,field:"csv",message:"Failed to parse CSV: "+(k instanceof Error?k.message:String(k))}]),f("error")}},y=async()=>{if(!(i.length===0||d!=="success"))try{await t(i),s(""),c([]),f("initial"),x("")}catch(k){console.error("Failed to submit staff data:",k)}},b=()=>{const k=new Blob([IB],{type:"text/csv;charset=utf-8;"}),E=document.createElement("a");E.href=URL.createObjectURL(k),E.setAttribute("download","staff_upload_template.csv"),document.body.appendChild(E),E.click(),document.body.removeChild(E)},S=()=>{p.current&&p.current.click()},I=k=>{var w;const E=(w=k.target.files)==null?void 0:w[0];if(!E)return;x(E.name);const T=new FileReader;T.onload=F=>{var A;const P=(A=F.target)==null?void 0:A.result;try{if(E.name.endsWith(".xlsx")||E.name.endsWith(".xls")){const L=lc(P,{type:"binary"}),Y=L.SheetNames[0],q=L.Sheets[Y],Q=zx.sheet_to_csv(q);s(Q)}else if(E.name.endsWith(".csv"))s(P);else throw new Error("Unsupported file format. Please use CSV, XLSX, or XLS files.");f("initial"),c([]),u([])}catch(L){console.error("Error reading file:",L),u([{index:0,field:"file",message:"Failed to read file: "+(L instanceof Error?L.message:String(L))}]),f("error")}},E.name.endsWith(".csv")?T.readAsText(E):T.readAsBinaryString(E),k.target&&(k.target.value="")};return o.jsxs(kr,{open:e,onClose:r,maxWidth:"md",fullWidth:!0,children:[o.jsx(Xr,{children:"Bulk Staff Upload"}),o.jsxs(Rr,{children:[o.jsxs(Se,{sx:{mb:2},children:[o.jsx(te,{variant:"body1",gutterBottom:!0,children:"Upload your CSV/Excel file or paste CSV data below to add or update multiple staff members at once."}),o.jsx(te,{variant:"body2",color:"text.secondary",children:"Required fields: Staff ID, First Name, Last Name, Email, Phone Number, Role, and Join Date"})]}),o.jsxs(Se,{sx:{mb:2,display:"flex",gap:1},children:[o.jsx(at,{title:"Download sample CSV template",children:o.jsx(Me,{variant:"outlined",size:"small",onClick:b,startIcon:o.jsx(ju,{}),children:"Download Template"})}),o.jsx("input",{type:"file",accept:".csv,.xlsx,.xls",style:{display:"none"},ref:p,onChange:I}),o.jsx(at,{title:"Upload CSV or Excel file",children:o.jsx(Me,{variant:"contained",size:"small",onClick:S,startIcon:o.jsx(Nu,{}),color:"primary",children:"Upload File"})}),o.jsx(at,{title:"Staff roles must be one of: Teacher, Principal, Admin Officer, Management, Account Officer, or Librarian",children:o.jsx(Ze,{size:"small",color:"info",children:o.jsx(uv,{})})})]}),h&&o.jsxs(jr,{severity:"info",sx:{mb:2},children:["File loaded: ",h]}),o.jsx(ke,{label:"CSV Data",multiline:!0,rows:10,value:a,onChange:m,fullWidth:!0,variant:"outlined",placeholder:"staffId,firstName,lastName,email,phoneNumber,role,joinDate,address,dateOfBirth,gender,qualifications,emergencyContact,bloodGroup,isActive",sx:{mb:2}}),o.jsx(Se,{sx:{mb:2},children:o.jsx(Me,{variant:"contained",color:"secondary",onClick:v,disabled:!a.trim()||n,children:"Parse Data"})}),d==="success"&&o.jsxs(jr,{severity:"success",sx:{mb:2},children:[o.jsx($i,{children:"Data Successfully Parsed"}),"Found ",i.length," valid staff records ready to be imported."]}),d==="error"&&o.jsxs(jr,{severity:"error",sx:{mb:2},children:[o.jsx($i,{children:"Validation Errors"}),o.jsx(Se,{component:"ul",sx:{pl:2,mt:1},children:l.map((k,E)=>o.jsx("li",{children:`Row ${k.index+1}, ${k.field}: ${k.message}`},E))})]}),i.length>0&&o.jsxs(st,{variant:"outlined",sx:{p:2,mt:2,maxHeight:"200px",overflow:"auto"},children:[o.jsxs(te,{variant:"subtitle1",gutterBottom:!0,children:["Preview of Parsed Data (",i.length," staff members)"]}),o.jsx(vr,{sx:{mb:2}}),i.slice(0,5).map((k,E)=>o.jsx(Se,{sx:{mb:1,p:1,bgcolor:"background.paper"},children:o.jsxs(te,{variant:"body2",children:[o.jsx("strong",{children:"ID:"})," ",k.staffId,",",o.jsx("strong",{children:" Name:"})," ",k.firstName," ",k.lastName,",",o.jsx("strong",{children:" Role:"})," ",k.role,",",o.jsx("strong",{children:" Email:"})," ",k.email,o.jsx("strong",{children:" Status:"})," ",k.isActive?"Active":"Inactive"]})},E)),i.length>5&&o.jsx(Yt,{label:`${i.length-5} more staff members`,size:"small",sx:{mt:1}})]})]}),o.jsxs(Nr,{children:[o.jsx(Me,{onClick:r,disabled:n,children:"Cancel"}),o.jsx(Me,{onClick:y,color:"primary",disabled:i.length===0||d!=="success"||n,startIcon:n?o.jsx(ta,{size:20}):o.jsx(Pu,{}),children:n?"Importing...":"Import Staff Data"})]})]})};var uf={},OB=At;Object.defineProperty(uf,"__esModule",{value:!0});var dv=uf.default=void 0,jB=OB(_t()),RB=o;dv=uf.default=(0,jB.default)((0,RB.jsx)("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"}),"Refresh");var df={},NB=At;Object.defineProperty(df,"__esModule",{value:!0});var mu=df.default=void 0,MB=NB(_t()),LB=o;mu=df.default=(0,MB.default)((0,LB.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-2h2zm0-4h-2V7h2z"}),"Error");const BB=()=>{const[e,r]=C.useState(!1),[t,n]=C.useState(null),[a,s]=C.useState(0),i=()=>s(l=>l+1);Mn.useEffect(()=>{const l=localStorage.getItem("token");if(l)try{const u=l.split(".");if(u.length!==3){n({error:"Invalid token format"});return}const d=JSON.parse(atob(u[1])),f=Math.floor(Date.now()/1e3),h=d.exp&&d.exp<f;n({...d,isExpired:h,expiresIn:d.exp?new Date(d.exp*1e3).toLocaleString():"Unknown",decodedPayload:d})}catch(u){const d=u&&typeof u=="object"&&"message"in u&&typeof u.message=="string"?u.message:"Unknown error";n({error:"Failed to decode token",details:d})}else n({error:"No token found in localStorage"})},[a]);const c=Mn.useMemo(()=>{const l=localStorage.getItem("user");if(!l)return{error:"No user data found"};try{return JSON.parse(l)}catch(u){return{error:"Failed to parse user data",details:u&&typeof u=="object"&&"message"in u&&typeof u.message=="string"?u.message:"Unknown error"}}},[a]);return o.jsxs(Ra,{expanded:e,onChange:()=>r(!e),sx:{mb:2,border:"1px solid #ddd"},children:[o.jsx(Na,{expandIcon:o.jsx(la,{}),children:o.jsxs(Se,{sx:{display:"flex",alignItems:"center",width:"100%",justifyContent:"space-between"},children:[o.jsx(te,{variant:"subtitle1",children:"Authentication Debugger"}),t!=null&&t.isExpired?o.jsx(Yt,{icon:o.jsx(mu,{}),label:"Token Expired",color:"error",size:"small"}):t!=null&&t.error?o.jsx(Yt,{icon:o.jsx(mu,{}),label:"Auth Error",color:"error",size:"small"}):o.jsx(Yt,{icon:o.jsx(Cu,{}),label:"Token Valid",color:"success",size:"small"})]})}),o.jsxs(Ma,{children:[o.jsx(Se,{sx:{mb:1},children:o.jsx(Me,{size:"small",startIcon:o.jsx(dv,{}),onClick:i,variant:"outlined",sx:{mb:2},children:"Refresh Auth Data"})}),o.jsx(te,{variant:"subtitle2",sx:{fontWeight:"bold",mb:1},children:"User Information:"}),o.jsx(st,{sx:{p:1,mb:2,bgcolor:"#f8f9fa",overflowX:"auto"},children:o.jsx("pre",{style:{margin:0},children:JSON.stringify(c,null,2)})}),o.jsx(te,{variant:"subtitle2",sx:{fontWeight:"bold",mb:1},children:"Token Information:"}),o.jsx(st,{sx:{p:1,mb:2,bgcolor:"#f8f9fa",overflowX:"auto"},children:o.jsx("pre",{style:{margin:0},children:JSON.stringify(t,null,2)})}),(t==null?void 0:t.isExpired)&&o.jsxs(te,{color:"error",variant:"body2",children:["Your token has expired at ",t.expiresIn,". You need to log in again."]}),(t==null?void 0:t.error)&&o.jsxs(te,{color:"error",variant:"body2",children:["Authentication error: ",t.error]}),o.jsx(te,{variant:"caption",color:"textSecondary",children:"This debugger is intended for development use only"})]})]})},$B=()=>{const[e,r]=C.useState(!1),[t,n]=C.useState(!1),[a,s]=C.useState(!1),[i,c]=C.useState(void 0),[l,u]=C.useState(null),{showNotification:d}=sn(),{user:f}=kn();C.useEffect(()=>{console.log("Current user:",f),console.log("Has MANAGE_STAFF permission:",f&&f.role?rr(f.role,"MANAGE_STAFF"):!1)},[f]);const{data:h,loading:x,error:p,refresh:m}=Nn(()=>Fa.getAll(),{cacheKey:"staffList"}),{mutate:g,loading:v}=Pr(j=>Fa.create(j),{onSuccess:()=>{d({type:"success",message:"Staff member created successfully"}),r(!1),m()},onError:j=>{d({type:"error",message:`Failed to create staff member: ${j.message}`})}}),{mutate:y,loading:b}=Pr(j=>Fa.bulkCreate(j),{onSuccess:j=>{const{created:_,updated:ae,errors:oe}=j;oe&&oe.length>0?d({type:"warning",message:`Partially completed: Created ${_}, Updated ${ae}, Failed ${oe.length} records`}):d({type:"success",message:`Successfully imported staff data: Created ${_}, Updated ${ae} records`}),n(!1),m()},onError:j=>{d({type:"error",message:`Failed to import staff data: ${j.message}`})}}),{mutate:S,loading:I}=Pr(j=>Fa.update(j.id,j),{onSuccess:()=>{d({type:"success",message:"Staff member updated successfully"}),r(!1),c(void 0),m()},onError:j=>{d({type:"error",message:`Failed to update staff member: ${j.message}`})}}),{mutate:k,loading:E}=Pr(j=>Fa.delete(j),{onSuccess:()=>{d({type:"success",message:"Staff member deleted successfully"}),s(!1),c(void 0),m()},onError:j=>{d({type:"error",message:`Failed to delete staff member: ${j.message}`})}});Pr(j=>{const _={isActive:j.isActive};return Fa.update(j.id,_)},{onSuccess:()=>{d({type:"success",message:"Staff status updated successfully"}),m()},onError:j=>{d({type:"error",message:`Failed to update staff status: ${j.message}`})}});const{mutate:T,loading:w}=Pr(j=>(console.log("Attempting to update employment status with:",{staffId:j.id,newStatus:j.status,currentTime:new Date().toISOString()}),Fa.updateEmploymentStatus(j.id,j.status)),{onSuccess:j=>{console.log("Employment status update succeeded:",{result:j,timestamp:new Date().toISOString()}),d({type:"success",message:"Employment status updated successfully"}),m()},onError:j=>{console.error("Employment status update failed:",{error:j,timestamp:new Date().toISOString()}),d({type:"error",message:`Failed to update employment status: ${j.message}`})}}),F=async(j,_)=>{if(console.log(`[DEBUG] [${new Date().toISOString()}] Attempting to update employment status for staff ID: ${j} to ${_}`),!Hb()){console.error(`[DEBUG] [${new Date().toISOString()}] Permission denied: User lacks required role (ADMIN or HR_MANAGER) for staff status updates`),P(),d({type:"error",message:"You don't have permission to update employment status. This action requires ADMIN or HR_MANAGER role."});return}console.log(`[DEBUG] [${new Date().toISOString()}] Permission check passed. User has ADMIN or HR_MANAGER role.`);try{console.log(`[DEBUG] [${new Date().toISOString()}] Calling staffService.updateEmploymentStatus with ID: ${j}, status: ${_}`);try{const ae=localStorage.getItem("token");if(ae){const oe=Wb(ae);console.log("[DEBUG] Auth token details before request:",{exp:new Date(oe.exp*1e3).toISOString(),roles:oe.roles||oe.authorities,sub:oe.sub,tokenLength:ae.length,tokenPrefix:ae.substring(0,15)+"..."})}else console.error("[DEBUG] No authentication token found in localStorage")}catch(ae){console.error("[DEBUG] Error parsing authentication token:",ae)}await T({id:j,status:_}),console.log(`[DEBUG] [${new Date().toISOString()}] Employment status update successful for staff ID: ${j}`)}catch(ae){console.error(`[DEBUG] [${new Date().toISOString()}] Error occurred while updating employment status:`,ae),ae.response?(console.error("[DEBUG] Server response error details:",{status:ae.response.status,statusText:ae.response.statusText,headers:ae.response.headers,data:ae.response.data}),ae.response.status===403&&(console.error("[DEBUG] 403 Forbidden error detected. Possible causes:"),console.error("1. Token expired during the request"),console.error("2. Token does not contain required roles (ADMIN or HR_MANAGER)"),console.error("3. Backend permission check differs from frontend"),P())):ae.request?console.error("[DEBUG] Request was made but no response received:",ae.request):console.error("[DEBUG] Error setting up the request:",ae.message)}},P=()=>{var j;return f?(console.log("Debug: User permissions check",{userId:f.id,userName:(f==null?void 0:f.username)||"unknown",userRole:(f==null?void 0:f.role)||"none",token:localStorage.getItem("token")?"Present (first 10 chars): "+((j=localStorage.getItem("token"))==null?void 0:j.substring(0,10))+"...":"Missing",hasManageStaff:f!=null&&f.role?rr(f.role,"MANAGE_STAFF"):!1,timestamp:new Date().toISOString()}),f!=null&&f.role?rr(f.role,"MANAGE_STAFF"):!1):(console.log("Debug: No user is logged in"),!1)};C.useEffect(()=>{P()},[f]);const A=j=>{P(),c(j),r(!0)},L=j=>{P(),c(j),s(!0)},Y=()=>{r(!1),c(void 0)},q=()=>{n(!1)},Q=()=>{i!=null&&i.id&&k(i.id)},K=async j=>{i!=null&&i.id?await S({...j,id:i.id}):await g(j)},ye=async j=>{await y(j)},U=(j,_)=>{console.log("Status change requested:",{staffId:j.id,staffName:`${j.firstName} ${j.lastName}`,currentStatus:j.employmentStatus,requestedStatus:_,timestamp:new Date().toISOString()});const ae=P();if(!f){console.error("Permission denied: No authenticated user"),d({type:"error",message:"Authentication required: Please log in again"}),m();return}if(!ae){console.error(`Permission denied: User role ${f.role} does not have MANAGE_STAFF permission`),d({type:"error",message:"You do not have permission to update employment status"}),m();return}j.id&&(console.log(`Proceeding with status update for staff ${j.id} to ${_}`),F(j.id,_))},me=j=>{if(!j)return"default";switch(j){case fr.ACTIVE:return"success";case fr.ON_LEAVE:case fr.SUSPENDED:return"warning";case fr.TERMINATED:case fr.RETIRED:case fr.RESIGNED:return"error";default:return"default"}},J=j=>j==null?void 0:j.replace(/_/g," "),D=j=>{var _;return j.role!=="TEACHER"||!((_=j.teacherDetails)!=null&&_.subjects)?"":j.teacherDetails.subjects},B=j=>{if(!j)return"";const _=j.firstName?j.firstName.charAt(0):"",ae=j.lastName?j.lastName.charAt(0):"";return`${_}${ae}`.toUpperCase()},V=j=>`${j.firstName||""} ${j.lastName||""}`,W=j=>{switch(j){case"TEACHER":return"#2196f3";case"PRINCIPAL":return"#9c27b0";case"ADMIN_OFFICER":return"#4caf50";case"MANAGEMENT":return"#ff9800";case"ACCOUNT_OFFICER":return"#f44336";case"LIBRARIAN":return"#795548";default:return"#9e9e9e"}},Z={Teacher:"primary",Principal:"secondary","Admin Officer":"info",Management:"warning","Account Officer":"error",Librarian:"success"},fe=C.useMemo(()=>h?!l||l==="Total"?h:l==="Active"?h.filter(j=>j.isActive):h.filter(j=>j.role.replace("_"," ").toUpperCase()===l.toUpperCase()||j.role.toUpperCase()===l.replace(" ","_").toUpperCase()):[],[h,l]),ne=C.useMemo(()=>{if(!h)return[];const j=[{label:"Total",count:h.length,color:"default"},{label:"Active",count:h.filter(_=>_.isActive).length,color:"success"}];return Object.keys(Z).forEach(_=>{const ae=h.filter(oe=>oe.role===_.toUpperCase().replace(" ","_")||oe.role===_).length;j.push({label:_,count:ae,color:Z[_]})}),j},[h]),ee=j=>{u(l===j?null:j)},se=[{id:"name",label:"Name",sortable:!0,format:(j,_)=>o.jsxs(Se,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[o.jsx(gp,{sx:{bgcolor:W(_.role),width:35,height:35,fontSize:"0.9rem"},children:B(_)}),o.jsx(te,{variant:"body2",children:V(_)})]})},{id:"staffId",label:"Staff ID",sortable:!0},{id:"role",label:"Role",sortable:!0,format:j=>o.jsx(Yt,{label:J(j),size:"small",color:j==="TEACHER"?"primary":"default",variant:j==="TEACHER"?"filled":"outlined"})},{id:"department",label:"Department",sortable:!0,format:(j,_)=>{var ae;return _.role==="TEACHER"?(ae=_.teacherDetails)==null?void 0:ae.department:"-"}},{id:"subjects",label:"Subjects",sortable:!1,format:(j,_)=>{const ae=D(_);return ae?o.jsx(Se,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:ae.split(",").map((oe,Te)=>o.jsx(Yt,{label:oe.trim(),size:"small",variant:"outlined"},Te))}):"-"}},{id:"email",label:"Email",sortable:!0},{id:"phoneNumber",label:"Contact",sortable:!0},{id:"isActive",label:"Status",sortable:!0,format:(j,_)=>rr((f==null?void 0:f.role)||"","MANAGE_STAFF")?o.jsx(Tt,{size:"small",fullWidth:!0,children:o.jsx(It,{value:_.employmentStatus||fr.ACTIVE,onChange:ae=>U(_,ae.target.value),disabled:w,variant:"standard",sx:{"& .MuiSelect-select":{py:0,color:()=>{switch(_.employmentStatus){case fr.ACTIVE:return"success.main";case fr.ON_LEAVE:case fr.SUSPENDED:return"warning.main";case fr.TERMINATED:case fr.RETIRED:case fr.RESIGNED:return"error.main";default:return"text.primary"}}}},children:Object.values(fr).map(ae=>o.jsx(Xe,{value:ae,children:ae.replace("_"," ")},ae))})}):o.jsx(Yt,{label:(_.employmentStatus||fr.ACTIVE).replace("_"," "),color:me(_.employmentStatus),size:"small"})},{id:"actions",label:"Actions",sortable:!1,format:(j,_)=>o.jsxs(Se,{sx:{display:"flex",gap:1},children:[rr((f==null?void 0:f.role)||"","MANAGE_STAFF")&&o.jsxs(o.Fragment,{children:[o.jsx(at,{title:"Edit",children:o.jsx(Ze,{size:"small",onClick:()=>A(_),color:"primary",children:o.jsx(no,{fontSize:"small"})})}),o.jsx(at,{title:"Delete",children:o.jsx(Ze,{size:"small",onClick:()=>L(_),color:"error",children:o.jsx(ei,{fontSize:"small"})})})]}),_.role==="TEACHER"&&o.jsxs(o.Fragment,{children:[o.jsx(at,{title:"View Schedule",children:o.jsx(Ze,{size:"small",color:"default",children:o.jsx(kp,{fontSize:"small"})})}),o.jsx(at,{title:"View Classes",children:o.jsx(Ze,{size:"small",color:"info",children:o.jsx(Xa,{fontSize:"small"})})})]}),o.jsx(at,{title:"Contact",children:o.jsx(Ze,{size:"small",color:"success",children:o.jsx(Fp,{fontSize:"small"})})})]})}];if(x&&!h)return o.jsx(Rn,{});if(p){const j=typeof p=="string"?p:(p==null?void 0:p.message)||String(p);return o.jsx(Ln,{message:j,onRetry:m})}return o.jsxs(Se,{sx:{p:3},children:[o.jsxs(Se,{sx:{mb:3,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx(te,{variant:"h4",children:"Staff Management"}),rr((f==null?void 0:f.role)||"","MANAGE_STAFF")&&o.jsxs(gc,{direction:"row",spacing:2,children:[o.jsx(Me,{variant:"outlined",color:"primary",startIcon:o.jsx(Ep,{}),onClick:()=>n(!0),children:"Bulk Upload"}),o.jsx(Me,{variant:"contained",color:"primary",startIcon:o.jsx(Gs,{}),onClick:()=>r(!0),children:"Add Staff Member"})]})]}),o.jsx(st,{sx:{p:2,mb:3},children:o.jsxs(Se,{sx:{mb:2},children:[o.jsx(te,{variant:"h6",gutterBottom:!0,children:"Staff Overview"}),o.jsx(X,{container:!0,spacing:1,children:ne.map((j,_)=>o.jsx(X,{item:!0,children:o.jsx(Yt,{label:`${j.label}: ${j.count}`,color:j.color,variant:l===j.label?"filled":"outlined",sx:{minWidth:100,cursor:"pointer",fontWeight:l===j.label?"bold":"normal"},onClick:()=>ee(j.label)})},_))}),l&&o.jsxs(Se,{sx:{mt:2,display:"flex",alignItems:"center"},children:[o.jsx(te,{variant:"body2",color:"text.secondary",mr:1,children:"Filtered by:"}),o.jsx(Yt,{label:l,size:"small",onDelete:()=>u(null)})]})]})}),o.jsx(st,{children:o.jsx(_c,{columns:se,data:fe||[],loading:x,onRefresh:m,searchPlaceholder:"Search staff...",initialSortBy:"role"})}),o.jsx(AB,{open:e,onClose:Y,onSubmit:K,initialData:i,loading:v||I}),o.jsx(PB,{open:t,onClose:q,onSubmit:ye,loading:b}),o.jsxs(kr,{open:a,onClose:()=>s(!1),children:[o.jsx(Xr,{children:"Confirm Deletion"}),o.jsx(Rr,{children:o.jsxs(Tp,{children:["Are you sure you want to delete ",i?V(i):"this staff member","? This action cannot be undone."]})}),o.jsxs(Nr,{children:[o.jsx(Me,{onClick:()=>s(!1),disabled:E,children:"Cancel"}),o.jsx(Me,{onClick:Q,color:"error",disabled:E,children:E?"Deleting...":"Delete"})]})]}),o.jsx(BB,{})]})},UB=Kv({palette:{primary:{main:"#1976d2",light:"#42a5f5",dark:"#1565c0",contrastText:"#ffffff"},secondary:{main:"#9c27b0",light:"#ba68c8",dark:"#7b1fa2",contrastText:"#ffffff"},success:{main:"#2e7d32",light:"#4caf50",dark:"#1b5e20"},warning:{main:"#ed6c02",light:"#ff9800",dark:"#e65100"},error:{main:"#d32f2f",light:"#ef5350",dark:"#c62828"},info:{main:"#0288d1",light:"#03a9f4",dark:"#01579b"}},typography:{fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif',h1:{fontSize:"2.5rem",fontWeight:500,letterSpacing:"-0.01562em"},h2:{fontSize:"2rem",fontWeight:500,letterSpacing:"-0.00833em"},h3:{fontSize:"1.75rem",fontWeight:500,letterSpacing:"0em"},h4:{fontSize:"1.5rem",fontWeight:500,letterSpacing:"0.00735em"},h5:{fontSize:"1.25rem",fontWeight:500,letterSpacing:"0em"},h6:{fontSize:"1rem",fontWeight:500,letterSpacing:"0.0075em"},button:{textTransform:"none",fontWeight:500}},components:{MuiButton:{styleOverrides:{root:{borderRadius:8},contained:{boxShadow:"none","&:hover":{boxShadow:"0px 2px 4px rgba(0,0,0,0.2)"}}}},MuiCard:{styleOverrides:{root:{borderRadius:12,boxShadow:"0px 2px 4px rgba(0,0,0,0.1)"}}},MuiDialog:{styleOverrides:{paper:{borderRadius:12}}},MuiDataGrid:{styleOverrides:{root:{border:"none","& .MuiDataGrid-cell:focus":{outline:"none"}}}}}});class mp extends Mn.Component{constructor(r){super(r),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(r,t){console.error("Error in component:",r,t)}render(){return this.state.hasError?o.jsx("div",{children:"Something went wrong. Please try refreshing the page."}):this.props.children}}const Ia=({children:e})=>{const r=C.useContext(ku);return C.useEffect(()=>{console.log("ðŸ” ProtectedRoute: Auth context available:",!!r),console.log("ðŸ” ProtectedRoute: Authentication status:",r==null?void 0:r.isAuthenticated)},[r]),r!=null&&r.loading?o.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:o.jsx("div",{children:"Authenticating..."})}):r!=null&&r.isAuthenticated?o.jsx(o.Fragment,{children:e}):(console.log("ðŸš« ProtectedRoute: User not authenticated, redirecting to login"),o.jsx(Bo,{to:"/login"}))},Ur={ADMIN:"ADMIN",TEACHER:"TEACHER",STAFF:"STAFF",PARENT:"PARENT",STUDENT:"STUDENT"};function VB(){return o.jsxs(Op,{children:[o.jsx(dn,{path:"/",element:o.jsx(lv,{})}),o.jsx(dn,{path:"/login",element:o.jsx(W8,{})}),o.jsx(dn,{path:"/register",element:o.jsx(z8,{})}),o.jsx(dn,{path:"/dashboard",element:o.jsx(Ia,{children:o.jsx(ka,{children:o.jsx(nw,{})})})}),o.jsx(dn,{path:"/students",element:o.jsx(Ia,{children:o.jsx(ka,{children:o.jsx(ks,{allowedRoles:[Ur.ADMIN,Ur.TEACHER,Ur.STAFF],children:o.jsx(RD,{})})})})}),o.jsx(dn,{path:"/staff",element:o.jsx(Ia,{children:o.jsx(ka,{children:o.jsx(ks,{allowedRoles:[Ur.ADMIN],children:o.jsx($B,{})})})})}),o.jsx(dn,{path:"/courses",element:o.jsx(Ia,{children:o.jsx(ka,{children:o.jsx(ks,{allowedRoles:[Ur.ADMIN,Ur.TEACHER,Ur.STAFF],children:o.jsx(MD,{})})})})}),o.jsx(dn,{path:"/reports",element:o.jsx(Ia,{children:o.jsx(ka,{children:o.jsx(ks,{allowedRoles:[Ur.ADMIN,Ur.TEACHER,Ur.STAFF],children:o.jsx(LD,{})})})})}),o.jsx(dn,{path:"/admissions",element:o.jsx(Ia,{children:o.jsx(ka,{children:o.jsx(ks,{allowedRoles:[Ur.ADMIN,Ur.STAFF],children:o.jsx(fF,{})})})})}),o.jsx(dn,{path:"/fees",element:o.jsx(Ia,{children:o.jsx(ka,{children:o.jsx(ks,{allowedRoles:[Ur.ADMIN],children:o.jsx(V8,{})})})})})]})}function WB(){const[e,r]=C.useState(!1);return C.useEffect(()=>{console.log("ðŸ App component mounted")},[]),o.jsx(mp,{children:o.jsxs(Jv,{theme:UB,children:[o.jsx(xp,{}),o.jsx(Gb,{children:o.jsx(ty,{children:o.jsx(mp,{children:e?o.jsx(Op,{children:o.jsx(dn,{path:"*",element:o.jsx(lv,{})})}):o.jsx(Mn.Suspense,{fallback:o.jsx("div",{children:"Loading..."}),children:o.jsx(qb,{children:o.jsx(VB,{})})})})})})]})})}Nl.createRoot(document.getElementById("root")).render(o.jsx(Mn.StrictMode,{children:o.jsx(WB,{})}))});export default HB();
//# sourceMappingURL=index-56c9f2ec.js.map
