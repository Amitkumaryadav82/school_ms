var Sy=Object.defineProperty;var Ey=(e,r,t)=>r in e?Sy(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t;var Le=(e,r,t)=>(Ey(e,typeof r!="symbol"?r+"":r,t),t);import{j as i,S as yu,A as Lr,u as Ty,i as _t,T as st,B as ye,a as ee,b as rl,L as qa,d as Xa,e as Ni,f as Ka,C as wp,g as Ay,I as Ze,M as ky,h as $t,k as Sp,l as Cy,m as Ep,n as Ye,o as _y,D as yf,p as Dy,q as Fy,r as Ws,s as Mi,F as jy,t as Iy,v as sn,P as be,c as Qt,_ as Qe,w as Dt,x as ie,y as Ta,z as Ge,E as ra,G as Py,H as Hs,J as Tp,K as to,N as Ap,O as mt,Q as Tt,R as Ja,U as Ae,V as yn,W as kp,X as vu,Y as gc,Z as Oy,$ as bu,a0 as Ry,a1 as Ke,a2 as Ny,a3 as My,a4 as _r,a5 as Pe,a6 as br,a7 as vf,a8 as Dr,a9 as Br,aa as yc,ab as X,ac as gt,ad as Ly,ae as Go,af as By,ag as Qa,ah as Ol,ai as sr,aj as bf,ak as Cp,al as Za,am as _p,an as es,ao as ts,ap as $y,aq as Uy,ar as wu,as as rs,at as ya,au as va,av as Ut,aw as Re,ax as Vy,ay as ba,az as Dp,aA as Fp,aB as ca,aC as la,aD as ua,aE as Li,aF as ro,aG as Qs,aH as vc,aI as jp,aJ as zs,aK as Ip,aL as Wy,aM as Hy,aN as Pp,aO as Yo,aP as zy,aQ as Su,aR as ma,aS as wf,aT as Sf,aU as Ef,aV as Rl,aW as Nl,aX as Gy,aY as Yy,aZ as qy,a_ as Op,a$ as Xy,b0 as Ky,b1 as Jy,b2 as tn,b3 as Da,b4 as Qy,b5 as Zy,b6 as ev}from"./mui-vendor-2642d531.js";import{d as tv,r as C,u as no,a as rv,N as Lo,R as nv,g as Rp,b as An,e as Np,L as qn,B as av,f as Mp,h as pn}from"./react-vendor-c0a3892c.js";import{R as Tf,B as sv,C as iv,X as ov,Y as cv,T as Af,L as kf,a as Cf,P as lv,b as uv,c as dv}from"./chart-vendor-22102d3f.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=t(a);fetch(a.href,s)}})();var Ml={},_f=tv;Ml.createRoot=_f.createRoot,Ml.hydrateRoot=_f.hydrateRoot;const fv="modulepreload",hv=function(e){return"/"+e},Df={},Ll=function(r,t,n){if(!t||t.length===0)return r();const a=document.getElementsByTagName("link");return Promise.all(t.map(s=>{if(s=hv(s),s in Df)return;Df[s]=!0;const o=s.endsWith(".css"),c=o?'[rel="stylesheet"]':"";if(!!n)for(let d=a.length-1;d>=0;d--){const f=a[d];if(f.href===s&&(!o||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${c}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":fv,o||(u.as="script",u.crossOrigin=""),u.href=s,document.head.appendChild(u),o)return new Promise((d,f)=>{u.addEventListener("load",d),u.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>r()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})};function Lp(e,r){return function(){return e.apply(r,arguments)}}const{toString:pv}=Object.prototype,{getPrototypeOf:Eu}=Object,{iterator:bc,toStringTag:Bp}=Symbol,wc=(e=>r=>{const t=pv.call(r);return e[t]||(e[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),Cn=e=>(e=e.toLowerCase(),r=>wc(r)===e),Sc=e=>r=>typeof r===e,{isArray:Zs}=Array,Bi=Sc("undefined");function mv(e){return e!==null&&!Bi(e)&&e.constructor!==null&&!Bi(e.constructor)&&$r(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const $p=Cn("ArrayBuffer");function xv(e){let r;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?r=ArrayBuffer.isView(e):r=e&&e.buffer&&$p(e.buffer),r}const gv=Sc("string"),$r=Sc("function"),Up=Sc("number"),Ec=e=>e!==null&&typeof e=="object",yv=e=>e===!0||e===!1,Bo=e=>{if(wc(e)!=="object")return!1;const r=Eu(e);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(Bp in e)&&!(bc in e)},vv=Cn("Date"),bv=Cn("File"),wv=Cn("Blob"),Sv=Cn("FileList"),Ev=e=>Ec(e)&&$r(e.pipe),Tv=e=>{let r;return e&&(typeof FormData=="function"&&e instanceof FormData||$r(e.append)&&((r=wc(e))==="formdata"||r==="object"&&$r(e.toString)&&e.toString()==="[object FormData]"))},Av=Cn("URLSearchParams"),[kv,Cv,_v,Dv]=["ReadableStream","Request","Response","Headers"].map(Cn),Fv=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function ao(e,r,{allOwnKeys:t=!1}={}){if(e===null||typeof e>"u")return;let n,a;if(typeof e!="object"&&(e=[e]),Zs(e))for(n=0,a=e.length;n<a;n++)r.call(null,e[n],n,e);else{const s=t?Object.getOwnPropertyNames(e):Object.keys(e),o=s.length;let c;for(n=0;n<o;n++)c=s[n],r.call(null,e[c],c,e)}}function Vp(e,r){r=r.toLowerCase();const t=Object.keys(e);let n=t.length,a;for(;n-- >0;)if(a=t[n],r===a.toLowerCase())return a;return null}const Va=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),Wp=e=>!Bi(e)&&e!==Va;function Bl(){const{caseless:e}=Wp(this)&&this||{},r={},t=(n,a)=>{const s=e&&Vp(r,a)||a;Bo(r[s])&&Bo(n)?r[s]=Bl(r[s],n):Bo(n)?r[s]=Bl({},n):Zs(n)?r[s]=n.slice():r[s]=n};for(let n=0,a=arguments.length;n<a;n++)arguments[n]&&ao(arguments[n],t);return r}const jv=(e,r,t,{allOwnKeys:n}={})=>(ao(r,(a,s)=>{t&&$r(a)?e[s]=Lp(a,t):e[s]=a},{allOwnKeys:n}),e),Iv=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Pv=(e,r,t,n)=>{e.prototype=Object.create(r.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:r.prototype}),t&&Object.assign(e.prototype,t)},Ov=(e,r,t,n)=>{let a,s,o;const c={};if(r=r||{},e==null)return r;do{for(a=Object.getOwnPropertyNames(e),s=a.length;s-- >0;)o=a[s],(!n||n(o,e,r))&&!c[o]&&(r[o]=e[o],c[o]=!0);e=t!==!1&&Eu(e)}while(e&&(!t||t(e,r))&&e!==Object.prototype);return r},Rv=(e,r,t)=>{e=String(e),(t===void 0||t>e.length)&&(t=e.length),t-=r.length;const n=e.indexOf(r,t);return n!==-1&&n===t},Nv=e=>{if(!e)return null;if(Zs(e))return e;let r=e.length;if(!Up(r))return null;const t=new Array(r);for(;r-- >0;)t[r]=e[r];return t},Mv=(e=>r=>e&&r instanceof e)(typeof Uint8Array<"u"&&Eu(Uint8Array)),Lv=(e,r)=>{const n=(e&&e[bc]).call(e);let a;for(;(a=n.next())&&!a.done;){const s=a.value;r.call(e,s[0],s[1])}},Bv=(e,r)=>{let t;const n=[];for(;(t=e.exec(r))!==null;)n.push(t);return n},$v=Cn("HTMLFormElement"),Uv=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,n,a){return n.toUpperCase()+a}),Ff=(({hasOwnProperty:e})=>(r,t)=>e.call(r,t))(Object.prototype),Vv=Cn("RegExp"),Hp=(e,r)=>{const t=Object.getOwnPropertyDescriptors(e),n={};ao(t,(a,s)=>{let o;(o=r(a,s,e))!==!1&&(n[s]=o||a)}),Object.defineProperties(e,n)},Wv=e=>{Hp(e,(r,t)=>{if($r(e)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const n=e[t];if($r(n)){if(r.enumerable=!1,"writable"in r){r.writable=!1;return}r.set||(r.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},Hv=(e,r)=>{const t={},n=a=>{a.forEach(s=>{t[s]=!0})};return Zs(e)?n(e):n(String(e).split(r)),t},zv=()=>{},Gv=(e,r)=>e!=null&&Number.isFinite(e=+e)?e:r;function Yv(e){return!!(e&&$r(e.append)&&e[Bp]==="FormData"&&e[bc])}const qv=e=>{const r=new Array(10),t=(n,a)=>{if(Ec(n)){if(r.indexOf(n)>=0)return;if(!("toJSON"in n)){r[a]=n;const s=Zs(n)?[]:{};return ao(n,(o,c)=>{const l=t(o,a+1);!Bi(l)&&(s[c]=l)}),r[a]=void 0,s}}return n};return t(e,0)},Xv=Cn("AsyncFunction"),Kv=e=>e&&(Ec(e)||$r(e))&&$r(e.then)&&$r(e.catch),zp=((e,r)=>e?setImmediate:r?((t,n)=>(Va.addEventListener("message",({source:a,data:s})=>{a===Va&&s===t&&n.length&&n.shift()()},!1),a=>{n.push(a),Va.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",$r(Va.postMessage)),Jv=typeof queueMicrotask<"u"?queueMicrotask.bind(Va):typeof process<"u"&&process.nextTick||zp,Qv=e=>e!=null&&$r(e[bc]),ve={isArray:Zs,isArrayBuffer:$p,isBuffer:mv,isFormData:Tv,isArrayBufferView:xv,isString:gv,isNumber:Up,isBoolean:yv,isObject:Ec,isPlainObject:Bo,isReadableStream:kv,isRequest:Cv,isResponse:_v,isHeaders:Dv,isUndefined:Bi,isDate:vv,isFile:bv,isBlob:wv,isRegExp:Vv,isFunction:$r,isStream:Ev,isURLSearchParams:Av,isTypedArray:Mv,isFileList:Sv,forEach:ao,merge:Bl,extend:jv,trim:Fv,stripBOM:Iv,inherits:Pv,toFlatObject:Ov,kindOf:wc,kindOfTest:Cn,endsWith:Rv,toArray:Nv,forEachEntry:Lv,matchAll:Bv,isHTMLForm:$v,hasOwnProperty:Ff,hasOwnProp:Ff,reduceDescriptors:Hp,freezeMethods:Wv,toObjectSet:Hv,toCamelCase:Uv,noop:zv,toFiniteNumber:Gv,findKey:Vp,global:Va,isContextDefined:Wp,isSpecCompliantForm:Yv,toJSONObject:qv,isAsyncFn:Xv,isThenable:Kv,setImmediate:zp,asap:Jv,isIterable:Qv};function at(e,r,t,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",r&&(this.code=r),t&&(this.config=t),n&&(this.request=n),a&&(this.response=a,this.status=a.status?a.status:null)}ve.inherits(at,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ve.toJSONObject(this.config),code:this.code,status:this.status}}});const Gp=at.prototype,Yp={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Yp[e]={value:e}});Object.defineProperties(at,Yp);Object.defineProperty(Gp,"isAxiosError",{value:!0});at.from=(e,r,t,n,a,s)=>{const o=Object.create(Gp);return ve.toFlatObject(e,o,function(l){return l!==Error.prototype},c=>c!=="isAxiosError"),at.call(o,e.message,r,t,n,a),o.cause=e,o.name=e.name,s&&Object.assign(o,s),o};const Zv=null;function $l(e){return ve.isPlainObject(e)||ve.isArray(e)}function qp(e){return ve.endsWith(e,"[]")?e.slice(0,-2):e}function jf(e,r,t){return e?e.concat(r).map(function(a,s){return a=qp(a),!t&&s?"["+a+"]":a}).join(t?".":""):r}function eb(e){return ve.isArray(e)&&!e.some($l)}const tb=ve.toFlatObject(ve,{},null,function(r){return/^is[A-Z]/.test(r)});function Tc(e,r,t){if(!ve.isObject(e))throw new TypeError("target must be an object");r=r||new FormData,t=ve.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(p,g){return!ve.isUndefined(g[p])});const n=t.metaTokens,a=t.visitor||d,s=t.dots,o=t.indexes,l=(t.Blob||typeof Blob<"u"&&Blob)&&ve.isSpecCompliantForm(r);if(!ve.isFunction(a))throw new TypeError("visitor must be a function");function u(m){if(m===null)return"";if(ve.isDate(m))return m.toISOString();if(!l&&ve.isBlob(m))throw new at("Blob is not supported. Use a Buffer instead.");return ve.isArrayBuffer(m)||ve.isTypedArray(m)?l&&typeof Blob=="function"?new Blob([m]):Buffer.from(m):m}function d(m,p,g){let w=m;if(m&&!g&&typeof m=="object"){if(ve.endsWith(p,"{}"))p=n?p:p.slice(0,-2),m=JSON.stringify(m);else if(ve.isArray(m)&&eb(m)||(ve.isFileList(m)||ve.endsWith(p,"[]"))&&(w=ve.toArray(m)))return p=qp(p),w.forEach(function(v,T){!(ve.isUndefined(v)||v===null)&&r.append(o===!0?jf([p],T,s):o===null?p:p+"[]",u(v))}),!1}return $l(m)?!0:(r.append(jf(g,p,s),u(m)),!1)}const f=[],h=Object.assign(tb,{defaultVisitor:d,convertValue:u,isVisitable:$l});function x(m,p){if(!ve.isUndefined(m)){if(f.indexOf(m)!==-1)throw Error("Circular reference detected in "+p.join("."));f.push(m),ve.forEach(m,function(w,y){(!(ve.isUndefined(w)||w===null)&&a.call(r,w,ve.isString(y)?y.trim():y,p,h))===!0&&x(w,p?p.concat(y):[y])}),f.pop()}}if(!ve.isObject(e))throw new TypeError("data must be an object");return x(e),r}function If(e){const r={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return r[n]})}function Tu(e,r){this._pairs=[],e&&Tc(e,this,r)}const Xp=Tu.prototype;Xp.append=function(r,t){this._pairs.push([r,t])};Xp.toString=function(r){const t=r?function(n){return r.call(this,n,If)}:If;return this._pairs.map(function(a){return t(a[0])+"="+t(a[1])},"").join("&")};function rb(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Kp(e,r,t){if(!r)return e;const n=t&&t.encode||rb;ve.isFunction(t)&&(t={serialize:t});const a=t&&t.serialize;let s;if(a?s=a(r,t):s=ve.isURLSearchParams(r)?r.toString():new Tu(r,t).toString(n),s){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}class nb{constructor(){this.handlers=[]}use(r,t,n){return this.handlers.push({fulfilled:r,rejected:t,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(r){this.handlers[r]&&(this.handlers[r]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(r){ve.forEach(this.handlers,function(n){n!==null&&r(n)})}}const Pf=nb,Jp={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},ab=typeof URLSearchParams<"u"?URLSearchParams:Tu,sb=typeof FormData<"u"?FormData:null,ib=typeof Blob<"u"?Blob:null,ob={isBrowser:!0,classes:{URLSearchParams:ab,FormData:sb,Blob:ib},protocols:["http","https","file","blob","url","data"]},Au=typeof window<"u"&&typeof document<"u",Ul=typeof navigator=="object"&&navigator||void 0,cb=Au&&(!Ul||["ReactNative","NativeScript","NS"].indexOf(Ul.product)<0),lb=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),ub=Au&&window.location.href||"http://localhost",db=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Au,hasStandardBrowserEnv:cb,hasStandardBrowserWebWorkerEnv:lb,navigator:Ul,origin:ub},Symbol.toStringTag,{value:"Module"})),gr={...db,...ob};function fb(e,r){return Tc(e,new gr.classes.URLSearchParams,Object.assign({visitor:function(t,n,a,s){return gr.isNode&&ve.isBuffer(t)?(this.append(n,t.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},r))}function hb(e){return ve.matchAll(/\w+|\[(\w*)]/g,e).map(r=>r[0]==="[]"?"":r[1]||r[0])}function pb(e){const r={},t=Object.keys(e);let n;const a=t.length;let s;for(n=0;n<a;n++)s=t[n],r[s]=e[s];return r}function Qp(e){function r(t,n,a,s){let o=t[s++];if(o==="__proto__")return!0;const c=Number.isFinite(+o),l=s>=t.length;return o=!o&&ve.isArray(a)?a.length:o,l?(ve.hasOwnProp(a,o)?a[o]=[a[o],n]:a[o]=n,!c):((!a[o]||!ve.isObject(a[o]))&&(a[o]=[]),r(t,n,a[o],s)&&ve.isArray(a[o])&&(a[o]=pb(a[o])),!c)}if(ve.isFormData(e)&&ve.isFunction(e.entries)){const t={};return ve.forEachEntry(e,(n,a)=>{r(hb(n),a,t,0)}),t}return null}function mb(e,r,t){if(ve.isString(e))try{return(r||JSON.parse)(e),ve.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(t||JSON.stringify)(e)}const ku={transitional:Jp,adapter:["xhr","http","fetch"],transformRequest:[function(r,t){const n=t.getContentType()||"",a=n.indexOf("application/json")>-1,s=ve.isObject(r);if(s&&ve.isHTMLForm(r)&&(r=new FormData(r)),ve.isFormData(r))return a?JSON.stringify(Qp(r)):r;if(ve.isArrayBuffer(r)||ve.isBuffer(r)||ve.isStream(r)||ve.isFile(r)||ve.isBlob(r)||ve.isReadableStream(r))return r;if(ve.isArrayBufferView(r))return r.buffer;if(ve.isURLSearchParams(r))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),r.toString();let c;if(s){if(n.indexOf("application/x-www-form-urlencoded")>-1)return fb(r,this.formSerializer).toString();if((c=ve.isFileList(r))||n.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return Tc(c?{"files[]":r}:r,l&&new l,this.formSerializer)}}return s||a?(t.setContentType("application/json",!1),mb(r)):r}],transformResponse:[function(r){const t=this.transitional||ku.transitional,n=t&&t.forcedJSONParsing,a=this.responseType==="json";if(ve.isResponse(r)||ve.isReadableStream(r))return r;if(r&&ve.isString(r)&&(n&&!this.responseType||a)){const o=!(t&&t.silentJSONParsing)&&a;try{return JSON.parse(r)}catch(c){if(o)throw c.name==="SyntaxError"?at.from(c,at.ERR_BAD_RESPONSE,this,null,this.response):c}}return r}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:gr.classes.FormData,Blob:gr.classes.Blob},validateStatus:function(r){return r>=200&&r<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ve.forEach(["delete","get","head","post","put","patch"],e=>{ku.headers[e]={}});const Cu=ku,xb=ve.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),gb=e=>{const r={};let t,n,a;return e&&e.split(`
`).forEach(function(o){a=o.indexOf(":"),t=o.substring(0,a).trim().toLowerCase(),n=o.substring(a+1).trim(),!(!t||r[t]&&xb[t])&&(t==="set-cookie"?r[t]?r[t].push(n):r[t]=[n]:r[t]=r[t]?r[t]+", "+n:n)}),r},Of=Symbol("internals");function li(e){return e&&String(e).trim().toLowerCase()}function $o(e){return e===!1||e==null?e:ve.isArray(e)?e.map($o):String(e)}function yb(e){const r=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=t.exec(e);)r[n[1]]=n[2];return r}const vb=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function nl(e,r,t,n,a){if(ve.isFunction(n))return n.call(this,r,t);if(a&&(r=t),!!ve.isString(r)){if(ve.isString(n))return r.indexOf(n)!==-1;if(ve.isRegExp(n))return n.test(r)}}function bb(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(r,t,n)=>t.toUpperCase()+n)}function wb(e,r){const t=ve.toCamelCase(" "+r);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+t,{value:function(a,s,o){return this[n].call(this,r,a,s,o)},configurable:!0})})}class Ac{constructor(r){r&&this.set(r)}set(r,t,n){const a=this;function s(c,l,u){const d=li(l);if(!d)throw new Error("header name must be a non-empty string");const f=ve.findKey(a,d);(!f||a[f]===void 0||u===!0||u===void 0&&a[f]!==!1)&&(a[f||l]=$o(c))}const o=(c,l)=>ve.forEach(c,(u,d)=>s(u,d,l));if(ve.isPlainObject(r)||r instanceof this.constructor)o(r,t);else if(ve.isString(r)&&(r=r.trim())&&!vb(r))o(gb(r),t);else if(ve.isObject(r)&&ve.isIterable(r)){let c={},l,u;for(const d of r){if(!ve.isArray(d))throw TypeError("Object iterator must return a key-value pair");c[u=d[0]]=(l=c[u])?ve.isArray(l)?[...l,d[1]]:[l,d[1]]:d[1]}o(c,t)}else r!=null&&s(t,r,n);return this}get(r,t){if(r=li(r),r){const n=ve.findKey(this,r);if(n){const a=this[n];if(!t)return a;if(t===!0)return yb(a);if(ve.isFunction(t))return t.call(this,a,n);if(ve.isRegExp(t))return t.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(r,t){if(r=li(r),r){const n=ve.findKey(this,r);return!!(n&&this[n]!==void 0&&(!t||nl(this,this[n],n,t)))}return!1}delete(r,t){const n=this;let a=!1;function s(o){if(o=li(o),o){const c=ve.findKey(n,o);c&&(!t||nl(n,n[c],c,t))&&(delete n[c],a=!0)}}return ve.isArray(r)?r.forEach(s):s(r),a}clear(r){const t=Object.keys(this);let n=t.length,a=!1;for(;n--;){const s=t[n];(!r||nl(this,this[s],s,r,!0))&&(delete this[s],a=!0)}return a}normalize(r){const t=this,n={};return ve.forEach(this,(a,s)=>{const o=ve.findKey(n,s);if(o){t[o]=$o(a),delete t[s];return}const c=r?bb(s):String(s).trim();c!==s&&delete t[s],t[c]=$o(a),n[c]=!0}),this}concat(...r){return this.constructor.concat(this,...r)}toJSON(r){const t=Object.create(null);return ve.forEach(this,(n,a)=>{n!=null&&n!==!1&&(t[a]=r&&ve.isArray(n)?n.join(", "):n)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([r,t])=>r+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(r){return r instanceof this?r:new this(r)}static concat(r,...t){const n=new this(r);return t.forEach(a=>n.set(a)),n}static accessor(r){const n=(this[Of]=this[Of]={accessors:{}}).accessors,a=this.prototype;function s(o){const c=li(o);n[c]||(wb(a,o),n[c]=!0)}return ve.isArray(r)?r.forEach(s):s(r),this}}Ac.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ve.reduceDescriptors(Ac.prototype,({value:e},r)=>{let t=r[0].toUpperCase()+r.slice(1);return{get:()=>e,set(n){this[t]=n}}});ve.freezeMethods(Ac);const En=Ac;function al(e,r){const t=this||Cu,n=r||t,a=En.from(n.headers);let s=n.data;return ve.forEach(e,function(c){s=c.call(t,s,a.normalize(),r?r.status:void 0)}),a.normalize(),s}function Zp(e){return!!(e&&e.__CANCEL__)}function ei(e,r,t){at.call(this,e??"canceled",at.ERR_CANCELED,r,t),this.name="CanceledError"}ve.inherits(ei,at,{__CANCEL__:!0});function em(e,r,t){const n=t.config.validateStatus;!t.status||!n||n(t.status)?e(t):r(new at("Request failed with status code "+t.status,[at.ERR_BAD_REQUEST,at.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function Sb(e){const r=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return r&&r[1]||""}function Eb(e,r){e=e||10;const t=new Array(e),n=new Array(e);let a=0,s=0,o;return r=r!==void 0?r:1e3,function(l){const u=Date.now(),d=n[s];o||(o=u),t[a]=l,n[a]=u;let f=s,h=0;for(;f!==a;)h+=t[f++],f=f%e;if(a=(a+1)%e,a===s&&(s=(s+1)%e),u-o<r)return;const x=d&&u-d;return x?Math.round(h*1e3/x):void 0}}function Tb(e,r){let t=0,n=1e3/r,a,s;const o=(u,d=Date.now())=>{t=d,a=null,s&&(clearTimeout(s),s=null),e.apply(null,u)};return[(...u)=>{const d=Date.now(),f=d-t;f>=n?o(u,d):(a=u,s||(s=setTimeout(()=>{s=null,o(a)},n-f)))},()=>a&&o(a)]}const qo=(e,r,t=3)=>{let n=0;const a=Eb(50,250);return Tb(s=>{const o=s.loaded,c=s.lengthComputable?s.total:void 0,l=o-n,u=a(l),d=o<=c;n=o;const f={loaded:o,total:c,progress:c?o/c:void 0,bytes:l,rate:u||void 0,estimated:u&&c&&d?(c-o)/u:void 0,event:s,lengthComputable:c!=null,[r?"download":"upload"]:!0};e(f)},t)},Rf=(e,r)=>{const t=e!=null;return[n=>r[0]({lengthComputable:t,total:e,loaded:n}),r[1]]},Nf=e=>(...r)=>ve.asap(()=>e(...r)),Ab=gr.hasStandardBrowserEnv?((e,r)=>t=>(t=new URL(t,gr.origin),e.protocol===t.protocol&&e.host===t.host&&(r||e.port===t.port)))(new URL(gr.origin),gr.navigator&&/(msie|trident)/i.test(gr.navigator.userAgent)):()=>!0,kb=gr.hasStandardBrowserEnv?{write(e,r,t,n,a,s){const o=[e+"="+encodeURIComponent(r)];ve.isNumber(t)&&o.push("expires="+new Date(t).toGMTString()),ve.isString(n)&&o.push("path="+n),ve.isString(a)&&o.push("domain="+a),s===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const r=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return r?decodeURIComponent(r[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Cb(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function _b(e,r){return r?e.replace(/\/?\/$/,"")+"/"+r.replace(/^\/+/,""):e}function tm(e,r,t){let n=!Cb(r);return e&&(n||t==!1)?_b(e,r):r}const Mf=e=>e instanceof En?{...e}:e;function ns(e,r){r=r||{};const t={};function n(u,d,f,h){return ve.isPlainObject(u)&&ve.isPlainObject(d)?ve.merge.call({caseless:h},u,d):ve.isPlainObject(d)?ve.merge({},d):ve.isArray(d)?d.slice():d}function a(u,d,f,h){if(ve.isUndefined(d)){if(!ve.isUndefined(u))return n(void 0,u,f,h)}else return n(u,d,f,h)}function s(u,d){if(!ve.isUndefined(d))return n(void 0,d)}function o(u,d){if(ve.isUndefined(d)){if(!ve.isUndefined(u))return n(void 0,u)}else return n(void 0,d)}function c(u,d,f){if(f in r)return n(u,d);if(f in e)return n(void 0,u)}const l={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:c,headers:(u,d,f)=>a(Mf(u),Mf(d),f,!0)};return ve.forEach(Object.keys(Object.assign({},e,r)),function(d){const f=l[d]||a,h=f(e[d],r[d],d);ve.isUndefined(h)&&f!==c||(t[d]=h)}),t}const rm=e=>{const r=ns({},e);let{data:t,withXSRFToken:n,xsrfHeaderName:a,xsrfCookieName:s,headers:o,auth:c}=r;r.headers=o=En.from(o),r.url=Kp(tm(r.baseURL,r.url,r.allowAbsoluteUrls),e.params,e.paramsSerializer),c&&o.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):"")));let l;if(ve.isFormData(t)){if(gr.hasStandardBrowserEnv||gr.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((l=o.getContentType())!==!1){const[u,...d]=l?l.split(";").map(f=>f.trim()).filter(Boolean):[];o.setContentType([u||"multipart/form-data",...d].join("; "))}}if(gr.hasStandardBrowserEnv&&(n&&ve.isFunction(n)&&(n=n(r)),n||n!==!1&&Ab(r.url))){const u=a&&s&&kb.read(s);u&&o.set(a,u)}return r},Db=typeof XMLHttpRequest<"u",Fb=Db&&function(e){return new Promise(function(t,n){const a=rm(e);let s=a.data;const o=En.from(a.headers).normalize();let{responseType:c,onUploadProgress:l,onDownloadProgress:u}=a,d,f,h,x,m;function p(){x&&x(),m&&m(),a.cancelToken&&a.cancelToken.unsubscribe(d),a.signal&&a.signal.removeEventListener("abort",d)}let g=new XMLHttpRequest;g.open(a.method.toUpperCase(),a.url,!0),g.timeout=a.timeout;function w(){if(!g)return;const v=En.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders()),F={data:!c||c==="text"||c==="json"?g.responseText:g.response,status:g.status,statusText:g.statusText,headers:v,config:e,request:g};em(function(S){t(S),p()},function(S){n(S),p()},F),g=null}"onloadend"in g?g.onloadend=w:g.onreadystatechange=function(){!g||g.readyState!==4||g.status===0&&!(g.responseURL&&g.responseURL.indexOf("file:")===0)||setTimeout(w)},g.onabort=function(){g&&(n(new at("Request aborted",at.ECONNABORTED,e,g)),g=null)},g.onerror=function(){n(new at("Network Error",at.ERR_NETWORK,e,g)),g=null},g.ontimeout=function(){let T=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const F=a.transitional||Jp;a.timeoutErrorMessage&&(T=a.timeoutErrorMessage),n(new at(T,F.clarifyTimeoutError?at.ETIMEDOUT:at.ECONNABORTED,e,g)),g=null},s===void 0&&o.setContentType(null),"setRequestHeader"in g&&ve.forEach(o.toJSON(),function(T,F){g.setRequestHeader(F,T)}),ve.isUndefined(a.withCredentials)||(g.withCredentials=!!a.withCredentials),c&&c!=="json"&&(g.responseType=a.responseType),u&&([h,m]=qo(u,!0),g.addEventListener("progress",h)),l&&g.upload&&([f,x]=qo(l),g.upload.addEventListener("progress",f),g.upload.addEventListener("loadend",x)),(a.cancelToken||a.signal)&&(d=v=>{g&&(n(!v||v.type?new ei(null,e,g):v),g.abort(),g=null)},a.cancelToken&&a.cancelToken.subscribe(d),a.signal&&(a.signal.aborted?d():a.signal.addEventListener("abort",d)));const y=Sb(a.url);if(y&&gr.protocols.indexOf(y)===-1){n(new at("Unsupported protocol "+y+":",at.ERR_BAD_REQUEST,e));return}g.send(s||null)})},jb=(e,r)=>{const{length:t}=e=e?e.filter(Boolean):[];if(r||t){let n=new AbortController,a;const s=function(u){if(!a){a=!0,c();const d=u instanceof Error?u:this.reason;n.abort(d instanceof at?d:new ei(d instanceof Error?d.message:d))}};let o=r&&setTimeout(()=>{o=null,s(new at(`timeout ${r} of ms exceeded`,at.ETIMEDOUT))},r);const c=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(s):u.removeEventListener("abort",s)}),e=null)};e.forEach(u=>u.addEventListener("abort",s));const{signal:l}=n;return l.unsubscribe=()=>ve.asap(c),l}},Ib=jb,Pb=function*(e,r){let t=e.byteLength;if(!r||t<r){yield e;return}let n=0,a;for(;n<t;)a=n+r,yield e.slice(n,a),n=a},Ob=async function*(e,r){for await(const t of Rb(e))yield*Pb(t,r)},Rb=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const r=e.getReader();try{for(;;){const{done:t,value:n}=await r.read();if(t)break;yield n}}finally{await r.cancel()}},Lf=(e,r,t,n)=>{const a=Ob(e,r);let s=0,o,c=l=>{o||(o=!0,n&&n(l))};return new ReadableStream({async pull(l){try{const{done:u,value:d}=await a.next();if(u){c(),l.close();return}let f=d.byteLength;if(t){let h=s+=f;t(h)}l.enqueue(new Uint8Array(d))}catch(u){throw c(u),u}},cancel(l){return c(l),a.return()}},{highWaterMark:2})},kc=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",nm=kc&&typeof ReadableStream=="function",Nb=kc&&(typeof TextEncoder=="function"?(e=>r=>e.encode(r))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),am=(e,...r)=>{try{return!!e(...r)}catch{return!1}},Mb=nm&&am(()=>{let e=!1;const r=new Request(gr.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!r}),Bf=64*1024,Vl=nm&&am(()=>ve.isReadableStream(new Response("").body)),Xo={stream:Vl&&(e=>e.body)};kc&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(r=>{!Xo[r]&&(Xo[r]=ve.isFunction(e[r])?t=>t[r]():(t,n)=>{throw new at(`Response type '${r}' is not supported`,at.ERR_NOT_SUPPORT,n)})})})(new Response);const Lb=async e=>{if(e==null)return 0;if(ve.isBlob(e))return e.size;if(ve.isSpecCompliantForm(e))return(await new Request(gr.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(ve.isArrayBufferView(e)||ve.isArrayBuffer(e))return e.byteLength;if(ve.isURLSearchParams(e)&&(e=e+""),ve.isString(e))return(await Nb(e)).byteLength},Bb=async(e,r)=>{const t=ve.toFiniteNumber(e.getContentLength());return t??Lb(r)},$b=kc&&(async e=>{let{url:r,method:t,data:n,signal:a,cancelToken:s,timeout:o,onDownloadProgress:c,onUploadProgress:l,responseType:u,headers:d,withCredentials:f="same-origin",fetchOptions:h}=rm(e);u=u?(u+"").toLowerCase():"text";let x=Ib([a,s&&s.toAbortSignal()],o),m;const p=x&&x.unsubscribe&&(()=>{x.unsubscribe()});let g;try{if(l&&Mb&&t!=="get"&&t!=="head"&&(g=await Bb(d,n))!==0){let F=new Request(r,{method:"POST",body:n,duplex:"half"}),A;if(ve.isFormData(n)&&(A=F.headers.get("content-type"))&&d.setContentType(A),F.body){const[S,E]=Rf(g,qo(Nf(l)));n=Lf(F.body,Bf,S,E)}}ve.isString(f)||(f=f?"include":"omit");const w="credentials"in Request.prototype;m=new Request(r,{...h,signal:x,method:t.toUpperCase(),headers:d.normalize().toJSON(),body:n,duplex:"half",credentials:w?f:void 0});let y=await fetch(m);const v=Vl&&(u==="stream"||u==="response");if(Vl&&(c||v&&p)){const F={};["status","statusText","headers"].forEach(b=>{F[b]=y[b]});const A=ve.toFiniteNumber(y.headers.get("content-length")),[S,E]=c&&Rf(A,qo(Nf(c),!0))||[];y=new Response(Lf(y.body,Bf,S,()=>{E&&E(),p&&p()}),F)}u=u||"text";let T=await Xo[ve.findKey(Xo,u)||"text"](y,e);return!v&&p&&p(),await new Promise((F,A)=>{em(F,A,{data:T,headers:En.from(y.headers),status:y.status,statusText:y.statusText,config:e,request:m})})}catch(w){throw p&&p(),w&&w.name==="TypeError"&&/Load failed|fetch/i.test(w.message)?Object.assign(new at("Network Error",at.ERR_NETWORK,e,m),{cause:w.cause||w}):at.from(w,w&&w.code,e,m)}}),Wl={http:Zv,xhr:Fb,fetch:$b};ve.forEach(Wl,(e,r)=>{if(e){try{Object.defineProperty(e,"name",{value:r})}catch{}Object.defineProperty(e,"adapterName",{value:r})}});const $f=e=>`- ${e}`,Ub=e=>ve.isFunction(e)||e===null||e===!1,sm={getAdapter:e=>{e=ve.isArray(e)?e:[e];const{length:r}=e;let t,n;const a={};for(let s=0;s<r;s++){t=e[s];let o;if(n=t,!Ub(t)&&(n=Wl[(o=String(t)).toLowerCase()],n===void 0))throw new at(`Unknown adapter '${o}'`);if(n)break;a[o||"#"+s]=n}if(!n){const s=Object.entries(a).map(([c,l])=>`adapter ${c} `+(l===!1?"is not supported by the environment":"is not available in the build"));let o=r?s.length>1?`since :
`+s.map($f).join(`
`):" "+$f(s[0]):"as no adapter specified";throw new at("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return n},adapters:Wl};function sl(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new ei(null,e)}function Uf(e){return sl(e),e.headers=En.from(e.headers),e.data=al.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),sm.getAdapter(e.adapter||Cu.adapter)(e).then(function(n){return sl(e),n.data=al.call(e,e.transformResponse,n),n.headers=En.from(n.headers),n},function(n){return Zp(n)||(sl(e),n&&n.response&&(n.response.data=al.call(e,e.transformResponse,n.response),n.response.headers=En.from(n.response.headers))),Promise.reject(n)})}const im="1.9.0",Cc={};["object","boolean","number","function","string","symbol"].forEach((e,r)=>{Cc[e]=function(n){return typeof n===e||"a"+(r<1?"n ":" ")+e}});const Vf={};Cc.transitional=function(r,t,n){function a(s,o){return"[Axios v"+im+"] Transitional option '"+s+"'"+o+(n?". "+n:"")}return(s,o,c)=>{if(r===!1)throw new at(a(o," has been removed"+(t?" in "+t:"")),at.ERR_DEPRECATED);return t&&!Vf[o]&&(Vf[o]=!0,console.warn(a(o," has been deprecated since v"+t+" and will be removed in the near future"))),r?r(s,o,c):!0}};Cc.spelling=function(r){return(t,n)=>(console.warn(`${n} is likely a misspelling of ${r}`),!0)};function Vb(e,r,t){if(typeof e!="object")throw new at("options must be an object",at.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let a=n.length;for(;a-- >0;){const s=n[a],o=r[s];if(o){const c=e[s],l=c===void 0||o(c,s,e);if(l!==!0)throw new at("option "+s+" must be "+l,at.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new at("Unknown option "+s,at.ERR_BAD_OPTION)}}const Uo={assertOptions:Vb,validators:Cc},Dn=Uo.validators;class Ko{constructor(r){this.defaults=r||{},this.interceptors={request:new Pf,response:new Pf}}async request(r,t){try{return await this._request(r,t)}catch(n){if(n instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const s=a.stack?a.stack.replace(/^.+\n/,""):"";try{n.stack?s&&!String(n.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+s):n.stack=s}catch{}}throw n}}_request(r,t){typeof r=="string"?(t=t||{},t.url=r):t=r||{},t=ns(this.defaults,t);const{transitional:n,paramsSerializer:a,headers:s}=t;n!==void 0&&Uo.assertOptions(n,{silentJSONParsing:Dn.transitional(Dn.boolean),forcedJSONParsing:Dn.transitional(Dn.boolean),clarifyTimeoutError:Dn.transitional(Dn.boolean)},!1),a!=null&&(ve.isFunction(a)?t.paramsSerializer={serialize:a}:Uo.assertOptions(a,{encode:Dn.function,serialize:Dn.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Uo.assertOptions(t,{baseUrl:Dn.spelling("baseURL"),withXsrfToken:Dn.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=s&&ve.merge(s.common,s[t.method]);s&&ve.forEach(["delete","get","head","post","put","patch","common"],m=>{delete s[m]}),t.headers=En.concat(o,s);const c=[];let l=!0;this.interceptors.request.forEach(function(p){typeof p.runWhen=="function"&&p.runWhen(t)===!1||(l=l&&p.synchronous,c.unshift(p.fulfilled,p.rejected))});const u=[];this.interceptors.response.forEach(function(p){u.push(p.fulfilled,p.rejected)});let d,f=0,h;if(!l){const m=[Uf.bind(this),void 0];for(m.unshift.apply(m,c),m.push.apply(m,u),h=m.length,d=Promise.resolve(t);f<h;)d=d.then(m[f++],m[f++]);return d}h=c.length;let x=t;for(f=0;f<h;){const m=c[f++],p=c[f++];try{x=m(x)}catch(g){p.call(this,g);break}}try{d=Uf.call(this,x)}catch(m){return Promise.reject(m)}for(f=0,h=u.length;f<h;)d=d.then(u[f++],u[f++]);return d}getUri(r){r=ns(this.defaults,r);const t=tm(r.baseURL,r.url,r.allowAbsoluteUrls);return Kp(t,r.params,r.paramsSerializer)}}ve.forEach(["delete","get","head","options"],function(r){Ko.prototype[r]=function(t,n){return this.request(ns(n||{},{method:r,url:t,data:(n||{}).data}))}});ve.forEach(["post","put","patch"],function(r){function t(n){return function(s,o,c){return this.request(ns(c||{},{method:r,headers:n?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}Ko.prototype[r]=t(),Ko.prototype[r+"Form"]=t(!0)});const Vo=Ko;class _u{constructor(r){if(typeof r!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(s){t=s});const n=this;this.promise.then(a=>{if(!n._listeners)return;let s=n._listeners.length;for(;s-- >0;)n._listeners[s](a);n._listeners=null}),this.promise.then=a=>{let s;const o=new Promise(c=>{n.subscribe(c),s=c}).then(a);return o.cancel=function(){n.unsubscribe(s)},o},r(function(s,o,c){n.reason||(n.reason=new ei(s,o,c),t(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(r){if(this.reason){r(this.reason);return}this._listeners?this._listeners.push(r):this._listeners=[r]}unsubscribe(r){if(!this._listeners)return;const t=this._listeners.indexOf(r);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const r=new AbortController,t=n=>{r.abort(n)};return this.subscribe(t),r.signal.unsubscribe=()=>this.unsubscribe(t),r.signal}static source(){let r;return{token:new _u(function(a){r=a}),cancel:r}}}const Wb=_u;function Hb(e){return function(t){return e.apply(null,t)}}function zb(e){return ve.isObject(e)&&e.isAxiosError===!0}const Hl={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Hl).forEach(([e,r])=>{Hl[r]=e});const Gb=Hl;function om(e){const r=new Vo(e),t=Lp(Vo.prototype.request,r);return ve.extend(t,Vo.prototype,r,{allOwnKeys:!0}),ve.extend(t,r,null,{allOwnKeys:!0}),t.create=function(a){return om(ns(e,a))},t}const qt=om(Cu);qt.Axios=Vo;qt.CanceledError=ei;qt.CancelToken=Wb;qt.isCancel=Zp;qt.VERSION=im;qt.toFormData=Tc;qt.AxiosError=at;qt.Cancel=qt.CanceledError;qt.all=function(r){return Promise.all(r)};qt.spread=Hb;qt.isAxiosError=zb;qt.mergeConfig=ns;qt.AxiosHeaders=En;qt.formToJSON=e=>Qp(ve.isHTMLForm(e)?new FormData(e):e);qt.getAdapter=sm.getAdapter;qt.HttpStatusCode=Gb;qt.default=qt;const Mn=qt,Yb={apiUrl:window.location.origin,fallbackApiUrl:"",swaggerUrl:"/swagger-ui/index.html",apiTimeout:15e3,retryAttempts:3};let cm;cm=Yb;const bt=cm,rn=Mn.create({baseURL:bt.apiUrl,timeout:bt.apiTimeout,headers:{"Content-Type":"application/json"},withCredentials:!0});rn.interceptors.request.use(e=>{var t,n;const r=localStorage.getItem("token");return(t=e.url)!=null&&t.startsWith("http://localhost:8080")&&((n=e.baseURL)!=null&&n.includes("localhost:8080"))&&(e.url=e.url.replace("http://localhost:8080",""),console.warn("Detected and fixed duplicate base URL in request")),console.log(`Request to ${e.baseURL}${e.url}:`,{method:e.method,hasToken:!!r,tokenFirstChars:r?`${r.substring(0,10)}...`:"none",headers:e.headers,timestamp:new Date().toISOString()}),r&&e.headers&&(e.headers.Authorization=`Bearer ${r}`),e});rn.interceptors.response.use(e=>{var r,t;return(r=e.config.url)!=null&&r.includes("staff")&&((t=e.config.url)!=null&&t.includes("employment-status"))&&console.log("Successful staff status update response:",{status:e.status,url:e.config.url,method:e.config.method,data:e.data}),e},e=>{var n,a,s,o,c,l,u,d,f,h,x,m,p,g,w,y,v,T,F,A,S,E,b,k,j,_,B,Q,Z,L,q,te,R,oe,J,P,V,z,G,ne,he,se,ae;if(console.error("API Error Details:",{status:(n=e.response)==null?void 0:n.status,statusText:(a=e.response)==null?void 0:a.statusText,data:(s=e.response)==null?void 0:s.data,url:(o=e.config)==null?void 0:o.url,method:(c=e.config)==null?void 0:c.method,headers:(l=e.config)==null?void 0:l.headers,requestTimestamp:new Date().toISOString()}),((u=e.response)==null?void 0:u.status)===403){console.error("Permission Error (403) Details:"),console.error("Current localStorage token:",localStorage.getItem("token")?"Present (first 10 chars): "+((d=localStorage.getItem("token"))==null?void 0:d.substring(0,10))+"...":"Missing"),console.error("User from localStorage:",localStorage.getItem("user"));let K="";(h=(f=e.config)==null?void 0:f.url)!=null&&h.startsWith("http")?K=e.config.url:K=`${((x=e.config)==null?void 0:x.baseURL)||""}${((m=e.config)==null?void 0:m.url)||""}`,console.error("Full request URL:",K),console.error("Request Method:",(g=(p=e.config)==null?void 0:p.method)==null?void 0:g.toUpperCase()),console.error("Request Headers:",(w=e.config)==null?void 0:w.headers);try{console.error("Request Payload:",(y=e.config)!=null&&y.data?JSON.parse((v=e.config)==null?void 0:v.data):"No data")}catch{console.error("Raw Request Payload:",(T=e.config)==null?void 0:T.data)}console.error("Response Body:",(F=e.response)==null?void 0:F.data);const O=localStorage.getItem("user");if(O)try{const D=JSON.parse(O);console.error("User role:",D.role),console.error("Required roles for this endpoint may include ADMIN or TEACHER")}catch{console.error("Could not parse user data")}}if(((A=e.response)==null?void 0:A.status)===500){console.error("Server Error 500 Details:");try{console.error("Request URL:",(S=e.config)==null?void 0:S.url),console.error("Request Method:",(E=e.config)==null?void 0:E.method),console.error("Request Payload:",JSON.parse((b=e.config)==null?void 0:b.data)),console.error("Response Data:",(k=e.response)==null?void 0:k.data)}catch{console.error("Raw Request Data:",(j=e.config)==null?void 0:j.data)}}if(((_=e.response)==null?void 0:_.status)===400){console.error("Validation Error Details:"),(Q=(B=e.response)==null?void 0:B.data)!=null&&Q.errors?console.table(e.response.data.errors):(L=(Z=e.response)==null?void 0:Z.data)!=null&&L.fieldErrors?console.table(e.response.data.fieldErrors):typeof((q=e.response)==null?void 0:q.data)=="object"&&Object.entries(e.response.data).forEach(([K,O])=>{console.log(`${K}:`,O)});try{console.log("Request payload that caused validation error:",JSON.parse((te=e.config)==null?void 0:te.data))}catch{console.log("Request payload (could not parse):",(R=e.config)==null?void 0:R.data)}}((oe=e.response)==null?void 0:oe.status)===401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login");const t={message:((P=(J=e.response)==null?void 0:J.data)==null?void 0:P.message)||((z=(V=e.response)==null?void 0:V.data)==null?void 0:z.error)||e.message||"An error occurred",status:((G=e.response)==null?void 0:G.status)||"network_error",originalError:e,validationErrors:((he=(ne=e.response)==null?void 0:ne.data)==null?void 0:he.errors)||((ae=(se=e.response)==null?void 0:se.data)==null?void 0:ae.fieldErrors)};return Promise.reject(t)});const De={get:(e,r)=>rn.get(Gn(e),{params:r}).then(t=>t.data),post:(e,r)=>rn.post(Gn(e),r).then(t=>t.data),put:(e,r)=>rn.put(Gn(e),r).then(t=>t.data),delete:e=>rn.delete(Gn(e)).then(r=>r.data),patch:(e,r)=>rn.patch(Gn(e),r).then(t=>t.data),authRequest:(e,r)=>rn.post(Gn(e),r,{headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}}).then(t=>t.data),bulkUpload:(e,r,t)=>{const n=(t==null?void 0:t.isFile)??r instanceof File,a=Gn(e);if(n){const s=new FormData;return s.append("file",r),rn.post(a,s,{headers:{"Content-Type":"multipart/form-data"}}).then(o=>o.data)}else return rn.post(a,r).then(s=>s.data)},downloadBlob:(e,r)=>rn.get(Gn(e),{responseType:"blob",params:r}).then(t=>t.data),downloadBlobPost:(e,r)=>rn.post(Gn(e),r,{responseType:"blob"}).then(t=>t.data)};function Gn(e){const r=bt.apiUrl.endsWith("/")?bt.apiUrl.slice(0,-1):bt.apiUrl;return e.startsWith("/api/")?`${r}${e}`:e.startsWith("/")?`${r}/api${e}`:`${r}/api/${e}`}function qb(e){try{const t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),n=decodeURIComponent(window.atob(t).split("").map(a=>"%"+("00"+a.charCodeAt(0).toString(16)).slice(-2)).join(""));return JSON.parse(n)}catch(r){return console.error("Error parsing JWT token:",r),null}}const bo={setWithExpiry:(e,r,t)=>{const a={value:r,expiry:new Date().getTime()+t};localStorage.setItem(e,JSON.stringify(a))},getWithExpiry:e=>{const r=localStorage.getItem(e);if(!r)return null;try{const t=JSON.parse(r);return new Date().getTime()>t.expiry?(localStorage.removeItem(e),null):t.value}catch(t){return console.error("Error parsing stored item with TTL:",t),localStorage.removeItem(e),null}},remove:e=>{localStorage.removeItem(e)}},Jo={login:async e=>{console.log("🔐 AuthService: Attempting login with credentials:",{username:e.username,passwordLength:e.password?e.password.length:0});try{if(!navigator.onLine){console.log("📵 AuthService: Device is offline, checking for cached credentials");const t=bo.getWithExpiry("offlineAuth");if(t&&t.username===e.username&&t.passwordHash===il(e.password))return console.log("✅ AuthService: Using cached credentials for offline mode"),{data:t.authData,offlineMode:!0};throw console.error("❌ AuthService: No valid cached credentials found for offline mode"),{message:"You appear to be offline. Cannot authenticate without internet connection.",status:"network_error",isOffline:!0}}try{console.log("🔄 AuthService: Trying login with enhanced CORS handling...");const{authFetch:t}=await Ll(()=>import("./authHelper-0e12ca06.js"),["assets/authHelper-0e12ca06.js","assets/mui-vendor-2642d531.js","assets/react-vendor-c0a3892c.js","assets/chart-vendor-22102d3f.js"]),n=await t("/auth/login",e);return console.log("✅ AuthService: Login successful with enhanced CORS handling"),console.log("🔍 DEBUG - Auth Response Details:",{responseData:n,token:n.token||n.access_token,username:n.username,role:n.role||n.userRole,allFields:Object.keys(n)}),bo.setWithExpiry("offlineAuth",{username:e.username,passwordHash:il(e.password),authData:n,timestamp:new Date().toISOString()},864e5),n}catch(t){console.warn("⚠️ Enhanced auth request failed, falling back to standard request:",t);const n=await De.authRequest("/auth/login",e);return console.log("✅ AuthService: Login successful with fallback method"),bo.setWithExpiry("offlineAuth",{username:e.username,passwordHash:il(e.password),authData:n,timestamp:new Date().toISOString()},864e5),n}}catch(r){throw console.error("❌ AuthService: Login failed:",r),r.message&&(r.message.includes("Network Error")||r.message.includes("CORS")||r.message.includes("header field")||r.status===0)?(console.error("🔄 CORS Issue Detected: Adding detailed diagnostic info"),{...r,message:"Authentication failed due to CORS issues. Please try again or contact support.",corsIssue:!0,diagnostics:{browser:navigator.userAgent,time:new Date().toISOString(),corsHeaders:["Authorization","Content-Type","Cache-Control"]}}):r}},register:async e=>{try{return await De.authRequest("/auth/register",e)}catch(r){throw console.error("❌ AuthService: Registration failed:",r),r}},logout:()=>{console.log("🔒 AuthService: Logging out user"),localStorage.removeItem("token"),localStorage.removeItem("user"),bo.remove("offlineAuth"),De.authRequest("/auth/logout",{}).then(()=>console.log("✅ AuthService: Server logout successful")).catch(e=>console.log("ℹ️ AuthService: Server logout failed, but client logout completed"))},validateToken:async e=>{try{return(await De.authRequest("/auth/validate-token",{token:e})).valid===!0}catch(r){return console.error("❌ AuthService: Token validation failed:",r),!1}}},Xb=()=>{var t;const e=Kb();if(console.log(`[AUTH DEBUG] [${new Date().toISOString()}] Checking staff status update permission`),!e)return console.log(`[AUTH DEBUG] [${new Date().toISOString()}] Permission check failed: No user found`),!1;if(console.log(`[AUTH DEBUG] [${new Date().toISOString()}] User role: ${e.role}`),console.log(`[AUTH DEBUG] [${new Date().toISOString()}] Token present: ${!!localStorage.getItem("token")}`),localStorage.getItem("token")){const n=((t=localStorage.getItem("token"))==null?void 0:t.substring(0,15))+"...";console.log(`[AUTH DEBUG] [${new Date().toISOString()}] Token sample: ${n}`)}const r=e.role==="ADMIN"||e.role==="HR_MANAGER";return console.log(`[AUTH DEBUG] [${new Date().toISOString()}] Has permission: ${r}`),r};function il(e){let r=0;for(let t=0;t<e.length;t++){const n=e.charCodeAt(t);r=(r<<5)-r+n,r=r&r}return r.toString(36)}function Kb(){const e=localStorage.getItem("user");if(!e)return null;try{return JSON.parse(e)}catch(r){return console.error(`[AUTH DEBUG] [${new Date().toISOString()}] Error parsing user JSON:`,r),null}}const lm=C.createContext(void 0),Jb=({children:e})=>{const[r,t]=C.useState(null),[n,a]=C.useState(!1),s=c=>{t(c),a(!0)},o=()=>{a(!1)};return i.jsxs(lm.Provider,{value:{showNotification:s},children:[e,r&&i.jsx(yu,{open:n,autoHideDuration:6e3,onClose:o,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:i.jsx(Lr,{onClose:o,severity:r.type,variant:"filled",sx:{width:"100%"},children:r.message})})]})},ln=()=>{const e=C.useContext(lm);if(!e)throw new Error("useNotification must be used within a NotificationProvider");return e},Qb=10*60*1e3,Du=C.createContext(void 0),Zb=({children:e})=>{const[r,t]=C.useState(null),[n,a]=C.useState(!1),[s,o]=C.useState(!1),c=no(),{showNotification:l}=ln(),u=C.useRef(null),d=C.useCallback(()=>{n&&(u.current&&window.clearTimeout(u.current),u.current=window.setTimeout(()=>{console.log("⏰ User session expired due to inactivity"),l({type:"warning",message:"You are being logged out due to inactivity"}),h()},Qb),console.log("⏰ Inactivity timer reset - will expire in 10 minutes if no activity"))},[n]);C.useEffect(()=>{if(n){d();const x=["mousedown","mousemove","keydown","scroll","touchstart"],m=()=>{d()};return x.forEach(p=>{document.addEventListener(p,m)}),()=>{u.current&&window.clearTimeout(u.current),x.forEach(p=>{document.removeEventListener(p,m)})}}},[n,d]),C.useEffect(()=>{const x=localStorage.getItem("token"),m=localStorage.getItem("user");if(x&&m)try{const p=JSON.parse(m);t(p),a(!0),console.log("✅ User authenticated from localStorage:",{username:p.username,role:p.role})}catch(p){console.error("❌ Error parsing user data from localStorage:",p),localStorage.removeItem("token"),localStorage.removeItem("user")}else console.log("ℹ️ No authentication data found in localStorage")},[]);const f=async(x,m)=>{try{o(!0),console.log("🔐 AuthContext: Attempting login for user:",x);const p=await Jo.login({username:x,password:m});console.log("✅ AuthContext: Raw login response:",p);const g=p.data?p.data:p;if(!g||!g.token&&!g.access_token)throw console.error("❌ Invalid response format, missing token:",g),new Error("Invalid response from server. Missing authentication token.");const w=g.token||g.access_token,y={token:w,username:g.username||x,role:g.role||g.userRole||"USER"};console.log("✅ Processed user data:",y),localStorage.setItem("token",w),localStorage.setItem("user",JSON.stringify(y)),t(y),a(!0),c("/dashboard"),d(),l({type:"success",message:"Login successful"})}catch(p){console.error("❌ Login error in AuthContext:",p);let g="Login failed. Please check your credentials.";throw p&&typeof p=="object"&&"message"in p&&typeof p.message=="string"?g=p.message:p&&typeof p=="object"&&"response"in p&&p.response&&typeof p.response=="object"&&"data"in p.response&&p.response.data&&typeof p.response.data=="object"&&"message"in p.response.data&&typeof p.response.data.message=="string"&&(g=p.response.data.message),l({type:"error",message:g}),p}finally{o(!1)}},h=()=>{u.current&&(window.clearTimeout(u.current),u.current=null),localStorage.removeItem("token"),localStorage.removeItem("user"),t(null),a(!1),c("/login"),l({type:"info",message:"You have been logged out"})};return i.jsx(Du.Provider,{value:{user:r,login:f,logout:h,isAuthenticated:n,resetInactivityTimer:d,loading:s},children:e})},_n=()=>{const e=C.useContext(Du);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e},Ua=class Ua{constructor(r="/actuator/health",t=6e4){Le(this,"statusUrl");Le(this,"pollingInterval");Le(this,"statusListeners",[]);Le(this,"currentStatus",{status:"UNKNOWN",message:"Checking server status..."});Le(this,"pollingTimerId",null);this.statusUrl=r,this.pollingInterval=t}static getInstance(){return Ua.instance||(Ua.instance=new Ua),Ua.instance}startPolling(){this.pollingTimerId||(this.checkServerStatus(),this.pollingTimerId=setInterval(()=>{this.checkServerStatus()},this.pollingInterval))}stopPolling(){this.pollingTimerId&&(clearInterval(this.pollingTimerId),this.pollingTimerId=null)}addStatusListener(r){return this.statusListeners.push(r),r(this.currentStatus),()=>{this.statusListeners=this.statusListeners.filter(t=>t!==r)}}async checkServerStatus(){try{const r=await fetch(this.statusUrl);if(r.ok){const t=r.headers.get("content-type");if(!t||!t.includes("application/json")){console.warn("Server returned non-JSON response:",t),this.updateStatus({status:"ONLINE",message:"Server is online but returned non-JSON response",details:{contentType:t}});return}try{const n=await r.json();n.status==="UP"?this.updateStatus({status:"ONLINE",message:"Server is online",details:n}):(console.warn(`Server status degraded: ${n.status}`,n),this.updateStatus({status:"DEGRADED",message:`Server is experiencing issues: ${n.status}`,details:n}))}catch(n){console.warn("Error parsing JSON response:",n),this.updateStatus({status:"ONLINE",message:"Server is online but returned invalid JSON",error:n})}}else console.error(`Server error: ${r.status} ${r.statusText}`),this.updateStatus({status:"ERROR",message:`Server error: ${r.status} ${r.statusText}`})}catch(r){console.error("Cannot connect to server:",r),this.updateStatus({status:"OFFLINE",message:"Cannot connect to server",error:r}),console.log(`Connectivity issue logged at: ${new Date().toLocaleString()}`)}}updateStatus(r){const t=this.currentStatus.status;t!==r.status&&console.log(`Server status changed from ${t} to ${r.status}`),this.currentStatus=r,this.notifyListeners()}notifyListeners(){this.statusListeners.forEach(r=>{r(this.currentStatus)})}};Le(Ua,"instance");let zl=Ua;function ew(){const[e,r]=C.useState({status:"UNKNOWN",message:"Initializing..."});return C.useEffect(()=>{const t=zl.getInstance(),n=t.addStatusListener(r);return t.startPolling(),()=>{n(),t.stopPolling()}},[]),e}var Fu={},ol={};const tw=rv(Ty);var Wf;function Ft(){return Wf||(Wf=1,function(e){"use client";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"default",{enumerable:!0,get:function(){return r.createSvgIcon}});var r=tw}(ol)),ol}var rw=_t;Object.defineProperty(Fu,"__esModule",{value:!0});var ju=Fu.default=void 0,nw=rw(Ft()),aw=i;ju=Fu.default=(0,nw.default)((0,aw.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"}),"CheckCircle");const Hf=()=>{const e=ew();return C.useEffect(()=>{e.status!=="ONLINE"&&(console.log(`Server Status: ${e.status}`),e.message&&console.log(`Message: ${e.message}`),e.details&&console.log("Details:",e.details),e.error&&console.error("Server connection error:",e.error))},[e]),e.status!=="ONLINE"?null:i.jsx(st,{title:"Server is connected",arrow:!0,placement:"bottom-end",children:i.jsxs(ye,{sx:{display:"flex",alignItems:"center",gap:1,padding:"4px 8px",borderRadius:1,bgcolor:"background.paper",border:1,borderColor:"success.main"},children:[i.jsx(ju,{sx:{color:"success.main"}}),i.jsx(ee,{variant:"caption",color:"success.main",sx:{fontWeight:"medium"},children:"Connected"})]})})},wo=240,rr={ADMIN:"ADMIN",TEACHER:"TEACHER",STAFF:"STAFF",PARENT:"PARENT",STUDENT:"STUDENT"},sw=[{text:"Dashboard",icon:i.jsx(Dy,{}),path:"/",allowedRoles:[rr.ADMIN,rr.TEACHER,rr.STAFF,rr.PARENT,rr.STUDENT]},{text:"Admissions",icon:i.jsx(Fy,{}),path:"/admissions",allowedRoles:[rr.ADMIN,rr.STAFF]},{text:"Students",icon:i.jsx(Ws,{}),path:"/students",allowedRoles:[rr.ADMIN,rr.TEACHER,rr.STAFF]},{text:"Staff",icon:i.jsx(Ws,{}),path:"/staff",allowedRoles:[rr.ADMIN]},{text:"Courses",icon:i.jsx(Mi,{}),path:"/courses",allowedRoles:[rr.ADMIN,rr.TEACHER,rr.STAFF]},{text:"Fee Management",icon:i.jsx(jy,{}),path:"/fees",allowedRoles:[rr.ADMIN]},{text:"Reports",icon:i.jsx(Iy,{}),path:"/reports",allowedRoles:[rr.ADMIN,rr.TEACHER,rr.STAFF]}],Fa=({children:e})=>{const[r,t]=C.useState(!1),[n,a]=C.useState(null),s=no(),{user:o,logout:c}=_n(),l=()=>{t(!r)},u=m=>{a(m.currentTarget)},d=()=>{a(null)},f=()=>{d(),c()},h=sw.filter(m=>o&&o.role&&m.allowedRoles.includes(o.role)),x=i.jsxs("div",{children:[i.jsx(rl,{}),i.jsx(qa,{children:h.map(m=>i.jsxs(Xa,{button:!0,onClick:()=>{s(m.path),t(!1)},sx:{"&:hover":{backgroundColor:"rgba(0, 0, 0, 0.04)"}},children:[i.jsx(Ni,{children:m.icon}),i.jsx(Ka,{primary:m.text})]},m.text))})]});return i.jsxs(ye,{sx:{display:"flex",width:"100%",height:"100vh",overflow:"hidden"},children:[i.jsx(wp,{}),i.jsx(Ay,{position:"fixed",sx:{zIndex:m=>m.zIndex.drawer+1,width:"100%"},children:i.jsxs(rl,{children:[i.jsx(Ze,{color:"inherit",edge:"start",onClick:l,sx:{mr:2,display:{sm:"none"}},children:i.jsx(ky,{})}),i.jsxs(ee,{variant:"h6",noWrap:!0,component:"div",sx:{flexGrow:1,display:"flex",alignItems:"center",fontSize:{xs:"1rem",sm:"1.25rem"}},children:["School Management System",i.jsx(st,{title:"Server connection status",children:i.jsx(ye,{sx:{ml:2,display:{xs:"none",sm:"flex"}},children:i.jsx(Hf,{})})})]}),i.jsxs(ye,{sx:{display:"flex",alignItems:"center"},children:[i.jsx(ye,{sx:{mr:2,display:{xs:"flex",sm:"none"}},children:i.jsx(Hf,{})}),o&&i.jsxs(i.Fragment,{children:[i.jsx($t,{label:o.role,color:"secondary",size:"small",sx:{mr:2,display:{xs:"none",sm:"flex"}}}),i.jsx(ee,{variant:"body1",sx:{mr:2,display:{xs:"none",sm:"block"},maxWidth:"150px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:o.username||o.email})]}),i.jsx(Ze,{color:"inherit",onClick:u,edge:"end",children:i.jsx(Sp,{sx:{width:32,height:32},children:i.jsx(Cy,{})})})]})]})}),i.jsx(Ep,{anchorEl:n,open:!!n,onClose:d,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:i.jsxs(Ye,{onClick:f,children:[i.jsx(Ni,{children:i.jsx(_y,{fontSize:"small"})}),i.jsx(Ka,{primary:"Logout"})]})}),i.jsx(yf,{variant:"temporary",open:r,onClose:l,ModalProps:{keepMounted:!0},sx:{display:{xs:"block",sm:"none"},"& .MuiDrawer-paper":{boxSizing:"border-box",width:wo,backgroundColor:"background.paper"}},children:x}),i.jsx(yf,{variant:"permanent",sx:{display:{xs:"none",sm:"block"},width:wo,flexShrink:0,"& .MuiDrawer-paper":{width:wo,boxSizing:"border-box",position:"relative",height:"100%",backgroundColor:"background.paper"}},open:!0,children:x}),i.jsxs(ye,{component:"main",sx:{flexGrow:1,p:3,width:{xs:"100%",sm:`calc(100% - ${wo}px)`},mt:{xs:8,sm:0},height:"100%",overflow:"auto"},children:[i.jsx(rl,{})," ",e]})]})},As=({children:e,allowedRoles:r})=>{const{user:t,isAuthenticated:n}=_n(),{showNotification:a}=ln();return C.useEffect(()=>{console.log("🔒 RoleBasedRoute checking access for path:",window.location.pathname),console.log("👤 User role:",t==null?void 0:t.role),console.log("✅ Allowed roles:",r),console.log("🔑 Access granted:",t&&t.role&&r.includes(t.role));const o=localStorage.getItem("token");if(o)try{const c=JSON.parse(atob(o.split(".")[1]));console.log("🔍 Token payload:",{exp:new Date(c.exp*1e3).toLocaleString(),roles:c.roles||c.authorities||c.role||"Not found in token",username:c.sub||c.username||"Not found in token"})}catch(c){console.error("Error parsing token:",c)}else console.warn("⚠️ No token available for role verification")},[t,r]),n?t?t.role&&r.some(o=>t.role.toUpperCase()===o.toUpperCase())?(console.log("✅ Access granted to:",window.location.pathname),i.jsx(i.Fragment,{children:e})):(console.error(`❌ Access denied: User role "${t.role||"unknown"}" not in allowed roles:`,r),a({type:"error",message:"Access denied: You do not have permission to view this page"}),i.jsx(Lo,{to:"/"})):(console.error("❌ User object is null or undefined"),a({type:"error",message:"Authentication error: User data is missing"}),i.jsx(Lo,{to:"/login"})):(console.warn("⚠️ User not authenticated, redirecting to login"),i.jsx(Lo,{to:"/login"}))},ks=e=>{let r="",t="";if(e&&e.name){const s=e.name.split(" ");r=s[0]||"",t=s.length>1?s.slice(1).join(" "):""}let n;try{if(e.dateOfBirth)if(/^\d{4}-\d{2}-\d{2}$/.test(e.dateOfBirth))n=e.dateOfBirth;else{const s=e.dateOfBirth.split(/[-/\.]/);let o;s.length===3?(s[0].length===4?o=new Date(`${s[0]}-${s[1]}-${s[2]}`):(o=new Date(`${s[2]}-${s[0]}-${s[1]}`),isNaN(o.getTime())&&(o=new Date(`${s[2]}-${s[1]}-${s[0]}`))),isNaN(o.getTime())?(console.warn(`Invalid date format "${e.dateOfBirth}" for student ${e.name||e.studentId}, using current date`),n=new Date().toISOString().split("T")[0]):n=o.toISOString().split("T")[0]):(o=new Date(e.dateOfBirth),isNaN(o.getTime())?(console.warn(`Invalid date format "${e.dateOfBirth}" for student ${e.name||e.studentId}, using current date`),n=new Date().toISOString().split("T")[0]):n=o.toISOString().split("T")[0])}else n=new Date().toISOString().split("T")[0]}catch(s){console.warn(`Error parsing date ${e.dateOfBirth} for student ${e.name||e.studentId}: ${s==null?void 0:s.message}`),n=new Date().toISOString().split("T")[0]}const a=parseInt(e.grade||"0",10);return{id:e.id,studentId:e.studentId||`ST${Date.now().toString().slice(-6)}`,firstName:r||"First",lastName:t||"Last",grade:isNaN(a)?1:a,section:e.section||"A",email:e.email||`student${Date.now()}@example.com`,contactNumber:e.phoneNumber||e.parentPhone||"0000000000",dateOfBirth:n,status:e.status||"ACTIVE",address:e.address||"Address not provided",guardianName:e.parentName||"Guardian",guardianContact:e.parentPhone||"0000000000",guardianEmail:e.parentEmail||e.email||"",guardianOccupation:e.guardianOccupation||"",guardianOfficeAddress:e.guardianOfficeAddress||"",aadharNumber:e.aadharNumber||"",udiseNumber:e.udiseNumber||"",houseAlloted:e.houseAlloted||"",guardianAnnualIncome:parseFloat(e.guardianAnnualIncome||"0")||0,previousSchool:e.previousSchool||"",tcNumber:e.tcNumber||"",tcReason:e.tcReason||"",tcDate:e.tcDate||"",whatsappNumber:e.whatsappNumber||"",subjects:e.subjects||"",transportMode:e.transportMode||"",busRouteNumber:e.busRouteNumber||"",admissionDate:e.admissionDate||new Date().toISOString().split("T")[0],bloodGroup:e.bloodGroup||"",gender:e.gender&&["MALE","FEMALE","OTHER"].includes(e.gender.toUpperCase())?e.gender.toUpperCase():"MALE",medicalConditions:e.medicalConditions||""}},Wr=e=>{var r;return{id:e.id,studentId:e.studentId,name:`${e.firstName} ${e.lastName}`.trim(),grade:e.grade.toString(),section:e.section,email:e.email,phoneNumber:e.contactNumber,dateOfBirth:e.dateOfBirth,status:e.status,address:e.address,parentName:e.guardianName,parentPhone:e.guardianContact,parentEmail:e.guardianEmail,guardianOccupation:e.guardianOccupation,guardianOfficeAddress:e.guardianOfficeAddress,aadharNumber:e.aadharNumber,udiseNumber:e.udiseNumber,houseAlloted:e.houseAlloted,guardianAnnualIncome:(r=e.guardianAnnualIncome)==null?void 0:r.toString(),previousSchool:e.previousSchool,tcNumber:e.tcNumber,tcReason:e.tcReason,tcDate:e.tcDate,whatsappNumber:e.whatsappNumber,subjects:e.subjects,transportMode:e.transportMode,busRouteNumber:e.busRouteNumber,admissionDate:e.admissionDate,bloodGroup:e.bloodGroup,gender:e.gender,medicalConditions:e.medicalConditions}};async function cl(e,r,t){const n=JSON.parse(localStorage.getItem("user")||sessionStorage.getItem("user")||"{}");if(n&&n.role==="ADMIN"){const o=localStorage.getItem("token")||sessionStorage.getItem("token");if(o)try{return await Mn({method:e,url:`${bt.apiUrl}${r}`,data:t,headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`}})}catch(c){throw console.error("Error with admin token:",c),c}}const s=localStorage.getItem("adminToken")||sessionStorage.getItem("adminToken");if(s)try{return await Mn({method:e,url:`${bt.apiUrl}${r}`,data:t,headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`}})}catch(o){throw console.error(`Error with admin token: ${o}`),sessionStorage.removeItem("adminToken"),localStorage.removeItem("adminToken"),new Error("Admin session expired. Please try again.")}else{const o=prompt("Admin username required for this action:"),c=prompt("Admin password required for this action:");if(!o||!c)throw new Error("Admin credentials required for this operation");try{const l=await Mn.post(`${bt.apiUrl}/api/auth/admin-login`,{username:o,password:c});if(l.data&&l.data.token)return sessionStorage.setItem("adminToken",l.data.token),await Mn({method:e,url:`${bt.apiUrl}${r}`,data:t,headers:{"Content-Type":"application/json",Authorization:`Bearer ${l.data.token}`}})}catch(l){throw console.error("Admin authentication failed:",l),new Error("Admin authentication failed. Please try again with correct credentials.")}}}const Tr={getAll:async()=>(await De.get("/api/students")).map(Wr),getAllStudents:async()=>(await De.get("/api/students")).map(Wr),getById:async e=>{const r=await De.get(`/api/students/${e}`);return Wr(r)},create:async e=>{const r=ks(e),t=await De.post("/api/students",r);return Wr(t)},update:async(e,r)=>{const t=ks({...r,id:e}),n=await De.put(`/api/students/${e}`,t);return Wr(n)},updateStatus:async(e,r)=>{try{console.log(`Updating student ${e} status to: ${r}`);const n={...await De.get(`/api/students/${e}`),status:r},a=await De.put(`/api/students/${e}`,n);return Wr(a)}catch(t){throw console.error("Error updating student status:",t),t}},delete:async e=>{try{return console.log(`Deleting student with ID: ${e}`),await De.delete(`/api/students/${e}`),{success:!0,message:"Student deleted successfully"}}catch(r){throw console.error("Error deleting student:",r),r}},getByGrade:async e=>(await De.get(`/api/students/grade/${e}`)).map(Wr),getByStatus:async e=>(await De.get(`/api/students/status/${e}`)).map(Wr),search:async e=>(await De.get(`/api/students/search?query=${e}`)).map(Wr),createWithElevatedPermissions:async e=>{const r=ks(e),t=await cl("post","/api/students",r);return t!=null&&t.data?Wr(t.data):null},updateWithElevatedPermissions:async(e,r)=>{const t=ks({...r,id:e}),n=await cl("put",`/api/students/${e}`,t);return n!=null&&n.data?Wr(n.data):null},createBulk:async e=>{const r=e.map(ks);return(await De.post("/api/students/bulk",{students:r,expectedCount:e.length})).map(Wr)},createBulkWithElevatedPermissions:async e=>{const r=e.map(ks),t=await cl("post","/api/students/bulk",{students:r,expectedCount:e.length});return t!=null&&t.data?t.data.map(Wr):[]}},Iu={getAll:()=>De.get("/staff"),getById:e=>De.get(`/staff/${e}`),create:e=>De.post("/staff",e),update:(e,r)=>De.put(`/staff/${e}`,r),delete:e=>De.delete(`/staff/${e}`),getAllTeachers:()=>De.get("/staff"),createTeacher:e=>De.post("/staff",e),updateTeacher:(e,r)=>De.put(`/staff/${e}`,r),deleteTeacher:e=>De.delete(`/staff/${e}`)},Is={getAll:()=>De.get("courses"),getById:e=>De.get(`courses/${e}`),create:e=>De.post("courses",e),update:(e,r)=>De.put(`courses/${e}`,r),delete:e=>De.delete(`courses/${e}`),enrollStudent:(e,r)=>De.post(`courses/${e}/enroll`,{studentId:r}),unenrollStudent:(e,r)=>De.delete(`courses/${e}/enroll?studentId=${r}`),getAllCourses:()=>De.get("courses")},an=({message:e="Loading...",size:r})=>i.jsxs(ye,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:2,minHeight:r?"auto":200},children:[i.jsx(sn,{size:r}),!r&&i.jsx(ee,{variant:"body1",color:"text.secondary",children:e})]}),on=({error:e,message:r,title:t,resetError:n,onRetry:a,className:s=""})=>{const[o,c]=C.useState(0),[l,u]=C.useState(!1),[d,f]=C.useState("unknown");if(r)return i.jsxs("div",{className:`error-message ${s}`,children:[t&&i.jsx("h4",{children:t}),i.jsx("p",{children:r})]});const h=(e==null?void 0:e.status)==="network_error",x=h&&!(e!=null&&e.isOffline),m=()=>e?typeof e=="string"?e:e.message?e.message:h?e.isOffline?"Your device appears to be offline. Please check your internet connection.":"Cannot connect to server. Please check if the backend server is running.":"An unexpected error occurred.":"",p=async()=>{if(!a&&!n)return;u(!0),c(3);const g=setInterval(()=>{c(w=>w<=1?(clearInterval(g),0):w-1)},1e3);setTimeout(async()=>{if(a)try{await a()}catch(w){console.error("Retry failed:",w)}else n&&n();u(!1)},3e3)};return C.useEffect(()=>{x&&bt.fallbackApiUrl&&(async()=>{try{await Mn.get(`${bt.fallbackApiUrl}/api/health`),f("available")}catch{f("unavailable")}})()},[x]),e?i.jsxs("div",{className:`bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative ${s}`,role:"alert",children:[i.jsx("strong",{className:"font-bold",children:"Error: "}),i.jsx("span",{className:"block sm:inline",children:m()}),h&&i.jsxs("div",{className:"mt-3",children:[e.isOffline?i.jsx("p",{className:"text-sm",children:"Your browser reports that you are currently offline. Please check your internet connection and try again."}):i.jsxs("div",{children:[i.jsx("p",{className:"text-sm mb-2",children:"The application cannot reach the server. This could be due to:"}),i.jsxs("ul",{className:"list-disc pl-5 text-sm mb-3",children:[i.jsx("li",{children:"The server is not running"}),i.jsx("li",{children:"There's a network issue between your browser and the server"}),i.jsx("li",{children:"A firewall is blocking the connection"}),i.jsx("li",{children:"The server URL is incorrect"})]}),d!=="unknown"&&i.jsxs("div",{className:"text-sm mb-3",children:[i.jsxs("p",{children:["Backup server status: "," ",d==="available"?i.jsx("span",{className:"text-green-600 font-semibold",children:"Available"}):i.jsx("span",{className:"text-red-600 font-semibold",children:"Unavailable"})]}),d==="available"&&i.jsx("p",{className:"mt-1",children:"The system will automatically try to use the backup server for your requests."})]})]}),n&&i.jsx("button",{onClick:p,disabled:l,className:`mt-2 px-4 py-2 rounded text-white ${l?"bg-gray-400 cursor-not-allowed":"bg-blue-500 hover:bg-blue-600"}`,children:l?`Retrying in ${o}s...`:"Retry Request"})]}),!h&&e.originalError&&i.jsxs("details",{className:"mt-3 text-sm",children:[i.jsx("summary",{className:"cursor-pointer text-gray-600",children:"View technical details"}),i.jsx("pre",{className:"mt-2 bg-gray-100 p-2 rounded overflow-auto max-h-40 text-xs",children:JSON.stringify(e.originalError,null,2)})]})]}):null},Ne={ADMIN:"ADMIN",TEACHER:"TEACHER",STAFF:"STAFF",PARENT:"PARENT",STUDENT:"STUDENT"},iw={CREATE_STUDENT:[Ne.ADMIN,Ne.STAFF],EDIT_STUDENT:[Ne.ADMIN,Ne.STAFF],DELETE_STUDENT:[Ne.ADMIN],VIEW_STUDENT:[Ne.ADMIN,Ne.TEACHER,Ne.STAFF,Ne.PARENT,Ne.STUDENT],CREATE_TEACHER:[Ne.ADMIN],EDIT_TEACHER:[Ne.ADMIN],DELETE_TEACHER:[Ne.ADMIN],VIEW_TEACHER:[Ne.ADMIN,Ne.STAFF,Ne.STUDENT],MANAGE_STAFF:[Ne.ADMIN],CREATE_COURSE:[Ne.ADMIN,Ne.STAFF],EDIT_COURSE:[Ne.ADMIN,Ne.STAFF],DELETE_COURSE:[Ne.ADMIN],VIEW_COURSE:[Ne.ADMIN,Ne.TEACHER,Ne.STAFF,Ne.STUDENT],MANAGE_ENROLLMENTS:[Ne.ADMIN,Ne.STAFF],VIEW_ENROLLMENTS:[Ne.ADMIN,Ne.STAFF,Ne.TEACHER],MANAGE_ASSIGNMENTS:[Ne.ADMIN,Ne.TEACHER],MANAGE_SCHEDULE:[Ne.ADMIN,Ne.STAFF],MANAGE_ATTENDANCE:[Ne.ADMIN,Ne.TEACHER],VIEW_ATTENDANCE:[Ne.ADMIN,Ne.TEACHER,Ne.STAFF,Ne.PARENT,Ne.STUDENT],MANAGE_EXAMS:[Ne.ADMIN,Ne.TEACHER],VIEW_EXAM_RESULTS:[Ne.ADMIN,Ne.TEACHER,Ne.STAFF,Ne.PARENT,Ne.STUDENT],MANAGE_GRADES:[Ne.ADMIN,Ne.TEACHER],MANAGE_FEES:[Ne.ADMIN,Ne.STAFF],VIEW_FEES:[Ne.ADMIN,Ne.STAFF,Ne.PARENT,Ne.STUDENT],MANAGE_ADMISSIONS:[Ne.ADMIN,Ne.STAFF],VIEW_ADMISSIONS:[Ne.ADMIN,Ne.STAFF],SEND_MESSAGE:[Ne.ADMIN,Ne.TEACHER,Ne.STAFF],VIEW_MESSAGE:[Ne.ADMIN,Ne.TEACHER,Ne.STAFF,Ne.PARENT,Ne.STUDENT],VIEW_ADMIN_DASHBOARD:[Ne.ADMIN,Ne.STAFF],VIEW_TEACHER_DASHBOARD:[Ne.TEACHER],VIEW_STUDENT_DASHBOARD:[Ne.STUDENT],VIEW_PARENT_DASHBOARD:[Ne.PARENT]},Lt=(e,r)=>{if(!e||!r)return!1;const t=iw[r]||[];return Object.values(Ne).includes(e)?t.includes(e):!1},zf=(e,r)=>!r||!Array.isArray(r)?!1:r.some(t=>Lt(e,t)),Gf=(e,r)=>!r||!Array.isArray(r)?!1:r.every(t=>Lt(e,t)),Bt={getAllFeeStructures:async()=>await De.get("/api/fees/structures"),getFeeStructureById:async e=>await De.get(`/api/fees/structures/${e}`),getFeeStructureByGrade:async e=>{try{return await De.get(`/api/fees/structures/grade/${e}`)}catch(r){return console.error(`Error fetching fee structure for grade ${e}:`,r),{id:1,classGrade:e,annualFees:25e3,buildingFees:5e3,labFees:3e3,totalFees:33e3,paymentSchedules:[],lateFees:[]}}},createFeeStructure:async e=>await De.post("/api/fees/structures",e),updateFeeStructure:async(e,r)=>await De.put(`/api/fees/structures/${e}`,r),deleteFeeStructure:async e=>await De.delete(`/api/fees/structures/${e}`),getAllTransportRoutes:async()=>await De.get("/api/fees/transport-routes"),getTransportRouteById:async e=>await De.get(`/api/fees/transport-routes/${e}`),createTransportRoute:async e=>await De.post("/api/fees/transport-routes",e),updateTransportRoute:async(e,r)=>await De.put(`/api/fees/transport-routes/${e}`,r),deleteTransportRoute:async e=>await De.delete(`/api/fees/transport-routes/${e}`),getAllPayments:async()=>await De.get("/api/fees/payments"),getPaymentById:async e=>await De.get(`/api/fees/payments/${e}`),getPaymentsByStudentId:async e=>{try{return await De.get(`/api/fees/payments/student/${e}`)}catch(r){return console.error(`Error fetching payment history for student ${e}:`,r),[]}},getPaymentSummaryByStudent:async e=>{try{return await De.get(`/api/fees/payments/summary/student/${e}`)}catch(r){return console.error(`Error fetching payment summary for student ${e}:`,r),{studentId:e,studentName:"Student",totalDue:25e3,totalPaid:15e3,balance:1e4,paymentStatus:"PARTIALLY_PAID",lastPaymentDate:new Date().toISOString(),nextDueDate:new Date(Date.now()+30*24*60*60*1e3).toISOString()}}},createPayment:async e=>await De.post("/api/fees/payments",e),updatePayment:async(e,r)=>await De.put(`/api/fees/payments/${e}`,r),voidPayment:async(e,r)=>await De.put(`/api/fees/payments/${e}/void`,{reason:r}),getPaymentReceipt:async e=>await De.get(`/api/fees/payments/${e}/receipt`),getPaymentAnalytics:async(e,r)=>{let t="/api/fees/analytics/payments";return e&&r&&(t+=`?startDate=${e}&endDate=${r}`),await De.get(t)},getPaymentDistribution:async e=>{let r="/api/fees/analytics/distribution";return e&&(r+=`?academicYear=${e}`),await De.get(r)},getRevenueTrend:async(e="monthly",r)=>{let t=`/api/fees/analytics/revenue-trend?period=${e}`;return r&&(t+=`&year=${r}`),await De.get(t)},getOverdueAnalytics:async()=>await De.get("/api/fees/analytics/overdue"),getStudentsWithOutstandingFees:async e=>{let r="/api/fees/analytics/outstanding";return e!==void 0&&(r+=`?gradeLevel=${e}`),await De.get(r)},generateFeesDueReport:async e=>{let r="/api/fees/reports/fees-due";return e!=null&&(r+=`?classGrade=${e}`),await De.get(r)},generateFeeStatusReport:async e=>{let r="/api/fees/reports/fee-status";return e!=null&&(r+=`?classGrade=${e}`),await De.get(r)},downloadFeeReport:async(e,r)=>{var t;try{let n=`/api/fees/reports/download/${e}`;r!=null&&(n+=`?classGrade=${r}`);const a=await Mn.get(n,{responseType:"blob",baseURL:bt.apiUrl,withCredentials:!0,headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),s=new Date().toISOString().split("T")[0],o=window.URL.createObjectURL(new Blob([a.data])),c=document.createElement("a");c.href=o,c.setAttribute("download",`Fee-Report-${e}-${s}.xlsx`),document.body.appendChild(c),c.click(),(t=c.parentNode)==null||t.removeChild(c)}catch(n){throw console.error("Error downloading fee report:",n),n}},exportPaymentData:async e=>{var r;try{const t=await Mn.post(`${bt.apiUrl}/api/payments/export`,e,{responseType:"blob",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}}),n=window.URL.createObjectURL(new Blob([t.data])),a=document.createElement("a");a.href=n,a.setAttribute("download",`Payments-${new Date().toISOString().split("T")[0]}.xlsx`),document.body.appendChild(a),a.click(),(r=a.parentNode)==null||r.removeChild(a)}catch(t){throw console.error("Error exporting payment data:",t),t}},getStudentFeeDetails:async e=>{try{const r=await Tr.getById(e),t=parseInt(r.grade||"10",10);let n;try{n=await De.get(`/api/fees/structures/grade/${t}`)}catch(a){console.error("Error fetching fee structure:",a),n={id:1,classGrade:t,annualFees:25e3,buildingFees:5e3,labFees:3e3,amount:33e3,totalFees:33e3}}return{studentId:e,studentFeeId:1,feeStructure:{id:n.id||1,classGrade:t,annualFees:n.annualFees||0,buildingFees:n.buildingFees||0,labFees:n.labFees||0,amount:n.totalFees||0,totalFees:n.totalFees||0}}}catch(r){return console.error("Error fetching real fee details, using mock data:",r),{studentId:e,studentFeeId:1,feeStructure:{id:1,classGrade:10,annualFees:25e3,buildingFees:5e3,labFees:3e3,amount:33e3,totalFees:33e3}}}},getStudentPaymentHistory:async e=>await De.get(`/api/fees/payments/student/${e}`),downloadReceipt:async e=>{var r;try{const t=await Mn.get(`${bt.apiUrl}/api/payments/${e}/receipt`,{responseType:"blob",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),n=window.URL.createObjectURL(new Blob([t.data])),a=document.createElement("a");a.href=n,a.setAttribute("download",`Receipt-${e}.pdf`),document.body.appendChild(a),a.click(),(r=a.parentNode)==null||r.removeChild(a)}catch(t){throw console.error("Error downloading receipt:",t),t}}};function ow(e,...r){const t=new URL(`https://mui.com/production-error/?code=${e}`);return r.forEach(n=>t.searchParams.append("args[]",n)),`Minified MUI error #${e}; visit ${t} for the full message.`}const cw=be.oneOfType([be.func,be.object]),um=cw;function lw(e){if(typeof e!="string")throw new Error(ow(7));return e.charAt(0).toUpperCase()+e.slice(1)}function ll(e){return e&&e.ownerDocument||document}const uw=typeof window<"u"?C.useLayoutEffect:C.useEffect,Bn=uw;let Yf=0;function dw(e){const[r,t]=C.useState(e),n=e||r;return C.useEffect(()=>{r==null&&(Yf+=1,t(`mui-${Yf}`))},[r]),n}const fw={...nv},qf=fw.useId;function _c(e){if(qf!==void 0){const r=qf();return e??r}return dw(e)}function Gs(e){const{controlled:r,default:t,name:n,state:a="value"}=e,{current:s}=C.useRef(r!==void 0),[o,c]=C.useState(t),l=s?r:o,u=C.useCallback(d=>{s||c(d)},[]);return[l,u]}function Ue(e){const r=C.useRef(e);return Bn(()=>{r.current=e}),C.useRef((...t)=>(0,r.current)(...t)).current}function Ur(...e){const r=C.useRef(void 0),t=C.useCallback(n=>{const a=e.map(s=>{if(s==null)return null;if(typeof s=="function"){const o=s,c=o(n);return typeof c=="function"?c:()=>{o(null)}}return s.current=n,()=>{s.current=null}});return()=>{a.forEach(s=>s==null?void 0:s())}},e);return C.useMemo(()=>e.every(n=>n==null)?null:n=>{r.current&&(r.current(),r.current=void 0),n!=null&&(r.current=t(n))},e)}const Xf={};function hw(e,r){const t=C.useRef(Xf);return t.current===Xf&&(t.current=e(r)),t}const pw=[];function mw(e){C.useEffect(e,pw)}class Pu{constructor(){Le(this,"currentId",null);Le(this,"clear",()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)});Le(this,"disposeEffect",()=>this.clear)}static create(){return new Pu}start(r,t){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,t()},r)}}function Ns(){const e=hw(Pu.create).current;return mw(e.disposeEffect),e}const xw={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:"1px"},gw=xw;function Rt(e,r,t=void 0){const n={};for(const a in e){const s=e[a];let o="",c=!0;for(let l=0;l<s.length;l+=1){const u=s[l];u&&(o+=(c===!0?"":" ")+r(u),c=!1,t&&t[u]&&(o+=" "+t[u]))}n[a]=o}return n}const Kf=e=>e,yw=()=>{let e=Kf;return{configure(r){e=r},generate(r){return e(r)},reset(){e=Kf}}},vw=yw(),bw=vw,ww={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function Xt(e,r,t="Mui"){const n=ww[r];return n?`${t}-${n}`:`${bw.generate(e)}-${r}`}function er(e,r,t="Mui"){const n={};return r.forEach(a=>{n[a]=Xt(e,a,t)}),n}function Sw(e){return typeof e=="string"}function Ew(e,r,t){return e===void 0||Sw(e)?r:{...r,ownerState:{...r.ownerState,...t}}}function Tw(e,r=[]){if(e===void 0)return{};const t={};return Object.keys(e).filter(n=>n.match(/^on[A-Z]/)&&typeof e[n]=="function"&&!r.includes(n)).forEach(n=>{t[n]=e[n]}),t}function Jf(e){if(e===void 0)return{};const r={};return Object.keys(e).filter(t=>!(t.match(/^on[A-Z]/)&&typeof e[t]=="function")).forEach(t=>{r[t]=e[t]}),r}function Aw(e){const{getSlotProps:r,additionalProps:t,externalSlotProps:n,externalForwardedProps:a,className:s}=e;if(!r){const x=Qt(t==null?void 0:t.className,s,a==null?void 0:a.className,n==null?void 0:n.className),m={...t==null?void 0:t.style,...a==null?void 0:a.style,...n==null?void 0:n.style},p={...t,...a,...n};return x.length>0&&(p.className=x),Object.keys(m).length>0&&(p.style=m),{props:p,internalRef:void 0}}const o=Tw({...a,...n}),c=Jf(n),l=Jf(a),u=r(o),d=Qt(u==null?void 0:u.className,t==null?void 0:t.className,s,a==null?void 0:a.className,n==null?void 0:n.className),f={...u==null?void 0:u.style,...t==null?void 0:t.style,...a==null?void 0:a.style,...n==null?void 0:n.style},h={...u,...t,...l,...c};return d.length>0&&(h.className=d),Object.keys(f).length>0&&(h.style=f),{props:h,internalRef:u.ref}}function $i(e,r,t){return typeof e=="function"?e(r,t):e}function ht(e){var f;const{elementType:r,externalSlotProps:t,ownerState:n,skipResolvingSlotProps:a=!1,...s}=e,o=a?{}:$i(t,n),{props:c,internalRef:l}=Aw({...s,externalSlotProps:o}),u=Ur(l,o==null?void 0:o.ref,(f=e.additionalProps)==null?void 0:f.ref);return Ew(r,{...c,ref:u},n)}const kw=["localeText"],Gl=C.createContext(null),dm=function(r){const{localeText:t}=r,n=Qe(r,kw),{utils:a,localeText:s}=C.useContext(Gl)??{utils:void 0,localeText:void 0},o=Dt({props:n,name:"MuiLocalizationProvider"}),{children:c,dateAdapter:l,dateFormats:u,dateLibInstance:d,adapterLocale:f,localeText:h}=o,x=C.useMemo(()=>ie({},h,s,t),[h,s,t]),m=C.useMemo(()=>{if(!l)return a||null;const w=new l({locale:f,formats:u,instance:d});if(!w.isMUIAdapter)throw new Error(["MUI X: The date adapter should be imported from `@mui/x-date-pickers` or `@mui/x-date-pickers-pro`, not from `@date-io`","For example, `import { AdapterDayjs } from '@mui/x-date-pickers/AdapterDayjs'` instead of `import AdapterDayjs from '@date-io/dayjs'`","More information on the installation documentation: https://mui.com/x/react-date-pickers/quickstart/#installation"].join(`
`));return w},[l,f,u,d,a]),p=C.useMemo(()=>m?{minDate:m.date("1900-01-01T00:00:00.000"),maxDate:m.date("2099-12-31T00:00:00.000")}:null,[m]),g=C.useMemo(()=>({utils:m,defaultDates:p,localeText:x}),[p,m,x]);return i.jsx(Gl.Provider,{value:g,children:c})},Cw=e=>({components:{MuiLocalizationProvider:{defaultProps:{localeText:ie({},e)}}}}),fm={previousMonth:"Previous month",nextMonth:"Next month",openPreviousView:"Open previous view",openNextView:"Open next view",calendarViewSwitchingButtonAriaLabel:e=>e==="year"?"year view is open, switch to calendar view":"calendar view is open, switch to year view",start:"Start",end:"End",startDate:"Start date",startTime:"Start time",endDate:"End date",endTime:"End time",cancelButtonLabel:"Cancel",clearButtonLabel:"Clear",okButtonLabel:"OK",todayButtonLabel:"Today",nextStepButtonLabel:"Next",datePickerToolbarTitle:"Select date",dateTimePickerToolbarTitle:"Select date & time",timePickerToolbarTitle:"Select time",dateRangePickerToolbarTitle:"Select date range",timeRangePickerToolbarTitle:"Select time range",clockLabelText:(e,r)=>`Select ${e}. ${r?`Selected time is ${r}`:"No time selected"}`,hoursClockNumberText:e=>`${e} hours`,minutesClockNumberText:e=>`${e} minutes`,secondsClockNumberText:e=>`${e} seconds`,selectViewText:e=>`Select ${e}`,calendarWeekNumberHeaderLabel:"Week number",calendarWeekNumberHeaderText:"#",calendarWeekNumberAriaLabelText:e=>`Week ${e}`,calendarWeekNumberText:e=>`${e}`,openDatePickerDialogue:e=>e?`Choose date, selected date is ${e}`:"Choose date",openTimePickerDialogue:e=>e?`Choose time, selected time is ${e}`:"Choose time",openRangePickerDialogue:e=>e?`Choose range, selected range is ${e}`:"Choose range",fieldClearLabel:"Clear",timeTableLabel:"pick time",dateTableLabel:"pick date",fieldYearPlaceholder:e=>"Y".repeat(e.digitAmount),fieldMonthPlaceholder:e=>e.contentType==="letter"?"MMMM":"MM",fieldDayPlaceholder:()=>"DD",fieldWeekDayPlaceholder:e=>e.contentType==="letter"?"EEEE":"EE",fieldHoursPlaceholder:()=>"hh",fieldMinutesPlaceholder:()=>"mm",fieldSecondsPlaceholder:()=>"ss",fieldMeridiemPlaceholder:()=>"aa",year:"Year",month:"Month",day:"Day",weekDay:"Week day",hours:"Hours",minutes:"Minutes",seconds:"Seconds",meridiem:"Meridiem",empty:"Empty"},_w=fm;Cw(fm);const ls=()=>{const e=C.useContext(Gl);if(e===null)throw new Error(["MUI X: Can not find the date and time pickers localization context.","It looks like you forgot to wrap your component in LocalizationProvider.","This can also happen if you are bundling multiple versions of the `@mui/x-date-pickers` package"].join(`
`));if(e.utils===null)throw new Error(["MUI X: Can not find the date and time pickers adapter from its localization context.","It looks like you forgot to pass a `dateAdapter` to your LocalizationProvider."].join(`
`));const r=C.useMemo(()=>ie({},_w,e.localeText),[e.localeText]);return C.useMemo(()=>ie({},e,{localeText:r}),[e,r])},St=()=>ls().utils,Dw=()=>ls().defaultDates,Dc=e=>{const r=St(),t=C.useRef(void 0);return t.current===void 0&&(t.current=r.date(void 0,e)),t.current},Aa=()=>ls().localeText,Fw=Ta(i.jsx("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),jw=Ta(i.jsx("path",{d:"M15.41 16.59L10.83 12l4.58-4.59L14 6l-6 6 6 6 1.41-1.41z"}),"ArrowLeft"),Iw=Ta(i.jsx("path",{d:"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"}),"ArrowRight"),Pw=Ta(i.jsx("path",{d:"M17 12h-5v5h5v-5zM16 1v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-1V1h-2zm3 18H5V8h14v11z"}),"Calendar");Ta(i.jsxs(C.Fragment,{children:[i.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),i.jsx("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"})]}),"Clock");Ta(i.jsx("path",{d:"M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z"}),"DateRange");Ta(i.jsxs(C.Fragment,{children:[i.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),i.jsx("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"})]}),"Time");const Ow=Ta(i.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Clear");function Rw(e){return Xt("MuiPickersArrowSwitcher",e)}er("MuiPickersArrowSwitcher",["root","spacer","button","previousIconButton","nextIconButton","leftArrowIcon","rightArrowIcon"]);const hm=C.createContext(()=>!0);function Nw(){return C.useContext(hm)}const pm=C.createContext(null);function mm(){return C.useContext(pm)}const Ou=C.createContext(null),ti=()=>{const e=C.useContext(Ou);if(e==null)throw new Error("MUI X: The `usePickerContext` hook can only be called inside the context of a Picker component");return e},xm=C.createContext(null),gm=C.createContext({ownerState:{isPickerDisabled:!1,isPickerReadOnly:!1,isPickerValueEmpty:!1,isPickerOpen:!1,pickerVariant:"desktop",pickerOrientation:"portrait"},rootRefObject:{current:null},labelId:void 0,dismissViews:()=>{},hasUIView:!0,getCurrentViewMode:()=>"UI",triggerElement:null,viewContainerRole:null,defaultActionBarActions:[],onPopperExited:void 0});function ym(e){const{contextValue:r,actionsContextValue:t,privateContextValue:n,fieldPrivateContextValue:a,isValidContextValue:s,localeText:o,children:c}=e;return i.jsx(Ou.Provider,{value:r,children:i.jsx(xm.Provider,{value:t,children:i.jsx(gm.Provider,{value:n,children:i.jsx(pm.Provider,{value:a,children:i.jsx(hm.Provider,{value:s,children:i.jsx(dm,{localeText:o,children:c})})})})})})}const dr=()=>C.useContext(gm),Mw=["children","className","slots","slotProps","isNextDisabled","isNextHidden","onGoToNext","nextLabel","isPreviousDisabled","isPreviousHidden","onGoToPrevious","previousLabel","labelId","classes"],Lw=["ownerState"],Bw=["ownerState"],$w=Ge("div",{name:"MuiPickersArrowSwitcher",slot:"Root"})({display:"flex"}),Uw=Ge("div",{name:"MuiPickersArrowSwitcher",slot:"Spacer"})(({theme:e})=>({width:e.spacing(3)})),Qf=Ge(Ze,{name:"MuiPickersArrowSwitcher",slot:"Button"})({variants:[{props:{isButtonHidden:!0},style:{visibility:"hidden"}}]}),Vw=e=>Rt({root:["root"],spacer:["spacer"],button:["button"],previousIconButton:["previousIconButton"],nextIconButton:["nextIconButton"],leftArrowIcon:["leftArrowIcon"],rightArrowIcon:["rightArrowIcon"]},Rw,e),Ww=C.forwardRef(function(r,t){const n=ra(),a=Dt({props:r,name:"MuiPickersArrowSwitcher"}),{children:s,className:o,slots:c,slotProps:l,isNextDisabled:u,isNextHidden:d,onGoToNext:f,nextLabel:h,isPreviousDisabled:x,isPreviousHidden:m,onGoToPrevious:p,previousLabel:g,labelId:w,classes:y}=a,v=Qe(a,Mw),{ownerState:T}=dr(),F=Vw(y),A={isDisabled:u,isHidden:d,goTo:f,label:h},S={isDisabled:x,isHidden:m,goTo:p,label:g},E=(c==null?void 0:c.previousIconButton)??Qf,b=ht({elementType:E,externalSlotProps:l==null?void 0:l.previousIconButton,additionalProps:{size:"medium",title:S.label,"aria-label":S.label,disabled:S.isDisabled,edge:"end",onClick:S.goTo},ownerState:ie({},T,{isButtonHidden:S.isHidden??!1}),className:Qt(F.button,F.previousIconButton)}),k=(c==null?void 0:c.nextIconButton)??Qf,j=ht({elementType:k,externalSlotProps:l==null?void 0:l.nextIconButton,additionalProps:{size:"medium",title:A.label,"aria-label":A.label,disabled:A.isDisabled,edge:"start",onClick:A.goTo},ownerState:ie({},T,{isButtonHidden:A.isHidden??!1}),className:Qt(F.button,F.nextIconButton)}),_=(c==null?void 0:c.leftArrowIcon)??jw,B=ht({elementType:_,externalSlotProps:l==null?void 0:l.leftArrowIcon,additionalProps:{fontSize:"inherit"},ownerState:T,className:F.leftArrowIcon}),Q=Qe(B,Lw),Z=(c==null?void 0:c.rightArrowIcon)??Iw,L=ht({elementType:Z,externalSlotProps:l==null?void 0:l.rightArrowIcon,additionalProps:{fontSize:"inherit"},ownerState:T,className:F.rightArrowIcon}),q=Qe(L,Bw);return i.jsxs($w,ie({ref:t,className:Qt(F.root,o),ownerState:T},v,{children:[i.jsx(E,ie({},b,{children:n?i.jsx(Z,ie({},q)):i.jsx(_,ie({},Q))})),s?i.jsx(ee,{variant:"subtitle1",component:"span",id:w,children:s}):i.jsx(Uw,{className:F.spacer,ownerState:T}),i.jsx(k,ie({},j,{children:n?i.jsx(_,ie({},Q)):i.jsx(Z,ie({},q))}))]}))}),ui=(e,r)=>e.length!==r.length?!1:r.every(t=>e.includes(t)),Hw=({openTo:e,defaultOpenTo:r,views:t,defaultViews:n})=>{const a=t??n;let s;if(e!=null)s=e;else if(a.includes(r))s=r;else if(a.length>0)s=a[0];else throw new Error("MUI X: The `views` prop must contain at least one view.");return{views:a,openTo:s}},zw=["hours","minutes","seconds"],Gw=e=>zw.includes(e),Zf=(e,r)=>r.getHours(e)*3600+r.getMinutes(e)*60+r.getSeconds(e),Yw=(e,r)=>(t,n)=>e?r.isAfter(t,n):Zf(t,r)>Zf(n,r),vm={hasNextStep:!1,hasSeveralSteps:!1,goToNextStep:()=>{},areViewsInSameStep:()=>!0};function qw(e){const{steps:r,isViewMatchingStep:t,onStepChange:n}=e;return a=>{if(r==null)return vm;const s=r.findIndex(c=>t(a.view,c)),o=s===-1||s===r.length-1?null:r[s+1];return{hasNextStep:o!=null,hasSeveralSteps:r.length>1,goToNextStep:()=>{o!=null&&n(ie({},a,{step:o}))},areViewsInSameStep:(c,l)=>{const u=r.find(f=>t(c,f)),d=r.find(f=>t(l,f));return u===d}}}}function bm({onChange:e,onViewChange:r,openTo:t,view:n,views:a,autoFocus:s,focusedView:o,onFocusedViewChange:c,getStepNavigation:l}){const u=C.useRef(t),d=C.useRef(a),f=C.useRef(a.includes(t)?t:a[0]),[h,x]=Gs({name:"useViews",state:"view",controlled:n,default:f.current}),m=C.useRef(s?h:null),[p,g]=Gs({name:"useViews",state:"focusedView",controlled:o,default:m.current}),w=l?l({setView:x,view:h,defaultView:f.current,views:a}):vm;C.useEffect(()=>{(u.current&&u.current!==t||d.current&&d.current.some(b=>!a.includes(b)))&&(x(a.includes(t)?t:a[0]),d.current=a,u.current=t)},[t,x,h,a]);const y=a.indexOf(h),v=a[y-1]??null,T=a[y+1]??null,F=Ue((b,k)=>{g(k?b:j=>b===j?null:j),c==null||c(b,k)}),A=Ue(b=>{F(b,!0),b!==h&&(x(b),r&&r(b))}),S=Ue(()=>{T&&A(T)}),E=Ue((b,k,j)=>{const _=k==="finish",B=j?a.indexOf(j)<a.length-1:!!T;e(b,_&&B?"partial":k,j);let Z=null;if(j!=null&&j!==h?Z=j:_&&(Z=h),Z==null)return;const L=a[a.indexOf(Z)+1];L==null||!w.areViewsInSameStep(Z,L)||A(L)});return ie({},w,{view:h,setView:A,focusedView:p,setFocusedView:F,nextView:T,previousView:v,defaultView:a.includes(t)?t:a[0],goToNextView:S,setValueAndGoToNextView:E})}function Xw(e,{disableFuture:r,maxDate:t,timezone:n}){const a=St();return C.useMemo(()=>{const s=a.date(void 0,n),o=a.startOfMonth(r&&a.isBefore(s,t)?s:t);return!a.isAfter(o,e)},[r,t,e,a,n])}function Kw(e,{disablePast:r,minDate:t,timezone:n}){const a=St();return C.useMemo(()=>{const s=a.date(void 0,n),o=a.startOfMonth(r&&a.isAfter(s,t)?s:t);return!a.isBefore(o,e)},[r,t,e,a,n])}const Ui=36,Fc=2,jc=320,Jw=280,Ru=336,Qw=Ge("div")({overflow:"hidden",width:jc,maxHeight:Ru,display:"flex",flexDirection:"column",margin:"0 auto"}),Qo=(e,r,t)=>{let n=r;return n=e.setHours(n,e.getHours(t)),n=e.setMinutes(n,e.getMinutes(t)),n=e.setSeconds(n,e.getSeconds(t)),n=e.setMilliseconds(n,e.getMilliseconds(t)),n},Vi=({date:e,disableFuture:r,disablePast:t,maxDate:n,minDate:a,isDateDisabled:s,utils:o,timezone:c})=>{const l=Qo(o,o.date(void 0,c),e);t&&o.isBefore(a,l)&&(a=l),r&&o.isAfter(n,l)&&(n=l);let u=e,d=e;for(o.isBefore(e,a)&&(u=a,d=null),o.isAfter(e,n)&&(d&&(d=n),u=null);u||d;){if(u&&o.isAfter(u,n)&&(u=null),d&&o.isBefore(d,a)&&(d=null),u){if(!s(u))return u;u=o.addDays(u,1)}if(d){if(!s(d))return d;d=o.addDays(d,-1)}}return null},Zw=(e,r)=>e.isValid(r)?r:null,e0=(e,r,t)=>r==null||!e.isValid(r)?t:r,e2=(e,r,t)=>!e.isValid(r)&&r!=null&&!e.isValid(t)&&t!=null?!0:e.isEqual(r,t),Nu=(e,r)=>{const n=[e.startOfYear(r)];for(;n.length<12;){const a=n[n.length-1];n.push(e.addMonths(a,1))}return n},wm=(e,r,t)=>t==="date"?e.startOfDay(e.date(void 0,r)):e.date(void 0,r),t2=["year","month","day"],t0=e=>t2.includes(e),Mu=(e,{format:r,views:t},n)=>{if(r!=null)return r;const a=e.formats;return ui(t,["year"])?a.year:ui(t,["month"])?a.month:ui(t,["day"])?a.dayOfMonth:ui(t,["month","year"])?`${a.month} ${a.year}`:ui(t,["day","month"])?`${a.month} ${a.dayOfMonth}`:n?/en/.test(e.getCurrentLocaleCode())?a.normalDateWithWeekday:a.normalDate:a.keyboardDate},r2=(e,r)=>{const t=e.startOfWeek(r);return[0,1,2,3,4,5,6].map(n=>e.addDays(t,n))},so=({name:e,timezone:r,value:t,defaultValue:n,referenceDate:a,onChange:s,valueManager:o})=>{const c=St(),[l,u]=Gs({name:e,state:"value",controlled:t,default:n??o.emptyValue}),d=C.useMemo(()=>o.getTimezone(c,l),[c,o,l]),f=Ue(p=>d==null?p:o.setTimezone(c,d,p)),h=C.useMemo(()=>r||d||(a?c.getTimezone(a):"default"),[r,d,a,c]),x=C.useMemo(()=>o.setTimezone(c,h,l),[o,c,h,l]),m=Ue((p,...g)=>{const w=f(p);u(w),s==null||s(w,...g)});return{value:x,handleValueChange:m,timezone:h}},Pn={year:1,month:2,day:3,hours:4,minutes:5,seconds:6,milliseconds:7},n2=e=>Math.max(...e.map(r=>Pn[r.type]??1)),di=(e,r,t)=>{if(r===Pn.year)return e.startOfYear(t);if(r===Pn.month)return e.startOfMonth(t);if(r===Pn.day)return e.startOfDay(t);let n=t;return r<Pn.minutes&&(n=e.setMinutes(n,0)),r<Pn.seconds&&(n=e.setSeconds(n,0)),r<Pn.milliseconds&&(n=e.setMilliseconds(n,0)),n},a2=({props:e,utils:r,granularity:t,timezone:n,getTodayDate:a})=>{let s=a?a():di(r,t,wm(r,n));e.minDate!=null&&r.isAfterDay(e.minDate,s)&&(s=di(r,t,e.minDate)),e.maxDate!=null&&r.isBeforeDay(e.maxDate,s)&&(s=di(r,t,e.maxDate));const o=Yw(e.disableIgnoringDatePartForTimeValidation??!1,r);return e.minTime!=null&&o(e.minTime,s)&&(s=di(r,t,e.disableIgnoringDatePartForTimeValidation?e.minTime:Qo(r,s,e.minTime))),e.maxTime!=null&&o(s,e.maxTime)&&(s=di(r,t,e.disableIgnoringDatePartForTimeValidation?e.maxTime:Qo(r,s,e.maxTime))),s},Sm=(e,r)=>{const t=e.formatTokenMap[r];if(t==null)throw new Error([`MUI X: The token "${r}" is not supported by the Date and Time Pickers.`,"Please try using another token or open an issue on https://github.com/mui/mui-x/issues/new/choose if you think it should be supported."].join(`
`));return typeof t=="string"?{type:t,contentType:t==="meridiem"?"letter":"digit",maxLength:void 0}:{type:t.sectionType,contentType:t.contentType,maxLength:t.maxLength}},Ic=(e,r)=>{const t=[],n=e.date(void 0,"default"),a=e.startOfWeek(n),s=e.endOfWeek(n);let o=a;for(;e.isBefore(o,s);)t.push(o),o=e.addDays(o,1);return t.map(c=>e.formatByString(c,r))},Em=(e,r,t,n)=>{switch(t){case"month":return Nu(e,e.date(void 0,r)).map(a=>e.formatByString(a,n));case"weekDay":return Ic(e,n);case"meridiem":{const a=e.date(void 0,r);return[e.startOfDay(a),e.endOfDay(a)].map(s=>e.formatByString(s,n))}default:return[]}},r0="s",s2=["0","1","2","3","4","5","6","7","8","9"],i2=e=>{const r=e.date(void 0);return e.formatByString(e.setSeconds(r,0),r0)==="0"?s2:Array.from({length:10}).map((n,a)=>e.formatByString(e.setSeconds(r,a),r0))},as=(e,r)=>{if(r[0]==="0")return e;const t=[];let n="";for(let a=0;a<e.length;a+=1){n+=e[a];const s=r.indexOf(n);s>-1&&(t.push(s.toString()),n="")}return t.join("")},Lu=(e,r)=>r[0]==="0"?e:e.split("").map(t=>r[Number(t)]).join(""),n0=(e,r)=>{const t=as(e,r);return t!==" "&&!Number.isNaN(Number(t))},Bu=(e,r)=>Number(e).toString().padStart(r,"0"),Tm=(e,r,t,n,a)=>{if(a.type==="day"&&a.contentType==="digit-with-letter"){const o=e.setDate(t.longestMonth,r);return e.formatByString(o,a.format)}let s=r.toString();return a.hasLeadingZerosInInput&&(s=Bu(s,a.maxLength)),Lu(s,n)},$u=(e,r,t)=>{let n=e.value||e.placeholder;const a=r==="non-input"?e.hasLeadingZerosInFormat:e.hasLeadingZerosInInput;return r==="non-input"&&e.hasLeadingZerosInInput&&!e.hasLeadingZerosInFormat&&(n=Number(as(n,t)).toString()),["input-rtl","input-ltr"].includes(r)&&e.contentType==="digit"&&!a&&n.length===1&&(n=`${n}‎`),r==="input-rtl"&&(n=`⁨${n}⁩`),n},a0=(e,r,t,n)=>e.formatByString(e.parse(r,t),n),o2=(e,r)=>e.formatByString(e.date(void 0,"system"),r).length===4,Am=(e,r,t,n)=>{if(r!=="digit")return!1;const a=e.date(void 0,"default");switch(t){case"year":return e.lib==="dayjs"&&n==="YY"?!0:e.formatByString(e.setYear(a,1),n).startsWith("0");case"month":return e.formatByString(e.startOfYear(a),n).length>1;case"day":return e.formatByString(e.startOfMonth(a),n).length>1;case"weekDay":return e.formatByString(e.startOfWeek(a),n).length>1;case"hours":return e.formatByString(e.setHours(a,1),n).length>1;case"minutes":return e.formatByString(e.setMinutes(a,1),n).length>1;case"seconds":return e.formatByString(e.setSeconds(a,1),n).length>1;default:throw new Error("Invalid section type")}},c2=(e,r,t)=>{const n=r.some(l=>l.type==="day"),a=[],s=[];for(let l=0;l<r.length;l+=1){const u=r[l];n&&u.type==="weekDay"||(a.push(u.format),s.push($u(u,"non-input",t)))}const o=a.join(" "),c=s.join(" ");return e.parse(c,o)},l2=e=>e.map(r=>`${r.startSeparator}${r.value||r.placeholder}${r.endSeparator}`).join(""),u2=(e,r,t)=>{const a=e.map(s=>{const o=$u(s,t?"input-rtl":"input-ltr",r);return`${s.startSeparator}${o}${s.endSeparator}`}).join("");return t?`⁦${a}⁩`:a},d2=(e,r,t)=>{const n=e.date(void 0,t),a=e.endOfYear(n),s=e.endOfDay(n),{maxDaysInMonth:o,longestMonth:c}=Nu(e,n).reduce((l,u)=>{const d=e.getDaysInMonth(u);return d>l.maxDaysInMonth?{maxDaysInMonth:d,longestMonth:u}:l},{maxDaysInMonth:0,longestMonth:null});return{year:({format:l})=>({minimum:0,maximum:o2(e,l)?9999:99}),month:()=>({minimum:1,maximum:e.getMonth(a)+1}),day:({currentDate:l})=>({minimum:1,maximum:e.isValid(l)?e.getDaysInMonth(l):o,longestMonth:c}),weekDay:({format:l,contentType:u})=>{if(u==="digit"){const d=Ic(e,l).map(Number);return{minimum:Math.min(...d),maximum:Math.max(...d)}}return{minimum:1,maximum:7}},hours:({format:l})=>{const u=e.getHours(s);return as(e.formatByString(e.endOfDay(n),l),r)!==u.toString()?{minimum:1,maximum:Number(as(e.formatByString(e.startOfDay(n),l),r))}:{minimum:0,maximum:u}},minutes:()=>({minimum:0,maximum:e.getMinutes(s)}),seconds:()=>({minimum:0,maximum:e.getSeconds(s)}),meridiem:()=>({minimum:0,maximum:1}),empty:()=>({minimum:0,maximum:0})}},f2=(e,r,t,n)=>{switch(r.type){case"year":return e.setYear(n,e.getYear(t));case"month":return e.setMonth(n,e.getMonth(t));case"weekDay":{let a=e.formatByString(t,r.format);r.hasLeadingZerosInInput&&(a=Bu(a,r.maxLength));const s=Ic(e,r.format),o=s.indexOf(a),l=s.indexOf(r.value)-o;return e.addDays(t,l)}case"day":return e.setDate(n,e.getDate(t));case"meridiem":{const a=e.getHours(t)<12,s=e.getHours(n);return a&&s>=12?e.addHours(n,-12):!a&&s<12?e.addHours(n,12):n}case"hours":return e.setHours(n,e.getHours(t));case"minutes":return e.setMinutes(n,e.getMinutes(t));case"seconds":return e.setSeconds(n,e.getSeconds(t));default:return n}},s0={year:1,month:2,day:3,weekDay:4,hours:5,minutes:6,seconds:7,meridiem:8,empty:9},i0=(e,r,t,n,a)=>[...t].sort((s,o)=>s0[s.type]-s0[o.type]).reduce((s,o)=>!a||o.modified?f2(e,o,r,s):s,n),h2=()=>navigator.userAgent.toLowerCase().includes("android"),p2=(e,r)=>{const t={};if(!r)return e.forEach((l,u)=>{const d=u===0?null:u-1,f=u===e.length-1?null:u+1;t[u]={leftIndex:d,rightIndex:f}}),{neighbors:t,startIndex:0,endIndex:e.length-1};const n={},a={};let s=0,o=0,c=e.length-1;for(;c>=0;){o=e.findIndex((l,u)=>{var d;return u>=s&&((d=l.endSeparator)==null?void 0:d.includes(" "))&&l.endSeparator!==" / "}),o===-1&&(o=e.length-1);for(let l=o;l>=s;l-=1)a[l]=c,n[c]=l,c-=1;s=o+1}return e.forEach((l,u)=>{const d=a[u],f=d===0?null:n[d-1],h=d===e.length-1?null:n[d+1];t[u]={leftIndex:f,rightIndex:h}}),{neighbors:t,startIndex:n[0],endIndex:n[e.length-1]}},Yl=(e,r)=>{if(e==null)return null;if(e==="all")return"all";if(typeof e=="string"){const t=r.findIndex(n=>n.type===e);return t===-1?null:t}return e},m2=["value","referenceDate"],$n={emptyValue:null,getTodayValue:wm,getInitialReferenceValue:e=>{let{value:r,referenceDate:t}=e,n=Qe(e,m2);return n.utils.isValid(r)?r:t??a2(n)},cleanValue:Zw,areValuesEqual:e2,isSameError:(e,r)=>e===r,hasError:e=>e!=null,defaultErrorState:null,getTimezone:(e,r)=>e.isValid(r)?e.getTimezone(r):null,setTimezone:(e,r,t)=>t==null?null:e.setTimezone(t,r)},x2={updateReferenceValue:(e,r,t)=>e.isValid(r)?r:t,getSectionsFromValue:(e,r)=>r(e),getV7HiddenInputValueFromSections:l2,getV6InputValueFromSections:u2,parseValueStr:(e,r,t)=>t(e.trim(),r),getDateFromSection:e=>e,getDateSectionsFromValue:e=>e,updateDateInValue:(e,r,t)=>t,clearDateSections:e=>e.map(r=>ie({},r,{value:""}))};function g2(e,r){return Array.isArray(r)?r.every(t=>e.indexOf(t)!==-1):e.indexOf(r)!==-1}const y2=e=>{setTimeout(e,0)},xr=(e=document)=>{const r=e.activeElement;return r?r.shadowRoot?xr(r.shadowRoot):r:null},v2="@media (pointer: fine)";function b2(e){return Xt("MuiPickersDay",e)}const ja=er("MuiPickersDay",["root","dayWithMargin","dayOutsideMonth","hiddenDaySpacingFiller","today","selected","disabled"]);function km(e){const{disabled:r,selected:t,today:n,outsideCurrentMonth:a,day:s,disableMargin:o,disableHighlightToday:c,showDaysOutsideCurrentMonth:l}=e,u=St(),{ownerState:d}=dr();return C.useMemo(()=>ie({},d,{day:s,isDaySelected:t??!1,isDayDisabled:r??!1,isDayCurrent:n??!1,isDayOutsideMonth:a??!1,isDayStartOfWeek:u.isSameDay(s,u.startOfWeek(s)),isDayEndOfWeek:u.isSameDay(s,u.endOfWeek(s)),disableMargin:o??!1,disableHighlightToday:c??!1,showDaysOutsideCurrentMonth:l??!1}),[u,d,s,t,r,n,a,o,c,l])}const w2=["autoFocus","className","classes","hidden","isAnimating","onClick","onDaySelect","onFocus","onBlur","onKeyDown","onMouseDown","onMouseEnter","children","isFirstVisibleCell","isLastVisibleCell","day","selected","disabled","today","outsideCurrentMonth","disableMargin","disableHighlightToday","showDaysOutsideCurrentMonth"],S2=(e,r)=>{const{isDaySelected:t,isDayDisabled:n,isDayCurrent:a,isDayOutsideMonth:s,disableMargin:o,disableHighlightToday:c,showDaysOutsideCurrentMonth:l}=r,u=s&&!l;return Rt({root:["root",t&&!u&&"selected",n&&"disabled",!o&&"dayWithMargin",!c&&a&&"today",s&&l&&"dayOutsideMonth",u&&"hiddenDaySpacingFiller"],hiddenDaySpacingFiller:["hiddenDaySpacingFiller"]},b2,e)},Cm=({theme:e})=>ie({},e.typography.caption,{width:Ui,height:Ui,borderRadius:"50%",padding:0,backgroundColor:"transparent",transition:e.transitions.create("background-color",{duration:e.transitions.duration.short}),color:(e.vars||e).palette.text.primary,"@media (pointer: fine)":{"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.hoverOpacity})`:Hs(e.palette.primary.main,e.palette.action.hoverOpacity)}},"&:focus":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.focusOpacity})`:Hs(e.palette.primary.main,e.palette.action.focusOpacity),[`&.${ja.selected}`]:{willChange:"background-color",backgroundColor:(e.vars||e).palette.primary.dark}},[`&.${ja.selected}`]:{color:(e.vars||e).palette.primary.contrastText,backgroundColor:(e.vars||e).palette.primary.main,fontWeight:e.typography.fontWeightMedium,"&:hover":{willChange:"background-color",backgroundColor:(e.vars||e).palette.primary.dark}},[`&.${ja.disabled}:not(.${ja.selected})`]:{color:(e.vars||e).palette.text.disabled},[`&.${ja.disabled}&.${ja.selected}`]:{opacity:.6},variants:[{props:{disableMargin:!1},style:{margin:`0 ${Fc}px`}},{props:{isDayOutsideMonth:!0,showDaysOutsideCurrentMonth:!0},style:{color:(e.vars||e).palette.text.secondary}},{props:{disableHighlightToday:!1,isDayCurrent:!0},style:{[`&:not(.${ja.selected})`]:{border:`1px solid ${(e.vars||e).palette.text.secondary}`}}}]}),_m=(e,r)=>{const{ownerState:t}=e;return[r.root,!t.disableMargin&&r.dayWithMargin,!t.disableHighlightToday&&t.isDayCurrent&&r.today,!t.isDayOutsideMonth&&t.showDaysOutsideCurrentMonth&&r.dayOutsideMonth,t.isDayOutsideMonth&&!t.showDaysOutsideCurrentMonth&&r.hiddenDaySpacingFiller]},E2=Ge(Py,{name:"MuiPickersDay",slot:"Root",overridesResolver:_m})(Cm),T2=Ge("div",{name:"MuiPickersDay",slot:"Root",overridesResolver:_m})(({theme:e})=>ie({},Cm({theme:e}),{opacity:0,pointerEvents:"none"})),fi=()=>{},A2=C.forwardRef(function(r,t){const n=Dt({props:r,name:"MuiPickersDay"}),{autoFocus:a=!1,className:s,classes:o,isAnimating:c,onClick:l,onDaySelect:u,onFocus:d=fi,onBlur:f=fi,onKeyDown:h=fi,onMouseDown:x=fi,onMouseEnter:m=fi,children:p,day:g,selected:w,disabled:y,today:v,outsideCurrentMonth:T,disableMargin:F,disableHighlightToday:A,showDaysOutsideCurrentMonth:S}=n,E=Qe(n,w2),b=km({day:g,selected:w,disabled:y,today:v,outsideCurrentMonth:T,disableMargin:F,disableHighlightToday:A,showDaysOutsideCurrentMonth:S}),k=S2(o,b),j=St(),_=C.useRef(null),B=Ur(_,t);Bn(()=>{a&&!y&&!c&&!T&&_.current.focus()},[a,y,c,T]);const Q=L=>{x(L),T&&L.preventDefault()},Z=L=>{y||u(g),T&&L.currentTarget.focus(),l&&l(L)};return T&&!S?i.jsx(T2,{className:Qt(k.root,k.hiddenDaySpacingFiller,s),ownerState:b,role:E.role}):i.jsx(E2,ie({className:Qt(k.root,s),ref:B,centerRipple:!0,disabled:y,tabIndex:w?0:-1,onKeyDown:L=>h(L,g),onFocus:L=>d(L,g),onBlur:L=>f(L,g),onMouseEnter:L=>m(L,g),onClick:Z,onMouseDown:Q},E,{ownerState:b,children:p||j.format(g,"dayOfMonth")}))}),k2=C.memo(A2),ql=["disablePast","disableFuture","minDate","maxDate","shouldDisableDate","shouldDisableMonth","shouldDisableYear"],Xl=["disablePast","disableFuture","minTime","maxTime","shouldDisableTime","minutesStep","ampm","disableIgnoringDatePartForTimeValidation"],Dm=["minDateTime","maxDateTime"],C2=[...ql,...Xl,...Dm],Fm=e=>C2.reduce((r,t)=>(e.hasOwnProperty(t)&&(r[t]=e[t]),r),{}),_2=["value","defaultValue","referenceDate","format","formatDensity","onChange","timezone","onError","shouldRespectLeadingZeros","selectedSections","onSelectedSectionsChange","unstableFieldRef","unstableStartFieldRef","unstableEndFieldRef","enableAccessibleFieldDOMStructure","disabled","readOnly","dateSeparator","autoFocus","focused"],jm=(e,r)=>C.useMemo(()=>{const t=ie({},e),n={},a=s=>{t.hasOwnProperty(s)&&(n[s]=t[s],delete t[s])};return _2.forEach(a),r==="date"?ql.forEach(a):r==="time"?Xl.forEach(a):r==="date-time"&&(ql.forEach(a),Xl.forEach(a),Dm.forEach(a)),{forwardedProps:t,internalProps:n}},[e,r]),D2=({utils:e,format:r})=>{let t=10,n=r,a=e.expandFormat(r);for(;a!==n;)if(n=a,a=e.expandFormat(n),t-=1,t<0)throw new Error("MUI X: The format expansion seems to be in an infinite loop. Please open an issue with the format passed to the component.");return a},F2=({utils:e,expandedFormat:r})=>{const t=[],{start:n,end:a}=e.escapedCharacters,s=new RegExp(`(\\${n}[^\\${a}]*\\${a})+`,"g");let o=null;for(;o=s.exec(r);)t.push({start:o.index,end:s.lastIndex-1});return t},j2=(e,r,t,n)=>{switch(t.type){case"year":return r.fieldYearPlaceholder({digitAmount:e.formatByString(e.date(void 0,"default"),n).length,format:n});case"month":return r.fieldMonthPlaceholder({contentType:t.contentType,format:n});case"day":return r.fieldDayPlaceholder({format:n});case"weekDay":return r.fieldWeekDayPlaceholder({contentType:t.contentType,format:n});case"hours":return r.fieldHoursPlaceholder({format:n});case"minutes":return r.fieldMinutesPlaceholder({format:n});case"seconds":return r.fieldSecondsPlaceholder({format:n});case"meridiem":return r.fieldMeridiemPlaceholder({format:n});default:return n}},I2=({utils:e,date:r,shouldRespectLeadingZeros:t,localeText:n,localizedDigits:a,now:s,token:o,startSeparator:c})=>{if(o==="")throw new Error("MUI X: Should not call `commitToken` with an empty token");const l=Sm(e,o),u=Am(e,l.contentType,l.type,o),d=t?u:l.contentType==="digit",f=e.isValid(r);let h=f?e.formatByString(r,o):"",x=null;if(d)if(u)x=h===""?e.formatByString(s,o).length:h.length;else{if(l.maxLength==null)throw new Error(`MUI X: The token ${o} should have a 'maxLength' property on it's adapter`);x=l.maxLength,f&&(h=Lu(Bu(as(h,a),x),a))}return ie({},l,{format:o,maxLength:x,value:h,placeholder:j2(e,n,l,o),hasLeadingZerosInFormat:u,hasLeadingZerosInInput:d,startSeparator:c,endSeparator:"",modified:!1})},P2=e=>{var x;const{utils:r,expandedFormat:t,escapedParts:n}=e,a=r.date(void 0),s=[];let o="";const c=Object.keys(r.formatTokenMap).sort((m,p)=>p.length-m.length),l=/^([a-zA-Z]+)/,u=new RegExp(`^(${c.join("|")})*$`),d=new RegExp(`^(${c.join("|")})`),f=m=>n.find(p=>p.start<=m&&p.end>=m);let h=0;for(;h<t.length;){const m=f(h),p=m!=null,g=(x=l.exec(t.slice(h)))==null?void 0:x[1];if(!p&&g!=null&&u.test(g)){let w=g;for(;w.length>0;){const y=d.exec(w)[1];w=w.slice(y.length),s.push(I2(ie({},e,{now:a,token:y,startSeparator:o}))),o=""}h+=g.length}else{const w=t[h];p&&(m==null?void 0:m.start)===h||(m==null?void 0:m.end)===h||(s.length===0?o+=w:(s[s.length-1].endSeparator+=w,s[s.length-1].isEndFormatSeparator=!0)),h+=1}}return s.length===0&&o.length>0&&s.push({type:"empty",contentType:"letter",maxLength:null,format:"",value:"",placeholder:"",hasLeadingZerosInFormat:!1,hasLeadingZerosInInput:!1,startSeparator:o,endSeparator:"",modified:!1}),s},O2=({isRtl:e,formatDensity:r,sections:t})=>t.map(n=>{const a=s=>{let o=s;return e&&o!==null&&o.includes(" ")&&(o=`⁩${o}⁦`),r==="spacious"&&["/",".","-"].includes(o)&&(o=` ${o} `),o};return n.startSeparator=a(n.startSeparator),n.endSeparator=a(n.endSeparator),n}),o0=e=>{let r=D2(e);e.isRtl&&e.enableAccessibleFieldDOMStructure&&(r=r.split(" ").reverse().join(" "));const t=F2(ie({},e,{expandedFormat:r})),n=P2(ie({},e,{expandedFormat:r,escapedParts:t}));return O2(ie({},e,{sections:n}))},Uu=()=>C.useContext(Ou),R2=()=>{const e=C.useContext(xm);if(e==null)throw new Error(["MUI X: The `usePickerActionsContext` can only be called in fields that are used as a slot of a Picker component"].join(`
`));return e},Cs=e=>e.saveQuery!=null,Im=({stateResponse:{localizedDigits:e,sectionsValueBoundaries:r,state:t,timezone:n,setCharacterQuery:a,setTempAndroidValueStr:s,updateSectionValue:o}})=>{const c=St(),l=({keyPressed:f,sectionIndex:h},x,m)=>{const p=f.toLowerCase(),g=t.sections[h];if(t.characterQuery!=null&&(!m||m(t.characterQuery.value))&&t.characterQuery.sectionIndex===h){const y=`${t.characterQuery.value}${p}`,v=x(y,g);if(!Cs(v))return a({sectionIndex:h,value:y,sectionType:g.type}),v}const w=x(p,g);return Cs(w)&&!w.saveQuery?(a(null),null):(a({sectionIndex:h,value:p,sectionType:g.type}),Cs(w)?null:w)},u=f=>{const h=(p,g,w)=>{const y=g.filter(v=>v.toLowerCase().startsWith(w));return y.length===0?{saveQuery:!1}:{sectionValue:y[0],shouldGoToNextSection:y.length===1}},x=(p,g,w,y)=>{const v=T=>Em(c,n,g.type,T);if(g.contentType==="letter")return h(g.format,v(g.format),p);if(w&&y!=null&&Sm(c,w).contentType==="letter"){const T=v(w),F=h(w,T,p);return Cs(F)?{saveQuery:!1}:ie({},F,{sectionValue:y(F.sectionValue,T)})}return{saveQuery:!1}};return l(f,(p,g)=>{switch(g.type){case"month":{const w=y=>a0(c,y,c.formats.month,g.format);return x(p,g,c.formats.month,w)}case"weekDay":{const w=(y,v)=>v.indexOf(y).toString();return x(p,g,c.formats.weekday,w)}case"meridiem":return x(p,g);default:return{saveQuery:!1}}})},d=f=>{const h=(m,p)=>{const g=as(m,e),w=Number(g),y=r[p.type]({currentDate:null,format:p.format,contentType:p.contentType});if(w>y.maximum)return{saveQuery:!1};if(w<y.minimum)return{saveQuery:!0};const v=w*10>y.maximum||g.length===y.maximum.toString().length;return{sectionValue:Tm(c,w,y,e,p),shouldGoToNextSection:v}};return l(f,(m,p)=>{if(p.contentType==="digit"||p.contentType==="digit-with-letter")return h(m,p);if(p.type==="month"){const g=Am(c,"digit","month","MM"),w=h(m,{type:p.type,format:"MM",hasLeadingZerosInFormat:g,hasLeadingZerosInInput:!0,contentType:"digit",maxLength:2});if(Cs(w))return w;const y=a0(c,w.sectionValue,"MM",p.format);return ie({},w,{sectionValue:y})}if(p.type==="weekDay"){const g=h(m,p);if(Cs(g))return g;const w=Ic(c,p.format)[Number(g.sectionValue)-1];return ie({},g,{sectionValue:w})}return{saveQuery:!1}},m=>n0(m,e))};return Ue(f=>{const h=t.sections[f.sectionIndex],m=n0(f.keyPressed,e)?d(ie({},f,{keyPressed:Lu(f.keyPressed,e)})):u(f);if(m==null){s(null);return}o({section:h,newSectionValue:m.sectionValue,shouldGoToNextSection:m.shouldGoToNextSection})})},io=({props:e,value:r,timezone:t,adapter:n})=>{if(r===null)return null;const{shouldDisableDate:a,shouldDisableMonth:s,shouldDisableYear:o,disablePast:c,disableFuture:l,minDate:u,maxDate:d}=e,f=n.utils.date(void 0,t);switch(!0){case!n.utils.isValid(r):return"invalidDate";case!!(a&&a(r)):return"shouldDisableDate";case!!(s&&s(r)):return"shouldDisableMonth";case!!(o&&o(r)):return"shouldDisableYear";case!!(l&&n.utils.isAfterDay(r,f)):return"disableFuture";case!!(c&&n.utils.isBeforeDay(r,f)):return"disablePast";case!!(u&&n.utils.isBeforeDay(r,u)):return"minDate";case!!(d&&n.utils.isAfterDay(r,d)):return"maxDate";default:return null}};io.valueManager=$n;function Pm(e){const{props:r,validator:t,value:n,timezone:a,onError:s}=e,o=ls(),c=C.useRef(t.valueManager.defaultErrorState),l=t({adapter:o,value:n,timezone:a,props:r}),u=t.valueManager.hasError(l);C.useEffect(()=>{s&&!t.valueManager.isSameError(l,c.current)&&s(l,n),c.current=l},[t,s,l,n]);const d=Ue(f=>t({adapter:o,value:f,timezone:a,props:r}));return{validationError:l,hasValidationError:u,getValidationErrorForNewValue:d}}const N2=5e3,Om=e=>{var we;const r=St(),t=Aa(),n=ls(),a=ra(),{manager:{validator:s,valueType:o,internal_valueManager:c,internal_fieldValueManager:l},internalPropsWithDefaults:u,internalPropsWithDefaults:{value:d,defaultValue:f,referenceDate:h,onChange:x,format:m,formatDensity:p="dense",selectedSections:g,onSelectedSectionsChange:w,shouldRespectLeadingZeros:y=!1,timezone:v,enableAccessibleFieldDOMStructure:T=!0},forwardedProps:{error:F}}=e,{value:A,handleValueChange:S,timezone:E}=so({name:"a field component",timezone:v,value:d,defaultValue:f,referenceDate:h,onChange:x,valueManager:c}),b=C.useRef(A);C.useEffect(()=>{b.current=A},[A]);const{hasValidationError:k}=Pm({props:u,validator:s,timezone:E,value:A,onError:u.onError}),j=C.useMemo(()=>F!==void 0?F:k,[k,F]),_=C.useMemo(()=>i2(r),[r]),B=C.useMemo(()=>d2(r,_,E),[r,_,E]),Q=C.useCallback(xe=>l.getSectionsFromValue(xe,Ce=>o0({utils:r,localeText:t,localizedDigits:_,format:m,date:Ce,formatDensity:p,shouldRespectLeadingZeros:y,enableAccessibleFieldDOMStructure:T,isRtl:a})),[l,m,t,_,a,y,r,p,T]),[Z,L]=C.useState(()=>{const xe=Q(A),Ce={sections:xe,lastExternalValue:A,lastSectionsDependencies:{format:m,isRtl:a,locale:r.locale},tempValueStrAndroid:null,characterQuery:null},Oe=n2(xe),ze=c.getInitialReferenceValue({referenceDate:h,value:A,utils:r,props:u,granularity:Oe,timezone:E});return ie({},Ce,{referenceValue:ze})}),[q,te]=Gs({controlled:g,default:null,name:"useField",state:"selectedSections"}),R=xe=>{te(xe),w==null||w(xe)},oe=C.useMemo(()=>Yl(q,Z.sections),[q,Z.sections]),J=oe==="all"?0:oe,P=C.useMemo(()=>p2(Z.sections,a&&!T),[Z.sections,a,T]),V=C.useMemo(()=>Z.sections.every(xe=>xe.value===""),[Z.sections]),z=xe=>{const Ce={validationError:s({adapter:n,value:xe,timezone:E,props:u})};S(xe,Ce)},G=(xe,Ce)=>{const Oe=[...Z.sections];return Oe[xe]=ie({},Oe[xe],{value:Ce,modified:!0}),Oe},ne=C.useRef(null),he=Ns(),se=xe=>{J!=null&&(ne.current={sectionIndex:J,value:xe},he.start(0,()=>{ne.current=null}))},ae=()=>{c.areValuesEqual(r,A,c.emptyValue)?L(xe=>ie({},xe,{sections:xe.sections.map(Ce=>ie({},Ce,{value:""})),tempValueStrAndroid:null,characterQuery:null})):(L(xe=>ie({},xe,{characterQuery:null})),z(c.emptyValue))},K=()=>{if(J==null)return;const xe=Z.sections[J];xe.value!==""&&(se(""),l.getDateFromSection(A,xe)===null?L(Ce=>ie({},Ce,{sections:G(J,""),tempValueStrAndroid:null,characterQuery:null})):(L(Ce=>ie({},Ce,{characterQuery:null})),z(l.updateDateInValue(A,xe,null))))},O=xe=>{const Ce=(ze,M)=>{const ce=r.parse(ze,m);if(!r.isValid(ce))return null;const de=o0({utils:r,localeText:t,localizedDigits:_,format:m,date:ce,formatDensity:p,shouldRespectLeadingZeros:y,enableAccessibleFieldDOMStructure:T,isRtl:a});return i0(r,ce,de,M,!1)},Oe=l.parseValueStr(xe,Z.referenceValue,Ce);z(Oe)},D=Ns(),re=({section:xe,newSectionValue:Ce,shouldGoToNextSection:Oe})=>{he.clear(),D.clear();const ze=l.getDateFromSection(A,xe);Oe&&J<Z.sections.length-1&&R(J+1);const M=G(J,Ce),ce=l.getDateSectionsFromValue(M,xe),de=c2(r,ce,_);if(r.isValid(de)){const Se=i0(r,de,ce,l.getDateFromSection(Z.referenceValue,xe),!0);return ze==null&&D.start(0,()=>{b.current===A&&L(ke=>ie({},ke,{sections:l.clearDateSections(Z.sections,xe),tempValueStrAndroid:null}))}),z(l.updateDateInValue(A,xe,Se))}return ce.every(Se=>Se.value!=="")?(se(Ce),z(l.updateDateInValue(A,xe,de))):ze!=null?(se(Ce),z(l.updateDateInValue(A,xe,null))):L(Se=>ie({},Se,{sections:M,tempValueStrAndroid:null}))},le=xe=>L(Ce=>ie({},Ce,{tempValueStrAndroid:xe})),Te=Ue(xe=>{L(Ce=>ie({},Ce,{characterQuery:xe}))});if(A!==Z.lastExternalValue){let xe;ne.current!=null&&!r.isValid(l.getDateFromSection(A,Z.sections[ne.current.sectionIndex]))?xe=G(ne.current.sectionIndex,ne.current.value):xe=Q(A),L(Ce=>ie({},Ce,{lastExternalValue:A,sections:xe,sectionsDependencies:{format:m,isRtl:a,locale:r.locale},referenceValue:l.updateReferenceValue(r,A,Ce.referenceValue),tempValueStrAndroid:null}))}if(a!==Z.lastSectionsDependencies.isRtl||m!==Z.lastSectionsDependencies.format||r.locale!==Z.lastSectionsDependencies.locale){const xe=Q(A);L(Ce=>ie({},Ce,{lastSectionsDependencies:{format:m,isRtl:a,locale:r.locale},sections:xe,tempValueStrAndroid:null,characterQuery:null}))}Z.characterQuery!=null&&!j&&J==null&&Te(null),Z.characterQuery!=null&&((we=Z.sections[Z.characterQuery.sectionIndex])==null?void 0:we.type)!==Z.characterQuery.sectionType&&Te(null),C.useEffect(()=>{ne.current!=null&&(ne.current=null)});const ue=Ns();return C.useEffect(()=>(Z.characterQuery!=null&&ue.start(N2,()=>Te(null)),()=>{}),[Z.characterQuery,Te,ue]),C.useEffect(()=>{Z.tempValueStrAndroid!=null&&J!=null&&K()},[Z.sections]),{activeSectionIndex:J,areAllSectionsEmpty:V,error:j,localizedDigits:_,parsedSelectedSections:oe,sectionOrder:P,sectionsValueBoundaries:B,state:Z,timezone:E,value:A,clearValue:ae,clearActiveSection:K,setCharacterQuery:Te,setSelectedSections:R,setTempAndroidValueStr:le,updateSectionValue:re,updateValueFromValueStr:O,getSectionsFromValue:Q}};function Rm(e){const{manager:{internal_useApplyDefaultValuesToFieldInternalProps:r},internalProps:t,skipContextFieldRefAssignment:n}=e,a=Uu(),s=mm(),o=Ur(t.unstableFieldRef,n?null:s==null?void 0:s.fieldRef),c=a==null?void 0:a.setValue,l=C.useCallback((d,f)=>c==null?void 0:c(d,{validationError:f.validationError,shouldClose:!1}),[c]),u=C.useMemo(()=>s!=null&&a!=null?ie({value:a.value,onChange:l,timezone:a.timezone,disabled:a.disabled,readOnly:a.readOnly,autoFocus:a.autoFocus&&!a.open,focused:a.open?!0:void 0,format:a.fieldFormat,formatDensity:s.formatDensity,enableAccessibleFieldDOMStructure:s.enableAccessibleFieldDOMStructure,selectedSections:s.selectedSections,onSelectedSectionsChange:s.onSelectedSectionsChange,unstableFieldRef:o},t):t,[a,s,t,l,o]);return r(u)}function Vu(e){const{focused:r,domGetters:t,stateResponse:{parsedSelectedSections:n,state:a}}=e;if(!t.isReady())return;const s=document.getSelection();if(!s)return;if(n==null){s.rangeCount>0&&t.getRoot().contains(s.getRangeAt(0).startContainer)&&s.removeAllRanges(),r&&t.getRoot().blur();return}if(!t.getRoot().contains(xr(document)))return;const o=new window.Range;let c;n==="all"?c=t.getRoot():a.sections[n].type==="empty"?c=t.getSectionContainer(n):c=t.getSectionContent(n),o.selectNodeContents(c),c.focus(),s.removeAllRanges(),s.addRange(o)}function Nm(e){const r=St(),{manager:{internal_fieldValueManager:t},internalPropsWithDefaults:{minutesStep:n,disabled:a,readOnly:s},stateResponse:{state:o,value:c,activeSectionIndex:l,parsedSelectedSections:u,sectionsValueBoundaries:d,localizedDigits:f,timezone:h,sectionOrder:x,clearValue:m,clearActiveSection:p,setSelectedSections:g,updateSectionValue:w}}=e;return Ue(y=>{if(!a)switch(!0){case((y.ctrlKey||y.metaKey)&&String.fromCharCode(y.keyCode)==="A"&&!y.shiftKey&&!y.altKey):{y.preventDefault(),g("all");break}case y.key==="ArrowRight":{if(y.preventDefault(),u==null)g(x.startIndex);else if(u==="all")g(x.endIndex);else{const v=x.neighbors[u].rightIndex;v!==null&&g(v)}break}case y.key==="ArrowLeft":{if(y.preventDefault(),u==null)g(x.endIndex);else if(u==="all")g(x.startIndex);else{const v=x.neighbors[u].leftIndex;v!==null&&g(v)}break}case y.key==="Delete":{if(y.preventDefault(),s)break;u==null||u==="all"?m():p();break}case["ArrowUp","ArrowDown","Home","End","PageUp","PageDown"].includes(y.key):{if(y.preventDefault(),s||l==null)break;u==="all"&&g(l);const v=o.sections[l],T=L2(r,h,v,y.key,d,f,t.getDateFromSection(c,v),{minutesStep:n});w({section:v,newSectionValue:T,shouldGoToNextSection:!1});break}}})}function M2(e){switch(e){case"ArrowUp":return 1;case"ArrowDown":return-1;case"PageUp":return 5;case"PageDown":return-5;default:return 0}}function L2(e,r,t,n,a,s,o,c){const l=M2(n),u=n==="Home",d=n==="End",f=t.value===""||u||d,h=()=>{const m=a[t.type]({currentDate:o,format:t.format,contentType:t.contentType}),p=y=>Tm(e,y,m,s,t),g=t.type==="minutes"&&(c!=null&&c.minutesStep)?c.minutesStep:1;let w;if(f){if(t.type==="year"&&!d&&!u)return e.formatByString(e.date(void 0,r),t.format);l>0||u?w=m.minimum:w=m.maximum}else w=parseInt(as(t.value,s),10)+l*g;return w%g!==0&&((l<0||u)&&(w+=g-(g+w)%g),(l>0||d)&&(w-=w%g)),w>m.maximum?p(m.minimum+(w-m.maximum-1)%(m.maximum-m.minimum+1)):w<m.minimum?p(m.maximum-(m.minimum-w-1)%(m.maximum-m.minimum+1)):p(w)},x=()=>{const m=Em(e,r,t.type,t.format);if(m.length===0)return t.value;if(f)return l>0||u?m[0]:m[m.length-1];const w=((m.indexOf(t.value)+l)%m.length+m.length)%m.length;return m[w]};return t.contentType==="digit"||t.contentType==="digit-with-letter"?h():x()}function B2(e){const{manager:r,focused:t,setFocused:n,domGetters:a,stateResponse:s,applyCharacterEditing:o,internalPropsWithDefaults:c,stateResponse:{parsedSelectedSections:l,sectionOrder:u,state:d,clearValue:f,setCharacterQuery:h,setSelectedSections:x,updateValueFromValueStr:m},internalPropsWithDefaults:{disabled:p=!1,readOnly:g=!1}}=e,w=Nm({manager:r,internalPropsWithDefaults:c,stateResponse:s}),y=Ns(),v=Ue(E=>{p||!a.isReady()||(n(!0),l==="all"?y.start(0,()=>{const b=document.getSelection().getRangeAt(0).startOffset;if(b===0){x(u.startIndex);return}let k=0,j=0;for(;j<b&&k<d.sections.length;){const _=d.sections[k];k+=1,j+=`${_.startSeparator}${_.value||_.placeholder}${_.endSeparator}`.length}x(k-1)}):t?a.getRoot().contains(E.target)||x(u.startIndex):(n(!0),x(u.startIndex)))}),T=Ue(E=>{if(!a.isReady()||l!=="all")return;const k=E.target.textContent??"";a.getRoot().innerHTML=d.sections.map(j=>`${j.startSeparator}${j.value||j.placeholder}${j.endSeparator}`).join(""),Vu({focused:t,domGetters:a,stateResponse:s}),k.length===0||k.charCodeAt(0)===10?(f(),x("all")):k.length>1?m(k):(l==="all"&&x(0),o({keyPressed:k,sectionIndex:0}))}),F=Ue(E=>{if(g||l!=="all"){E.preventDefault();return}const b=E.clipboardData.getData("text");E.preventDefault(),h(null),m(b)}),A=Ue(()=>{if(t||p||!a.isReady())return;const E=xr(document);n(!0),a.getSectionIndexFromDOMElement(E)!=null||x(u.startIndex)}),S=Ue(()=>{setTimeout(()=>{if(!a.isReady())return;const E=xr(document);!a.getRoot().contains(E)&&(n(!1),x(null))})});return{onKeyDown:w,onBlur:S,onFocus:A,onClick:v,onPaste:F,onInput:T,contentEditable:l==="all",tabIndex:l===0?-1:0}}function $2(e){const{manager:{internal_fieldValueManager:r},stateResponse:{areAllSectionsEmpty:t,state:n,updateValueFromValueStr:a}}=e,s=Ue(c=>{a(c.target.value)});return{value:C.useMemo(()=>t?"":r.getV7HiddenInputValueFromSections(n.sections),[t,n.sections,r]),onChange:s}}function U2(e){const{stateResponse:{setSelectedSections:r},internalPropsWithDefaults:{disabled:t=!1}}=e,n=Ue(a=>s=>{t||s.isDefaultPrevented()||r(a)});return C.useCallback(a=>({"data-sectionindex":a,onClick:n(a)}),[n])}function V2(e){const r=St(),t=Aa(),n=_c(),{focused:a,domGetters:s,stateResponse:o,applyCharacterEditing:c,manager:{internal_fieldValueManager:l},stateResponse:{parsedSelectedSections:u,sectionsValueBoundaries:d,state:f,value:h,clearActiveSection:x,setCharacterQuery:m,setSelectedSections:p,updateSectionValue:g,updateValueFromValueStr:w},internalPropsWithDefaults:{disabled:y=!1,readOnly:v=!1}}=e,T=u==="all",F=!T&&!y&&!v,A=Ue(_=>{if(!s.isReady())return;const B=f.sections[_];s.getSectionContent(_).innerHTML=B.value||B.placeholder,Vu({focused:a,domGetters:s,stateResponse:o})}),S=Ue(_=>{if(!s.isReady())return;const B=_.target,Q=B.textContent??"",Z=s.getSectionIndexFromDOMElement(B),L=f.sections[Z];if(v){A(Z);return}if(Q.length===0){if(L.value===""){A(Z);return}const q=_.nativeEvent.inputType;if(q==="insertParagraph"||q==="insertLineBreak"){A(Z);return}A(Z),x();return}c({keyPressed:Q,sectionIndex:Z}),A(Z)}),E=Ue(_=>{_.preventDefault()}),b=Ue(_=>{if(_.preventDefault(),v||y||typeof u!="number")return;const B=f.sections[u],Q=_.clipboardData.getData("text"),Z=/^[a-zA-Z]+$/.test(Q),L=/^[0-9]+$/.test(Q),q=/^(([a-zA-Z]+)|)([0-9]+)(([a-zA-Z]+)|)$/.test(Q);B.contentType==="letter"&&Z||B.contentType==="digit"&&L||B.contentType==="digit-with-letter"&&q?(m(null),g({section:B,newSectionValue:Q,shouldGoToNextSection:!0})):!Z&&!L&&(m(null),w(Q))}),k=Ue(_=>{_.preventDefault(),_.dataTransfer.dropEffect="none"}),j=Ue(_=>()=>{y||p(_)});return C.useCallback((_,B)=>{const Q=d[_.type]({currentDate:l.getDateFromSection(h,_),contentType:_.contentType,format:_.format});return{onInput:S,onPaste:b,onMouseUp:E,onDragOver:k,onFocus:j(B),"aria-labelledby":`${n}-${_.type}`,"aria-readonly":v,"aria-valuenow":H2(_,r),"aria-valuemin":Q.minimum,"aria-valuemax":Q.maximum,"aria-valuetext":_.value?W2(_,r):t.empty,"aria-label":t[_.type],"aria-disabled":y,tabIndex:T||B>0?-1:0,contentEditable:!T&&!y&&!v,role:"spinbutton",id:`${n}-${_.type}`,"data-range-position":_.dateName||void 0,spellCheck:F?!1:void 0,autoCapitalize:F?"off":void 0,autoCorrect:F?"off":void 0,children:_.value||_.placeholder,inputMode:_.contentType==="letter"?"text":"numeric"}},[d,n,T,y,v,F,t,r,S,b,E,k,j,l,h])}function W2(e,r){if(e.value)switch(e.type){case"month":{if(e.contentType==="digit")return r.format(r.setMonth(r.date(),Number(e.value)-1),"month");const t=r.parse(e.value,e.format);return t?r.format(t,"month"):void 0}case"day":return e.contentType==="digit"?r.format(r.setDate(r.startOfYear(r.date()),Number(e.value)),"dayOfMonthFull"):e.value;case"weekDay":return;default:return}}function H2(e,r){if(e.value)switch(e.type){case"weekDay":return e.contentType==="letter"?void 0:Number(e.value);case"meridiem":{const t=r.parse(`01:00 ${e.value}`,`${r.formats.hours12h}:${r.formats.minutes} ${e.format}`);return t?r.getHours(t)>=12?1:0:void 0}case"day":return e.contentType==="digit-with-letter"?parseInt(e.value,10):Number(e.value);case"month":{if(e.contentType==="digit")return Number(e.value);const t=r.parse(e.value,e.format);return t?r.getMonth(t)+1:void 0}default:return e.contentType!=="letter"?Number(e.value):void 0}}const z2=e=>{const{props:r,manager:t,skipContextFieldRefAssignment:n,manager:{valueType:a,internal_useOpenPickerButtonAriaLabel:s}}=e,{internalProps:o,forwardedProps:c}=jm(r,a),l=Rm({manager:t,internalProps:o,skipContextFieldRefAssignment:n}),{sectionListRef:u,onBlur:d,onClick:f,onFocus:h,onInput:x,onPaste:m,onKeyDown:p,onClear:g,clearable:w}=c,{disabled:y=!1,readOnly:v=!1,autoFocus:T=!1,focused:F,unstableFieldRef:A}=l,S=C.useRef(null),E=Ur(u,S),b=C.useMemo(()=>({isReady:()=>S.current!=null,getRoot:()=>S.current.getRoot(),getSectionContainer:ue=>S.current.getSectionContainer(ue),getSectionContent:ue=>S.current.getSectionContent(ue),getSectionIndexFromDOMElement:ue=>S.current.getSectionIndexFromDOMElement(ue)}),[S]),k=Om({manager:t,internalPropsWithDefaults:l,forwardedProps:c}),{areAllSectionsEmpty:j,error:_,parsedSelectedSections:B,sectionOrder:Q,state:Z,value:L,clearValue:q,setSelectedSections:te}=k,R=Im({stateResponse:k}),oe=s(L),[J,P]=C.useState(!1);function V(ue=0){if(y||!S.current||c0(S)!=null)return;const we=Yl(ue,Z.sections);P(!0),S.current.getSectionContent(we).focus()}const z=B2({manager:t,internalPropsWithDefaults:l,stateResponse:k,applyCharacterEditing:R,focused:J,setFocused:P,domGetters:b}),G=$2({manager:t,stateResponse:k}),ne=U2({stateResponse:k,internalPropsWithDefaults:l}),he=V2({manager:t,stateResponse:k,applyCharacterEditing:R,internalPropsWithDefaults:l,domGetters:b,focused:J}),se=Ue(ue=>{p==null||p(ue),z.onKeyDown(ue)}),ae=Ue(ue=>{d==null||d(ue),z.onBlur(ue)}),K=Ue(ue=>{h==null||h(ue),z.onFocus(ue)}),O=Ue(ue=>{ue.isDefaultPrevented()||(f==null||f(ue),z.onClick(ue))}),D=Ue(ue=>{m==null||m(ue),z.onPaste(ue)}),re=Ue(ue=>{x==null||x(ue),z.onInput(ue)}),le=Ue((ue,...we)=>{ue.preventDefault(),g==null||g(ue,...we),q(),l0(S)?te(Q.startIndex):V(0)}),Te=C.useMemo(()=>Z.sections.map((ue,we)=>{const xe=he(ue,we);return{container:ne(we),content:he(ue,we),before:{children:ue.startSeparator},after:{children:ue.endSeparator,"data-range-position":ue.isEndFormatSeparator?xe["data-range-position"]:void 0}}}),[Z.sections,ne,he]);return C.useEffect(()=>{if(S.current==null)throw new Error(["MUI X: The `sectionListRef` prop has not been initialized by `PickersSectionList`","You probably tried to pass a component to the `textField` slot that contains an `<input />` element instead of a `PickersSectionList`.","","If you want to keep using an `<input />` HTML element for the editing, please add the `enableAccessibleFieldDOMStructure={false}` prop to your Picker or Field component:","","<DatePicker enableAccessibleFieldDOMStructure={false} slots={{ textField: MyCustomTextField }} />","","Learn more about the field accessible DOM structure on the MUI documentation: https://mui.com/x/react-date-pickers/fields/#fields-to-edit-a-single-element"].join(`
`));T&&!y&&S.current&&S.current.getSectionContent(Q.startIndex).focus()},[]),Bn(()=>{if(!(!J||!S.current)){if(B==="all")S.current.getRoot().focus();else if(typeof B=="number"){const ue=S.current.getSectionContent(B);ue&&ue.focus()}}},[B,J]),Bn(()=>{Vu({focused:J,domGetters:b,stateResponse:k})}),C.useImperativeHandle(A,()=>({getSections:()=>Z.sections,getActiveSectionIndex:()=>c0(S),setSelectedSections:ue=>{if(y||!S.current)return;const we=Yl(ue,Z.sections);P((we==="all"?0:we)!==null),te(ue)},focusField:V,isFieldFocused:()=>l0(S)})),ie({},c,z,{onBlur:ae,onClick:O,onFocus:K,onInput:re,onPaste:D,onKeyDown:se,onClear:le},G,{error:_,clearable:!!(w&&!j&&!v&&!y),focused:F??J,sectionListRef:E,enableAccessibleFieldDOMStructure:!0,elements:Te,areAllSectionsEmpty:j,disabled:y,readOnly:v,autoFocus:T,openPickerAriaLabel:oe})};function c0(e){const r=xr(document);return!r||!e.current||!e.current.getRoot().contains(r)?null:e.current.getSectionIndexFromDOMElement(r)}function l0(e){const r=xr(document);return!!e.current&&e.current.getRoot().contains(r)}const Ps=e=>e.replace(/[\u2066\u2067\u2068\u2069]/g,""),G2=(e,r,t)=>{let n=0,a=t?1:0;const s=[];for(let o=0;o<e.length;o+=1){const c=e[o],l=$u(c,t?"input-rtl":"input-ltr",r),u=`${c.startSeparator}${l}${c.endSeparator}`,d=Ps(u).length,f=u.length,h=Ps(l),x=a+(h===""?0:l.indexOf(h[0]))+c.startSeparator.length,m=x+h.length;s.push(ie({},c,{start:n,end:n+d,startInInput:x,endInInput:m})),n+=d,a+=f}return s},Y2=e=>{const r=ra(),t=Ns(),n=Ns(),{props:a,manager:s,skipContextFieldRefAssignment:o,manager:{valueType:c,internal_valueManager:l,internal_fieldValueManager:u,internal_useOpenPickerButtonAriaLabel:d}}=e,{internalProps:f,forwardedProps:h}=jm(a,c),x=Rm({manager:s,internalProps:f,skipContextFieldRefAssignment:o}),{onFocus:m,onClick:p,onPaste:g,onBlur:w,onKeyDown:y,onClear:v,clearable:T,inputRef:F,placeholder:A}=h,{readOnly:S=!1,disabled:E=!1,autoFocus:b=!1,focused:k,unstableFieldRef:j}=x,_=C.useRef(null),B=Ur(F,_),Q=Om({manager:s,internalPropsWithDefaults:x,forwardedProps:h}),{activeSectionIndex:Z,areAllSectionsEmpty:L,error:q,localizedDigits:te,parsedSelectedSections:R,sectionOrder:oe,state:J,value:P,clearValue:V,clearActiveSection:z,setCharacterQuery:G,setSelectedSections:ne,setTempAndroidValueStr:he,updateSectionValue:se,updateValueFromValueStr:ae,getSectionsFromValue:K}=Q,O=Im({stateResponse:Q}),D=d(P),re=C.useMemo(()=>G2(J.sections,te,r),[J.sections,te,r]);function le(){const Fe=_.current.selectionStart??0;let Ie;Fe<=re[0].startInInput||Fe>=re[re.length-1].endInInput?Ie=1:Ie=re.findIndex(qe=>qe.startInInput-qe.startSeparator.length>Fe);const We=Ie===-1?re.length-1:Ie-1;ne(We)}function Te(Fe=0){var Ie;xr(document)!==_.current&&((Ie=_.current)==null||Ie.focus(),ne(Fe))}const ue=Ue(Fe=>{m==null||m(Fe);const Ie=_.current;t.start(0,()=>{!Ie||Ie!==_.current||Z==null&&(Ie.value.length&&Number(Ie.selectionEnd)-Number(Ie.selectionStart)===Ie.value.length?ne("all"):le())})}),we=Ue((Fe,...Ie)=>{Fe.isDefaultPrevented()||(p==null||p(Fe,...Ie),le())}),xe=Ue(Fe=>{if(g==null||g(Fe),Fe.preventDefault(),S||E)return;const Ie=Fe.clipboardData.getData("text");if(typeof R=="number"){const We=J.sections[R],qe=/^[a-zA-Z]+$/.test(Ie),tt=/^[0-9]+$/.test(Ie),ut=/^(([a-zA-Z]+)|)([0-9]+)(([a-zA-Z]+)|)$/.test(Ie);if(We.contentType==="letter"&&qe||We.contentType==="digit"&&tt||We.contentType==="digit-with-letter"&&ut){G(null),se({section:We,newSectionValue:Ie,shouldGoToNextSection:!0});return}if(qe||tt)return}G(null),ae(Ie)}),Ce=Ue(Fe=>{w==null||w(Fe),ne(null)}),Oe=Ue(Fe=>{if(S)return;const Ie=Fe.target.value;if(Ie===""){V();return}const We=Fe.nativeEvent.data,qe=We&&We.length>1,tt=qe?We:Ie,ut=Ps(tt);if(R==="all"&&ne(Z),Z==null||qe){ae(qe?We:ut);return}let or;if(R==="all"&&ut.length===1)or=ut;else{const Ht=Ps(u.getV6InputValueFromSections(re,te,r));let it=-1,Nt=-1;for(let Pr=0;Pr<Ht.length;Pr+=1)it===-1&&Ht[Pr]!==ut[Pr]&&(it=Pr),Nt===-1&&Ht[Ht.length-Pr-1]!==ut[ut.length-Pr-1]&&(Nt=Pr);const tr=re[Z];if(it<tr.start||Ht.length-Nt-1>tr.end)return;const Es=ut.length-Ht.length+tr.end-Ps(tr.endSeparator||"").length;or=ut.slice(tr.start+Ps(tr.startSeparator||"").length,Es)}if(or.length===0){h2()&&he(tt),z();return}O({keyPressed:or,sectionIndex:Z})}),ze=Ue((Fe,...Ie)=>{Fe.preventDefault(),v==null||v(Fe,...Ie),V(),u0(_)?ne(oe.startIndex):Te(0)}),M=Nm({manager:s,internalPropsWithDefaults:x,stateResponse:Q}),ce=Ue(Fe=>{y==null||y(Fe),M(Fe)}),de=C.useMemo(()=>A!==void 0?A:u.getV6InputValueFromSections(K(l.emptyValue),te,r),[A,u,K,l.emptyValue,te,r]),Se=C.useMemo(()=>J.tempValueStrAndroid??u.getV6InputValueFromSections(J.sections,te,r),[J.sections,u,J.tempValueStrAndroid,te,r]);C.useEffect(()=>{_.current&&_.current===xr(document)&&ne("all")},[]),Bn(()=>{function Fe(){if(!_.current)return;if(R==null){_.current.scrollLeft&&(_.current.scrollLeft=0);return}if(_.current!==xr(document))return;const Ie=_.current.scrollTop;if(R==="all")_.current.select();else{const We=re[R],qe=We.type==="empty"?We.startInInput-We.startSeparator.length:We.startInInput,tt=We.type==="empty"?We.endInInput+We.endSeparator.length:We.endInInput;(qe!==_.current.selectionStart||tt!==_.current.selectionEnd)&&_.current===xr(document)&&_.current.setSelectionRange(qe,tt),n.start(0,()=>{_.current&&_.current===xr(document)&&_.current.selectionStart===_.current.selectionEnd&&(_.current.selectionStart!==qe||_.current.selectionEnd!==tt)&&Fe()})}_.current.scrollTop=Ie}Fe()});const ke=C.useMemo(()=>Z==null||J.sections[Z].contentType==="letter"?"text":"numeric",[Z,J.sections]),Ve=!(_.current&&_.current===xr(document))&&L;return C.useImperativeHandle(j,()=>({getSections:()=>J.sections,getActiveSectionIndex:()=>{const Fe=_.current.selectionStart??0,Ie=_.current.selectionEnd??0;if(Fe===0&&Ie===0)return null;const We=Fe<=re[0].startInInput?1:re.findIndex(qe=>qe.startInInput-qe.startSeparator.length>Fe);return We===-1?re.length-1:We-1},setSelectedSections:Fe=>ne(Fe),focusField:Te,isFieldFocused:()=>u0(_)})),ie({},h,{error:q,clearable:!!(T&&!L&&!S&&!E),onBlur:Ce,onClick:we,onFocus:ue,onPaste:xe,onKeyDown:ce,onClear:ze,inputRef:B,enableAccessibleFieldDOMStructure:!1,placeholder:de,inputMode:ke,autoComplete:"off",value:Ve?"":Se,onChange:Oe,focused:k,disabled:E,readOnly:S,autoFocus:b,openPickerAriaLabel:D})};function u0(e){return e.current===xr(document)}const q2=e=>{const r=mm();return(e.props.enableAccessibleFieldDOMStructure??(r==null?void 0:r.enableAccessibleFieldDOMStructure)??!0?z2:Y2)(e)};function X2(e={}){const{enableAccessibleFieldDOMStructure:r=!0}=e;return C.useMemo(()=>({valueType:"date",validator:io,internal_valueManager:$n,internal_fieldValueManager:x2,internal_enableAccessibleFieldDOMStructure:r,internal_useApplyDefaultValuesToFieldInternalProps:J2,internal_useOpenPickerButtonAriaLabel:K2}),[r])}function K2(e){const r=St(),t=Aa();return C.useMemo(()=>{const n=r.isValid(e)?r.format(e,"fullDate"):null;return t.openDatePickerDialogue(n)},[e,t,r])}function J2(e){const r=St(),t=oo(e);return C.useMemo(()=>ie({},e,t,{format:e.format??r.formats.keyboardDate}),[e,t,r])}function oo(e){const r=St(),t=Dw();return C.useMemo(()=>({disablePast:e.disablePast??!1,disableFuture:e.disableFuture??!1,minDate:e0(r,e.minDate,t.minDate),maxDate:e0(r,e.maxDate,t.maxDate)}),[e.minDate,e.maxDate,e.disableFuture,e.disablePast,r,t])}const Q2=e=>{const r=X2(e);return q2({manager:r,props:e})};function Wu(e){const{ownerState:r}=dr(),t=ra();return C.useMemo(()=>ie({},r,{isFieldDisabled:e.disabled??!1,isFieldReadOnly:e.readOnly??!1,isFieldRequired:e.required??!1,fieldDirection:t?"rtl":"ltr"}),[r,e.disabled,e.readOnly,e.required,t])}function Z2(e){return Xt("MuiPickersTextField",e)}er("MuiPickersTextField",["root","focused","disabled","error","required"]);function eS(e){return Xt("MuiPickersInputBase",e)}const Ms=er("MuiPickersInputBase",["root","focused","disabled","error","notchedOutline","sectionContent","sectionBefore","sectionAfter","adornedStart","adornedEnd","input","activeBar"]);function tS(e){return Xt("MuiPickersSectionList",e)}const hi=er("MuiPickersSectionList",["root","section","sectionContent"]),rS=["slots","slotProps","elements","sectionListRef","classes"],Mm=Ge("div",{name:"MuiPickersSectionList",slot:"Root"})({direction:"ltr /*! @noflip */",outline:"none"}),Lm=Ge("span",{name:"MuiPickersSectionList",slot:"Section"})({}),Bm=Ge("span",{name:"MuiPickersSectionList",slot:"SectionSeparator"})({whiteSpace:"pre"}),$m=Ge("span",{name:"MuiPickersSectionList",slot:"SectionContent"})({outline:"none"}),nS=e=>Rt({root:["root"],section:["section"],sectionContent:["sectionContent"]},tS,e);function aS(e){const{slots:r,slotProps:t,element:n,classes:a}=e,{ownerState:s}=dr(),o=(r==null?void 0:r.section)??Lm,c=ht({elementType:o,externalSlotProps:t==null?void 0:t.section,externalForwardedProps:n.container,className:a.section,ownerState:s}),l=(r==null?void 0:r.sectionContent)??$m,u=ht({elementType:l,externalSlotProps:t==null?void 0:t.sectionContent,externalForwardedProps:n.content,additionalProps:{suppressContentEditableWarning:!0},className:a.sectionContent,ownerState:s}),d=(r==null?void 0:r.sectionSeparator)??Bm,f=ht({elementType:d,externalSlotProps:t==null?void 0:t.sectionSeparator,externalForwardedProps:n.before,ownerState:ie({},s,{separatorPosition:"before"})}),h=ht({elementType:d,externalSlotProps:t==null?void 0:t.sectionSeparator,externalForwardedProps:n.after,ownerState:ie({},s,{separatorPosition:"after"})});return i.jsxs(o,ie({},c,{children:[i.jsx(d,ie({},f)),i.jsx(l,ie({},u)),i.jsx(d,ie({},h))]}))}const sS=C.forwardRef(function(r,t){const n=Dt({props:r,name:"MuiPickersSectionList"}),{slots:a,slotProps:s,elements:o,sectionListRef:c,classes:l}=n,u=Qe(n,rS),d=nS(l),{ownerState:f}=dr(),h=C.useRef(null),x=Ur(t,h),m=w=>{if(!h.current)throw new Error(`MUI X: Cannot call sectionListRef.${w} before the mount of the component.`);return h.current};C.useImperativeHandle(c,()=>({getRoot(){return m("getRoot")},getSectionContainer(w){return m("getSectionContainer").querySelector(`.${hi.section}[data-sectionindex="${w}"]`)},getSectionContent(w){return m("getSectionContent").querySelector(`.${hi.section}[data-sectionindex="${w}"] .${hi.sectionContent}`)},getSectionIndexFromDOMElement(w){const y=m("getSectionIndexFromDOMElement");if(w==null||!y.contains(w))return null;let v=null;return w.classList.contains(hi.section)?v=w:w.classList.contains(hi.sectionContent)&&(v=w.parentElement),v==null?null:Number(v.dataset.sectionindex)}}));const p=(a==null?void 0:a.root)??Mm,g=ht({elementType:p,externalSlotProps:s==null?void 0:s.root,externalForwardedProps:u,additionalProps:{ref:x,suppressContentEditableWarning:!0},className:d.root,ownerState:f});return i.jsx(p,ie({},g,{children:g.contentEditable?o.map(({content:w,before:y,after:v})=>`${y.children}${w.children}${v.children}`).join(""):i.jsx(C.Fragment,{children:o.map((w,y)=>i.jsx(aS,{slots:a,slotProps:s,element:w,classes:d},y))})}))}),Um=C.createContext(null),Pc=()=>{const e=C.useContext(Um);if(e==null)throw new Error(["MUI X: The `usePickerTextFieldOwnerState` can only be called in components that are used inside a PickerTextField component"].join(`
`));return e},iS=["elements","areAllSectionsEmpty","defaultValue","label","value","onChange","id","autoFocus","endAdornment","startAdornment","renderSuffix","slots","slotProps","contentEditable","tabIndex","onInput","onPaste","onKeyDown","fullWidth","name","readOnly","inputProps","inputRef","sectionListRef","onFocus","onBlur","classes","ownerState"],oS=e=>Math.round(e*1e5)/1e5,Oc=Ge("div",{name:"MuiPickersInputBase",slot:"Root"})(({theme:e})=>ie({},e.typography.body1,{color:(e.vars||e).palette.text.primary,cursor:"text",padding:0,display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",boxSizing:"border-box",letterSpacing:`${oS(.15/16)}em`,variants:[{props:{isInputInFullWidth:!0},style:{width:"100%"}}]})),Hu=Ge(Mm,{name:"MuiPickersInputBase",slot:"SectionsContainer"})(({theme:e})=>({padding:"4px 0 5px",fontFamily:e.typography.fontFamily,fontSize:"inherit",lineHeight:"1.4375em",flexGrow:1,outline:"none",display:"flex",flexWrap:"nowrap",overflow:"hidden",letterSpacing:"inherit",width:"182px",variants:[{props:{fieldDirection:"rtl"},style:{textAlign:"right /*! @noflip */"}},{props:{inputSize:"small"},style:{paddingTop:1}},{props:{hasStartAdornment:!1,isFieldFocused:!1,isFieldValueEmpty:!0},style:{color:"currentColor",opacity:0}},{props:{hasStartAdornment:!1,isFieldFocused:!1,isFieldValueEmpty:!0,inputHasLabel:!1},style:e.vars?{opacity:e.vars.opacity.inputPlaceholder}:{opacity:e.palette.mode==="light"?.42:.5}}]})),cS=Ge(Lm,{name:"MuiPickersInputBase",slot:"Section"})(({theme:e})=>({fontFamily:e.typography.fontFamily,fontSize:"inherit",letterSpacing:"inherit",lineHeight:"1.4375em",display:"inline-block",whiteSpace:"nowrap"})),lS=Ge($m,{name:"MuiPickersInputBase",slot:"SectionContent",overridesResolver:(e,r)=>r.content})(({theme:e})=>({fontFamily:e.typography.fontFamily,lineHeight:"1.4375em",letterSpacing:"inherit",width:"fit-content",outline:"none"})),uS=Ge(Bm,{name:"MuiPickersInputBase",slot:"Separator"})(()=>({whiteSpace:"pre",letterSpacing:"inherit"})),dS=Ge("input",{name:"MuiPickersInputBase",slot:"Input",overridesResolver:(e,r)=>r.hiddenInput})(ie({},gw)),fS=Ge("div",{name:"MuiPickersInputBase",slot:"ActiveBar"})(({theme:e,ownerState:r})=>({display:"none",position:"absolute",height:2,bottom:2,borderTopLeftRadius:2,borderTopRightRadius:2,transition:e.transitions.create(["width","left"],{duration:e.transitions.duration.shortest}),backgroundColor:(e.vars||e).palette.primary.main,'[data-active-range-position="start"] &, [data-active-range-position="end"] &':{display:"block"},'[data-active-range-position="start"] &':{left:r.sectionOffsets[0]},'[data-active-range-position="end"] &':{left:r.sectionOffsets[1]}})),hS=(e,r)=>{const{isFieldFocused:t,isFieldDisabled:n,isFieldReadOnly:a,hasFieldError:s,inputSize:o,isInputInFullWidth:c,inputColor:l,hasStartAdornment:u,hasEndAdornment:d}=r,f={root:["root",t&&!n&&"focused",n&&"disabled",a&&"readOnly",s&&"error",c&&"fullWidth",`color${lw(l)}`,o==="small"&&"inputSizeSmall",u&&"adornedStart",d&&"adornedEnd"],notchedOutline:["notchedOutline"],input:["input"],sectionsContainer:["sectionsContainer"],sectionContent:["sectionContent"],sectionBefore:["sectionBefore"],sectionAfter:["sectionAfter"],activeBar:["activeBar"]};return Rt(f,eS,e)};function d0(e,r,t,n){var a;if(e.content.id){const s=(a=r.current)==null?void 0:a.querySelectorAll(`[data-sectionindex="${t}"] [data-range-position="${n}"]`);if(s)return Array.from(s).reduce((o,c)=>o+c.offsetWidth,0)}return 0}function pS(e,r){var a,s,o,c,l;let t=0;if(((a=r.current)==null?void 0:a.getAttribute("data-active-range-position"))==="end")for(let u=e.length-1;u>=e.length/2;u-=1)t+=d0(e[u],r,u,"end");else for(let u=0;u<e.length/2;u+=1)t+=d0(e[u],r,u,"start");return{activeBarWidth:t,sectionOffsets:[((o=(s=r.current)==null?void 0:s.querySelector('[data-sectionindex="0"]'))==null?void 0:o.offsetLeft)||0,((l=(c=r.current)==null?void 0:c.querySelector(`[data-sectionindex="${e.length/2}"]`))==null?void 0:l.offsetLeft)||0]}}const zu=C.forwardRef(function(r,t){const n=Dt({props:r,name:"MuiPickersInputBase"}),{elements:a,areAllSectionsEmpty:s,value:o,onChange:c,id:l,endAdornment:u,startAdornment:d,renderSuffix:f,slots:h,slotProps:x,contentEditable:m,tabIndex:p,onInput:g,onPaste:w,onKeyDown:y,name:v,readOnly:T,inputProps:F,inputRef:A,sectionListRef:S,onFocus:E,onBlur:b,classes:k,ownerState:j}=n,_=Qe(n,iS),B=Pc(),Q=C.useRef(null),Z=C.useRef(null),L=C.useRef([]),q=Ur(t,Q),te=Ur(F==null?void 0:F.ref,A),R=Tp();if(!R)throw new Error("MUI X: PickersInputBase should always be used inside a PickersTextField component");const oe=j??B,J=K=>{var O;(O=R.onFocus)==null||O.call(R,K),E==null||E(K)},P=K=>{J(K)},V=K=>{var O,D;if(y==null||y(K),K.key==="Enter"&&!K.defaultMuiPrevented){if((O=Q.current)!=null&&O.dataset.multiInput)return;const re=(D=Q.current)==null?void 0:D.closest("form"),le=re==null?void 0:re.querySelector('[type="submit"]');if(!re||!le)return;K.preventDefault(),re.requestSubmit(le)}},z=K=>{var O;(O=R.onBlur)==null||O.call(R,K),b==null||b(K)};C.useEffect(()=>{R&&R.setAdornedStart(!!d)},[R,d]),C.useEffect(()=>{R&&(s?R.onEmpty():R.onFilled())},[R,s]);const G=hS(k,oe),ne=(h==null?void 0:h.root)||Oc,he=ht({elementType:ne,externalSlotProps:x==null?void 0:x.root,externalForwardedProps:_,additionalProps:{"aria-invalid":R.error,ref:q},className:G.root,ownerState:oe}),se=(h==null?void 0:h.input)||Hu,ae=a.some(K=>K.content["data-range-position"]!==void 0);return C.useEffect(()=>{if(!ae||!oe.isPickerOpen)return;const{activeBarWidth:K,sectionOffsets:O}=pS(a,Q);L.current=[O[0],O[1]],Z.current&&(Z.current.style.width=`${K}px`)},[a,ae,oe.isPickerOpen]),i.jsxs(ne,ie({},he,{children:[d,i.jsx(sS,{sectionListRef:S,elements:a,contentEditable:m,tabIndex:p,className:G.sectionsContainer,onFocus:J,onBlur:z,onInput:g,onPaste:w,onKeyDown:V,slots:{root:se,section:cS,sectionContent:lS,sectionSeparator:uS},slotProps:{root:ie({},x==null?void 0:x.input,{ownerState:oe}),sectionContent:{className:Ms.sectionContent},sectionSeparator:({separatorPosition:K})=>({className:K==="before"?Ms.sectionBefore:Ms.sectionAfter})}}),u,f?f(ie({},R)):null,i.jsx(dS,ie({name:v,className:G.input,value:o,onChange:c,id:l,"aria-hidden":"true",tabIndex:-1,readOnly:T,required:R.required,disabled:R.disabled,onFocus:P},F,{ref:te})),ae&&i.jsx(fS,{className:G.activeBar,ref:Z,ownerState:{sectionOffsets:L.current}})]}))});function mS(e){return Xt("MuiPickersOutlinedInput",e)}const dn=ie({},Ms,er("MuiPickersOutlinedInput",["root","notchedOutline","input"])),xS=["children","className","label","notched","shrink"],gS=Ge("fieldset",{name:"MuiPickersOutlinedInput",slot:"NotchedOutline"})(({theme:e})=>{const r=e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%",borderColor:e.vars?`rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:r}}),f0=Ge("span")(({theme:e})=>({fontFamily:e.typography.fontFamily,fontSize:"inherit"})),yS=Ge("legend",{shouldForwardProp:e=>to(e)&&e!=="notched"})(({theme:e})=>({float:"unset",width:"auto",overflow:"hidden",variants:[{props:{inputHasLabel:!1},style:{padding:0,lineHeight:"11px",transition:e.transitions.create("width",{duration:150,easing:e.transitions.easing.easeOut})}},{props:{inputHasLabel:!0},style:{display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:e.transitions.create("max-width",{duration:50,easing:e.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}}},{props:{inputHasLabel:!0,notched:!0},style:{maxWidth:"100%",transition:e.transitions.create("max-width",{duration:100,easing:e.transitions.easing.easeOut,delay:50})}}]}));function vS(e){const{className:r,label:t,notched:n}=e,a=Qe(e,xS),s=Pc();return i.jsx(gS,ie({"aria-hidden":!0,className:r},a,{ownerState:s,children:i.jsx(yS,{ownerState:s,notched:n,children:t?i.jsx(f0,{children:t}):i.jsx(f0,{className:"notranslate",children:"​"})})}))}const bS=["label","autoFocus","ownerState","classes","notched"],wS=Ge(Oc,{name:"MuiPickersOutlinedInput",slot:"Root"})(({theme:e})=>{const r=e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{padding:"0 14px",borderRadius:(e.vars||e).shape.borderRadius,[`&:hover .${dn.notchedOutline}`]:{borderColor:(e.vars||e).palette.text.primary},"@media (hover: none)":{[`&:hover .${dn.notchedOutline}`]:{borderColor:e.vars?`rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:r}},[`&.${dn.focused} .${dn.notchedOutline}`]:{borderStyle:"solid",borderWidth:2},[`&.${dn.disabled}`]:{[`& .${dn.notchedOutline}`]:{borderColor:(e.vars||e).palette.action.disabled},"*":{color:(e.vars||e).palette.action.disabled}},[`&.${dn.error} .${dn.notchedOutline}`]:{borderColor:(e.vars||e).palette.error.main},variants:Object.keys((e.vars??e).palette).filter(t=>{var n;return((n=(e.vars??e).palette[t])==null?void 0:n.main)??!1}).map(t=>({props:{inputColor:t},style:{[`&.${dn.focused}:not(.${dn.error}) .${dn.notchedOutline}`]:{borderColor:(e.vars||e).palette[t].main}}}))}}),SS=Ge(Hu,{name:"MuiPickersOutlinedInput",slot:"SectionsContainer"})({padding:"16.5px 0",variants:[{props:{inputSize:"small"},style:{padding:"8.5px 0"}}]}),ES=e=>{const t=Rt({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},mS,e);return ie({},e,t)},Vm=C.forwardRef(function(r,t){const n=Dt({props:r,name:"MuiPickersOutlinedInput"}),{label:a,classes:s,notched:o}=n,c=Qe(n,bS),l=Tp(),u=ES(s);return i.jsx(zu,ie({slots:{root:wS,input:SS},renderSuffix:d=>i.jsx(vS,{shrink:!!(o||d.adornedStart||d.focused||d.filled),notched:!!(o||d.adornedStart||d.focused||d.filled),className:u.notchedOutline,label:a!=null&&a!==""&&(l!=null&&l.required)?i.jsxs(C.Fragment,{children:[a," ","*"]}):a})},c,{label:a,classes:u,ref:t}))});Vm.muiName="Input";function TS(e){return Xt("MuiPickersFilledInput",e)}const Ia=ie({},Ms,er("MuiPickersFilledInput",["root","underline","input"])),AS=["label","autoFocus","disableUnderline","hiddenLabel","classes"],kS=Ge(Oc,{name:"MuiPickersFilledInput",slot:"Root",shouldForwardProp:e=>Ap(e)&&e!=="disableUnderline"})(({theme:e})=>{const r=e.palette.mode==="light",t=r?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",n=r?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",a=r?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",s=r?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return{backgroundColor:e.vars?e.vars.palette.FilledInput.bg:n,borderTopLeftRadius:(e.vars||e).shape.borderRadius,borderTopRightRadius:(e.vars||e).shape.borderRadius,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),"&:hover":{backgroundColor:e.vars?e.vars.palette.FilledInput.hoverBg:a,"@media (hover: none)":{backgroundColor:e.vars?e.vars.palette.FilledInput.bg:n}},[`&.${Ia.focused}`]:{backgroundColor:e.vars?e.vars.palette.FilledInput.bg:n},[`&.${Ia.disabled}`]:{backgroundColor:e.vars?e.vars.palette.FilledInput.disabledBg:s},variants:[...Object.keys((e.vars??e).palette).filter(o=>(e.vars??e).palette[o].main).map(o=>{var c;return{props:{inputColor:o,disableUnderline:!1},style:{"&::after":{borderBottom:`2px solid ${(c=(e.vars||e).palette[o])==null?void 0:c.main}`}}}}),{props:{disableUnderline:!1},style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${Ia.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${Ia.error}`]:{"&:before, &:after":{borderBottomColor:(e.vars||e).palette.error.main}},"&::before":{borderBottom:`1px solid ${e.vars?`rgba(${e.vars.palette.common.onBackgroundChannel} / ${e.vars.opacity.inputUnderline})`:t}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:e.transitions.create("border-bottom-color",{duration:e.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${Ia.disabled}, .${Ia.error}):before`]:{borderBottom:`1px solid ${(e.vars||e).palette.text.primary}`},[`&.${Ia.disabled}:before`]:{borderBottomStyle:"dotted"}}},{props:{hasStartAdornment:!0},style:{paddingLeft:12}},{props:{hasEndAdornment:!0},style:{paddingRight:12}}]}}),CS=Ge(Hu,{name:"MuiPickersFilledInput",slot:"sectionsContainer",shouldForwardProp:e=>Ap(e)&&e!=="hiddenLabel"})({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12,variants:[{props:{inputSize:"small"},style:{paddingTop:21,paddingBottom:4}},{props:{hasStartAdornment:!0},style:{paddingLeft:0}},{props:{hasEndAdornment:!0},style:{paddingRight:0}},{props:{hiddenLabel:!0},style:{paddingTop:16,paddingBottom:17}},{props:{hiddenLabel:!0,inputSize:"small"},style:{paddingTop:8,paddingBottom:9}}]}),_S=(e,r)=>{const{inputHasUnderline:t}=r,a=Rt({root:["root",t&&"underline"],input:["input"]},TS,e);return ie({},e,a)},Wm=C.forwardRef(function(r,t){const n=Dt({props:r,name:"MuiPickersFilledInput"}),{label:a,disableUnderline:s=!1,hiddenLabel:o=!1,classes:c}=n,l=Qe(n,AS),u=Pc(),d=ie({},u,{inputHasUnderline:!s}),f=_S(c,d);return i.jsx(zu,ie({slots:{root:kS,input:CS},slotProps:{root:{disableUnderline:s},input:{hiddenLabel:o}}},l,{label:a,classes:f,ref:t,ownerState:d}))});Wm.muiName="Input";function DS(e){return Xt("MuiPickersFilledInput",e)}const pi=ie({},Ms,er("MuiPickersInput",["root","underline","input"])),FS=["label","autoFocus","disableUnderline","ownerState","classes"],jS=Ge(Oc,{name:"MuiPickersInput",slot:"Root",shouldForwardProp:e=>to(e)&&e!=="disableUnderline"})(({theme:e})=>{let t=e.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return e.vars&&(t=`rgba(${e.vars.palette.common.onBackgroundChannel} / ${e.vars.opacity.inputUnderline})`),{"label + &":{marginTop:16},variants:[...Object.keys((e.vars??e).palette).filter(n=>(e.vars??e).palette[n].main).map(n=>({props:{inputColor:n},style:{"&::after":{borderBottom:`2px solid ${(e.vars||e).palette[n].main}`}}})),{props:{disableUnderline:!1},style:{"&::after":{background:"red",left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${pi.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${pi.error}`]:{"&:before, &:after":{borderBottomColor:(e.vars||e).palette.error.main}},"&::before":{borderBottom:`1px solid ${t}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:e.transitions.create("border-bottom-color",{duration:e.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${pi.disabled}, .${pi.error}):before`]:{borderBottom:`2px solid ${(e.vars||e).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${t}`}},[`&.${pi.disabled}:before`]:{borderBottomStyle:"dotted"}}}]}}),IS=(e,r)=>{const{inputHasUnderline:t}=r,a=Rt({root:["root",!t&&"underline"],input:["input"]},DS,e);return ie({},e,a)},Hm=C.forwardRef(function(r,t){const n=Dt({props:r,name:"MuiPickersInput"}),{label:a,disableUnderline:s=!1,classes:o}=n,c=Qe(n,FS),l=Pc(),u=ie({},l,{inputHasUnderline:!s}),d=IS(o,u);return i.jsx(zu,ie({slots:{root:jS},slotProps:{root:{disableUnderline:s}}},c,{label:a,classes:d,ref:t}))});Hm.muiName="Input";const PS=["onFocus","onBlur","className","classes","color","disabled","error","variant","required","InputProps","inputProps","inputRef","sectionListRef","elements","areAllSectionsEmpty","onClick","onKeyDown","onKeyUp","onPaste","onInput","endAdornment","startAdornment","tabIndex","contentEditable","focused","value","onChange","fullWidth","id","name","helperText","FormHelperTextProps","label","InputLabelProps","data-active-range-position"],OS={standard:Hm,filled:Wm,outlined:Vm},RS=Ge(mt,{name:"MuiPickersTextField",slot:"Root"})({}),NS=(e,r)=>{const{isFieldFocused:t,isFieldDisabled:n,isFieldRequired:a}=r;return Rt({root:["root",t&&!n&&"focused",n&&"disabled",a&&"required"]},Z2,e)},zm=C.forwardRef(function(r,t){const n=Dt({props:r,name:"MuiPickersTextField"}),{onFocus:a,onBlur:s,className:o,classes:c,color:l="primary",disabled:u=!1,error:d=!1,variant:f="outlined",required:h=!1,InputProps:x,inputProps:m,inputRef:p,sectionListRef:g,elements:w,areAllSectionsEmpty:y,onClick:v,onKeyDown:T,onKeyUp:F,onPaste:A,onInput:S,endAdornment:E,startAdornment:b,tabIndex:k,contentEditable:j,focused:_,value:B,onChange:Q,fullWidth:Z,id:L,name:q,helperText:te,FormHelperTextProps:R,label:oe,InputLabelProps:J,"data-active-range-position":P}=n,V=Qe(n,PS),z=C.useRef(null),G=Ur(t,z),ne=_c(L),he=te&&ne?`${ne}-helper-text`:void 0,se=oe&&ne?`${ne}-label`:void 0,ae=Wu({disabled:n.disabled,required:n.required,readOnly:x==null?void 0:x.readOnly}),K=C.useMemo(()=>ie({},ae,{isFieldValueEmpty:y,isFieldFocused:_??!1,hasFieldError:d??!1,inputSize:n.size??"medium",inputColor:l??"primary",isInputInFullWidth:Z??!1,hasStartAdornment:!!(b??(x==null?void 0:x.startAdornment)),hasEndAdornment:!!(E??(x==null?void 0:x.endAdornment)),inputHasLabel:!!oe}),[ae,y,_,d,n.size,l,Z,b,E,x==null?void 0:x.startAdornment,x==null?void 0:x.endAdornment,oe]),O=NS(c,K),D=OS[f];return i.jsx(Um.Provider,{value:K,children:i.jsxs(RS,ie({className:Qt(O.root,o),ref:G,focused:_,disabled:u,variant:f,error:d,color:l,fullWidth:Z,required:h,ownerState:K},V,{children:[oe!=null&&oe!==""&&i.jsx(Tt,ie({htmlFor:ne,id:se},J,{children:oe})),i.jsx(D,ie({elements:w,areAllSectionsEmpty:y,onClick:v,onKeyDown:T,onKeyUp:F,onInput:S,onPaste:A,onFocus:a,onBlur:s,endAdornment:E,startAdornment:b,tabIndex:k,contentEditable:j,value:B,onChange:Q,id:ne,fullWidth:Z,inputProps:m,inputRef:p,sectionListRef:g,label:oe,name:q,role:"group","aria-labelledby":se,"aria-describedby":he,"aria-live":he?"polite":void 0,"data-active-range-position":P},x)),te&&i.jsx(Ja,ie({id:he},R,{children:te}))]}))})}),MS=["enableAccessibleFieldDOMStructure"],LS=["InputProps","readOnly","onClear","clearable","clearButtonPosition","openPickerButtonPosition","openPickerAriaLabel"],BS=["onPaste","onKeyDown","inputMode","readOnly","InputProps","inputProps","inputRef","onClear","clearable","clearButtonPosition","openPickerButtonPosition","openPickerAriaLabel"],$S=["ownerState"],US=["ownerState"],VS=["ownerState"],WS=["ownerState"],HS=["InputProps","inputProps"],zS=e=>{let{enableAccessibleFieldDOMStructure:r}=e,t=Qe(e,MS);if(r){const{InputProps:g,readOnly:w,onClear:y,clearable:v,clearButtonPosition:T,openPickerButtonPosition:F,openPickerAriaLabel:A}=t,S=Qe(t,LS);return{clearable:v,onClear:y,clearButtonPosition:T,openPickerButtonPosition:F,openPickerAriaLabel:A,textFieldProps:ie({},S,{InputProps:ie({},g??{},{readOnly:w})})}}const{onPaste:n,onKeyDown:a,inputMode:s,readOnly:o,InputProps:c,inputProps:l,inputRef:u,onClear:d,clearable:f,clearButtonPosition:h,openPickerButtonPosition:x,openPickerAriaLabel:m}=t,p=Qe(t,BS);return{clearable:f,onClear:d,clearButtonPosition:h,openPickerButtonPosition:x,openPickerAriaLabel:m,textFieldProps:ie({},p,{InputProps:ie({},c??{},{readOnly:o}),inputProps:ie({},l??{},{inputMode:s,onPaste:n,onKeyDown:a,ref:u})})}},Gu=C.createContext({slots:{},slotProps:{},inputRef:void 0});function GS(e){var R,oe;const{slots:r,slotProps:t,fieldResponse:n,defaultOpenPickerIcon:a}=e,s=Aa(),o=Uu(),c=C.useContext(Gu),{textFieldProps:l,onClear:u,clearable:d,openPickerAriaLabel:f,clearButtonPosition:h="end",openPickerButtonPosition:x="end"}=zS(n),m=Wu(l),p=Ue(J=>{J.preventDefault(),o==null||o.setOpen(P=>!P)}),g=o?o.triggerStatus:"hidden",w=d?h:null,y=g!=="hidden"?x:null,v=(r==null?void 0:r.textField)??c.slots.textField??(n.enableAccessibleFieldDOMStructure===!1?Ae:zm),T=(r==null?void 0:r.inputAdornment)??c.slots.inputAdornment??yn,F=ht({elementType:T,externalSlotProps:Wo(c.slotProps.inputAdornment,t==null?void 0:t.inputAdornment),additionalProps:{position:"start"},ownerState:ie({},m,{position:"start"})}),A=Qe(F,$S),S=ht({elementType:T,externalSlotProps:t==null?void 0:t.inputAdornment,additionalProps:{position:"end"},ownerState:ie({},m,{position:"end"})}),E=Qe(S,US),b=c.slots.openPickerButton??Ze,k=ht({elementType:b,externalSlotProps:c.slotProps.openPickerButton,additionalProps:{disabled:g==="disabled",onClick:p,"aria-label":f,edge:l.variant!=="standard"?y:!1},ownerState:m}),j=Qe(k,VS),_=c.slots.openPickerIcon??a,B=ht({elementType:_,externalSlotProps:c.slotProps.openPickerIcon,ownerState:m}),Q=(r==null?void 0:r.clearButton)??c.slots.clearButton??Ze,Z=ht({elementType:Q,externalSlotProps:Wo(c.slotProps.clearButton,t==null?void 0:t.clearButton),className:"clearButton",additionalProps:{title:s.fieldClearLabel,tabIndex:-1,onClick:u,disabled:n.disabled||n.readOnly,edge:l.variant!=="standard"&&w!==y?w:!1},ownerState:m}),L=Qe(Z,WS),q=(r==null?void 0:r.clearIcon)??c.slots.clearIcon??Ow,te=ht({elementType:q,externalSlotProps:Wo(c.slotProps.clearIcon,t==null?void 0:t.clearIcon),additionalProps:{fontSize:"small"},ownerState:m});return l.ref=Ur(l.ref,o==null?void 0:o.rootRef),l.InputProps||(l.InputProps={}),o&&(l.InputProps.ref=o.triggerRef),!((R=l.InputProps)!=null&&R.startAdornment)&&(w==="start"||y==="start")&&(l.InputProps.startAdornment=i.jsxs(T,ie({},A,{children:[y==="start"&&i.jsx(b,ie({},j,{children:i.jsx(_,ie({},B))})),w==="start"&&i.jsx(Q,ie({},L,{children:i.jsx(q,ie({},te))}))]}))),!((oe=l.InputProps)!=null&&oe.endAdornment)&&(w==="end"||y==="end")&&(l.InputProps.endAdornment=i.jsxs(T,ie({},E,{children:[w==="end"&&i.jsx(Q,ie({},L,{children:i.jsx(q,ie({},te))})),y==="end"&&i.jsx(b,ie({},j,{children:i.jsx(_,ie({},B))}))]}))),w!=null&&(l.sx=[{"& .clearButton":{opacity:1},"@media (pointer: fine)":{"& .clearButton":{opacity:0},"&:hover, &:focus-within":{".clearButton":{opacity:1}}}},...Array.isArray(l.sx)?l.sx:[l.sx]]),i.jsx(v,ie({},l))}function Wo(e,r){return e?r?t=>ie({},$i(r,t),$i(e,t)):e:r}function YS(e){const{ref:r,externalForwardedProps:t,slotProps:n}=e,a=C.useContext(Gu),s=Uu(),o=Wu(t),{InputProps:c,inputProps:l}=t,u=Qe(t,HS),d=ht({elementType:zm,externalSlotProps:Wo(a.slotProps.textField,n==null?void 0:n.textField),externalForwardedProps:u,additionalProps:{ref:r,sx:s==null?void 0:s.rootSx,label:s==null?void 0:s.label,name:s==null?void 0:s.name,className:s==null?void 0:s.rootClassName,inputRef:a.inputRef},ownerState:o});return d.inputProps=ie({},l,d.inputProps),d.InputProps=ie({},c,d.InputProps),d}function Gm(e){const{slots:r={},slotProps:t={},inputRef:n,children:a}=e,s=C.useMemo(()=>({inputRef:n,slots:{openPickerButton:r.openPickerButton,openPickerIcon:r.openPickerIcon,textField:r.textField,inputAdornment:r.inputAdornment,clearIcon:r.clearIcon,clearButton:r.clearButton},slotProps:{openPickerButton:t.openPickerButton,openPickerIcon:t.openPickerIcon,textField:t.textField,inputAdornment:t.inputAdornment,clearIcon:t.clearIcon,clearButton:t.clearButton}}),[n,r.openPickerButton,r.openPickerIcon,r.textField,r.inputAdornment,r.clearIcon,r.clearButton,t.openPickerButton,t.openPickerIcon,t.textField,t.inputAdornment,t.clearIcon,t.clearButton]);return i.jsx(Gu.Provider,{value:s,children:a})}const qS=["slots","slotProps"],Ym=C.forwardRef(function(r,t){const n=Dt({props:r,name:"MuiDateField"}),{slots:a,slotProps:s}=n,o=Qe(n,qS),c=YS({slotProps:s,ref:t,externalForwardedProps:o}),l=Q2(c);return i.jsx(GS,{slots:a,slotProps:s,fieldResponse:l,defaultOpenPickerIcon:Pw})}),qm=({shouldDisableDate:e,shouldDisableMonth:r,shouldDisableYear:t,minDate:n,maxDate:a,disableFuture:s,disablePast:o,timezone:c})=>{const l=ls();return C.useCallback(u=>io({adapter:l,value:u,timezone:c,props:{shouldDisableDate:e,shouldDisableMonth:r,shouldDisableYear:t,minDate:n,maxDate:a,disableFuture:s,disablePast:o}})!==null,[l,e,r,t,n,a,s,o,c])},XS=(e,r)=>(t,n)=>{switch(n.type){case"setVisibleDate":return ie({},t,{slideDirection:n.direction,currentMonth:n.month,isMonthSwitchingAnimating:!r.isSameMonth(n.month,t.currentMonth)&&!e&&!n.skipAnimation,focusedDay:n.focusedDay});case"changeMonthTimezone":{const a=n.newTimezone;if(r.getTimezone(t.currentMonth)===a)return t;let s=r.setTimezone(t.currentMonth,a);return r.getMonth(s)!==r.getMonth(t.currentMonth)&&(s=r.setMonth(s,r.getMonth(t.currentMonth))),ie({},t,{currentMonth:s})}case"finishMonthSwitchingAnimation":return ie({},t,{isMonthSwitchingAnimating:!1});default:throw new Error("missing support")}},KS=e=>{const{value:r,referenceDate:t,disableFuture:n,disablePast:a,maxDate:s,minDate:o,onMonthChange:c,onYearChange:l,reduceAnimations:u,shouldDisableDate:d,timezone:f,getCurrentMonthFromVisibleDate:h}=e,x=St(),m=C.useRef(XS(!!u,x)).current,p=C.useMemo(()=>$n.getInitialReferenceValue({value:r,utils:x,timezone:f,props:e,referenceDate:t,granularity:Pn.day}),[t,f]),[g,w]=C.useReducer(m,{isMonthSwitchingAnimating:!1,focusedDay:p,currentMonth:x.startOfMonth(p),slideDirection:"left"}),y=qm({shouldDisableDate:d,minDate:o,maxDate:s,disableFuture:n,disablePast:a,timezone:f});C.useEffect(()=>{w({type:"changeMonthTimezone",newTimezone:x.getTimezone(p)})},[p,x]);const v=Ue(({target:F,reason:A})=>{if(A==="cell-interaction"&&g.focusedDay!=null&&x.isSameDay(F,g.focusedDay))return;const S=A==="cell-interaction";let E,b;if(A==="cell-interaction")E=h(F,g.currentMonth),b=F;else if(E=x.isSameMonth(F,g.currentMonth)?g.currentMonth:x.startOfMonth(F),b=F,y(b)){const _=x.startOfMonth(F),B=x.endOfMonth(F);b=Vi({utils:x,date:b,minDate:x.isBefore(o,_)?_:o,maxDate:x.isAfter(s,B)?B:s,disablePast:a,disableFuture:n,isDateDisabled:y,timezone:f})}const k=!x.isSameMonth(g.currentMonth,E),j=!x.isSameYear(g.currentMonth,E);k&&(c==null||c(E)),j&&(l==null||l(x.startOfYear(E))),w({type:"setVisibleDate",month:E,direction:x.isAfterDay(E,g.currentMonth)?"left":"right",focusedDay:g.focusedDay!=null&&b!=null&&x.isSameDay(b,g.focusedDay)?g.focusedDay:b,skipAnimation:S})}),T=C.useCallback(()=>{w({type:"finishMonthSwitchingAnimation"})},[]);return{referenceDate:p,calendarState:g,setVisibleDate:v,isDateDisabled:y,onMonthSwitchingAnimationEnd:T}},JS=e=>Xt("MuiPickersFadeTransitionGroup",e);er("MuiPickersFadeTransitionGroup",["root"]);const QS=["children"],ZS=e=>Rt({root:["root"]},JS,e),eE=Ge(kp,{name:"MuiPickersFadeTransitionGroup",slot:"Root"})({display:"block",position:"relative"});function Xm(e){const r=Dt({props:e,name:"MuiPickersFadeTransitionGroup"}),{className:t,reduceAnimations:n,transKey:a,classes:s}=r,{children:o}=r,c=Qe(r,QS),l=ZS(s),u=vu();return n?o:i.jsx(eE,{className:Qt(l.root,t),ownerState:c,children:i.jsx(gc,{appear:!1,mountOnEnter:!0,unmountOnExit:!0,timeout:{appear:u.transitions.duration.enteringScreen,enter:u.transitions.duration.enteringScreen,exit:0},children:o},a)})}const tE=e=>Xt("MuiPickersSlideTransition",e),Jr=er("MuiPickersSlideTransition",["root","slideEnter-left","slideEnter-right","slideEnterActive","slideExit","slideExitActiveLeft-left","slideExitActiveLeft-right"]),rE=["children","className","reduceAnimations","slideDirection","transKey","classes"],nE=(e,r)=>{const{slideDirection:t}=r,n={root:["root"],exit:["slideExit"],enterActive:["slideEnterActive"],enter:[`slideEnter-${t}`],exitActive:[`slideExitActiveLeft-${t}`]};return Rt(n,tE,e)},aE=Ge(kp,{name:"MuiPickersSlideTransition",slot:"Root",overridesResolver:(e,r)=>[r.root,{[`.${Jr["slideEnter-left"]}`]:r["slideEnter-left"]},{[`.${Jr["slideEnter-right"]}`]:r["slideEnter-right"]},{[`.${Jr.slideEnterActive}`]:r.slideEnterActive},{[`.${Jr.slideExit}`]:r.slideExit},{[`.${Jr["slideExitActiveLeft-left"]}`]:r["slideExitActiveLeft-left"]},{[`.${Jr["slideExitActiveLeft-right"]}`]:r["slideExitActiveLeft-right"]}]})(({theme:e})=>{const r=e.transitions.create("transform",{duration:e.transitions.duration.complex,easing:"cubic-bezier(0.35, 0.8, 0.4, 1)"});return{display:"block",position:"relative",overflowX:"hidden","& > *":{position:"absolute",top:0,right:0,left:0},[`& .${Jr["slideEnter-left"]}`]:{willChange:"transform",transform:"translate(100%)",zIndex:1},[`& .${Jr["slideEnter-right"]}`]:{willChange:"transform",transform:"translate(-100%)",zIndex:1},[`& .${Jr.slideEnterActive}`]:{transform:"translate(0%)",transition:r},[`& .${Jr.slideExit}`]:{transform:"translate(0%)"},[`& .${Jr["slideExitActiveLeft-left"]}`]:{willChange:"transform",transform:"translate(-100%)",transition:r,zIndex:0},[`& .${Jr["slideExitActiveLeft-right"]}`]:{willChange:"transform",transform:"translate(100%)",transition:r,zIndex:0}}});function sE(e){const r=Dt({props:e,name:"MuiPickersSlideTransition"}),{children:t,className:n,reduceAnimations:a,slideDirection:s,transKey:o,classes:c}=r,l=Qe(r,rE),{ownerState:u}=dr(),d=ie({},u,{slideDirection:s}),f=nE(c,d),h=vu();if(a)return i.jsx("div",{className:Qt(f.root,n),children:t});const x={exit:f.exit,enterActive:f.enterActive,enter:f.enter,exitActive:f.exitActive};return i.jsx(aE,{className:Qt(f.root,n),childFactory:m=>C.cloneElement(m,{classNames:x}),role:"presentation",ownerState:d,children:i.jsx(Oy,ie({mountOnEnter:!0,unmountOnExit:!0,timeout:h.transitions.duration.complex,classNames:x},l,{children:t}),o)})}const iE=e=>Xt("MuiDayCalendar",e);er("MuiDayCalendar",["root","header","weekDayLabel","loadingContainer","slideTransition","monthContainer","weekContainer","weekNumberLabel","weekNumber"]);const oE=["parentProps","day","focusedDay","selectedDays","isDateDisabled","currentMonthNumber","isViewFocused"],cE=["ownerState"],lE=e=>Rt({root:["root"],header:["header"],weekDayLabel:["weekDayLabel"],loadingContainer:["loadingContainer"],slideTransition:["slideTransition"],monthContainer:["monthContainer"],weekContainer:["weekContainer"],weekNumberLabel:["weekNumberLabel"],weekNumber:["weekNumber"]},iE,e),Km=(Ui+Fc*2)*6,uE=Ge("div",{name:"MuiDayCalendar",slot:"Root"})({}),dE=Ge("div",{name:"MuiDayCalendar",slot:"Header"})({display:"flex",justifyContent:"center",alignItems:"center"}),fE=Ge(ee,{name:"MuiDayCalendar",slot:"WeekDayLabel"})(({theme:e})=>({width:36,height:40,margin:"0 2px",textAlign:"center",display:"flex",justifyContent:"center",alignItems:"center",color:(e.vars||e).palette.text.secondary})),hE=Ge(ee,{name:"MuiDayCalendar",slot:"WeekNumberLabel"})(({theme:e})=>({width:36,height:40,margin:"0 2px",textAlign:"center",display:"flex",justifyContent:"center",alignItems:"center",color:(e.vars||e).palette.text.disabled})),pE=Ge(ee,{name:"MuiDayCalendar",slot:"WeekNumber"})(({theme:e})=>ie({},e.typography.caption,{width:Ui,height:Ui,padding:0,margin:`0 ${Fc}px`,color:(e.vars||e).palette.text.disabled,fontSize:"0.75rem",alignItems:"center",justifyContent:"center",display:"inline-flex"})),mE=Ge("div",{name:"MuiDayCalendar",slot:"LoadingContainer"})({display:"flex",justifyContent:"center",alignItems:"center",minHeight:Km}),xE=Ge(sE,{name:"MuiDayCalendar",slot:"SlideTransition"})({minHeight:Km}),gE=Ge("div",{name:"MuiDayCalendar",slot:"MonthContainer"})({overflow:"hidden"}),yE=Ge("div",{name:"MuiDayCalendar",slot:"WeekContainer"})({margin:`${Fc}px 0`,display:"flex",justifyContent:"center"});function vE(e){let{parentProps:r,day:t,focusedDay:n,selectedDays:a,isDateDisabled:s,currentMonthNumber:o,isViewFocused:c}=e,l=Qe(e,oE);const{disabled:u,disableHighlightToday:d,isMonthSwitchingAnimating:f,showDaysOutsideCurrentMonth:h,slots:x,slotProps:m,timezone:p}=r,g=St(),w=Dc(p),y=n!=null&&g.isSameDay(t,n),v=c&&y,T=a.some(Q=>g.isSameDay(Q,t)),F=g.isSameDay(t,w),A=C.useMemo(()=>u||s(t),[u,s,t]),S=C.useMemo(()=>g.getMonth(t)!==o,[g,t,o]),E=km({day:t,selected:T,disabled:A,today:F,outsideCurrentMonth:S,disableMargin:void 0,disableHighlightToday:d,showDaysOutsideCurrentMonth:h}),b=(x==null?void 0:x.day)??k2,k=ht({elementType:b,externalSlotProps:m==null?void 0:m.day,additionalProps:ie({disableHighlightToday:d,showDaysOutsideCurrentMonth:h,role:"gridcell",isAnimating:f,"data-timestamp":g.toJsDate(t).valueOf()},l),ownerState:ie({},E,{day:t,isDayDisabled:A,isDaySelected:T})}),j=Qe(k,cE),_=C.useMemo(()=>{const Q=g.startOfMonth(g.setMonth(t,o));return h?g.isSameDay(t,g.startOfWeek(Q)):g.isSameDay(t,Q)},[o,t,h,g]),B=C.useMemo(()=>{const Q=g.endOfMonth(g.setMonth(t,o));return h?g.isSameDay(t,g.endOfWeek(Q)):g.isSameDay(t,Q)},[o,t,h,g]);return i.jsx(b,ie({},j,{day:t,disabled:A,autoFocus:!S&&v,today:F,outsideCurrentMonth:S,isFirstVisibleCell:_,isLastVisibleCell:B,selected:T,tabIndex:y?0:-1,"aria-selected":T,"aria-current":F?"date":void 0}))}function bE(e){const r=Dt({props:e,name:"MuiDayCalendar"}),t=St(),{onFocusedDayChange:n,className:a,classes:s,currentMonth:o,selectedDays:c,focusedDay:l,loading:u,onSelectedDaysChange:d,onMonthSwitchingAnimationEnd:f,readOnly:h,reduceAnimations:x,renderLoading:m=()=>i.jsx("span",{children:"..."}),slideDirection:p,TransitionProps:g,disablePast:w,disableFuture:y,minDate:v,maxDate:T,shouldDisableDate:F,shouldDisableMonth:A,shouldDisableYear:S,dayOfWeekFormatter:E=O=>t.format(O,"weekdayShort").charAt(0).toUpperCase(),hasFocus:b,onFocusedViewChange:k,gridLabelId:j,displayWeekNumber:_,fixedWeekNumber:B,timezone:Q}=r,Z=Dc(Q),L=lE(s),q=ra(),te=qm({shouldDisableDate:F,shouldDisableMonth:A,shouldDisableYear:S,minDate:v,maxDate:T,disablePast:w,disableFuture:y,timezone:Q}),R=Aa(),oe=Ue(O=>{h||d(O)}),J=O=>{te(O)||(n(O),k==null||k(!0))},P=Ue((O,D)=>{switch(O.key){case"ArrowUp":J(t.addDays(D,-7)),O.preventDefault();break;case"ArrowDown":J(t.addDays(D,7)),O.preventDefault();break;case"ArrowLeft":{const re=t.addDays(D,q?1:-1),le=t.addMonths(D,q?1:-1),Te=Vi({utils:t,date:re,minDate:q?re:t.startOfMonth(le),maxDate:q?t.endOfMonth(le):re,isDateDisabled:te,timezone:Q});J(Te||re),O.preventDefault();break}case"ArrowRight":{const re=t.addDays(D,q?-1:1),le=t.addMonths(D,q?-1:1),Te=Vi({utils:t,date:re,minDate:q?t.startOfMonth(le):re,maxDate:q?re:t.endOfMonth(le),isDateDisabled:te,timezone:Q});J(Te||re),O.preventDefault();break}case"Home":J(t.startOfWeek(D)),O.preventDefault();break;case"End":J(t.endOfWeek(D)),O.preventDefault();break;case"PageUp":J(t.addMonths(D,1)),O.preventDefault();break;case"PageDown":J(t.addMonths(D,-1)),O.preventDefault();break}}),V=Ue((O,D)=>J(D)),z=Ue((O,D)=>{l!=null&&t.isSameDay(l,D)&&(k==null||k(!1))}),G=t.getMonth(o),ne=t.getYear(o),he=C.useMemo(()=>c.filter(O=>!!O).map(O=>t.startOfDay(O)),[t,c]),se=`${ne}-${G}`,ae=C.useMemo(()=>C.createRef(),[se]),K=C.useMemo(()=>{const O=t.getWeekArray(o);let D=t.addMonths(o,1);for(;B&&O.length<B;){const re=t.getWeekArray(D),le=t.isSameDay(O[O.length-1][0],re[0][0]);re.slice(le?1:0).forEach(Te=>{O.length<B&&O.push(Te)}),D=t.addMonths(D,1)}return O},[o,B,t]);return i.jsxs(uE,{role:"grid","aria-labelledby":j,className:L.root,children:[i.jsxs(dE,{role:"row",className:L.header,children:[_&&i.jsx(hE,{variant:"caption",role:"columnheader","aria-label":R.calendarWeekNumberHeaderLabel,className:L.weekNumberLabel,children:R.calendarWeekNumberHeaderText}),r2(t,Z).map((O,D)=>i.jsx(fE,{variant:"caption",role:"columnheader","aria-label":t.format(O,"weekday"),className:L.weekDayLabel,children:E(O)},D.toString()))]}),u?i.jsx(mE,{className:L.loadingContainer,children:m()}):i.jsx(xE,ie({transKey:se,onExited:f,reduceAnimations:x,slideDirection:p,className:Qt(a,L.slideTransition)},g,{nodeRef:ae,children:i.jsx(gE,{ref:ae,role:"rowgroup",className:L.monthContainer,children:K.map((O,D)=>i.jsxs(yE,{role:"row",className:L.weekContainer,"aria-rowindex":D+1,children:[_&&i.jsx(pE,{className:L.weekNumber,role:"rowheader","aria-label":R.calendarWeekNumberAriaLabelText(t.getWeekNumber(O[0])),children:R.calendarWeekNumberText(t.getWeekNumber(O[0]))}),O.map((re,le)=>i.jsx(vE,{parentProps:r,day:re,selectedDays:he,isViewFocused:b,focusedDay:l,onKeyDown:P,onFocus:V,onBlur:z,onDaySelect:oe,isDateDisabled:te,currentMonthNumber:G,"aria-colindex":le+1},re.toString()))]},`week-${O[0]}`))})}))]})}function Jm(e){return Xt("MuiMonthCalendar",e)}const So=er("MuiMonthCalendar",["root","button","disabled","selected"]),wE=["autoFocus","classes","disabled","selected","value","onClick","onKeyDown","onFocus","onBlur","slots","slotProps"],SE=(e,r)=>{const t={button:["button",r.isMonthDisabled&&"disabled",r.isMonthSelected&&"selected"]};return Rt(t,Jm,e)},EE=Ge("button",{name:"MuiMonthCalendar",slot:"Button",overridesResolver:(e,r)=>[r.button,{[`&.${So.disabled}`]:r.disabled},{[`&.${So.selected}`]:r.selected}]})(({theme:e})=>ie({color:"unset",backgroundColor:"transparent",border:0,outline:0},e.typography.subtitle1,{height:36,width:72,borderRadius:18,cursor:"pointer","&:focus":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:Hs(e.palette.action.active,e.palette.action.hoverOpacity)},"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:Hs(e.palette.action.active,e.palette.action.hoverOpacity)},"&:disabled":{cursor:"auto",pointerEvents:"none"},[`&.${So.disabled}`]:{color:(e.vars||e).palette.text.secondary},[`&.${So.selected}`]:{color:(e.vars||e).palette.primary.contrastText,backgroundColor:(e.vars||e).palette.primary.main,"&:focus, &:hover":{backgroundColor:(e.vars||e).palette.primary.dark}}})),TE=C.memo(function(r){const{autoFocus:t,classes:n,disabled:a,selected:s,value:o,onClick:c,onKeyDown:l,onFocus:u,onBlur:d,slots:f,slotProps:h}=r,x=Qe(r,wE),m=C.useRef(null),{ownerState:p}=dr(),g=ie({},p,{isMonthDisabled:a,isMonthSelected:s}),w=SE(n,g);Bn(()=>{var T;t&&((T=m.current)==null||T.focus())},[t]);const y=(f==null?void 0:f.monthButton)??EE,v=ht({elementType:y,externalSlotProps:h==null?void 0:h.monthButton,externalForwardedProps:x,additionalProps:{disabled:a,ref:m,type:"button",role:"radio","aria-checked":s,onClick:T=>c(T,o),onKeyDown:T=>l(T,o),onFocus:T=>u(T,o),onBlur:T=>d(T,o)},ownerState:g,className:w.button});return i.jsx(y,ie({},v))}),AE=["autoFocus","className","classes","value","defaultValue","referenceDate","disabled","disableFuture","disablePast","maxDate","minDate","onChange","shouldDisableMonth","readOnly","disableHighlightToday","onMonthFocus","hasFocus","onFocusedViewChange","monthsPerRow","timezone","gridLabelId","slots","slotProps"],kE=e=>Rt({root:["root"]},Jm,e);function CE(e,r){const t=Dt({props:e,name:r}),n=oo(t);return ie({},t,n,{monthsPerRow:t.monthsPerRow??3})}const _E=Ge("div",{name:"MuiMonthCalendar",slot:"Root",shouldForwardProp:e=>to(e)&&e!=="monthsPerRow"})({display:"flex",flexWrap:"wrap",justifyContent:"space-evenly",rowGap:16,padding:"8px 0",width:jc,boxSizing:"border-box",variants:[{props:{monthsPerRow:3},style:{columnGap:24}},{props:{monthsPerRow:4},style:{columnGap:0}}]}),DE=C.forwardRef(function(r,t){const n=CE(r,"MuiMonthCalendar"),{autoFocus:a,className:s,classes:o,value:c,defaultValue:l,referenceDate:u,disabled:d,disableFuture:f,disablePast:h,maxDate:x,minDate:m,onChange:p,shouldDisableMonth:g,readOnly:w,onMonthFocus:y,hasFocus:v,onFocusedViewChange:T,monthsPerRow:F,timezone:A,gridLabelId:S,slots:E,slotProps:b}=n,k=Qe(n,AE),{value:j,handleValueChange:_,timezone:B}=so({name:"MonthCalendar",timezone:A,value:c,defaultValue:l,referenceDate:u,onChange:p,valueManager:$n}),Q=Dc(B),Z=ra(),L=St(),{ownerState:q}=dr(),te=C.useMemo(()=>$n.getInitialReferenceValue({value:j,utils:L,props:n,timezone:B,referenceDate:u,granularity:Pn.month}),[]),R=kE(o),oe=C.useMemo(()=>L.getMonth(Q),[L,Q]),J=C.useMemo(()=>j!=null?L.getMonth(j):null,[j,L]),[P,V]=C.useState(()=>J||L.getMonth(te)),[z,G]=Gs({name:"MonthCalendar",state:"hasFocus",controlled:v,default:a??!1}),ne=Ue(re=>{G(re),T&&T(re)}),he=C.useCallback(re=>{const le=L.startOfMonth(h&&L.isAfter(Q,m)?Q:m),Te=L.startOfMonth(f&&L.isBefore(Q,x)?Q:x),ue=L.startOfMonth(re);return L.isBefore(ue,le)||L.isAfter(ue,Te)?!0:g?g(ue):!1},[f,h,x,m,Q,g,L]),se=Ue((re,le)=>{if(w)return;const Te=L.setMonth(j??te,le);_(Te)}),ae=Ue(re=>{he(L.setMonth(j??te,re))||(V(re),ne(!0),y&&y(re))});C.useEffect(()=>{V(re=>J!==null&&re!==J?J:re)},[J]);const K=Ue((re,le)=>{switch(re.key){case"ArrowUp":ae((12+le-3)%12),re.preventDefault();break;case"ArrowDown":ae((12+le+3)%12),re.preventDefault();break;case"ArrowLeft":ae((12+le+(Z?1:-1))%12),re.preventDefault();break;case"ArrowRight":ae((12+le+(Z?-1:1))%12),re.preventDefault();break}}),O=Ue((re,le)=>{ae(le)}),D=Ue((re,le)=>{P===le&&ne(!1)});return i.jsx(_E,ie({ref:t,className:Qt(R.root,s),ownerState:q,role:"radiogroup","aria-labelledby":S,monthsPerRow:F},k,{children:Nu(L,j??te).map(re=>{const le=L.getMonth(re),Te=L.format(re,"monthShort"),ue=L.format(re,"month"),we=le===J,xe=d||he(re);return i.jsx(TE,{selected:we,value:le,onClick:se,onKeyDown:K,autoFocus:z&&le===P,disabled:xe,tabIndex:le===P&&!xe?0:-1,onFocus:O,onBlur:D,"aria-current":oe===le?"date":void 0,"aria-label":ue,slots:E,slotProps:b,classes:o,children:Te},Te)})}))});function Qm(e){return Xt("MuiYearCalendar",e)}const Eo=er("MuiYearCalendar",["root","button","disabled","selected"]),FE=["autoFocus","classes","disabled","selected","value","onClick","onKeyDown","onFocus","onBlur","slots","slotProps"],jE=(e,r)=>{const t={button:["button",r.isYearDisabled&&"disabled",r.isYearSelected&&"selected"]};return Rt(t,Qm,e)},IE=Ge("button",{name:"MuiYearCalendar",slot:"Button",overridesResolver:(e,r)=>[r.button,{[`&.${Eo.disabled}`]:r.disabled},{[`&.${Eo.selected}`]:r.selected}]})(({theme:e})=>ie({color:"unset",backgroundColor:"transparent",border:0,outline:0},e.typography.subtitle1,{height:36,width:72,borderRadius:18,cursor:"pointer","&:focus":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.focusOpacity})`:Hs(e.palette.action.active,e.palette.action.focusOpacity)},"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:Hs(e.palette.action.active,e.palette.action.hoverOpacity)},"&:disabled":{cursor:"auto",pointerEvents:"none"},[`&.${Eo.disabled}`]:{color:(e.vars||e).palette.text.secondary},[`&.${Eo.selected}`]:{color:(e.vars||e).palette.primary.contrastText,backgroundColor:(e.vars||e).palette.primary.main,"&:focus, &:hover":{backgroundColor:(e.vars||e).palette.primary.dark}}})),PE=C.memo(function(r){const{autoFocus:t,classes:n,disabled:a,selected:s,value:o,onClick:c,onKeyDown:l,onFocus:u,onBlur:d,slots:f,slotProps:h}=r,x=Qe(r,FE),m=C.useRef(null),{ownerState:p}=dr(),g=ie({},p,{isYearDisabled:a,isYearSelected:s}),w=jE(n,g);Bn(()=>{var T;t&&((T=m.current)==null||T.focus())},[t]);const y=(f==null?void 0:f.yearButton)??IE,v=ht({elementType:y,externalSlotProps:h==null?void 0:h.yearButton,externalForwardedProps:x,additionalProps:{disabled:a,ref:m,type:"button",role:"radio","aria-checked":s,onClick:T=>c(T,o),onKeyDown:T=>l(T,o),onFocus:T=>u(T,o),onBlur:T=>d(T,o)},ownerState:g,className:w.button});return i.jsx(y,ie({},v))}),OE=["autoFocus","className","classes","value","defaultValue","referenceDate","disabled","disableFuture","disablePast","maxDate","minDate","onChange","readOnly","shouldDisableYear","disableHighlightToday","onYearFocus","hasFocus","onFocusedViewChange","yearsOrder","yearsPerRow","timezone","gridLabelId","slots","slotProps"],RE=e=>Rt({root:["root"]},Qm,e);function NE(e,r){const t=Dt({props:e,name:r}),n=oo(t);return ie({},t,n,{yearsPerRow:t.yearsPerRow??3,yearsOrder:t.yearsOrder??"asc"})}const ME=Ge("div",{name:"MuiYearCalendar",slot:"Root",shouldForwardProp:e=>to(e)&&e!=="yearsPerRow"})({display:"flex",flexWrap:"wrap",justifyContent:"space-evenly",rowGap:12,padding:"6px 0",overflowY:"auto",height:"100%",width:jc,maxHeight:Jw,boxSizing:"border-box",position:"relative",variants:[{props:{yearsPerRow:3},style:{columnGap:24}},{props:{yearsPerRow:4},style:{columnGap:0,padding:"0 2px"}}]}),LE=Ge("div",{name:"MuiYearCalendar",slot:"ButtonFiller"})({height:36,width:72}),BE=C.forwardRef(function(r,t){const n=NE(r,"MuiYearCalendar"),{autoFocus:a,className:s,classes:o,value:c,defaultValue:l,referenceDate:u,disabled:d,disableFuture:f,disablePast:h,maxDate:x,minDate:m,onChange:p,readOnly:g,shouldDisableYear:w,onYearFocus:y,hasFocus:v,onFocusedViewChange:T,yearsOrder:F,yearsPerRow:A,timezone:S,gridLabelId:E,slots:b,slotProps:k}=n,j=Qe(n,OE),{value:_,handleValueChange:B,timezone:Q}=so({name:"YearCalendar",timezone:S,value:c,defaultValue:l,referenceDate:u,onChange:p,valueManager:$n}),Z=Dc(Q),L=ra(),q=St(),{ownerState:te}=dr(),R=C.useMemo(()=>$n.getInitialReferenceValue({value:_,utils:q,props:n,timezone:Q,referenceDate:u,granularity:Pn.year}),[]),oe=RE(o),J=C.useMemo(()=>q.getYear(Z),[q,Z]),P=C.useMemo(()=>_!=null?q.getYear(_):null,[_,q]),[V,z]=C.useState(()=>P||q.getYear(R)),[G,ne]=Gs({name:"YearCalendar",state:"hasFocus",controlled:v,default:a??!1}),he=Ue(Oe=>{ne(Oe),T&&T(Oe)}),se=C.useCallback(Oe=>{if(h&&q.isBeforeYear(Oe,Z)||f&&q.isAfterYear(Oe,Z)||m&&q.isBeforeYear(Oe,m)||x&&q.isAfterYear(Oe,x))return!0;if(!w)return!1;const ze=q.startOfYear(Oe);return w(ze)},[f,h,x,m,Z,w,q]),ae=Ue((Oe,ze)=>{if(g)return;const M=q.setYear(_??R,ze);B(M)}),K=Ue(Oe=>{se(q.setYear(_??R,Oe))||(z(Oe),he(!0),y==null||y(Oe))});C.useEffect(()=>{z(Oe=>P!==null&&Oe!==P?P:Oe)},[P]);const O=F!=="desc"?A*1:A*-1,D=L&&F==="asc"||!L&&F==="desc"?-1:1,re=Ue((Oe,ze)=>{switch(Oe.key){case"ArrowUp":K(ze-O),Oe.preventDefault();break;case"ArrowDown":K(ze+O),Oe.preventDefault();break;case"ArrowLeft":K(ze-D),Oe.preventDefault();break;case"ArrowRight":K(ze+D),Oe.preventDefault();break}}),le=Ue((Oe,ze)=>{K(ze)}),Te=Ue((Oe,ze)=>{V===ze&&he(!1)}),ue=C.useRef(null),we=Ur(t,ue);C.useEffect(()=>{if(a||ue.current===null)return;const Oe=ue.current.querySelector('[tabindex="0"]');if(!Oe)return;const ze=Oe.offsetHeight,M=Oe.offsetTop,ce=ue.current.clientHeight,de=ue.current.scrollTop,Se=M+ze;ze>ce||M<de||(ue.current.scrollTop=Se-ce/2-ze/2)},[a]);const xe=q.getYearRange([m,x]);F==="desc"&&xe.reverse();let Ce=A-xe.length%A;return Ce===A&&(Ce=0),i.jsxs(ME,ie({ref:we,className:Qt(oe.root,s),ownerState:te,role:"radiogroup","aria-labelledby":E,yearsPerRow:A},j,{children:[xe.map(Oe=>{const ze=q.getYear(Oe),M=ze===P,ce=d||se(Oe);return i.jsx(PE,{selected:M,value:ze,onClick:ae,onKeyDown:re,autoFocus:G&&ze===V,disabled:ce,tabIndex:ze===V&&!ce?0:-1,onFocus:le,onBlur:Te,"aria-current":J===ze?"date":void 0,slots:b,slotProps:k,classes:o,children:q.format(Oe,"year")},q.format(Oe,"year"))}),Array.from({length:Ce},(Oe,ze)=>i.jsx(LE,{},ze))]}))}),$E=e=>Xt("MuiPickersCalendarHeader",e),UE=er("MuiPickersCalendarHeader",["root","labelContainer","label","switchViewButton","switchViewIcon"]),VE=["slots","slotProps","currentMonth","disabled","disableFuture","disablePast","maxDate","minDate","onMonthChange","onViewChange","view","reduceAnimations","views","labelId","className","classes","timezone","format"],WE=["ownerState"],HE=e=>Rt({root:["root"],labelContainer:["labelContainer"],label:["label"],switchViewButton:["switchViewButton"],switchViewIcon:["switchViewIcon"]},$E,e),zE=Ge("div",{name:"MuiPickersCalendarHeader",slot:"Root"})({display:"flex",alignItems:"center",marginTop:12,marginBottom:4,paddingLeft:24,paddingRight:12,maxHeight:40,minHeight:40}),GE=Ge("div",{name:"MuiPickersCalendarHeader",slot:"LabelContainer"})(({theme:e})=>ie({display:"flex",overflow:"hidden",alignItems:"center",cursor:"pointer",marginRight:"auto"},e.typography.body1,{fontWeight:e.typography.fontWeightMedium})),YE=Ge("div",{name:"MuiPickersCalendarHeader",slot:"Label"})({marginRight:6}),qE=Ge(Ze,{name:"MuiPickersCalendarHeader",slot:"SwitchViewButton"})({marginRight:"auto",variants:[{props:{view:"year"},style:{[`.${UE.switchViewIcon}`]:{transform:"rotate(180deg)"}}}]}),XE=Ge(Fw,{name:"MuiPickersCalendarHeader",slot:"SwitchViewIcon"})(({theme:e})=>({willChange:"transform",transition:e.transitions.create("transform"),transform:"rotate(0deg)"})),KE=C.forwardRef(function(r,t){const n=Aa(),a=St(),s=Dt({props:r,name:"MuiPickersCalendarHeader"}),{slots:o,slotProps:c,currentMonth:l,disabled:u,disableFuture:d,disablePast:f,maxDate:h,minDate:x,onMonthChange:m,onViewChange:p,view:g,reduceAnimations:w,views:y,labelId:v,className:T,classes:F,timezone:A,format:S=`${a.formats.month} ${a.formats.year}`}=s,E=Qe(s,VE),{ownerState:b}=dr(),k=HE(F),j=(o==null?void 0:o.switchViewButton)??qE,_=ht({elementType:j,externalSlotProps:c==null?void 0:c.switchViewButton,additionalProps:{size:"small","aria-label":n.calendarViewSwitchingButtonAriaLabel(g)},ownerState:b,className:k.switchViewButton}),B=(o==null?void 0:o.switchViewIcon)??XE,Q=ht({elementType:B,externalSlotProps:c==null?void 0:c.switchViewIcon,ownerState:b,className:k.switchViewIcon}),Z=Qe(Q,WE),L=()=>m(a.addMonths(l,1)),q=()=>m(a.addMonths(l,-1)),te=Xw(l,{disableFuture:d,maxDate:h,timezone:A}),R=Kw(l,{disablePast:f,minDate:x,timezone:A}),oe=()=>{if(!(y.length===1||!p||u))if(y.length===2)p(y.find(P=>P!==g)||y[0]);else{const P=y.indexOf(g)!==0?0:1;p(y[P])}};if(y.length===1&&y[0]==="year")return null;const J=a.formatByString(l,S);return i.jsxs(zE,ie({},E,{ownerState:b,className:Qt(k.root,T),ref:t,children:[i.jsxs(GE,{role:"presentation",onClick:oe,ownerState:b,"aria-live":"polite",className:k.labelContainer,children:[i.jsx(Xm,{reduceAnimations:w,transKey:J,children:i.jsx(YE,{id:v,ownerState:b,className:k.label,children:J})}),y.length>1&&!u&&i.jsx(j,ie({},_,{children:i.jsx(B,ie({},Z))}))]}),i.jsx(gc,{in:g==="day",appear:!w,enter:!w,children:i.jsx(Ww,{slots:o,slotProps:c,onGoToPrevious:q,isPreviousDisabled:R,previousLabel:n.previousMonth,onGoToNext:L,isNextDisabled:te,nextLabel:n.nextMonth})})]}))}),JE="@media (prefers-reduced-motion: reduce)",Ls=typeof navigator<"u"&&navigator.userAgent.match(/android\s(\d+)|OS\s(\d+)/i),h0=Ls&&Ls[1]?parseInt(Ls[1],10):null,p0=Ls&&Ls[2]?parseInt(Ls[2],10):null,QE=h0&&h0<10||p0&&p0<13||!1;function Zm(e){const r=bu(JE,{defaultMatches:!1});return e??(r||QE)}const ZE=e=>Xt("MuiDateCalendar",e);er("MuiDateCalendar",["root","viewTransitionContainer"]);const eT=["autoFocus","onViewChange","value","defaultValue","referenceDate","disableFuture","disablePast","onChange","onYearChange","onMonthChange","reduceAnimations","shouldDisableDate","shouldDisableMonth","shouldDisableYear","view","views","openTo","className","classes","disabled","readOnly","minDate","maxDate","disableHighlightToday","focusedView","onFocusedViewChange","showDaysOutsideCurrentMonth","fixedWeekNumber","dayOfWeekFormatter","slots","slotProps","loading","renderLoading","displayWeekNumber","yearsOrder","yearsPerRow","monthsPerRow","timezone"],tT=e=>Rt({root:["root"],viewTransitionContainer:["viewTransitionContainer"]},ZE,e);function rT(e,r){const t=Dt({props:e,name:r}),n=Zm(t.reduceAnimations),a=oo(t);return ie({},t,a,{loading:t.loading??!1,openTo:t.openTo??"day",views:t.views??["year","day"],reduceAnimations:n,renderLoading:t.renderLoading??(()=>i.jsx("span",{children:"..."}))})}const nT=Ge(Qw,{name:"MuiDateCalendar",slot:"Root"})({display:"flex",flexDirection:"column",height:Ru}),aT=Ge(Xm,{name:"MuiDateCalendar",slot:"ViewTransitionContainer"})({}),sT=C.forwardRef(function(r,t){const n=St(),{ownerState:a}=dr(),s=_c(),o=rT(r,"MuiDateCalendar"),{autoFocus:c,onViewChange:l,value:u,defaultValue:d,referenceDate:f,disableFuture:h,disablePast:x,onChange:m,onMonthChange:p,reduceAnimations:g,shouldDisableDate:w,shouldDisableMonth:y,shouldDisableYear:v,view:T,views:F,openTo:A,className:S,classes:E,disabled:b,readOnly:k,minDate:j,maxDate:_,disableHighlightToday:B,focusedView:Q,onFocusedViewChange:Z,showDaysOutsideCurrentMonth:L,fixedWeekNumber:q,dayOfWeekFormatter:te,slots:R,slotProps:oe,loading:J,renderLoading:P,displayWeekNumber:V,yearsOrder:z,yearsPerRow:G,monthsPerRow:ne,timezone:he}=o,se=Qe(o,eT),{value:ae,handleValueChange:K,timezone:O}=so({name:"DateCalendar",timezone:he,value:u,defaultValue:d,referenceDate:f,onChange:m,valueManager:$n}),{view:D,setView:re,focusedView:le,setFocusedView:Te,goToNextView:ue,setValueAndGoToNextView:we}=bm({view:T,views:F,openTo:A,onChange:K,onViewChange:l,autoFocus:c,focusedView:Q,onFocusedViewChange:Z}),{referenceDate:xe,calendarState:Ce,setVisibleDate:Oe,isDateDisabled:ze,onMonthSwitchingAnimationEnd:M}=KS({value:ae,referenceDate:f,reduceAnimations:g,onMonthChange:p,minDate:j,maxDate:_,shouldDisableDate:w,disablePast:x,disableFuture:h,timezone:O,getCurrentMonthFromVisibleDate:(it,Nt)=>n.isSameMonth(it,Nt)?Nt:n.startOfMonth(it)}),ce=b&&ae||j,de=b&&ae||_,Se=`${s}-grid-label`,ke=le!==null,Be=(R==null?void 0:R.calendarHeader)??KE,Ve=ht({elementType:Be,externalSlotProps:oe==null?void 0:oe.calendarHeader,additionalProps:{views:F,view:D,currentMonth:Ce.currentMonth,onViewChange:re,onMonthChange:it=>Oe({target:it,reason:"header-navigation"}),minDate:ce,maxDate:de,disabled:b,disablePast:x,disableFuture:h,reduceAnimations:g,timezone:O,labelId:Se},ownerState:a}),Fe=Ue(it=>{const Nt=n.startOfMonth(it),tr=n.endOfMonth(it),Ir=ze(it)?Vi({utils:n,date:it,minDate:n.isBefore(j,Nt)?Nt:j,maxDate:n.isAfter(_,tr)?tr:_,disablePast:x,disableFuture:h,isDateDisabled:ze,timezone:O}):it;Ir?(we(Ir,"finish"),Oe({target:Ir,reason:"cell-interaction"})):(ue(),Oe({target:Nt,reason:"cell-interaction"}))}),Ie=Ue(it=>{const Nt=n.startOfYear(it),tr=n.endOfYear(it),Ir=ze(it)?Vi({utils:n,date:it,minDate:n.isBefore(j,Nt)?Nt:j,maxDate:n.isAfter(_,tr)?tr:_,disablePast:x,disableFuture:h,isDateDisabled:ze,timezone:O}):it;Ir?(we(Ir,"finish"),Oe({target:Ir,reason:"cell-interaction"})):(ue(),Oe({target:Nt,reason:"cell-interaction"}))}),We=Ue(it=>K(it&&Qo(n,it,ae??xe),"finish",D));C.useEffect(()=>{n.isValid(ae)&&Oe({target:ae,reason:"controlled-value-change"})},[ae]);const qe=tT(E),tt={disablePast:x,disableFuture:h,maxDate:_,minDate:j},ut={disableHighlightToday:B,readOnly:k,disabled:b,timezone:O,gridLabelId:Se,slots:R,slotProps:oe},or=C.useRef(D);C.useEffect(()=>{or.current!==D&&(le===or.current&&Te(D,!0),or.current=D)},[le,Te,D]);const Ht=C.useMemo(()=>[ae],[ae]);return i.jsxs(nT,ie({ref:t,className:Qt(qe.root,S),ownerState:a},se,{children:[i.jsx(Be,ie({},Ve,{slots:R,slotProps:oe})),i.jsx(aT,{reduceAnimations:g,className:qe.viewTransitionContainer,transKey:D,ownerState:a,children:i.jsxs("div",{children:[D==="year"&&i.jsx(BE,ie({},tt,ut,{value:ae,onChange:Ie,shouldDisableYear:v,hasFocus:ke,onFocusedViewChange:it=>Te("year",it),yearsOrder:z,yearsPerRow:G,referenceDate:xe})),D==="month"&&i.jsx(DE,ie({},tt,ut,{hasFocus:ke,className:S,value:ae,onChange:Fe,shouldDisableMonth:y,onFocusedViewChange:it=>Te("month",it),monthsPerRow:ne,referenceDate:xe})),D==="day"&&i.jsx(bE,ie({},Ce,tt,ut,{onMonthSwitchingAnimationEnd:M,hasFocus:ke,onFocusedDayChange:it=>Oe({target:it,reason:"cell-interaction"}),reduceAnimations:g,selectedDays:Ht,onSelectedDaysChange:We,shouldDisableDate:w,shouldDisableMonth:y,shouldDisableYear:v,onFocusedViewChange:it=>Te("day",it),showDaysOutsideCurrentMonth:L,fixedWeekNumber:q,dayOfWeekFormatter:te,displayWeekNumber:V,loading:J,renderLoading:P}))]})})]}))});function iT(e){return Xt("MuiPickersToolbar",e)}er("MuiPickersToolbar",["root","title","content"]);function ex(){const{ownerState:e}=dr(),r=ra();return C.useMemo(()=>ie({},e,{toolbarDirection:r?"rtl":"ltr"}),[e,r])}const oT=["children","className","classes","toolbarTitle","hidden","titleId","classes","landscapeDirection"],cT=e=>Rt({root:["root"],title:["title"],content:["content"]},iT,e),lT=Ge("div",{name:"MuiPickersToolbar",slot:"Root"})(({theme:e})=>({display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"space-between",padding:e.spacing(2,3),variants:[{props:{pickerOrientation:"landscape"},style:{height:"auto",maxWidth:160,padding:16,justifyContent:"flex-start",flexWrap:"wrap"}}]})),uT=Ge("div",{name:"MuiPickersToolbar",slot:"Content",shouldForwardProp:e=>to(e)&&e!=="landscapeDirection"})({display:"flex",flexWrap:"wrap",width:"100%",flex:1,justifyContent:"space-between",alignItems:"center",flexDirection:"row",variants:[{props:{pickerOrientation:"landscape"},style:{justifyContent:"flex-start",alignItems:"flex-start",flexDirection:"column"}},{props:{pickerOrientation:"landscape",landscapeDirection:"row"},style:{flexDirection:"row"}}]}),dT=C.forwardRef(function(r,t){const n=Dt({props:r,name:"MuiPickersToolbar"}),{children:a,className:s,classes:o,toolbarTitle:c,hidden:l,titleId:u,landscapeDirection:d}=n,f=Qe(n,oT),h=ex(),x=cT(o);return l?null:i.jsxs(lT,ie({ref:t,className:Qt(x.root,s),ownerState:h},f,{children:[i.jsx(ee,{color:"text.secondary",variant:"overline",id:u,className:x.title,children:c}),i.jsx(uT,{className:x.content,ownerState:h,landscapeDirection:d,children:a})]}))});function fT(e){return Xt("MuiDatePickerToolbar",e)}er("MuiDatePickerToolbar",["root","title"]);const hT=["toolbarFormat","toolbarPlaceholder","className","classes"],pT=e=>Rt({root:["root"],title:["title"]},fT,e),mT=Ge(dT,{name:"MuiDatePickerToolbar",slot:"Root"})({}),xT=Ge(ee,{name:"MuiDatePickerToolbar",slot:"Title"})({variants:[{props:{pickerOrientation:"landscape"},style:{margin:"auto 16px auto auto"}}]}),gT=C.forwardRef(function(r,t){const n=Dt({props:r,name:"MuiDatePickerToolbar"}),{toolbarFormat:a,toolbarPlaceholder:s="––",className:o,classes:c}=n,l=Qe(n,hT),u=St(),{value:d,views:f,orientation:h}=ti(),x=Aa(),m=ex(),p=pT(c),g=C.useMemo(()=>{if(!u.isValid(d))return s;const w=Mu(u,{format:a,views:f},!0);return u.formatByString(d,w)},[d,a,s,u,f]);return i.jsx(mT,ie({ref:t,toolbarTitle:x.datePickerToolbarTitle,className:Qt(p.root,o)},l,{children:i.jsx(xT,{variant:"h4",align:h==="landscape"?"left":"center",ownerState:m,className:p.title,children:g})}))});function tx(e,r){const t=Dt({props:e,name:r}),n=oo(t),a=C.useMemo(()=>{var s;return((s=t.localeText)==null?void 0:s.toolbarTitle)==null?t.localeText:ie({},t.localeText,{datePickerToolbarTitle:t.localeText.toolbarTitle})},[t.localeText]);return ie({},t,n,{localeText:a},Hw({views:t.views,openTo:t.openTo,defaultViews:["year","day"],defaultOpenTo:"day"}),{slots:ie({toolbar:gT},t.slots)})}function yT(e){return Xt("MuiPickerPopper",e)}er("MuiPickerPopper",["root","paper"]);const vT=["PaperComponent","ownerState","children","paperSlotProps","paperClasses","onPaperClick","onPaperTouchStart"],bT=e=>Rt({root:["root"],paper:["paper"]},yT,e),wT=Ge(Ry,{name:"MuiPickerPopper",slot:"Root"})(({theme:e})=>({zIndex:e.zIndex.modal})),ST=Ge(Ke,{name:"MuiPickerPopper",slot:"Paper"})({outline:0,transformOrigin:"top center",variants:[{props:({popperPlacement:e})=>["top","top-start","top-end"].includes(e),style:{transformOrigin:"bottom center"}}]});function ET(e,r){return r.documentElement.clientWidth<e.clientX||r.documentElement.clientHeight<e.clientY}function TT(e,r){const t=C.useRef(!1),n=C.useRef(!1),a=C.useRef(null),s=C.useRef(!1);C.useEffect(()=>{if(!e)return;function l(){s.current=!0}return document.addEventListener("mousedown",l,!0),document.addEventListener("touchstart",l,!0),()=>{document.removeEventListener("mousedown",l,!0),document.removeEventListener("touchstart",l,!0),s.current=!1}},[e]);const o=Ue(l=>{if(!s.current)return;const u=n.current;n.current=!1;const d=ll(a.current);if(!a.current||"clientX"in l&&ET(l,d))return;if(t.current){t.current=!1;return}let f;l.composedPath?f=l.composedPath().indexOf(a.current)>-1:f=!d.documentElement.contains(l.target)||a.current.contains(l.target),!f&&!u&&r(l)}),c=()=>{n.current=!0};return C.useEffect(()=>{if(e){const l=ll(a.current),u=()=>{t.current=!0};return l.addEventListener("touchstart",o),l.addEventListener("touchmove",u),()=>{l.removeEventListener("touchstart",o),l.removeEventListener("touchmove",u)}}},[e,o]),C.useEffect(()=>{if(e){const l=ll(a.current);return l.addEventListener("click",o),()=>{l.removeEventListener("click",o),n.current=!1}}},[e,o]),[a,c,c]}const AT=C.forwardRef((e,r)=>{const{PaperComponent:t,ownerState:n,children:a,paperSlotProps:s,paperClasses:o,onPaperClick:c,onPaperTouchStart:l}=e,u=Qe(e,vT),d=ht({elementType:t,externalSlotProps:s,additionalProps:{tabIndex:-1,elevation:8,ref:r},className:o,ownerState:n});return i.jsx(t,ie({},u,d,{onClick:f=>{var h;c(f),(h=d.onClick)==null||h.call(d,f)},onTouchStart:f=>{var h;l(f),(h=d.onTouchStart)==null||h.call(d,f)},ownerState:n,children:a}))});function kT(e){const r=Dt({props:e,name:"MuiPickerPopper"}),{children:t,placement:n="bottom-start",slots:a,slotProps:s,classes:o}=r,{open:c,popupRef:l,reduceAnimations:u}=ti(),{dismissViews:d,getCurrentViewMode:f,onPopperExited:h,triggerElement:x,viewContainerRole:m}=dr();C.useEffect(()=>{function q(te){c&&te.key==="Escape"&&d()}return document.addEventListener("keydown",q),()=>{document.removeEventListener("keydown",q)}},[d,c]);const p=C.useRef(null);C.useEffect(()=>{m==="tooltip"||f()==="field"||(c?p.current=xr(document):p.current&&p.current instanceof HTMLElement&&setTimeout(()=>{p.current instanceof HTMLElement&&p.current.focus()}))},[c,m,f]);const g=bT(o),{ownerState:w,rootRefObject:y}=dr(),v=ie({},w,{popperPlacement:n}),T=Ue(()=>{m==="tooltip"?y2(()=>{var q,te;(q=y.current)!=null&&q.contains(xr(document))||(te=l.current)!=null&&te.contains(xr(document))||d()}):d()}),[F,A,S]=TT(c,T),E=C.useRef(null),b=Ur(E,l),k=Ur(b,F),j=q=>{q.key==="Escape"&&(q.stopPropagation(),d())},_=(a==null?void 0:a.desktopTransition)??u?gc:Ny,B=(a==null?void 0:a.desktopTrapFocus)??My,Q=(a==null?void 0:a.desktopPaper)??ST,Z=(a==null?void 0:a.popper)??wT,L=ht({elementType:Z,externalSlotProps:s==null?void 0:s.popper,additionalProps:{transition:!0,role:m??void 0,open:c,placement:n,anchorEl:x,onKeyDown:j},className:g.root,ownerState:v});return i.jsx(Z,ie({},L,{children:({TransitionProps:q})=>i.jsx(B,ie({open:c,disableAutoFocus:!0,disableRestoreFocus:!0,disableEnforceFocus:m==="tooltip",isEnabled:()=>!0},s==null?void 0:s.desktopTrapFocus,{children:i.jsx(_,ie({},q,s==null?void 0:s.desktopTransition,{onExited:te=>{var R,oe,J;h==null||h(),(oe=(R=s==null?void 0:s.desktopTransition)==null?void 0:R.onExited)==null||oe.call(R,te),(J=q==null?void 0:q.onExited)==null||J.call(q)},children:i.jsx(AT,{PaperComponent:Q,ownerState:v,ref:k,onPaperClick:A,onPaperTouchStart:S,paperClasses:g.paper,paperSlotProps:s==null?void 0:s.desktopPaper,children:t})}))}))}))}function m0(){return typeof window>"u"?"portrait":window.screen&&window.screen.orientation&&window.screen.orientation.angle?Math.abs(window.screen.orientation.angle)===90?"landscape":"portrait":window.orientation&&Math.abs(Number(window.orientation))===90?"landscape":"portrait"}function CT(e,r){const[t,n]=C.useState(m0);return Bn(()=>{const a=()=>{n(m0())};return window.addEventListener("orientationchange",a),()=>{window.removeEventListener("orientationchange",a)}},[]),g2(e,["hours","minutes","seconds"])?"portrait":r??t}function _T(e){const{props:r,valueManager:t,validator:n}=e,{value:a,defaultValue:s,onChange:o,referenceDate:c,timezone:l,onAccept:u,closeOnSelect:d,open:f,onOpen:h,onClose:x}=r,{current:m}=C.useRef(s),{current:p}=C.useRef(a!==void 0),{current:g}=C.useRef(f!==void 0),w=St(),{timezone:y,value:v,handleValueChange:T}=so({name:"a picker component",timezone:l,value:a,defaultValue:m,referenceDate:c,onChange:o,valueManager:t}),[F,A]=C.useState(()=>({open:!1,lastExternalValue:v,clockShallowValue:void 0,lastCommittedValue:v,hasBeenModifiedSinceMount:!1})),{getValidationErrorForNewValue:S}=Pm({props:r,validator:n,timezone:y,value:v,onError:r.onError}),E=Ue(_=>{const B=typeof _=="function"?_(F.open):_;g||A(Q=>ie({},Q,{open:B})),B&&h&&h(),B||x==null||x()}),b=Ue((_,B)=>{const{changeImportance:Q="accept",skipPublicationIfPristine:Z=!1,validationError:L,shortcut:q,shouldClose:te=Q==="accept"}=B??{};let R,oe;!Z&&!p&&!F.hasBeenModifiedSinceMount?(R=!0,oe=Q==="accept"):(R=!t.areValuesEqual(w,_,v),oe=Q==="accept"&&!t.areValuesEqual(w,_,F.lastCommittedValue)),A(V=>ie({},V,{clockShallowValue:R?void 0:V.clockShallowValue,lastCommittedValue:oe?v:V.lastCommittedValue,hasBeenModifiedSinceMount:!0}));let J=null;const P=()=>(J||(J={validationError:L??S(_)},q&&(J.shortcut=q)),J);R&&T(_,P()),oe&&u&&u(_,P()),te&&E(!1)});v!==F.lastExternalValue&&A(_=>ie({},_,{lastExternalValue:v,clockShallowValue:void 0,hasBeenModifiedSinceMount:!0}));const k=Ue((_,B="partial")=>{if(B==="shallow"){A(Q=>ie({},Q,{clockShallowValue:_,hasBeenModifiedSinceMount:!0}));return}b(_,{changeImportance:B==="finish"&&d?"accept":"set"})});C.useEffect(()=>{if(g){if(f===void 0)throw new Error("You must not mix controlling and uncontrolled mode for `open` prop");A(_=>ie({},_,{open:f}))}},[g,f]);const j=C.useMemo(()=>t.cleanValue(w,F.clockShallowValue===void 0?v:F.clockShallowValue),[w,t,F.clockShallowValue,v]);return{timezone:y,state:F,setValue:b,setValueFromView:k,setOpen:E,value:v,viewValue:j}}const DT=["className","sx"],rx=({ref:e,props:r,valueManager:t,valueType:n,variant:a,validator:s,onPopperExited:o,autoFocusView:c,rendererInterceptor:l,localeText:u,viewContainerRole:d,getStepNavigation:f})=>{const{views:h,view:x,openTo:m,onViewChange:p,viewRenderers:g,reduceAnimations:w,orientation:y,disableOpenPicker:v,closeOnSelect:T,disabled:F,readOnly:A,formatDensity:S,enableAccessibleFieldDOMStructure:E,selectedSections:b,onSelectedSectionsChange:k,format:j,label:_,autoFocus:B,name:Q}=r,{className:Z,sx:L}=r,q=Qe(r,DT),te=_c(),R=St(),oe=ls(),J=Zm(w),P=CT(h,y),{current:V}=C.useRef(m??null),[z,G]=C.useState(null),ne=C.useRef(null),he=C.useRef(null),se=C.useRef(null),ae=Ur(e,se),{timezone:K,state:O,setOpen:D,setValue:re,setValueFromView:le,value:Te,viewValue:ue}=_T({props:r,valueManager:t,validator:s}),{view:we,setView:xe,defaultView:Ce,focusedView:Oe,setFocusedView:ze,setValueAndGoToNextView:M,goToNextStep:ce,hasNextStep:de,hasSeveralSteps:Se}=bm({view:x,views:h,openTo:m,onChange:le,onViewChange:p,autoFocus:c,getStepNavigation:f}),ke=Ue(()=>re(t.emptyValue)),Be=Ue(()=>re(t.getTodayValue(R,K,n))),Ve=Ue(()=>re(Te)),Fe=Ue(()=>re(O.lastCommittedValue,{skipPublicationIfPristine:!0})),Ie=Ue(()=>{re(Te,{skipPublicationIfPristine:!0})}),{hasUIView:We,viewModeLookup:qe,timeViewsCount:tt}=C.useMemo(()=>h.reduce((jt,Vr)=>{const vo=g[Vr]==null?"field":"UI";return jt.viewModeLookup[Vr]=vo,vo==="UI"&&(jt.hasUIView=!0,Gw(Vr)&&(jt.timeViewsCount+=1)),jt},{hasUIView:!1,viewModeLookup:{},timeViewsCount:0}),[g,h]),ut=qe[we],or=Ue(()=>ut),[Ht,it]=C.useState(ut==="UI"?we:null);Ht!==we&&qe[we]==="UI"&&it(we),Bn(()=>{ut==="field"&&O.open&&(D(!1),setTimeout(()=>{var jt,Vr;(jt=he==null?void 0:he.current)==null||jt.setSelectedSections(we),(Vr=he==null?void 0:he.current)==null||Vr.focusField(we)}))},[we]),Bn(()=>{if(!O.open)return;let jt=we;ut==="field"&&Ht!=null&&(jt=Ht),jt!==Ce&&qe[jt]==="UI"&&qe[Ce]==="UI"&&(jt=Ce),jt!==we&&xe(jt),ze(jt,!0)},[O.open]);const Nt=C.useMemo(()=>({isPickerValueEmpty:t.areValuesEqual(R,Te,t.emptyValue),isPickerOpen:O.open,isPickerDisabled:r.disabled??!1,isPickerReadOnly:r.readOnly??!1,pickerOrientation:P,pickerVariant:a}),[R,t,Te,O.open,P,a,r.disabled,r.readOnly]),tr=C.useMemo(()=>v||!We?"hidden":F||A?"disabled":"enabled",[v,We,F,A]),Ir=Ue(ce),Es=C.useMemo(()=>T&&!Se?[]:["cancel","nextOrAccept"],[T,Se]),Pr=C.useMemo(()=>({setValue:re,setOpen:D,clearValue:ke,setValueToToday:Be,acceptValueChanges:Ve,cancelValueChanges:Fe,setView:xe,goToNextStep:Ir}),[re,D,ke,Be,Ve,Fe,xe,Ir]),Ts=C.useMemo(()=>ie({},Pr,{value:Te,timezone:K,open:O.open,views:h,view:Ht,initialView:V,disabled:F??!1,readOnly:A??!1,autoFocus:B??!1,variant:a,orientation:P,popupRef:ne,reduceAnimations:J,triggerRef:G,triggerStatus:tr,hasNextStep:de,fieldFormat:j??"",name:Q,label:_,rootSx:L,rootRef:ae,rootClassName:Z}),[Pr,Te,ae,a,P,J,F,A,j,Z,Q,_,L,tr,de,K,O.open,Ht,h,V,B]),Qc=C.useMemo(()=>({dismissViews:Ie,ownerState:Nt,hasUIView:We,getCurrentViewMode:or,rootRefObject:se,labelId:te,triggerElement:z,viewContainerRole:d,defaultActionBarActions:Es,onPopperExited:o}),[Ie,Nt,We,or,te,z,d,Es,o]),Zc=C.useMemo(()=>({formatDensity:S,enableAccessibleFieldDOMStructure:E,selectedSections:b,onSelectedSectionsChange:k,fieldRef:he}),[S,E,b,k,he]);return{providerProps:{localeText:u,contextValue:Ts,privateContextValue:Qc,actionsContextValue:Pr,fieldPrivateContextValue:Zc,isValidContextValue:jt=>{const Vr=s({adapter:oe,value:jt,timezone:K,props:r});return!t.hasError(Vr)}},renderCurrentView:()=>{if(Ht==null)return null;const jt=g[Ht];if(jt==null)return null;const Vr=ie({},q,{views:h,timezone:K,value:ue,onChange:M,view:Ht,onViewChange:xe,showViewSwitcher:tt>1,timeViewsCount:tt},d==="tooltip"?{focusedView:null,onFocusedViewChange:()=>{}}:{focusedView:Oe,onFocusedViewChange:ze});return l?i.jsx(l,{viewRenderers:g,popperView:Ht,rendererProps:Vr}):jt(Vr)},ownerState:Nt}};function nx(e){return Xt("MuiPickersLayout",e)}const Pa=er("MuiPickersLayout",["root","landscape","contentWrapper","toolbar","actionBar","tabs","shortcuts"]),FT=["actions"],jT=Ge(_r,{name:"MuiPickersLayout",slot:"ActionBar"})({});function IT(e){const{actions:r}=e,t=Qe(e,FT),n=Aa(),{clearValue:a,setValueToToday:s,acceptValueChanges:o,cancelValueChanges:c,goToNextStep:l,hasNextStep:u}=ti();if(r==null||r.length===0)return null;const d=r==null?void 0:r.map(f=>{switch(f){case"clear":return i.jsx(Pe,{onClick:a,children:n.clearButtonLabel},f);case"cancel":return i.jsx(Pe,{onClick:c,children:n.cancelButtonLabel},f);case"accept":return i.jsx(Pe,{onClick:o,children:n.okButtonLabel},f);case"today":return i.jsx(Pe,{onClick:s,children:n.todayButtonLabel},f);case"next":return i.jsx(Pe,{onClick:l,children:n.nextStepButtonLabel},f);case"nextOrAccept":return u?i.jsx(Pe,{onClick:l,children:n.nextStepButtonLabel},f):i.jsx(Pe,{onClick:o,children:n.okButtonLabel},f);default:return null}});return i.jsx(jT,ie({},t,{children:d}))}const PT=C.memo(IT),OT=["items","changeImportance"],RT=["getValue"],NT=Ge(qa,{name:"MuiPickersLayout",slot:"Shortcuts"})({});function MT(e){const{items:r,changeImportance:t="accept"}=e,n=Qe(e,OT),{setValue:a}=R2(),s=Nw();if(r==null||r.length===0)return null;const o=r.map(c=>{let{getValue:l}=c,u=Qe(c,RT);const d=l({isValid:s});return ie({},u,{label:u.label,onClick:()=>{a(d,{changeImportance:t,shortcut:u})},disabled:!s(d)})});return i.jsx(NT,ie({dense:!0,sx:[{maxHeight:Ru,maxWidth:200,overflow:"auto"},...Array.isArray(n.sx)?n.sx:[n.sx]]},n,{children:o.map(c=>i.jsx(Xa,{children:i.jsx($t,ie({},c))},c.id??c.label))}))}const LT=["ownerState"];function BT(e){return e.view!==null}const $T=(e,r)=>{const{pickerOrientation:t}=r;return Rt({root:["root",t==="landscape"&&"landscape"],contentWrapper:["contentWrapper"],toolbar:["toolbar"],actionBar:["actionBar"],tabs:["tabs"],landscape:["landscape"],shortcuts:["shortcuts"]},nx,e)},UT=e=>{const{ownerState:r,defaultActionBarActions:t}=dr(),{view:n}=ti(),a=ra(),{children:s,slots:o,slotProps:c,classes:l}=e,u=C.useMemo(()=>ie({},r,{layoutDirection:a?"rtl":"ltr"}),[r,a]),d=$T(l,u),f=(o==null?void 0:o.actionBar)??PT,h=ht({elementType:f,externalSlotProps:c==null?void 0:c.actionBar,additionalProps:{actions:t},className:d.actionBar,ownerState:u}),x=Qe(h,LT),m=i.jsx(f,ie({},x)),p=o==null?void 0:o.toolbar,g=ht({elementType:p,externalSlotProps:c==null?void 0:c.toolbar,className:d.toolbar,ownerState:u}),w=BT(g)&&p?i.jsx(p,ie({},g)):null,y=s,v=o==null?void 0:o.tabs,T=n&&v?i.jsx(v,ie({className:d.tabs},c==null?void 0:c.tabs)):null,F=(o==null?void 0:o.shortcuts)??MT,A=ht({elementType:F,externalSlotProps:c==null?void 0:c.shortcuts,className:d.shortcuts,ownerState:u}),S=n&&F?i.jsx(F,ie({},A)):null;return{toolbar:w,content:y,tabs:T,actionBar:m,shortcuts:S,ownerState:u}},VT=UT,WT=(e,r)=>{const{pickerOrientation:t}=r;return Rt({root:["root",t==="landscape"&&"landscape"],contentWrapper:["contentWrapper"]},nx,e)},HT=Ge("div",{name:"MuiPickersLayout",slot:"Root"})({display:"grid",gridAutoColumns:"max-content auto max-content",gridAutoRows:"max-content auto max-content",[`& .${Pa.actionBar}`]:{gridColumn:"1 / 4",gridRow:3},variants:[{props:{pickerOrientation:"landscape"},style:{[`& .${Pa.toolbar}`]:{gridColumn:1,gridRow:"2 / 3"},[`.${Pa.shortcuts}`]:{gridColumn:"2 / 4",gridRow:1}}},{props:{pickerOrientation:"landscape",layoutDirection:"rtl"},style:{[`& .${Pa.toolbar}`]:{gridColumn:3}}},{props:{pickerOrientation:"portrait"},style:{[`& .${Pa.toolbar}`]:{gridColumn:"2 / 4",gridRow:1},[`& .${Pa.shortcuts}`]:{gridColumn:1,gridRow:"2 / 3"}}},{props:{pickerOrientation:"portrait",layoutDirection:"rtl"},style:{[`& .${Pa.shortcuts}`]:{gridColumn:3}}}]}),zT=Ge("div",{name:"MuiPickersLayout",slot:"ContentWrapper"})({gridColumn:"2 / 4",gridRow:2,display:"flex",flexDirection:"column"}),ax=C.forwardRef(function(r,t){const n=Dt({props:r,name:"MuiPickersLayout"}),{toolbar:a,content:s,tabs:o,actionBar:c,shortcuts:l,ownerState:u}=VT(n),{orientation:d,variant:f}=ti(),{sx:h,className:x,classes:m}=n,p=WT(m,u);return i.jsxs(HT,{ref:t,sx:h,className:Qt(p.root,x),ownerState:u,children:[d==="landscape"?l:a,d==="landscape"?a:l,i.jsx(zT,{className:p.contentWrapper,ownerState:u,children:f==="desktop"?i.jsxs(C.Fragment,{children:[s,o]}):i.jsxs(C.Fragment,{children:[o,s]})}),c]})});function sx(e){const{steps:r}=e;return qw({steps:r,isViewMatchingStep:(t,n)=>n.views==null||n.views.includes(t),onStepChange:({step:t,defaultView:n,setView:a,view:s,views:o})=>{const c=t.views==null?n:t.views.find(l=>o.includes(l));c!==s&&a(c)}})}const GT=["props","steps"],YT=["ownerState"],qT=e=>{var A;let{props:r,steps:t}=e,n=Qe(e,GT);const{slots:a,slotProps:s,label:o,inputRef:c,localeText:l}=r,u=sx({steps:t}),{providerProps:d,renderCurrentView:f,ownerState:h}=rx(ie({},n,{props:r,localeText:l,autoFocusView:!0,viewContainerRole:"dialog",variant:"desktop",getStepNavigation:u})),x=d.privateContextValue.labelId,m=((A=s==null?void 0:s.toolbar)==null?void 0:A.hidden)??!1,p=a.field,g=ht({elementType:p,externalSlotProps:s==null?void 0:s.field,additionalProps:ie({},m&&{id:x}),ownerState:h}),w=Qe(g,YT),y=a.layout??ax;let v=x;m&&(o?v=`${x}-label`:v=void 0);const T=ie({},s,{toolbar:ie({},s==null?void 0:s.toolbar,{titleId:x}),popper:ie({"aria-labelledby":v},s==null?void 0:s.popper)});return{renderPicker:()=>i.jsx(ym,ie({},d,{children:i.jsxs(Gm,{slots:a,slotProps:T,inputRef:c,children:[i.jsx(p,ie({},w)),i.jsx(kT,{slots:a,slotProps:T,children:i.jsx(y,ie({},T==null?void 0:T.layout,{slots:a,slotProps:T,children:f()}))})]})}))}},Bs=({view:e,onViewChange:r,views:t,focusedView:n,onFocusedViewChange:a,value:s,defaultValue:o,referenceDate:c,onChange:l,className:u,classes:d,disableFuture:f,disablePast:h,minDate:x,maxDate:m,shouldDisableDate:p,shouldDisableMonth:g,shouldDisableYear:w,reduceAnimations:y,onMonthChange:v,monthsPerRow:T,onYearChange:F,yearsOrder:A,yearsPerRow:S,slots:E,slotProps:b,loading:k,renderLoading:j,disableHighlightToday:_,readOnly:B,disabled:Q,showDaysOutsideCurrentMonth:Z,dayOfWeekFormatter:L,sx:q,autoFocus:te,fixedWeekNumber:R,displayWeekNumber:oe,timezone:J})=>i.jsx(sT,{view:e,onViewChange:r,views:t.filter(t0),focusedView:n&&t0(n)?n:null,onFocusedViewChange:a,value:s,defaultValue:o,referenceDate:c,onChange:l,className:u,classes:d,disableFuture:f,disablePast:h,minDate:x,maxDate:m,shouldDisableDate:p,shouldDisableMonth:g,shouldDisableYear:w,reduceAnimations:y,onMonthChange:v,monthsPerRow:T,onYearChange:F,yearsOrder:A,yearsPerRow:S,slots:E,slotProps:b,loading:k,renderLoading:j,disableHighlightToday:_,readOnly:B,disabled:Q,showDaysOutsideCurrentMonth:Z,dayOfWeekFormatter:L,sx:q,autoFocus:te,fixedWeekNumber:R,displayWeekNumber:oe,timezone:J}),ix=C.forwardRef(function(r,t){var l;const n=St(),a=tx(r,"MuiDesktopDatePicker"),s=ie({day:Bs,month:Bs,year:Bs},a.viewRenderers),o=ie({},a,{closeOnSelect:a.closeOnSelect??!0,viewRenderers:s,format:Mu(n,a,!1),yearsPerRow:a.yearsPerRow??4,slots:ie({field:Ym},a.slots),slotProps:ie({},a.slotProps,{field:u=>{var d;return ie({},$i((d=a.slotProps)==null?void 0:d.field,u),Fm(a))},toolbar:ie({hidden:!0},(l=a.slotProps)==null?void 0:l.toolbar)})}),{renderPicker:c}=qT({ref:t,props:o,valueManager:$n,valueType:"date",validator:io,steps:null});return c()});ix.propTypes={autoFocus:be.bool,className:be.string,closeOnSelect:be.bool,dayOfWeekFormatter:be.func,defaultValue:be.object,disabled:be.bool,disableFuture:be.bool,disableHighlightToday:be.bool,disableOpenPicker:be.bool,disablePast:be.bool,displayWeekNumber:be.bool,enableAccessibleFieldDOMStructure:be.any,fixedWeekNumber:be.number,format:be.string,formatDensity:be.oneOf(["dense","spacious"]),inputRef:um,label:be.node,loading:be.bool,localeText:be.object,maxDate:be.object,minDate:be.object,monthsPerRow:be.oneOf([3,4]),name:be.string,onAccept:be.func,onChange:be.func,onClose:be.func,onError:be.func,onMonthChange:be.func,onOpen:be.func,onSelectedSectionsChange:be.func,onViewChange:be.func,onYearChange:be.func,open:be.bool,openTo:be.oneOf(["day","month","year"]),orientation:be.oneOf(["landscape","portrait"]),readOnly:be.bool,reduceAnimations:be.bool,referenceDate:be.object,renderLoading:be.func,selectedSections:be.oneOfType([be.oneOf(["all","day","empty","hours","meridiem","minutes","month","seconds","weekDay","year"]),be.number]),shouldDisableDate:be.func,shouldDisableMonth:be.func,shouldDisableYear:be.func,showDaysOutsideCurrentMonth:be.bool,slotProps:be.object,slots:be.object,sx:be.oneOfType([be.arrayOf(be.oneOfType([be.func,be.object,be.bool])),be.func,be.object]),timezone:be.string,value:be.object,view:be.oneOf(["day","month","year"]),viewRenderers:be.shape({day:be.func,month:be.func,year:be.func}),views:be.arrayOf(be.oneOf(["day","month","year"]).isRequired),yearsOrder:be.oneOf(["asc","desc"]),yearsPerRow:be.oneOf([3,4])};const XT=Ge(br)({[`& .${vf.container}`]:{outline:0},[`& .${vf.paper}`]:{outline:0,minWidth:jc}}),KT=Ge(Dr)({"&:first-of-type":{padding:0}});function JT(e){const{children:r,slots:t,slotProps:n}=e,{open:a}=ti(),{dismissViews:s,onPopperExited:o}=dr(),c=(t==null?void 0:t.dialog)??XT,l=(t==null?void 0:t.mobileTransition)??gc;return i.jsx(c,ie({open:a,onClose:()=>{s(),o==null||o()}},n==null?void 0:n.dialog,{TransitionComponent:l,TransitionProps:n==null?void 0:n.mobileTransition,PaperComponent:t==null?void 0:t.mobilePaper,PaperProps:n==null?void 0:n.mobilePaper,children:i.jsx(KT,{children:r})}))}const QT=["props","steps"],ZT=["ownerState"],eA=e=>{var A;let{props:r,steps:t}=e,n=Qe(e,QT);const{slots:a,slotProps:s,label:o,inputRef:c,localeText:l}=r,u=sx({steps:t}),{providerProps:d,renderCurrentView:f,ownerState:h}=rx(ie({},n,{props:r,localeText:l,autoFocusView:!0,viewContainerRole:"dialog",variant:"mobile",getStepNavigation:u})),x=d.privateContextValue.labelId,m=((A=s==null?void 0:s.toolbar)==null?void 0:A.hidden)??!1,p=a.field,g=ht({elementType:p,externalSlotProps:s==null?void 0:s.field,additionalProps:ie({},m&&{id:x}),ownerState:h}),w=Qe(g,ZT),y=a.layout??ax;let v=x;m&&(o?v=`${x}-label`:v=void 0);const T=ie({},s,{toolbar:ie({},s==null?void 0:s.toolbar,{titleId:x}),mobilePaper:ie({"aria-labelledby":v},s==null?void 0:s.mobilePaper)});return{renderPicker:()=>i.jsx(ym,ie({},d,{children:i.jsxs(Gm,{slots:a,slotProps:T,inputRef:c,children:[i.jsx(p,ie({},w)),i.jsx(JT,{slots:a,slotProps:T,children:i.jsx(y,ie({},T==null?void 0:T.layout,{slots:a,slotProps:T,children:f()}))})]})}))}},ox=C.forwardRef(function(r,t){var l;const n=St(),a=tx(r,"MuiMobileDatePicker"),s=ie({day:Bs,month:Bs,year:Bs},a.viewRenderers),o=ie({},a,{viewRenderers:s,format:Mu(n,a,!1),slots:ie({field:Ym},a.slots),slotProps:ie({},a.slotProps,{field:u=>{var d;return ie({},$i((d=a.slotProps)==null?void 0:d.field,u),Fm(a))},toolbar:ie({hidden:!1},(l=a.slotProps)==null?void 0:l.toolbar)})}),{renderPicker:c}=eA({ref:t,props:o,valueManager:$n,valueType:"date",validator:io,steps:null});return c()});ox.propTypes={autoFocus:be.bool,className:be.string,closeOnSelect:be.bool,dayOfWeekFormatter:be.func,defaultValue:be.object,disabled:be.bool,disableFuture:be.bool,disableHighlightToday:be.bool,disableOpenPicker:be.bool,disablePast:be.bool,displayWeekNumber:be.bool,enableAccessibleFieldDOMStructure:be.any,fixedWeekNumber:be.number,format:be.string,formatDensity:be.oneOf(["dense","spacious"]),inputRef:um,label:be.node,loading:be.bool,localeText:be.object,maxDate:be.object,minDate:be.object,monthsPerRow:be.oneOf([3,4]),name:be.string,onAccept:be.func,onChange:be.func,onClose:be.func,onError:be.func,onMonthChange:be.func,onOpen:be.func,onSelectedSectionsChange:be.func,onViewChange:be.func,onYearChange:be.func,open:be.bool,openTo:be.oneOf(["day","month","year"]),orientation:be.oneOf(["landscape","portrait"]),readOnly:be.bool,reduceAnimations:be.bool,referenceDate:be.object,renderLoading:be.func,selectedSections:be.oneOfType([be.oneOf(["all","day","empty","hours","meridiem","minutes","month","seconds","weekDay","year"]),be.number]),shouldDisableDate:be.func,shouldDisableMonth:be.func,shouldDisableYear:be.func,showDaysOutsideCurrentMonth:be.bool,slotProps:be.object,slots:be.object,sx:be.oneOfType([be.arrayOf(be.oneOfType([be.func,be.object,be.bool])),be.func,be.object]),timezone:be.string,value:be.object,view:be.oneOf(["day","month","year"]),viewRenderers:be.shape({day:be.func,month:be.func,year:be.func}),views:be.arrayOf(be.oneOf(["day","month","year"]).isRequired),yearsOrder:be.oneOf(["asc","desc"]),yearsPerRow:be.oneOf([3,4])};const tA=["desktopModeMediaQuery"],rA=C.forwardRef(function(r,t){const n=Dt({props:r,name:"MuiDatePicker"}),{desktopModeMediaQuery:a=v2}=n,s=Qe(n,tA);return bu(a,{defaultMatches:!0})?i.jsx(ix,ie({ref:t},s)):i.jsx(ox,ie({ref:t},s))}),cx=6048e5,nA=864e5,Rc=6e4,Nc=36e5,aA=1e3,x0=Symbol.for("constructDateFrom");function wt(e,r){return typeof e=="function"?e(r):e&&typeof e=="object"&&x0 in e?e[x0](r):e instanceof Date?new e.constructor(r):new Date(r)}function Xe(e,r){return wt(r||e,e)}function Mc(e,r,t){const n=Xe(e,t==null?void 0:t.in);return isNaN(r)?wt((t==null?void 0:t.in)||e,NaN):(r&&n.setDate(n.getDate()+r),n)}function lx(e,r,t){return wt((t==null?void 0:t.in)||e,+Xe(e)+r)}function sA(e,r,t){return lx(e,r*1e3,t)}function iA(e,r,t){const n=Xe(e,t==null?void 0:t.in);return n.setTime(n.getTime()+r*Rc),n}function oA(e,r,t){return lx(e,r*Nc,t)}function cA(e,r,t){return Mc(e,r*7,t)}function ux(e,r,t){const n=Xe(e,t==null?void 0:t.in);if(isNaN(r))return wt((t==null?void 0:t.in)||e,NaN);if(!r)return n;const a=n.getDate(),s=wt((t==null?void 0:t.in)||e,n.getTime());s.setMonth(n.getMonth()+r+1,0);const o=s.getDate();return a>=o?s:(n.setFullYear(s.getFullYear(),s.getMonth(),a),n)}function lA(e,r,t){return ux(e,r*12,t)}function g0(e,r){const t=Xe(e,r==null?void 0:r.in);return t.setHours(23,59,59,999),t}let uA={};function us(){return uA}function dA(e,r){var c,l,u,d;const t=us(),n=(r==null?void 0:r.weekStartsOn)??((l=(c=r==null?void 0:r.locale)==null?void 0:c.options)==null?void 0:l.weekStartsOn)??t.weekStartsOn??((d=(u=t.locale)==null?void 0:u.options)==null?void 0:d.weekStartsOn)??0,a=Xe(e,r==null?void 0:r.in),s=a.getDay(),o=(s<n?-7:0)+6-(s-n);return a.setDate(a.getDate()+o),a.setHours(23,59,59,999),a}function y0(e,r){const t=Xe(e,r==null?void 0:r.in),n=t.getFullYear();return t.setFullYear(n+1,0,0),t.setHours(23,59,59,999),t}const fA={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},hA=(e,r,t)=>{let n;const a=fA[e];return typeof a=="string"?n=a:r===1?n=a.one:n=a.other.replace("{{count}}",r.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+n:n+" ago":n};function ul(e){return(r={})=>{const t=r.width?String(r.width):e.defaultWidth;return e.formats[t]||e.formats[e.defaultWidth]}}const pA={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},mA={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},xA={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},gA={date:ul({formats:pA,defaultWidth:"full"}),time:ul({formats:mA,defaultWidth:"full"}),dateTime:ul({formats:xA,defaultWidth:"full"})},yA={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},vA=(e,r,t,n)=>yA[e];function mi(e){return(r,t)=>{const n=t!=null&&t.context?String(t.context):"standalone";let a;if(n==="formatting"&&e.formattingValues){const o=e.defaultFormattingWidth||e.defaultWidth,c=t!=null&&t.width?String(t.width):o;a=e.formattingValues[c]||e.formattingValues[o]}else{const o=e.defaultWidth,c=t!=null&&t.width?String(t.width):e.defaultWidth;a=e.values[c]||e.values[o]}const s=e.argumentCallback?e.argumentCallback(r):r;return a[s]}}const bA={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},wA={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},SA={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},EA={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},TA={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},AA={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},kA=(e,r)=>{const t=Number(e),n=t%100;if(n>20||n<10)switch(n%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},CA={ordinalNumber:kA,era:mi({values:bA,defaultWidth:"wide"}),quarter:mi({values:wA,defaultWidth:"wide",argumentCallback:e=>e-1}),month:mi({values:SA,defaultWidth:"wide"}),day:mi({values:EA,defaultWidth:"wide"}),dayPeriod:mi({values:TA,defaultWidth:"wide",formattingValues:AA,defaultFormattingWidth:"wide"})};function xi(e){return(r,t={})=>{const n=t.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],s=r.match(a);if(!s)return null;const o=s[0],c=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(c)?DA(c,f=>f.test(o)):_A(c,f=>f.test(o));let u;u=e.valueCallback?e.valueCallback(l):l,u=t.valueCallback?t.valueCallback(u):u;const d=r.slice(o.length);return{value:u,rest:d}}}function _A(e,r){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&r(e[t]))return t}function DA(e,r){for(let t=0;t<e.length;t++)if(r(e[t]))return t}function FA(e){return(r,t={})=>{const n=r.match(e.matchPattern);if(!n)return null;const a=n[0],s=r.match(e.parsePattern);if(!s)return null;let o=e.valueCallback?e.valueCallback(s[0]):s[0];o=t.valueCallback?t.valueCallback(o):o;const c=r.slice(a.length);return{value:o,rest:c}}}const jA=/^(\d+)(th|st|nd|rd)?/i,IA=/\d+/i,PA={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},OA={any:[/^b/i,/^(a|c)/i]},RA={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},NA={any:[/1/i,/2/i,/3/i,/4/i]},MA={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},LA={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},BA={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},$A={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},UA={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},VA={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},WA={ordinalNumber:FA({matchPattern:jA,parsePattern:IA,valueCallback:e=>parseInt(e,10)}),era:xi({matchPatterns:PA,defaultMatchWidth:"wide",parsePatterns:OA,defaultParseWidth:"any"}),quarter:xi({matchPatterns:RA,defaultMatchWidth:"wide",parsePatterns:NA,defaultParseWidth:"any",valueCallback:e=>e+1}),month:xi({matchPatterns:MA,defaultMatchWidth:"wide",parsePatterns:LA,defaultParseWidth:"any"}),day:xi({matchPatterns:BA,defaultMatchWidth:"wide",parsePatterns:$A,defaultParseWidth:"any"}),dayPeriod:xi({matchPatterns:UA,defaultMatchWidth:"any",parsePatterns:VA,defaultParseWidth:"any"})},Yu={code:"en-US",formatDistance:hA,formatLong:gA,formatRelative:vA,localize:CA,match:WA,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Zo(e){const r=Xe(e),t=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()));return t.setUTCFullYear(r.getFullYear()),+e-+t}function co(e,...r){const t=wt.bind(null,e||r.find(n=>typeof n=="object"));return r.map(t)}function Wi(e,r){const t=Xe(e,r==null?void 0:r.in);return t.setHours(0,0,0,0),t}function HA(e,r,t){const[n,a]=co(t==null?void 0:t.in,e,r),s=Wi(n),o=Wi(a),c=+s-Zo(s),l=+o-Zo(o);return Math.round((c-l)/nA)}function dx(e,r){const t=Xe(e,r==null?void 0:r.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}function zA(e,r){const t=Xe(e,r==null?void 0:r.in);return HA(t,dx(t))+1}function ea(e,r){var c,l,u,d;const t=us(),n=(r==null?void 0:r.weekStartsOn)??((l=(c=r==null?void 0:r.locale)==null?void 0:c.options)==null?void 0:l.weekStartsOn)??t.weekStartsOn??((d=(u=t.locale)==null?void 0:u.options)==null?void 0:d.weekStartsOn)??0,a=Xe(e,r==null?void 0:r.in),s=a.getDay(),o=(s<n?7:0)+s-n;return a.setDate(a.getDate()-o),a.setHours(0,0,0,0),a}function Ys(e,r){return ea(e,{...r,weekStartsOn:1})}function fx(e,r){const t=Xe(e,r==null?void 0:r.in),n=t.getFullYear(),a=wt(t,0);a.setFullYear(n+1,0,4),a.setHours(0,0,0,0);const s=Ys(a),o=wt(t,0);o.setFullYear(n,0,4),o.setHours(0,0,0,0);const c=Ys(o);return t.getTime()>=s.getTime()?n+1:t.getTime()>=c.getTime()?n:n-1}function GA(e,r){const t=fx(e,r),n=wt((r==null?void 0:r.in)||e,0);return n.setFullYear(t,0,4),n.setHours(0,0,0,0),Ys(n)}function hx(e,r){const t=Xe(e,r==null?void 0:r.in),n=+Ys(t)-+GA(t);return Math.round(n/cx)+1}function qu(e,r){var d,f,h,x;const t=Xe(e,r==null?void 0:r.in),n=t.getFullYear(),a=us(),s=(r==null?void 0:r.firstWeekContainsDate)??((f=(d=r==null?void 0:r.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??a.firstWeekContainsDate??((x=(h=a.locale)==null?void 0:h.options)==null?void 0:x.firstWeekContainsDate)??1,o=wt((r==null?void 0:r.in)||e,0);o.setFullYear(n+1,0,s),o.setHours(0,0,0,0);const c=ea(o,r),l=wt((r==null?void 0:r.in)||e,0);l.setFullYear(n,0,s),l.setHours(0,0,0,0);const u=ea(l,r);return+t>=+c?n+1:+t>=+u?n:n-1}function YA(e,r){var c,l,u,d;const t=us(),n=(r==null?void 0:r.firstWeekContainsDate)??((l=(c=r==null?void 0:r.locale)==null?void 0:c.options)==null?void 0:l.firstWeekContainsDate)??t.firstWeekContainsDate??((d=(u=t.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??1,a=qu(e,r),s=wt((r==null?void 0:r.in)||e,0);return s.setFullYear(a,0,n),s.setHours(0,0,0,0),ea(s,r)}function Xu(e,r){const t=Xe(e,r==null?void 0:r.in),n=+ea(t,r)-+YA(t,r);return Math.round(n/cx)+1}function pt(e,r){const t=e<0?"-":"",n=Math.abs(e).toString().padStart(r,"0");return t+n}const sa={y(e,r){const t=e.getFullYear(),n=t>0?t:1-t;return pt(r==="yy"?n%100:n,r.length)},M(e,r){const t=e.getMonth();return r==="M"?String(t+1):pt(t+1,2)},d(e,r){return pt(e.getDate(),r.length)},a(e,r){const t=e.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(e,r){return pt(e.getHours()%12||12,r.length)},H(e,r){return pt(e.getHours(),r.length)},m(e,r){return pt(e.getMinutes(),r.length)},s(e,r){return pt(e.getSeconds(),r.length)},S(e,r){const t=r.length,n=e.getMilliseconds(),a=Math.trunc(n*Math.pow(10,t-3));return pt(a,r.length)}},_s={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},v0={G:function(e,r,t){const n=e.getFullYear()>0?1:0;switch(r){case"G":case"GG":case"GGG":return t.era(n,{width:"abbreviated"});case"GGGGG":return t.era(n,{width:"narrow"});case"GGGG":default:return t.era(n,{width:"wide"})}},y:function(e,r,t){if(r==="yo"){const n=e.getFullYear(),a=n>0?n:1-n;return t.ordinalNumber(a,{unit:"year"})}return sa.y(e,r)},Y:function(e,r,t,n){const a=qu(e,n),s=a>0?a:1-a;if(r==="YY"){const o=s%100;return pt(o,2)}return r==="Yo"?t.ordinalNumber(s,{unit:"year"}):pt(s,r.length)},R:function(e,r){const t=fx(e);return pt(t,r.length)},u:function(e,r){const t=e.getFullYear();return pt(t,r.length)},Q:function(e,r,t){const n=Math.ceil((e.getMonth()+1)/3);switch(r){case"Q":return String(n);case"QQ":return pt(n,2);case"Qo":return t.ordinalNumber(n,{unit:"quarter"});case"QQQ":return t.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,r,t){const n=Math.ceil((e.getMonth()+1)/3);switch(r){case"q":return String(n);case"qq":return pt(n,2);case"qo":return t.ordinalNumber(n,{unit:"quarter"});case"qqq":return t.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,r,t){const n=e.getMonth();switch(r){case"M":case"MM":return sa.M(e,r);case"Mo":return t.ordinalNumber(n+1,{unit:"month"});case"MMM":return t.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(n,{width:"wide",context:"formatting"})}},L:function(e,r,t){const n=e.getMonth();switch(r){case"L":return String(n+1);case"LL":return pt(n+1,2);case"Lo":return t.ordinalNumber(n+1,{unit:"month"});case"LLL":return t.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(n,{width:"wide",context:"standalone"})}},w:function(e,r,t,n){const a=Xu(e,n);return r==="wo"?t.ordinalNumber(a,{unit:"week"}):pt(a,r.length)},I:function(e,r,t){const n=hx(e);return r==="Io"?t.ordinalNumber(n,{unit:"week"}):pt(n,r.length)},d:function(e,r,t){return r==="do"?t.ordinalNumber(e.getDate(),{unit:"date"}):sa.d(e,r)},D:function(e,r,t){const n=zA(e);return r==="Do"?t.ordinalNumber(n,{unit:"dayOfYear"}):pt(n,r.length)},E:function(e,r,t){const n=e.getDay();switch(r){case"E":case"EE":case"EEE":return t.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(n,{width:"short",context:"formatting"});case"EEEE":default:return t.day(n,{width:"wide",context:"formatting"})}},e:function(e,r,t,n){const a=e.getDay(),s=(a-n.weekStartsOn+8)%7||7;switch(r){case"e":return String(s);case"ee":return pt(s,2);case"eo":return t.ordinalNumber(s,{unit:"day"});case"eee":return t.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(a,{width:"short",context:"formatting"});case"eeee":default:return t.day(a,{width:"wide",context:"formatting"})}},c:function(e,r,t,n){const a=e.getDay(),s=(a-n.weekStartsOn+8)%7||7;switch(r){case"c":return String(s);case"cc":return pt(s,r.length);case"co":return t.ordinalNumber(s,{unit:"day"});case"ccc":return t.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(a,{width:"narrow",context:"standalone"});case"cccccc":return t.day(a,{width:"short",context:"standalone"});case"cccc":default:return t.day(a,{width:"wide",context:"standalone"})}},i:function(e,r,t){const n=e.getDay(),a=n===0?7:n;switch(r){case"i":return String(a);case"ii":return pt(a,r.length);case"io":return t.ordinalNumber(a,{unit:"day"});case"iii":return t.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(n,{width:"short",context:"formatting"});case"iiii":default:return t.day(n,{width:"wide",context:"formatting"})}},a:function(e,r,t){const a=e.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,r,t){const n=e.getHours();let a;switch(n===12?a=_s.noon:n===0?a=_s.midnight:a=n/12>=1?"pm":"am",r){case"b":case"bb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,r,t){const n=e.getHours();let a;switch(n>=17?a=_s.evening:n>=12?a=_s.afternoon:n>=4?a=_s.morning:a=_s.night,r){case"B":case"BB":case"BBB":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,r,t){if(r==="ho"){let n=e.getHours()%12;return n===0&&(n=12),t.ordinalNumber(n,{unit:"hour"})}return sa.h(e,r)},H:function(e,r,t){return r==="Ho"?t.ordinalNumber(e.getHours(),{unit:"hour"}):sa.H(e,r)},K:function(e,r,t){const n=e.getHours()%12;return r==="Ko"?t.ordinalNumber(n,{unit:"hour"}):pt(n,r.length)},k:function(e,r,t){let n=e.getHours();return n===0&&(n=24),r==="ko"?t.ordinalNumber(n,{unit:"hour"}):pt(n,r.length)},m:function(e,r,t){return r==="mo"?t.ordinalNumber(e.getMinutes(),{unit:"minute"}):sa.m(e,r)},s:function(e,r,t){return r==="so"?t.ordinalNumber(e.getSeconds(),{unit:"second"}):sa.s(e,r)},S:function(e,r){return sa.S(e,r)},X:function(e,r,t){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(r){case"X":return w0(n);case"XXXX":case"XX":return Ma(n);case"XXXXX":case"XXX":default:return Ma(n,":")}},x:function(e,r,t){const n=e.getTimezoneOffset();switch(r){case"x":return w0(n);case"xxxx":case"xx":return Ma(n);case"xxxxx":case"xxx":default:return Ma(n,":")}},O:function(e,r,t){const n=e.getTimezoneOffset();switch(r){case"O":case"OO":case"OOO":return"GMT"+b0(n,":");case"OOOO":default:return"GMT"+Ma(n,":")}},z:function(e,r,t){const n=e.getTimezoneOffset();switch(r){case"z":case"zz":case"zzz":return"GMT"+b0(n,":");case"zzzz":default:return"GMT"+Ma(n,":")}},t:function(e,r,t){const n=Math.trunc(+e/1e3);return pt(n,r.length)},T:function(e,r,t){return pt(+e,r.length)}};function b0(e,r=""){const t=e>0?"-":"+",n=Math.abs(e),a=Math.trunc(n/60),s=n%60;return s===0?t+String(a):t+String(a)+r+pt(s,2)}function w0(e,r){return e%60===0?(e>0?"-":"+")+pt(Math.abs(e)/60,2):Ma(e,r)}function Ma(e,r=""){const t=e>0?"-":"+",n=Math.abs(e),a=pt(Math.trunc(n/60),2),s=pt(n%60,2);return t+a+r+s}const S0=(e,r)=>{switch(e){case"P":return r.date({width:"short"});case"PP":return r.date({width:"medium"});case"PPP":return r.date({width:"long"});case"PPPP":default:return r.date({width:"full"})}},px=(e,r)=>{switch(e){case"p":return r.time({width:"short"});case"pp":return r.time({width:"medium"});case"ppp":return r.time({width:"long"});case"pppp":default:return r.time({width:"full"})}},qA=(e,r)=>{const t=e.match(/(P+)(p+)?/)||[],n=t[1],a=t[2];if(!a)return S0(e,r);let s;switch(n){case"P":s=r.dateTime({width:"short"});break;case"PP":s=r.dateTime({width:"medium"});break;case"PPP":s=r.dateTime({width:"long"});break;case"PPPP":default:s=r.dateTime({width:"full"});break}return s.replace("{{date}}",S0(n,r)).replace("{{time}}",px(a,r))},ec={p:px,P:qA},XA=/^D+$/,KA=/^Y+$/,JA=["D","DD","YY","YYYY"];function mx(e){return XA.test(e)}function xx(e){return KA.test(e)}function Kl(e,r,t){const n=QA(e,r,t);if(console.warn(n),JA.includes(e))throw new RangeError(n)}function QA(e,r,t){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${r}\`) for formatting ${n} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}function ZA(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function gx(e){return!(!ZA(e)&&typeof e!="number"||isNaN(+Xe(e)))}const ek=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,tk=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,rk=/^'([^]*?)'?$/,nk=/''/g,ak=/[a-zA-Z]/;function qs(e,r,t){var d,f,h,x,m,p,g,w;const n=us(),a=(t==null?void 0:t.locale)??n.locale??Yu,s=(t==null?void 0:t.firstWeekContainsDate)??((f=(d=t==null?void 0:t.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??n.firstWeekContainsDate??((x=(h=n.locale)==null?void 0:h.options)==null?void 0:x.firstWeekContainsDate)??1,o=(t==null?void 0:t.weekStartsOn)??((p=(m=t==null?void 0:t.locale)==null?void 0:m.options)==null?void 0:p.weekStartsOn)??n.weekStartsOn??((w=(g=n.locale)==null?void 0:g.options)==null?void 0:w.weekStartsOn)??0,c=Xe(e,t==null?void 0:t.in);if(!gx(c))throw new RangeError("Invalid time value");let l=r.match(tk).map(y=>{const v=y[0];if(v==="p"||v==="P"){const T=ec[v];return T(y,a.formatLong)}return y}).join("").match(ek).map(y=>{if(y==="''")return{isToken:!1,value:"'"};const v=y[0];if(v==="'")return{isToken:!1,value:sk(y)};if(v0[v])return{isToken:!0,value:y};if(v.match(ak))throw new RangeError("Format string contains an unescaped latin alphabet character `"+v+"`");return{isToken:!1,value:y}});a.localize.preprocessor&&(l=a.localize.preprocessor(c,l));const u={firstWeekContainsDate:s,weekStartsOn:o,locale:a};return l.map(y=>{if(!y.isToken)return y.value;const v=y.value;(!(t!=null&&t.useAdditionalWeekYearTokens)&&xx(v)||!(t!=null&&t.useAdditionalDayOfYearTokens)&&mx(v))&&Kl(v,r,String(e));const T=v0[v[0]];return T(c,v,a.localize,u)}).join("")}function sk(e){const r=e.match(rk);return r?r[1].replace(nk,"'"):e}function ik(e,r){return Xe(e,r==null?void 0:r.in).getDate()}function yx(e,r){const t=Xe(e,r==null?void 0:r.in),n=t.getFullYear(),a=t.getMonth(),s=wt(t,0);return s.setFullYear(n,a+1,0),s.setHours(0,0,0,0),s.getDate()}function ok(e,r){return Xe(e,r==null?void 0:r.in).getHours()}function ck(e,r){return Xe(e,r==null?void 0:r.in).getMinutes()}function lk(e,r){return Xe(e,r==null?void 0:r.in).getMonth()}function uk(e){return Xe(e).getSeconds()}function dk(e){return Xe(e).getMilliseconds()}function fk(e,r){return Xe(e,r==null?void 0:r.in).getFullYear()}function dl(e,r){return+Xe(e)>+Xe(r)}function fl(e,r){return+Xe(e)<+Xe(r)}function hk(e,r){return+Xe(e)==+Xe(r)}function pk(e,r,t){const[n,a]=co(t==null?void 0:t.in,e,r);return+Wi(n)==+Wi(a)}function mk(e,r,t){const[n,a]=co(t==null?void 0:t.in,e,r);return n.getFullYear()===a.getFullYear()}function xk(e,r,t){const[n,a]=co(t==null?void 0:t.in,e,r);return n.getFullYear()===a.getFullYear()&&n.getMonth()===a.getMonth()}function E0(e,r){const t=Xe(e,r==null?void 0:r.in);return t.setMinutes(0,0,0),t}function gk(e,r,t){const[n,a]=co(t==null?void 0:t.in,e,r);return+E0(n)==+E0(a)}function yk(){return Object.assign({},us())}function vk(e,r){const t=bk(r)?new r(0):wt(r,0);return t.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),t.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),t}function bk(e){var r;return typeof e=="function"&&((r=e.prototype)==null?void 0:r.constructor)===e}const wk=10;class vx{constructor(){Le(this,"subPriority",0)}validate(r,t){return!0}}class Sk extends vx{constructor(r,t,n,a,s){super(),this.value=r,this.validateValue=t,this.setValue=n,this.priority=a,s&&(this.subPriority=s)}validate(r,t){return this.validateValue(r,this.value,t)}set(r,t,n){return this.setValue(r,t,this.value,n)}}class Ek extends vx{constructor(t,n){super();Le(this,"priority",wk);Le(this,"subPriority",-1);this.context=t||(a=>wt(n,a))}set(t,n){return n.timestampIsSet?t:wt(t,vk(t,this.context))}}class ft{run(r,t,n,a){const s=this.parse(r,t,n,a);return s?{setter:new Sk(s.value,this.validate,this.set,this.priority,this.subPriority),rest:s.rest}:null}validate(r,t,n){return!0}}class Tk extends ft{constructor(){super(...arguments);Le(this,"priority",140);Le(this,"incompatibleTokens",["R","u","t","T"])}parse(t,n,a){switch(n){case"G":case"GG":case"GGG":return a.era(t,{width:"abbreviated"})||a.era(t,{width:"narrow"});case"GGGGG":return a.era(t,{width:"narrow"});case"GGGG":default:return a.era(t,{width:"wide"})||a.era(t,{width:"abbreviated"})||a.era(t,{width:"narrow"})}}set(t,n,a){return n.era=a,t.setFullYear(a,0,1),t.setHours(0,0,0,0),t}}const Vt={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},Rn={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function Wt(e,r){return e&&{value:r(e.value),rest:e.rest}}function Ct(e,r){const t=r.match(e);return t?{value:parseInt(t[0],10),rest:r.slice(t[0].length)}:null}function Nn(e,r){const t=r.match(e);if(!t)return null;if(t[0]==="Z")return{value:0,rest:r.slice(1)};const n=t[1]==="+"?1:-1,a=t[2]?parseInt(t[2],10):0,s=t[3]?parseInt(t[3],10):0,o=t[5]?parseInt(t[5],10):0;return{value:n*(a*Nc+s*Rc+o*aA),rest:r.slice(t[0].length)}}function bx(e){return Ct(Vt.anyDigitsSigned,e)}function Pt(e,r){switch(e){case 1:return Ct(Vt.singleDigit,r);case 2:return Ct(Vt.twoDigits,r);case 3:return Ct(Vt.threeDigits,r);case 4:return Ct(Vt.fourDigits,r);default:return Ct(new RegExp("^\\d{1,"+e+"}"),r)}}function tc(e,r){switch(e){case 1:return Ct(Vt.singleDigitSigned,r);case 2:return Ct(Vt.twoDigitsSigned,r);case 3:return Ct(Vt.threeDigitsSigned,r);case 4:return Ct(Vt.fourDigitsSigned,r);default:return Ct(new RegExp("^-?\\d{1,"+e+"}"),r)}}function Ku(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function wx(e,r){const t=r>0,n=t?r:1-r;let a;if(n<=50)a=e||100;else{const s=n+50,o=Math.trunc(s/100)*100,c=e>=s%100;a=e+o-(c?100:0)}return t?a:1-a}function Sx(e){return e%400===0||e%4===0&&e%100!==0}class Ak extends ft{constructor(){super(...arguments);Le(this,"priority",130);Le(this,"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"])}parse(t,n,a){const s=o=>({year:o,isTwoDigitYear:n==="yy"});switch(n){case"y":return Wt(Pt(4,t),s);case"yo":return Wt(a.ordinalNumber(t,{unit:"year"}),s);default:return Wt(Pt(n.length,t),s)}}validate(t,n){return n.isTwoDigitYear||n.year>0}set(t,n,a){const s=t.getFullYear();if(a.isTwoDigitYear){const c=wx(a.year,s);return t.setFullYear(c,0,1),t.setHours(0,0,0,0),t}const o=!("era"in n)||n.era===1?a.year:1-a.year;return t.setFullYear(o,0,1),t.setHours(0,0,0,0),t}}class kk extends ft{constructor(){super(...arguments);Le(this,"priority",130);Le(this,"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"])}parse(t,n,a){const s=o=>({year:o,isTwoDigitYear:n==="YY"});switch(n){case"Y":return Wt(Pt(4,t),s);case"Yo":return Wt(a.ordinalNumber(t,{unit:"year"}),s);default:return Wt(Pt(n.length,t),s)}}validate(t,n){return n.isTwoDigitYear||n.year>0}set(t,n,a,s){const o=qu(t,s);if(a.isTwoDigitYear){const l=wx(a.year,o);return t.setFullYear(l,0,s.firstWeekContainsDate),t.setHours(0,0,0,0),ea(t,s)}const c=!("era"in n)||n.era===1?a.year:1-a.year;return t.setFullYear(c,0,s.firstWeekContainsDate),t.setHours(0,0,0,0),ea(t,s)}}class Ck extends ft{constructor(){super(...arguments);Le(this,"priority",130);Le(this,"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"])}parse(t,n){return tc(n==="R"?4:n.length,t)}set(t,n,a){const s=wt(t,0);return s.setFullYear(a,0,4),s.setHours(0,0,0,0),Ys(s)}}class _k extends ft{constructor(){super(...arguments);Le(this,"priority",130);Le(this,"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"])}parse(t,n){return tc(n==="u"?4:n.length,t)}set(t,n,a){return t.setFullYear(a,0,1),t.setHours(0,0,0,0),t}}class Dk extends ft{constructor(){super(...arguments);Le(this,"priority",120);Le(this,"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"])}parse(t,n,a){switch(n){case"Q":case"QQ":return Pt(n.length,t);case"Qo":return a.ordinalNumber(t,{unit:"quarter"});case"QQQ":return a.quarter(t,{width:"abbreviated",context:"formatting"})||a.quarter(t,{width:"narrow",context:"formatting"});case"QQQQQ":return a.quarter(t,{width:"narrow",context:"formatting"});case"QQQQ":default:return a.quarter(t,{width:"wide",context:"formatting"})||a.quarter(t,{width:"abbreviated",context:"formatting"})||a.quarter(t,{width:"narrow",context:"formatting"})}}validate(t,n){return n>=1&&n<=4}set(t,n,a){return t.setMonth((a-1)*3,1),t.setHours(0,0,0,0),t}}class Fk extends ft{constructor(){super(...arguments);Le(this,"priority",120);Le(this,"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"])}parse(t,n,a){switch(n){case"q":case"qq":return Pt(n.length,t);case"qo":return a.ordinalNumber(t,{unit:"quarter"});case"qqq":return a.quarter(t,{width:"abbreviated",context:"standalone"})||a.quarter(t,{width:"narrow",context:"standalone"});case"qqqqq":return a.quarter(t,{width:"narrow",context:"standalone"});case"qqqq":default:return a.quarter(t,{width:"wide",context:"standalone"})||a.quarter(t,{width:"abbreviated",context:"standalone"})||a.quarter(t,{width:"narrow",context:"standalone"})}}validate(t,n){return n>=1&&n<=4}set(t,n,a){return t.setMonth((a-1)*3,1),t.setHours(0,0,0,0),t}}class jk extends ft{constructor(){super(...arguments);Le(this,"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]);Le(this,"priority",110)}parse(t,n,a){const s=o=>o-1;switch(n){case"M":return Wt(Ct(Vt.month,t),s);case"MM":return Wt(Pt(2,t),s);case"Mo":return Wt(a.ordinalNumber(t,{unit:"month"}),s);case"MMM":return a.month(t,{width:"abbreviated",context:"formatting"})||a.month(t,{width:"narrow",context:"formatting"});case"MMMMM":return a.month(t,{width:"narrow",context:"formatting"});case"MMMM":default:return a.month(t,{width:"wide",context:"formatting"})||a.month(t,{width:"abbreviated",context:"formatting"})||a.month(t,{width:"narrow",context:"formatting"})}}validate(t,n){return n>=0&&n<=11}set(t,n,a){return t.setMonth(a,1),t.setHours(0,0,0,0),t}}class Ik extends ft{constructor(){super(...arguments);Le(this,"priority",110);Le(this,"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"])}parse(t,n,a){const s=o=>o-1;switch(n){case"L":return Wt(Ct(Vt.month,t),s);case"LL":return Wt(Pt(2,t),s);case"Lo":return Wt(a.ordinalNumber(t,{unit:"month"}),s);case"LLL":return a.month(t,{width:"abbreviated",context:"standalone"})||a.month(t,{width:"narrow",context:"standalone"});case"LLLLL":return a.month(t,{width:"narrow",context:"standalone"});case"LLLL":default:return a.month(t,{width:"wide",context:"standalone"})||a.month(t,{width:"abbreviated",context:"standalone"})||a.month(t,{width:"narrow",context:"standalone"})}}validate(t,n){return n>=0&&n<=11}set(t,n,a){return t.setMonth(a,1),t.setHours(0,0,0,0),t}}function Pk(e,r,t){const n=Xe(e,t==null?void 0:t.in),a=Xu(n,t)-r;return n.setDate(n.getDate()-a*7),Xe(n,t==null?void 0:t.in)}class Ok extends ft{constructor(){super(...arguments);Le(this,"priority",100);Le(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"])}parse(t,n,a){switch(n){case"w":return Ct(Vt.week,t);case"wo":return a.ordinalNumber(t,{unit:"week"});default:return Pt(n.length,t)}}validate(t,n){return n>=1&&n<=53}set(t,n,a,s){return ea(Pk(t,a,s),s)}}function Rk(e,r,t){const n=Xe(e,t==null?void 0:t.in),a=hx(n,t)-r;return n.setDate(n.getDate()-a*7),n}class Nk extends ft{constructor(){super(...arguments);Le(this,"priority",100);Le(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"])}parse(t,n,a){switch(n){case"I":return Ct(Vt.week,t);case"Io":return a.ordinalNumber(t,{unit:"week"});default:return Pt(n.length,t)}}validate(t,n){return n>=1&&n<=53}set(t,n,a){return Ys(Rk(t,a))}}const Mk=[31,28,31,30,31,30,31,31,30,31,30,31],Lk=[31,29,31,30,31,30,31,31,30,31,30,31];class Bk extends ft{constructor(){super(...arguments);Le(this,"priority",90);Le(this,"subPriority",1);Le(this,"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"])}parse(t,n,a){switch(n){case"d":return Ct(Vt.date,t);case"do":return a.ordinalNumber(t,{unit:"date"});default:return Pt(n.length,t)}}validate(t,n){const a=t.getFullYear(),s=Sx(a),o=t.getMonth();return s?n>=1&&n<=Lk[o]:n>=1&&n<=Mk[o]}set(t,n,a){return t.setDate(a),t.setHours(0,0,0,0),t}}class $k extends ft{constructor(){super(...arguments);Le(this,"priority",90);Le(this,"subpriority",1);Le(this,"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"])}parse(t,n,a){switch(n){case"D":case"DD":return Ct(Vt.dayOfYear,t);case"Do":return a.ordinalNumber(t,{unit:"date"});default:return Pt(n.length,t)}}validate(t,n){const a=t.getFullYear();return Sx(a)?n>=1&&n<=366:n>=1&&n<=365}set(t,n,a){return t.setMonth(0,a),t.setHours(0,0,0,0),t}}function Ju(e,r,t){var f,h,x,m;const n=us(),a=(t==null?void 0:t.weekStartsOn)??((h=(f=t==null?void 0:t.locale)==null?void 0:f.options)==null?void 0:h.weekStartsOn)??n.weekStartsOn??((m=(x=n.locale)==null?void 0:x.options)==null?void 0:m.weekStartsOn)??0,s=Xe(e,t==null?void 0:t.in),o=s.getDay(),l=(r%7+7)%7,u=7-a,d=r<0||r>6?r-(o+u)%7:(l+u)%7-(o+u)%7;return Mc(s,d,t)}class Uk extends ft{constructor(){super(...arguments);Le(this,"priority",90);Le(this,"incompatibleTokens",["D","i","e","c","t","T"])}parse(t,n,a){switch(n){case"E":case"EE":case"EEE":return a.day(t,{width:"abbreviated",context:"formatting"})||a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"});case"EEEEE":return a.day(t,{width:"narrow",context:"formatting"});case"EEEEEE":return a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"});case"EEEE":default:return a.day(t,{width:"wide",context:"formatting"})||a.day(t,{width:"abbreviated",context:"formatting"})||a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"})}}validate(t,n){return n>=0&&n<=6}set(t,n,a,s){return t=Ju(t,a,s),t.setHours(0,0,0,0),t}}class Vk extends ft{constructor(){super(...arguments);Le(this,"priority",90);Le(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"])}parse(t,n,a,s){const o=c=>{const l=Math.floor((c-1)/7)*7;return(c+s.weekStartsOn+6)%7+l};switch(n){case"e":case"ee":return Wt(Pt(n.length,t),o);case"eo":return Wt(a.ordinalNumber(t,{unit:"day"}),o);case"eee":return a.day(t,{width:"abbreviated",context:"formatting"})||a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"});case"eeeee":return a.day(t,{width:"narrow",context:"formatting"});case"eeeeee":return a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"});case"eeee":default:return a.day(t,{width:"wide",context:"formatting"})||a.day(t,{width:"abbreviated",context:"formatting"})||a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"})}}validate(t,n){return n>=0&&n<=6}set(t,n,a,s){return t=Ju(t,a,s),t.setHours(0,0,0,0),t}}class Wk extends ft{constructor(){super(...arguments);Le(this,"priority",90);Le(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"])}parse(t,n,a,s){const o=c=>{const l=Math.floor((c-1)/7)*7;return(c+s.weekStartsOn+6)%7+l};switch(n){case"c":case"cc":return Wt(Pt(n.length,t),o);case"co":return Wt(a.ordinalNumber(t,{unit:"day"}),o);case"ccc":return a.day(t,{width:"abbreviated",context:"standalone"})||a.day(t,{width:"short",context:"standalone"})||a.day(t,{width:"narrow",context:"standalone"});case"ccccc":return a.day(t,{width:"narrow",context:"standalone"});case"cccccc":return a.day(t,{width:"short",context:"standalone"})||a.day(t,{width:"narrow",context:"standalone"});case"cccc":default:return a.day(t,{width:"wide",context:"standalone"})||a.day(t,{width:"abbreviated",context:"standalone"})||a.day(t,{width:"short",context:"standalone"})||a.day(t,{width:"narrow",context:"standalone"})}}validate(t,n){return n>=0&&n<=6}set(t,n,a,s){return t=Ju(t,a,s),t.setHours(0,0,0,0),t}}function Hk(e,r){const t=Xe(e,r==null?void 0:r.in).getDay();return t===0?7:t}function zk(e,r,t){const n=Xe(e,t==null?void 0:t.in),a=Hk(n,t),s=r-a;return Mc(n,s,t)}class Gk extends ft{constructor(){super(...arguments);Le(this,"priority",90);Le(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"])}parse(t,n,a){const s=o=>o===0?7:o;switch(n){case"i":case"ii":return Pt(n.length,t);case"io":return a.ordinalNumber(t,{unit:"day"});case"iii":return Wt(a.day(t,{width:"abbreviated",context:"formatting"})||a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"}),s);case"iiiii":return Wt(a.day(t,{width:"narrow",context:"formatting"}),s);case"iiiiii":return Wt(a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"}),s);case"iiii":default:return Wt(a.day(t,{width:"wide",context:"formatting"})||a.day(t,{width:"abbreviated",context:"formatting"})||a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"}),s)}}validate(t,n){return n>=1&&n<=7}set(t,n,a){return t=zk(t,a),t.setHours(0,0,0,0),t}}class Yk extends ft{constructor(){super(...arguments);Le(this,"priority",80);Le(this,"incompatibleTokens",["b","B","H","k","t","T"])}parse(t,n,a){switch(n){case"a":case"aa":case"aaa":return a.dayPeriod(t,{width:"abbreviated",context:"formatting"})||a.dayPeriod(t,{width:"narrow",context:"formatting"});case"aaaaa":return a.dayPeriod(t,{width:"narrow",context:"formatting"});case"aaaa":default:return a.dayPeriod(t,{width:"wide",context:"formatting"})||a.dayPeriod(t,{width:"abbreviated",context:"formatting"})||a.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,n,a){return t.setHours(Ku(a),0,0,0),t}}class qk extends ft{constructor(){super(...arguments);Le(this,"priority",80);Le(this,"incompatibleTokens",["a","B","H","k","t","T"])}parse(t,n,a){switch(n){case"b":case"bb":case"bbb":return a.dayPeriod(t,{width:"abbreviated",context:"formatting"})||a.dayPeriod(t,{width:"narrow",context:"formatting"});case"bbbbb":return a.dayPeriod(t,{width:"narrow",context:"formatting"});case"bbbb":default:return a.dayPeriod(t,{width:"wide",context:"formatting"})||a.dayPeriod(t,{width:"abbreviated",context:"formatting"})||a.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,n,a){return t.setHours(Ku(a),0,0,0),t}}class Xk extends ft{constructor(){super(...arguments);Le(this,"priority",80);Le(this,"incompatibleTokens",["a","b","t","T"])}parse(t,n,a){switch(n){case"B":case"BB":case"BBB":return a.dayPeriod(t,{width:"abbreviated",context:"formatting"})||a.dayPeriod(t,{width:"narrow",context:"formatting"});case"BBBBB":return a.dayPeriod(t,{width:"narrow",context:"formatting"});case"BBBB":default:return a.dayPeriod(t,{width:"wide",context:"formatting"})||a.dayPeriod(t,{width:"abbreviated",context:"formatting"})||a.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,n,a){return t.setHours(Ku(a),0,0,0),t}}class Kk extends ft{constructor(){super(...arguments);Le(this,"priority",70);Le(this,"incompatibleTokens",["H","K","k","t","T"])}parse(t,n,a){switch(n){case"h":return Ct(Vt.hour12h,t);case"ho":return a.ordinalNumber(t,{unit:"hour"});default:return Pt(n.length,t)}}validate(t,n){return n>=1&&n<=12}set(t,n,a){const s=t.getHours()>=12;return s&&a<12?t.setHours(a+12,0,0,0):!s&&a===12?t.setHours(0,0,0,0):t.setHours(a,0,0,0),t}}class Jk extends ft{constructor(){super(...arguments);Le(this,"priority",70);Le(this,"incompatibleTokens",["a","b","h","K","k","t","T"])}parse(t,n,a){switch(n){case"H":return Ct(Vt.hour23h,t);case"Ho":return a.ordinalNumber(t,{unit:"hour"});default:return Pt(n.length,t)}}validate(t,n){return n>=0&&n<=23}set(t,n,a){return t.setHours(a,0,0,0),t}}class Qk extends ft{constructor(){super(...arguments);Le(this,"priority",70);Le(this,"incompatibleTokens",["h","H","k","t","T"])}parse(t,n,a){switch(n){case"K":return Ct(Vt.hour11h,t);case"Ko":return a.ordinalNumber(t,{unit:"hour"});default:return Pt(n.length,t)}}validate(t,n){return n>=0&&n<=11}set(t,n,a){return t.getHours()>=12&&a<12?t.setHours(a+12,0,0,0):t.setHours(a,0,0,0),t}}class Zk extends ft{constructor(){super(...arguments);Le(this,"priority",70);Le(this,"incompatibleTokens",["a","b","h","H","K","t","T"])}parse(t,n,a){switch(n){case"k":return Ct(Vt.hour24h,t);case"ko":return a.ordinalNumber(t,{unit:"hour"});default:return Pt(n.length,t)}}validate(t,n){return n>=1&&n<=24}set(t,n,a){const s=a<=24?a%24:a;return t.setHours(s,0,0,0),t}}class eC extends ft{constructor(){super(...arguments);Le(this,"priority",60);Le(this,"incompatibleTokens",["t","T"])}parse(t,n,a){switch(n){case"m":return Ct(Vt.minute,t);case"mo":return a.ordinalNumber(t,{unit:"minute"});default:return Pt(n.length,t)}}validate(t,n){return n>=0&&n<=59}set(t,n,a){return t.setMinutes(a,0,0),t}}class tC extends ft{constructor(){super(...arguments);Le(this,"priority",50);Le(this,"incompatibleTokens",["t","T"])}parse(t,n,a){switch(n){case"s":return Ct(Vt.second,t);case"so":return a.ordinalNumber(t,{unit:"second"});default:return Pt(n.length,t)}}validate(t,n){return n>=0&&n<=59}set(t,n,a){return t.setSeconds(a,0),t}}class rC extends ft{constructor(){super(...arguments);Le(this,"priority",30);Le(this,"incompatibleTokens",["t","T"])}parse(t,n){const a=s=>Math.trunc(s*Math.pow(10,-n.length+3));return Wt(Pt(n.length,t),a)}set(t,n,a){return t.setMilliseconds(a),t}}class nC extends ft{constructor(){super(...arguments);Le(this,"priority",10);Le(this,"incompatibleTokens",["t","T","x"])}parse(t,n){switch(n){case"X":return Nn(Rn.basicOptionalMinutes,t);case"XX":return Nn(Rn.basic,t);case"XXXX":return Nn(Rn.basicOptionalSeconds,t);case"XXXXX":return Nn(Rn.extendedOptionalSeconds,t);case"XXX":default:return Nn(Rn.extended,t)}}set(t,n,a){return n.timestampIsSet?t:wt(t,t.getTime()-Zo(t)-a)}}class aC extends ft{constructor(){super(...arguments);Le(this,"priority",10);Le(this,"incompatibleTokens",["t","T","X"])}parse(t,n){switch(n){case"x":return Nn(Rn.basicOptionalMinutes,t);case"xx":return Nn(Rn.basic,t);case"xxxx":return Nn(Rn.basicOptionalSeconds,t);case"xxxxx":return Nn(Rn.extendedOptionalSeconds,t);case"xxx":default:return Nn(Rn.extended,t)}}set(t,n,a){return n.timestampIsSet?t:wt(t,t.getTime()-Zo(t)-a)}}class sC extends ft{constructor(){super(...arguments);Le(this,"priority",40);Le(this,"incompatibleTokens","*")}parse(t){return bx(t)}set(t,n,a){return[wt(t,a*1e3),{timestampIsSet:!0}]}}class iC extends ft{constructor(){super(...arguments);Le(this,"priority",20);Le(this,"incompatibleTokens","*")}parse(t){return bx(t)}set(t,n,a){return[wt(t,a),{timestampIsSet:!0}]}}const oC={G:new Tk,y:new Ak,Y:new kk,R:new Ck,u:new _k,Q:new Dk,q:new Fk,M:new jk,L:new Ik,w:new Ok,I:new Nk,d:new Bk,D:new $k,E:new Uk,e:new Vk,c:new Wk,i:new Gk,a:new Yk,b:new qk,B:new Xk,h:new Kk,H:new Jk,K:new Qk,k:new Zk,m:new eC,s:new tC,S:new rC,X:new nC,x:new aC,t:new sC,T:new iC},cC=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,lC=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,uC=/^'([^]*?)'?$/,dC=/''/g,fC=/\S/,hC=/[a-zA-Z]/;function pC(e,r,t,n){var g,w,y,v,T,F,A,S;const a=()=>wt((n==null?void 0:n.in)||t,NaN),s=yk(),o=(n==null?void 0:n.locale)??s.locale??Yu,c=(n==null?void 0:n.firstWeekContainsDate)??((w=(g=n==null?void 0:n.locale)==null?void 0:g.options)==null?void 0:w.firstWeekContainsDate)??s.firstWeekContainsDate??((v=(y=s.locale)==null?void 0:y.options)==null?void 0:v.firstWeekContainsDate)??1,l=(n==null?void 0:n.weekStartsOn)??((F=(T=n==null?void 0:n.locale)==null?void 0:T.options)==null?void 0:F.weekStartsOn)??s.weekStartsOn??((S=(A=s.locale)==null?void 0:A.options)==null?void 0:S.weekStartsOn)??0;if(!r)return e?a():Xe(t,n==null?void 0:n.in);const u={firstWeekContainsDate:c,weekStartsOn:l,locale:o},d=[new Ek(n==null?void 0:n.in,t)],f=r.match(lC).map(E=>{const b=E[0];if(b in ec){const k=ec[b];return k(E,o.formatLong)}return E}).join("").match(cC),h=[];for(let E of f){!(n!=null&&n.useAdditionalWeekYearTokens)&&xx(E)&&Kl(E,r,e),!(n!=null&&n.useAdditionalDayOfYearTokens)&&mx(E)&&Kl(E,r,e);const b=E[0],k=oC[b];if(k){const{incompatibleTokens:j}=k;if(Array.isArray(j)){const B=h.find(Q=>j.includes(Q.token)||Q.token===b);if(B)throw new RangeError(`The format string mustn't contain \`${B.fullToken}\` and \`${E}\` at the same time`)}else if(k.incompatibleTokens==="*"&&h.length>0)throw new RangeError(`The format string mustn't contain \`${E}\` and any other token at the same time`);h.push({token:b,fullToken:E});const _=k.run(e,E,o.match,u);if(!_)return a();d.push(_.setter),e=_.rest}else{if(b.match(hC))throw new RangeError("Format string contains an unescaped latin alphabet character `"+b+"`");if(E==="''"?E="'":b==="'"&&(E=mC(E)),e.indexOf(E)===0)e=e.slice(E.length);else return a()}}if(e.length>0&&fC.test(e))return a();const x=d.map(E=>E.priority).sort((E,b)=>b-E).filter((E,b,k)=>k.indexOf(E)===b).map(E=>d.filter(b=>b.priority===E).sort((b,k)=>k.subPriority-b.subPriority)).map(E=>E[0]);let m=Xe(t,n==null?void 0:n.in);if(isNaN(+m))return a();const p={};for(const E of x){if(!E.validate(m,u))return a();const b=E.set(m,p,u);Array.isArray(b)?(m=b[0],Object.assign(p,b[1])):m=b}return m}function mC(e){return e.match(uC)[1].replace(dC,"'")}function xC(e,r,t){const n=Xe(e,t==null?void 0:t.in);return n.setDate(r),n}function gC(e,r,t){const n=Xe(e,t==null?void 0:t.in);return n.setHours(r),n}function yC(e,r,t){const n=Xe(e,t==null?void 0:t.in);return n.setMinutes(r),n}function vC(e,r,t){const n=Xe(e,t==null?void 0:t.in),a=n.getFullYear(),s=n.getDate(),o=wt((t==null?void 0:t.in)||e,0);o.setFullYear(a,r,15),o.setHours(0,0,0,0);const c=yx(o);return n.setMonth(r,Math.min(s,c)),n}function bC(e,r,t){const n=Xe(e,t==null?void 0:t.in);return n.setSeconds(r),n}function wC(e,r,t){const n=Xe(e,t==null?void 0:t.in);return n.setMilliseconds(r),n}function SC(e,r,t){const n=Xe(e,t==null?void 0:t.in);return isNaN(+n)?wt((t==null?void 0:t.in)||e,NaN):(n.setFullYear(r),n)}function EC(e,r){const t=Xe(e,r==null?void 0:r.in);return t.setDate(1),t.setHours(0,0,0,0),t}function TC(e,r){const t=Xe(e,r==null?void 0:r.in),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}function AC(e,r,t){const n=+Xe(e,t==null?void 0:t.in),[a,s]=[+Xe(r.start,t==null?void 0:t.in),+Xe(r.end,t==null?void 0:t.in)].sort((o,c)=>o-c);return n>=a&&n<=s}const kC={y:{sectionType:"year",contentType:"digit",maxLength:4},yy:"year",yyy:{sectionType:"year",contentType:"digit",maxLength:4},yyyy:"year",M:{sectionType:"month",contentType:"digit",maxLength:2},MM:"month",MMMM:{sectionType:"month",contentType:"letter"},MMM:{sectionType:"month",contentType:"letter"},L:{sectionType:"month",contentType:"digit",maxLength:2},LL:"month",LLL:{sectionType:"month",contentType:"letter"},LLLL:{sectionType:"month",contentType:"letter"},d:{sectionType:"day",contentType:"digit",maxLength:2},dd:"day",do:{sectionType:"day",contentType:"digit-with-letter"},E:{sectionType:"weekDay",contentType:"letter"},EE:{sectionType:"weekDay",contentType:"letter"},EEE:{sectionType:"weekDay",contentType:"letter"},EEEE:{sectionType:"weekDay",contentType:"letter"},EEEEE:{sectionType:"weekDay",contentType:"letter"},i:{sectionType:"weekDay",contentType:"digit",maxLength:1},ii:"weekDay",iii:{sectionType:"weekDay",contentType:"letter"},iiii:{sectionType:"weekDay",contentType:"letter"},e:{sectionType:"weekDay",contentType:"digit",maxLength:1},ee:"weekDay",eee:{sectionType:"weekDay",contentType:"letter"},eeee:{sectionType:"weekDay",contentType:"letter"},eeeee:{sectionType:"weekDay",contentType:"letter"},eeeeee:{sectionType:"weekDay",contentType:"letter"},c:{sectionType:"weekDay",contentType:"digit",maxLength:1},cc:"weekDay",ccc:{sectionType:"weekDay",contentType:"letter"},cccc:{sectionType:"weekDay",contentType:"letter"},ccccc:{sectionType:"weekDay",contentType:"letter"},cccccc:{sectionType:"weekDay",contentType:"letter"},a:"meridiem",aa:"meridiem",aaa:"meridiem",H:{sectionType:"hours",contentType:"digit",maxLength:2},HH:"hours",h:{sectionType:"hours",contentType:"digit",maxLength:2},hh:"hours",m:{sectionType:"minutes",contentType:"digit",maxLength:2},mm:"minutes",s:{sectionType:"seconds",contentType:"digit",maxLength:2},ss:"seconds"},CC={year:"yyyy",month:"LLLL",monthShort:"MMM",dayOfMonth:"d",dayOfMonthFull:"do",weekday:"EEEE",weekdayShort:"EEEEEE",hours24h:"HH",hours12h:"hh",meridiem:"aa",minutes:"mm",seconds:"ss",fullDate:"PP",keyboardDate:"P",shortDate:"MMM d",normalDate:"d MMMM",normalDateWithWeekday:"EEE, MMM d",fullTime12h:"hh:mm aa",fullTime24h:"HH:mm",keyboardDateTime12h:"P hh:mm aa",keyboardDateTime24h:"P HH:mm"};class _C{constructor(r){this.isMUIAdapter=!0,this.isTimezoneCompatible=!1,this.lib=void 0,this.locale=void 0,this.formats=void 0,this.formatTokenMap=kC,this.escapedCharacters={start:"'",end:"'"},this.longFormatters=void 0,this.date=o=>typeof o>"u"?new Date:o===null?null:new Date(o),this.getInvalidDate=()=>new Date("Invalid Date"),this.getTimezone=()=>"default",this.setTimezone=o=>o,this.toJsDate=o=>o,this.getCurrentLocaleCode=()=>this.locale.code,this.is12HourCycleInCurrentLocale=()=>/a/.test(this.locale.formatLong.time({width:"short"})),this.expandFormat=o=>{const c=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g;return o.match(c).map(l=>{const u=l[0];if(u==="p"||u==="P"){const d=this.longFormatters[u];return d(l,this.locale.formatLong)}return l}).join("")},this.formatNumber=o=>o,this.getDayOfWeek=o=>o.getDay()+1;const{locale:t,formats:n,longFormatters:a,lib:s}=r;this.locale=t,this.formats=ie({},CC,n),this.longFormatters=a,this.lib=s||"date-fns"}}class DC extends _C{constructor({locale:r,formats:t}={}){super({locale:r??Yu,formats:t,longFormatters:ec}),this.parse=(n,a)=>n===""?null:pC(n,a,new Date,{locale:this.locale}),this.isValid=n=>n==null?!1:gx(n),this.format=(n,a)=>this.formatByString(n,this.formats[a]),this.formatByString=(n,a)=>qs(n,a,{locale:this.locale}),this.isEqual=(n,a)=>n===null&&a===null?!0:n===null||a===null?!1:hk(n,a),this.isSameYear=(n,a)=>mk(n,a),this.isSameMonth=(n,a)=>xk(n,a),this.isSameDay=(n,a)=>pk(n,a),this.isSameHour=(n,a)=>gk(n,a),this.isAfter=(n,a)=>dl(n,a),this.isAfterYear=(n,a)=>dl(n,y0(a)),this.isAfterDay=(n,a)=>dl(n,g0(a)),this.isBefore=(n,a)=>fl(n,a),this.isBeforeYear=(n,a)=>fl(n,this.startOfYear(a)),this.isBeforeDay=(n,a)=>fl(n,this.startOfDay(a)),this.isWithinRange=(n,[a,s])=>AC(n,{start:a,end:s}),this.startOfYear=n=>dx(n),this.startOfMonth=n=>EC(n),this.startOfWeek=n=>ea(n,{locale:this.locale}),this.startOfDay=n=>Wi(n),this.endOfYear=n=>y0(n),this.endOfMonth=n=>TC(n),this.endOfWeek=n=>dA(n,{locale:this.locale}),this.endOfDay=n=>g0(n),this.addYears=(n,a)=>lA(n,a),this.addMonths=(n,a)=>ux(n,a),this.addWeeks=(n,a)=>cA(n,a),this.addDays=(n,a)=>Mc(n,a),this.addHours=(n,a)=>oA(n,a),this.addMinutes=(n,a)=>iA(n,a),this.addSeconds=(n,a)=>sA(n,a),this.getYear=n=>fk(n),this.getMonth=n=>lk(n),this.getDate=n=>ik(n),this.getHours=n=>ok(n),this.getMinutes=n=>ck(n),this.getSeconds=n=>uk(n),this.getMilliseconds=n=>dk(n),this.setYear=(n,a)=>SC(n,a),this.setMonth=(n,a)=>vC(n,a),this.setDate=(n,a)=>xC(n,a),this.setHours=(n,a)=>gC(n,a),this.setMinutes=(n,a)=>yC(n,a),this.setSeconds=(n,a)=>bC(n,a),this.setMilliseconds=(n,a)=>wC(n,a),this.getDaysInMonth=n=>yx(n),this.getWeekArray=n=>{const a=this.startOfWeek(this.startOfMonth(n)),s=this.endOfWeek(this.endOfMonth(n));let o=0,c=a;const l=[];for(;this.isBefore(c,s);){const u=Math.floor(o/7);l[u]=l[u]||[],l[u].push(c),c=this.addDays(c,1),o+=1}return l},this.getWeekNumber=n=>Xu(n,{locale:this.locale}),this.getYearRange=([n,a])=>{const s=this.startOfYear(n),o=this.endOfYear(a),c=[];let l=s;for(;this.isBefore(l,o);)c.push(l),l=this.addYears(l,1);return c}}}var FC=function(r){return jC(r)&&!IC(r)};function jC(e){return!!e&&typeof e=="object"}function IC(e){var r=Object.prototype.toString.call(e);return r==="[object RegExp]"||r==="[object Date]"||RC(e)}var PC=typeof Symbol=="function"&&Symbol.for,OC=PC?Symbol.for("react.element"):60103;function RC(e){return e.$$typeof===OC}function NC(e){return Array.isArray(e)?[]:{}}function rc(e,r){return r.clone!==!1&&r.isMergeableObject(e)?Hi(NC(e),e,r):e}function MC(e,r,t){return e.concat(r).map(function(n){return rc(n,t)})}function LC(e,r,t){var n={};return t.isMergeableObject(e)&&Object.keys(e).forEach(function(a){n[a]=rc(e[a],t)}),Object.keys(r).forEach(function(a){!t.isMergeableObject(r[a])||!e[a]?n[a]=rc(r[a],t):n[a]=Hi(e[a],r[a],t)}),n}function Hi(e,r,t){t=t||{},t.arrayMerge=t.arrayMerge||MC,t.isMergeableObject=t.isMergeableObject||FC;var n=Array.isArray(r),a=Array.isArray(e),s=n===a;return s?n?t.arrayMerge(e,r,t):LC(e,r,t):rc(r,t)}Hi.all=function(r,t){if(!Array.isArray(r))throw new Error("first argument should be an array");return r.reduce(function(n,a){return Hi(n,a,t)},{})};var Jl=Hi,BC=typeof global=="object"&&global&&global.Object===Object&&global;const Ex=BC;var $C=typeof self=="object"&&self&&self.Object===Object&&self,UC=Ex||$C||Function("return this")();const Vn=UC;var VC=Vn.Symbol;const wa=VC;var Tx=Object.prototype,WC=Tx.hasOwnProperty,HC=Tx.toString,gi=wa?wa.toStringTag:void 0;function zC(e){var r=WC.call(e,gi),t=e[gi];try{e[gi]=void 0;var n=!0}catch{}var a=HC.call(e);return n&&(r?e[gi]=t:delete e[gi]),a}var GC=Object.prototype,YC=GC.toString;function qC(e){return YC.call(e)}var XC="[object Null]",KC="[object Undefined]",T0=wa?wa.toStringTag:void 0;function ds(e){return e==null?e===void 0?KC:XC:T0&&T0 in Object(e)?zC(e):qC(e)}function Ax(e,r){return function(t){return e(r(t))}}var JC=Ax(Object.getPrototypeOf,Object);const Qu=JC;function fs(e){return e!=null&&typeof e=="object"}var QC="[object Object]",ZC=Function.prototype,e_=Object.prototype,kx=ZC.toString,t_=e_.hasOwnProperty,r_=kx.call(Object);function A0(e){if(!fs(e)||ds(e)!=QC)return!1;var r=Qu(e);if(r===null)return!0;var t=t_.call(r,"constructor")&&r.constructor;return typeof t=="function"&&t instanceof t&&kx.call(t)==r_}function n_(){this.__data__=[],this.size=0}function Cx(e,r){return e===r||e!==e&&r!==r}function Lc(e,r){for(var t=e.length;t--;)if(Cx(e[t][0],r))return t;return-1}var a_=Array.prototype,s_=a_.splice;function i_(e){var r=this.__data__,t=Lc(r,e);if(t<0)return!1;var n=r.length-1;return t==n?r.pop():s_.call(r,t,1),--this.size,!0}function o_(e){var r=this.__data__,t=Lc(r,e);return t<0?void 0:r[t][1]}function c_(e){return Lc(this.__data__,e)>-1}function l_(e,r){var t=this.__data__,n=Lc(t,e);return n<0?(++this.size,t.push([e,r])):t[n][1]=r,this}function na(e){var r=-1,t=e==null?0:e.length;for(this.clear();++r<t;){var n=e[r];this.set(n[0],n[1])}}na.prototype.clear=n_;na.prototype.delete=i_;na.prototype.get=o_;na.prototype.has=c_;na.prototype.set=l_;function u_(){this.__data__=new na,this.size=0}function d_(e){var r=this.__data__,t=r.delete(e);return this.size=r.size,t}function f_(e){return this.__data__.get(e)}function h_(e){return this.__data__.has(e)}function lo(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}var p_="[object AsyncFunction]",m_="[object Function]",x_="[object GeneratorFunction]",g_="[object Proxy]";function _x(e){if(!lo(e))return!1;var r=ds(e);return r==m_||r==x_||r==p_||r==g_}var y_=Vn["__core-js_shared__"];const hl=y_;var k0=function(){var e=/[^.]+$/.exec(hl&&hl.keys&&hl.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function v_(e){return!!k0&&k0 in e}var b_=Function.prototype,w_=b_.toString;function hs(e){if(e!=null){try{return w_.call(e)}catch{}try{return e+""}catch{}}return""}var S_=/[\\^$.*+?()[\]{}|]/g,E_=/^\[object .+?Constructor\]$/,T_=Function.prototype,A_=Object.prototype,k_=T_.toString,C_=A_.hasOwnProperty,__=RegExp("^"+k_.call(C_).replace(S_,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function D_(e){if(!lo(e)||v_(e))return!1;var r=_x(e)?__:E_;return r.test(hs(e))}function F_(e,r){return e==null?void 0:e[r]}function ps(e,r){var t=F_(e,r);return D_(t)?t:void 0}var j_=ps(Vn,"Map");const zi=j_;var I_=ps(Object,"create");const Gi=I_;function P_(){this.__data__=Gi?Gi(null):{},this.size=0}function O_(e){var r=this.has(e)&&delete this.__data__[e];return this.size-=r?1:0,r}var R_="__lodash_hash_undefined__",N_=Object.prototype,M_=N_.hasOwnProperty;function L_(e){var r=this.__data__;if(Gi){var t=r[e];return t===R_?void 0:t}return M_.call(r,e)?r[e]:void 0}var B_=Object.prototype,$_=B_.hasOwnProperty;function U_(e){var r=this.__data__;return Gi?r[e]!==void 0:$_.call(r,e)}var V_="__lodash_hash_undefined__";function W_(e,r){var t=this.__data__;return this.size+=this.has(e)?0:1,t[e]=Gi&&r===void 0?V_:r,this}function ss(e){var r=-1,t=e==null?0:e.length;for(this.clear();++r<t;){var n=e[r];this.set(n[0],n[1])}}ss.prototype.clear=P_;ss.prototype.delete=O_;ss.prototype.get=L_;ss.prototype.has=U_;ss.prototype.set=W_;function H_(){this.size=0,this.__data__={hash:new ss,map:new(zi||na),string:new ss}}function z_(e){var r=typeof e;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?e!=="__proto__":e===null}function Bc(e,r){var t=e.__data__;return z_(r)?t[typeof r=="string"?"string":"hash"]:t.map}function G_(e){var r=Bc(this,e).delete(e);return this.size-=r?1:0,r}function Y_(e){return Bc(this,e).get(e)}function q_(e){return Bc(this,e).has(e)}function X_(e,r){var t=Bc(this,e),n=t.size;return t.set(e,r),this.size+=t.size==n?0:1,this}function ka(e){var r=-1,t=e==null?0:e.length;for(this.clear();++r<t;){var n=e[r];this.set(n[0],n[1])}}ka.prototype.clear=H_;ka.prototype.delete=G_;ka.prototype.get=Y_;ka.prototype.has=q_;ka.prototype.set=X_;var K_=200;function J_(e,r){var t=this.__data__;if(t instanceof na){var n=t.__data__;if(!zi||n.length<K_-1)return n.push([e,r]),this.size=++t.size,this;t=this.__data__=new ka(n)}return t.set(e,r),this.size=t.size,this}function ri(e){var r=this.__data__=new na(e);this.size=r.size}ri.prototype.clear=u_;ri.prototype.delete=d_;ri.prototype.get=f_;ri.prototype.has=h_;ri.prototype.set=J_;function Q_(e,r){for(var t=-1,n=e==null?0:e.length;++t<n&&r(e[t],t,e)!==!1;);return e}var Z_=function(){try{var e=ps(Object,"defineProperty");return e({},"",{}),e}catch{}}();const C0=Z_;function Dx(e,r,t){r=="__proto__"&&C0?C0(e,r,{configurable:!0,enumerable:!0,value:t,writable:!0}):e[r]=t}var eD=Object.prototype,tD=eD.hasOwnProperty;function Fx(e,r,t){var n=e[r];(!(tD.call(e,r)&&Cx(n,t))||t===void 0&&!(r in e))&&Dx(e,r,t)}function $c(e,r,t,n){var a=!t;t||(t={});for(var s=-1,o=r.length;++s<o;){var c=r[s],l=n?n(t[c],e[c],c,t,e):void 0;l===void 0&&(l=e[c]),a?Dx(t,c,l):Fx(t,c,l)}return t}function rD(e,r){for(var t=-1,n=Array(e);++t<e;)n[t]=r(t);return n}var nD="[object Arguments]";function _0(e){return fs(e)&&ds(e)==nD}var jx=Object.prototype,aD=jx.hasOwnProperty,sD=jx.propertyIsEnumerable,iD=_0(function(){return arguments}())?_0:function(e){return fs(e)&&aD.call(e,"callee")&&!sD.call(e,"callee")};const oD=iD;var cD=Array.isArray;const uo=cD;function lD(){return!1}var Ix=typeof exports=="object"&&exports&&!exports.nodeType&&exports,D0=Ix&&typeof module=="object"&&module&&!module.nodeType&&module,uD=D0&&D0.exports===Ix,F0=uD?Vn.Buffer:void 0,dD=F0?F0.isBuffer:void 0,fD=dD||lD;const Px=fD;var hD=9007199254740991,pD=/^(?:0|[1-9]\d*)$/;function mD(e,r){var t=typeof e;return r=r??hD,!!r&&(t=="number"||t!="symbol"&&pD.test(e))&&e>-1&&e%1==0&&e<r}var xD=9007199254740991;function Ox(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=xD}var gD="[object Arguments]",yD="[object Array]",vD="[object Boolean]",bD="[object Date]",wD="[object Error]",SD="[object Function]",ED="[object Map]",TD="[object Number]",AD="[object Object]",kD="[object RegExp]",CD="[object Set]",_D="[object String]",DD="[object WeakMap]",FD="[object ArrayBuffer]",jD="[object DataView]",ID="[object Float32Array]",PD="[object Float64Array]",OD="[object Int8Array]",RD="[object Int16Array]",ND="[object Int32Array]",MD="[object Uint8Array]",LD="[object Uint8ClampedArray]",BD="[object Uint16Array]",$D="[object Uint32Array]",vt={};vt[ID]=vt[PD]=vt[OD]=vt[RD]=vt[ND]=vt[MD]=vt[LD]=vt[BD]=vt[$D]=!0;vt[gD]=vt[yD]=vt[FD]=vt[vD]=vt[jD]=vt[bD]=vt[wD]=vt[SD]=vt[ED]=vt[TD]=vt[AD]=vt[kD]=vt[CD]=vt[_D]=vt[DD]=!1;function UD(e){return fs(e)&&Ox(e.length)&&!!vt[ds(e)]}function Zu(e){return function(r){return e(r)}}var Rx=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Ai=Rx&&typeof module=="object"&&module&&!module.nodeType&&module,VD=Ai&&Ai.exports===Rx,pl=VD&&Ex.process,WD=function(){try{var e=Ai&&Ai.require&&Ai.require("util").types;return e||pl&&pl.binding&&pl.binding("util")}catch{}}();const Xs=WD;var j0=Xs&&Xs.isTypedArray,HD=j0?Zu(j0):UD;const zD=HD;var GD=Object.prototype,YD=GD.hasOwnProperty;function Nx(e,r){var t=uo(e),n=!t&&oD(e),a=!t&&!n&&Px(e),s=!t&&!n&&!a&&zD(e),o=t||n||a||s,c=o?rD(e.length,String):[],l=c.length;for(var u in e)(r||YD.call(e,u))&&!(o&&(u=="length"||a&&(u=="offset"||u=="parent")||s&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||mD(u,l)))&&c.push(u);return c}var qD=Object.prototype;function ed(e){var r=e&&e.constructor,t=typeof r=="function"&&r.prototype||qD;return e===t}var XD=Ax(Object.keys,Object);const KD=XD;var JD=Object.prototype,QD=JD.hasOwnProperty;function ZD(e){if(!ed(e))return KD(e);var r=[];for(var t in Object(e))QD.call(e,t)&&t!="constructor"&&r.push(t);return r}function Mx(e){return e!=null&&Ox(e.length)&&!_x(e)}function td(e){return Mx(e)?Nx(e):ZD(e)}function eF(e,r){return e&&$c(r,td(r),e)}function tF(e){var r=[];if(e!=null)for(var t in Object(e))r.push(t);return r}var rF=Object.prototype,nF=rF.hasOwnProperty;function aF(e){if(!lo(e))return tF(e);var r=ed(e),t=[];for(var n in e)n=="constructor"&&(r||!nF.call(e,n))||t.push(n);return t}function rd(e){return Mx(e)?Nx(e,!0):aF(e)}function sF(e,r){return e&&$c(r,rd(r),e)}var Lx=typeof exports=="object"&&exports&&!exports.nodeType&&exports,I0=Lx&&typeof module=="object"&&module&&!module.nodeType&&module,iF=I0&&I0.exports===Lx,P0=iF?Vn.Buffer:void 0,O0=P0?P0.allocUnsafe:void 0;function oF(e,r){if(r)return e.slice();var t=e.length,n=O0?O0(t):new e.constructor(t);return e.copy(n),n}function Bx(e,r){var t=-1,n=e.length;for(r||(r=Array(n));++t<n;)r[t]=e[t];return r}function cF(e,r){for(var t=-1,n=e==null?0:e.length,a=0,s=[];++t<n;){var o=e[t];r(o,t,e)&&(s[a++]=o)}return s}function $x(){return[]}var lF=Object.prototype,uF=lF.propertyIsEnumerable,R0=Object.getOwnPropertySymbols,dF=R0?function(e){return e==null?[]:(e=Object(e),cF(R0(e),function(r){return uF.call(e,r)}))}:$x;const nd=dF;function fF(e,r){return $c(e,nd(e),r)}function Ux(e,r){for(var t=-1,n=r.length,a=e.length;++t<n;)e[a+t]=r[t];return e}var hF=Object.getOwnPropertySymbols,pF=hF?function(e){for(var r=[];e;)Ux(r,nd(e)),e=Qu(e);return r}:$x;const Vx=pF;function mF(e,r){return $c(e,Vx(e),r)}function Wx(e,r,t){var n=r(e);return uo(e)?n:Ux(n,t(e))}function xF(e){return Wx(e,td,nd)}function gF(e){return Wx(e,rd,Vx)}var yF=ps(Vn,"DataView");const Ql=yF;var vF=ps(Vn,"Promise");const Zl=vF;var bF=ps(Vn,"Set");const eu=bF;var wF=ps(Vn,"WeakMap");const tu=wF;var N0="[object Map]",SF="[object Object]",M0="[object Promise]",L0="[object Set]",B0="[object WeakMap]",$0="[object DataView]",EF=hs(Ql),TF=hs(zi),AF=hs(Zl),kF=hs(eu),CF=hs(tu),La=ds;(Ql&&La(new Ql(new ArrayBuffer(1)))!=$0||zi&&La(new zi)!=N0||Zl&&La(Zl.resolve())!=M0||eu&&La(new eu)!=L0||tu&&La(new tu)!=B0)&&(La=function(e){var r=ds(e),t=r==SF?e.constructor:void 0,n=t?hs(t):"";if(n)switch(n){case EF:return $0;case TF:return N0;case AF:return M0;case kF:return L0;case CF:return B0}return r});const ad=La;var _F=Object.prototype,DF=_F.hasOwnProperty;function FF(e){var r=e.length,t=new e.constructor(r);return r&&typeof e[0]=="string"&&DF.call(e,"index")&&(t.index=e.index,t.input=e.input),t}var jF=Vn.Uint8Array;const U0=jF;function sd(e){var r=new e.constructor(e.byteLength);return new U0(r).set(new U0(e)),r}function IF(e,r){var t=r?sd(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.byteLength)}var PF=/\w*$/;function OF(e){var r=new e.constructor(e.source,PF.exec(e));return r.lastIndex=e.lastIndex,r}var V0=wa?wa.prototype:void 0,W0=V0?V0.valueOf:void 0;function RF(e){return W0?Object(W0.call(e)):{}}function NF(e,r){var t=r?sd(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.length)}var MF="[object Boolean]",LF="[object Date]",BF="[object Map]",$F="[object Number]",UF="[object RegExp]",VF="[object Set]",WF="[object String]",HF="[object Symbol]",zF="[object ArrayBuffer]",GF="[object DataView]",YF="[object Float32Array]",qF="[object Float64Array]",XF="[object Int8Array]",KF="[object Int16Array]",JF="[object Int32Array]",QF="[object Uint8Array]",ZF="[object Uint8ClampedArray]",ej="[object Uint16Array]",tj="[object Uint32Array]";function rj(e,r,t){var n=e.constructor;switch(r){case zF:return sd(e);case MF:case LF:return new n(+e);case GF:return IF(e,t);case YF:case qF:case XF:case KF:case JF:case QF:case ZF:case ej:case tj:return NF(e,t);case BF:return new n;case $F:case WF:return new n(e);case UF:return OF(e);case VF:return new n;case HF:return RF(e)}}var H0=Object.create,nj=function(){function e(){}return function(r){if(!lo(r))return{};if(H0)return H0(r);e.prototype=r;var t=new e;return e.prototype=void 0,t}}();const aj=nj;function sj(e){return typeof e.constructor=="function"&&!ed(e)?aj(Qu(e)):{}}var ij="[object Map]";function oj(e){return fs(e)&&ad(e)==ij}var z0=Xs&&Xs.isMap,cj=z0?Zu(z0):oj;const lj=cj;var uj="[object Set]";function dj(e){return fs(e)&&ad(e)==uj}var G0=Xs&&Xs.isSet,fj=G0?Zu(G0):dj;const hj=fj;var pj=1,mj=2,xj=4,Hx="[object Arguments]",gj="[object Array]",yj="[object Boolean]",vj="[object Date]",bj="[object Error]",zx="[object Function]",wj="[object GeneratorFunction]",Sj="[object Map]",Ej="[object Number]",Gx="[object Object]",Tj="[object RegExp]",Aj="[object Set]",kj="[object String]",Cj="[object Symbol]",_j="[object WeakMap]",Dj="[object ArrayBuffer]",Fj="[object DataView]",jj="[object Float32Array]",Ij="[object Float64Array]",Pj="[object Int8Array]",Oj="[object Int16Array]",Rj="[object Int32Array]",Nj="[object Uint8Array]",Mj="[object Uint8ClampedArray]",Lj="[object Uint16Array]",Bj="[object Uint32Array]",xt={};xt[Hx]=xt[gj]=xt[Dj]=xt[Fj]=xt[yj]=xt[vj]=xt[jj]=xt[Ij]=xt[Pj]=xt[Oj]=xt[Rj]=xt[Sj]=xt[Ej]=xt[Gx]=xt[Tj]=xt[Aj]=xt[kj]=xt[Cj]=xt[Nj]=xt[Mj]=xt[Lj]=xt[Bj]=!0;xt[bj]=xt[zx]=xt[_j]=!1;function ki(e,r,t,n,a,s){var o,c=r&pj,l=r&mj,u=r&xj;if(t&&(o=a?t(e,n,a,s):t(e)),o!==void 0)return o;if(!lo(e))return e;var d=uo(e);if(d){if(o=FF(e),!c)return Bx(e,o)}else{var f=ad(e),h=f==zx||f==wj;if(Px(e))return oF(e,c);if(f==Gx||f==Hx||h&&!a){if(o=l||h?{}:sj(e),!c)return l?mF(e,sF(o,e)):fF(e,eF(o,e))}else{if(!xt[f])return a?e:{};o=rj(e,f,c)}}s||(s=new ri);var x=s.get(e);if(x)return x;s.set(e,o),hj(e)?e.forEach(function(g){o.add(ki(g,r,t,g,e,s))}):lj(e)&&e.forEach(function(g,w){o.set(w,ki(g,r,t,w,e,s))});var m=u?l?gF:xF:l?rd:td,p=d?void 0:m(e);return Q_(p||e,function(g,w){p&&(w=g,g=e[w]),Fx(o,w,ki(g,r,t,w,e,s))}),o}var $j=1,Uj=4;function To(e){return ki(e,$j|Uj)}var Y0=Array.isArray,q0=Object.keys,Vj=Object.prototype.hasOwnProperty,Wj=typeof Element<"u";function ru(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){var t=Y0(e),n=Y0(r),a,s,o;if(t&&n){if(s=e.length,s!=r.length)return!1;for(a=s;a--!==0;)if(!ru(e[a],r[a]))return!1;return!0}if(t!=n)return!1;var c=e instanceof Date,l=r instanceof Date;if(c!=l)return!1;if(c&&l)return e.getTime()==r.getTime();var u=e instanceof RegExp,d=r instanceof RegExp;if(u!=d)return!1;if(u&&d)return e.toString()==r.toString();var f=q0(e);if(s=f.length,s!==q0(r).length)return!1;for(a=s;a--!==0;)if(!Vj.call(r,f[a]))return!1;if(Wj&&e instanceof Element&&r instanceof Element)return e===r;for(a=s;a--!==0;)if(o=f[a],!(o==="_owner"&&e.$$typeof)&&!ru(e[o],r[o]))return!1;return!0}return e!==e&&r!==r}var Hj=function(r,t){try{return ru(r,t)}catch(n){if(n.message&&n.message.match(/stack|recursion/i)||n.number===-2146828260)return console.warn("Warning: react-fast-compare does not handle circular references.",n.name,n.message),!1;throw n}};const Ba=Rp(Hj);var zj=!0;function Gj(e,r){if(!zj){if(e)return;var t="Warning: "+r;typeof console<"u"&&console.warn(t);try{throw Error(t)}catch{}}}var Yj=4;function X0(e){return ki(e,Yj)}function Yx(e,r){for(var t=-1,n=e==null?0:e.length,a=Array(n);++t<n;)a[t]=r(e[t],t,e);return a}var qj="[object Symbol]";function id(e){return typeof e=="symbol"||fs(e)&&ds(e)==qj}var Xj="Expected a function";function od(e,r){if(typeof e!="function"||r!=null&&typeof r!="function")throw new TypeError(Xj);var t=function(){var n=arguments,a=r?r.apply(this,n):n[0],s=t.cache;if(s.has(a))return s.get(a);var o=e.apply(this,n);return t.cache=s.set(a,o)||s,o};return t.cache=new(od.Cache||ka),t}od.Cache=ka;var Kj=500;function Jj(e){var r=od(e,function(n){return t.size===Kj&&t.clear(),n}),t=r.cache;return r}var Qj=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Zj=/\\(\\)?/g,eI=Jj(function(e){var r=[];return e.charCodeAt(0)===46&&r.push(""),e.replace(Qj,function(t,n,a,s){r.push(a?s.replace(Zj,"$1"):n||t)}),r});const tI=eI;var rI=1/0;function nI(e){if(typeof e=="string"||id(e))return e;var r=e+"";return r=="0"&&1/e==-rI?"-0":r}var aI=1/0,K0=wa?wa.prototype:void 0,J0=K0?K0.toString:void 0;function qx(e){if(typeof e=="string")return e;if(uo(e))return Yx(e,qx)+"";if(id(e))return J0?J0.call(e):"";var r=e+"";return r=="0"&&1/e==-aI?"-0":r}function sI(e){return e==null?"":qx(e)}function Xx(e){return uo(e)?Yx(e,nI):id(e)?[e]:Bx(tI(sI(e)))}function nr(){return nr=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},nr.apply(this,arguments)}function Kx(e,r){if(e==null)return{};var t={},n=Object.keys(e),a,s;for(s=0;s<n.length;s++)a=n[s],!(r.indexOf(a)>=0)&&(t[a]=e[a]);return t}var Uc=C.createContext(void 0);Uc.displayName="FormikContext";Uc.Provider;Uc.Consumer;function iI(){var e=C.useContext(Uc);return e||Gj(!1),e}var mn=function(r){return typeof r=="function"},Vc=function(r){return r!==null&&typeof r=="object"},oI=function(r){return String(Math.floor(Number(r)))===r},ml=function(r){return Object.prototype.toString.call(r)==="[object String]"},xl=function(r){return Vc(r)&&mn(r.then)};function Gr(e,r,t,n){n===void 0&&(n=0);for(var a=Xx(r);e&&n<a.length;)e=e[a[n++]];return n!==a.length&&!e||e===void 0?t:e}function Ha(e,r,t){for(var n=X0(e),a=n,s=0,o=Xx(r);s<o.length-1;s++){var c=o[s],l=Gr(e,o.slice(0,s+1));if(l&&(Vc(l)||Array.isArray(l)))a=a[c]=X0(l);else{var u=o[s+1];a=a[c]=oI(u)&&Number(u)>=0?[]:{}}}return(s===0?e:a)[o[s]]===t?e:(t===void 0?delete a[o[s]]:a[o[s]]=t,s===0&&t===void 0&&delete n[o[s]],n)}function Jx(e,r,t,n){t===void 0&&(t=new WeakMap),n===void 0&&(n={});for(var a=0,s=Object.keys(e);a<s.length;a++){var o=s[a],c=e[o];Vc(c)?t.get(c)||(t.set(c,!0),n[o]=Array.isArray(c)?[]:{},Jx(c,r,t,n[o])):n[o]=r}return n}function cI(e,r){switch(r.type){case"SET_VALUES":return nr({},e,{values:r.payload});case"SET_TOUCHED":return nr({},e,{touched:r.payload});case"SET_ERRORS":return Ba(e.errors,r.payload)?e:nr({},e,{errors:r.payload});case"SET_STATUS":return nr({},e,{status:r.payload});case"SET_ISSUBMITTING":return nr({},e,{isSubmitting:r.payload});case"SET_ISVALIDATING":return nr({},e,{isValidating:r.payload});case"SET_FIELD_VALUE":return nr({},e,{values:Ha(e.values,r.payload.field,r.payload.value)});case"SET_FIELD_TOUCHED":return nr({},e,{touched:Ha(e.touched,r.payload.field,r.payload.value)});case"SET_FIELD_ERROR":return nr({},e,{errors:Ha(e.errors,r.payload.field,r.payload.value)});case"RESET_FORM":return nr({},e,r.payload);case"SET_FORMIK_STATE":return r.payload(e);case"SUBMIT_ATTEMPT":return nr({},e,{touched:Jx(e.values,!0),isSubmitting:!0,submitCount:e.submitCount+1});case"SUBMIT_FAILURE":return nr({},e,{isSubmitting:!1});case"SUBMIT_SUCCESS":return nr({},e,{isSubmitting:!1});default:return e}}var Oa={},Ao={};function lI(e){var r=e.validateOnChange,t=r===void 0?!0:r,n=e.validateOnBlur,a=n===void 0?!0:n,s=e.validateOnMount,o=s===void 0?!1:s,c=e.isInitialValid,l=e.enableReinitialize,u=l===void 0?!1:l,d=e.onSubmit,f=Kx(e,["validateOnChange","validateOnBlur","validateOnMount","isInitialValid","enableReinitialize","onSubmit"]),h=nr({validateOnChange:t,validateOnBlur:a,validateOnMount:o,onSubmit:d},f),x=C.useRef(h.initialValues),m=C.useRef(h.initialErrors||Oa),p=C.useRef(h.initialTouched||Ao),g=C.useRef(h.initialStatus),w=C.useRef(!1),y=C.useRef({});C.useEffect(function(){return w.current=!0,function(){w.current=!1}},[]);var v=C.useState(0),T=v[1],F=C.useRef({values:To(h.initialValues),errors:To(h.initialErrors)||Oa,touched:To(h.initialTouched)||Ao,status:To(h.initialStatus),isSubmitting:!1,isValidating:!1,submitCount:0}),A=F.current,S=C.useCallback(function(M){var ce=F.current;F.current=cI(ce,M),ce!==F.current&&T(function(de){return de+1})},[]),E=C.useCallback(function(M,ce){return new Promise(function(de,Se){var ke=h.validate(M,ce);ke==null?de(Oa):xl(ke)?ke.then(function(Be){de(Be||Oa)},function(Be){Se(Be)}):de(ke)})},[h.validate]),b=C.useCallback(function(M,ce){var de=h.validationSchema,Se=mn(de)?de(ce):de,ke=ce&&Se.validateAt?Se.validateAt(ce,M):dI(M,Se);return new Promise(function(Be,Ve){ke.then(function(){Be(Oa)},function(Fe){Fe.name==="ValidationError"?Be(uI(Fe)):Ve(Fe)})})},[h.validationSchema]),k=C.useCallback(function(M,ce){return new Promise(function(de){return de(y.current[M].validate(ce))})},[]),j=C.useCallback(function(M){var ce=Object.keys(y.current).filter(function(Se){return mn(y.current[Se].validate)}),de=ce.length>0?ce.map(function(Se){return k(Se,Gr(M,Se))}):[Promise.resolve("DO_NOT_DELETE_YOU_WILL_BE_FIRED")];return Promise.all(de).then(function(Se){return Se.reduce(function(ke,Be,Ve){return Be==="DO_NOT_DELETE_YOU_WILL_BE_FIRED"||Be&&(ke=Ha(ke,ce[Ve],Be)),ke},{})})},[k]),_=C.useCallback(function(M){return Promise.all([j(M),h.validationSchema?b(M):{},h.validate?E(M):{}]).then(function(ce){var de=ce[0],Se=ce[1],ke=ce[2],Be=Jl.all([de,Se,ke],{arrayMerge:fI});return Be})},[h.validate,h.validationSchema,j,E,b]),B=Qr(function(M){return M===void 0&&(M=A.values),S({type:"SET_ISVALIDATING",payload:!0}),_(M).then(function(ce){return w.current&&(S({type:"SET_ISVALIDATING",payload:!1}),S({type:"SET_ERRORS",payload:ce})),ce})});C.useEffect(function(){o&&w.current===!0&&Ba(x.current,h.initialValues)&&B(x.current)},[o,B]);var Q=C.useCallback(function(M){var ce=M&&M.values?M.values:x.current,de=M&&M.errors?M.errors:m.current?m.current:h.initialErrors||{},Se=M&&M.touched?M.touched:p.current?p.current:h.initialTouched||{},ke=M&&M.status?M.status:g.current?g.current:h.initialStatus;x.current=ce,m.current=de,p.current=Se,g.current=ke;var Be=function(){S({type:"RESET_FORM",payload:{isSubmitting:!!M&&!!M.isSubmitting,errors:de,touched:Se,status:ke,values:ce,isValidating:!!M&&!!M.isValidating,submitCount:M&&M.submitCount&&typeof M.submitCount=="number"?M.submitCount:0}})};if(h.onReset){var Ve=h.onReset(A.values,re);xl(Ve)?Ve.then(Be):Be()}else Be()},[h.initialErrors,h.initialStatus,h.initialTouched,h.onReset]);C.useEffect(function(){w.current===!0&&!Ba(x.current,h.initialValues)&&u&&(x.current=h.initialValues,Q(),o&&B(x.current))},[u,h.initialValues,Q,o,B]),C.useEffect(function(){u&&w.current===!0&&!Ba(m.current,h.initialErrors)&&(m.current=h.initialErrors||Oa,S({type:"SET_ERRORS",payload:h.initialErrors||Oa}))},[u,h.initialErrors]),C.useEffect(function(){u&&w.current===!0&&!Ba(p.current,h.initialTouched)&&(p.current=h.initialTouched||Ao,S({type:"SET_TOUCHED",payload:h.initialTouched||Ao}))},[u,h.initialTouched]),C.useEffect(function(){u&&w.current===!0&&!Ba(g.current,h.initialStatus)&&(g.current=h.initialStatus,S({type:"SET_STATUS",payload:h.initialStatus}))},[u,h.initialStatus,h.initialTouched]);var Z=Qr(function(M){if(y.current[M]&&mn(y.current[M].validate)){var ce=Gr(A.values,M),de=y.current[M].validate(ce);return xl(de)?(S({type:"SET_ISVALIDATING",payload:!0}),de.then(function(Se){return Se}).then(function(Se){S({type:"SET_FIELD_ERROR",payload:{field:M,value:Se}}),S({type:"SET_ISVALIDATING",payload:!1})})):(S({type:"SET_FIELD_ERROR",payload:{field:M,value:de}}),Promise.resolve(de))}else if(h.validationSchema)return S({type:"SET_ISVALIDATING",payload:!0}),b(A.values,M).then(function(Se){return Se}).then(function(Se){S({type:"SET_FIELD_ERROR",payload:{field:M,value:Gr(Se,M)}}),S({type:"SET_ISVALIDATING",payload:!1})});return Promise.resolve()}),L=C.useCallback(function(M,ce){var de=ce.validate;y.current[M]={validate:de}},[]),q=C.useCallback(function(M){delete y.current[M]},[]),te=Qr(function(M,ce){S({type:"SET_TOUCHED",payload:M});var de=ce===void 0?a:ce;return de?B(A.values):Promise.resolve()}),R=C.useCallback(function(M){S({type:"SET_ERRORS",payload:M})},[]),oe=Qr(function(M,ce){var de=mn(M)?M(A.values):M;S({type:"SET_VALUES",payload:de});var Se=ce===void 0?t:ce;return Se?B(de):Promise.resolve()}),J=C.useCallback(function(M,ce){S({type:"SET_FIELD_ERROR",payload:{field:M,value:ce}})},[]),P=Qr(function(M,ce,de){S({type:"SET_FIELD_VALUE",payload:{field:M,value:ce}});var Se=de===void 0?t:de;return Se?B(Ha(A.values,M,ce)):Promise.resolve()}),V=C.useCallback(function(M,ce){var de=ce,Se=M,ke;if(!ml(M)){M.persist&&M.persist();var Be=M.target?M.target:M.currentTarget,Ve=Be.type,Fe=Be.name,Ie=Be.id,We=Be.value,qe=Be.checked,tt=Be.outerHTML,ut=Be.options,or=Be.multiple;de=ce||Fe||Ie,Se=/number|range/.test(Ve)?(ke=parseFloat(We),isNaN(ke)?"":ke):/checkbox/.test(Ve)?pI(Gr(A.values,de),qe,We):ut&&or?hI(ut):We}de&&P(de,Se)},[P,A.values]),z=Qr(function(M){if(ml(M))return function(ce){return V(ce,M)};V(M)}),G=Qr(function(M,ce,de){ce===void 0&&(ce=!0),S({type:"SET_FIELD_TOUCHED",payload:{field:M,value:ce}});var Se=de===void 0?a:de;return Se?B(A.values):Promise.resolve()}),ne=C.useCallback(function(M,ce){M.persist&&M.persist();var de=M.target,Se=de.name,ke=de.id,Be=de.outerHTML,Ve=ce||Se||ke;G(Ve,!0)},[G]),he=Qr(function(M){if(ml(M))return function(ce){return ne(ce,M)};ne(M)}),se=C.useCallback(function(M){mn(M)?S({type:"SET_FORMIK_STATE",payload:M}):S({type:"SET_FORMIK_STATE",payload:function(){return M}})},[]),ae=C.useCallback(function(M){S({type:"SET_STATUS",payload:M})},[]),K=C.useCallback(function(M){S({type:"SET_ISSUBMITTING",payload:M})},[]),O=Qr(function(){return S({type:"SUBMIT_ATTEMPT"}),B().then(function(M){var ce=M instanceof Error,de=!ce&&Object.keys(M).length===0;if(de){var Se;try{if(Se=le(),Se===void 0)return}catch(ke){throw ke}return Promise.resolve(Se).then(function(ke){return w.current&&S({type:"SUBMIT_SUCCESS"}),ke}).catch(function(ke){if(w.current)throw S({type:"SUBMIT_FAILURE"}),ke})}else if(w.current&&(S({type:"SUBMIT_FAILURE"}),ce))throw M})}),D=Qr(function(M){M&&M.preventDefault&&mn(M.preventDefault)&&M.preventDefault(),M&&M.stopPropagation&&mn(M.stopPropagation)&&M.stopPropagation(),O().catch(function(ce){console.warn("Warning: An unhandled error was caught from submitForm()",ce)})}),re={resetForm:Q,validateForm:B,validateField:Z,setErrors:R,setFieldError:J,setFieldTouched:G,setFieldValue:P,setStatus:ae,setSubmitting:K,setTouched:te,setValues:oe,setFormikState:se,submitForm:O},le=Qr(function(){return d(A.values,re)}),Te=Qr(function(M){M&&M.preventDefault&&mn(M.preventDefault)&&M.preventDefault(),M&&M.stopPropagation&&mn(M.stopPropagation)&&M.stopPropagation(),Q()}),ue=C.useCallback(function(M){return{value:Gr(A.values,M),error:Gr(A.errors,M),touched:!!Gr(A.touched,M),initialValue:Gr(x.current,M),initialTouched:!!Gr(p.current,M),initialError:Gr(m.current,M)}},[A.errors,A.touched,A.values]),we=C.useCallback(function(M){return{setValue:function(de,Se){return P(M,de,Se)},setTouched:function(de,Se){return G(M,de,Se)},setError:function(de){return J(M,de)}}},[P,G,J]),xe=C.useCallback(function(M){var ce=Vc(M),de=ce?M.name:M,Se=Gr(A.values,de),ke={name:de,value:Se,onChange:z,onBlur:he};if(ce){var Be=M.type,Ve=M.value,Fe=M.as,Ie=M.multiple;Be==="checkbox"?Ve===void 0?ke.checked=!!Se:(ke.checked=!!(Array.isArray(Se)&&~Se.indexOf(Ve)),ke.value=Ve):Be==="radio"?(ke.checked=Se===Ve,ke.value=Ve):Fe==="select"&&Ie&&(ke.value=ke.value||[],ke.multiple=!0)}return ke},[he,z,A.values]),Ce=C.useMemo(function(){return!Ba(x.current,A.values)},[x.current,A.values]),Oe=C.useMemo(function(){return typeof c<"u"?Ce?A.errors&&Object.keys(A.errors).length===0:c!==!1&&mn(c)?c(h):c:A.errors&&Object.keys(A.errors).length===0},[c,Ce,A.errors,h]),ze=nr({},A,{initialValues:x.current,initialErrors:m.current,initialTouched:p.current,initialStatus:g.current,handleBlur:he,handleChange:z,handleReset:Te,handleSubmit:D,resetForm:Q,setErrors:R,setFormikState:se,setFieldTouched:G,setFieldValue:P,setFieldError:J,setStatus:ae,setSubmitting:K,setTouched:te,setValues:oe,submitForm:O,validateForm:B,validateField:Z,isValid:Oe,dirty:Ce,unregisterField:q,registerField:L,getFieldProps:xe,getFieldMeta:ue,getFieldHelpers:we,validateOnBlur:a,validateOnChange:t,validateOnMount:o});return ze}function uI(e){var r={};if(e.inner){if(e.inner.length===0)return Ha(r,e.path,e.message);for(var a=e.inner,t=Array.isArray(a),n=0,a=t?a:a[Symbol.iterator]();;){var s;if(t){if(n>=a.length)break;s=a[n++]}else{if(n=a.next(),n.done)break;s=n.value}var o=s;Gr(r,o.path)||(r=Ha(r,o.path,o.message))}}return r}function dI(e,r,t,n){t===void 0&&(t=!1);var a=nu(e);return r[t?"validateSync":"validate"](a,{abortEarly:!1,context:n||a})}function nu(e){var r=Array.isArray(e)?[]:{};for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=String(t);Array.isArray(e[n])===!0?r[n]=e[n].map(function(a){return Array.isArray(a)===!0||A0(a)?nu(a):a!==""?a:void 0}):A0(e[n])?r[n]=nu(e[n]):r[n]=e[n]!==""?e[n]:void 0}return r}function fI(e,r,t){var n=e.slice();return r.forEach(function(s,o){if(typeof n[o]>"u"){var c=t.clone!==!1,l=c&&t.isMergeableObject(s);n[o]=l?Jl(Array.isArray(s)?[]:{},s,t):s}else t.isMergeableObject(s)?n[o]=Jl(e[o],s,t):e.indexOf(s)===-1&&n.push(s)}),n}function hI(e){return Array.from(e).filter(function(r){return r.selected}).map(function(r){return r.value})}function pI(e,r,t){if(typeof e=="boolean")return!!r;var n=[],a=!1,s=-1;if(Array.isArray(e))n=e,s=e.indexOf(t),a=s>=0;else if(!t||t=="true"||t=="false")return!!r;return r&&t&&!a?n.concat(t):a?n.slice(0,s).concat(n.slice(s+1)):n}var mI=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?C.useLayoutEffect:C.useEffect;function Qr(e){var r=C.useRef(e);return mI(function(){r.current=e}),C.useCallback(function(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return r.current.apply(void 0,n)},[])}var xI=C.forwardRef(function(e,r){var t=e.action,n=Kx(e,["action"]),a=t??"#",s=iI(),o=s.handleReset,c=s.handleSubmit;return C.createElement("form",nr({onSubmit:c,ref:r,onReset:o,action:a},n))});xI.displayName="Form";function ms(e){this._maxSize=e,this.clear()}ms.prototype.clear=function(){this._size=0,this._values=Object.create(null)};ms.prototype.get=function(e){return this._values[e]};ms.prototype.set=function(e,r){return this._size>=this._maxSize&&this.clear(),e in this._values||this._size++,this._values[e]=r};var gI=/[^.^\]^[]+|(?=\[\]|\.\.)/g,Qx=/^\d+$/,yI=/^\d/,vI=/[~`!#$%\^&*+=\-\[\]\\';,/{}|\\":<>\?]/g,bI=/^\s*(['"]?)(.*?)(\1)\s*$/,cd=512,Q0=new ms(cd),Z0=new ms(cd),eh=new ms(cd),za={Cache:ms,split:au,normalizePath:gl,setter:function(e){var r=gl(e);return Z0.get(e)||Z0.set(e,function(n,a){for(var s=0,o=r.length,c=n;s<o-1;){var l=r[s];if(l==="__proto__"||l==="constructor"||l==="prototype")return n;c=c[r[s++]]}c[r[s]]=a})},getter:function(e,r){var t=gl(e);return eh.get(e)||eh.set(e,function(a){for(var s=0,o=t.length;s<o;)if(a!=null||!r)a=a[t[s++]];else return;return a})},join:function(e){return e.reduce(function(r,t){return r+(ld(t)||Qx.test(t)?"["+t+"]":(r?".":"")+t)},"")},forEach:function(e,r,t){wI(Array.isArray(e)?e:au(e),r,t)}};function gl(e){return Q0.get(e)||Q0.set(e,au(e).map(function(r){return r.replace(bI,"$2")}))}function au(e){return e.match(gI)||[""]}function wI(e,r,t){var n=e.length,a,s,o,c;for(s=0;s<n;s++)a=e[s],a&&(TI(a)&&(a='"'+a+'"'),c=ld(a),o=!c&&/^\d+$/.test(a),r.call(t,a,c,o,s,e))}function ld(e){return typeof e=="string"&&e&&["'",'"'].indexOf(e.charAt(0))!==-1}function SI(e){return e.match(yI)&&!e.match(Qx)}function EI(e){return vI.test(e)}function TI(e){return!ld(e)&&(SI(e)||EI(e))}const AI=/[A-Z\xc0-\xd6\xd8-\xde]?[a-z\xdf-\xf6\xf8-\xff]+(?:['’](?:d|ll|m|re|s|t|ve))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde]|$)|(?:[A-Z\xc0-\xd6\xd8-\xde]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['’](?:D|LL|M|RE|S|T|VE))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde](?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])|$)|[A-Z\xc0-\xd6\xd8-\xde]?(?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['’](?:d|ll|m|re|s|t|ve))?|[A-Z\xc0-\xd6\xd8-\xde]+(?:['’](?:D|LL|M|RE|S|T|VE))?|\d*(?:1ST|2ND|3RD|(?![123])\dTH)(?=\b|[a-z_])|\d*(?:1st|2nd|3rd|(?![123])\dth)(?=\b|[A-Z_])|\d+|(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?)*/g,Wc=e=>e.match(AI)||[],Hc=e=>e[0].toUpperCase()+e.slice(1),ud=(e,r)=>Wc(e).join(r).toLowerCase(),Zx=e=>Wc(e).reduce((r,t)=>`${r}${r?t[0].toUpperCase()+t.slice(1).toLowerCase():t.toLowerCase()}`,""),kI=e=>Hc(Zx(e)),CI=e=>ud(e,"_"),_I=e=>ud(e,"-"),DI=e=>Hc(ud(e," ")),FI=e=>Wc(e).map(Hc).join(" ");var yl={words:Wc,upperFirst:Hc,camelCase:Zx,pascalCase:kI,snakeCase:CI,kebabCase:_I,sentenceCase:DI,titleCase:FI},dd={exports:{}};dd.exports=function(e){return eg(jI(e),e)};dd.exports.array=eg;function eg(e,r){var t=e.length,n=new Array(t),a={},s=t,o=II(r),c=PI(e);for(r.forEach(function(u){if(!c.has(u[0])||!c.has(u[1]))throw new Error("Unknown node. There is an unknown node in the supplied edges.")});s--;)a[s]||l(e[s],s,new Set);return n;function l(u,d,f){if(f.has(u)){var h;try{h=", node was:"+JSON.stringify(u)}catch{h=""}throw new Error("Cyclic dependency"+h)}if(!c.has(u))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(u));if(!a[d]){a[d]=!0;var x=o.get(u)||new Set;if(x=Array.from(x),d=x.length){f.add(u);do{var m=x[--d];l(m,c.get(m),f)}while(d);f.delete(u)}n[--t]=u}}}function jI(e){for(var r=new Set,t=0,n=e.length;t<n;t++){var a=e[t];r.add(a[0]),r.add(a[1])}return Array.from(r)}function II(e){for(var r=new Map,t=0,n=e.length;t<n;t++){var a=e[t];r.has(a[0])||r.set(a[0],new Set),r.has(a[1])||r.set(a[1],new Set),r.get(a[0]).add(a[1])}return r}function PI(e){for(var r=new Map,t=0,n=e.length;t<n;t++)r.set(e[t],t);return r}var OI=dd.exports;const RI=Rp(OI),NI=Object.prototype.toString,MI=Error.prototype.toString,LI=RegExp.prototype.toString,BI=typeof Symbol<"u"?Symbol.prototype.toString:()=>"",$I=/^Symbol\((.*)\)(.*)$/;function UI(e){return e!=+e?"NaN":e===0&&1/e<0?"-0":""+e}function th(e,r=!1){if(e==null||e===!0||e===!1)return""+e;const t=typeof e;if(t==="number")return UI(e);if(t==="string")return r?`"${e}"`:e;if(t==="function")return"[Function "+(e.name||"anonymous")+"]";if(t==="symbol")return BI.call(e).replace($I,"Symbol($1)");const n=NI.call(e).slice(8,-1);return n==="Date"?isNaN(e.getTime())?""+e:e.toISOString(e):n==="Error"||e instanceof Error?"["+MI.call(e)+"]":n==="RegExp"?LI.call(e):null}function xa(e,r){let t=th(e,r);return t!==null?t:JSON.stringify(e,function(n,a){let s=th(this[n],r);return s!==null?s:a},2)}function tg(e){return e==null?[]:[].concat(e)}let rg,ng,ag,VI=/\$\{\s*(\w+)\s*\}/g;rg=Symbol.toStringTag;class rh{constructor(r,t,n,a){this.name=void 0,this.message=void 0,this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=void 0,this.inner=void 0,this[rg]="Error",this.name="ValidationError",this.value=t,this.path=n,this.type=a,this.errors=[],this.inner=[],tg(r).forEach(s=>{if(Nr.isError(s)){this.errors.push(...s.errors);const o=s.inner.length?s.inner:[s];this.inner.push(...o)}else this.errors.push(s)}),this.message=this.errors.length>1?`${this.errors.length} errors occurred`:this.errors[0]}}ng=Symbol.hasInstance;ag=Symbol.toStringTag;class Nr extends Error{static formatError(r,t){const n=t.label||t.path||"this";return t=Object.assign({},t,{path:n,originalPath:t.path}),typeof r=="string"?r.replace(VI,(a,s)=>xa(t[s])):typeof r=="function"?r(t):r}static isError(r){return r&&r.name==="ValidationError"}constructor(r,t,n,a,s){const o=new rh(r,t,n,a);if(s)return o;super(),this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=[],this.inner=[],this[ag]="Error",this.name=o.name,this.message=o.message,this.type=o.type,this.value=o.value,this.path=o.path,this.errors=o.errors,this.inner=o.inner,Error.captureStackTrace&&Error.captureStackTrace(this,Nr)}static[ng](r){return rh[Symbol.hasInstance](r)||super[Symbol.hasInstance](r)}}let In={default:"${path} is invalid",required:"${path} is a required field",defined:"${path} must be defined",notNull:"${path} cannot be null",oneOf:"${path} must be one of the following values: ${values}",notOneOf:"${path} must not be one of the following values: ${values}",notType:({path:e,type:r,value:t,originalValue:n})=>{const a=n!=null&&n!==t?` (cast from the value \`${xa(n,!0)}\`).`:".";return r!=="mixed"?`${e} must be a \`${r}\` type, but the final value was: \`${xa(t,!0)}\``+a:`${e} must match the configured type. The validated value was: \`${xa(t,!0)}\``+a}},Or={length:"${path} must be exactly ${length} characters",min:"${path} must be at least ${min} characters",max:"${path} must be at most ${max} characters",matches:'${path} must match the following: "${regex}"',email:"${path} must be a valid email",url:"${path} must be a valid URL",uuid:"${path} must be a valid UUID",datetime:"${path} must be a valid ISO date-time",datetime_precision:"${path} must be a valid ISO date-time with a sub-second precision of exactly ${precision} digits",datetime_offset:'${path} must be a valid ISO date-time with UTC "Z" timezone',trim:"${path} must be a trimmed string",lowercase:"${path} must be a lowercase string",uppercase:"${path} must be a upper case string"},oa={min:"${path} must be greater than or equal to ${min}",max:"${path} must be less than or equal to ${max}",lessThan:"${path} must be less than ${less}",moreThan:"${path} must be greater than ${more}",positive:"${path} must be a positive number",negative:"${path} must be a negative number",integer:"${path} must be an integer"},su={min:"${path} field must be later than ${min}",max:"${path} field must be at earlier than ${max}"},WI={isValue:"${path} field must be ${value}"},Ho={noUnknown:"${path} field has unspecified keys: ${unknown}",exact:"${path} object contains unknown properties: ${properties}"},HI={min:"${path} field must have at least ${min} items",max:"${path} field must have less than or equal to ${max} items",length:"${path} must have ${length} items"},zI={notType:e=>{const{path:r,value:t,spec:n}=e,a=n.types.length;if(Array.isArray(t)){if(t.length<a)return`${r} tuple value has too few items, expected a length of ${a} but got ${t.length} for value: \`${xa(t,!0)}\``;if(t.length>a)return`${r} tuple value has too many items, expected a length of ${a} but got ${t.length} for value: \`${xa(t,!0)}\``}return Nr.formatError(In.notType,e)}};Object.assign(Object.create(null),{mixed:In,string:Or,number:oa,date:su,object:Ho,array:HI,boolean:WI,tuple:zI});const fd=e=>e&&e.__isYupSchema__;class nc{static fromOptions(r,t){if(!t.then&&!t.otherwise)throw new TypeError("either `then:` or `otherwise:` is required for `when()` conditions");let{is:n,then:a,otherwise:s}=t,o=typeof n=="function"?n:(...c)=>c.every(l=>l===n);return new nc(r,(c,l)=>{var u;let d=o(...c)?a:s;return(u=d==null?void 0:d(l))!=null?u:l})}constructor(r,t){this.fn=void 0,this.refs=r,this.refs=r,this.fn=t}resolve(r,t){let n=this.refs.map(s=>s.getValue(t==null?void 0:t.value,t==null?void 0:t.parent,t==null?void 0:t.context)),a=this.fn(n,r,t);if(a===void 0||a===r)return r;if(!fd(a))throw new TypeError("conditions must return a schema object");return a.resolve(t)}}const ko={context:"$",value:"."};class xs{constructor(r,t={}){if(this.key=void 0,this.isContext=void 0,this.isValue=void 0,this.isSibling=void 0,this.path=void 0,this.getter=void 0,this.map=void 0,typeof r!="string")throw new TypeError("ref must be a string, got: "+r);if(this.key=r.trim(),r==="")throw new TypeError("ref must be a non-empty string");this.isContext=this.key[0]===ko.context,this.isValue=this.key[0]===ko.value,this.isSibling=!this.isContext&&!this.isValue;let n=this.isContext?ko.context:this.isValue?ko.value:"";this.path=this.key.slice(n.length),this.getter=this.path&&za.getter(this.path,!0),this.map=t.map}getValue(r,t,n){let a=this.isContext?n:this.isValue?r:t;return this.getter&&(a=this.getter(a||{})),this.map&&(a=this.map(a)),a}cast(r,t){return this.getValue(r,t==null?void 0:t.parent,t==null?void 0:t.context)}resolve(){return this}describe(){return{type:"ref",key:this.key}}toString(){return`Ref(${this.key})`}static isRef(r){return r&&r.__isYupRef}}xs.prototype.__isYupRef=!0;const Kn=e=>e==null;function Ds(e){function r({value:t,path:n="",options:a,originalValue:s,schema:o},c,l){const{name:u,test:d,params:f,message:h,skipAbsent:x}=e;let{parent:m,context:p,abortEarly:g=o.spec.abortEarly,disableStackTrace:w=o.spec.disableStackTrace}=a;function y(j){return xs.isRef(j)?j.getValue(t,m,p):j}function v(j={}){const _=Object.assign({value:t,originalValue:s,label:o.spec.label,path:j.path||n,spec:o.spec,disableStackTrace:j.disableStackTrace||w},f,j.params);for(const Q of Object.keys(_))_[Q]=y(_[Q]);const B=new Nr(Nr.formatError(j.message||h,_),t,_.path,j.type||u,_.disableStackTrace);return B.params=_,B}const T=g?c:l;let F={path:n,parent:m,type:u,from:a.from,createError:v,resolve:y,options:a,originalValue:s,schema:o};const A=j=>{Nr.isError(j)?T(j):j?l(null):T(v())},S=j=>{Nr.isError(j)?T(j):c(j)};if(x&&Kn(t))return A(!0);let b;try{var k;if(b=d.call(F,t,F),typeof((k=b)==null?void 0:k.then)=="function"){if(a.sync)throw new Error(`Validation test of type: "${F.type}" returned a Promise during a synchronous validate. This test will finish after the validate call has returned`);return Promise.resolve(b).then(A,S)}}catch(j){S(j);return}A(b)}return r.OPTIONS=e,r}function GI(e,r,t,n=t){let a,s,o;return r?(za.forEach(r,(c,l,u)=>{let d=l?c.slice(1,c.length-1):c;e=e.resolve({context:n,parent:a,value:t});let f=e.type==="tuple",h=u?parseInt(d,10):0;if(e.innerType||f){if(f&&!u)throw new Error(`Yup.reach cannot implicitly index into a tuple type. the path part "${o}" must contain an index to the tuple element, e.g. "${o}[0]"`);if(t&&h>=t.length)throw new Error(`Yup.reach cannot resolve an array item at index: ${c}, in the path: ${r}. because there is no value at that index. `);a=t,t=t&&t[h],e=f?e.spec.types[h]:e.innerType}if(!u){if(!e.fields||!e.fields[d])throw new Error(`The schema does not contain the path: ${r}. (failed at: ${o} which is a type: "${e.type}")`);a=t,t=t&&t[d],e=e.fields[d]}s=d,o=l?"["+c+"]":"."+c}),{schema:e,parent:a,parentPath:s}):{parent:a,parentPath:r,schema:e}}class ac extends Set{describe(){const r=[];for(const t of this.values())r.push(xs.isRef(t)?t.describe():t);return r}resolveAll(r){let t=[];for(const n of this.values())t.push(r(n));return t}clone(){return new ac(this.values())}merge(r,t){const n=this.clone();return r.forEach(a=>n.add(a)),t.forEach(a=>n.delete(a)),n}}function Os(e,r=new Map){if(fd(e)||!e||typeof e!="object")return e;if(r.has(e))return r.get(e);let t;if(e instanceof Date)t=new Date(e.getTime()),r.set(e,t);else if(e instanceof RegExp)t=new RegExp(e),r.set(e,t);else if(Array.isArray(e)){t=new Array(e.length),r.set(e,t);for(let n=0;n<e.length;n++)t[n]=Os(e[n],r)}else if(e instanceof Map){t=new Map,r.set(e,t);for(const[n,a]of e.entries())t.set(n,Os(a,r))}else if(e instanceof Set){t=new Set,r.set(e,t);for(const n of e)t.add(Os(n,r))}else if(e instanceof Object){t={},r.set(e,t);for(const[n,a]of Object.entries(e))t[n]=Os(a,r)}else throw Error(`Unable to clone ${e}`);return t}class kn{constructor(r){this.type=void 0,this.deps=[],this.tests=void 0,this.transforms=void 0,this.conditions=[],this._mutate=void 0,this.internalTests={},this._whitelist=new ac,this._blacklist=new ac,this.exclusiveTests=Object.create(null),this._typeCheck=void 0,this.spec=void 0,this.tests=[],this.transforms=[],this.withMutation(()=>{this.typeError(In.notType)}),this.type=r.type,this._typeCheck=r.check,this.spec=Object.assign({strip:!1,strict:!1,abortEarly:!0,recursive:!0,disableStackTrace:!1,nullable:!1,optional:!0,coerce:!0},r==null?void 0:r.spec),this.withMutation(t=>{t.nonNullable()})}get _type(){return this.type}clone(r){if(this._mutate)return r&&Object.assign(this.spec,r),this;const t=Object.create(Object.getPrototypeOf(this));return t.type=this.type,t._typeCheck=this._typeCheck,t._whitelist=this._whitelist.clone(),t._blacklist=this._blacklist.clone(),t.internalTests=Object.assign({},this.internalTests),t.exclusiveTests=Object.assign({},this.exclusiveTests),t.deps=[...this.deps],t.conditions=[...this.conditions],t.tests=[...this.tests],t.transforms=[...this.transforms],t.spec=Os(Object.assign({},this.spec,r)),t}label(r){let t=this.clone();return t.spec.label=r,t}meta(...r){if(r.length===0)return this.spec.meta;let t=this.clone();return t.spec.meta=Object.assign(t.spec.meta||{},r[0]),t}withMutation(r){let t=this._mutate;this._mutate=!0;let n=r(this);return this._mutate=t,n}concat(r){if(!r||r===this)return this;if(r.type!==this.type&&this.type!=="mixed")throw new TypeError(`You cannot \`concat()\` schema's of different types: ${this.type} and ${r.type}`);let t=this,n=r.clone();const a=Object.assign({},t.spec,n.spec);return n.spec=a,n.internalTests=Object.assign({},t.internalTests,n.internalTests),n._whitelist=t._whitelist.merge(r._whitelist,r._blacklist),n._blacklist=t._blacklist.merge(r._blacklist,r._whitelist),n.tests=t.tests,n.exclusiveTests=t.exclusiveTests,n.withMutation(s=>{r.tests.forEach(o=>{s.test(o.OPTIONS)})}),n.transforms=[...t.transforms,...n.transforms],n}isType(r){return r==null?!!(this.spec.nullable&&r===null||this.spec.optional&&r===void 0):this._typeCheck(r)}resolve(r){let t=this;if(t.conditions.length){let n=t.conditions;t=t.clone(),t.conditions=[],t=n.reduce((a,s)=>s.resolve(a,r),t),t=t.resolve(r)}return t}resolveOptions(r){var t,n,a,s;return Object.assign({},r,{from:r.from||[],strict:(t=r.strict)!=null?t:this.spec.strict,abortEarly:(n=r.abortEarly)!=null?n:this.spec.abortEarly,recursive:(a=r.recursive)!=null?a:this.spec.recursive,disableStackTrace:(s=r.disableStackTrace)!=null?s:this.spec.disableStackTrace})}cast(r,t={}){let n=this.resolve(Object.assign({value:r},t)),a=t.assert==="ignore-optionality",s=n._cast(r,t);if(t.assert!==!1&&!n.isType(s)){if(a&&Kn(s))return s;let o=xa(r),c=xa(s);throw new TypeError(`The value of ${t.path||"field"} could not be cast to a value that satisfies the schema type: "${n.type}". 

attempted value: ${o} 
`+(c!==o?`result of cast: ${c}`:""))}return s}_cast(r,t){let n=r===void 0?r:this.transforms.reduce((a,s)=>s.call(this,a,r,this),r);return n===void 0&&(n=this.getDefault(t)),n}_validate(r,t={},n,a){let{path:s,originalValue:o=r,strict:c=this.spec.strict}=t,l=r;c||(l=this._cast(l,Object.assign({assert:!1},t)));let u=[];for(let d of Object.values(this.internalTests))d&&u.push(d);this.runTests({path:s,value:l,originalValue:o,options:t,tests:u},n,d=>{if(d.length)return a(d,l);this.runTests({path:s,value:l,originalValue:o,options:t,tests:this.tests},n,a)})}runTests(r,t,n){let a=!1,{tests:s,value:o,originalValue:c,path:l,options:u}=r,d=p=>{a||(a=!0,t(p,o))},f=p=>{a||(a=!0,n(p,o))},h=s.length,x=[];if(!h)return f([]);let m={value:o,originalValue:c,path:l,options:u,schema:this};for(let p=0;p<s.length;p++){const g=s[p];g(m,d,function(y){y&&(Array.isArray(y)?x.push(...y):x.push(y)),--h<=0&&f(x)})}}asNestedTest({key:r,index:t,parent:n,parentPath:a,originalParent:s,options:o}){const c=r??t;if(c==null)throw TypeError("Must include `key` or `index` for nested validations");const l=typeof c=="number";let u=n[c];const d=Object.assign({},o,{strict:!0,parent:n,value:u,originalValue:s[c],key:void 0,[l?"index":"key"]:c,path:l||c.includes(".")?`${a||""}[${l?c:`"${c}"`}]`:(a?`${a}.`:"")+r});return(f,h,x)=>this.resolve(d)._validate(u,d,h,x)}validate(r,t){var n;let a=this.resolve(Object.assign({},t,{value:r})),s=(n=t==null?void 0:t.disableStackTrace)!=null?n:a.spec.disableStackTrace;return new Promise((o,c)=>a._validate(r,t,(l,u)=>{Nr.isError(l)&&(l.value=u),c(l)},(l,u)=>{l.length?c(new Nr(l,u,void 0,void 0,s)):o(u)}))}validateSync(r,t){var n;let a=this.resolve(Object.assign({},t,{value:r})),s,o=(n=t==null?void 0:t.disableStackTrace)!=null?n:a.spec.disableStackTrace;return a._validate(r,Object.assign({},t,{sync:!0}),(c,l)=>{throw Nr.isError(c)&&(c.value=l),c},(c,l)=>{if(c.length)throw new Nr(c,r,void 0,void 0,o);s=l}),s}isValid(r,t){return this.validate(r,t).then(()=>!0,n=>{if(Nr.isError(n))return!1;throw n})}isValidSync(r,t){try{return this.validateSync(r,t),!0}catch(n){if(Nr.isError(n))return!1;throw n}}_getDefault(r){let t=this.spec.default;return t==null?t:typeof t=="function"?t.call(this,r):Os(t)}getDefault(r){return this.resolve(r||{})._getDefault(r)}default(r){return arguments.length===0?this._getDefault():this.clone({default:r})}strict(r=!0){return this.clone({strict:r})}nullability(r,t){const n=this.clone({nullable:r});return n.internalTests.nullable=Ds({message:t,name:"nullable",test(a){return a===null?this.schema.spec.nullable:!0}}),n}optionality(r,t){const n=this.clone({optional:r});return n.internalTests.optionality=Ds({message:t,name:"optionality",test(a){return a===void 0?this.schema.spec.optional:!0}}),n}optional(){return this.optionality(!0)}defined(r=In.defined){return this.optionality(!1,r)}nullable(){return this.nullability(!0)}nonNullable(r=In.notNull){return this.nullability(!1,r)}required(r=In.required){return this.clone().withMutation(t=>t.nonNullable(r).defined(r))}notRequired(){return this.clone().withMutation(r=>r.nullable().optional())}transform(r){let t=this.clone();return t.transforms.push(r),t}test(...r){let t;if(r.length===1?typeof r[0]=="function"?t={test:r[0]}:t=r[0]:r.length===2?t={name:r[0],test:r[1]}:t={name:r[0],message:r[1],test:r[2]},t.message===void 0&&(t.message=In.default),typeof t.test!="function")throw new TypeError("`test` is a required parameters");let n=this.clone(),a=Ds(t),s=t.exclusive||t.name&&n.exclusiveTests[t.name]===!0;if(t.exclusive&&!t.name)throw new TypeError("Exclusive tests must provide a unique `name` identifying the test");return t.name&&(n.exclusiveTests[t.name]=!!t.exclusive),n.tests=n.tests.filter(o=>!(o.OPTIONS.name===t.name&&(s||o.OPTIONS.test===a.OPTIONS.test))),n.tests.push(a),n}when(r,t){!Array.isArray(r)&&typeof r!="string"&&(t=r,r=".");let n=this.clone(),a=tg(r).map(s=>new xs(s));return a.forEach(s=>{s.isSibling&&n.deps.push(s.key)}),n.conditions.push(typeof t=="function"?new nc(a,t):nc.fromOptions(a,t)),n}typeError(r){let t=this.clone();return t.internalTests.typeError=Ds({message:r,name:"typeError",skipAbsent:!0,test(n){return this.schema._typeCheck(n)?!0:this.createError({params:{type:this.schema.type}})}}),t}oneOf(r,t=In.oneOf){let n=this.clone();return r.forEach(a=>{n._whitelist.add(a),n._blacklist.delete(a)}),n.internalTests.whiteList=Ds({message:t,name:"oneOf",skipAbsent:!0,test(a){let s=this.schema._whitelist,o=s.resolveAll(this.resolve);return o.includes(a)?!0:this.createError({params:{values:Array.from(s).join(", "),resolved:o}})}}),n}notOneOf(r,t=In.notOneOf){let n=this.clone();return r.forEach(a=>{n._blacklist.add(a),n._whitelist.delete(a)}),n.internalTests.blacklist=Ds({message:t,name:"notOneOf",test(a){let s=this.schema._blacklist,o=s.resolveAll(this.resolve);return o.includes(a)?this.createError({params:{values:Array.from(s).join(", "),resolved:o}}):!0}}),n}strip(r=!0){let t=this.clone();return t.spec.strip=r,t}describe(r){const t=(r?this.resolve(r):this).clone(),{label:n,meta:a,optional:s,nullable:o}=t.spec;return{meta:a,label:n,optional:s,nullable:o,default:t.getDefault(r),type:t.type,oneOf:t._whitelist.describe(),notOneOf:t._blacklist.describe(),tests:t.tests.map(l=>({name:l.OPTIONS.name,params:l.OPTIONS.params})).filter((l,u,d)=>d.findIndex(f=>f.name===l.name)===u)}}}kn.prototype.__isYupSchema__=!0;for(const e of["validate","validateSync"])kn.prototype[`${e}At`]=function(r,t,n={}){const{parent:a,parentPath:s,schema:o}=GI(this,r,t,n.context);return o[e](a&&a[s],Object.assign({},n,{parent:a,path:r}))};for(const e of["equals","is"])kn.prototype[e]=kn.prototype.oneOf;for(const e of["not","nope"])kn.prototype[e]=kn.prototype.notOneOf;const YI=/^(\d{4}|[+-]\d{6})(?:-?(\d{2})(?:-?(\d{2}))?)?(?:[ T]?(\d{2}):?(\d{2})(?::?(\d{2})(?:[,.](\d{1,}))?)?(?:(Z)|([+-])(\d{2})(?::?(\d{2}))?)?)?$/;function qI(e){const r=iu(e);if(!r)return Date.parse?Date.parse(e):Number.NaN;if(r.z===void 0&&r.plusMinus===void 0)return new Date(r.year,r.month,r.day,r.hour,r.minute,r.second,r.millisecond).valueOf();let t=0;return r.z!=="Z"&&r.plusMinus!==void 0&&(t=r.hourOffset*60+r.minuteOffset,r.plusMinus==="+"&&(t=0-t)),Date.UTC(r.year,r.month,r.day,r.hour,r.minute+t,r.second,r.millisecond)}function iu(e){var r,t;const n=YI.exec(e);return n?{year:Yn(n[1]),month:Yn(n[2],1)-1,day:Yn(n[3],1),hour:Yn(n[4]),minute:Yn(n[5]),second:Yn(n[6]),millisecond:n[7]?Yn(n[7].substring(0,3)):0,precision:(r=(t=n[7])==null?void 0:t.length)!=null?r:void 0,z:n[8]||void 0,plusMinus:n[9]||void 0,hourOffset:Yn(n[10]),minuteOffset:Yn(n[11])}:null}function Yn(e,r=0){return Number(e)||r}let XI=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,KI=/^((https?|ftp):)?\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,JI=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,QI="^\\d{4}-\\d{2}-\\d{2}",ZI="\\d{2}:\\d{2}:\\d{2}",eP="(([+-]\\d{2}(:?\\d{2})?)|Z)",tP=new RegExp(`${QI}T${ZI}(\\.\\d+)?${eP}$`),rP=e=>Kn(e)||e===e.trim(),nP={}.toString();function bi(){return new sg}class sg extends kn{constructor(){super({type:"string",check(r){return r instanceof String&&(r=r.valueOf()),typeof r=="string"}}),this.withMutation(()=>{this.transform((r,t,n)=>{if(!n.spec.coerce||n.isType(r)||Array.isArray(r))return r;const a=r!=null&&r.toString?r.toString():r;return a===nP?r:a})})}required(r){return super.required(r).withMutation(t=>t.test({message:r||In.required,name:"required",skipAbsent:!0,test:n=>!!n.length}))}notRequired(){return super.notRequired().withMutation(r=>(r.tests=r.tests.filter(t=>t.OPTIONS.name!=="required"),r))}length(r,t=Or.length){return this.test({message:t,name:"length",exclusive:!0,params:{length:r},skipAbsent:!0,test(n){return n.length===this.resolve(r)}})}min(r,t=Or.min){return this.test({message:t,name:"min",exclusive:!0,params:{min:r},skipAbsent:!0,test(n){return n.length>=this.resolve(r)}})}max(r,t=Or.max){return this.test({name:"max",exclusive:!0,message:t,params:{max:r},skipAbsent:!0,test(n){return n.length<=this.resolve(r)}})}matches(r,t){let n=!1,a,s;return t&&(typeof t=="object"?{excludeEmptyString:n=!1,message:a,name:s}=t:a=t),this.test({name:s||"matches",message:a||Or.matches,params:{regex:r},skipAbsent:!0,test:o=>o===""&&n||o.search(r)!==-1})}email(r=Or.email){return this.matches(XI,{name:"email",message:r,excludeEmptyString:!0})}url(r=Or.url){return this.matches(KI,{name:"url",message:r,excludeEmptyString:!0})}uuid(r=Or.uuid){return this.matches(JI,{name:"uuid",message:r,excludeEmptyString:!1})}datetime(r){let t="",n,a;return r&&(typeof r=="object"?{message:t="",allowOffset:n=!1,precision:a=void 0}=r:t=r),this.matches(tP,{name:"datetime",message:t||Or.datetime,excludeEmptyString:!0}).test({name:"datetime_offset",message:t||Or.datetime_offset,params:{allowOffset:n},skipAbsent:!0,test:s=>{if(!s||n)return!0;const o=iu(s);return o?!!o.z:!1}}).test({name:"datetime_precision",message:t||Or.datetime_precision,params:{precision:a},skipAbsent:!0,test:s=>{if(!s||a==null)return!0;const o=iu(s);return o?o.precision===a:!1}})}ensure(){return this.default("").transform(r=>r===null?"":r)}trim(r=Or.trim){return this.transform(t=>t!=null?t.trim():t).test({message:r,name:"trim",test:rP})}lowercase(r=Or.lowercase){return this.transform(t=>Kn(t)?t:t.toLowerCase()).test({message:r,name:"string_case",exclusive:!0,skipAbsent:!0,test:t=>Kn(t)||t===t.toLowerCase()})}uppercase(r=Or.uppercase){return this.transform(t=>Kn(t)?t:t.toUpperCase()).test({message:r,name:"string_case",exclusive:!0,skipAbsent:!0,test:t=>Kn(t)||t===t.toUpperCase()})}}bi.prototype=sg.prototype;let aP=e=>e!=+e;function ig(){return new og}class og extends kn{constructor(){super({type:"number",check(r){return r instanceof Number&&(r=r.valueOf()),typeof r=="number"&&!aP(r)}}),this.withMutation(()=>{this.transform((r,t,n)=>{if(!n.spec.coerce)return r;let a=r;if(typeof a=="string"){if(a=a.replace(/\s/g,""),a==="")return NaN;a=+a}return n.isType(a)||a===null?a:parseFloat(a)})})}min(r,t=oa.min){return this.test({message:t,name:"min",exclusive:!0,params:{min:r},skipAbsent:!0,test(n){return n>=this.resolve(r)}})}max(r,t=oa.max){return this.test({message:t,name:"max",exclusive:!0,params:{max:r},skipAbsent:!0,test(n){return n<=this.resolve(r)}})}lessThan(r,t=oa.lessThan){return this.test({message:t,name:"max",exclusive:!0,params:{less:r},skipAbsent:!0,test(n){return n<this.resolve(r)}})}moreThan(r,t=oa.moreThan){return this.test({message:t,name:"min",exclusive:!0,params:{more:r},skipAbsent:!0,test(n){return n>this.resolve(r)}})}positive(r=oa.positive){return this.moreThan(0,r)}negative(r=oa.negative){return this.lessThan(0,r)}integer(r=oa.integer){return this.test({name:"integer",message:r,skipAbsent:!0,test:t=>Number.isInteger(t)})}truncate(){return this.transform(r=>Kn(r)?r:r|0)}round(r){var t;let n=["ceil","floor","round","trunc"];if(r=((t=r)==null?void 0:t.toLowerCase())||"round",r==="trunc")return this.truncate();if(n.indexOf(r.toLowerCase())===-1)throw new TypeError("Only valid options for round() are: "+n.join(", "));return this.transform(a=>Kn(a)?a:Math[r](a))}}ig.prototype=og.prototype;let cg=new Date(""),sP=e=>Object.prototype.toString.call(e)==="[object Date]";function hd(){return new fo}class fo extends kn{constructor(){super({type:"date",check(r){return sP(r)&&!isNaN(r.getTime())}}),this.withMutation(()=>{this.transform((r,t,n)=>!n.spec.coerce||n.isType(r)||r===null?r:(r=qI(r),isNaN(r)?fo.INVALID_DATE:new Date(r)))})}prepareParam(r,t){let n;if(xs.isRef(r))n=r;else{let a=this.cast(r);if(!this._typeCheck(a))throw new TypeError(`\`${t}\` must be a Date or a value that can be \`cast()\` to a Date`);n=a}return n}min(r,t=su.min){let n=this.prepareParam(r,"min");return this.test({message:t,name:"min",exclusive:!0,params:{min:r},skipAbsent:!0,test(a){return a>=this.resolve(n)}})}max(r,t=su.max){let n=this.prepareParam(r,"max");return this.test({message:t,name:"max",exclusive:!0,params:{max:r},skipAbsent:!0,test(a){return a<=this.resolve(n)}})}}fo.INVALID_DATE=cg;hd.prototype=fo.prototype;hd.INVALID_DATE=cg;function iP(e,r=[]){let t=[],n=new Set,a=new Set(r.map(([o,c])=>`${o}-${c}`));function s(o,c){let l=za.split(o)[0];n.add(l),a.has(`${c}-${l}`)||t.push([c,l])}for(const o of Object.keys(e)){let c=e[o];n.add(o),xs.isRef(c)&&c.isSibling?s(c.path,o):fd(c)&&"deps"in c&&c.deps.forEach(l=>s(l,o))}return RI.array(Array.from(n),t).reverse()}function nh(e,r){let t=1/0;return e.some((n,a)=>{var s;if((s=r.path)!=null&&s.includes(n))return t=a,!0}),t}function lg(e){return(r,t)=>nh(e,r)-nh(e,t)}const oP=(e,r,t)=>{if(typeof e!="string")return e;let n=e;try{n=JSON.parse(e)}catch{}return t.isType(n)?n:e};function zo(e){if("fields"in e){const r={};for(const[t,n]of Object.entries(e.fields))r[t]=zo(n);return e.setFields(r)}if(e.type==="array"){const r=e.optional();return r.innerType&&(r.innerType=zo(r.innerType)),r}return e.type==="tuple"?e.optional().clone({types:e.spec.types.map(zo)}):"optional"in e?e.optional():e}const cP=(e,r)=>{const t=[...za.normalizePath(r)];if(t.length===1)return t[0]in e;let n=t.pop(),a=za.getter(za.join(t),!0)(e);return!!(a&&n in a)};let ah=e=>Object.prototype.toString.call(e)==="[object Object]";function sh(e,r){let t=Object.keys(e.fields);return Object.keys(r).filter(n=>t.indexOf(n)===-1)}const lP=lg([]);function ug(e){return new dg(e)}class dg extends kn{constructor(r){super({type:"object",check(t){return ah(t)||typeof t=="function"}}),this.fields=Object.create(null),this._sortErrors=lP,this._nodes=[],this._excludedEdges=[],this.withMutation(()=>{r&&this.shape(r)})}_cast(r,t={}){var n;let a=super._cast(r,t);if(a===void 0)return this.getDefault(t);if(!this._typeCheck(a))return a;let s=this.fields,o=(n=t.stripUnknown)!=null?n:this.spec.noUnknown,c=[].concat(this._nodes,Object.keys(a).filter(f=>!this._nodes.includes(f))),l={},u=Object.assign({},t,{parent:l,__validating:t.__validating||!1}),d=!1;for(const f of c){let h=s[f],x=f in a;if(h){let m,p=a[f];u.path=(t.path?`${t.path}.`:"")+f,h=h.resolve({value:p,context:t.context,parent:l});let g=h instanceof kn?h.spec:void 0,w=g==null?void 0:g.strict;if(g!=null&&g.strip){d=d||f in a;continue}m=!t.__validating||!w?h.cast(a[f],u):a[f],m!==void 0&&(l[f]=m)}else x&&!o&&(l[f]=a[f]);(x!==f in l||l[f]!==a[f])&&(d=!0)}return d?l:a}_validate(r,t={},n,a){let{from:s=[],originalValue:o=r,recursive:c=this.spec.recursive}=t;t.from=[{schema:this,value:o},...s],t.__validating=!0,t.originalValue=o,super._validate(r,t,n,(l,u)=>{if(!c||!ah(u)){a(l,u);return}o=o||u;let d=[];for(let f of this._nodes){let h=this.fields[f];!h||xs.isRef(h)||d.push(h.asNestedTest({options:t,key:f,parent:u,parentPath:t.path,originalParent:o}))}this.runTests({tests:d,value:u,originalValue:o,options:t},n,f=>{a(f.sort(this._sortErrors).concat(l),u)})})}clone(r){const t=super.clone(r);return t.fields=Object.assign({},this.fields),t._nodes=this._nodes,t._excludedEdges=this._excludedEdges,t._sortErrors=this._sortErrors,t}concat(r){let t=super.concat(r),n=t.fields;for(let[a,s]of Object.entries(this.fields)){const o=n[a];n[a]=o===void 0?s:o}return t.withMutation(a=>a.setFields(n,[...this._excludedEdges,...r._excludedEdges]))}_getDefault(r){if("default"in this.spec)return super._getDefault(r);if(!this._nodes.length)return;let t={};return this._nodes.forEach(n=>{var a;const s=this.fields[n];let o=r;(a=o)!=null&&a.value&&(o=Object.assign({},o,{parent:o.value,value:o.value[n]})),t[n]=s&&"getDefault"in s?s.getDefault(o):void 0}),t}setFields(r,t){let n=this.clone();return n.fields=r,n._nodes=iP(r,t),n._sortErrors=lg(Object.keys(r)),t&&(n._excludedEdges=t),n}shape(r,t=[]){return this.clone().withMutation(n=>{let a=n._excludedEdges;return t.length&&(Array.isArray(t[0])||(t=[t]),a=[...n._excludedEdges,...t]),n.setFields(Object.assign(n.fields,r),a)})}partial(){const r={};for(const[t,n]of Object.entries(this.fields))r[t]="optional"in n&&n.optional instanceof Function?n.optional():n;return this.setFields(r)}deepPartial(){return zo(this)}pick(r){const t={};for(const n of r)this.fields[n]&&(t[n]=this.fields[n]);return this.setFields(t,this._excludedEdges.filter(([n,a])=>r.includes(n)&&r.includes(a)))}omit(r){const t=[];for(const n of Object.keys(this.fields))r.includes(n)||t.push(n);return this.pick(t)}from(r,t,n){let a=za.getter(r,!0);return this.transform(s=>{if(!s)return s;let o=s;return cP(s,r)&&(o=Object.assign({},s),n||delete o[r],o[t]=a(s)),o})}json(){return this.transform(oP)}exact(r){return this.test({name:"exact",exclusive:!0,message:r||Ho.exact,test(t){if(t==null)return!0;const n=sh(this.schema,t);return n.length===0||this.createError({params:{properties:n.join(", ")}})}})}stripUnknown(){return this.clone({noUnknown:!0})}noUnknown(r=!0,t=Ho.noUnknown){typeof r!="boolean"&&(t=r,r=!0);let n=this.test({name:"noUnknown",exclusive:!0,message:t,test(a){if(a==null)return!0;const s=sh(this.schema,a);return!r||s.length===0||this.createError({params:{unknown:s.join(", ")}})}});return n.spec.noUnknown=r,n}unknown(r=!0,t=Ho.noUnknown){return this.noUnknown(!r,t)}transformKeys(r){return this.transform(t=>{if(!t)return t;const n={};for(const a of Object.keys(t))n[r(a)]=t[a];return n})}camelCase(){return this.transformKeys(yl.camelCase)}snakeCase(){return this.transformKeys(yl.snakeCase)}constantCase(){return this.transformKeys(r=>yl.snakeCase(r).toUpperCase())}describe(r){const t=(r?this.resolve(r):this).clone(),n=super.describe(r);n.fields={};for(const[s,o]of Object.entries(t.fields)){var a;let c=r;(a=c)!=null&&a.value&&(c=Object.assign({},c,{parent:c.value,value:c.value[s]})),n.fields[s]=o.describe(c)}return n}}ug.prototype=dg.prototype;const fg=e=>{var r;if(e.isAxiosError){const t=e;if(!t.response)return"Network error. Please check your connection.";const n=t.response.status,a=(r=t.response.data)==null?void 0:r.message;switch(n){case 400:return a||"Invalid request. Please check your input.";case 401:return"Authentication required. Please log in.";case 403:return"You do not have permission to perform this action.";case 404:return a||"Resource not found.";case 409:return a||"Conflict with existing data.";case 422:return a||"Invalid input data.";case 500:return"Internal server error. Please try again later.";default:return a||"An unexpected error occurred."}}return e instanceof Error?e.message:"An unexpected error occurred."},vl=new Map,uP=5*60*1e3;function Ln(e,r={}){const[t,n]=C.useState(null),[a,s]=C.useState(!0),[o,c]=C.useState(null),{showNotification:l}=ln(),{cacheKey:u,cacheDuration:d=uP,onSuccess:f,onError:h,showErrorNotification:x=!0,dependencies:m=[],skip:p=!1}=r;C.useEffect(()=>{p?s(!1):g()},[...m]);const g=async(v=!1)=>{if(!p){if(u&&!v){const T=vl.get(u);if(T&&Date.now()-T.timestamp<d){n(T.data),s(!1);return}}try{s(!0),c(null);const T=await e();n(T),u&&vl.set(u,{data:T,timestamp:Date.now()}),f==null||f(T)}catch(T){const F=fg(T);c(F),h==null||h(T),x&&l({type:"error",message:F})}finally{s(!1)}}};return C.useEffect(()=>{m.length===0&&!p&&g()},[]),{data:t,loading:a,error:o,refresh:()=>g(!0),refetch:()=>g(!0),clearCache:()=>u&&vl.delete(u)}}function Mr(e,r={}){const[t,n]=C.useState(!1),[a,s]=C.useState(null),{showNotification:o}=ln(),{onSuccess:c,onError:l,showErrorNotification:u=!0}=r;return{mutate:async f=>{try{n(!0),s(null);const h=await e(f);return c==null||c(h),h}catch(h){const x=fg(h);throw s(x),l==null||l(h),u&&o({type:"error",message:x}),h}finally{n(!1)}},loading:t,error:a}}function dP(e,r){const t=()=>wt(r==null?void 0:r.in,NaN),n=(r==null?void 0:r.additionalDigits)??2,a=mP(e);let s;if(a.date){const u=xP(a.date,n);s=gP(u.restDateString,u.year)}if(!s||isNaN(+s))return t();const o=+s;let c=0,l;if(a.time&&(c=yP(a.time),isNaN(c)))return t();if(a.timezone){if(l=vP(a.timezone),isNaN(l))return t()}else{const u=new Date(o+c),d=Xe(0,r==null?void 0:r.in);return d.setFullYear(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()),d.setHours(u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()),d}return Xe(o+c+l,r==null?void 0:r.in)}const Co={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},fP=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,hP=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,pP=/^([+-])(\d{2})(?::?(\d{2}))?$/;function mP(e){const r={},t=e.split(Co.dateTimeDelimiter);let n;if(t.length>2)return r;if(/:/.test(t[0])?n=t[0]:(r.date=t[0],n=t[1],Co.timeZoneDelimiter.test(r.date)&&(r.date=e.split(Co.timeZoneDelimiter)[0],n=e.substr(r.date.length,e.length))),n){const a=Co.timezone.exec(n);a?(r.time=n.replace(a[1],""),r.timezone=a[1]):r.time=n}return r}function xP(e,r){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+r)+"})|(\\d{2}|[+-]\\d{"+(2+r)+"})$)"),n=e.match(t);if(!n)return{year:NaN,restDateString:""};const a=n[1]?parseInt(n[1]):null,s=n[2]?parseInt(n[2]):null;return{year:s===null?a:s*100,restDateString:e.slice((n[1]||n[2]).length)}}function gP(e,r){if(r===null)return new Date(NaN);const t=e.match(fP);if(!t)return new Date(NaN);const n=!!t[4],a=yi(t[1]),s=yi(t[2])-1,o=yi(t[3]),c=yi(t[4]),l=yi(t[5])-1;if(n)return TP(r,c,l)?bP(r,c,l):new Date(NaN);{const u=new Date(0);return!SP(r,s,o)||!EP(r,a)?new Date(NaN):(u.setUTCFullYear(r,s,Math.max(a,o)),u)}}function yi(e){return e?parseInt(e):1}function yP(e){const r=e.match(hP);if(!r)return NaN;const t=bl(r[1]),n=bl(r[2]),a=bl(r[3]);return AP(t,n,a)?t*Nc+n*Rc+a*1e3:NaN}function bl(e){return e&&parseFloat(e.replace(",","."))||0}function vP(e){if(e==="Z")return 0;const r=e.match(pP);if(!r)return 0;const t=r[1]==="+"?-1:1,n=parseInt(r[2]),a=r[3]&&parseInt(r[3])||0;return kP(n,a)?t*(n*Nc+a*Rc):NaN}function bP(e,r,t){const n=new Date(0);n.setUTCFullYear(e,0,4);const a=n.getUTCDay()||7,s=(r-1)*7+t+1-a;return n.setUTCDate(n.getUTCDate()+s),n}const wP=[31,null,31,30,31,30,31,31,30,31,30,31];function hg(e){return e%400===0||e%4===0&&e%100!==0}function SP(e,r,t){return r>=0&&r<=11&&t>=1&&t<=(wP[r]||(hg(e)?29:28))}function EP(e,r){return r>=1&&r<=(hg(e)?366:365)}function TP(e,r,t){return r>=1&&r<=53&&t>=0&&t<=6}function AP(e,r,t){return e===24?r===0&&t===0:t>=0&&t<60&&r>=0&&r<60&&e>=0&&e<25}function kP(e,r){return r>=0&&r<=59}var zr=(e=>(e.CASH="CASH",e.CHEQUE="CHEQUE",e.CHECK="CHECK",e.BANK_TRANSFER="BANK_TRANSFER",e.UPI="UPI",e.CREDIT_CARD="CREDIT_CARD",e.ONLINE="ONLINE",e))(zr||{}),xn=(e=>(e.MONTHLY="MONTHLY",e.QUARTERLY="QUARTERLY",e.HALF_YEARLY="HALF_YEARLY",e.YEARLY="YEARLY",e))(xn||{});const pg=({open:e,studentId:r,onClose:t,onSubmit:n,loading:a,initialData:s})=>{const[o,c]=C.useState((s==null?void 0:s.frequency)||xn.MONTHLY),{data:l,loading:u,error:d,refetch:f}=Ln(()=>r?Bt.getStudentFeeDetails(r):Promise.reject("No student selected"),{dependencies:[r],skip:!r}),{data:h,loading:x}=Ln(()=>r?Bt.getStudentPaymentHistory(r):Promise.reject("No student selected"),{dependencies:[r],skip:!r}),m=(T,F)=>{if(!T)return 0;const A=T.totalFees||T.annualFees||0;switch(F){case xn.MONTHLY:return A/12;case xn.QUARTERLY:return A/4;case xn.HALF_YEARLY:return A/2;case xn.YEARLY:return A;default:return A/12}},g=(()=>{if(!(l!=null&&l.feeStructure)||!h)return{paid:0,remaining:0,totalAnnualFee:0};const T=l.feeStructure.totalFees||l.feeStructure.annualFees||0,F=Array.isArray(h)?h.reduce((S,E)=>S+(E.amount||0),0):0,A=T-F;return{paid:F,remaining:A,totalAnnualFee:T}})(),w=ug({amount:ig().positive("Amount must be positive").required("Amount is required").test("not-exceeding-pending","Amount exceeds remaining fees",function(T){return s!=null&&s.id?!0:T<=g.remaining}),paymentMethod:bi().required("Payment method is required"),paymentDate:hd().required("Payment date is required").max(new Date,"Payment date cannot be in the future"),frequency:bi().required("Payment frequency is required"),reference:bi().when("paymentMethod",{is:T=>T!==zr.CASH,then:T=>T.required("Reference number is required for non-cash payments")}),notes:bi().max(200,"Notes must be less than 200 characters")}),y=lI({initialValues:{amount:(s==null?void 0:s.amount)??m(l==null?void 0:l.feeStructure,o),paymentMethod:(s==null?void 0:s.paymentMethod)??zr.CASH,paymentDate:(s==null?void 0:s.paymentDate)??qs(new Date,"yyyy-MM-dd"),frequency:(s==null?void 0:s.frequency)??xn.MONTHLY,reference:(s==null?void 0:s.reference)??"",notes:(s==null?void 0:s.notes)??""},validationSchema:w,enableReinitialize:!0,onSubmit:T=>{if(r){const F={studentId:r,id:s==null?void 0:s.id,paymentDate:typeof T.paymentDate=="string"?T.paymentDate:qs(T.paymentDate,"yyyy-MM-dd"),amount:T.amount,amountPaid:T.amount,paymentMethod:T.paymentMethod,frequency:T.frequency,reference:T.reference,notes:T.notes,paymentStatus:"PAID",academicYear:new Date().getFullYear().toString(),academicTerm:"CURRENT"};l!=null&&l.studentFeeId&&(F.studentFeeId=l.studentFeeId),n(F)}}});C.useEffect(()=>{if(!(s!=null&&s.id)){const T=m(l==null?void 0:l.feeStructure,y.values.frequency);y.setFieldValue("amount",T)}},[y.values.frequency,l==null?void 0:l.feeStructure]);const v=T=>{const F=T.target.value;c(F),y.setFieldValue("frequency",F)};return i.jsxs(br,{open:e,onClose:t,maxWidth:"md",fullWidth:!0,children:[i.jsxs(Br,{sx:{display:"flex",alignItems:"center",mb:1},children:[i.jsx(yc,{sx:{mr:1}}),s!=null&&s.id?"Edit Payment":"Record New Payment"]}),i.jsxs("form",{onSubmit:y.handleSubmit,children:[i.jsxs(Dr,{children:[d&&i.jsx(on,{message:"Error loading student fees information"}),!u&&l&&i.jsxs(ye,{sx:{mb:3,p:2,bgcolor:"#f8f9fa",borderRadius:1},children:[i.jsx(ee,{variant:"subtitle1",gutterBottom:!0,children:"Fee Status"}),i.jsxs(X,{container:!0,spacing:2,children:[i.jsxs(X,{item:!0,xs:4,children:[i.jsx(ee,{variant:"body2",color:"textSecondary",children:"Total Annual Fee"}),i.jsxs(ee,{variant:"h6",children:["₹",g.totalAnnualFee.toLocaleString()]})]}),i.jsxs(X,{item:!0,xs:4,children:[i.jsx(ee,{variant:"body2",color:"textSecondary",children:"Paid"}),i.jsxs(ee,{variant:"h6",color:"success.main",children:["₹",g.paid.toLocaleString()]})]}),i.jsxs(X,{item:!0,xs:4,children:[i.jsx(ee,{variant:"body2",color:"textSecondary",children:"Remaining"}),i.jsxs(ee,{variant:"h6",color:"error.main",children:["₹",g.remaining.toLocaleString()]})]})]})]}),i.jsxs(X,{container:!0,spacing:3,children:[i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsxs(mt,{fullWidth:!0,error:y.touched.frequency&&!!y.errors.frequency,children:[i.jsx(Tt,{id:"frequency-label",children:"Payment Frequency"}),i.jsxs(gt,{labelId:"frequency-label",id:"frequency",name:"frequency",value:y.values.frequency,onChange:v,label:"Payment Frequency",children:[i.jsx(Ye,{value:xn.MONTHLY,children:"Monthly"}),i.jsx(Ye,{value:xn.QUARTERLY,children:"Quarterly"}),i.jsx(Ye,{value:xn.HALF_YEARLY,children:"Half Yearly"}),i.jsx(Ye,{value:xn.YEARLY,children:"Yearly"})]}),y.touched.frequency&&y.errors.frequency&&i.jsx(Ja,{children:y.errors.frequency})]})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,id:"amount",name:"amount",label:"Amount",type:"number",value:y.values.amount,onChange:y.handleChange,onBlur:y.handleBlur,error:y.touched.amount&&!!y.errors.amount,helperText:y.touched.amount&&y.errors.amount,InputProps:{startAdornment:i.jsx(yn,{position:"start",children:"₹"})}})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsxs(mt,{fullWidth:!0,error:y.touched.paymentMethod&&!!y.errors.paymentMethod,children:[i.jsx(Tt,{id:"payment-method-label",children:"Payment Method"}),i.jsxs(gt,{labelId:"payment-method-label",id:"paymentMethod",name:"paymentMethod",value:y.values.paymentMethod,onChange:y.handleChange,label:"Payment Method",children:[i.jsx(Ye,{value:zr.CASH,children:"Cash"}),i.jsx(Ye,{value:zr.CHEQUE,children:"Cheque"}),i.jsx(Ye,{value:zr.BANK_TRANSFER,children:"Bank Transfer"}),i.jsx(Ye,{value:zr.UPI,children:"UPI"}),i.jsx(Ye,{value:zr.CREDIT_CARD,children:"Credit Card"})]}),y.touched.paymentMethod&&y.errors.paymentMethod&&i.jsx(Ja,{children:y.errors.paymentMethod})]})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(dm,{dateAdapter:DC,children:i.jsx(rA,{label:"Payment Date",value:y.values.paymentDate?typeof y.values.paymentDate=="string"?dP(y.values.paymentDate):y.values.paymentDate:null,onChange:T=>{y.setFieldValue("paymentDate",T)},slotProps:{textField:{fullWidth:!0,error:y.touched.paymentDate&&!!y.errors.paymentDate,helperText:y.touched.paymentDate&&y.errors.paymentDate}}})})}),y.values.paymentMethod!==zr.CASH&&i.jsx(X,{item:!0,xs:12,children:i.jsx(Ae,{fullWidth:!0,id:"reference",name:"reference",label:y.values.paymentMethod===zr.CHEQUE?"Cheque Number":y.values.paymentMethod===zr.BANK_TRANSFER?"Transaction Reference":y.values.paymentMethod===zr.UPI?"UPI Reference ID":y.values.paymentMethod===zr.CREDIT_CARD?"Transaction ID":"Reference Number",value:y.values.reference,onChange:y.handleChange,onBlur:y.handleBlur,error:y.touched.reference&&!!y.errors.reference,helperText:y.touched.reference&&y.errors.reference})}),i.jsx(X,{item:!0,xs:12,children:i.jsx(Ae,{fullWidth:!0,id:"notes",name:"notes",label:"Notes",multiline:!0,rows:2,value:y.values.notes,onChange:y.handleChange,onBlur:y.handleBlur,error:y.touched.notes&&!!y.errors.notes,helperText:y.touched.notes&&y.errors.notes||`${y.values.notes.length}/200 characters`})})]})]}),i.jsxs(_r,{children:[i.jsx(Pe,{onClick:t,children:"Cancel"}),i.jsx(Pe,{type:"submit",variant:"contained",color:"primary",disabled:a||!y.isValid,startIcon:a?i.jsx(sn,{size:20}):i.jsx(Ly,{}),children:s!=null&&s.id?"Update Payment":"Complete Payment"})]})]})]})},On=({title:e,value:r,icon:t,color:n,onClick:a})=>i.jsxs(es,{sx:{height:"100%",display:"flex",flexDirection:"column",cursor:a?"pointer":"default",transition:"transform 0.2s","&:hover":a?{transform:"translateY(-4px)",boxShadow:4}:{}},onClick:a,children:[i.jsxs(ts,{sx:{flexGrow:1},children:[i.jsxs(ye,{sx:{display:"flex",alignItems:"center",mb:2},children:[i.jsx(t,{sx:{color:n}}),i.jsx(ee,{variant:"h6",component:"div",sx:{ml:1},children:e})]}),i.jsx(ee,{variant:"h4",color:n,children:r})]}),a&&i.jsx($y,{children:i.jsx(Pe,{size:"small",endIcon:i.jsx(Uy,{}),children:"View Details"})})]}),CP=()=>{const e=no(),{user:r}=_n(),{showNotification:t}=ln(),[n,a]=C.useState({studentInfo:null,enrolledCourses:[],upcomingAssignments:[],attendance:{present:0,absent:0,late:0,percentage:0},feePaymentSummary:void 0}),[s,o]=C.useState(!0),[c,l]=C.useState(null),[u,d]=C.useState(!1),[f,h]=C.useState(!1),x=async()=>{try{o(!0),l(null);const p=r==null?void 0:r.id;if(!p)throw new Error("User ID not found");const[g,w,y,v]=await Promise.all([De.get(`/students/${p}`),De.get(`/students/${p}/courses`),De.get(`/students/${p}/assignments`),De.get(`/students/${p}/attendance`)]);let T;try{T=await Bt.getPaymentSummaryByStudent(p)}catch(F){console.error("Error loading fee payment summary:",F),T={studentId:p,studentName:(g==null?void 0:g.name)||"",totalDue:25e3,totalPaid:15e3,balance:1e4,paymentStatus:"PARTIALLY_PAID",lastPaymentDate:"2025-04-15",nextDueDate:"2025-05-15"}}a({studentInfo:g||null,enrolledCourses:Array.isArray(w)?w:[],upcomingAssignments:Array.isArray(y)?y:[],attendance:v||{present:0,absent:0,late:0,percentage:0},feePaymentSummary:T})}catch(p){console.error("Error loading student dashboard data:",p),l("Failed to load student data from database. Please ensure the backend server is running."),t({type:"error",message:"Failed to load your dashboard data from database. Please try again later."})}finally{o(!1)}};C.useEffect(()=>{x();const p=setInterval(x,5*60*1e3);return()=>clearInterval(p)},[]);const m=async p=>{try{h(!0),await Bt.createPayment(p),t({type:"success",message:"Payment recorded successfully!"}),d(!1),x()}catch(g){console.error("Error creating payment:",g),t({type:"error",message:"Failed to record payment. Please try again later."})}finally{h(!1)}};return s?i.jsx(an,{message:"Loading your dashboard..."}):c?i.jsx(on,{message:c,onRetry:x}):i.jsxs(ye,{children:[i.jsxs(ee,{variant:"h4",sx:{mb:4},children:["Student Dashboard",r&&i.jsxs(ee,{variant:"subtitle1",color:"text.secondary",children:["Welcome, ",r.name||r.email]})]}),i.jsxs(X,{container:!0,spacing:3,children:[i.jsx(X,{item:!0,xs:12,sm:6,md:3,children:i.jsx(On,{title:"Enrolled Courses",value:n.enrolledCourses.length,icon:Mi,color:"primary.main",onClick:()=>e("/courses")})}),i.jsx(X,{item:!0,xs:12,sm:6,md:3,children:i.jsx(On,{title:"Upcoming Assignments",value:n.upcomingAssignments.length,icon:Go,color:"secondary.main"})}),i.jsx(X,{item:!0,xs:12,sm:6,md:3,children:i.jsx(On,{title:"Attendance Rate",value:`${n.attendance.percentage}%`,icon:By,color:"success.main"})}),i.jsx(X,{item:!0,xs:12,sm:6,md:3,children:i.jsx(On,{title:"GPA",value:"3.5",icon:Qa,color:"info.main"})}),n.feePaymentSummary&&i.jsx(X,{item:!0,xs:12,children:i.jsxs(Ke,{sx:{p:2,mb:3},children:[i.jsxs(ye,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[i.jsxs(ee,{variant:"h6",sx:{display:"flex",alignItems:"center"},children:[i.jsx(Ol,{sx:{mr:1}}),"Fee Payment Summary"]}),i.jsx(Pe,{variant:"contained",color:"primary",onClick:()=>d(!0),startIcon:i.jsx(Ol,{}),disabled:n.feePaymentSummary.balance<=0,children:"Make Payment"})]}),i.jsxs(X,{container:!0,spacing:2,children:[i.jsx(X,{item:!0,xs:12,md:4,children:i.jsxs(ye,{sx:{p:2,textAlign:"center",bgcolor:"#f5f5f5",borderRadius:1},children:[i.jsx(ee,{variant:"body2",color:"text.secondary",children:"Total Fee"}),i.jsxs(ee,{variant:"h5",children:["₹",n.feePaymentSummary.totalDue.toLocaleString()]})]})}),i.jsx(X,{item:!0,xs:12,md:4,children:i.jsxs(ye,{sx:{p:2,textAlign:"center",bgcolor:"#e8f5e9",borderRadius:1},children:[i.jsx(ee,{variant:"body2",color:"text.secondary",children:"Paid Amount"}),i.jsxs(ee,{variant:"h5",color:"success.main",children:["₹",n.feePaymentSummary.totalPaid.toLocaleString()]})]})}),i.jsx(X,{item:!0,xs:12,md:4,children:i.jsxs(ye,{sx:{p:2,textAlign:"center",bgcolor:n.feePaymentSummary.balance>0?"#ffebee":"#e8f5e9",borderRadius:1},children:[i.jsx(ee,{variant:"body2",color:"text.secondary",children:"Balance"}),i.jsxs(ee,{variant:"h5",color:n.feePaymentSummary.balance>0?"error.main":"success.main",children:["₹",n.feePaymentSummary.balance.toLocaleString()]})]})})]}),i.jsxs(ye,{sx:{display:"flex",justifyContent:"space-between",mt:2,alignItems:"center"},children:[i.jsxs(ye,{children:[i.jsxs(ee,{variant:"body2",color:"text.secondary",children:["Status:"," ",i.jsx($t,{label:n.feePaymentSummary.paymentStatus,color:n.feePaymentSummary.paymentStatus==="PAID"?"success":n.feePaymentSummary.paymentStatus==="PARTIALLY_PAID"?"warning":"error",size:"small",sx:{ml:1}})]}),n.feePaymentSummary.lastPaymentDate&&i.jsxs(ee,{variant:"body2",color:"text.secondary",sx:{mt:1},children:["Last Payment:"," ",new Date(n.feePaymentSummary.lastPaymentDate).toLocaleDateString()]})]}),n.feePaymentSummary.nextDueDate&&i.jsxs(ye,{sx:{textAlign:"right"},children:[i.jsx(ee,{variant:"body2",color:"text.secondary",children:"Next Due Date:"}),i.jsx(ee,{variant:"body1",color:"error.main",fontWeight:"bold",children:new Date(n.feePaymentSummary.nextDueDate).toLocaleDateString()})]})]})]})}),i.jsx(X,{item:!0,xs:12,md:6,children:i.jsxs(Ke,{sx:{p:2,height:"100%"},children:[i.jsx(ee,{variant:"h6",gutterBottom:!0,children:"Your Courses"}),i.jsx(qa,{children:n.enrolledCourses.map((p,g)=>i.jsxs(An.Fragment,{children:[g>0&&i.jsx(sr,{}),i.jsxs(Xa,{children:[i.jsx(Ni,{children:i.jsx(Mi,{color:"primary"})}),i.jsx(Ka,{primary:p.name,secondary:i.jsxs(i.Fragment,{children:[p.teacher," • ",p.schedule,p.grade&&i.jsxs(ee,{component:"span",color:"text.secondary",children:[" ","• Grade:"," ",i.jsx(ee,{component:"span",color:"primary.main",fontWeight:"bold",children:p.grade})]})]})})]})]},p.id))}),i.jsx(ye,{sx:{mt:2,display:"flex",justifyContent:"flex-end"},children:i.jsx(Pe,{size:"small",color:"primary",onClick:()=>e("/courses"),children:"View All Courses"})})]})}),i.jsx(X,{item:!0,xs:12,md:6,children:i.jsxs(Ke,{sx:{p:2,height:"100%"},children:[i.jsx(ee,{variant:"h6",gutterBottom:!0,children:"Upcoming Assignments"}),i.jsx(qa,{children:n.upcomingAssignments.map((p,g)=>i.jsxs(An.Fragment,{children:[g>0&&i.jsx(sr,{}),i.jsxs(Xa,{children:[i.jsx(Ni,{children:i.jsx(Go,{color:"secondary"})}),i.jsx(Ka,{primary:p.title,secondary:i.jsxs(i.Fragment,{children:["Due: ",p.dueDate," • ",p.course]})})]})]},p.id))})]})}),i.jsx(X,{item:!0,xs:12,children:i.jsxs(Ke,{sx:{p:2},children:[i.jsx(ee,{variant:"h6",gutterBottom:!0,children:"Attendance Summary"}),i.jsxs(X,{container:!0,spacing:3,sx:{mt:1},children:[i.jsx(X,{item:!0,xs:12,sm:4,children:i.jsxs(ye,{sx:{textAlign:"center",p:2},children:[i.jsx(ee,{variant:"h2",color:"primary.main",children:n.attendance.present}),i.jsx(ee,{variant:"body1",children:"Days Present"})]})}),i.jsx(X,{item:!0,xs:6,sm:4,children:i.jsxs(ye,{sx:{textAlign:"center",p:2},children:[i.jsx(ee,{variant:"h2",color:"error.main",children:n.attendance.absent}),i.jsx(ee,{variant:"body1",children:"Days Absent"})]})}),i.jsx(X,{item:!0,xs:6,sm:4,children:i.jsxs(ye,{sx:{textAlign:"center",p:2},children:[i.jsx(ee,{variant:"h2",color:"warning.main",children:n.attendance.late}),i.jsx(ee,{variant:"body1",children:"Days Late"})]})})]})]})})]}),u&&r&&n.studentInfo&&i.jsx(pg,{open:u,studentId:r.id,onClose:()=>d(!1),onSubmit:m,loading:f})]})},ih=()=>{const e=no(),{showNotification:r}=ln(),[t,n]=C.useState({totalStudents:0,totalTeachers:0,totalCourses:0,activeEnrollments:0,averageClassSize:0,coursesAtCapacity:0,recentActivity:[]}),[a,s]=C.useState(!0),[o,c]=C.useState(null),l=async()=>{try{s(!0),c(null);const[u,d,f]=await Promise.all([Tr.getAll(),Iu.getAll(),Is.getAll()]),h=Array.isArray(u)?u:[],x=Array.isArray(d)?d:[],m=Array.isArray(f)?f:[],p=m.reduce((v,T)=>v+(T.enrolled||0),0),g=m.length>0?p/m.length:0,w=m.filter(v=>(v.enrolled||0)>=(v.capacity||30)).length,y=[...m.slice(0,3).map(v=>({id:v.id,type:"course",description:`Course ${v.name} has ${(v.capacity||30)-(v.enrolled||0)} seats remaining`,timestamp:new Date().toISOString()})),...h.slice(0,3).map(v=>({id:v.id,type:"student",description:`Student ${v.name} - Grade ${v.grade||"N/A"}`,timestamp:new Date(Date.now()-36e5).toISOString()}))].sort((v,T)=>new Date(T.timestamp).getTime()-new Date(v.timestamp).getTime());n({totalStudents:h.length,totalTeachers:x.length,totalCourses:m.length,activeEnrollments:p,averageClassSize:Math.round(g*10)/10,coursesAtCapacity:w,recentActivity:y})}catch(u){console.error("Error loading dashboard stats:",u),c("Failed to load dashboard statistics. Please ensure the backend server is running and the database is properly configured."),r({type:"error",message:"Failed to load dashboard statistics from database. Please check your server connection."})}finally{s(!1)}};return C.useEffect(()=>{l();const u=setInterval(l,5*60*1e3);return()=>clearInterval(u)},[]),a?i.jsx(an,{message:"Loading dashboard statistics..."}):o?i.jsx(on,{message:o,onRetry:l}):i.jsxs(ye,{children:[i.jsx(ee,{variant:"h4",sx:{mb:4},children:"Admin Dashboard"}),i.jsxs(X,{container:!0,spacing:3,children:[i.jsx(X,{item:!0,xs:12,sm:6,md:3,children:i.jsx(On,{title:"Total Students",value:t.totalStudents,icon:Ws,color:"primary.main",onClick:()=>e("/students")})}),i.jsx(X,{item:!0,xs:12,sm:6,md:3,children:i.jsx(On,{title:"Total Teachers",value:t.totalTeachers,icon:Qa,color:"secondary.main",onClick:()=>e("/teachers")})}),i.jsx(X,{item:!0,xs:12,sm:6,md:3,children:i.jsx(On,{title:"Total Courses",value:t.totalCourses,icon:Mi,color:"success.main",onClick:()=>e("/courses")})}),i.jsx(X,{item:!0,xs:12,sm:6,md:3,children:i.jsx(On,{title:"Active Enrollments",value:t.activeEnrollments,icon:bf,color:"info.main"})}),i.jsx(X,{item:!0,xs:12,sm:6,md:3,children:i.jsx(On,{title:"Average Class Size",value:t.averageClassSize,icon:bf,color:"warning.main"})}),i.jsx(X,{item:!0,xs:12,sm:6,md:3,children:i.jsx(On,{title:"Courses at Capacity",value:t.coursesAtCapacity,icon:Cp,color:"error.main",onClick:()=>e("/courses")})}),i.jsx(X,{item:!0,xs:12,children:i.jsxs(Ke,{sx:{p:2,mt:2},children:[i.jsxs(ye,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[i.jsx(ee,{variant:"h6",children:"Recent Activity"}),i.jsx(Pe,{size:"small",startIcon:i.jsx(Za,{}),onClick:l,children:"Refresh"})]}),i.jsx(qa,{children:t.recentActivity.map((u,d)=>i.jsxs(An.Fragment,{children:[d>0&&i.jsx(sr,{}),i.jsxs(Xa,{children:[i.jsxs(Ni,{children:[u.type==="enrollment"&&i.jsx(Ws,{color:"primary"}),u.type==="course"&&i.jsx(Mi,{color:"secondary"}),u.type==="student"&&i.jsx(Qa,{color:"success"}),u.type==="teacher"&&i.jsx(_p,{color:"info"})]}),i.jsx(Ka,{primary:u.description,secondary:new Date(u.timestamp).toLocaleString()})]})]},u.id||d))})]})})]})]})},_P=()=>{const{user:e}=_n();return e&&e.role===Ne.STUDENT?i.jsx(CP,{}):e&&e.role===Ne.TEACHER?i.jsx(ih,{}):e&&(e.role===Ne.ADMIN||e.role===Ne.STAFF)?i.jsx(ih,{}):i.jsxs(ye,{sx:{textAlign:"center",py:5},children:[i.jsx(ee,{variant:"h5",color:"text.secondary",children:"Dashboard not available for your role."}),i.jsx(ee,{variant:"body1",sx:{mt:2},children:"Please contact the system administrator if you believe this is an error."})]})};function zc({columns:e,data:r,defaultRowsPerPage:t=10,rowsPerPageOptions:n=[5,10,25,50],loading:a=!1,onRefresh:s,searchEnabled:o=!0,searchPlaceholder:c="Search...",onSearch:l,initialSortBy:u,renderRowDetail:d,expandableRows:f=!1}){const[h,x]=C.useState(0),[m,p]=C.useState(t),[g,w]=C.useState(""),[y,v]=C.useState(u||null),[T,F]=C.useState("asc"),[A,S]=C.useState({});C.useEffect(()=>{x(0)},[g]);const E=(L,q)=>{x(q)},b=L=>{p(parseInt(L.target.value,10)),x(0)},k=L=>{F(y===L&&T==="asc"?"desc":"asc"),v(L)},j=L=>{const q=L.target.value;w(q),l==null||l(q)},_=L=>{S(q=>({...q,[L]:!q[L]}))},B=r.filter(L=>Object.values(L).some(q=>String(q).toLowerCase().includes(g.toLowerCase()))),Q=y?[...B].sort((L,q)=>{const te=L[y],R=q[y];if(te===R)return 0;if(te==null)return 1;if(R==null)return-1;const oe=te<R?-1:1;return T==="asc"?oe:-oe}):B,Z=Q.slice(h*m,h*m+m);return i.jsxs(Ke,{sx:{width:"100%",overflow:"hidden"},children:[(o||s)&&i.jsxs(ye,{sx:{p:2,display:"flex",gap:2,alignItems:"center"},children:[o&&i.jsx(Ae,{size:"small",placeholder:c,value:g,onChange:j,sx:{minWidth:300},InputProps:{startAdornment:i.jsx(wu,{sx:{mr:1,color:"text.secondary"}})}}),s&&i.jsx(st,{title:"Refresh data",children:i.jsx(Ze,{onClick:s,disabled:a,children:i.jsx(Za,{})})})]}),i.jsx(rs,{children:i.jsxs(ya,{stickyHeader:!0,children:[i.jsx(va,{children:i.jsx(Ut,{children:e.map(L=>i.jsx(Re,{sortDirection:y===L.id?T:!1,children:L.sortable?i.jsx(Vy,{active:y===L.id,direction:y===L.id?T:"asc",onClick:()=>k(L.id),children:L.label}):L.label},L.id))})}),i.jsx(ba,{children:a?i.jsx(Ut,{children:i.jsx(Re,{colSpan:e.length,align:"center",sx:{py:4},children:i.jsx(sn,{})})}):Z.length===0?i.jsx(Ut,{children:i.jsx(Re,{colSpan:e.length,align:"center",sx:{py:4},children:i.jsx(ee,{variant:"body1",color:"text.secondary",children:"No data found"})})}):Z.map((L,q)=>i.jsxs(An.Fragment,{children:[i.jsxs(Ut,{hover:!0,children:[e.map(te=>i.jsx(Re,{children:te.format?te.format(L[te.id],L):L[te.id]},te.id)),f&&d&&i.jsx(Re,{children:i.jsx(Ze,{onClick:()=>_(L.id),children:A[L.id]?"-":"+"})})]}),f&&d&&A[L.id]&&i.jsx(Ut,{children:i.jsx(Re,{colSpan:e.length,children:d(L)})})]},q))})]})}),i.jsx(Dp,{rowsPerPageOptions:n,component:"div",count:Q.length,rowsPerPage:m,page:h,onPageChange:E,onRowsPerPageChange:b})]})}var pd={},DP=_t;Object.defineProperty(pd,"__esModule",{value:!0});var mg=pd.default=void 0,FP=DP(Ft()),jP=i;mg=pd.default=(0,FP.default)((0,jP.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-6h2zm0-8h-2V7h2z"}),"Info");var md={},IP=_t;Object.defineProperty(md,"__esModule",{value:!0});var Xn=md.default=void 0,PP=IP(Ft()),OP=i;Xn=md.default=(0,PP.default)((0,OP.jsx)("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore");const Gc={email:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,studentEmail:/^[^\s@]+@(edu\.com|school\.org)$/,phone:/^\+?[\d\s-]{10,}$/,name:/^[a-zA-Z\s-']{2,}$/,studentId:/^[A-Za-z0-9]{4,}$/,password:/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d@$!%*#?&]{8,}$/,indianMobile:/^\+91\d{10}$/},RP=e=>Gc.email.test(e),NP=e=>Gc.name.test(e),MP=e=>Gc.studentId.test(e),oh=e=>!isNaN(e)&&e>0,LP=(e,r)=>{console.log("Validating student:",e);const t={},n=(r==null?void 0:r.isEdit)||!1;return(!e.name||!NP(e.name))&&(t.name="Please enter a valid name (minimum 2 characters, letters only)"),e.grade||(t.grade="Grade is required"),e.email?RP(e.email)||(t.email="Please enter a valid email address"):t.email="Email address is required",n||(e.studentId?MP(e.studentId)||(t.studentId="Please enter a valid student ID (at least 4 alphanumeric characters)"):t.studentId="Student ID is required"),e.parentPhone?Gc.indianMobile.test(e.parentPhone)||(t.parentPhone="Parent phone must start with +91 followed by 10 digits"):t.parentPhone="Parent phone is required",e.dateOfBirth||(t.dateOfBirth="Date of birth is required"),(!e.address||e.address.trim()==="")&&(t.address="Address is required"),(!e.parentName||e.parentName.trim()==="")&&(t.parentName="Parent/guardian name is required"),e.gender||(t.gender="Gender is required"),console.log("Validation errors:",t),t},BP=e=>{const r={};return(!e.name||e.name.length<3)&&(r.name="Course name must be at least 3 characters"),e.department||(r.department="Department is required"),e.teacherId||(r.teacherId="Teacher is required"),oh(e.credits)||(r.credits="Credits must be a positive number"),oh(e.capacity)||(r.capacity="Capacity must be a positive number"),e.enrolled>e.capacity&&(r.enrolled="Enrolled students cannot exceed capacity"),r},Yc=({open:e,onClose:r,title:t,children:n,onSubmit:a,submitLabel:s="Submit",cancelLabel:o="Cancel",loading:c=!1,maxWidth:l="sm",hideActions:u=!1,fullWidth:d=!0,disableSubmitButton:f=!1})=>i.jsxs(br,{open:e,onClose:c?void 0:r,maxWidth:l,fullWidth:d,children:[i.jsx(Br,{children:i.jsxs(ye,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[i.jsx(ee,{variant:"h6",children:t}),!c&&i.jsx(Ze,{onClick:r,size:"small",children:i.jsx(Fp,{})})]})}),i.jsx(Dr,{dividers:!0,children:n}),!u&&i.jsxs(_r,{children:[i.jsx(Pe,{onClick:r,disabled:c,children:o}),a&&i.jsx(Pe,{onClick:a,variant:"contained",color:"primary",disabled:c||f,children:s})]})]}),$P=["1","2","3","4","5","6","7","8","9","10","11","12"],UP=["A","B","C","D"],VP=["A+","A-","B+","B-","AB+","AB-","O+","O-"],WP=["School Bus","Self"],ch=()=>{const e=new Date;return e.setFullYear(e.getFullYear()-10),e.toISOString().split("T")[0]},HP=({open:e,onClose:r,onSubmit:t,initialData:n,loading:a})=>{var _,B,Q,Z;const[s,o]=C.useState(n||{name:"",studentId:"",grade:"",section:"",dateOfBirth:ch(),gender:"",bloodGroup:"",address:"",email:"",parentName:"",phoneNumber:"",parentPhone:"+91",emergencyContact:"",admissionDate:new Date().toISOString().split("T")[0],status:"ACTIVE",guardianOccupation:"",guardianOfficeAddress:"",aadharNumber:"",udiseNumber:"",houseAlloted:"",guardianAnnualIncome:"",previousSchool:"",tcNumber:"",tcReason:"",tcDate:"",whatsappNumber:"",subjects:"",transportMode:"",busRouteNumber:"",medicalConditions:"",feeStructureId:void 0}),[c,l]=C.useState({}),[u,d]=C.useState("panel1"),[f,h]=C.useState(null),[x,m]=C.useState(!1),[p,g]=C.useState(!1),[w,y]=C.useState([]),[v,T]=C.useState(!1),F=L=>(q,te)=>{d(te?L:!1)},A=async L=>{if(L)try{m(!0);const q=parseInt(L,10),te=await Bt.getFeeStructureByGrade(q);h(te),o(R=>({...R,feeStructureId:te.id})),g(!0)}catch(q){console.error("Error fetching fee structure:",q),h(null)}finally{m(!1)}},S=async()=>{try{T(!0);const L=await Bt.getAllTransportRoutes();y(L||[])}catch(L){console.error("Error fetching transport routes:",L),y([])}finally{T(!1)}},E=L=>{const q=L.target.value;o(te=>({...te,grade:q})),c.grade&&l(te=>({...te,grade:""})),A(q)},b=L=>{const q=L.target.value;if(o(te=>({...te,transportMode:q,busRouteNumber:q==="School Bus"?te.busRouteNumber:""})),q!=="School Bus"&&(f!=null&&f.transportFee)){const te={...f,transportFee:0,totalFees:f.annualFees+f.buildingFees+f.labFees};h(te)}q==="School Bus"&&S()};C.useEffect(()=>{e&&(n?(o(n),n.transportMode==="School Bus"&&n.busRouteNumber&&S().then(()=>{setTimeout(()=>{const L=n.busRouteNumber,q=L!=null?w.find(te=>te.id===parseInt(L.toString())):void 0;if(q&&f){const te={...f,transportFee:q.feeAmount,totalFees:f.annualFees+f.buildingFees+f.labFees+q.feeAmount};h(te)}},500)})):o(L=>({...L,dateOfBirth:ch()})),S())},[e,n]);const k=L=>q=>{let te=q.target.value;L==="parentPhone"&&!te.startsWith("+91")&&(te="+91"+te.replace(/^\+91/g,"")),o(R=>({...R,[L]:te})),c[L]&&l(R=>({...R,[L]:""}))},j=()=>{const L={...s,phoneNumber:s.parentPhone||""};if(new Date(L.dateOfBirth||"")>=new Date){l(J=>({...J,dateOfBirth:"Date of birth must be in the past"}));return}const R=!!(n!=null&&n.id),oe=LP(L,{isEdit:R});if(Object.keys(oe).length>0){l(oe);return}t(L)};return i.jsx(Yc,{open:e,onClose:r,title:n?"Edit Student":"Add New Student",submitLabel:n?"Update":"Submit",onSubmit:j,maxWidth:"md",loading:a,disableSubmitButton:!1,children:i.jsxs(ye,{sx:{width:"100%"},children:[i.jsxs(ca,{expanded:u==="panel1",onChange:F("panel1"),children:[i.jsx(la,{expandIcon:i.jsx(Xn,{}),children:i.jsx(ee,{variant:"subtitle1",children:"Basic Information"})}),i.jsx(ua,{children:i.jsxs(X,{container:!0,spacing:2,children:[i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Name",value:s.name,onChange:k("name"),error:!!c.name,helperText:c.name,required:!0})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Student ID",value:s.studentId,onChange:k("studentId"),error:!!c.studentId,helperText:c.studentId||"Student ID cannot be changed after creation",required:!0,disabled:!!(n!=null&&n.id),InputProps:{endAdornment:!(n!=null&&n.id)&&i.jsx(yn,{position:"end",children:i.jsx(st,{title:"Enter a unique Student ID. This cannot be changed later.",children:i.jsx(Ze,{size:"small",children:i.jsx(mg,{fontSize:"small"})})})})}})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsxs(mt,{fullWidth:!0,error:!!c.grade,children:[i.jsx(Tt,{children:"Grade"}),i.jsx(gt,{value:s.grade,onChange:E,label:"Grade",required:!0,children:$P.map(L=>i.jsxs(Ye,{value:L,children:["Grade ",L]},L))}),c.grade&&i.jsx(Ja,{children:c.grade})]})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsxs(mt,{fullWidth:!0,children:[i.jsx(Tt,{children:"Section"}),i.jsx(gt,{value:s.section,onChange:k("section"),label:"Section",children:UP.map(L=>i.jsxs(Ye,{value:L,children:["Section ",L]},L))})]})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Date of Birth",type:"date",value:s.dateOfBirth,onChange:k("dateOfBirth"),error:!!c.dateOfBirth,helperText:c.dateOfBirth,InputLabelProps:{shrink:!0},required:!0})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsxs(mt,{fullWidth:!0,children:[i.jsx(Tt,{children:"Gender"}),i.jsxs(gt,{value:s.gender,onChange:k("gender"),label:"Gender",required:!0,children:[i.jsx(Ye,{value:"MALE",children:"Male"}),i.jsx(Ye,{value:"FEMALE",children:"Female"}),i.jsx(Ye,{value:"OTHER",children:"Other"})]})]})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsxs(mt,{fullWidth:!0,children:[i.jsx(Tt,{children:"Blood Group"}),i.jsxs(gt,{value:s.bloodGroup,onChange:k("bloodGroup"),label:"Blood Group",children:[i.jsx(Ye,{value:"",children:"Not Specified"}),VP.map(L=>i.jsx(Ye,{value:L,children:L},L))]})]})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"House Alloted",value:s.houseAlloted,onChange:k("houseAlloted")})}),i.jsx(X,{item:!0,xs:12,children:i.jsx(Ae,{fullWidth:!0,label:"Address",multiline:!0,rows:2,value:s.address,onChange:k("address"),error:!!c.address,helperText:c.address,required:!0})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Medical Conditions",value:s.medicalConditions,onChange:k("medicalConditions"),multiline:!0,rows:2})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Email",type:"email",value:s.email,onChange:k("email"),error:!!c.email,helperText:c.email,required:!0})})]})})]}),i.jsxs(ca,{expanded:u==="panel2",onChange:F("panel2"),children:[i.jsx(la,{expandIcon:i.jsx(Xn,{}),children:i.jsx(ee,{variant:"subtitle1",children:"Parent/Guardian Information"})}),i.jsx(ua,{children:i.jsxs(X,{container:!0,spacing:2,children:[i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Parent/Guardian Name",value:s.parentName,onChange:k("parentName"),error:!!c.parentName,helperText:c.parentName,required:!0})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Parent Phone",value:s.parentPhone,onChange:k("parentPhone"),error:!!c.parentPhone,helperText:c.parentPhone||"Must start with +91 followed by 10 digits",required:!0})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Emergency Contact Number",value:s.emergencyContact,onChange:k("emergencyContact"),error:!!c.emergencyContact,helperText:c.emergencyContact})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"WhatsApp Number",value:s.whatsappNumber,onChange:k("whatsappNumber")})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Parent/Guardian Email",type:"email",value:s.parentEmail,onChange:k("parentEmail")})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Guardian Occupation",value:s.guardianOccupation,onChange:k("guardianOccupation")})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Guardian Annual Income",value:s.guardianAnnualIncome,onChange:k("guardianAnnualIncome"),type:"number"})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Guardian Office Address",value:s.guardianOfficeAddress,onChange:k("guardianOfficeAddress"),multiline:!0,rows:2})})]})})]}),i.jsxs(ca,{expanded:u==="panel3",onChange:F("panel3"),children:[i.jsx(la,{expandIcon:i.jsx(Xn,{}),children:i.jsx(ee,{variant:"subtitle1",children:"Identification & Records"})}),i.jsx(ua,{children:i.jsxs(X,{container:!0,spacing:2,children:[i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Aadhar Number",value:s.aadharNumber,onChange:k("aadharNumber")})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"UDISE Number",value:s.udiseNumber,onChange:k("udiseNumber")})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Previous School",value:s.previousSchool,onChange:k("previousSchool")})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Subjects",value:s.subjects,onChange:k("subjects"),multiline:!0,rows:2,placeholder:"Comma separated list of subjects"})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Admission Date",type:"date",value:s.admissionDate,onChange:k("admissionDate"),InputLabelProps:{shrink:!0}})})]})})]}),i.jsxs(ca,{expanded:u==="panel4",onChange:F("panel4"),children:[i.jsx(la,{expandIcon:i.jsx(Xn,{}),children:i.jsx(ee,{variant:"subtitle1",children:"Transfer Certificate Details"})}),i.jsx(ua,{children:i.jsxs(X,{container:!0,spacing:2,children:[i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"TC Number",value:s.tcNumber,onChange:k("tcNumber")})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"TC Date",type:"date",value:s.tcDate,onChange:k("tcDate"),InputLabelProps:{shrink:!0}})}),i.jsx(X,{item:!0,xs:12,children:i.jsx(Ae,{fullWidth:!0,label:"TC Reason",value:s.tcReason,onChange:k("tcReason"),multiline:!0,rows:2})})]})})]}),"        ",i.jsxs(ca,{expanded:p||u==="panel5",onChange:F("panel5"),children:[i.jsxs(la,{expandIcon:i.jsx(Xn,{}),children:[i.jsx(ee,{variant:"subtitle1",children:"Fee Details"}),x&&i.jsx(sn,{size:20,sx:{ml:2}})]}),i.jsx(ua,{children:x?i.jsx(ye,{display:"flex",justifyContent:"center",p:2,children:i.jsx(sn,{})}):f?i.jsxs(ye,{children:[i.jsxs(ee,{variant:"subtitle2",gutterBottom:!0,children:["Fee Structure for Grade ",f.classGrade]}),i.jsxs(X,{container:!0,spacing:2,children:[i.jsx(X,{item:!0,xs:12,md:6,children:i.jsxs(Ke,{variant:"outlined",sx:{p:2},children:[i.jsx(ee,{variant:"body2",color:"text.secondary",children:"Annual Fees:"}),i.jsxs(ee,{variant:"body1",children:["₹",(_=f.annualFees)==null?void 0:_.toFixed(2)]}),i.jsx(ee,{variant:"body2",color:"text.secondary",mt:1,children:"Building Fees:"}),i.jsxs(ee,{variant:"body1",children:["₹",(B=f.buildingFees)==null?void 0:B.toFixed(2)]}),i.jsx(ee,{variant:"body2",color:"text.secondary",mt:1,children:"Lab Fees:"}),i.jsxs(ee,{variant:"body1",children:["₹",(Q=f.labFees)==null?void 0:Q.toFixed(2)]}),i.jsx(ee,{variant:"body2",color:"text.secondary",mt:1,children:"Transport Fees:"}),i.jsx(ee,{variant:"body1",children:f.transportFee?`₹${f.transportFee.toFixed(2)}`:"₹0.00"}),i.jsx(sr,{sx:{my:1}}),i.jsx(ee,{variant:"body2",color:"text.secondary",fontWeight:"bold",children:"Total Fees:"}),i.jsxs(ee,{variant:"body1",fontWeight:"bold",children:["₹",(Z=f.totalFees||f.annualFees+f.buildingFees+f.labFees+(f.transportFee||0))==null?void 0:Z.toFixed(2)]})]})}),f.paymentSchedules&&f.paymentSchedules.length>0&&i.jsx(X,{item:!0,xs:12,md:6,children:i.jsxs(Ke,{variant:"outlined",sx:{p:2},children:[i.jsx(ee,{variant:"subtitle2",gutterBottom:!0,children:"Payment Schedules"}),i.jsx(X,{container:!0,spacing:1,children:f.paymentSchedules.filter(L=>L.isEnabled).map((L,q)=>{var te;return i.jsx(X,{item:!0,xs:12,children:i.jsxs(ye,{sx:{p:1,bgcolor:s.paymentScheduleId===L.id?"primary.light":"background.paper",border:"1px solid",borderColor:s.paymentScheduleId===L.id?"primary.main":"divider",borderRadius:1,cursor:"pointer"},onClick:()=>{o(R=>({...R,paymentScheduleId:L.id}))},children:[i.jsxs(ee,{variant:"body2",fontWeight:"medium",children:[L.scheduleType," Payment"]}),i.jsxs(ee,{variant:"body2",color:"text.secondary",children:["₹",(te=L.amount)==null?void 0:te.toFixed(2)," per payment"]})]})},q)})})]})})]})]}):i.jsx(ee,{color:"text.secondary",children:"Select a grade to view the fee structure details"})}),"        "]}),i.jsxs(ca,{expanded:u==="panel6",onChange:F("panel6"),children:[i.jsx(la,{expandIcon:i.jsx(Xn,{}),children:i.jsx(ee,{variant:"subtitle1",children:"Transportation"})}),i.jsx(ua,{children:i.jsxs(X,{container:!0,spacing:2,children:[i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsxs(mt,{fullWidth:!0,children:[i.jsx(Tt,{children:"Transport Mode"}),i.jsxs(gt,{value:s.transportMode,onChange:b,label:"Transport Mode",children:[i.jsx(Ye,{value:"",children:"Not Specified"}),WP.map(L=>i.jsx(Ye,{value:L,children:L},L))]})]})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsxs(mt,{fullWidth:!0,children:[i.jsx(Tt,{children:"Bus Route Number"}),"                  ",i.jsx(gt,{value:s.busRouteNumber||"",onChange:L=>{const q=L.target.value;if(o(te=>({...te,busRouteNumber:q})),f){const te=w.find(R=>R.id===parseInt(q.toString()));if(te){const R={...f,transportFee:te.feeAmount,totalFees:f.annualFees+f.buildingFees+f.labFees+te.feeAmount};h(R),g(!0)}}},label:"Bus Route Number",disabled:s.transportMode!=="School Bus",children:w.map(L=>i.jsxs(Ye,{value:L.id,children:[L.routeName," - ",L.routeDescription]},L.id))})]})})]})})]})]})})};var xg={exports:{}};/* @license
Papa Parse
v5.5.2
https://github.com/mholt/PapaParse
License: MIT
*/(function(e,r){((t,n)=>{e.exports=n()})(Np,function t(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},a,s=!n.document&&!!n.postMessage,o=n.IS_PAPA_WORKER||!1,c={},l=0,u={};function d(E){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(b){var k=F(b);k.chunkSize=parseInt(k.chunkSize),b.step||b.chunk||(k.chunkSize=null),this._handle=new p(k),(this._handle.streamer=this)._config=k}).call(this,E),this.parseChunk=function(b,k){var j=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<j){let B=this._config.newline;B||(_=this._config.quoteChar||'"',B=this._handle.guessLineEndings(b,_)),b=[...b.split(B).slice(j)].join(B)}this.isFirstChunk&&S(this._config.beforeFirstChunk)&&(_=this._config.beforeFirstChunk(b))!==void 0&&(b=_),this.isFirstChunk=!1,this._halted=!1;var j=this._partialLine+b,_=(this._partialLine="",this._handle.parse(j,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(b=_.meta.cursor,j=(this._finished||(this._partialLine=j.substring(b-this._baseIndex),this._baseIndex=b),_&&_.data&&(this._rowCount+=_.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),o)n.postMessage({results:_,workerId:u.WORKER_ID,finished:j});else if(S(this._config.chunk)&&!k){if(this._config.chunk(_,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=_=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(_.data),this._completeResults.errors=this._completeResults.errors.concat(_.errors),this._completeResults.meta=_.meta),this._completed||!j||!S(this._config.complete)||_&&_.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),j||_&&_.meta.paused||this._nextChunk(),_}this._halted=!0},this._sendError=function(b){S(this._config.error)?this._config.error(b):o&&this._config.error&&n.postMessage({workerId:u.WORKER_ID,error:b,finished:!1})}}function f(E){var b;(E=E||{}).chunkSize||(E.chunkSize=u.RemoteChunkSize),d.call(this,E),this._nextChunk=s?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(k){this._input=k,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(b=new XMLHttpRequest,this._config.withCredentials&&(b.withCredentials=this._config.withCredentials),s||(b.onload=A(this._chunkLoaded,this),b.onerror=A(this._chunkError,this)),b.open(this._config.downloadRequestBody?"POST":"GET",this._input,!s),this._config.downloadRequestHeaders){var k,j=this._config.downloadRequestHeaders;for(k in j)b.setRequestHeader(k,j[k])}var _;this._config.chunkSize&&(_=this._start+this._config.chunkSize-1,b.setRequestHeader("Range","bytes="+this._start+"-"+_));try{b.send(this._config.downloadRequestBody)}catch(B){this._chunkError(B.message)}s&&b.status===0&&this._chunkError()}},this._chunkLoaded=function(){b.readyState===4&&(b.status<200||400<=b.status?this._chunkError():(this._start+=this._config.chunkSize||b.responseText.length,this._finished=!this._config.chunkSize||this._start>=(k=>(k=k.getResponseHeader("Content-Range"))!==null?parseInt(k.substring(k.lastIndexOf("/")+1)):-1)(b),this.parseChunk(b.responseText)))},this._chunkError=function(k){k=b.statusText||k,this._sendError(new Error(k))}}function h(E){(E=E||{}).chunkSize||(E.chunkSize=u.LocalChunkSize),d.call(this,E);var b,k,j=typeof FileReader<"u";this.stream=function(_){this._input=_,k=_.slice||_.webkitSlice||_.mozSlice,j?((b=new FileReader).onload=A(this._chunkLoaded,this),b.onerror=A(this._chunkError,this)):b=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var _=this._input,B=(this._config.chunkSize&&(B=Math.min(this._start+this._config.chunkSize,this._input.size),_=k.call(_,this._start,B)),b.readAsText(_,this._config.encoding));j||this._chunkLoaded({target:{result:B}})},this._chunkLoaded=function(_){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(_.target.result)},this._chunkError=function(){this._sendError(b.error)}}function x(E){var b;d.call(this,E=E||{}),this.stream=function(k){return b=k,this._nextChunk()},this._nextChunk=function(){var k,j;if(!this._finished)return k=this._config.chunkSize,b=k?(j=b.substring(0,k),b.substring(k)):(j=b,""),this._finished=!b,this.parseChunk(j)}}function m(E){d.call(this,E=E||{});var b=[],k=!0,j=!1;this.pause=function(){d.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){d.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(_){this._input=_,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){j&&b.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),b.length?this.parseChunk(b.shift()):k=!0},this._streamData=A(function(_){try{b.push(typeof _=="string"?_:_.toString(this._config.encoding)),k&&(k=!1,this._checkIsFinished(),this.parseChunk(b.shift()))}catch(B){this._streamError(B)}},this),this._streamError=A(function(_){this._streamCleanUp(),this._sendError(_)},this),this._streamEnd=A(function(){this._streamCleanUp(),j=!0,this._streamData("")},this),this._streamCleanUp=A(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function p(E){var b,k,j,_,B=Math.pow(2,53),Q=-B,Z=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,L=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,q=this,te=0,R=0,oe=!1,J=!1,P=[],V={data:[],errors:[],meta:{}};function z(se){return E.skipEmptyLines==="greedy"?se.join("").trim()==="":se.length===1&&se[0].length===0}function G(){if(V&&j&&(he("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+u.DefaultDelimiter+"'"),j=!1),E.skipEmptyLines&&(V.data=V.data.filter(function(O){return!z(O)})),ne()){let O=function(D,re){S(E.transformHeader)&&(D=E.transformHeader(D,re)),P.push(D)};if(V)if(Array.isArray(V.data[0])){for(var se=0;ne()&&se<V.data.length;se++)V.data[se].forEach(O);V.data.splice(0,1)}else V.data.forEach(O)}function ae(O,D){for(var re=E.header?{}:[],le=0;le<O.length;le++){var Te=le,ue=O[le],ue=((we,xe)=>(Ce=>(E.dynamicTypingFunction&&E.dynamicTyping[Ce]===void 0&&(E.dynamicTyping[Ce]=E.dynamicTypingFunction(Ce)),(E.dynamicTyping[Ce]||E.dynamicTyping)===!0))(we)?xe==="true"||xe==="TRUE"||xe!=="false"&&xe!=="FALSE"&&((Ce=>{if(Z.test(Ce)&&(Ce=parseFloat(Ce),Q<Ce&&Ce<B))return 1})(xe)?parseFloat(xe):L.test(xe)?new Date(xe):xe===""?null:xe):xe)(Te=E.header?le>=P.length?"__parsed_extra":P[le]:Te,ue=E.transform?E.transform(ue,Te):ue);Te==="__parsed_extra"?(re[Te]=re[Te]||[],re[Te].push(ue)):re[Te]=ue}return E.header&&(le>P.length?he("FieldMismatch","TooManyFields","Too many fields: expected "+P.length+" fields but parsed "+le,R+D):le<P.length&&he("FieldMismatch","TooFewFields","Too few fields: expected "+P.length+" fields but parsed "+le,R+D)),re}var K;V&&(E.header||E.dynamicTyping||E.transform)&&(K=1,!V.data.length||Array.isArray(V.data[0])?(V.data=V.data.map(ae),K=V.data.length):V.data=ae(V.data,0),E.header&&V.meta&&(V.meta.fields=P),R+=K)}function ne(){return E.header&&P.length===0}function he(se,ae,K,O){se={type:se,code:ae,message:K},O!==void 0&&(se.row=O),V.errors.push(se)}S(E.step)&&(_=E.step,E.step=function(se){V=se,ne()?G():(G(),V.data.length!==0&&(te+=se.data.length,E.preview&&te>E.preview?k.abort():(V.data=V.data[0],_(V,q))))}),this.parse=function(se,ae,K){var O=E.quoteChar||'"',O=(E.newline||(E.newline=this.guessLineEndings(se,O)),j=!1,E.delimiter?S(E.delimiter)&&(E.delimiter=E.delimiter(se),V.meta.delimiter=E.delimiter):((O=((D,re,le,Te,ue)=>{var we,xe,Ce,Oe;ue=ue||[",","	","|",";",u.RECORD_SEP,u.UNIT_SEP];for(var ze=0;ze<ue.length;ze++){for(var M,ce=ue[ze],de=0,Se=0,ke=0,Be=(Ce=void 0,new w({comments:Te,delimiter:ce,newline:re,preview:10}).parse(D)),Ve=0;Ve<Be.data.length;Ve++)le&&z(Be.data[Ve])?ke++:(M=Be.data[Ve].length,Se+=M,Ce===void 0?Ce=M:0<M&&(de+=Math.abs(M-Ce),Ce=M));0<Be.data.length&&(Se/=Be.data.length-ke),(xe===void 0||de<=xe)&&(Oe===void 0||Oe<Se)&&1.99<Se&&(xe=de,we=ce,Oe=Se)}return{successful:!!(E.delimiter=we),bestDelimiter:we}})(se,E.newline,E.skipEmptyLines,E.comments,E.delimitersToGuess)).successful?E.delimiter=O.bestDelimiter:(j=!0,E.delimiter=u.DefaultDelimiter),V.meta.delimiter=E.delimiter),F(E));return E.preview&&E.header&&O.preview++,b=se,k=new w(O),V=k.parse(b,ae,K),G(),oe?{meta:{paused:!0}}:V||{meta:{paused:!1}}},this.paused=function(){return oe},this.pause=function(){oe=!0,k.abort(),b=S(E.chunk)?"":b.substring(k.getCharIndex())},this.resume=function(){q.streamer._halted?(oe=!1,q.streamer.parseChunk(b,!0)):setTimeout(q.resume,3)},this.aborted=function(){return J},this.abort=function(){J=!0,k.abort(),V.meta.aborted=!0,S(E.complete)&&E.complete(V),b=""},this.guessLineEndings=function(D,O){D=D.substring(0,1048576);var O=new RegExp(g(O)+"([^]*?)"+g(O),"gm"),K=(D=D.replace(O,"")).split("\r"),O=D.split(`
`),D=1<O.length&&O[0].length<K[0].length;if(K.length===1||D)return`
`;for(var re=0,le=0;le<K.length;le++)K[le][0]===`
`&&re++;return re>=K.length/2?`\r
`:"\r"}}function g(E){return E.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function w(E){var b=(E=E||{}).delimiter,k=E.newline,j=E.comments,_=E.step,B=E.preview,Q=E.fastMode,Z=null,L=!1,q=E.quoteChar==null?'"':E.quoteChar,te=q;if(E.escapeChar!==void 0&&(te=E.escapeChar),(typeof b!="string"||-1<u.BAD_DELIMITERS.indexOf(b))&&(b=","),j===b)throw new Error("Comment character same as delimiter");j===!0?j="#":(typeof j!="string"||-1<u.BAD_DELIMITERS.indexOf(j))&&(j=!1),k!==`
`&&k!=="\r"&&k!==`\r
`&&(k=`
`);var R=0,oe=!1;this.parse=function(J,P,V){if(typeof J!="string")throw new Error("Input must be a string");var z=J.length,G=b.length,ne=k.length,he=j.length,se=S(_),ae=[],K=[],O=[],D=R=0;if(!J)return de();if(Q||Q!==!1&&J.indexOf(q)===-1){for(var re=J.split(k),le=0;le<re.length;le++){if(O=re[le],R+=O.length,le!==re.length-1)R+=k.length;else if(V)return de();if(!j||O.substring(0,he)!==j){if(se){if(ae=[],Oe(O.split(b)),Se(),oe)return de()}else Oe(O.split(b));if(B&&B<=le)return ae=ae.slice(0,B),de(!0)}}return de()}for(var Te=J.indexOf(b,R),ue=J.indexOf(k,R),we=new RegExp(g(te)+g(q),"g"),xe=J.indexOf(q,R);;)if(J[R]===q)for(xe=R,R++;;){if((xe=J.indexOf(q,xe+1))===-1)return V||K.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:ae.length,index:R}),M();if(xe===z-1)return M(J.substring(R,xe).replace(we,q));if(q===te&&J[xe+1]===te)xe++;else if(q===te||xe===0||J[xe-1]!==te){Te!==-1&&Te<xe+1&&(Te=J.indexOf(b,xe+1));var Ce=ze((ue=ue!==-1&&ue<xe+1?J.indexOf(k,xe+1):ue)===-1?Te:Math.min(Te,ue));if(J.substr(xe+1+Ce,G)===b){O.push(J.substring(R,xe).replace(we,q)),J[R=xe+1+Ce+G]!==q&&(xe=J.indexOf(q,R)),Te=J.indexOf(b,R),ue=J.indexOf(k,R);break}if(Ce=ze(ue),J.substring(xe+1+Ce,xe+1+Ce+ne)===k){if(O.push(J.substring(R,xe).replace(we,q)),ce(xe+1+Ce+ne),Te=J.indexOf(b,R),xe=J.indexOf(q,R),se&&(Se(),oe))return de();if(B&&ae.length>=B)return de(!0);break}K.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:ae.length,index:R}),xe++}}else if(j&&O.length===0&&J.substring(R,R+he)===j){if(ue===-1)return de();R=ue+ne,ue=J.indexOf(k,R),Te=J.indexOf(b,R)}else if(Te!==-1&&(Te<ue||ue===-1))O.push(J.substring(R,Te)),R=Te+G,Te=J.indexOf(b,R);else{if(ue===-1)break;if(O.push(J.substring(R,ue)),ce(ue+ne),se&&(Se(),oe))return de();if(B&&ae.length>=B)return de(!0)}return M();function Oe(ke){ae.push(ke),D=R}function ze(ke){var Be=0;return Be=ke!==-1&&(ke=J.substring(xe+1,ke))&&ke.trim()===""?ke.length:Be}function M(ke){return V||(ke===void 0&&(ke=J.substring(R)),O.push(ke),R=z,Oe(O),se&&Se()),de()}function ce(ke){R=ke,Oe(O),O=[],ue=J.indexOf(k,R)}function de(ke){if(E.header&&!P&&ae.length&&!L){var Be=ae[0],Ve={},Fe=new Set(Be);let Ie=!1;for(let We=0;We<Be.length;We++){let qe=Be[We];if(Ve[qe=S(E.transformHeader)?E.transformHeader(qe,We):qe]){let tt,ut=Ve[qe];for(;tt=qe+"_"+ut,ut++,Fe.has(tt););Fe.add(tt),Be[We]=tt,Ve[qe]++,Ie=!0,(Z=Z===null?{}:Z)[tt]=qe}else Ve[qe]=1,Be[We]=qe;Fe.add(qe)}Ie&&console.warn("Duplicate headers found and renamed."),L=!0}return{data:ae,errors:K,meta:{delimiter:b,linebreak:k,aborted:oe,truncated:!!ke,cursor:D+(P||0),renamedHeaders:Z}}}function Se(){_(de()),ae=[],K=[]}},this.abort=function(){oe=!0},this.getCharIndex=function(){return R}}function y(E){var b=E.data,k=c[b.workerId],j=!1;if(b.error)k.userError(b.error,b.file);else if(b.results&&b.results.data){var _={abort:function(){j=!0,v(b.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:T,resume:T};if(S(k.userStep)){for(var B=0;B<b.results.data.length&&(k.userStep({data:b.results.data[B],errors:b.results.errors,meta:b.results.meta},_),!j);B++);delete b.results}else S(k.userChunk)&&(k.userChunk(b.results,_,b.file),delete b.results)}b.finished&&!j&&v(b.workerId,b.results)}function v(E,b){var k=c[E];S(k.userComplete)&&k.userComplete(b),k.terminate(),delete c[E]}function T(){throw new Error("Not implemented.")}function F(E){if(typeof E!="object"||E===null)return E;var b,k=Array.isArray(E)?[]:{};for(b in E)k[b]=F(E[b]);return k}function A(E,b){return function(){E.apply(b,arguments)}}function S(E){return typeof E=="function"}return u.parse=function(E,b){var k=(b=b||{}).dynamicTyping||!1;if(S(k)&&(b.dynamicTypingFunction=k,k={}),b.dynamicTyping=k,b.transform=!!S(b.transform)&&b.transform,!b.worker||!u.WORKERS_SUPPORTED)return k=null,u.NODE_STREAM_INPUT,typeof E=="string"?(E=(j=>j.charCodeAt(0)!==65279?j:j.slice(1))(E),k=new(b.download?f:x)(b)):E.readable===!0&&S(E.read)&&S(E.on)?k=new m(b):(n.File&&E instanceof File||E instanceof Object)&&(k=new h(b)),k.stream(E);(k=(()=>{var j;return!!u.WORKERS_SUPPORTED&&(j=(()=>{var _=n.URL||n.webkitURL||null,B=t.toString();return u.BLOB_URL||(u.BLOB_URL=_.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",B,")();"],{type:"text/javascript"})))})(),(j=new n.Worker(j)).onmessage=y,j.id=l++,c[j.id]=j)})()).userStep=b.step,k.userChunk=b.chunk,k.userComplete=b.complete,k.userError=b.error,b.step=S(b.step),b.chunk=S(b.chunk),b.complete=S(b.complete),b.error=S(b.error),delete b.worker,k.postMessage({input:E,config:b,workerId:k.id})},u.unparse=function(E,b){var k=!1,j=!0,_=",",B=`\r
`,Q='"',Z=Q+Q,L=!1,q=null,te=!1,R=((()=>{if(typeof b=="object"){if(typeof b.delimiter!="string"||u.BAD_DELIMITERS.filter(function(P){return b.delimiter.indexOf(P)!==-1}).length||(_=b.delimiter),typeof b.quotes!="boolean"&&typeof b.quotes!="function"&&!Array.isArray(b.quotes)||(k=b.quotes),typeof b.skipEmptyLines!="boolean"&&typeof b.skipEmptyLines!="string"||(L=b.skipEmptyLines),typeof b.newline=="string"&&(B=b.newline),typeof b.quoteChar=="string"&&(Q=b.quoteChar),typeof b.header=="boolean"&&(j=b.header),Array.isArray(b.columns)){if(b.columns.length===0)throw new Error("Option columns is empty");q=b.columns}b.escapeChar!==void 0&&(Z=b.escapeChar+Q),b.escapeFormulae instanceof RegExp?te=b.escapeFormulae:typeof b.escapeFormulae=="boolean"&&b.escapeFormulae&&(te=/^[=+\-@\t\r].*$/)}})(),new RegExp(g(Q),"g"));if(typeof E=="string"&&(E=JSON.parse(E)),Array.isArray(E)){if(!E.length||Array.isArray(E[0]))return oe(null,E,L);if(typeof E[0]=="object")return oe(q||Object.keys(E[0]),E,L)}else if(typeof E=="object")return typeof E.data=="string"&&(E.data=JSON.parse(E.data)),Array.isArray(E.data)&&(E.fields||(E.fields=E.meta&&E.meta.fields||q),E.fields||(E.fields=Array.isArray(E.data[0])?E.fields:typeof E.data[0]=="object"?Object.keys(E.data[0]):[]),Array.isArray(E.data[0])||typeof E.data[0]=="object"||(E.data=[E.data])),oe(E.fields||[],E.data||[],L);throw new Error("Unable to serialize unrecognized input");function oe(P,V,z){var G="",ne=(typeof P=="string"&&(P=JSON.parse(P)),typeof V=="string"&&(V=JSON.parse(V)),Array.isArray(P)&&0<P.length),he=!Array.isArray(V[0]);if(ne&&j){for(var se=0;se<P.length;se++)0<se&&(G+=_),G+=J(P[se],se);0<V.length&&(G+=B)}for(var ae=0;ae<V.length;ae++){var K=(ne?P:V[ae]).length,O=!1,D=ne?Object.keys(V[ae]).length===0:V[ae].length===0;if(z&&!ne&&(O=z==="greedy"?V[ae].join("").trim()==="":V[ae].length===1&&V[ae][0].length===0),z==="greedy"&&ne){for(var re=[],le=0;le<K;le++){var Te=he?P[le]:le;re.push(V[ae][Te])}O=re.join("").trim()===""}if(!O){for(var ue=0;ue<K;ue++){0<ue&&!D&&(G+=_);var we=ne&&he?P[ue]:ue;G+=J(V[ae][we],ue)}ae<V.length-1&&(!z||0<K&&!D)&&(G+=B)}}return G}function J(P,V){var z,G;return P==null?"":P.constructor===Date?JSON.stringify(P).slice(1,25):(G=!1,te&&typeof P=="string"&&te.test(P)&&(P="'"+P,G=!0),z=P.toString().replace(R,Z),(G=G||k===!0||typeof k=="function"&&k(P,V)||Array.isArray(k)&&k[V]||((ne,he)=>{for(var se=0;se<he.length;se++)if(-1<ne.indexOf(he[se]))return!0;return!1})(z,u.BAD_DELIMITERS)||-1<z.indexOf(_)||z.charAt(0)===" "||z.charAt(z.length-1)===" ")?Q+z+Q:z)}},u.RECORD_SEP=String.fromCharCode(30),u.UNIT_SEP=String.fromCharCode(31),u.BYTE_ORDER_MARK="\uFEFF",u.BAD_DELIMITERS=["\r",`
`,'"',u.BYTE_ORDER_MARK],u.WORKERS_SUPPORTED=!s&&!!n.Worker,u.NODE_STREAM_INPUT=1,u.LocalChunkSize=10485760,u.RemoteChunkSize=5242880,u.DefaultDelimiter=",",u.Parser=w,u.ParserHandle=p,u.NetworkStreamer=f,u.FileStreamer=h,u.StringStreamer=x,u.ReadableStreamStreamer=m,n.jQuery&&((a=n.jQuery).fn.parse=function(E){var b=E.config||{},k=[];return this.each(function(B){if(!(a(this).prop("tagName").toUpperCase()==="INPUT"&&a(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var Q=0;Q<this.files.length;Q++)k.push({file:this.files[Q],inputElem:this,instanceConfig:a.extend({},b)})}),j(),this;function j(){if(k.length===0)S(E.complete)&&E.complete();else{var B,Q,Z,L,q=k[0];if(S(E.before)){var te=E.before(q.file,q.inputElem);if(typeof te=="object"){if(te.action==="abort")return B="AbortError",Q=q.file,Z=q.inputElem,L=te.reason,void(S(E.error)&&E.error({name:B},Q,Z,L));if(te.action==="skip")return void _();typeof te.config=="object"&&(q.instanceConfig=a.extend(q.instanceConfig,te.config))}else if(te==="skip")return void _()}var R=q.instanceConfig.complete;q.instanceConfig.complete=function(oe){S(R)&&R(oe,q.file,q.inputElem),_()},u.parse(q.file,q.instanceConfig)}}function _(){k.splice(0,1),j()}}),o&&(n.onmessage=function(E){E=E.data,u.WORKER_ID===void 0&&E&&(u.WORKER_ID=E.workerId),typeof E.input=="string"?n.postMessage({workerId:u.WORKER_ID,results:u.parse(E.input,E.config),finished:!0}):(n.File&&E.input instanceof File||E.input instanceof Object)&&(E=u.parse(E.input,E.config))&&n.postMessage({workerId:u.WORKER_ID,results:E,finished:!0})}),(f.prototype=Object.create(d.prototype)).constructor=f,(h.prototype=Object.create(d.prototype)).constructor=h,(x.prototype=Object.create(x.prototype)).constructor=x,(m.prototype=Object.create(d.prototype)).constructor=m,u})})(xg);var gg=xg.exports,xd={},zP=_t;Object.defineProperty(xd,"__esModule",{value:!0});var gd=xd.default=void 0,GP=zP(Ft()),YP=i;gd=xd.default=(0,GP.default)((0,YP.jsx)("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96M14 13v4h-4v-4H7l5-5 5 5z"}),"CloudUpload");var yd={},qP=_t;Object.defineProperty(yd,"__esModule",{value:!0});var vd=yd.default=void 0,XP=qP(Ft()),KP=i;vd=yd.default=(0,XP.default)((0,KP.jsx)("path",{d:"M5 20h14v-2H5zM19 9h-4V3H9v6H5l7 7z"}),"Download");var bd={},JP=_t;Object.defineProperty(bd,"__esModule",{value:!0});var wd=bd.default=void 0,QP=JP(Ft()),ZP=i;wd=bd.default=(0,QP.default)((0,ZP.jsx)("path",{d:"M9 16h6v-6h4l-7-7-7 7h4zm-4 2h14v2H5z"}),"FileUpload");/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var yg=1252,eO=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Sd={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Ed=function(e){eO.indexOf(e)!=-1&&(yg=Sd[0]=e)};function tO(){Ed(1252)}var bn=function(e){Ed(e)};function vg(){bn(1200),tO()}function lh(e){for(var r=[],t=0,n=e.length;t<n;++t)r[t]=e.charCodeAt(t);return r}function rO(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return r.join("")}function bg(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return r.join("")}var wi=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1);return r==255&&t==254?rO(e.slice(2)):r==254&&t==255?bg(e.slice(2)):r==65279?e.slice(1):e},_o=function(r){return String.fromCharCode(r)},uh=function(r){return String.fromCharCode(r)},da,ha="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function dh(e){for(var r="",t=0,n=0,a=0,s=0,o=0,c=0,l=0,u=0;u<e.length;)t=e.charCodeAt(u++),s=t>>2,n=e.charCodeAt(u++),o=(t&3)<<4|n>>4,a=e.charCodeAt(u++),c=(n&15)<<2|a>>6,l=a&63,isNaN(n)?c=l=64:isNaN(a)&&(l=64),r+=ha.charAt(s)+ha.charAt(o)+ha.charAt(c)+ha.charAt(l);return r}function Kr(e){var r="",t=0,n=0,a=0,s=0,o=0,c=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)s=ha.indexOf(e.charAt(u++)),o=ha.indexOf(e.charAt(u++)),t=s<<2|o>>4,r+=String.fromCharCode(t),c=ha.indexOf(e.charAt(u++)),n=(o&15)<<4|c>>2,c!==64&&(r+=String.fromCharCode(n)),l=ha.indexOf(e.charAt(u++)),a=(c&3)<<6|l,l!==64&&(r+=String.fromCharCode(a));return r}var ot=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),gs=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}}();function Sa(e){return ot?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function fh(e){return ot?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var vn=function(r){return ot?gs(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)&255})};function ys(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function Td(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Td(new Uint8Array(e));for(var r=new Array(e.length),t=0;t<e.length;++t)r[t]=e[t];return r}var fa=ot?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:gs(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var n=new Uint8Array(t),a=0;for(r=0,t=0;r<e.length;t+=a,++r)if(a=e[r].length,e[r]instanceof Uint8Array)n.set(e[r],t);else{if(typeof e[r]=="string")throw"wtf";n.set(new Uint8Array(e[r]),t)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function nO(e){for(var r=[],t=0,n=e.length+250,a=Sa(e.length+255),s=0;s<e.length;++s){var o=e.charCodeAt(s);if(o<128)a[t++]=o;else if(o<2048)a[t++]=192|o>>6&31,a[t++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var c=e.charCodeAt(++s)&1023;a[t++]=240|o>>8&7,a[t++]=128|o>>2&63,a[t++]=128|c>>6&15|(o&3)<<4,a[t++]=128|c&63}else a[t++]=224|o>>12&15,a[t++]=128|o>>6&63,a[t++]=128|o&63;t>n&&(r.push(a.slice(0,t)),t=0,a=Sa(65535),n=65530)}return r.push(a.slice(0,t)),fa(r)}var Fr=/\u0000/g,Si=/[\u0001-\u0006]/g;function $s(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function wn(e,r){var t=""+e;return t.length>=r?t:It("0",r-t.length)+t}function Ad(e,r){var t=""+e;return t.length>=r?t:It(" ",r-t.length)+t}function sc(e,r){var t=""+e;return t.length>=r?t:t+It(" ",r-t.length)}function aO(e,r){var t=""+Math.round(e);return t.length>=r?t:It("0",r-t.length)+t}function sO(e,r){var t=""+e;return t.length>=r?t:It("0",r-t.length)+t}var hh=Math.pow(2,32);function Fs(e,r){if(e>hh||e<-hh)return aO(e,r);var t=Math.round(e);return sO(t,r)}function ic(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var ph=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],wl=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function iO(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var nt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},mh={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},oO={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function oc(e,r,t){for(var n=e<0?-1:1,a=e*n,s=0,o=1,c=0,l=1,u=0,d=0,f=Math.floor(a);u<r&&(f=Math.floor(a),c=f*o+s,d=f*u+l,!(a-f<5e-8));)a=1/(a-f),s=o,o=c,l=u,u=d;if(d>r&&(u>r?(d=l,c=s):(d=u,c=o)),!t)return[0,n*c,d];var h=Math.floor(n*c/d);return[h,n*c-h*d,d]}function Wa(e,r,t){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),s=0,o=[],c={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),r&&r.date1904&&(n+=1462),c.u>.9999&&(c.u=0,++a==86400&&(c.T=a=0,++n,++c.D)),n===60)o=t?[1317,10,29]:[1900,2,29],s=3;else if(n===0)o=t?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),o=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),t&&(s=hO(l,o))}return c.y=o[0],c.m=o[1],c.d=o[2],c.S=a%60,a=Math.floor(a/60),c.M=a%60,a=Math.floor(a/60),c.H=a,c.q=s,c}var wg=new Date(1899,11,31,0,0,0),cO=wg.getTime(),lO=new Date(1900,2,1,0,0,0);function Sg(e,r){var t=e.getTime();return r?t-=1461*24*60*60*1e3:e>=lO&&(t+=24*60*60*1e3),(t-(cO+(e.getTimezoneOffset()-wg.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function kd(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function uO(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function dO(e){var r=e<0?12:11,t=kd(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10),t.length<=r)?t:e.toExponential(5)}function fO(e){var r=kd(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function Yi(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return r>=-4&&r<=-1?t=e.toPrecision(10+r):Math.abs(r)<=9?t=dO(e):r===10?t=e.toFixed(10).substr(0,12):t=fO(e),kd(uO(t.toUpperCase()))}function is(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Yi(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return cn(14,Sg(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function hO(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function pO(e,r,t,n){var a="",s=0,o=0,c=t.y,l,u=0;switch(e){case 98:c=t.y+543;case 121:switch(r.length){case 1:case 2:l=c%100,u=2;break;default:l=c%1e4,u=4;break}break;case 109:switch(r.length){case 1:case 2:l=t.m,u=r.length;break;case 3:return wl[t.m-1][1];case 5:return wl[t.m-1][0];default:return wl[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:l=t.d,u=r.length;break;case 3:return ph[t.q][0];default:return ph[t.q][1]}break;case 104:switch(r.length){case 1:case 2:l=1+(t.H+11)%12,u=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:l=t.H,u=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:l=t.M,u=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return t.u===0&&(r=="s"||r=="ss")?wn(t.S,r.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,s=Math.round(o*(t.S+t.u)),s>=60*o&&(s=0),r==="s"?s===0?"0":""+s/o:(a=wn(s,2+n),r==="ss"?a.substr(0,2):"."+a.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":l=t.D*24+t.H;break;case"[m]":case"[mm]":l=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":l=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r}u=r.length===3?1:2;break;case 101:l=c,u=1;break}var d=u>0?wn(l,u):"";return d}function pa(e){var r=3;if(e.length<=r)return e;for(var t=e.length%r,n=e.substr(0,t);t!=e.length;t+=r)n+=(n.length>0?",":"")+e.substr(t,r);return n}var Eg=/%/g;function mO(e,r,t){var n=r.replace(Eg,""),a=r.length-n.length;return Qn(e,n,t*Math.pow(10,2*a))+It("%",a)}function xO(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return Qn(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function Tg(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Tg(e,-r);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(r)*Math.LOG10E)%a;if(s<0&&(s+=a),t=(r/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),t.indexOf("e")===-1){var o=Math.floor(Math.log(r)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(o-t.length+s):t+="E+"+(o-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,a)+"."+t.substr(2+a),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,l,u,d){return l+u+d.substr(0,(a+s)%a)+"."+d.substr(s)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Ag=/# (\?+)( ?)\/( ?)(\d+)/;function gO(e,r,t){var n=parseInt(e[4],10),a=Math.round(r*n),s=Math.floor(a/n),o=a-s*n,c=n;return t+(s===0?"":""+s)+" "+(o===0?It(" ",e[1].length+1+e[4].length):Ad(o,e[1].length)+e[2]+"/"+e[3]+wn(c,e[4].length))}function yO(e,r,t){return t+(r===0?"":""+r)+It(" ",e[1].length+2+e[4].length)}var kg=/^#*0*\.([0#]+)/,Cg=/\).*[0#]/,_g=/\(###\) ###\\?-####/;function Ar(e){for(var r="",t,n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function xh(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function gh(e,r){var t=e-Math.floor(e),n=Math.pow(10,r);return r<(""+Math.round(t*n)).length?0:Math.round(t*n)}function vO(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function bO(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function en(e,r,t){if(e.charCodeAt(0)===40&&!r.match(Cg)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?en("n",n,t):"("+en("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return xO(e,r,t);if(r.indexOf("%")!==-1)return mO(e,r,t);if(r.indexOf("E")!==-1)return Tg(r,t);if(r.charCodeAt(0)===36)return"$"+en(e,r.substr(r.charAt(1)==" "?2:1),t);var a,s,o,c,l=Math.abs(t),u=t<0?"-":"";if(r.match(/^00+$/))return u+Fs(l,r.length);if(r.match(/^[#?]+$/))return a=Fs(t,0),a==="0"&&(a=""),a.length>r.length?a:Ar(r.substr(0,r.length-a.length))+a;if(s=r.match(Ag))return gO(s,l,u);if(r.match(/^#+0+$/))return u+Fs(l,r.length-r.indexOf("0"));if(s=r.match(kg))return a=xh(t,s[1].length).replace(/^([^\.]+)$/,"$1."+Ar(s[1])).replace(/\.$/,"."+Ar(s[1])).replace(/\.(\d*)$/,function(m,p){return"."+p+It("0",Ar(s[1]).length-p.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),s=r.match(/^(0*)\.(#*)$/))return u+xh(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=r.match(/^#{1,3},##0(\.?)$/))return u+pa(Fs(l,0));if(s=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+en(e,r,-t):pa(""+(Math.floor(t)+vO(t,s[1].length)))+"."+wn(gh(t,s[1].length),s[1].length);if(s=r.match(/^#,#*,#0/))return en(e,r.replace(/^#,#*,/,""),t);if(s=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=$s(en(e,r.replace(/[\\-]/g,""),t)),o=0,$s($s(r.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<a.length?a.charAt(o++):m==="0"?"0":""}));if(r.match(_g))return a=en(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),c=oc(l,Math.pow(10,o)-1,!1),a=""+u,d=Qn("n",s[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],d=sc(c[2],o),d.length<s[4].length&&(d=Ar(s[4].substr(s[4].length-d.length))+d),a+=d,a;if(s=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),c=oc(l,Math.pow(10,o)-1,!0),u+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Ad(c[1],o)+s[2]+"/"+s[3]+sc(c[2],o):It(" ",2*o+1+s[2].length+s[3].length));if(s=r.match(/^[#0?]+$/))return a=Fs(t,0),r.length<=a.length?a:Ar(r.substr(0,r.length-a.length))+a;if(s=r.match(/^([#0?]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var f=r.indexOf(".")-o,h=r.length-a.length-f;return Ar(r.substr(0,f)+a+r.substr(r.length-h))}if(s=r.match(/^00,000\.([#0]*0)$/))return o=gh(t,s[1].length),t<0?"-"+en(e,r,-t):pa(bO(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?wn(0,3-m.length):"")+m})+"."+wn(o,s[1].length);switch(r){case"###,##0.00":return en(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var x=pa(Fs(l,0));return x!=="0"?u+x:"";case"###,###.00":return en(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return en(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function wO(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return Qn(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function SO(e,r,t){var n=r.replace(Eg,""),a=r.length-n.length;return Qn(e,n,t*Math.pow(10,2*a))+It("%",a)}function Dg(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Dg(e,-r);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(r)*Math.LOG10E)%a;if(s<0&&(s+=a),t=(r/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!t.match(/[Ee]/)){var o=Math.floor(Math.log(r)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(o-t.length+s):t+="E+"+(o-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,l,u,d){return l+u+d.substr(0,(a+s)%a)+"."+d.substr(s)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function jn(e,r,t){if(e.charCodeAt(0)===40&&!r.match(Cg)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?jn("n",n,t):"("+jn("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return wO(e,r,t);if(r.indexOf("%")!==-1)return SO(e,r,t);if(r.indexOf("E")!==-1)return Dg(r,t);if(r.charCodeAt(0)===36)return"$"+jn(e,r.substr(r.charAt(1)==" "?2:1),t);var a,s,o,c,l=Math.abs(t),u=t<0?"-":"";if(r.match(/^00+$/))return u+wn(l,r.length);if(r.match(/^[#?]+$/))return a=""+t,t===0&&(a=""),a.length>r.length?a:Ar(r.substr(0,r.length-a.length))+a;if(s=r.match(Ag))return yO(s,l,u);if(r.match(/^#+0+$/))return u+wn(l,r.length-r.indexOf("0"));if(s=r.match(kg))return a=(""+t).replace(/^([^\.]+)$/,"$1."+Ar(s[1])).replace(/\.$/,"."+Ar(s[1])),a=a.replace(/\.(\d*)$/,function(m,p){return"."+p+It("0",Ar(s[1]).length-p.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),s=r.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=r.match(/^#{1,3},##0(\.?)$/))return u+pa(""+l);if(s=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+jn(e,r,-t):pa(""+t)+"."+It("0",s[1].length);if(s=r.match(/^#,#*,#0/))return jn(e,r.replace(/^#,#*,/,""),t);if(s=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=$s(jn(e,r.replace(/[\\-]/g,""),t)),o=0,$s($s(r.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<a.length?a.charAt(o++):m==="0"?"0":""}));if(r.match(_g))return a=jn(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),c=oc(l,Math.pow(10,o)-1,!1),a=""+u,d=Qn("n",s[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],d=sc(c[2],o),d.length<s[4].length&&(d=Ar(s[4].substr(s[4].length-d.length))+d),a+=d,a;if(s=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),c=oc(l,Math.pow(10,o)-1,!0),u+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Ad(c[1],o)+s[2]+"/"+s[3]+sc(c[2],o):It(" ",2*o+1+s[2].length+s[3].length));if(s=r.match(/^[#0?]+$/))return a=""+t,r.length<=a.length?a:Ar(r.substr(0,r.length-a.length))+a;if(s=r.match(/^([#0]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var f=r.indexOf(".")-o,h=r.length-a.length-f;return Ar(r.substr(0,f)+a+r.substr(r.length-h))}if(s=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+jn(e,r,-t):pa(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?wn(0,3-m.length):"")+m})+"."+wn(0,s[1].length);switch(r){case"###,###":case"##,###":case"#,###":var x=pa(""+l);return x!=="0"?u+x:"";default:if(r.match(/\.[0#?]*$/))return jn(e,r.slice(0,r.lastIndexOf(".")),t)+Ar(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function Qn(e,r,t){return(t|0)===t?jn(e,r,t):en(e,r,t)}function EO(e){for(var r=[],t=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:r[r.length]=e.substr(a,n-a),a=n+1}if(r[r.length]=e.substr(a),t===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var Fg=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ni(e){for(var r=0,t="",n="";r<e.length;)switch(t=e.charAt(r)){case"G":ic(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="上午/下午")return!0;++r;break;case"[":for(n=t;e.charAt(r++)!=="]"&&r<e.length;)n+=e.charAt(r);if(n.match(Fg))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||t=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function TO(e,r,t,n){for(var a=[],s="",o=0,c="",l="t",u,d,f,h="H";o<e.length;)switch(c=e.charAt(o)){case"G":if(!ic(e,o))throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(f=e.charCodeAt(++o))!==34&&o<e.length;)s+=String.fromCharCode(f);a[a.length]={t:"t",v:s},++o;break;case"\\":var x=e.charAt(++o),m=x==="("||x===")"?x:"t";a[a.length]={t:m,v:x},++o;break;case"_":a[a.length]={t:"t",v:" "},o+=2;break;case"@":a[a.length]={t:"T",v:r},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(u==null&&(u=Wa(r,t,e.charAt(o+1)==="2"),u==null))return"";a[a.length]={t:"X",v:e.substr(o,2)},l=c,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||u==null&&(u=Wa(r,t),u==null))return"";for(s=c;++o<e.length&&e.charAt(o).toLowerCase()===c;)s+=c;c==="m"&&l.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=h),a[a.length]={t:c,v:s},l=c;break;case"A":case"a":case"上":var p={t:c,v:c};if(u==null&&(u=Wa(r,t)),e.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(p.v=u.H>=12?"P":"A"),p.t="T",h="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(p.v=u.H>=12?"PM":"AM"),p.t="T",o+=5,h="h"):e.substr(o,5).toUpperCase()==="上午/下午"?(u!=null&&(p.v=u.H>=12?"下午":"上午"),p.t="T",o+=5,h="h"):(p.t="t",++o),u==null&&p.t==="T")return"";a[a.length]=p,l=c;break;case"[":for(s=c;e.charAt(o++)!=="]"&&o<e.length;)s+=e.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(Fg)){if(u==null&&(u=Wa(r,t),u==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",ni(e)||(a[a.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=c;++o<e.length&&(c=e.charAt(o))==="0";)s+=c;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=c;++o<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(o))>-1;)s+=c;a[a.length]={t:"n",v:s};break;case"?":for(s=c;e.charAt(++o)===c;)s+=c;a[a.length]={t:c,v:s},l=c;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":a[a.length]={t:n===1?"t":c,v:c},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=c;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)s+=e.charAt(o);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:c,v:c},++o;break;case"$":a[a.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"t",v:c},++o;break}var g=0,w=0,y;for(o=a.length-1,l="t";o>=0;--o)switch(a[o].t){case"h":case"H":a[o].t=h,l="h",g<1&&(g=1);break;case"s":(y=a[o].v.match(/\.0+$/))&&(w=Math.max(w,y[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":l=a[o].t;break;case"m":l==="s"&&(a[o].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&a[o].v.match(/[Hh]/)&&(g=1),g<2&&a[o].v.match(/[Mm]/)&&(g=2),g<3&&a[o].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var v="",T;for(o=0;o<a.length;++o)switch(a[o].t){case"t":case"T":case" ":case"D":break;case"X":a[o].v="",a[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[o].v=pO(a[o].t.charCodeAt(0),a[o].v,u,w),a[o].t="t";break;case"n":case"?":for(T=o+1;a[T]!=null&&((c=a[T].t)==="?"||c==="D"||(c===" "||c==="t")&&a[T+1]!=null&&(a[T+1].t==="?"||a[T+1].t==="t"&&a[T+1].v==="/")||a[o].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(a[T].v==="/"||a[T].v===" "&&a[T+1]!=null&&a[T+1].t=="?"));)a[o].v+=a[T].v,a[T]={v:"",t:";"},++T;v+=a[o].v,o=T-1;break;case"G":a[o].t="t",a[o].v=is(r,t);break}var F="",A,S;if(v.length>0){v.charCodeAt(0)==40?(A=r<0&&v.charCodeAt(0)===45?-r:r,S=Qn("n",v,A)):(A=r<0&&n>1?-r:r,S=Qn("n",v,A),A<0&&a[0]&&a[0].t=="t"&&(S=S.substr(1),a[0].v="-"+a[0].v)),T=S.length-1;var E=a.length;for(o=0;o<a.length;++o)if(a[o]!=null&&a[o].t!="t"&&a[o].v.indexOf(".")>-1){E=o;break}var b=a.length;if(E===a.length&&S.indexOf("E")===-1){for(o=a.length-1;o>=0;--o)a[o]==null||"n?".indexOf(a[o].t)===-1||(T>=a[o].v.length-1?(T-=a[o].v.length,a[o].v=S.substr(T+1,a[o].v.length)):T<0?a[o].v="":(a[o].v=S.substr(0,T+1),T=-1),a[o].t="t",b=o);T>=0&&b<a.length&&(a[b].v=S.substr(0,T+1)+a[b].v)}else if(E!==a.length&&S.indexOf("E")===-1){for(T=S.indexOf(".")-1,o=E;o>=0;--o)if(!(a[o]==null||"n?".indexOf(a[o].t)===-1)){for(d=a[o].v.indexOf(".")>-1&&o===E?a[o].v.indexOf(".")-1:a[o].v.length-1,F=a[o].v.substr(d+1);d>=0;--d)T>=0&&(a[o].v.charAt(d)==="0"||a[o].v.charAt(d)==="#")&&(F=S.charAt(T--)+F);a[o].v=F,a[o].t="t",b=o}for(T>=0&&b<a.length&&(a[b].v=S.substr(0,T+1)+a[b].v),T=S.indexOf(".")+1,o=E;o<a.length;++o)if(!(a[o]==null||"n?(".indexOf(a[o].t)===-1&&o!==E)){for(d=a[o].v.indexOf(".")>-1&&o===E?a[o].v.indexOf(".")+1:0,F=a[o].v.substr(0,d);d<a[o].v.length;++d)T<S.length&&(F+=S.charAt(T++));a[o].v=F,a[o].t="t",b=o}}}for(o=0;o<a.length;++o)a[o]!=null&&"n?".indexOf(a[o].t)>-1&&(A=n>1&&r<0&&o>0&&a[o-1].v==="-"?-r:r,a[o].v=Qn(a[o].t,a[o].v,A),a[o].t="t");var k="";for(o=0;o!==a.length;++o)a[o]!=null&&(k+=a[o].v);return k}var yh=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function vh(e,r){if(r==null)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function AO(e,r){var t=EO(e),n=t.length,a=t[n-1].indexOf("@");if(n<4&&a>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof r!="number")return[4,t.length===4||a>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=a>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=a>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=a>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var s=r>0?t[0]:r<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var o=t[0].match(yh),c=t[1].match(yh);return vh(r,o)?[n,t[0]]:vh(r,c)?[n,t[1]]:[n,t[o!=null&&c!=null?2:1]]}return[n,s]}function cn(e,r,t){t==null&&(t={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?n=t.dateNF:n=e;break;case"number":e==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:nt)[e],n==null&&(n=t.table&&t.table[mh[e]]||nt[mh[e]]),n==null&&(n=oO[e]||"General");break}if(ic(n,0))return is(r,t);r instanceof Date&&(r=Sg(r,t.date1904));var a=AO(n,r);if(ic(a[1]))return is(r,t);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return TO(a[1],r,t,a[0])}function Ga(e,r){if(typeof r!="number"){r=+r||-1;for(var t=0;t<392;++t){if(nt[t]==null){r<0&&(r=t);continue}if(nt[t]==e){r=t;break}}r<0&&(r=391)}return nt[r]=e,r}function jg(){nt=iO()}var kO={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Ig=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function CO(e){var r=typeof e=="number"?nt[e]:e;return r=r.replace(Ig,"(\\d+)"),new RegExp("^"+r+"$")}function _O(e,r,t){var n=-1,a=-1,s=-1,o=-1,c=-1,l=-1;(r.match(Ig)||[]).forEach(function(f,h){var x=parseInt(t[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=x;break;case"d":s=x;break;case"h":o=x;break;case"s":l=x;break;case"m":o>=0?c=x:a=x;break}}),l>=0&&c==-1&&a>=0&&(c=a,a=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return o==-1&&c==-1&&l==-1?u:n==-1&&a==-1&&s==-1?d:u+"T"+d}var DO=function(){var e={};e.version="1.2.0";function r(){for(var S=0,E=new Array(256),b=0;b!=256;++b)S=b,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,E[b]=S;return typeof Int32Array<"u"?new Int32Array(E):E}var t=r();function n(S){var E=0,b=0,k=0,j=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(k=0;k!=256;++k)j[k]=S[k];for(k=0;k!=256;++k)for(b=S[k],E=256+k;E<4096;E+=256)b=j[E]=b>>>8^S[b&255];var _=[];for(k=1;k!=16;++k)_[k-1]=typeof Int32Array<"u"?j.subarray(k*256,k*256+256):j.slice(k*256,k*256+256);return _}var a=n(t),s=a[0],o=a[1],c=a[2],l=a[3],u=a[4],d=a[5],f=a[6],h=a[7],x=a[8],m=a[9],p=a[10],g=a[11],w=a[12],y=a[13],v=a[14];function T(S,E){for(var b=E^-1,k=0,j=S.length;k<j;)b=b>>>8^t[(b^S.charCodeAt(k++))&255];return~b}function F(S,E){for(var b=E^-1,k=S.length-15,j=0;j<k;)b=v[S[j++]^b&255]^y[S[j++]^b>>8&255]^w[S[j++]^b>>16&255]^g[S[j++]^b>>>24]^p[S[j++]]^m[S[j++]]^x[S[j++]]^h[S[j++]]^f[S[j++]]^d[S[j++]]^u[S[j++]]^l[S[j++]]^c[S[j++]]^o[S[j++]]^s[S[j++]]^t[S[j++]];for(k+=15;j<k;)b=b>>>8^t[(b^S[j++])&255];return~b}function A(S,E){for(var b=E^-1,k=0,j=S.length,_=0,B=0;k<j;)_=S.charCodeAt(k++),_<128?b=b>>>8^t[(b^_)&255]:_<2048?(b=b>>>8^t[(b^(192|_>>6&31))&255],b=b>>>8^t[(b^(128|_&63))&255]):_>=55296&&_<57344?(_=(_&1023)+64,B=S.charCodeAt(k++)&1023,b=b>>>8^t[(b^(240|_>>8&7))&255],b=b>>>8^t[(b^(128|_>>2&63))&255],b=b>>>8^t[(b^(128|B>>6&15|(_&3)<<4))&255],b=b>>>8^t[(b^(128|B&63))&255]):(b=b>>>8^t[(b^(224|_>>12&15))&255],b=b>>>8^t[(b^(128|_>>6&63))&255],b=b>>>8^t[(b^(128|_&63))&255]);return~b}return e.table=t,e.bstr=T,e.buf=F,e.str=A,e}(),ct=function(){var r={};r.version="1.2.1";function t(I,W){for(var N=I.split("/"),U=W.split("/"),H=0,Y=0,pe=Math.min(N.length,U.length);H<pe;++H){if(Y=N[H].length-U[H].length)return Y;if(N[H]!=U[H])return N[H]<U[H]?-1:1}return N.length-U.length}function n(I){if(I.charAt(I.length-1)=="/")return I.slice(0,-1).indexOf("/")===-1?I:n(I.slice(0,-1));var W=I.lastIndexOf("/");return W===-1?I:I.slice(0,W+1)}function a(I){if(I.charAt(I.length-1)=="/")return a(I.slice(0,-1));var W=I.lastIndexOf("/");return W===-1?I:I.slice(W+1)}function s(I,W){typeof W=="string"&&(W=new Date(W));var N=W.getHours();N=N<<6|W.getMinutes(),N=N<<5|W.getSeconds()>>>1,I.write_shift(2,N);var U=W.getFullYear()-1980;U=U<<4|W.getMonth()+1,U=U<<5|W.getDate(),I.write_shift(2,U)}function o(I){var W=I.read_shift(2)&65535,N=I.read_shift(2)&65535,U=new Date,H=N&31;N>>>=5;var Y=N&15;N>>>=4,U.setMilliseconds(0),U.setFullYear(N+1980),U.setMonth(Y-1),U.setDate(H);var pe=W&31;W>>>=5;var Ee=W&63;return W>>>=6,U.setHours(W),U.setMinutes(Ee),U.setSeconds(pe<<1),U}function c(I){cr(I,0);for(var W={},N=0;I.l<=I.length-4;){var U=I.read_shift(2),H=I.read_shift(2),Y=I.l+H,pe={};switch(U){case 21589:N=I.read_shift(1),N&1&&(pe.mtime=I.read_shift(4)),H>5&&(N&2&&(pe.atime=I.read_shift(4)),N&4&&(pe.ctime=I.read_shift(4))),pe.mtime&&(pe.mt=new Date(pe.mtime*1e3));break}I.l=Y,W[U]=pe}return W}var l;function u(){return l||(l={})}function d(I,W){if(I[0]==80&&I[1]==75)return Ir(I,W);if((I[0]|32)==109&&(I[1]|32)==105)return Vr(I,W);if(I.length<512)throw new Error("CFB file size "+I.length+" < 512");var N=3,U=512,H=0,Y=0,pe=0,Ee=0,fe=0,me=[],ge=I.slice(0,512);cr(ge,0);var _e=f(ge);switch(N=_e[0],N){case 3:U=512;break;case 4:U=4096;break;case 0:if(_e[1]==0)return Ir(I,W);default:throw new Error("Major Version: Expected 3 or 4 saw "+N)}U!==512&&(ge=I.slice(0,U),cr(ge,28));var Me=I.slice(0,U);h(ge,N);var He=ge.read_shift(4,"i");if(N===3&&He!==0)throw new Error("# Directory Sectors: Expected 0 saw "+He);ge.l+=4,pe=ge.read_shift(4,"i"),ge.l+=4,ge.chk("00100000","Mini Stream Cutoff Size: "),Ee=ge.read_shift(4,"i"),H=ge.read_shift(4,"i"),fe=ge.read_shift(4,"i"),Y=ge.read_shift(4,"i");for(var je=-1,$e=0;$e<109&&(je=ge.read_shift(4,"i"),!(je<0));++$e)me[$e]=je;var rt=x(I,U);g(fe,Y,rt,U,me);var At=y(rt,pe,me,U);At[pe].name="!Directory",H>0&&Ee!==B&&(At[Ee].name="!MiniFAT"),At[me[0]].name="!FAT",At.fat_addrs=me,At.ssz=U;var kt={},fr=[],ii=[],oi=[];v(pe,At,rt,fr,H,kt,ii,Ee),m(ii,oi,fr),fr.shift();var ci={FileIndex:ii,FullPaths:oi};return W&&W.raw&&(ci.raw={header:Me,sectors:rt}),ci}function f(I){if(I[I.l]==80&&I[I.l+1]==75)return[0,0];I.chk(Q,"Header Signature: "),I.l+=16;var W=I.read_shift(2,"u");return[I.read_shift(2,"u"),W]}function h(I,W){var N=9;switch(I.l+=2,N=I.read_shift(2)){case 9:if(W!=3)throw new Error("Sector Shift: Expected 9 saw "+N);break;case 12:if(W!=4)throw new Error("Sector Shift: Expected 12 saw "+N);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+N)}I.chk("0600","Mini Sector Shift: "),I.chk("000000000000","Reserved: ")}function x(I,W){for(var N=Math.ceil(I.length/W)-1,U=[],H=1;H<N;++H)U[H-1]=I.slice(H*W,(H+1)*W);return U[N-1]=I.slice(N*W),U}function m(I,W,N){for(var U=0,H=0,Y=0,pe=0,Ee=0,fe=N.length,me=[],ge=[];U<fe;++U)me[U]=ge[U]=U,W[U]=N[U];for(;Ee<ge.length;++Ee)U=ge[Ee],H=I[U].L,Y=I[U].R,pe=I[U].C,me[U]===U&&(H!==-1&&me[H]!==H&&(me[U]=me[H]),Y!==-1&&me[Y]!==Y&&(me[U]=me[Y])),pe!==-1&&(me[pe]=U),H!==-1&&U!=me[U]&&(me[H]=me[U],ge.lastIndexOf(H)<Ee&&ge.push(H)),Y!==-1&&U!=me[U]&&(me[Y]=me[U],ge.lastIndexOf(Y)<Ee&&ge.push(Y));for(U=1;U<fe;++U)me[U]===U&&(Y!==-1&&me[Y]!==Y?me[U]=me[Y]:H!==-1&&me[H]!==H&&(me[U]=me[H]));for(U=1;U<fe;++U)if(I[U].type!==0){if(Ee=U,Ee!=me[Ee])do Ee=me[Ee],W[U]=W[Ee]+"/"+W[U];while(Ee!==0&&me[Ee]!==-1&&Ee!=me[Ee]);me[U]=-1}for(W[0]+="/",U=1;U<fe;++U)I[U].type!==2&&(W[U]+="/")}function p(I,W,N){for(var U=I.start,H=I.size,Y=[],pe=U;N&&H>0&&pe>=0;)Y.push(W.slice(pe*_,pe*_+_)),H-=_,pe=$a(N,pe*4);return Y.length===0?Kt(0):fa(Y).slice(0,I.size)}function g(I,W,N,U,H){var Y=B;if(I===B){if(W!==0)throw new Error("DIFAT chain shorter than expected")}else if(I!==-1){var pe=N[I],Ee=(U>>>2)-1;if(!pe)return;for(var fe=0;fe<Ee&&(Y=$a(pe,fe*4))!==B;++fe)H.push(Y);g($a(pe,U-4),W-1,N,U,H)}}function w(I,W,N,U,H){var Y=[],pe=[];H||(H=[]);var Ee=U-1,fe=0,me=0;for(fe=W;fe>=0;){H[fe]=!0,Y[Y.length]=fe,pe.push(I[fe]);var ge=N[Math.floor(fe*4/U)];if(me=fe*4&Ee,U<4+me)throw new Error("FAT boundary crossed: "+fe+" 4 "+U);if(!I[ge])break;fe=$a(I[ge],me)}return{nodes:Y,data:Dh([pe])}}function y(I,W,N,U){var H=I.length,Y=[],pe=[],Ee=[],fe=[],me=U-1,ge=0,_e=0,Me=0,He=0;for(ge=0;ge<H;++ge)if(Ee=[],Me=ge+W,Me>=H&&(Me-=H),!pe[Me]){fe=[];var je=[];for(_e=Me;_e>=0;){je[_e]=!0,pe[_e]=!0,Ee[Ee.length]=_e,fe.push(I[_e]);var $e=N[Math.floor(_e*4/U)];if(He=_e*4&me,U<4+He)throw new Error("FAT boundary crossed: "+_e+" 4 "+U);if(!I[$e]||(_e=$a(I[$e],He),je[_e]))break}Y[Me]={nodes:Ee,data:Dh([fe])}}return Y}function v(I,W,N,U,H,Y,pe,Ee){for(var fe=0,me=U.length?2:0,ge=W[I].data,_e=0,Me=0,He;_e<ge.length;_e+=128){var je=ge.slice(_e,_e+128);cr(je,64),Me=je.read_shift(2),He=jd(je,0,Me-me),U.push(He);var $e={name:He,type:je.read_shift(1),color:je.read_shift(1),L:je.read_shift(4,"i"),R:je.read_shift(4,"i"),C:je.read_shift(4,"i"),clsid:je.read_shift(16),state:je.read_shift(4,"i"),start:0,size:0},rt=je.read_shift(2)+je.read_shift(2)+je.read_shift(2)+je.read_shift(2);rt!==0&&($e.ct=T(je,je.l-8));var At=je.read_shift(2)+je.read_shift(2)+je.read_shift(2)+je.read_shift(2);At!==0&&($e.mt=T(je,je.l-8)),$e.start=je.read_shift(4,"i"),$e.size=je.read_shift(4,"i"),$e.size<0&&$e.start<0&&($e.size=$e.type=0,$e.start=B,$e.name=""),$e.type===5?(fe=$e.start,H>0&&fe!==B&&(W[fe].name="!StreamData")):$e.size>=4096?($e.storage="fat",W[$e.start]===void 0&&(W[$e.start]=w(N,$e.start,W.fat_addrs,W.ssz)),W[$e.start].name=$e.name,$e.content=W[$e.start].data.slice(0,$e.size)):($e.storage="minifat",$e.size<0?$e.size=0:fe!==B&&$e.start!==B&&W[fe]&&($e.content=p($e,W[fe].data,(W[Ee]||{}).data))),$e.content&&cr($e.content,0),Y[He]=$e,pe.push($e)}}function T(I,W){return new Date((Yr(I,W+4)/1e7*Math.pow(2,32)+Yr(I,W)/1e7-11644473600)*1e3)}function F(I,W){return u(),d(l.readFileSync(I),W)}function A(I,W){var N=W&&W.type;switch(N||ot&&Buffer.isBuffer(I)&&(N="buffer"),N||"base64"){case"file":return F(I,W);case"base64":return d(vn(Kr(I)),W);case"binary":return d(vn(I),W)}return d(I,W)}function S(I,W){var N=W||{},U=N.root||"Root Entry";if(I.FullPaths||(I.FullPaths=[]),I.FileIndex||(I.FileIndex=[]),I.FullPaths.length!==I.FileIndex.length)throw new Error("inconsistent CFB structure");I.FullPaths.length===0&&(I.FullPaths[0]=U+"/",I.FileIndex[0]={name:U,type:5}),N.CLSID&&(I.FileIndex[0].clsid=N.CLSID),E(I)}function E(I){var W="Sh33tJ5";if(!ct.find(I,"/"+W)){var N=Kt(4);N[0]=55,N[1]=N[3]=50,N[2]=54,I.FileIndex.push({name:W,type:2,content:N,size:4,L:69,R:69,C:69}),I.FullPaths.push(I.FullPaths[0]+W),b(I)}}function b(I,W){S(I);for(var N=!1,U=!1,H=I.FullPaths.length-1;H>=0;--H){var Y=I.FileIndex[H];switch(Y.type){case 0:U?N=!0:(I.FileIndex.pop(),I.FullPaths.pop());break;case 1:case 2:case 5:U=!0,isNaN(Y.R*Y.L*Y.C)&&(N=!0),Y.R>-1&&Y.L>-1&&Y.R==Y.L&&(N=!0);break;default:N=!0;break}}if(!(!N&&!W)){var pe=new Date(1987,1,19),Ee=0,fe=Object.create?Object.create(null):{},me=[];for(H=0;H<I.FullPaths.length;++H)fe[I.FullPaths[H]]=!0,I.FileIndex[H].type!==0&&me.push([I.FullPaths[H],I.FileIndex[H]]);for(H=0;H<me.length;++H){var ge=n(me[H][0]);U=fe[ge],U||(me.push([ge,{name:a(ge).replace("/",""),type:1,clsid:L,ct:pe,mt:pe,content:null}]),fe[ge]=!0)}for(me.sort(function(He,je){return t(He[0],je[0])}),I.FullPaths=[],I.FileIndex=[],H=0;H<me.length;++H)I.FullPaths[H]=me[H][0],I.FileIndex[H]=me[H][1];for(H=0;H<me.length;++H){var _e=I.FileIndex[H],Me=I.FullPaths[H];if(_e.name=a(Me).replace("/",""),_e.L=_e.R=_e.C=-(_e.color=1),_e.size=_e.content?_e.content.length:0,_e.start=0,_e.clsid=_e.clsid||L,H===0)_e.C=me.length>1?1:-1,_e.size=0,_e.type=5;else if(Me.slice(-1)=="/"){for(Ee=H+1;Ee<me.length&&n(I.FullPaths[Ee])!=Me;++Ee);for(_e.C=Ee>=me.length?-1:Ee,Ee=H+1;Ee<me.length&&n(I.FullPaths[Ee])!=n(Me);++Ee);_e.R=Ee>=me.length?-1:Ee,_e.type=1}else n(I.FullPaths[H+1]||"")==n(Me)&&(_e.R=H+1),_e.type=2}}}function k(I,W){var N=W||{};if(N.fileType=="mad")return vo(I,N);switch(b(I),N.fileType){case"zip":return Pr(I,N)}var U=function(He){for(var je=0,$e=0,rt=0;rt<He.FileIndex.length;++rt){var At=He.FileIndex[rt];if(At.content){var kt=At.content.length;kt>0&&(kt<4096?je+=kt+63>>6:$e+=kt+511>>9)}}for(var fr=He.FullPaths.length+3>>2,ii=je+7>>3,oi=je+127>>7,ci=ii+$e+fr+oi,_a=ci+127>>7,tl=_a<=109?0:Math.ceil((_a-109)/127);ci+_a+tl+127>>7>_a;)tl=++_a<=109?0:Math.ceil((_a-109)/127);var zn=[1,tl,_a,oi,fr,$e,je,0];return He.FileIndex[0].size=je<<6,zn[7]=(He.FileIndex[0].start=zn[0]+zn[1]+zn[2]+zn[3]+zn[4]+zn[5])+(zn[6]+7>>3),zn}(I),H=Kt(U[7]<<9),Y=0,pe=0;{for(Y=0;Y<8;++Y)H.write_shift(1,Z[Y]);for(Y=0;Y<8;++Y)H.write_shift(2,0);for(H.write_shift(2,62),H.write_shift(2,3),H.write_shift(2,65534),H.write_shift(2,9),H.write_shift(2,6),Y=0;Y<3;++Y)H.write_shift(2,0);for(H.write_shift(4,0),H.write_shift(4,U[2]),H.write_shift(4,U[0]+U[1]+U[2]+U[3]-1),H.write_shift(4,0),H.write_shift(4,4096),H.write_shift(4,U[3]?U[0]+U[1]+U[2]-1:B),H.write_shift(4,U[3]),H.write_shift(-4,U[1]?U[0]-1:B),H.write_shift(4,U[1]),Y=0;Y<109;++Y)H.write_shift(-4,Y<U[2]?U[1]+Y:-1)}if(U[1])for(pe=0;pe<U[1];++pe){for(;Y<236+pe*127;++Y)H.write_shift(-4,Y<U[2]?U[1]+Y:-1);H.write_shift(-4,pe===U[1]-1?B:pe+1)}var Ee=function(He){for(pe+=He;Y<pe-1;++Y)H.write_shift(-4,Y+1);He&&(++Y,H.write_shift(-4,B))};for(pe=Y=0,pe+=U[1];Y<pe;++Y)H.write_shift(-4,q.DIFSECT);for(pe+=U[2];Y<pe;++Y)H.write_shift(-4,q.FATSECT);Ee(U[3]),Ee(U[4]);for(var fe=0,me=0,ge=I.FileIndex[0];fe<I.FileIndex.length;++fe)ge=I.FileIndex[fe],ge.content&&(me=ge.content.length,!(me<4096)&&(ge.start=pe,Ee(me+511>>9)));for(Ee(U[6]+7>>3);H.l&511;)H.write_shift(-4,q.ENDOFCHAIN);for(pe=Y=0,fe=0;fe<I.FileIndex.length;++fe)ge=I.FileIndex[fe],ge.content&&(me=ge.content.length,!(!me||me>=4096)&&(ge.start=pe,Ee(me+63>>6)));for(;H.l&511;)H.write_shift(-4,q.ENDOFCHAIN);for(Y=0;Y<U[4]<<2;++Y){var _e=I.FullPaths[Y];if(!_e||_e.length===0){for(fe=0;fe<17;++fe)H.write_shift(4,0);for(fe=0;fe<3;++fe)H.write_shift(4,-1);for(fe=0;fe<12;++fe)H.write_shift(4,0);continue}ge=I.FileIndex[Y],Y===0&&(ge.start=ge.size?ge.start-1:B);var Me=Y===0&&N.root||ge.name;if(me=2*(Me.length+1),H.write_shift(64,Me,"utf16le"),H.write_shift(2,me),H.write_shift(1,ge.type),H.write_shift(1,ge.color),H.write_shift(-4,ge.L),H.write_shift(-4,ge.R),H.write_shift(-4,ge.C),ge.clsid)H.write_shift(16,ge.clsid,"hex");else for(fe=0;fe<4;++fe)H.write_shift(4,0);H.write_shift(4,ge.state||0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,ge.start),H.write_shift(4,ge.size),H.write_shift(4,0)}for(Y=1;Y<I.FileIndex.length;++Y)if(ge=I.FileIndex[Y],ge.size>=4096)if(H.l=ge.start+1<<9,ot&&Buffer.isBuffer(ge.content))ge.content.copy(H,H.l,0,ge.size),H.l+=ge.size+511&-512;else{for(fe=0;fe<ge.size;++fe)H.write_shift(1,ge.content[fe]);for(;fe&511;++fe)H.write_shift(1,0)}for(Y=1;Y<I.FileIndex.length;++Y)if(ge=I.FileIndex[Y],ge.size>0&&ge.size<4096)if(ot&&Buffer.isBuffer(ge.content))ge.content.copy(H,H.l,0,ge.size),H.l+=ge.size+63&-64;else{for(fe=0;fe<ge.size;++fe)H.write_shift(1,ge.content[fe]);for(;fe&63;++fe)H.write_shift(1,0)}if(ot)H.l=H.length;else for(;H.l<H.length;)H.write_shift(1,0);return H}function j(I,W){var N=I.FullPaths.map(function(fe){return fe.toUpperCase()}),U=N.map(function(fe){var me=fe.split("/");return me[me.length-(fe.slice(-1)=="/"?2:1)]}),H=!1;W.charCodeAt(0)===47?(H=!0,W=N[0].slice(0,-1)+W):H=W.indexOf("/")!==-1;var Y=W.toUpperCase(),pe=H===!0?N.indexOf(Y):U.indexOf(Y);if(pe!==-1)return I.FileIndex[pe];var Ee=!Y.match(Si);for(Y=Y.replace(Fr,""),Ee&&(Y=Y.replace(Si,"!")),pe=0;pe<N.length;++pe)if((Ee?N[pe].replace(Si,"!"):N[pe]).replace(Fr,"")==Y||(Ee?U[pe].replace(Si,"!"):U[pe]).replace(Fr,"")==Y)return I.FileIndex[pe];return null}var _=64,B=-2,Q="d0cf11e0a1b11ae1",Z=[208,207,17,224,161,177,26,225],L="00000000000000000000000000000000",q={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:B,FREESECT:-1,HEADER_SIGNATURE:Q,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:L,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function te(I,W,N){u();var U=k(I,N);l.writeFileSync(W,U)}function R(I){for(var W=new Array(I.length),N=0;N<I.length;++N)W[N]=String.fromCharCode(I[N]);return W.join("")}function oe(I,W){var N=k(I,W);switch(W&&W.type||"buffer"){case"file":return u(),l.writeFileSync(W.filename,N),N;case"binary":return typeof N=="string"?N:R(N);case"base64":return dh(typeof N=="string"?N:R(N));case"buffer":if(ot)return Buffer.isBuffer(N)?N:gs(N);case"array":return typeof N=="string"?vn(N):N}return N}var J;function P(I){try{var W=I.InflateRaw,N=new W;if(N._processChunk(new Uint8Array([3,0]),N._finishFlushFlag),N.bytesRead)J=I;else throw new Error("zlib does not expose bytesRead")}catch(U){console.error("cannot use native zlib: "+(U.message||U))}}function V(I,W){if(!J)return Nt(I,W);var N=J.InflateRaw,U=new N,H=U._processChunk(I.slice(I.l),U._finishFlushFlag);return I.l+=U.bytesRead,H}function z(I){return J?J.deflateRawSync(I):Ie(I)}var G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ne=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],he=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function se(I){var W=(I<<1|I<<11)&139536|(I<<5|I<<15)&558144;return(W>>16|W>>8|W)&255}for(var ae=typeof Uint8Array<"u",K=ae?new Uint8Array(256):[],O=0;O<256;++O)K[O]=se(O);function D(I,W){var N=K[I&255];return W<=8?N>>>8-W:(N=N<<8|K[I>>8&255],W<=16?N>>>16-W:(N=N<<8|K[I>>16&255],N>>>24-W))}function re(I,W){var N=W&7,U=W>>>3;return(I[U]|(N<=6?0:I[U+1]<<8))>>>N&3}function le(I,W){var N=W&7,U=W>>>3;return(I[U]|(N<=5?0:I[U+1]<<8))>>>N&7}function Te(I,W){var N=W&7,U=W>>>3;return(I[U]|(N<=4?0:I[U+1]<<8))>>>N&15}function ue(I,W){var N=W&7,U=W>>>3;return(I[U]|(N<=3?0:I[U+1]<<8))>>>N&31}function we(I,W){var N=W&7,U=W>>>3;return(I[U]|(N<=1?0:I[U+1]<<8))>>>N&127}function xe(I,W,N){var U=W&7,H=W>>>3,Y=(1<<N)-1,pe=I[H]>>>U;return N<8-U||(pe|=I[H+1]<<8-U,N<16-U)||(pe|=I[H+2]<<16-U,N<24-U)||(pe|=I[H+3]<<24-U),pe&Y}function Ce(I,W,N){var U=W&7,H=W>>>3;return U<=5?I[H]|=(N&7)<<U:(I[H]|=N<<U&255,I[H+1]=(N&7)>>8-U),W+3}function Oe(I,W,N){var U=W&7,H=W>>>3;return N=(N&1)<<U,I[H]|=N,W+1}function ze(I,W,N){var U=W&7,H=W>>>3;return N<<=U,I[H]|=N&255,N>>>=8,I[H+1]=N,W+8}function M(I,W,N){var U=W&7,H=W>>>3;return N<<=U,I[H]|=N&255,N>>>=8,I[H+1]=N&255,I[H+2]=N>>>8,W+16}function ce(I,W){var N=I.length,U=2*N>W?2*N:W+5,H=0;if(N>=W)return I;if(ot){var Y=fh(U);if(I.copy)I.copy(Y);else for(;H<I.length;++H)Y[H]=I[H];return Y}else if(ae){var pe=new Uint8Array(U);if(pe.set)pe.set(I);else for(;H<N;++H)pe[H]=I[H];return pe}return I.length=U,I}function de(I){for(var W=new Array(I),N=0;N<I;++N)W[N]=0;return W}function Se(I,W,N){var U=1,H=0,Y=0,pe=0,Ee=0,fe=I.length,me=ae?new Uint16Array(32):de(32);for(Y=0;Y<32;++Y)me[Y]=0;for(Y=fe;Y<N;++Y)I[Y]=0;fe=I.length;var ge=ae?new Uint16Array(fe):de(fe);for(Y=0;Y<fe;++Y)me[H=I[Y]]++,U<H&&(U=H),ge[Y]=0;for(me[0]=0,Y=1;Y<=U;++Y)me[Y+16]=Ee=Ee+me[Y-1]<<1;for(Y=0;Y<fe;++Y)Ee=I[Y],Ee!=0&&(ge[Y]=me[Ee+16]++);var _e=0;for(Y=0;Y<fe;++Y)if(_e=I[Y],_e!=0)for(Ee=D(ge[Y],U)>>U-_e,pe=(1<<U+4-_e)-1;pe>=0;--pe)W[Ee|pe<<_e]=_e&15|Y<<4;return U}var ke=ae?new Uint16Array(512):de(512),Be=ae?new Uint16Array(32):de(32);if(!ae){for(var Ve=0;Ve<512;++Ve)ke[Ve]=0;for(Ve=0;Ve<32;++Ve)Be[Ve]=0}(function(){for(var I=[],W=0;W<32;W++)I.push(5);Se(I,Be,32);var N=[];for(W=0;W<=143;W++)N.push(8);for(;W<=255;W++)N.push(9);for(;W<=279;W++)N.push(7);for(;W<=287;W++)N.push(8);Se(N,ke,288)})();var Fe=function(){for(var W=ae?new Uint8Array(32768):[],N=0,U=0;N<he.length-1;++N)for(;U<he[N+1];++U)W[U]=N;for(;U<32768;++U)W[U]=29;var H=ae?new Uint8Array(259):[];for(N=0,U=0;N<ne.length-1;++N)for(;U<ne[N+1];++U)H[U]=N;function Y(Ee,fe){for(var me=0;me<Ee.length;){var ge=Math.min(65535,Ee.length-me),_e=me+ge==Ee.length;for(fe.write_shift(1,+_e),fe.write_shift(2,ge),fe.write_shift(2,~ge&65535);ge-- >0;)fe[fe.l++]=Ee[me++]}return fe.l}function pe(Ee,fe){for(var me=0,ge=0,_e=ae?new Uint16Array(32768):[];ge<Ee.length;){var Me=Math.min(65535,Ee.length-ge);if(Me<10){for(me=Ce(fe,me,+(ge+Me==Ee.length)),me&7&&(me+=8-(me&7)),fe.l=me/8|0,fe.write_shift(2,Me),fe.write_shift(2,~Me&65535);Me-- >0;)fe[fe.l++]=Ee[ge++];me=fe.l*8;continue}me=Ce(fe,me,+(ge+Me==Ee.length)+2);for(var He=0;Me-- >0;){var je=Ee[ge];He=(He<<5^je)&32767;var $e=-1,rt=0;if(($e=_e[He])&&($e|=ge&-32768,$e>ge&&($e-=32768),$e<ge))for(;Ee[$e+rt]==Ee[ge+rt]&&rt<250;)++rt;if(rt>2){je=H[rt],je<=22?me=ze(fe,me,K[je+1]>>1)-1:(ze(fe,me,3),me+=5,ze(fe,me,K[je-23]>>5),me+=3);var At=je<8?0:je-4>>2;At>0&&(M(fe,me,rt-ne[je]),me+=At),je=W[ge-$e],me=ze(fe,me,K[je]>>3),me-=3;var kt=je<4?0:je-2>>1;kt>0&&(M(fe,me,ge-$e-he[je]),me+=kt);for(var fr=0;fr<rt;++fr)_e[He]=ge&32767,He=(He<<5^Ee[ge])&32767,++ge;Me-=rt-1}else je<=143?je=je+48:me=Oe(fe,me,1),me=ze(fe,me,K[je]),_e[He]=ge&32767,++ge}me=ze(fe,me,0)-1}return fe.l=(me+7)/8|0,fe.l}return function(fe,me){return fe.length<8?Y(fe,me):pe(fe,me)}}();function Ie(I){var W=Kt(50+Math.floor(I.length*1.1)),N=Fe(I,W);return W.slice(0,N)}var We=ae?new Uint16Array(32768):de(32768),qe=ae?new Uint16Array(32768):de(32768),tt=ae?new Uint16Array(128):de(128),ut=1,or=1;function Ht(I,W){var N=ue(I,W)+257;W+=5;var U=ue(I,W)+1;W+=5;var H=Te(I,W)+4;W+=4;for(var Y=0,pe=ae?new Uint8Array(19):de(19),Ee=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],fe=1,me=ae?new Uint8Array(8):de(8),ge=ae?new Uint8Array(8):de(8),_e=pe.length,Me=0;Me<H;++Me)pe[G[Me]]=Y=le(I,W),fe<Y&&(fe=Y),me[Y]++,W+=3;var He=0;for(me[0]=0,Me=1;Me<=fe;++Me)ge[Me]=He=He+me[Me-1]<<1;for(Me=0;Me<_e;++Me)(He=pe[Me])!=0&&(Ee[Me]=ge[He]++);var je=0;for(Me=0;Me<_e;++Me)if(je=pe[Me],je!=0){He=K[Ee[Me]]>>8-je;for(var $e=(1<<7-je)-1;$e>=0;--$e)tt[He|$e<<je]=je&7|Me<<3}var rt=[];for(fe=1;rt.length<N+U;)switch(He=tt[we(I,W)],W+=He&7,He>>>=3){case 16:for(Y=3+re(I,W),W+=2,He=rt[rt.length-1];Y-- >0;)rt.push(He);break;case 17:for(Y=3+le(I,W),W+=3;Y-- >0;)rt.push(0);break;case 18:for(Y=11+we(I,W),W+=7;Y-- >0;)rt.push(0);break;default:rt.push(He),fe<He&&(fe=He);break}var At=rt.slice(0,N),kt=rt.slice(N);for(Me=N;Me<286;++Me)At[Me]=0;for(Me=U;Me<30;++Me)kt[Me]=0;return ut=Se(At,We,286),or=Se(kt,qe,30),W}function it(I,W){if(I[0]==3&&!(I[1]&3))return[Sa(W),2];for(var N=0,U=0,H=fh(W||1<<18),Y=0,pe=H.length>>>0,Ee=0,fe=0;!(U&1);){if(U=le(I,N),N+=3,U>>>1)U>>1==1?(Ee=9,fe=5):(N=Ht(I,N),Ee=ut,fe=or);else{N&7&&(N+=8-(N&7));var me=I[N>>>3]|I[(N>>>3)+1]<<8;if(N+=32,me>0)for(!W&&pe<Y+me&&(H=ce(H,Y+me),pe=H.length);me-- >0;)H[Y++]=I[N>>>3],N+=8;continue}for(;;){!W&&pe<Y+32767&&(H=ce(H,Y+32767),pe=H.length);var ge=xe(I,N,Ee),_e=U>>>1==1?ke[ge]:We[ge];if(N+=_e&15,_e>>>=4,!(_e>>>8&255))H[Y++]=_e;else{if(_e==256)break;_e-=257;var Me=_e<8?0:_e-4>>2;Me>5&&(Me=0);var He=Y+ne[_e];Me>0&&(He+=xe(I,N,Me),N+=Me),ge=xe(I,N,fe),_e=U>>>1==1?Be[ge]:qe[ge],N+=_e&15,_e>>>=4;var je=_e<4?0:_e-2>>1,$e=he[_e];for(je>0&&($e+=xe(I,N,je),N+=je),!W&&pe<He&&(H=ce(H,He+100),pe=H.length);Y<He;)H[Y]=H[Y-$e],++Y}}}return W?[H,N+7>>>3]:[H.slice(0,Y),N+7>>>3]}function Nt(I,W){var N=I.slice(I.l||0),U=it(N,W);return I.l+=U[1],U[0]}function tr(I,W){if(I)typeof console<"u"&&console.error(W);else throw new Error(W)}function Ir(I,W){var N=I;cr(N,0);var U=[],H=[],Y={FileIndex:U,FullPaths:H};S(Y,{root:W.root});for(var pe=N.length-4;(N[pe]!=80||N[pe+1]!=75||N[pe+2]!=5||N[pe+3]!=6)&&pe>=0;)--pe;N.l=pe+4,N.l+=4;var Ee=N.read_shift(2);N.l+=6;var fe=N.read_shift(4);for(N.l=fe,pe=0;pe<Ee;++pe){N.l+=20;var me=N.read_shift(4),ge=N.read_shift(4),_e=N.read_shift(2),Me=N.read_shift(2),He=N.read_shift(2);N.l+=8;var je=N.read_shift(4),$e=c(N.slice(N.l+_e,N.l+_e+Me));N.l+=_e+Me+He;var rt=N.l;N.l=je+4,Es(N,me,ge,Y,$e),N.l=rt}return Y}function Es(I,W,N,U,H){I.l+=2;var Y=I.read_shift(2),pe=I.read_shift(2),Ee=o(I);if(Y&8257)throw new Error("Unsupported ZIP encryption");for(var fe=I.read_shift(4),me=I.read_shift(4),ge=I.read_shift(4),_e=I.read_shift(2),Me=I.read_shift(2),He="",je=0;je<_e;++je)He+=String.fromCharCode(I[I.l++]);if(Me){var $e=c(I.slice(I.l,I.l+Me));($e[21589]||{}).mt&&(Ee=$e[21589].mt),((H||{})[21589]||{}).mt&&(Ee=H[21589].mt)}I.l+=Me;var rt=I.slice(I.l,I.l+me);switch(pe){case 8:rt=V(I,ge);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+pe)}var At=!1;Y&8&&(fe=I.read_shift(4),fe==134695760&&(fe=I.read_shift(4),At=!0),me=I.read_shift(4),ge=I.read_shift(4)),me!=W&&tr(At,"Bad compressed size: "+W+" != "+me),ge!=N&&tr(At,"Bad uncompressed size: "+N+" != "+ge),el(U,He,rt,{unsafe:!0,mt:Ee})}function Pr(I,W){var N=W||{},U=[],H=[],Y=Kt(1),pe=N.compression?8:0,Ee=0,fe=0,me=0,ge=0,_e=0,Me=I.FullPaths[0],He=Me,je=I.FileIndex[0],$e=[],rt=0;for(fe=1;fe<I.FullPaths.length;++fe)if(He=I.FullPaths[fe].slice(Me.length),je=I.FileIndex[fe],!(!je.size||!je.content||He=="Sh33tJ5")){var At=ge,kt=Kt(He.length);for(me=0;me<He.length;++me)kt.write_shift(1,He.charCodeAt(me)&127);kt=kt.slice(0,kt.l),$e[_e]=DO.buf(je.content,0);var fr=je.content;pe==8&&(fr=z(fr)),Y=Kt(30),Y.write_shift(4,67324752),Y.write_shift(2,20),Y.write_shift(2,Ee),Y.write_shift(2,pe),je.mt?s(Y,je.mt):Y.write_shift(4,0),Y.write_shift(-4,$e[_e]),Y.write_shift(4,fr.length),Y.write_shift(4,je.content.length),Y.write_shift(2,kt.length),Y.write_shift(2,0),ge+=Y.length,U.push(Y),ge+=kt.length,U.push(kt),ge+=fr.length,U.push(fr),Y=Kt(46),Y.write_shift(4,33639248),Y.write_shift(2,0),Y.write_shift(2,20),Y.write_shift(2,Ee),Y.write_shift(2,pe),Y.write_shift(4,0),Y.write_shift(-4,$e[_e]),Y.write_shift(4,fr.length),Y.write_shift(4,je.content.length),Y.write_shift(2,kt.length),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(4,0),Y.write_shift(4,At),rt+=Y.l,H.push(Y),rt+=kt.length,H.push(kt),++_e}return Y=Kt(22),Y.write_shift(4,101010256),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,_e),Y.write_shift(2,_e),Y.write_shift(4,rt),Y.write_shift(4,ge),Y.write_shift(2,0),fa([fa(U),fa(H),Y])}var Ts={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Qc(I,W){if(I.ctype)return I.ctype;var N=I.name||"",U=N.match(/\.([^\.]+)$/);return U&&Ts[U[1]]||W&&(U=(N=W).match(/[\.\\]([^\.\\])+$/),U&&Ts[U[1]])?Ts[U[1]]:"application/octet-stream"}function Zc(I){for(var W=dh(I),N=[],U=0;U<W.length;U+=76)N.push(W.slice(U,U+76));return N.join(`\r
`)+`\r
`}function xf(I){var W=I.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(me){var ge=me.charCodeAt(0).toString(16).toUpperCase();return"="+(ge.length==1?"0"+ge:ge)});W=W.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),W.charAt(0)==`
`&&(W="=0D"+W.slice(1)),W=W.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var N=[],U=W.split(`\r
`),H=0;H<U.length;++H){var Y=U[H];if(Y.length==0){N.push("");continue}for(var pe=0;pe<Y.length;){var Ee=76,fe=Y.slice(pe,pe+Ee);fe.charAt(Ee-1)=="="?Ee--:fe.charAt(Ee-2)=="="?Ee-=2:fe.charAt(Ee-3)=="="&&(Ee-=3),fe=Y.slice(pe,pe+Ee),pe+=Ee,pe<Y.length&&(fe+="="),N.push(fe)}}return N.join(`\r
`)}function gf(I){for(var W=[],N=0;N<I.length;++N){for(var U=I[N];N<=I.length&&U.charAt(U.length-1)=="=";)U=U.slice(0,U.length-1)+I[++N];W.push(U)}for(var H=0;H<W.length;++H)W[H]=W[H].replace(/[=][0-9A-Fa-f]{2}/g,function(Y){return String.fromCharCode(parseInt(Y.slice(1),16))});return vn(W.join(`\r
`))}function jt(I,W,N){for(var U="",H="",Y="",pe,Ee=0;Ee<10;++Ee){var fe=W[Ee];if(!fe||fe.match(/^\s*$/))break;var me=fe.match(/^(.*?):\s*([^\s].*)$/);if(me)switch(me[1].toLowerCase()){case"content-location":U=me[2].trim();break;case"content-type":Y=me[2].trim();break;case"content-transfer-encoding":H=me[2].trim();break}}switch(++Ee,H.toLowerCase()){case"base64":pe=vn(Kr(W.slice(Ee).join("")));break;case"quoted-printable":pe=gf(W.slice(Ee));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+H)}var ge=el(I,U.slice(N.length),pe,{unsafe:!0});Y&&(ge.ctype=Y)}function Vr(I,W){if(R(I.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var N=W&&W.root||"",U=(ot&&Buffer.isBuffer(I)?I.toString("binary"):R(I)).split(`\r
`),H=0,Y="";for(H=0;H<U.length;++H)if(Y=U[H],!!/^Content-Location:/i.test(Y)&&(Y=Y.slice(Y.indexOf("file")),N||(N=Y.slice(0,Y.lastIndexOf("/")+1)),Y.slice(0,N.length)!=N))for(;N.length>0&&(N=N.slice(0,N.length-1),N=N.slice(0,N.lastIndexOf("/")+1),Y.slice(0,N.length)!=N););var pe=(U[1]||"").match(/boundary="(.*?)"/);if(!pe)throw new Error("MAD cannot find boundary");var Ee="--"+(pe[1]||""),fe=[],me=[],ge={FileIndex:fe,FullPaths:me};S(ge);var _e,Me=0;for(H=0;H<U.length;++H){var He=U[H];He!==Ee&&He!==Ee+"--"||(Me++&&jt(ge,U.slice(_e,H),N),_e=H)}return ge}function vo(I,W){var N=W||{},U=N.boundary||"SheetJS";U="------="+U;for(var H=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+U.slice(2)+'"',"","",""],Y=I.FullPaths[0],pe=Y,Ee=I.FileIndex[0],fe=1;fe<I.FullPaths.length;++fe)if(pe=I.FullPaths[fe].slice(Y.length),Ee=I.FileIndex[fe],!(!Ee.size||!Ee.content||pe=="Sh33tJ5")){pe=pe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(rt){return"_x"+rt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(rt){return"_u"+rt.charCodeAt(0).toString(16)+"_"});for(var me=Ee.content,ge=ot&&Buffer.isBuffer(me)?me.toString("binary"):R(me),_e=0,Me=Math.min(1024,ge.length),He=0,je=0;je<=Me;++je)(He=ge.charCodeAt(je))>=32&&He<128&&++_e;var $e=_e>=Me*4/5;H.push(U),H.push("Content-Location: "+(N.root||"file:///C:/SheetJS/")+pe),H.push("Content-Transfer-Encoding: "+($e?"quoted-printable":"base64")),H.push("Content-Type: "+Qc(Ee,pe)),H.push(""),H.push($e?xf(ge):Zc(ge))}return H.push(U+`--\r
`),H.join(`\r
`)}function yy(I){var W={};return S(W,I),W}function el(I,W,N,U){var H=U&&U.unsafe;H||S(I);var Y=!H&&ct.find(I,W);if(!Y){var pe=I.FullPaths[0];W.slice(0,pe.length)==pe?pe=W:(pe.slice(-1)!="/"&&(pe+="/"),pe=(pe+W).replace("//","/")),Y={name:a(W),type:2},I.FileIndex.push(Y),I.FullPaths.push(pe),H||ct.utils.cfb_gc(I)}return Y.content=N,Y.size=N?N.length:0,U&&(U.CLSID&&(Y.clsid=U.CLSID),U.mt&&(Y.mt=U.mt),U.ct&&(Y.ct=U.ct)),Y}function vy(I,W){S(I);var N=ct.find(I,W);if(N){for(var U=0;U<I.FileIndex.length;++U)if(I.FileIndex[U]==N)return I.FileIndex.splice(U,1),I.FullPaths.splice(U,1),!0}return!1}function by(I,W,N){S(I);var U=ct.find(I,W);if(U){for(var H=0;H<I.FileIndex.length;++H)if(I.FileIndex[H]==U)return I.FileIndex[H].name=a(N),I.FullPaths[H]=N,!0}return!1}function wy(I){b(I,!0)}return r.find=j,r.read=A,r.parse=d,r.write=oe,r.writeFile=te,r.utils={cfb_new:yy,cfb_add:el,cfb_del:vy,cfb_mov:by,cfb_gc:wy,ReadShift:Ci,CheckField:t1,prep_blob:cr,bconcat:fa,use_zlib:P,_deflateRaw:Ie,_inflateRaw:Nt,consts:q},r}();function FO(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(e);r.open("r"),r.encoding="binary";var t=r.read();return r.close(),t}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Un(e){for(var r=Object.keys(e),t=[],n=0;n<r.length;++n)Object.prototype.hasOwnProperty.call(e,r[n])&&t.push(r[n]);return t}function Cd(e){for(var r=[],t=Un(e),n=0;n!==t.length;++n)r[e[t[n]]]=t[n];return r}var cc=new Date(1899,11,30,0,0,0);function jr(e,r){var t=e.getTime();r&&(t-=1462*24*60*60*1e3);var n=cc.getTime()+(e.getTimezoneOffset()-cc.getTimezoneOffset())*6e4;return(t-n)/(24*60*60*1e3)}var Pg=new Date,jO=cc.getTime()+(Pg.getTimezoneOffset()-cc.getTimezoneOffset())*6e4,bh=Pg.getTimezoneOffset();function qc(e){var r=new Date;return r.setTime(e*24*60*60*1e3+jO),r.getTimezoneOffset()!==bh&&r.setTime(r.getTime()+(r.getTimezoneOffset()-bh)*6e4),r}function IO(e){var r=0,t=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(t=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":t*=24;case"H":t*=60;case"M":if(n)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}r+=t*parseInt(a[s],10)}return r}var wh=new Date("2017-02-19T19:06:09.000Z"),Og=isNaN(wh.getFullYear())?new Date("2/19/17"):wh,PO=Og.getFullYear()==2017;function ir(e,r){var t=new Date(e);if(PO)return r>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):r<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(Og.getFullYear()==1917&&!isNaN(t.getFullYear())){var n=t.getFullYear();return e.indexOf(""+n)>-1||t.setFullYear(t.getFullYear()+100),t}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function os(e,r){if(ot&&Buffer.isBuffer(e)){if(r){if(e[0]==255&&e[1]==254)return Ti(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Ti(bg(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(e[0]==255&&e[1]==254)return Ti(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Ti(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return t[s]||s})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function lr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=lr(e[t]));return r}function It(e,r){for(var t="";t.length<r;)t+=e;return t}function Tn(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(r=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return t=-t,s}),!isNaN(r=Number(n)))?r/t:r}var OO=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ks(e){var r=new Date(e),t=new Date(NaN),n=r.getYear(),a=r.getMonth(),s=r.getDate();if(isNaN(s))return t;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&OO.indexOf(o)==-1)return t}else if(o.match(/[a-z]/))return t;return n<0||n>8099?t:(a>0||s>1)&&n!=101?r:e.match(/[^-0-9:,\/\\]/)?t:r}var RO=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,n,a){if(e||typeof n=="string")return t.split(n);for(var s=t.split(n),o=[s[0]],c=1;c<s.length;++c)o.push(a),o.push(s[c]);return o}}();function Rg(e){return e?e.content&&e.type?os(e.content,!0):e.data?wi(e.data):e.asNodeBuffer&&ot?wi(e.asNodeBuffer().toString("binary")):e.asBinary?wi(e.asBinary()):e._data&&e._data.getContent?wi(os(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Ng(e){if(!e)return null;if(e.data)return lh(e.data);if(e.asNodeBuffer&&ot)return e.asNodeBuffer();if(e._data&&e._data.getContent){var r=e._data.getContent();return typeof r=="string"?lh(r):Array.prototype.slice.call(r)}return e.content&&e.type?e.content:null}function NO(e){return e&&e.name.slice(-4)===".bin"?Ng(e):Rg(e)}function nn(e,r){for(var t=e.FullPaths||Un(e.files),n=r.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<t.length;++s){var o=t[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||a==o)return e.files?e.files[t[s]]:e.FileIndex[s]}return null}function _d(e,r){var t=nn(e,r);if(t==null)throw new Error("Cannot find file "+r+" in zip");return t}function Gt(e,r,t){if(!t)return NO(_d(e,r));if(!r)return null;try{return Gt(e,r)}catch{return null}}function qr(e,r,t){if(!t)return Rg(_d(e,r));if(!r)return null;try{return qr(e,r)}catch{return null}}function Mg(e,r,t){if(!t)return Ng(_d(e,r));if(!r)return null;try{return Mg(e,r)}catch{return null}}function Sh(e){for(var r=e.FullPaths||Un(e.files),t=[],n=0;n<r.length;++n)r[n].slice(-1)!="/"&&t.push(r[n].replace(/^Root Entry[\/]/,""));return t.sort()}function MO(e,r,t){if(e.FullPaths){if(typeof t=="string"){var n;return ot?n=gs(t):n=nO(t),ct.utils.cfb_add(e,r,n)}ct.utils.cfb_add(e,r,t)}else e.file(r,t)}function Lg(e,r){switch(r.type){case"base64":return ct.read(e,{type:"base64"});case"binary":return ct.read(e,{type:"binary"});case"buffer":case"array":return ct.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function Ei(e,r){if(e.charAt(0)=="/")return e.slice(1);var t=r.split("/");r.slice(-1)!="/"&&t.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?t.pop():a!=="."&&t.push(a)}return t.join("/")}var Bg=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,LO=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Eh=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,BO=/<[^>]*>/g,Er=Bg.match(Eh)?Eh:BO,$O=/<\w*:/,UO=/<(\/?)\w+:/;function Je(e,r,t){for(var n={},a=0,s=0;a!==e.length&&!((s=e.charCodeAt(a))===32||s===10||s===13);++a);if(r||(n[0]=e.slice(0,a)),a===e.length)return n;var o=e.match(LO),c=0,l="",u=0,d="",f="",h=1;if(o)for(u=0;u!=o.length;++u){for(f=o[u],s=0;s!=f.length&&f.charCodeAt(s)!==61;++s);for(d=f.slice(0,s).trim();f.charCodeAt(s+1)==32;)++s;for(h=(a=f.charCodeAt(s+1))==34||a==39?1:0,l=f.slice(s+1+h,f.length-h),c=0;c!=d.length&&d.charCodeAt(c)!==58;++c);if(c===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=l,t||(n[d.toLowerCase()]=l);else{var x=(c===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(c+1);if(n[x]&&d.slice(c-3,c)=="ext")continue;n[x]=l,t||(n[x.toLowerCase()]=l)}}return n}function Wn(e){return e.replace(UO,"<$1")}var $g={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},VO=Cd($g),dt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;return function t(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(e,function(c,l){return $g[c]||String.fromCharCode(parseInt(l,c.indexOf("x")>-1?16:10))||c}).replace(r,function(c,l){return String.fromCharCode(parseInt(l,16))});var o=a.indexOf("]]>");return t(a.slice(0,s))+a.slice(s+9,o)+t(a.slice(o+3))}}(),WO=/[&<>'"]/g,HO=/[\u0000-\u001f]/g;function Dd(e){var r=e+"";return r.replace(WO,function(t){return VO[t]}).replace(/\n/g,"<br/>").replace(HO,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}var Th=function(){var e=/&#(\d+);/g;function r(t,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,r)}}();function Et(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Sl(e){for(var r="",t=0,n=0,a=0,s=0,o=0,c=0;t<e.length;){if(n=e.charCodeAt(t++),n<128){r+=String.fromCharCode(n);continue}if(a=e.charCodeAt(t++),n>191&&n<224){o=(n&31)<<6,o|=a&63,r+=String.fromCharCode(o);continue}if(s=e.charCodeAt(t++),n<240){r+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}o=e.charCodeAt(t++),c=((n&7)<<18|(a&63)<<12|(s&63)<<6|o&63)-65536,r+=String.fromCharCode(55296+(c>>>10&1023)),r+=String.fromCharCode(56320+(c&1023))}return r}function Ah(e){var r=Sa(2*e.length),t,n,a=1,s=0,o=0,c;for(n=0;n<e.length;n+=a)a=1,(c=e.charCodeAt(n))<128?t=c:c<224?(t=(c&31)*64+(e.charCodeAt(n+1)&63),a=2):c<240?(t=(c&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,t=(c&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),t-=65536,o=55296+(t>>>10&1023),t=56320+(t&1023)),o!==0&&(r[s++]=o&255,r[s++]=o>>>8,o=0),r[s++]=t%256,r[s++]=t>>>8;return r.slice(0,s).toString("ucs2")}function kh(e){return gs(e,"binary").toString("utf8")}var Do="foo bar bazâð£",yt=ot&&(kh(Do)==Sl(Do)&&kh||Ah(Do)==Sl(Do)&&Ah)||Sl,Ti=ot?function(e){return gs(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,n=0,a=0;t<e.length;)switch(n=e.charCodeAt(t++),!0){case n<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(t++)-56320+(n<<10),r.push(String.fromCharCode(240+(a>>18&7))),r.push(String.fromCharCode(144+(a>>12&63))),r.push(String.fromCharCode(128+(a>>6&63))),r.push(String.fromCharCode(128+(a&63)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)))}return r.join("")},qi=function(){var e={};return function(t,n){var a=t+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",n||"")}}(),Ug=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),zO=function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),GO=/<\/?(?:vt:)?variant>/g,YO=/<(?:vt:)([^>]*)>([\s\S]*)</;function Ch(e,r){var t=Je(e),n=e.match(zO(t.baseType))||[],a=[];if(n.length!=t.size){if(r.WTF)throw new Error("unexpected vector length "+n.length+" != "+t.size);return a}return n.forEach(function(s){var o=s.replace(GO,"").match(YO);o&&a.push({v:yt(o[2]),t:o[1]})}),a}var qO=/(^\s|\s$|\n)/;function XO(e){return Un(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function KO(e,r,t){return"<"+e+(t!=null?XO(t):"")+(r!=null?(r.match(qO)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function Fd(e){if(ot&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return yt(ys(Td(e)));throw new Error("Bad input format: expected Buffer or string")}var Xi=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,JO={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},QO=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function ZO(e,r){for(var t=1-2*(e[r+7]>>>7),n=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),a=e[r+6]&15,s=5;s>=0;--s)a=a*256+e[r+s];return n==2047?a==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),t*Math.pow(2,n-52)*a)}function e4(e,r,t){var n=(r<0||1/r==-1/0?1:0)<<7,a=0,s=0,o=n?-r:r;isFinite(o)?o==0?a=s=0:(a=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(r)?26985:0);for(var c=0;c<=5;++c,s/=256)e[t+c]=s&255;e[t+6]=(a&15)<<4|s&15,e[t+7]=a>>4|n}var _h=function(e){for(var r=[],t=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,s=e[0][n].length;a<s;a+=t)r.push.apply(r,e[0][n].slice(a,a+t));return r},Dh=ot?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:gs(r)})):_h(e)}:_h,Fh=function(e,r,t){for(var n=[],a=r;a<t;a+=2)n.push(String.fromCharCode(Jn(e,a)));return n.join("").replace(Fr,"")},jd=ot?function(e,r,t){return Buffer.isBuffer(e)?e.toString("utf16le",r,t).replace(Fr,""):Fh(e,r,t)}:Fh,jh=function(e,r,t){for(var n=[],a=r;a<r+t;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},Vg=ot?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):jh(e,r,t)}:jh,Ih=function(e,r,t){for(var n=[],a=r;a<t;a++)n.push(String.fromCharCode(js(e,a)));return n.join("")},ho=ot?function(r,t,n){return Buffer.isBuffer(r)?r.toString("utf8",t,n):Ih(r,t,n)}:Ih,Wg=function(e,r){var t=Yr(e,r);return t>0?ho(e,r+4,r+4+t-1):""},Hg=Wg,zg=function(e,r){var t=Yr(e,r);return t>0?ho(e,r+4,r+4+t-1):""},Gg=zg,Yg=function(e,r){var t=2*Yr(e,r);return t>0?ho(e,r+4,r+4+t-1):""},qg=Yg,Xg=function(r,t){var n=Yr(r,t);return n>0?jd(r,t+4,t+4+n):""},Kg=Xg,Jg=function(e,r){var t=Yr(e,r);return t>0?ho(e,r+4,r+4+t):""},Qg=Jg,Zg=function(e,r){return ZO(e,r)},lc=Zg,e1=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};ot&&(Hg=function(r,t){if(!Buffer.isBuffer(r))return Wg(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},Gg=function(r,t){if(!Buffer.isBuffer(r))return zg(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},qg=function(r,t){if(!Buffer.isBuffer(r))return Yg(r,t);var n=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n-1)},Kg=function(r,t){if(!Buffer.isBuffer(r))return Xg(r,t);var n=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n)},Qg=function(r,t){if(!Buffer.isBuffer(r))return Jg(r,t);var n=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+n)},lc=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):Zg(r,t)},e1=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var js=function(e,r){return e[r]},Jn=function(e,r){return e[r+1]*256+e[r]},t4=function(e,r){var t=e[r+1]*256+e[r];return t<32768?t:(65535-t+1)*-1},Yr=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},$a=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},r4=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function Ci(e,r){var t="",n,a,s=[],o,c,l,u;switch(r){case"dbcs":if(u=this.l,ot&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)t+=String.fromCharCode(Jn(this,u)),u+=2;e*=2;break;case"utf8":t=ho(this,this.l,this.l+e);break;case"utf16le":e*=2,t=jd(this,this.l,this.l+e);break;case"wstr":return Ci.call(this,e,"dbcs");case"lpstr-ansi":t=Hg(this,this.l),e=4+Yr(this,this.l);break;case"lpstr-cp":t=Gg(this,this.l),e=4+Yr(this,this.l);break;case"lpwstr":t=qg(this,this.l),e=4+2*Yr(this,this.l);break;case"lpp4":e=4+Yr(this,this.l),t=Kg(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Yr(this,this.l),t=Qg(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(o=js(this,this.l+e++))!==0;)s.push(_o(o));t=s.join("");break;case"_wstr":for(e=0,t="";(o=Jn(this,this.l+e))!==0;)s.push(_o(o)),e+=2;e+=2,t=s.join("");break;case"dbcs-cont":for(t="",u=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return o=js(this,u),this.l=u+1,c=Ci.call(this,e-l,o?"dbcs-cont":"sbcs-cont"),s.join("")+c;s.push(_o(Jn(this,u))),u+=2}t=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",u=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return o=js(this,u),this.l=u+1,c=Ci.call(this,e-l,o?"dbcs-cont":"sbcs-cont"),s.join("")+c;s.push(_o(js(this,u))),u+=1}t=s.join("");break;default:switch(e){case 1:return n=js(this,this.l),this.l++,n;case 2:return n=(r==="i"?t4:Jn)(this,this.l),this.l+=2,n;case 4:case-4:return r==="i"||!(this[this.l+3]&128)?(n=(e>0?$a:r4)(this,this.l),this.l+=4,n):(a=Yr(this,this.l),this.l+=4,a);case 8:case-8:if(r==="f")return e==8?a=lc(this,this.l):a=lc([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:t=Vg(this,this.l,e);break}}return this.l+=e,t}var n4=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},a4=function(e,r,t){e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},s4=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255};function i4(e,r,t){var n=0,a=0;if(t==="dbcs"){for(a=0;a!=r.length;++a)s4(this,r.charCodeAt(a),this.l+2*a);n=2*r.length}else if(t==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=r.length;++a)this[this.l+a]=r.charCodeAt(a)&255;n=r.length}else if(t==="hex"){for(;a<e;++a)this[this.l++]=parseInt(r.slice(2*a,2*a+2),16)||0;return this}else if(t==="utf16le"){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(r.length,e);++a){var o=r.charCodeAt(a);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=r&255;break;case 2:n=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:n=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:n=4,n4(this,r,this.l);break;case 8:if(n=8,t==="f"){e4(this,r,this.l);break}case 16:break;case-4:n=4,a4(this,r,this.l);break}return this.l+=n,this}function t1(e,r){var t=Vg(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function cr(e,r){e.l=r,e.read_shift=Ci,e.chk=t1,e.write_shift=i4}function Sr(e,r){e.l+=r}function Kt(e){var r=Sa(e);return cr(r,0),r}function aa(e,r,t){if(e){var n,a,s;cr(e,e.l||0);for(var o=e.length,c=0,l=0;e.l<o;){c=e.read_shift(1),c&128&&(c=(c&127)+((e.read_shift(1)&127)<<7));var u=mc[c]||mc[65535];for(n=e.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=e.read_shift(1))&127)<<7*a;l=e.l+s;var d=u.f&&u.f(e,s,t);if(e.l=l,r(d,u,c))return}}}function ou(){var e=[],r=ot?256:2048,t=function(u){var d=Kt(u);return cr(d,0),d},n=t(r),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(a(),n=t(Math.max(u+1,r)))},o=function(){return a(),fa(e)},c=function(u){a(),n=u,n.l==null&&(n.l=n.length),s(r)};return{next:s,push:c,end:o,_bufs:e}}function _i(e,r,t){var n=lr(e);if(r.s?(n.cRel&&(n.c+=r.s.c),n.rRel&&(n.r+=r.s.r)):(n.cRel&&(n.c+=r.c),n.rRel&&(n.r+=r.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Ph(e,r,t){var n=lr(e);return n.s=_i(n.s,r.s,t),n.e=_i(n.e,r.s,t),n}function Di(e,r){if(e.cRel&&e.c<0)for(e=lr(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=lr(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=et(e);return!e.cRel&&e.cRel!=null&&(t=l4(t)),!e.rRel&&e.rRel!=null&&(t=o4(t)),t}function El(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Jt(e.s.c)+":"+(e.e.cRel?"":"$")+Jt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+ur(e.s.r)+":"+(e.e.rRel?"":"$")+ur(e.e.r):Di(e.s,r.biff)+":"+Di(e.e,r.biff)}function Id(e){return parseInt(c4(e),10)-1}function ur(e){return""+(e+1)}function o4(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function c4(e){return e.replace(/\$(\d+)$/,"$1")}function Pd(e){for(var r=u4(e),t=0,n=0;n!==r.length;++n)t=26*t+r.charCodeAt(n)-64;return t-1}function Jt(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function l4(e){return e.replace(/^([A-Z])/,"$$$1")}function u4(e){return e.replace(/^\$([A-Z])/,"$1")}function d4(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Cr(e){for(var r=0,t=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?r=10*r+(a-48):a>=65&&a<=90&&(t=26*t+(a-64))}return{c:t-1,r:r-1}}function et(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function ai(e){var r=e.indexOf(":");return r==-1?{s:Cr(e),e:Cr(e)}:{s:Cr(e.slice(0,r)),e:Cr(e.slice(r+1))}}function lt(e,r){return typeof r>"u"||typeof r=="number"?lt(e.s,e.e):(typeof e!="string"&&(e=et(e)),typeof r!="string"&&(r=et(r)),e==r?e:e+":"+r)}function Ot(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,a=0,s=e.length;for(t=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)t=26*t+a;for(r.s.c=--t,t=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)t=10*t+a;if(r.s.r=--t,n===s||a!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++n,t=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)t=26*t+a;for(r.e.c=--t,t=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)t=10*t+a;return r.e.r=--t,r}function Oh(e,r){var t=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=cn(e.z,t?jr(r):r)}catch{}try{return e.w=cn((e.XF||{}).numFmtId||(t?14:0),t?jr(r):r)}catch{return""+r}}function ta(e,r,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?ws[e.v]||e.v:r==null?Oh(e,e.v):Oh(e,r))}function Ca(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",n={};return n[t]=e,{SheetNames:[t],Sheets:n}}function r1(e,r,t){var n=t||{},a=e?Array.isArray(e):n.dense,s=e||(a?[]:{}),o=0,c=0;if(s&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var l=typeof n.origin=="string"?Cr(n.origin):n.origin;o=l.r,c=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=Ot(s["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),o==-1&&(u.e.r=o=d.e.r+1)}for(var f=0;f!=r.length;++f)if(r[f]){if(!Array.isArray(r[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=r[f].length;++h)if(!(typeof r[f][h]>"u")){var x={v:r[f][h]},m=o+f,p=c+h;if(u.s.r>m&&(u.s.r=m),u.s.c>p&&(u.s.c=p),u.e.r<m&&(u.e.r=m),u.e.c<p&&(u.e.c=p),r[f][h]&&typeof r[f][h]=="object"&&!Array.isArray(r[f][h])&&!(r[f][h]instanceof Date))x=r[f][h];else if(Array.isArray(x.v)&&(x.f=r[f][h][1],x.v=x.v[0]),x.v===null)if(x.f)x.t="n";else if(n.nullError)x.t="e",x.v=0;else if(n.sheetStubs)x.t="z";else continue;else typeof x.v=="number"?x.t="n":typeof x.v=="boolean"?x.t="b":x.v instanceof Date?(x.z=n.dateNF||nt[14],n.cellDates?(x.t="d",x.w=cn(x.z,jr(x.v))):(x.t="n",x.v=jr(x.v),x.w=cn(x.z,x.v))):x.t="s";if(a)s[m]||(s[m]=[]),s[m][p]&&s[m][p].z&&(x.z=s[m][p].z),s[m][p]=x;else{var g=et({c:p,r:m});s[g]&&s[g].z&&(x.z=s[g].z),s[g]=x}}}return u.s.c<1e7&&(s["!ref"]=lt(u)),s}function si(e,r){return r1(null,e,r)}function f4(e){return e.read_shift(4,"i")}function wr(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function h4(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Od(e,r){var t=e.l,n=e.read_shift(1),a=wr(e),s=[],o={t:a,h:a};if(n&1){for(var c=e.read_shift(4),l=0;l!=c;++l)s.push(h4(e));o.r=s}else o.r=[{ich:0,ifnt:0}];return e.l=t+r,o}var p4=Od;function un(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function vs(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}var m4=wr;function Rd(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}var x4=wr,cu=Rd;function Nd(e){var r=e.slice(e.l,e.l+4),t=r[0]&1,n=r[0]&2;e.l+=4;var a=n===0?lc([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):$a(r,0)>>2;return t?a/100:a}function n1(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}var bs=n1;function yr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function g4(e){var r={},t=e.read_shift(1),n=t>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),o=e.read_shift(1),c=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:r.auto=1;break;case 1:r.index=a;var u=Ya[a];u&&(r.rgb=Ji(u));break;case 2:r.rgb=Ji([o,c,l]);break;case 3:r.theme=a;break}return s!=0&&(r.tint=s>0?s/32767:s/32768),r}function y4(e){var r=e.read_shift(1);e.l++;var t={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return t}function a1(e,r){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,r==1?"lpstr":"lpwstr")}function v4(e){return a1(e,1)}function b4(e){return a1(e,2)}var Md=2,Rr=3,Fo=11,Rh=12,uc=19,jo=64,w4=65,S4=71,E4=4108,T4=4126,ar=80,s1=81,A4=[ar,s1],k4={1:{n:"CodePage",t:Md},2:{n:"Category",t:ar},3:{n:"PresentationFormat",t:ar},4:{n:"ByteCount",t:Rr},5:{n:"LineCount",t:Rr},6:{n:"ParagraphCount",t:Rr},7:{n:"SlideCount",t:Rr},8:{n:"NoteCount",t:Rr},9:{n:"HiddenCount",t:Rr},10:{n:"MultimediaClipCount",t:Rr},11:{n:"ScaleCrop",t:Fo},12:{n:"HeadingPairs",t:E4},13:{n:"TitlesOfParts",t:T4},14:{n:"Manager",t:ar},15:{n:"Company",t:ar},16:{n:"LinksUpToDate",t:Fo},17:{n:"CharacterCount",t:Rr},19:{n:"SharedDoc",t:Fo},22:{n:"HyperlinksChanged",t:Fo},23:{n:"AppVersion",t:Rr,p:"version"},24:{n:"DigSig",t:w4},26:{n:"ContentType",t:ar},27:{n:"ContentStatus",t:ar},28:{n:"Language",t:ar},29:{n:"Version",t:ar},255:{},2147483648:{n:"Locale",t:uc},2147483651:{n:"Behavior",t:uc},1919054434:{}},C4={1:{n:"CodePage",t:Md},2:{n:"Title",t:ar},3:{n:"Subject",t:ar},4:{n:"Author",t:ar},5:{n:"Keywords",t:ar},6:{n:"Comments",t:ar},7:{n:"Template",t:ar},8:{n:"LastAuthor",t:ar},9:{n:"RevNumber",t:ar},10:{n:"EditTime",t:jo},11:{n:"LastPrinted",t:jo},12:{n:"CreatedDate",t:jo},13:{n:"ModifiedDate",t:jo},14:{n:"PageCount",t:Rr},15:{n:"WordCount",t:Rr},16:{n:"CharCount",t:Rr},17:{n:"Thumbnail",t:S4},18:{n:"Application",t:ar},19:{n:"DocSecurity",t:Rr},255:{},2147483648:{n:"Locale",t:uc},2147483651:{n:"Behavior",t:uc},1919054434:{}},Nh={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},_4=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function D4(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var F4=D4([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ya=lr(F4),ws={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},i1={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Mh={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function j4(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function I4(e){var r=j4();if(!e||!e.match)return r;var t={};if((e.match(Er)||[]).forEach(function(n){var a=Je(n);switch(a[0].replace($O,"<")){case"<?xml":break;case"<Types":r.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[a.Extension]=a.ContentType;break;case"<Override":r[Mh[a.ContentType]]!==void 0&&r[Mh[a.ContentType]].push(a.PartName);break}}),r.xmlns!==JO.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=t,delete r.calcchains,r}var Rs={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function lu(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function Fi(e,r){var t={"!id":{}};if(!e)return t;r.charAt(0)!=="/"&&(r="/"+r);var n={};return(e.match(Er)||[]).forEach(function(a){var s=Je(a);if(s[0]==="<Relationship"){var o={};o.Type=s.Type,o.Target=s.Target,o.Id=s.Id,s.TargetMode&&(o.TargetMode=s.TargetMode);var c=s.TargetMode==="External"?s.Target:Ei(s.Target,r);t[c]=o,n[s.Id]=o}}),t["!id"]=n,t}var P4="application/vnd.oasis.opendocument.spreadsheet";function O4(e,r){for(var t=Fd(e),n,a;n=Xi.exec(t);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Je(n[0],!1),a.path=="/"&&a.type!==P4)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw n}}var ji=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],R4=function(){for(var e=new Array(ji.length),r=0;r<ji.length;++r){var t=ji[r],n="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[r]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function o1(e){var r={};e=yt(e);for(var t=0;t<ji.length;++t){var n=ji[t],a=e.match(R4[t]);a!=null&&a.length>0&&(r[n[1]]=dt(a[1])),n[2]==="date"&&r[n[1]]&&(r[n[1]]=ir(r[n[1]]))}return r}var N4=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function c1(e,r,t,n){var a=[];if(typeof e=="string")a=Ch(e,n);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map(function(d){return{v:d}}));var o=typeof r=="string"?Ch(r,n).map(function(d){return d.v}):r,c=0,l=0;if(o.length>0)for(var u=0;u!==a.length;u+=2){switch(l=+a[u+1].v,a[u].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":t.Worksheets=l,t.SheetNames=o.slice(c,c+l);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":t.NamedRanges=l,t.DefinedNames=o.slice(c,c+l);break;case"Charts":case"Diagramme":t.Chartsheets=l,t.ChartNames=o.slice(c,c+l);break}c+=l}}function M4(e,r,t){var n={};return r||(r={}),e=yt(e),N4.forEach(function(a){var s=(e.match(qi(a[0]))||[])[1];switch(a[2]){case"string":s&&(r[a[1]]=dt(s));break;case"bool":r[a[1]]=s==="true";break;case"raw":var o=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));o&&o.length>0&&(n[a[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&c1(n.HeadingPairs,n.TitlesOfParts,r,t),r}var L4=/<[^>]+>[^<]*/g;function B4(e,r){var t={},n="",a=e.match(L4);if(a)for(var s=0;s!=a.length;++s){var o=a[s],c=Je(o);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":n=dt(c.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var l=o.split(">"),u=l[0].slice(4),d=l[1];switch(u){case"lpstr":case"bstr":case"lpwstr":t[n]=dt(d);break;case"bool":t[n]=Et(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":t[n]=parseFloat(d);break;case"filetime":case"date":t[n]=ir(d);break;case"cy":case"error":t[n]=dt(d);break;default:if(u.slice(-1)=="/")break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",o,u,l)}}else if(o.slice(0,2)!=="</"){if(r.WTF)throw new Error(o)}}}return t}var $4={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Tl;function U4(e,r,t){Tl||(Tl=Cd($4)),r=Tl[r]||r,e[r]=t}function Ld(e){var r=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function l1(e,r,t){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-n&3;)++e.l;return a}function u1(e,r,t){var n=e.read_shift(0,"lpwstr");return t&&(e.l+=4-(n.length+1&3)&3),n}function d1(e,r,t){return r===31?u1(e):l1(e,r,t)}function uu(e,r,t){return d1(e,r,t===!1?0:4)}function V4(e,r){if(!r)throw new Error("VtUnalignedString must have positive length");return d1(e,r,0)}function W4(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n){var a=e.l;t[n]=e.read_shift(0,"lpwstr").replace(Fr,""),e.l-a&2&&(e.l+=2)}return t}function H4(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n)t[n]=e.read_shift(0,"lpstr-cp").replace(Fr,"");return t}function z4(e){var r=e.l,t=dc(e,s1);e[e.l]==0&&e[e.l+1]==0&&e.l-r&2&&(e.l+=2);var n=dc(e,Rr);return[t,n]}function G4(e){for(var r=e.read_shift(4),t=[],n=0;n<r/2;++n)t.push(z4(e));return t}function Lh(e,r){for(var t=e.read_shift(4),n={},a=0;a!=t;++a){var s=e.read_shift(4),o=e.read_shift(4);n[s]=e.read_shift(o,r===1200?"utf16le":"utf8").replace(Fr,"").replace(Si,"!"),r===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>2+1<<2),n}function f1(e){var r=e.read_shift(4),t=e.slice(e.l,e.l+r);return e.l+=r,(r&3)>0&&(e.l+=4-(r&3)&3),t}function Y4(e){var r={};return r.Size=e.read_shift(4),e.l+=r.Size+3-(r.Size-1)%4,r}function dc(e,r,t){var n=e.read_shift(2),a,s=t||{};if(e.l+=2,r!==Rh&&n!==r&&A4.indexOf(r)===-1&&!((r&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+r+" saw "+n);switch(r===Rh?n:r){case 2:return a=e.read_shift(2,"i"),s.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return l1(e,n,4).replace(Fr,"");case 31:return u1(e);case 64:return Ld(e);case 65:return f1(e);case 71:return Y4(e);case 80:return uu(e,n,!s.raw).replace(Fr,"");case 81:return V4(e,n).replace(Fr,"");case 4108:return G4(e);case 4126:case 4127:return n==4127?W4(e):H4(e);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+n)}}function Bh(e,r){var t=e.l,n=e.read_shift(4),a=e.read_shift(4),s=[],o=0,c=0,l=-1,u={};for(o=0;o!=a;++o){var d=e.read_shift(4),f=e.read_shift(4);s[o]=[d,f+t]}s.sort(function(y,v){return y[1]-v[1]});var h={};for(o=0;o!=a;++o){if(e.l!==s[o][1]){var x=!0;if(o>0&&r)switch(r[s[o-1][0]].t){case 2:e.l+2===s[o][1]&&(e.l+=2,x=!1);break;case 80:e.l<=s[o][1]&&(e.l=s[o][1],x=!1);break;case 4108:e.l<=s[o][1]&&(e.l=s[o][1],x=!1);break}if((!r||o==0)&&e.l<=s[o][1]&&(x=!1,e.l=s[o][1]),x)throw new Error("Read Error: Expected address "+s[o][1]+" at "+e.l+" :"+o)}if(r){var m=r[s[o][0]];if(h[m.n]=dc(e,m.t,{raw:!0}),m.p==="version"&&(h[m.n]=String(h[m.n]>>16)+"."+("0000"+String(h[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(h[m.n]){case 0:h[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:bn(c=h[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[m.n])}}else if(s[o][0]===1){if(c=h.CodePage=dc(e,Md),bn(c),l!==-1){var p=e.l;e.l=s[l][1],u=Lh(e,c),e.l=p}}else if(s[o][0]===0){if(c===0){l=o,e.l=s[o+1][1];continue}u=Lh(e,c)}else{var g=u[s[o][0]],w;switch(e[e.l]){case 65:e.l+=4,w=f1(e);break;case 30:e.l+=4,w=uu(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,w=uu(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,w=e.read_shift(4,"i");break;case 19:e.l+=4,w=e.read_shift(4);break;case 5:e.l+=4,w=e.read_shift(8,"f");break;case 11:e.l+=4,w=Mt(e,4);break;case 64:e.l+=4,w=ir(Ld(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[g]=w}}return e.l=t+n,h}function $h(e,r,t){var n=e.content;if(!n)return{};cr(n,0);var a,s,o,c,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),d=n.read_shift(16);if(d!==ct.utils.consts.HEADER_CLSID&&d!==t)throw new Error("Bad PropertySet CLSID "+d);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),c=n.read_shift(4),a===1&&c!==n.l)throw new Error("Length mismatch: "+c+" !== "+n.l);a===2&&(o=n.read_shift(16),l=n.read_shift(4));var f=Bh(n,r),h={SystemIdentifier:u};for(var x in f)h[x]=f[x];if(h.FMTID=s,a===1)return h;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var m;try{m=Bh(n,null)}catch{}for(x in m)h[x]=m[x];return h.FMTID=[s,o],h}function ia(e,r){return e.read_shift(r),null}function q4(e,r,t){for(var n=[],a=e.l+r;e.l<a;)n.push(t(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function Mt(e,r){return e.read_shift(r)===1}function Yt(e){return e.read_shift(2,"u")}function h1(e,r){return q4(e,r,Yt)}function X4(e){var r=e.read_shift(1),t=e.read_shift(1);return t===1?r:r===1}function po(e,r,t){var n=e.read_shift(t&&t.biff>=12?2:1),a="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else t.biff==12&&(a="wstr");t.biff>=2&&t.biff<=5&&(a="cpstr");var o=n?e.read_shift(n,a):"";return o}function K4(e){var r=e.read_shift(2),t=e.read_shift(1),n=t&4,a=t&8,s=1+(t&1),o=0,c,l={};a&&(o=e.read_shift(2)),n&&(c=e.read_shift(4));var u=s==2?"dbcs-cont":"sbcs-cont",d=r===0?"":e.read_shift(r,u);return a&&(e.l+=4*o),n&&(e.l+=c),l.t=d,a||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function cs(e,r,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(r,"sbcs-cont"):n=e.read_shift(r,"dbcs-cont"),n}function mo(e,r,t){var n=e.read_shift(t&&t.biff==2?1:2);return n===0?(e.l++,""):cs(e,n,t)}function Ss(e,r,t){if(t.biff>5)return mo(e,r,t);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function J4(e){var r=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[r,t]}function Q4(e){var r=e.read_shift(4),t=e.l,n=!1;r>24&&(e.l+=r-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=t);var a=e.read_shift((n?r-24:r)>>1,"utf16le").replace(Fr,"");return n&&(e.l+=24),a}function Z4(e){for(var r=e.read_shift(2),t="";r-- >0;)t+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return t+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(s>>1,"utf16le").replace(Fr,"");return t+o}function eR(e,r){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return Q4(e);case"0303000000000000c000000000000046":return Z4(e);default:throw new Error("Unsupported Moniker "+t)}}function Io(e){var r=e.read_shift(4),t=r>0?e.read_shift(r,"utf16le").replace(Fr,""):"";return t}function tR(e,r){var t=e.l+r,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var s,o,c,l,u="",d,f;a&16&&(s=Io(e,t-e.l)),a&128&&(o=Io(e,t-e.l)),(a&257)===257&&(c=Io(e,t-e.l)),(a&257)===1&&(l=eR(e,t-e.l)),a&8&&(u=Io(e,t-e.l)),a&32&&(d=e.read_shift(16)),a&64&&(f=Ld(e)),e.l=t;var h=o||c||l||"";h&&u&&(h+="#"+u),h||(h="#"+u),a&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var x={Target:h};return d&&(x.guid=d),f&&(x.time=f),s&&(x.Tooltip=s),x}function p1(e){var r=e.read_shift(1),t=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[r,t,n,a]}function m1(e,r){var t=p1(e);return t[3]=0,t}function Hn(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return{r,c:t,ixfe:n}}function rR(e){var r=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:r,flags:t}}function nR(e,r,t){return r===0?"":Ss(e,r,t)}function aR(e,r,t){var n=t.biff>8?4:2,a=e.read_shift(n),s=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[a,s,o]}function x1(e){var r=e.read_shift(2),t=Nd(e);return[r,t]}function sR(e,r,t){e.l+=4,r-=4;var n=e.l+r,a=po(e,r,t),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,a}function Xc(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r},e:{c:a,r:t}}}function g1(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r},e:{c:a,r:t}}}var iR=g1;function y1(e){e.l+=4;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[t,r,n]}function oR(e){var r={};return e.l+=4,e.l+=16,r.fSharedNote=e.read_shift(2),e.l+=4,r}function cR(e){var r={};return e.l+=4,e.cf=e.read_shift(2),r}function hr(e){e.l+=2,e.l+=e.read_shift(2)}var lR={0:hr,4:hr,5:hr,6:hr,7:cR,8:hr,9:hr,10:hr,11:hr,12:hr,13:oR,14:hr,15:hr,16:hr,17:hr,18:hr,19:hr,20:hr,21:y1};function uR(e,r){for(var t=e.l+r,n=[];e.l<t;){var a=e.read_shift(2);e.l-=2;try{n.push(lR[a](e,t-e.l))}catch{return e.l=t,n}}return e.l!=t&&(e.l=t),n}function Po(e,r){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),r-=2,r>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(r),t}function dR(e,r){return r===0||e.read_shift(2),1200}function fR(e,r,t){if(t.enc)return e.l+=r,"";var n=e.l,a=Ss(e,0,t);return e.read_shift(r+n-e.l),a}function hR(e,r,t){var n=t&&t.biff==8||r==2?e.read_shift(2):(e.l+=r,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function pR(e,r,t){var n=e.read_shift(4),a=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var o=po(e,0,t);return o.length===0&&(o="Sheet1"),{pos:n,hs:a,dt:s,name:o}}function mR(e,r){for(var t=e.l+r,n=e.read_shift(4),a=e.read_shift(4),s=[],o=0;o!=a&&e.l<t;++o)s.push(K4(e));return s.Count=n,s.Unique=a,s}function xR(e,r){var t={};return t.dsst=e.read_shift(2),e.l+=r-2,t}function gR(e){var r={};r.r=e.read_shift(2),r.c=e.read_shift(2),r.cnt=e.read_shift(2)-r.c;var t=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(r.level=n&7),n&32&&(r.hidden=!0),n&64&&(r.hpt=t/20),r}function yR(e){var r=rR(e);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var t=e.read_shift(4);return t!==0}function vR(e){return e.read_shift(2),e.read_shift(4)}function Uh(e,r,t){var n=0;t&&t.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);t&&t.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function bR(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),l=e.read_shift(2),u=e.read_shift(2);return{Pos:[r,t],Dim:[n,a],Flags:s,CurTab:o,FirstTab:c,Selected:l,TabRatio:u}}function wR(e,r,t){if(t&&t.biff>=2&&t.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function SR(){}function ER(e,r,t){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=po(e,0,t),n}function TR(e){var r=Hn(e);return r.isst=e.read_shift(4),r}function AR(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=e.l+r,a=Hn(e);t.biff==2&&e.l++;var s=mo(e,n-e.l,t);return a.val=s,a}function kR(e,r,t){var n=e.read_shift(2),a=Ss(e,0,t);return[n,a]}var CR=Ss;function Vh(e,r,t){var n=e.l+r,a=t.biff==8||!t.biff?4:2,s=e.read_shift(a),o=e.read_shift(a),c=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:s,c},e:{r:o,c:l}}}function _R(e){var r=e.read_shift(2),t=e.read_shift(2),n=x1(e);return{r,c:t,ixfe:n[0],rknum:n[1]}}function DR(e,r){for(var t=e.l+r-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<t;)s.push(x1(e));if(e.l!==t)throw new Error("MulRK read error");var o=e.read_shift(2);if(s.length!=o-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:o,rkrec:s}}function FR(e,r){for(var t=e.l+r-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<t;)s.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var o=e.read_shift(2);if(s.length!=o-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:o,ixfe:s}}function jR(e,r,t,n){var a={},s=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(4),l=e.read_shift(2);return a.patternType=_4[c>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=o&15,a.dgRight=o>>4&15,a.dgTop=o>>8&15,a.dgBottom=o>>12&15,a.icvLeft=o>>16&127,a.icvRight=o>>23&127,a.grbitDiag=o>>30&3,a.icvTop=c&127,a.icvBottom=c>>7&127,a.icvDiag=c>>14&127,a.dgDiag=c>>21&15,a.icvFore=l&127,a.icvBack=l>>7&127,a.fsxButton=l>>14&1),a}function IR(e,r,t){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,r-=6,n.data=jR(e,r,n.fStyle,t),n}function PR(e){e.l+=4;var r=[e.read_shift(2),e.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function Wh(e,r,t){var n=Hn(e);(t.biff==2||r==9)&&++e.l;var a=X4(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function OR(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=Hn(e),a=yr(e);return n.val=a,n}var Hh=nR;function RR(e,r,t){var n=e.l+r,a=e.read_shift(2),s=e.read_shift(2);if(t.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var o=cs(e,s),c=[];n>e.l;)c.push(mo(e));return[s,a,o,c]}function zh(e,r,t){var n=e.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return t.sbcch===14849&&(a=sR(e,r-2,t)),s.body=a||e.read_shift(r-2),typeof a=="string"&&(s.Name=a),s}var NR=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Gh(e,r,t){var n=e.l+r,a=e.read_shift(2),s=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(t&&t.biff==2?1:2),l=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),l=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var u=cs(e,o,t);a&32&&(u=NR[u.charCodeAt(0)]);var d=n-e.l;t&&t.biff==2&&--d;var f=n==e.l||c===0||!(d>0)?[]:g6(e,d,t,c);return{chKey:s,Name:u,itab:l,rgce:f}}function v1(e,r,t){if(t.biff<8)return MR(e,r,t);for(var n=[],a=e.l+r,s=e.read_shift(t.biff>8?4:2);s--!==0;)n.push(aR(e,t.biff>8?12:6,t));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function MR(e,r,t){e[e.l+1]==3&&e[e.l]++;var n=po(e,r,t);return n.charCodeAt(0)==3?n.slice(1):n}function LR(e,r,t){if(t.biff<8){e.l+=r;return}var n=e.read_shift(2),a=e.read_shift(2),s=cs(e,n,t),o=cs(e,a,t);return[s,o]}function BR(e,r,t){var n=g1(e);e.l++;var a=e.read_shift(1);return r-=8,[y6(e,r,t),a,n]}function Yh(e,r,t){var n=iR(e);switch(t.biff){case 2:e.l++,r-=7;break;case 3:case 4:e.l+=2,r-=8;break;default:e.l+=6,r-=12}return[n,m6(e,r,t)]}function $R(e){var r=e.read_shift(4)!==0,t=e.read_shift(4)!==0,n=e.read_shift(4);return[r,t,n]}function UR(e,r,t){if(!(t.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),c=Ss(e,0,t);return t.biff<8&&e.read_shift(1),[{r:n,c:a},c,o,s]}}function VR(e,r,t){return UR(e,r,t)}function WR(e,r){for(var t=[],n=e.read_shift(2);n--;)t.push(Xc(e));return t}function HR(e,r,t){if(t&&t.biff<8)return GR(e,r,t);var n=y1(e),a=uR(e,r-22,n[1]);return{cmo:n,ft:a}}var zR={8:function(e,r){var t=e.l+r;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=t,{fmt:n}}};function GR(e,r,t){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,r-=36;var o=[];return o.push((zR[n]||Sr)(e,r,t)),{cmo:[a,n,s],ft:o}}function YR(e,r,t){var n=e.l,a="";try{e.l+=4;var s=(t.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:o=J4(e,6,t);var c=e.read_shift(2);e.read_shift(2),Yt(e,2);var l=e.read_shift(2);e.l+=l;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var d=e[e.l],f=cs(e,e.lens[u+1]-e.lens[u]-1);if(a+=f,a.length>=(d?c:2*c))break}if(a.length!==c&&a.length!==c*2)throw new Error("cchText: "+c+" != "+a.length);return e.l=n+r,{t:a}}catch{return e.l=n+r,{t:a}}}function qR(e,r){var t=Xc(e);e.l+=16;var n=tR(e,r-24);return[t,n]}function XR(e,r){e.read_shift(2);var t=Xc(e),n=e.read_shift((r-10)/2,"dbcs-cont");return n=n.replace(Fr,""),[t,n]}function KR(e){var r=[0,0],t;return t=e.read_shift(2),r[0]=Nh[t]||t,t=e.read_shift(2),r[1]=Nh[t]||t,r}function JR(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(m1(e));return t}function QR(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(m1(e));return t}function ZR(e){e.l+=2;var r={cxfs:0,crc:0};return r.cxfs=e.read_shift(2),r.crc=e.read_shift(4),r}function b1(e,r,t){if(!t.cellStyles)return Sr(e,r);var n=t&&t.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var u={s:a,e:s,w:o,ixfe:c,flags:l};return(t.biff>=5||!t.biff)&&(u.level=l>>8&7),u}function eN(e,r){var t={};return r<32||(e.l+=16,t.header=yr(e),t.footer=yr(e),e.l+=2),t}function tN(e,r,t){var n={area:!1};if(t.biff!=5)return e.l+=r,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}var rN=Hn,nN=h1,aN=mo;function sN(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),a={fmt:r,env:t,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function iN(e,r,t){t.biffguess&&t.biff==5&&(t.biff=2);var n=Hn(e);++e.l;var a=Ss(e,r-7,t);return n.t="str",n.val=a,n}function oN(e){var r=Hn(e);++e.l;var t=yr(e);return r.t="n",r.val=t,r}function cN(e){var r=Hn(e);++e.l;var t=e.read_shift(2);return r.t="n",r.val=t,r}function lN(e){var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,"sbcs-cont")}function uN(e,r){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=r-13}function dN(e,r,t){var n=e.l+r,a=Hn(e),s=e.read_shift(2),o=cs(e,s,t);return e.l=n,a.t="str",a.val=o,a}var fN=[2,3,48,49,131,139,140,245],qh=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=Cd({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(c,l){var u=[],d=Sa(1);switch(l.type){case"base64":d=vn(Kr(c));break;case"binary":d=vn(c);break;case"buffer":case"array":d=c;break}cr(d,0);var f=d.read_shift(1),h=!!(f&136),x=!1,m=!1;switch(f){case 2:break;case 3:break;case 48:x=!0,h=!0;break;case 49:x=!0,h=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var p=0,g=521;f==2&&(p=d.read_shift(2)),d.l+=3,f!=2&&(p=d.read_shift(4)),p>1048576&&(p=1e6),f!=2&&(g=d.read_shift(2));var w=d.read_shift(2),y=l.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(y=e[d[d.l]]),d.l+=1,d.l+=2),m&&(d.l+=36);for(var v=[],T={},F=Math.min(d.length,f==2?521:g-10-(x?264:0)),A=m?32:11;d.l<F&&d[d.l]!=13;)switch(T={},T.name=da.utils.decode(y,d.slice(d.l,d.l+A)).replace(/[\u0000\r\n].*$/g,""),d.l+=A,T.type=String.fromCharCode(d.read_shift(1)),f!=2&&!m&&(T.offset=d.read_shift(4)),T.len=d.read_shift(1),f==2&&(T.offset=d.read_shift(2)),T.dec=d.read_shift(1),T.name.length&&v.push(T),f!=2&&(d.l+=m?13:14),T.type){case"B":(!x||T.len!=8)&&l.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+T.type)}if(d[d.l]!==13&&(d.l=g-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=g;var S=0,E=0;for(u[0]=[],E=0;E!=v.length;++E)u[0][E]=v[E].name;for(;p-- >0;){if(d[d.l]===42){d.l+=w;continue}for(++d.l,u[++S]=[],E=0,E=0;E!=v.length;++E){var b=d.slice(d.l,d.l+v[E].len);d.l+=v[E].len,cr(b,0);var k=da.utils.decode(y,b);switch(v[E].type){case"C":k.trim().length&&(u[S][E]=k.replace(/\s+$/,""));break;case"D":k.length===8?u[S][E]=new Date(+k.slice(0,4),+k.slice(4,6)-1,+k.slice(6,8)):u[S][E]=k;break;case"F":u[S][E]=parseFloat(k.trim());break;case"+":case"I":u[S][E]=m?b.read_shift(-4,"i")^2147483648:b.read_shift(4,"i");break;case"L":switch(k.trim().toUpperCase()){case"Y":case"T":u[S][E]=!0;break;case"N":case"F":u[S][E]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+k+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[S][E]="##MEMO##"+(m?parseInt(k.trim(),10):b.read_shift(4));break;case"N":k=k.replace(/\u0000/g,"").trim(),k&&k!="."&&(u[S][E]=+k||0);break;case"@":u[S][E]=new Date(b.read_shift(-8,"f")-621356832e5);break;case"T":u[S][E]=new Date((b.read_shift(4)-2440588)*864e5+b.read_shift(4));break;case"Y":u[S][E]=b.read_shift(4,"i")/1e4+b.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[S][E]=-b.read_shift(-8,"f");break;case"B":if(x&&v[E].len==8){u[S][E]=b.read_shift(8,"f");break}case"G":case"P":b.l+=v[E].len;break;case"0":if(v[E].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+v[E].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=v,u}function n(c,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var d=si(t(c,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function a(c,l){try{return Ca(n(c,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(c,l){var u=l||{};if(+u.codepage>=0&&bn(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=ou(),f=xu(c,{header:1,raw:!0,cellDates:!0}),h=f[0],x=f.slice(1),m=c["!cols"]||[],p=0,g=0,w=0,y=1;for(p=0;p<h.length;++p){if(((m[p]||{}).DBF||{}).name){h[p]=m[p].DBF.name,++w;continue}if(h[p]!=null){if(++w,typeof h[p]=="number"&&(h[p]=h[p].toString(10)),typeof h[p]!="string")throw new Error("DBF Invalid column name "+h[p]+" |"+typeof h[p]+"|");if(h.indexOf(h[p])!==p){for(g=0;g<1024;++g)if(h.indexOf(h[p]+"_"+g)==-1){h[p]+="_"+g;break}}}}var v=Ot(c["!ref"]),T=[],F=[],A=[];for(p=0;p<=v.e.c-v.s.c;++p){var S="",E="",b=0,k=[];for(g=0;g<x.length;++g)x[g][p]!=null&&k.push(x[g][p]);if(k.length==0||h[p]==null){T[p]="?";continue}for(g=0;g<k.length;++g){switch(typeof k[g]){case"number":E="B";break;case"string":E="C";break;case"boolean":E="L";break;case"object":E=k[g]instanceof Date?"D":"C";break;default:E="C"}b=Math.max(b,String(k[g]).length),S=S&&S!=E?"C":E}b>250&&(b=250),E=((m[p]||{}).DBF||{}).type,E=="C"&&m[p].DBF.len>b&&(b=m[p].DBF.len),S=="B"&&E=="N"&&(S="N",A[p]=m[p].DBF.dec,b=m[p].DBF.len),F[p]=S=="C"||E=="N"?b:s[S]||0,y+=F[p],T[p]=S}var j=d.next(32);for(j.write_shift(4,318902576),j.write_shift(4,x.length),j.write_shift(2,296+32*w),j.write_shift(2,y),p=0;p<4;++p)j.write_shift(4,0);for(j.write_shift(4,0|(+r[yg]||3)<<8),p=0,g=0;p<h.length;++p)if(h[p]!=null){var _=d.next(32),B=(h[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);_.write_shift(1,B,"sbcs"),_.write_shift(1,T[p]=="?"?"C":T[p],"sbcs"),_.write_shift(4,g),_.write_shift(1,F[p]||s[T[p]]||0),_.write_shift(1,A[p]||0),_.write_shift(1,2),_.write_shift(4,0),_.write_shift(1,0),_.write_shift(4,0),_.write_shift(4,0),g+=F[p]||s[T[p]]||0}var Q=d.next(264);for(Q.write_shift(4,13),p=0;p<65;++p)Q.write_shift(4,0);for(p=0;p<x.length;++p){var Z=d.next(y);for(Z.write_shift(1,0),g=0;g<h.length;++g)if(h[g]!=null)switch(T[g]){case"L":Z.write_shift(1,x[p][g]==null?63:x[p][g]?84:70);break;case"B":Z.write_shift(8,x[p][g]||0,"f");break;case"N":var L="0";for(typeof x[p][g]=="number"&&(L=x[p][g].toFixed(A[g]||0)),w=0;w<F[g]-L.length;++w)Z.write_shift(1,32);Z.write_shift(1,L,"sbcs");break;case"D":x[p][g]?(Z.write_shift(4,("0000"+x[p][g].getFullYear()).slice(-4),"sbcs"),Z.write_shift(2,("00"+(x[p][g].getMonth()+1)).slice(-2),"sbcs"),Z.write_shift(2,("00"+x[p][g].getDate()).slice(-2),"sbcs")):Z.write_shift(8,"00000000","sbcs");break;case"C":var q=String(x[p][g]!=null?x[p][g]:"").slice(0,F[g]);for(Z.write_shift(1,q,"sbcs"),w=0;w<F[g]-q.length;++w)Z.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:a,to_sheet:n,from_sheet:o}}(),hN=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+Un(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(h,x){var m=e[x];return typeof m=="number"?uh(m):m},n=function(h,x,m){var p=x.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return p==59?h:uh(p)};e["|"]=254;function a(h,x){switch(x.type){case"base64":return s(Kr(h),x);case"binary":return s(h,x);case"buffer":return s(ot&&Buffer.isBuffer(h)?h.toString("binary"):ys(h),x);case"array":return s(os(h),x)}throw new Error("Unrecognized type "+x.type)}function s(h,x){var m=h.split(/[\n\r]+/),p=-1,g=-1,w=0,y=0,v=[],T=[],F=null,A={},S=[],E=[],b=[],k=0,j;for(+x.codepage>=0&&bn(+x.codepage);w!==m.length;++w){k=0;var _=m[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(r,t),B=_.replace(/;;/g,"\0").split(";").map(function(G){return G.replace(/\u0000/g,";")}),Q=B[0],Z;if(_.length>0)switch(Q){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":B[1].charAt(0)=="P"&&T.push(_.slice(3).replace(/;;/g,";"));break;case"C":var L=!1,q=!1,te=!1,R=!1,oe=-1,J=-1;for(y=1;y<B.length;++y)switch(B[y].charAt(0)){case"A":break;case"X":g=parseInt(B[y].slice(1))-1,q=!0;break;case"Y":for(p=parseInt(B[y].slice(1))-1,q||(g=0),j=v.length;j<=p;++j)v[j]=[];break;case"K":Z=B[y].slice(1),Z.charAt(0)==='"'?Z=Z.slice(1,Z.length-1):Z==="TRUE"?Z=!0:Z==="FALSE"?Z=!1:isNaN(Tn(Z))?isNaN(Ks(Z).getDate())||(Z=ir(Z)):(Z=Tn(Z),F!==null&&ni(F)&&(Z=qc(Z))),L=!0;break;case"E":R=!0;var P=Us(B[y].slice(1),{r:p,c:g});v[p][g]=[v[p][g],P];break;case"S":te=!0,v[p][g]=[v[p][g],"S5S"];break;case"G":break;case"R":oe=parseInt(B[y].slice(1))-1;break;case"C":J=parseInt(B[y].slice(1))-1;break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+_)}if(L&&(v[p][g]&&v[p][g].length==2?v[p][g][0]=Z:v[p][g]=Z,F=null),te){if(R)throw new Error("SYLK shared formula cannot have own formula");var V=oe>-1&&v[oe][J];if(!V||!V[1])throw new Error("SYLK shared formula cannot find base");v[p][g][1]=F1(V[1],{r:p-oe,c:g-J})}break;case"F":var z=0;for(y=1;y<B.length;++y)switch(B[y].charAt(0)){case"X":g=parseInt(B[y].slice(1))-1,++z;break;case"Y":for(p=parseInt(B[y].slice(1))-1,j=v.length;j<=p;++j)v[j]=[];break;case"M":k=parseInt(B[y].slice(1))/20;break;case"F":break;case"G":break;case"P":F=T[parseInt(B[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(b=B[y].slice(1).split(" "),j=parseInt(b[0],10);j<=parseInt(b[1],10);++j)k=parseInt(b[2],10),E[j-1]=k===0?{hidden:!0}:{wch:k},Js(E[j-1]);break;case"C":g=parseInt(B[y].slice(1))-1,E[g]||(E[g]={});break;case"R":p=parseInt(B[y].slice(1))-1,S[p]||(S[p]={}),k>0?(S[p].hpt=k,S[p].hpx=Qi(k)):k===0&&(S[p].hidden=!0);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+_)}z<1&&(F=null);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+_)}}return S.length>0&&(A["!rows"]=S),E.length>0&&(A["!cols"]=E),x&&x.sheetRows&&(v=v.slice(0,x.sheetRows)),[v,A]}function o(h,x){var m=a(h,x),p=m[0],g=m[1],w=si(p,x);return Un(g).forEach(function(y){w[y]=g[y]}),w}function c(h,x){return Ca(o(h,x),x)}function l(h,x,m,p){var g="C;Y"+(m+1)+";X"+(p+1)+";K";switch(h.t){case"n":g+=h.v||0,h.f&&!h.F&&(g+=";E"+Z3(h.f,{r:m,c:p}));break;case"b":g+=h.v?"TRUE":"FALSE";break;case"e":g+=h.w||h.v;break;case"d":g+='"'+(h.w||h.v)+'"';break;case"s":g+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function u(h,x){x.forEach(function(m,p){var g="F;W"+(p+1)+" "+(p+1)+" ";m.hidden?g+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=hc(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=pc(m.wpx)),typeof m.wch=="number"&&(g+=Math.round(m.wch))),g.charAt(g.length-1)!=" "&&h.push(g)})}function d(h,x){x.forEach(function(m,p){var g="F;";m.hidden?g+="M0;":m.hpt?g+="M"+20*m.hpt+";":m.hpx&&(g+="M"+20*C1(m.hpx)+";"),g.length>2&&h.push(g+"R"+(p+1))})}function f(h,x){var m=["ID;PWXL;N;E"],p=[],g=Ot(h["!ref"]),w,y=Array.isArray(h),v=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),h["!cols"]&&u(m,h["!cols"]),h["!rows"]&&d(m,h["!rows"]),m.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var T=g.s.r;T<=g.e.r;++T)for(var F=g.s.c;F<=g.e.c;++F){var A=et({r:T,c:F});w=y?(h[T]||[])[F]:h[A],!(!w||w.v==null&&(!w.f||w.F))&&p.push(l(w,h,T,F))}return m.join(v)+v+p.join(v)+v+"E"+v}return{to_workbook:c,to_sheet:o,from_sheet:f}}(),pN=function(){function e(s,o){switch(o.type){case"base64":return r(Kr(s),o);case"binary":return r(s,o);case"buffer":return r(ot&&Buffer.isBuffer(s)?s.toString("binary"):ys(s),o);case"array":return r(os(s),o)}throw new Error("Unrecognized type "+o.type)}function r(s,o){for(var c=s.split(`
`),l=-1,u=-1,d=0,f=[];d!==c.length;++d){if(c[d].trim()==="BOT"){f[++l]=[],u=0;continue}if(!(l<0)){var h=c[d].trim().split(","),x=h[0],m=h[1];++d;for(var p=c[d]||"";(p.match(/["]/g)||[]).length&1&&d<c.length-1;)p+=`
`+c[++d];switch(p=p.trim(),+x){case-1:if(p==="BOT"){f[++l]=[],u=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?f[l][u]=!0:p==="FALSE"?f[l][u]=!1:isNaN(Tn(m))?isNaN(Ks(m).getDate())?f[l][u]=m:f[l][u]=ir(m):f[l][u]=Tn(m),++u;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),f[l][u++]=p!==""?p:null;break}if(p==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function t(s,o){return si(e(s,o),o)}function n(s,o){return Ca(t(s,o),o)}var a=function(){var s=function(l,u,d,f,h){l.push(u),l.push(d+","+f),l.push('"'+h.replace(/"/g,'""')+'"')},o=function(l,u,d,f){l.push(u+","+d),l.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var u=[],d=Ot(l["!ref"]),f,h=Array.isArray(l);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,d.e.r-d.s.r+1,""),s(u,"TUPLES",0,d.e.c-d.s.c+1,""),s(u,"DATA",0,0,"");for(var x=d.s.r;x<=d.e.r;++x){o(u,-1,0,"BOT");for(var m=d.s.c;m<=d.e.c;++m){var p=et({r:x,c:m});if(f=h?(l[x]||[])[m]:l[p],!f){o(u,1,0,"");continue}switch(f.t){case"n":var g=f.w;!g&&f.v!=null&&(g=f.v),g==null?f.f&&!f.F?o(u,1,0,"="+f.f):o(u,1,0,""):o(u,0,g,"V");break;case"b":o(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=cn(f.z||nt[14],jr(ir(f.v)))),o(u,0,f.w,"V");break;default:o(u,1,0,"")}}}o(u,-1,0,"EOD");var w=`\r
`,y=u.join(w);return y}}();return{to_workbook:n,to_sheet:t,from_sheet:a}}(),mN=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(f,h){for(var x=f.split(`
`),m=-1,p=-1,g=0,w=[];g!==x.length;++g){var y=x[g].trim().split(":");if(y[0]==="cell"){var v=Cr(y[1]);if(w.length<=v.r)for(m=w.length;m<=v.r;++m)w[m]||(w[m]=[]);switch(m=v.r,p=v.c,y[2]){case"t":w[m][p]=e(y[3]);break;case"v":w[m][p]=+y[3];break;case"vtf":var T=y[y.length-1];case"vtc":switch(y[3]){case"nl":w[m][p]=!!+y[4];break;default:w[m][p]=+y[4];break}y[2]=="vtf"&&(w[m][p]=[w[m][p],T])}}}return h&&h.sheetRows&&(w=w.slice(0,h.sheetRows)),w}function n(f,h){return si(t(f,h),h)}function a(f,h){return Ca(n(f,h),h)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var h=[],x=[],m,p="",g=ai(f["!ref"]),w=Array.isArray(f),y=g.s.r;y<=g.e.r;++y)for(var v=g.s.c;v<=g.e.c;++v)if(p=et({r:y,c:v}),m=w?(f[y]||[])[v]:f[p],!(!m||m.v==null||m.t==="z")){switch(x=["cell",p,"t"],m.t){case"s":case"str":x.push(r(m.v));break;case"n":m.f?(x[2]="vtf",x[3]="n",x[4]=m.v,x[5]=r(m.f)):(x[2]="v",x[3]=m.v);break;case"b":x[2]="vt"+(m.f?"f":"c"),x[3]="nl",x[4]=m.v?"1":"0",x[5]=r(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var T=jr(ir(m.v));x[2]="vtc",x[3]="nd",x[4]=""+T,x[5]=m.w||cn(m.z||nt[14],T);break;case"e":continue}h.push(x.join(":"))}return h.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function d(f){return[s,o,c,o,u(f),l].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:d}}(),Ki=function(){function e(d,f,h,x,m){m.raw?f[h][x]=d:d===""||(d==="TRUE"?f[h][x]=!0:d==="FALSE"?f[h][x]=!1:isNaN(Tn(d))?isNaN(Ks(d).getDate())?f[h][x]=d:f[h][x]=ir(d):f[h][x]=Tn(d))}function r(d,f){var h=f||{},x=[];if(!d||d.length===0)return x;for(var m=d.split(/[\r\n]/),p=m.length-1;p>=0&&m[p].length===0;)--p;for(var g=10,w=0,y=0;y<=p;++y)w=m[y].indexOf(" "),w==-1?w=m[y].length:w++,g=Math.max(g,w);for(y=0;y<=p;++y){x[y]=[];var v=0;for(e(m[y].slice(0,g).trim(),x,y,v,h),v=1;v<=(m[y].length-g)/10+1;++v)e(m[y].slice(g+(v-1)*10,g+v*10).trim(),x,y,v,h)}return h.sheetRows&&(x=x.slice(0,h.sheetRows)),x}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(d){for(var f={},h=!1,x=0,m=0;x<d.length;++x)(m=d.charCodeAt(x))==34?h=!h:!h&&m in t&&(f[m]=(f[m]||0)+1);m=[];for(x in f)Object.prototype.hasOwnProperty.call(f,x)&&m.push([f[x],x]);if(!m.length){f=n;for(x in f)Object.prototype.hasOwnProperty.call(f,x)&&m.push([f[x],x])}return m.sort(function(p,g){return p[0]-g[0]||n[p[1]]-n[g[1]]}),t[m.pop()[1]]||44}function s(d,f){var h=f||{},x="",m=h.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(x=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(x=d.charAt(4),d=d.slice(6)):x=a(d.slice(0,1024)):h&&h.FS?x=h.FS:x=a(d.slice(0,1024));var g=0,w=0,y=0,v=0,T=0,F=x.charCodeAt(0),A=!1,S=0,E=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var b=h.dateNF!=null?CO(h.dateNF):null;function k(){var j=d.slice(v,T),_={};if(j.charAt(0)=='"'&&j.charAt(j.length-1)=='"'&&(j=j.slice(1,-1).replace(/""/g,'"')),j.length===0)_.t="z";else if(h.raw)_.t="s",_.v=j;else if(j.trim().length===0)_.t="s",_.v=j;else if(j.charCodeAt(0)==61)j.charCodeAt(1)==34&&j.charCodeAt(j.length-1)==34?(_.t="s",_.v=j.slice(2,-1).replace(/""/g,'"')):tM(j)?(_.t="n",_.f=j.slice(1)):(_.t="s",_.v=j);else if(j=="TRUE")_.t="b",_.v=!0;else if(j=="FALSE")_.t="b",_.v=!1;else if(!isNaN(y=Tn(j)))_.t="n",h.cellText!==!1&&(_.w=j),_.v=y;else if(!isNaN(Ks(j).getDate())||b&&j.match(b)){_.z=h.dateNF||nt[14];var B=0;b&&j.match(b)&&(j=_O(j,h.dateNF,j.match(b)||[]),B=1),h.cellDates?(_.t="d",_.v=ir(j,B)):(_.t="n",_.v=jr(ir(j,B))),h.cellText!==!1&&(_.w=cn(_.z,_.v instanceof Date?jr(_.v):_.v)),h.cellNF||delete _.z}else _.t="s",_.v=j;if(_.t=="z"||(h.dense?(m[g]||(m[g]=[]),m[g][w]=_):m[et({c:w,r:g})]=_),v=T+1,E=d.charCodeAt(v),p.e.c<w&&(p.e.c=w),p.e.r<g&&(p.e.r=g),S==F)++w;else if(w=0,++g,h.sheetRows&&h.sheetRows<=g)return!0}e:for(;T<d.length;++T)switch(S=d.charCodeAt(T)){case 34:E===34&&(A=!A);break;case F:case 10:case 13:if(!A&&k())break e;break}return T-v>0&&k(),m["!ref"]=lt(p),m}function o(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,f):si(r(d,f),f)}function c(d,f){var h="",x=f.type=="string"?[0,0,0,0]:Gd(d,f);switch(f.type){case"base64":h=Kr(d);break;case"binary":h=d;break;case"buffer":f.codepage==65001?h=d.toString("utf8"):f.codepage&&typeof da<"u"?h=da.utils.decode(f.codepage,d):h=ot&&Buffer.isBuffer(d)?d.toString("binary"):ys(d);break;case"array":h=os(d);break;case"string":h=d;break;default:throw new Error("Unrecognized type "+f.type)}return x[0]==239&&x[1]==187&&x[2]==191?h=yt(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=yt(h):f.type=="binary"&&typeof da<"u"&&f.codepage&&(h=da.utils.decode(f.codepage,da.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?mN.to_sheet(f.type=="string"?h:yt(h),f):o(h,f)}function l(d,f){return Ca(c(d,f),f)}function u(d){for(var f=[],h=Ot(d["!ref"]),x,m=Array.isArray(d),p=h.s.r;p<=h.e.r;++p){for(var g=[],w=h.s.c;w<=h.e.c;++w){var y=et({r:p,c:w});if(x=m?(d[p]||[])[w]:d[y],!x||x.v==null){g.push("          ");continue}for(var v=(x.w||(ta(x),x.w)||"").slice(0,10);v.length<10;)v+=" ";g.push(v+(w===0?" ":""))}f.push(g.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:c,from_sheet:u}}();function xN(e,r){var t=r||{},n=!!t.WTF;t.WTF=!0;try{var a=hN.to_workbook(e,t);return t.WTF=n,a}catch(s){if(t.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Ki.to_workbook(e,r)}}var Ii=function(){function e(P,V,z){if(P){cr(P,P.l||0);for(var G=z.Enum||oe;P.l<P.length;){var ne=P.read_shift(2),he=G[ne]||G[65535],se=P.read_shift(2),ae=P.l+se,K=he.f&&he.f(P,se,z);if(P.l=ae,V(K,he,ne))return}}}function r(P,V){switch(V.type){case"base64":return t(vn(Kr(P)),V);case"binary":return t(vn(P),V);case"buffer":case"array":return t(P,V)}throw"Unsupported type "+V.type}function t(P,V){if(!P)return P;var z=V||{},G=z.dense?[]:{},ne="Sheet1",he="",se=0,ae={},K=[],O=[],D={s:{r:0,c:0},e:{r:0,c:0}},re=z.sheetRows||0;if(P[2]==0&&(P[3]==8||P[3]==9)&&P.length>=16&&P[14]==5&&P[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(P[2]==2)z.Enum=oe,e(P,function(we,xe,Ce){switch(Ce){case 0:z.vers=we,we>=4096&&(z.qpro=!0);break;case 6:D=we;break;case 204:we&&(he=we);break;case 222:he=we;break;case 15:case 51:z.qpro||(we[1].v=we[1].v.slice(1));case 13:case 14:case 16:Ce==14&&(we[2]&112)==112&&(we[2]&15)>1&&(we[2]&15)<15&&(we[1].z=z.dateNF||nt[14],z.cellDates&&(we[1].t="d",we[1].v=qc(we[1].v))),z.qpro&&we[3]>se&&(G["!ref"]=lt(D),ae[ne]=G,K.push(ne),G=z.dense?[]:{},D={s:{r:0,c:0},e:{r:0,c:0}},se=we[3],ne=he||"Sheet"+(se+1),he="");var Oe=z.dense?(G[we[0].r]||[])[we[0].c]:G[et(we[0])];if(Oe){Oe.t=we[1].t,Oe.v=we[1].v,we[1].z!=null&&(Oe.z=we[1].z),we[1].f!=null&&(Oe.f=we[1].f);break}z.dense?(G[we[0].r]||(G[we[0].r]=[]),G[we[0].r][we[0].c]=we[1]):G[et(we[0])]=we[1];break}},z);else if(P[2]==26||P[2]==14)z.Enum=J,P[2]==14&&(z.qpro=!0,P.l=0),e(P,function(we,xe,Ce){switch(Ce){case 204:ne=we;break;case 22:we[1].v=we[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(we[3]>se&&(G["!ref"]=lt(D),ae[ne]=G,K.push(ne),G=z.dense?[]:{},D={s:{r:0,c:0},e:{r:0,c:0}},se=we[3],ne="Sheet"+(se+1)),re>0&&we[0].r>=re)break;z.dense?(G[we[0].r]||(G[we[0].r]=[]),G[we[0].r][we[0].c]=we[1]):G[et(we[0])]=we[1],D.e.c<we[0].c&&(D.e.c=we[0].c),D.e.r<we[0].r&&(D.e.r=we[0].r);break;case 27:we[14e3]&&(O[we[14e3][0]]=we[14e3][1]);break;case 1537:O[we[0]]=we[1],we[0]==se&&(ne=we[1]);break}},z);else throw new Error("Unrecognized LOTUS BOF "+P[2]);if(G["!ref"]=lt(D),ae[he||ne]=G,K.push(he||ne),!O.length)return{SheetNames:K,Sheets:ae};for(var le={},Te=[],ue=0;ue<O.length;++ue)ae[K[ue]]?(Te.push(O[ue]||K[ue]),le[O[ue]]=ae[O[ue]]||ae[K[ue]]):(Te.push(O[ue]),le[O[ue]]={"!ref":"A1"});return{SheetNames:Te,Sheets:le}}function n(P,V){var z=V||{};if(+z.codepage>=0&&bn(+z.codepage),z.type=="string")throw new Error("Cannot write WK1 to JS string");var G=ou(),ne=Ot(P["!ref"]),he=Array.isArray(P),se=[];hn(G,0,s(1030)),hn(G,6,l(ne));for(var ae=Math.min(ne.e.r,8191),K=ne.s.r;K<=ae;++K)for(var O=ur(K),D=ne.s.c;D<=ne.e.c;++D){K===ne.s.r&&(se[D]=Jt(D));var re=se[D]+O,le=he?(P[K]||[])[D]:P[re];if(!(!le||le.t=="z"))if(le.t=="n")(le.v|0)==le.v&&le.v>=-32768&&le.v<=32767?hn(G,13,x(K,D,le.v)):hn(G,14,p(K,D,le.v));else{var Te=ta(le);hn(G,15,f(K,D,Te.slice(0,239)))}}return hn(G,1),G.end()}function a(P,V){var z=V||{};if(+z.codepage>=0&&bn(+z.codepage),z.type=="string")throw new Error("Cannot write WK3 to JS string");var G=ou();hn(G,0,o(P));for(var ne=0,he=0;ne<P.SheetNames.length;++ne)(P.Sheets[P.SheetNames[ne]]||{})["!ref"]&&hn(G,27,R(P.SheetNames[ne],he++));var se=0;for(ne=0;ne<P.SheetNames.length;++ne){var ae=P.Sheets[P.SheetNames[ne]];if(!(!ae||!ae["!ref"])){for(var K=Ot(ae["!ref"]),O=Array.isArray(ae),D=[],re=Math.min(K.e.r,8191),le=K.s.r;le<=re;++le)for(var Te=ur(le),ue=K.s.c;ue<=K.e.c;++ue){le===K.s.r&&(D[ue]=Jt(ue));var we=D[ue]+Te,xe=O?(ae[le]||[])[ue]:ae[we];if(!(!xe||xe.t=="z"))if(xe.t=="n")hn(G,23,k(le,ue,se,xe.v));else{var Ce=ta(xe);hn(G,22,S(le,ue,se,Ce.slice(0,239)))}}++se}}return hn(G,1),G.end()}function s(P){var V=Kt(2);return V.write_shift(2,P),V}function o(P){var V=Kt(26);V.write_shift(2,4096),V.write_shift(2,4),V.write_shift(4,0);for(var z=0,G=0,ne=0,he=0;he<P.SheetNames.length;++he){var se=P.SheetNames[he],ae=P.Sheets[se];if(!(!ae||!ae["!ref"])){++ne;var K=ai(ae["!ref"]);z<K.e.r&&(z=K.e.r),G<K.e.c&&(G=K.e.c)}}return z>8191&&(z=8191),V.write_shift(2,z),V.write_shift(1,ne),V.write_shift(1,G),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(1,1),V.write_shift(1,2),V.write_shift(4,0),V.write_shift(4,0),V}function c(P,V,z){var G={s:{c:0,r:0},e:{c:0,r:0}};return V==8&&z.qpro?(G.s.c=P.read_shift(1),P.l++,G.s.r=P.read_shift(2),G.e.c=P.read_shift(1),P.l++,G.e.r=P.read_shift(2),G):(G.s.c=P.read_shift(2),G.s.r=P.read_shift(2),V==12&&z.qpro&&(P.l+=2),G.e.c=P.read_shift(2),G.e.r=P.read_shift(2),V==12&&z.qpro&&(P.l+=2),G.s.c==65535&&(G.s.c=G.e.c=G.s.r=G.e.r=0),G)}function l(P){var V=Kt(8);return V.write_shift(2,P.s.c),V.write_shift(2,P.s.r),V.write_shift(2,P.e.c),V.write_shift(2,P.e.r),V}function u(P,V,z){var G=[{c:0,r:0},{t:"n",v:0},0,0];return z.qpro&&z.vers!=20768?(G[0].c=P.read_shift(1),G[3]=P.read_shift(1),G[0].r=P.read_shift(2),P.l+=2):(G[2]=P.read_shift(1),G[0].c=P.read_shift(2),G[0].r=P.read_shift(2)),G}function d(P,V,z){var G=P.l+V,ne=u(P,V,z);if(ne[1].t="s",z.vers==20768){P.l++;var he=P.read_shift(1);return ne[1].v=P.read_shift(he,"utf8"),ne}return z.qpro&&P.l++,ne[1].v=P.read_shift(G-P.l,"cstr"),ne}function f(P,V,z){var G=Kt(7+z.length);G.write_shift(1,255),G.write_shift(2,V),G.write_shift(2,P),G.write_shift(1,39);for(var ne=0;ne<G.length;++ne){var he=z.charCodeAt(ne);G.write_shift(1,he>=128?95:he)}return G.write_shift(1,0),G}function h(P,V,z){var G=u(P,V,z);return G[1].v=P.read_shift(2,"i"),G}function x(P,V,z){var G=Kt(7);return G.write_shift(1,255),G.write_shift(2,V),G.write_shift(2,P),G.write_shift(2,z,"i"),G}function m(P,V,z){var G=u(P,V,z);return G[1].v=P.read_shift(8,"f"),G}function p(P,V,z){var G=Kt(13);return G.write_shift(1,255),G.write_shift(2,V),G.write_shift(2,P),G.write_shift(8,z,"f"),G}function g(P,V,z){var G=P.l+V,ne=u(P,V,z);if(ne[1].v=P.read_shift(8,"f"),z.qpro)P.l=G;else{var he=P.read_shift(2);T(P.slice(P.l,P.l+he),ne),P.l+=he}return ne}function w(P,V,z){var G=V&32768;return V&=-32769,V=(G?P:0)+(V>=8192?V-16384:V),(G?"":"$")+(z?Jt(V):ur(V))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},v=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function T(P,V){cr(P,0);for(var z=[],G=0,ne="",he="",se="",ae="";P.l<P.length;){var K=P[P.l++];switch(K){case 0:z.push(P.read_shift(8,"f"));break;case 1:he=w(V[0].c,P.read_shift(2),!0),ne=w(V[0].r,P.read_shift(2),!1),z.push(he+ne);break;case 2:{var O=w(V[0].c,P.read_shift(2),!0),D=w(V[0].r,P.read_shift(2),!1);he=w(V[0].c,P.read_shift(2),!0),ne=w(V[0].r,P.read_shift(2),!1),z.push(O+D+":"+he+ne)}break;case 3:if(P.l<P.length){console.error("WK1 premature formula end");return}break;case 4:z.push("("+z.pop()+")");break;case 5:z.push(P.read_shift(2));break;case 6:{for(var re="";K=P[P.l++];)re+=String.fromCharCode(K);z.push('"'+re.replace(/"/g,'""')+'"')}break;case 8:z.push("-"+z.pop());break;case 23:z.push("+"+z.pop());break;case 22:z.push("NOT("+z.pop()+")");break;case 20:case 21:ae=z.pop(),se=z.pop(),z.push(["AND","OR"][K-20]+"("+se+","+ae+")");break;default:if(K<32&&v[K])ae=z.pop(),se=z.pop(),z.push(se+v[K]+ae);else if(y[K]){if(G=y[K][1],G==69&&(G=P[P.l++]),G>z.length){console.error("WK1 bad formula parse 0x"+K.toString(16)+":|"+z.join("|")+"|");return}var le=z.slice(-G);z.length-=G,z.push(y[K][0]+"("+le.join(",")+")")}else return K<=7?console.error("WK1 invalid opcode "+K.toString(16)):K<=24?console.error("WK1 unsupported op "+K.toString(16)):K<=30?console.error("WK1 invalid opcode "+K.toString(16)):K<=115?console.error("WK1 unsupported function opcode "+K.toString(16)):console.error("WK1 unrecognized opcode "+K.toString(16))}}z.length==1?V[1].f=""+z[0]:console.error("WK1 bad formula parse |"+z.join("|")+"|")}function F(P){var V=[{c:0,r:0},{t:"n",v:0},0];return V[0].r=P.read_shift(2),V[3]=P[P.l++],V[0].c=P[P.l++],V}function A(P,V){var z=F(P);return z[1].t="s",z[1].v=P.read_shift(V-4,"cstr"),z}function S(P,V,z,G){var ne=Kt(6+G.length);ne.write_shift(2,P),ne.write_shift(1,z),ne.write_shift(1,V),ne.write_shift(1,39);for(var he=0;he<G.length;++he){var se=G.charCodeAt(he);ne.write_shift(1,se>=128?95:se)}return ne.write_shift(1,0),ne}function E(P,V){var z=F(P);z[1].v=P.read_shift(2);var G=z[1].v>>1;if(z[1].v&1)switch(G&7){case 0:G=(G>>3)*5e3;break;case 1:G=(G>>3)*500;break;case 2:G=(G>>3)/20;break;case 3:G=(G>>3)/200;break;case 4:G=(G>>3)/2e3;break;case 5:G=(G>>3)/2e4;break;case 6:G=(G>>3)/16;break;case 7:G=(G>>3)/64;break}return z[1].v=G,z}function b(P,V){var z=F(P),G=P.read_shift(4),ne=P.read_shift(4),he=P.read_shift(2);if(he==65535)return G===0&&ne===3221225472?(z[1].t="e",z[1].v=15):G===0&&ne===3489660928?(z[1].t="e",z[1].v=42):z[1].v=0,z;var se=he&32768;return he=(he&32767)-16446,z[1].v=(1-se*2)*(ne*Math.pow(2,he+32)+G*Math.pow(2,he)),z}function k(P,V,z,G){var ne=Kt(14);if(ne.write_shift(2,P),ne.write_shift(1,z),ne.write_shift(1,V),G==0)return ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(2,65535),ne;var he=0,se=0,ae=0,K=0;return G<0&&(he=1,G=-G),se=Math.log2(G)|0,G/=Math.pow(2,se-31),K=G>>>0,K&2147483648||(G/=2,++se,K=G>>>0),G-=K,K|=2147483648,K>>>=0,G*=Math.pow(2,32),ae=G>>>0,ne.write_shift(4,ae),ne.write_shift(4,K),se+=16383+(he?32768:0),ne.write_shift(2,se),ne}function j(P,V){var z=b(P);return P.l+=V-14,z}function _(P,V){var z=F(P),G=P.read_shift(4);return z[1].v=G>>6,z}function B(P,V){var z=F(P),G=P.read_shift(8,"f");return z[1].v=G,z}function Q(P,V){var z=B(P);return P.l+=V-10,z}function Z(P,V){return P[P.l+V-1]==0?P.read_shift(V,"cstr"):""}function L(P,V){var z=P[P.l++];z>V-1&&(z=V-1);for(var G="";G.length<z;)G+=String.fromCharCode(P[P.l++]);return G}function q(P,V,z){if(!(!z.qpro||V<21)){var G=P.read_shift(1);P.l+=17,P.l+=1,P.l+=2;var ne=P.read_shift(V-21,"cstr");return[G,ne]}}function te(P,V){for(var z={},G=P.l+V;P.l<G;){var ne=P.read_shift(2);if(ne==14e3){for(z[ne]=[0,""],z[ne][0]=P.read_shift(2);P[P.l];)z[ne][1]+=String.fromCharCode(P[P.l]),P.l++;P.l++}}return z}function R(P,V){var z=Kt(5+P.length);z.write_shift(2,14e3),z.write_shift(2,V);for(var G=0;G<P.length;++G){var ne=P.charCodeAt(G);z[z.l++]=ne>127?95:ne}return z[z.l++]=0,z}var oe={0:{n:"BOF",f:Yt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Z},222:{n:"SHEETNAMELP",f:L},65535:{n:""}},J={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:A},23:{n:"NUMBER17",f:b},24:{n:"NUMBER18",f:E},25:{n:"FORMULA19",f:j},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:te},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:_},38:{n:"??"},39:{n:"NUMBER27",f:B},40:{n:"FORMULA28",f:Q},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Z},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:q},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:r}}();function gN(e){var r={},t=e.match(Er),n=0,a=!1;if(t)for(;n!=t.length;++n){var s=Je(t[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;r.cp=Sd[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=s.val;break;case"<sz":r.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":s.rgb&&(r.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return r}var yN=function(){var e=qi("t"),r=qi("rPr");function t(s){var o=s.match(e);if(!o)return{t:"s",v:""};var c={t:"s",v:dt(o[1])},l=s.match(r);return l&&(c.s=gN(l[1])),c}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(a).map(t).filter(function(c){return c.v})}}(),vN=function(){var r=/(\r\n|\n)/g;function t(a,s,o){var c=[];a.u&&c.push("text-decoration: underline;"),a.uval&&c.push("text-underline-style:"+a.uval+";"),a.sz&&c.push("font-size:"+a.sz+"pt;"),a.outline&&c.push("text-effect: outline;"),a.shadow&&c.push("text-shadow: auto;"),s.push('<span style="'+c.join("")+'">'),a.b&&(s.push("<b>"),o.push("</b>")),a.i&&(s.push("<i>"),o.push("</i>")),a.strike&&(s.push("<s>"),o.push("</s>"));var l=a.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),o.push("</"+l+">")),o.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&t(a.s,s[0],s[2]),s[0].join("")+s[1].replace(r,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),bN=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,wN=/<(?:\w+:)?r>/,SN=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Bd(e,r){var t=r?r.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=dt(yt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=yt(e),t&&(n.h=Dd(n.t))):e.match(wN)&&(n.r=yt(e),n.t=dt(yt((e.replace(SN,"").match(bN)||[]).join("").replace(Er,""))),t&&(n.h=vN(yN(n.r)))),n):{t:""}}var EN=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,TN=/<(?:\w+:)?(?:si|sstItem)>/g,AN=/<\/(?:\w+:)?(?:si|sstItem)>/;function kN(e,r){var t=[],n="";if(!e)return t;var a=e.match(EN);if(a){n=a[2].replace(TN,"").split(AN);for(var s=0;s!=n.length;++s){var o=Bd(n[s].trim(),r);o!=null&&(t[t.length]=o)}a=Je(a[1]),t.Count=a.count,t.Unique=a.uniqueCount}return t}function CN(e){return[e.read_shift(4),e.read_shift(4)]}function _N(e,r){var t=[],n=!1;return aa(e,function(s,o,c){switch(c){case 159:t.Count=s[0],t.Unique=s[1];break;case 19:t.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||r.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),t}function w1(e){for(var r=[],t=e.split(""),n=0;n<t.length;++n)r[n]=t[n].charCodeAt(0);return r}function Zn(e,r){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),r>=4&&(e.l+=r-4),t}function DN(e){var r={};return r.id=e.read_shift(0,"lpp4"),r.R=Zn(e,4),r.U=Zn(e,4),r.W=Zn(e,4),r}function FN(e){for(var r=e.read_shift(4),t=e.l+r-4,n={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return n}function jN(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(FN(e));return r}function IN(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(e.read_shift(0,"lpp4"));return r}function PN(e){var r={};return e.read_shift(4),e.l+=4,r.id=e.read_shift(0,"lpp4"),r.name=e.read_shift(0,"lpp4"),r.R=Zn(e,4),r.U=Zn(e,4),r.W=Zn(e,4),r}function ON(e){var r=PN(e);if(r.ename=e.read_shift(0,"8lpp4"),r.blksz=e.read_shift(4),r.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function S1(e,r){var t=e.l+r,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,n}function E1(e,r){var t={},n=e.l+r;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,n),e.l=n,t}function RN(e){var r=Zn(e);switch(r.Minor){case 2:return[r.Minor,NN(e)];case 3:return[r.Minor,MN()];case 4:return[r.Minor,LN(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function NN(e){var r=e.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),n=S1(e,t),a=E1(e,e.length-e.l);return{t:"Std",h:n,v:a}}function MN(){throw new Error("File is password-protected: ECMA-376 Extensible")}function LN(e){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),n={};return t.replace(Er,function(s){var o=Je(s);switch(Wn(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(c){n[c]=o[c]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function BN(e,r){var t={},n=t.EncryptionVersionInfo=Zn(e,4);if(r-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);t.Flags=e.read_shift(4),r-=4;var a=e.read_shift(4);return r-=4,t.EncryptionHeader=S1(e,a),r-=a,t.EncryptionVerifier=E1(e,r),t}function $N(e){var r={},t=r.EncryptionVersionInfo=Zn(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return r.Salt=e.read_shift(16),r.EncryptedVerifier=e.read_shift(16),r.EncryptedVerifierHash=e.read_shift(16),r}function UN(e){var r=0,t,n=w1(e),a=n.length+1,s,o,c,l,u;for(t=Sa(a),t[0]=n.length,s=1;s!=a;++s)t[s]=n[s-1];for(s=a-1;s>=0;--s)o=t[s],c=r&16384?1:0,l=r<<1&32767,u=c|l,r=u^o;return r^52811}var T1=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},a=function(o,c){return n(o^c)},s=function(o){for(var c=r[o.length-1],l=104,u=o.length-1;u>=0;--u)for(var d=o[u],f=0;f!=7;++f)d&64&&(c^=t[l]),d*=2,--l;return c};return function(o){for(var c=w1(o),l=s(c),u=c.length,d=Sa(16),f=0;f!=16;++f)d[f]=0;var h,x,m;for((u&1)===1&&(h=l>>8,d[u]=a(e[0],h),--u,h=l&255,x=c[c.length-1],d[u]=a(x,h));u>0;)--u,h=l>>8,d[u]=a(c[u],h),--u,h=l&255,d[u]=a(c[u],h);for(u=15,m=15-c.length;m>0;)h=l>>8,d[u]=a(e[m],h),--u,--m,h=l&255,d[u]=a(c[u],h),--u,--m;return d}}(),VN=function(e,r,t,n,a){a||(a=r),n||(n=T1(e));var s,o;for(s=0;s!=r.length;++s)o=r[s],o^=n[t],o=(o>>5|o<<3)&255,a[s]=o,++t;return[a,t,n]},WN=function(e){var r=0,t=T1(e);return function(n){var a=VN("",n,r,t);return r=a[1],a[0]}};function HN(e,r,t,n){var a={key:Yt(e),verificationBytes:Yt(e)};return t.password&&(a.verifier=UN(t.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=WN(t.password)),a}function zN(e,r,t){var n=t||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=$N(e):n.Data=BN(e,r),n}function GN(e,r,t){var n={Type:t.biff>=8?e.read_shift(2):0};return n.Type?zN(e,r-2,n):HN(e,t.biff>=8?r:r-2,t,n),n}var YN=function(){function e(a,s){switch(s.type){case"base64":return r(Kr(a),s);case"binary":return r(a,s);case"buffer":return r(ot&&Buffer.isBuffer(a)?a.toString("binary"):ys(a),s);case"array":return r(os(a),s)}throw new Error("Unrecognized type "+s.type)}function r(a,s){var o=s||{},c=o.dense?[]:{},l=a.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(d,f){Array.isArray(c)&&(c[f]=[]);for(var h=/\\\w+\b/g,x=0,m,p=-1;m=h.exec(d);){switch(m[0]){case"\\cell":var g=d.slice(x,h.lastIndex-m[0].length);if(g[0]==" "&&(g=g.slice(1)),++p,g.length){var w={v:g,t:"s"};Array.isArray(c)?c[f][p]=w:c[et({r:f,c:p})]=w}break}x=h.lastIndex}p>u.e.c&&(u.e.c=p)}),c["!ref"]=lt(u),c}function t(a,s){return Ca(e(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],o=Ot(a["!ref"]),c,l=Array.isArray(a),u=o.s.r;u<=o.e.r;++u){s.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)s.push("\\cellx"+(d+1));for(s.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var f=et({r:u,c:d});c=l?(a[u]||[])[d]:a[f],!(!c||c.v==null&&(!c.f||c.F))&&(s.push(" "+(c.w||(ta(c),c.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:n}}();function qN(e){var r=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function Ji(e){for(var r=0,t=1;r!=3;++r)t=t*256+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}function XN(e){var r=e[0]/255,t=e[1]/255,n=e[2]/255,a=Math.max(r,t,n),s=Math.min(r,t,n),o=a-s;if(o===0)return[0,0,r];var c=0,l=0,u=a+s;switch(l=o/(u>1?2-u:u),a){case r:c=((t-n)/o+6)%6;break;case t:c=(n-r)/o+2;break;case n:c=(r-t)/o+4;break}return[c/6,l,u/2]}function KN(e){var r=e[0],t=e[1],n=e[2],a=t*2*(n<.5?n:1-n),s=n-a/2,o=[s,s,s],c=6*r,l;if(t!==0)switch(c|0){case 0:case 6:l=a*c,o[0]+=a,o[1]+=l;break;case 1:l=a*(2-c),o[0]+=l,o[1]+=a;break;case 2:l=a*(c-2),o[1]+=a,o[2]+=l;break;case 3:l=a*(4-c),o[1]+=l,o[2]+=a;break;case 4:l=a*(c-4),o[2]+=a,o[0]+=l;break;case 5:l=a*(6-c),o[2]+=l,o[0]+=a;break}for(var u=0;u!=3;++u)o[u]=Math.round(o[u]*255);return o}function fc(e,r){if(r===0)return e;var t=XN(qN(e));return r<0?t[2]=t[2]*(1+r):t[2]=1-(1-t[2])*(1-r),Ji(KN(t))}var A1=6,JN=15,QN=1,kr=A1;function hc(e){return Math.floor((e+Math.round(128/kr)/256)*kr)}function pc(e){return Math.floor((e-5)/kr*100+.5)/100}function du(e){return Math.round((e*kr+5)/kr*256)/256}function Al(e){return du(pc(hc(e)))}function $d(e){var r=Math.abs(e-Al(e)),t=kr;if(r>.005)for(kr=QN;kr<JN;++kr)Math.abs(e-Al(e))<=r&&(r=Math.abs(e-Al(e)),t=kr);kr=t}function Js(e){e.width?(e.wpx=hc(e.width),e.wch=pc(e.wpx),e.MDW=kr):e.wpx?(e.wch=pc(e.wpx),e.width=du(e.wch),e.MDW=kr):typeof e.wch=="number"&&(e.width=du(e.wch),e.wpx=hc(e.width),e.MDW=kr),e.customWidth&&delete e.customWidth}var ZN=96,k1=ZN;function C1(e){return e*96/k1}function Qi(e){return e*k1/96}var e3={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function t3(e,r,t,n){r.Borders=[];var a={},s=!1;(e[0].match(Er)||[]).forEach(function(o){var c=Je(o);switch(Wn(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},c.diagonalUp&&(a.diagonalUp=Et(c.diagonalUp)),c.diagonalDown&&(a.diagonalDown=Et(c.diagonalDown)),r.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+c[0]+" in borders")}})}function r3(e,r,t,n){r.Fills=[];var a={},s=!1;(e[0].match(Er)||[]).forEach(function(o){var c=Je(o);switch(Wn(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},r.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":c.patternType&&(a.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),c.indexed&&(a.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(a.bgColor.theme=parseInt(c.theme,10)),c.tint&&(a.bgColor.tint=parseFloat(c.tint)),c.rgb&&(a.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),c.theme&&(a.fgColor.theme=parseInt(c.theme,10)),c.tint&&(a.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(a.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+c[0]+" in fills")}})}function n3(e,r,t,n){r.Fonts=[];var a={},s=!1;(e[0].match(Er)||[]).forEach(function(o){var c=Je(o);switch(Wn(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(a),a={};break;case"<name":c.val&&(a.name=yt(c.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=c.val?Et(c.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=c.val?Et(c.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(c.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=c.val?Et(c.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=c.val?Et(c.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=c.val?Et(c.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=c.val?Et(c.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=c.val?Et(c.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":c.val&&(a.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(a.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(a.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(a.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=Sd[parseInt(c.val,10)];break;case"<color":if(a.color||(a.color={}),c.auto&&(a.color.auto=Et(c.auto)),c.rgb)a.color.rgb=c.rgb.slice(-6);else if(c.indexed){a.color.index=parseInt(c.indexed,10);var l=Ya[a.color.index];a.color.index==81&&(l=Ya[1]),l||(l=Ya[1]),a.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else c.theme&&(a.color.theme=parseInt(c.theme,10),c.tint&&(a.color.tint=parseFloat(c.tint)),c.theme&&t.themeElements&&t.themeElements.clrScheme&&(a.color.rgb=fc(t.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+c[0]+" in fonts")}})}function a3(e,r,t){r.NumberFmt=[];for(var n=Un(nt),a=0;a<n.length;++a)r.NumberFmt[n[a]]=nt[n[a]];var s=e[0].match(Er);if(s)for(a=0;a<s.length;++a){var o=Je(s[a]);switch(Wn(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=dt(yt(o.formatCode)),l=parseInt(o.numFmtId,10);if(r.NumberFmt[l]=c,l>0){if(l>392){for(l=392;l>60&&r.NumberFmt[l]!=null;--l);r.NumberFmt[l]=c}Ga(c,l)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}var Oo=["numFmtId","fillId","fontId","borderId","xfId"],Ro=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function s3(e,r,t){r.CellXf=[];var n,a=!1;(e[0].match(Er)||[]).forEach(function(s){var o=Je(s),c=0;switch(Wn(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],c=0;c<Oo.length;++c)n[Oo[c]]&&(n[Oo[c]]=parseInt(n[Oo[c]],10));for(c=0;c<Ro.length;++c)n[Ro[c]]&&(n[Ro[c]]=Et(n[Ro[c]]));if(r.NumberFmt&&n.numFmtId>392){for(c=392;c>60;--c)if(r.NumberFmt[n.numFmtId]==r.NumberFmt[c]){n.numFmtId=c;break}}r.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};o.vertical&&(l.vertical=o.vertical),o.horizontal&&(l.horizontal=o.horizontal),o.textRotation!=null&&(l.textRotation=o.textRotation),o.indent&&(l.indent=o.indent),o.wrapText&&(l.wrapText=Et(o.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(t&&t.WTF&&!a)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}var i3=function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,l,u){var d={};if(!c)return d;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=c.match(r))&&a3(f,d,u),(f=c.match(a))&&n3(f,d,l,u),(f=c.match(n))&&r3(f,d,l,u),(f=c.match(s))&&t3(f,d,l,u),(f=c.match(t))&&s3(f,d,u),d}}();function o3(e,r){var t=e.read_shift(2),n=wr(e);return[t,n]}function c3(e,r,t){var n={};n.sz=e.read_shift(2)/20;var a=y4(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var c=e.read_shift(1);c>0&&(n.family=c);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=g4(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=wr(e),n}var l3=Sr;function u3(e,r){var t=e.l+r,n=e.read_shift(2),a=e.read_shift(2);return e.l=t,{ixfe:n,numFmtId:a}}var d3=Sr;function f3(e,r,t){var n={};n.NumberFmt=[];for(var a in nt)n.NumberFmt[a]=nt[a];n.CellXf=[],n.Fonts=[];var s=[],o=!1;return aa(e,function(l,u,d){switch(d){case 44:n.NumberFmt[l[0]]=l[1],Ga(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(l.color.rgb=fc(r.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(d),o=!0;break;case 38:s.pop(),o=!1;break;default:if(u.T>0)s.push(d);else if(u.T<0)s.pop();else if(!o||t.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}var h3=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function p3(e,r,t){r.themeElements.clrScheme=[];var n={};(e[0].match(Er)||[]).forEach(function(a){var s=Je(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(r.themeElements.clrScheme[h3.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function m3(){}function x3(){}var g3=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,y3=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,v3=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function b3(e,r,t){r.themeElements={};var n;[["clrScheme",g3,p3],["fontScheme",y3,m3],["fmtScheme",v3,x3]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,r,t)})}var w3=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function _1(e,r){(!e||e.length===0)&&(e=S3());var t,n={};if(!(t=e.match(w3)))throw new Error("themeElements not found in theme");return b3(t[0],n,r),n.raw=e,n}function S3(e,r){if(r&&r.themeXLSX)return r.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var t=[Bg];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function E3(e,r,t){var n=e.l+r,a=e.read_shift(4);if(a!==124226){if(!t.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var o;try{o=Lg(s,{type:"array"})}catch{return}var c=qr(o,"theme/theme/theme1.xml",!0);if(c)return _1(c,t)}}function T3(e){return e.read_shift(4)}function A3(e){var r={};switch(r.xclrType=e.read_shift(2),r.nTintShade=e.read_shift(2),r.xclrType){case 0:e.l+=4;break;case 1:r.xclrValue=k3(e,4);break;case 2:r.xclrValue=p1(e);break;case 3:r.xclrValue=T3(e);break;case 4:e.l+=4;break}return e.l+=8,r}function k3(e,r){return Sr(e,r)}function C3(e,r){return Sr(e,r)}function _3(e){var r=e.read_shift(2),t=e.read_shift(2)-4,n=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=A3(e);break;case 6:n[1]=C3(e,t);break;case 14:case 15:n[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+t)}return n}function D3(e,r){var t=e.l+r;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),s=[];a-- >0;)s.push(_3(e,t-e.l));return{ixfe:n,ext:s}}function F3(e,r){r.forEach(function(t){switch(t[0]){}})}function j3(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:wr(e)}}function I3(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function P3(e){return e.l+=4,e.read_shift(4)!=0}function O3(e,r,t){var n={Types:[],Cell:[],Value:[]},a=t||{},s=[],o=!1,c=2;return aa(e,function(l,u,d){switch(d){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(f){c==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):c==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:c=l?1:0;break;case 338:c=2;break;case 35:s.push(d),o=!0;break;case 36:s.pop(),o=!1;break;default:if(!u.T){if(!o||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function R3(e,r,t){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,s=2,o;return e.replace(Er,function(c){var l=Je(c);switch(Wn(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==l.name&&(o=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+l.i);break;default:if(!a&&t.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return c}),n}function N3(e){var r=[];if(!e)return r;var t=1;return(e.match(Er)||[]).forEach(function(n){var a=Je(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?t=a.i:a.i=t,r.push(a);break}}),r}function M3(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=et(t);var n=e.read_shift(1);return n&2&&(r.l="1"),n&8&&(r.a="1"),r}function L3(e,r,t){var n=[];return aa(e,function(s,o,c){switch(c){case 63:n.push(s);break;default:if(!o.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),n}function B3(e,r,t,n){if(!e)return e;var a=n||{},s=!1;aa(e,function(c,l,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},a)}function $3(e,r){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][t].Target}function Xh(e,r,t,n){var a=Array.isArray(e),s;r.forEach(function(o){var c=Cr(o.ref);if(a?(e[c.r]||(e[c.r]=[]),s=e[c.r][c.c]):s=e[o.ref],!s){s={t:"z"},a?e[c.r][c.c]=s:e[o.ref]=s;var l=Ot(e["!ref"]||"BDWGO1000001:A1");l.s.r>c.r&&(l.s.r=c.r),l.e.r<c.r&&(l.e.r=c.r),l.s.c>c.c&&(l.s.c=c.c),l.e.c<c.c&&(l.e.c=c.c);var u=lt(l);u!==e["!ref"]&&(e["!ref"]=u)}s.c||(s.c=[]);var d={a:o.author,t:o.t,r:o.r,T:t};o.h&&(d.h=o.h);for(var f=s.c.length-1;f>=0;--f){if(!t&&s.c[f].T)return;t&&!s.c[f].T&&s.c.splice(f,1)}if(t&&n){for(f=0;f<n.length;++f)if(d.a==n[f].id){d.a=n[f].name||d.a;break}}s.c.push(d)})}function U3(e,r){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var c=o.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&t.push(c[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var c=o.match(/<(?:\w+:)?comment[^>]*>/);if(c){var l=Je(c[0]),u={author:l.authorId&&t[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},d=Cr(l.ref);if(!(r.sheetRows&&r.sheetRows<=d.r)){var f=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&Bd(f[1])||{r:"",t:"",h:""};u.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),u.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(u.h=h.h),n.push(u)}}}}),n}function V3(e,r){var t=[],n=!1,a={},s=0;return e.replace(Er,function(c,l){var u=Je(c);switch(Wn(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":a.t!=null&&t.push(a);break;case"<text>":case"<text":s=l+c.length;break;case"</text>":a.t=e.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return c}),t}function W3(e,r){var t=[],n=!1;return e.replace(Er,function(s){var o=Je(s);switch(Wn(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return s}),t}function H3(e){var r={};r.iauthor=e.read_shift(4);var t=bs(e);return r.rfx=t.s,r.ref=et(t.s),e.l+=16,r}var z3=wr;function G3(e,r){var t=[],n=[],a={},s=!1;return aa(e,function(c,l,u){switch(u){case 632:n.push(c);break;case 635:a=c;break;case 637:a.t=c.t,a.h=c.h,a.r=c.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,r.sheetRows&&a.rfx&&r.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,t.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||r.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),t}var Y3="application/vnd.ms-office.vbaProject";function q3(e){var r=ct.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,n){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var a=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");ct.utils.cfb_add(r,a,e.FileIndex[n].content)}}),ct.write(r)}function X3(){return{"!type":"dialog"}}function K3(){return{"!type":"dialog"}}function J3(){return{"!type":"macro"}}function Q3(){return{"!type":"macro"}}var Us=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(n,a,s,o){var c=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),o.length==0?c=!0:o.charAt(0)=="["&&(c=!0,o=o.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return c?d+=r.c:--d,l?u+=r.r:--u,a+(c?"":"$")+Jt(d)+(l?"":"$")+ur(u)}return function(a,s){return r=s,a.replace(e,t)}}(),D1=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Z3=function(){return function(r,t){return r.replace(D1,function(n,a,s,o,c,l){var u=Pd(o)-(s?0:t.c),d=Id(l)-(c?0:t.r),f=d==0?"":c?d+1:"["+d+"]",h=u==0?"":s?u+1:"["+u+"]";return a+"R"+f+"C"+h})}}();function F1(e,r){return e.replace(D1,function(t,n,a,s,o,c){return n+(a=="$"?a+s:Jt(Pd(s)+r.c))+(o=="$"?o+c:ur(Id(c)+r.r))})}function eM(e,r,t){var n=ai(r),a=n.s,s=Cr(t),o={r:s.r-a.r,c:s.c-a.c};return F1(e,o)}function tM(e){return e.length!=1}function Kh(e){return e.replace(/_xlfn\./g,"")}function zt(e){e.l+=1}function Ea(e,r){var t=e.read_shift(r==1?1:2);return[t&16383,t>>14&1,t>>15&1]}function j1(e,r,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return I1(e);t.biff==12&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),o=Ea(e,2),c=Ea(e,2);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:c[0],cRel:c[1],rRel:c[2]}}}function I1(e){var r=Ea(e,2),t=Ea(e,2),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:r[0],c:n,cRel:r[1],rRel:r[2]},e:{r:t[0],c:a,cRel:t[1],rRel:t[2]}}}function rM(e,r,t){if(t.biff<8)return I1(e);var n=e.read_shift(t.biff==12?4:2),a=e.read_shift(t.biff==12?4:2),s=Ea(e,2),o=Ea(e,2);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function P1(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return nM(e);var n=e.read_shift(t&&t.biff==12?4:2),a=Ea(e,2);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function nM(e){var r=Ea(e,2),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}function aM(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function sM(e,r,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return iM(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),o=(s&16384)>>14,c=(s&32768)>>15;if(s&=16383,c==1)for(;a>524287;)a-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:o,rRel:c}}function iM(e){var r=e.read_shift(2),t=e.read_shift(1),n=(r&32768)>>15,a=(r&16384)>>14;return r&=16383,n==1&&r>=8192&&(r=r-16384),a==1&&t>=128&&(t=t-256),{r,c:t,cRel:a,rRel:n}}function oM(e,r,t){var n=(e[e.l++]&96)>>5,a=j1(e,t.biff>=2&&t.biff<=5?6:8,t);return[n,a]}function cM(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var o=j1(e,s,t);return[n,a,o]}function lM(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function uM(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=8;if(t)switch(t.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,a]}function dM(e,r,t){var n=(e[e.l++]&96)>>5,a=rM(e,r-1,t);return[n,a]}function fM(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[n]}function Jh(e){var r=e[e.l+1]&1,t=1;return e.l+=4,[r,t]}function hM(e,r,t){e.l+=2;for(var n=e.read_shift(t&&t.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(t&&t.biff==2?1:2));return a}function pM(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function mM(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function xM(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function gM(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[n]}function O1(e){var r=e.read_shift(1),t=e.read_shift(1);return[r,t]}function yM(e){return e.read_shift(2),O1(e)}function vM(e){return e.read_shift(2),O1(e)}function bM(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=P1(e,0,t);return[n,a]}function wM(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=sM(e,0,t);return[n,a]}function SM(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var s=P1(e,0,t);return[n,a,s]}function EM(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(t&&t.biff<=3?1:2);return[T6[a],M1[a],n]}function TM(e,r,t){var n=e[e.l++],a=e.read_shift(1),s=t&&t.biff<=3?[n==88?-1:0,e.read_shift(1)]:AM(e);return[a,(s[0]===0?M1:E6)[s[1]]]}function AM(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function kM(e,r,t){e.l+=t&&t.biff==2?3:4}function CM(e,r,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function _M(e){return e.l++,ws[e.read_shift(1)]}function DM(e){return e.l++,e.read_shift(2)}function FM(e){return e.l++,e.read_shift(1)!==0}function jM(e){return e.l++,yr(e)}function IM(e,r,t){return e.l++,po(e,r-1,t)}function PM(e,r){var t=[e.read_shift(1)];if(r==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=Mt(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:t[1]=ws[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=yr(e);break;case 2:t[1]=Ss(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function OM(e,r,t){for(var n=e.read_shift(t.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((t.biff==12?bs:Xc)(e));return a}function RM(e,r,t){var n=0,a=0;t.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--a==0&&(a=256));for(var s=0,o=[];s!=n&&(o[s]=[]);++s)for(var c=0;c!=a;++c)o[s][c]=PM(e,t.biff);return o}function NM(e,r,t){var n=e.read_shift(1)>>>5&3,a=!t||t.biff>=8?4:2,s=e.read_shift(a);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function MM(e,r,t){if(t.biff==5)return LM(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),s=e.read_shift(4);return[n,a,s]}function LM(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[r,t,n]}function BM(e,r,t){var n=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function $M(e,r,t){var n=e.read_shift(1)>>>5&3,a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function UM(e,r,t){var n=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[n]}function VM(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,a]}var WM=Sr,HM=Sr,zM=Sr;function xo(e,r,t){return e.l+=2,[aM(e)]}function Ud(e){return e.l+=6,[]}var GM=xo,YM=Ud,qM=Ud,XM=xo;function R1(e){return e.l+=2,[Yt(e),e.read_shift(2)&1]}var KM=xo,JM=R1,QM=Ud,ZM=xo,e6=xo,t6=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function r6(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2),o=t6[t>>2&31];return{ixti:r,coltype:t&3,rt:o,idx:n,c:a,C:s}}function n6(e){return e.l+=2,[e.read_shift(4)]}function a6(e,r,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function s6(e,r,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function i6(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function o6(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function c6(e){return e.l+=4,[0,0]}var Qh={1:{n:"PtgExp",f:CM},2:{n:"PtgTbl",f:zM},3:{n:"PtgAdd",f:zt},4:{n:"PtgSub",f:zt},5:{n:"PtgMul",f:zt},6:{n:"PtgDiv",f:zt},7:{n:"PtgPower",f:zt},8:{n:"PtgConcat",f:zt},9:{n:"PtgLt",f:zt},10:{n:"PtgLe",f:zt},11:{n:"PtgEq",f:zt},12:{n:"PtgGe",f:zt},13:{n:"PtgGt",f:zt},14:{n:"PtgNe",f:zt},15:{n:"PtgIsect",f:zt},16:{n:"PtgUnion",f:zt},17:{n:"PtgRange",f:zt},18:{n:"PtgUplus",f:zt},19:{n:"PtgUminus",f:zt},20:{n:"PtgPercent",f:zt},21:{n:"PtgParen",f:zt},22:{n:"PtgMissArg",f:zt},23:{n:"PtgStr",f:IM},26:{n:"PtgSheet",f:a6},27:{n:"PtgEndSheet",f:s6},28:{n:"PtgErr",f:_M},29:{n:"PtgBool",f:FM},30:{n:"PtgInt",f:DM},31:{n:"PtgNum",f:jM},32:{n:"PtgArray",f:fM},33:{n:"PtgFunc",f:EM},34:{n:"PtgFuncVar",f:TM},35:{n:"PtgName",f:NM},36:{n:"PtgRef",f:bM},37:{n:"PtgArea",f:oM},38:{n:"PtgMemArea",f:BM},39:{n:"PtgMemErr",f:WM},40:{n:"PtgMemNoMem",f:HM},41:{n:"PtgMemFunc",f:$M},42:{n:"PtgRefErr",f:UM},43:{n:"PtgAreaErr",f:lM},44:{n:"PtgRefN",f:wM},45:{n:"PtgAreaN",f:dM},46:{n:"PtgMemAreaN",f:i6},47:{n:"PtgMemNoMemN",f:o6},57:{n:"PtgNameX",f:MM},58:{n:"PtgRef3d",f:SM},59:{n:"PtgArea3d",f:cM},60:{n:"PtgRefErr3d",f:VM},61:{n:"PtgAreaErr3d",f:uM},255:{}},l6={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},u6={1:{n:"PtgElfLel",f:R1},2:{n:"PtgElfRw",f:ZM},3:{n:"PtgElfCol",f:GM},6:{n:"PtgElfRwV",f:e6},7:{n:"PtgElfColV",f:XM},10:{n:"PtgElfRadical",f:KM},11:{n:"PtgElfRadicalS",f:QM},13:{n:"PtgElfColS",f:YM},15:{n:"PtgElfColSV",f:qM},16:{n:"PtgElfRadicalLel",f:JM},25:{n:"PtgList",f:r6},29:{n:"PtgSxName",f:n6},255:{}},d6={0:{n:"PtgAttrNoop",f:c6},1:{n:"PtgAttrSemi",f:gM},2:{n:"PtgAttrIf",f:mM},4:{n:"PtgAttrChoose",f:hM},8:{n:"PtgAttrGoto",f:pM},16:{n:"PtgAttrSum",f:kM},32:{n:"PtgAttrBaxcel",f:Jh},33:{n:"PtgAttrBaxcel",f:Jh},64:{n:"PtgAttrSpace",f:yM},65:{n:"PtgAttrSpaceSemi",f:vM},128:{n:"PtgAttrIfError",f:xM},255:{}};function go(e,r,t,n){if(n.biff<8)return Sr(e,r);for(var a=e.l+r,s=[],o=0;o!==t.length;++o)switch(t[o][0]){case"PtgArray":t[o][1]=RM(e,0,n),s.push(t[o][1]);break;case"PtgMemArea":t[o][2]=OM(e,t[o][1],n),s.push(t[o][2]);break;case"PtgExp":n&&n.biff==12&&(t[o][1][1]=e.read_shift(4),s.push(t[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[o][0]}return r=a-e.l,r!==0&&s.push(Sr(e,r)),s}function yo(e,r,t){for(var n=e.l+r,a,s,o=[];n!=e.l;)r=n-e.l,s=e[e.l],a=Qh[s]||Qh[l6[s]],(s===24||s===25)&&(a=(s===24?u6:d6)[e[e.l+1]]),!a||!a.f?Sr(e,r):o.push([a.n,a.f(e,r,t)]);return o}function f6(e){for(var r=[],t=0;t<e.length;++t){for(var n=e[t],a=[],s=0;s<n.length;++s){var o=n[s];if(o)switch(o[0]){case 2:a.push('"'+o[1].replace(/"/g,'""')+'"');break;default:a.push(o[1])}else a.push("")}r.push(a.join(","))}return r.join(";")}var h6={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function p6(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function N1(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!n)return"SH33TJSERR1";var a="";if(t.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Zh(e,r,t){var n=N1(e,r,t);return n=="#REF"?n:p6(n,t)}function mr(e,r,t,n,a){var s=a&&a.biff||8,o={s:{c:0,r:0},e:{c:0,r:0}},c=[],l,u,d,f=0,h=0,x,m="";if(!e[0]||!e[0][0])return"";for(var p=-1,g="",w=0,y=e[0].length;w<y;++w){var v=e[0][w];switch(v[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=c.pop(),u=c.pop(),p>=0){switch(e[0][p][1][0]){case 0:g=It(" ",e[0][p][1][1]);break;case 1:g=It("\r",e[0][p][1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}u=u+g,p=-1}c.push(u+h6[v[0]]+l);break;case"PtgIsect":l=c.pop(),u=c.pop(),c.push(u+" "+l);break;case"PtgUnion":l=c.pop(),u=c.pop(),c.push(u+","+l);break;case"PtgRange":l=c.pop(),u=c.pop(),c.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=_i(v[1][1],o,a),c.push(Di(d,s));break;case"PtgRefN":d=t?_i(v[1][1],t,a):v[1][1],c.push(Di(d,s));break;case"PtgRef3d":f=v[1][1],d=_i(v[1][2],o,a),m=Zh(n,f,a),c.push(m+"!"+Di(d,s));break;case"PtgFunc":case"PtgFuncVar":var T=v[1][0],F=v[1][1];T||(T=0),T&=127;var A=T==0?[]:c.slice(-T);c.length-=T,F==="User"&&(F=A.shift()),c.push(F+"("+A.join(",")+")");break;case"PtgBool":c.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(v[1]);break;case"PtgNum":c.push(String(v[1]));break;case"PtgStr":c.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(v[1]);break;case"PtgAreaN":x=Ph(v[1][1],t?{s:t}:o,a),c.push(El(x,a));break;case"PtgArea":x=Ph(v[1][1],o,a),c.push(El(x,a));break;case"PtgArea3d":f=v[1][1],x=v[1][2],m=Zh(n,f,a),c.push(m+"!"+El(x,a));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=v[1][2];var S=(n.names||[])[h-1]||(n[0]||[])[h],E=S?S.Name:"SH33TJSNAME"+String(h);E&&E.slice(0,6)=="_xlfn."&&!a.xlfn&&(E=E.slice(6)),c.push(E);break;case"PtgNameX":var b=v[1][1];h=v[1][2];var k;if(a.biff<=5)b<0&&(b=-b),n[b]&&(k=n[b][h]);else{var j="";if(((n[b]||[])[0]||[])[0]==14849||(((n[b]||[])[0]||[])[0]==1025?n[b][h]&&n[b][h].itab>0&&(j=n.SheetNames[n[b][h].itab-1]+"!"):j=n.SheetNames[h-1]+"!"),n[b]&&n[b][h])j+=n[b][h].Name;else if(n[0]&&n[0][h])j+=n[0][h].Name;else{var _=(N1(n,b,a)||"").split(";;");_[h-1]?j=_[h-1]:j+="SH33TJSERRX"}c.push(j);break}k||(k={Name:"SH33TJSERRY"}),c.push(k.Name);break;case"PtgParen":var B="(",Q=")";if(p>=0){switch(g="",e[0][p][1][0]){case 2:B=It(" ",e[0][p][1][1])+B;break;case 3:B=It("\r",e[0][p][1][1])+B;break;case 4:Q=It(" ",e[0][p][1][1])+Q;break;case 5:Q=It("\r",e[0][p][1][1])+Q;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}c.push(B+c.pop()+Q);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":d={c:v[1][1],r:v[1][0]};var Z={c:t.c,r:t.r};if(n.sharedf[et(d)]){var L=n.sharedf[et(d)];c.push(mr(L,o,Z,n,a))}else{var q=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){c.push(mr(u[1],o,Z,n,a)),q=!0;break}q||c.push(v[1])}break;case"PtgArray":c.push("{"+f6(v[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(v));default:throw new Error("Unrecognized Formula Token: "+String(v))}var te=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&p>=0&&te.indexOf(e[0][w][0])==-1){v=e[0][p];var R=!0;switch(v[1][0]){case 4:R=!1;case 0:g=It(" ",v[1][1]);break;case 5:R=!1;case 1:g=It("\r",v[1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}c.push((R?g:"")+c.pop()+(R?"":g)),p=-1}}if(c.length>1&&a.WTF)throw new Error("bad formula stack");return c[0]}function m6(e,r,t){var n=e.l+r,a=t.biff==2?1:2,s,o=e.read_shift(a);if(o==65535)return[[],Sr(e,r-2)];var c=yo(e,o,t);return r!==o+a&&(s=go(e,r-o-a,c,t)),e.l=n,[c,s]}function x6(e,r,t){var n=e.l+r,a=t.biff==2?1:2,s,o=e.read_shift(a);if(o==65535)return[[],Sr(e,r-2)];var c=yo(e,o,t);return r!==o+a&&(s=go(e,r-o-a,c,t)),e.l=n,[c,s]}function g6(e,r,t,n){var a=e.l+r,s=yo(e,n,t),o;return a!==e.l&&(o=go(e,a-e.l,s,t)),[s,o]}function y6(e,r,t){var n=e.l+r,a,s=e.read_shift(2),o=yo(e,s,t);return s==65535?[[],Sr(e,r-2)]:(r!==s+2&&(a=go(e,n-s-2,o,t)),[o,a])}function v6(e){var r;if(Jn(e,e.l+6)!==65535)return[yr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return r=e[e.l+2]===1,e.l+=8,[r,"b"];case 2:return r=e[e.l+2],e.l+=8,[r,"e"];case 3:return e.l+=8,["","s"]}return[]}function kl(e,r,t){var n=e.l+r,a=Hn(e);t.biff==2&&++e.l;var s=v6(e),o=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var c=x6(e,n-e.l,t);return{cell:a,val:s[0],formula:c,shared:o>>3&1,tt:s[1]}}function Kc(e,r,t){var n=e.read_shift(4),a=yo(e,n,t),s=e.read_shift(4),o=s>0?go(e,s,a,t):null;return[a,o]}var b6=Kc,Jc=Kc,w6=Kc,S6=Kc,E6={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},M1={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},T6={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ep(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Cl(e){var r=e.split(":"),t=r[0].split(".")[0];return[t,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}var Pi={},Vs={};function Oi(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function L1(e,r,t,n,a,s){try{n.cellNF&&(e.z=nt[r])}catch(c){if(n.WTF)throw c}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=ir(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(nt[r]==null&&Ga(kO[r]||"General",r),e.t==="e")e.w=e.w||ws[e.v];else if(r===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Yi(e.v);else if(e.t==="d"){var o=jr(e.v);(o|0)===o?e.w=o.toString(10):e.w=Yi(o)}else{if(e.v===void 0)return"";e.w=is(e.v,Vs)}else e.t==="d"?e.w=cn(r,jr(e.v),Vs):e.w=cn(r,e.v,Vs)}catch(c){if(n.WTF)throw c}if(n.cellStyles&&t!=null)try{e.s=s.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=fc(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=fc(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(c){if(n.WTF&&s.Fills)throw c}}}function A6(e,r){var t=Ot(r);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=lt(t))}var k6=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,C6=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,_6=/<(?:\w:)?hyperlink [^>]*>/mg,D6=/"(\w*:\w*)"/,F6=/<(?:\w:)?col\b[^>]*[\/]?>/g,j6=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,I6=/<(?:\w:)?pageMargins[^>]*\/>/g,B1=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,P6=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,O6=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function R6(e,r,t,n,a,s,o){if(!e)return e;n||(n={"!id":{}});var c=r.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",f=e.match(C6);f?(u=e.slice(0,f.index),d=e.slice(f.index+f[0].length)):u=d=e;var h=u.match(B1);h?Vd(h[0],c,a,t):(h=u.match(P6))&&N6(h[0],h[1]||"",c,a,t);var x=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(x>0){var m=u.slice(x,x+50).match(D6);m&&A6(c,m[1])}var p=u.match(O6);p&&p[1]&&V6(p[1],a);var g=[];if(r.cellStyles){var w=u.match(F6);w&&B6(g,w)}f&&W6(f[1],c,r,l,s,o);var y=d.match(j6);y&&(c["!autofilter"]=$6(y[0]));var v=[],T=d.match(k6);if(T)for(x=0;x!=T.length;++x)v[x]=Ot(T[x].slice(T[x].indexOf('"')+1));var F=d.match(_6);F&&M6(c,F,n);var A=d.match(I6);if(A&&(c["!margins"]=L6(Je(A[0]))),!c["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(c["!ref"]=lt(l)),r.sheetRows>0&&c["!ref"]){var S=Ot(c["!ref"]);r.sheetRows<=+S.e.r&&(S.e.r=r.sheetRows-1,S.e.r>l.e.r&&(S.e.r=l.e.r),S.e.r<S.s.r&&(S.s.r=S.e.r),S.e.c>l.e.c&&(S.e.c=l.e.c),S.e.c<S.s.c&&(S.s.c=S.e.c),c["!fullref"]=c["!ref"],c["!ref"]=lt(S))}return g.length>0&&(c["!cols"]=g),v.length>0&&(c["!merges"]=v),c}function Vd(e,r,t,n){var a=Je(e);t.Sheets[n]||(t.Sheets[n]={}),a.codeName&&(t.Sheets[n].CodeName=dt(yt(a.codeName)))}function N6(e,r,t,n,a){Vd(e.slice(0,e.indexOf(">")),t,n,a)}function M6(e,r,t){for(var n=Array.isArray(e),a=0;a!=r.length;++a){var s=Je(yt(r[a]),!0);if(!s.ref)return;var o=((t||{})["!id"]||[])[s.id];o?(s.Target=o.Target,s.location&&(s.Target+="#"+dt(s.location))):(s.Target="#"+dt(s.location),o={Target:s.Target,TargetMode:"Internal"}),s.Rel=o,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var c=Ot(s.ref),l=c.s.r;l<=c.e.r;++l)for(var u=c.s.c;u<=c.e.c;++u){var d=et({c:u,r:l});n?(e[l]||(e[l]=[]),e[l][u]||(e[l][u]={t:"z",v:void 0}),e[l][u].l=s):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=s)}}}function L6(e){var r={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(r[t]=parseFloat(e[t]))}),r}function B6(e,r){for(var t=!1,n=0;n!=r.length;++n){var a=Je(r[n],!0);a.hidden&&(a.hidden=Et(a.hidden));var s=parseInt(a.min,10)-1,o=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!t&&a.width&&(t=!0,$d(a.width)),Js(a);s<=o;)e[s++]=lr(a)}}function $6(e){var r={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return r}var U6=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function V6(e,r){r.Views||(r.Views=[{}]),(e.match(U6)||[]).forEach(function(t,n){var a=Je(t);r.Views[n]||(r.Views[n]={}),+a.zoomScale&&(r.Views[n].zoom=+a.zoomScale),Et(a.rightToLeft)&&(r.Views[n].RTL=!0)})}var W6=function(){var e=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=qi("v"),o=qi("f");return function(l,u,d,f,h,x){for(var m=0,p="",g=[],w=[],y=0,v=0,T=0,F="",A,S,E=0,b=0,k,j,_=0,B=0,Q=Array.isArray(x.CellXf),Z,L=[],q=[],te=Array.isArray(u),R=[],oe={},J=!1,P=!!d.sheetStubs,V=l.split(r),z=0,G=V.length;z!=G;++z){p=V[z].trim();var ne=p.length;if(ne!==0){var he=0;e:for(m=0;m<ne;++m)switch(p[m]){case">":if(p[m-1]!="/"){++m;break e}if(d&&d.cellStyles){if(S=Je(p.slice(he,m),!0),E=S.r!=null?parseInt(S.r,10):E+1,b=-1,d.sheetRows&&d.sheetRows<E)continue;oe={},J=!1,S.ht&&(J=!0,oe.hpt=parseFloat(S.ht),oe.hpx=Qi(oe.hpt)),S.hidden=="1"&&(J=!0,oe.hidden=!0),S.outlineLevel!=null&&(J=!0,oe.level=+S.outlineLevel),J&&(R[E-1]=oe)}break;case"<":he=m;break}if(he>=m)break;if(S=Je(p.slice(he,m),!0),E=S.r!=null?parseInt(S.r,10):E+1,b=-1,!(d.sheetRows&&d.sheetRows<E)){f.s.r>E-1&&(f.s.r=E-1),f.e.r<E-1&&(f.e.r=E-1),d&&d.cellStyles&&(oe={},J=!1,S.ht&&(J=!0,oe.hpt=parseFloat(S.ht),oe.hpx=Qi(oe.hpt)),S.hidden=="1"&&(J=!0,oe.hidden=!0),S.outlineLevel!=null&&(J=!0,oe.level=+S.outlineLevel),J&&(R[E-1]=oe)),g=p.slice(m).split(e);for(var se=0;se!=g.length&&g[se].trim().charAt(0)=="<";++se);for(g=g.slice(se),m=0;m!=g.length;++m)if(p=g[m].trim(),p.length!==0){if(w=p.match(t),y=m,v=0,T=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,w!=null&&w.length===2){for(y=0,F=w[1],v=0;v!=F.length&&!((T=F.charCodeAt(v)-64)<1||T>26);++v)y=26*y+T;--y,b=y}else++b;for(v=0;v!=p.length&&p.charCodeAt(v)!==62;++v);if(++v,S=Je(p.slice(0,v),!0),S.r||(S.r=et({r:E-1,c:b})),F=p.slice(v),A={t:""},(w=F.match(s))!=null&&w[1]!==""&&(A.v=dt(w[1])),d.cellFormula){if((w=F.match(o))!=null&&w[1]!==""){if(A.f=dt(yt(w[1])).replace(/\r\n/g,`
`),d.xlfn||(A.f=Kh(A.f)),w[0].indexOf('t="array"')>-1)A.F=(F.match(a)||[])[1],A.F.indexOf(":")>-1&&L.push([Ot(A.F),A.F]);else if(w[0].indexOf('t="shared"')>-1){j=Je(w[0]);var ae=dt(yt(w[1]));d.xlfn||(ae=Kh(ae)),q[parseInt(j.si,10)]=[j,ae,S.r]}}else(w=F.match(/<f[^>]*\/>/))&&(j=Je(w[0]),q[j.si]&&(A.f=eM(q[j.si][1],q[j.si][2],S.r)));var K=Cr(S.r);for(v=0;v<L.length;++v)K.r>=L[v][0].s.r&&K.r<=L[v][0].e.r&&K.c>=L[v][0].s.c&&K.c<=L[v][0].e.c&&(A.F=L[v][1])}if(S.t==null&&A.v===void 0)if(A.f||A.F)A.v=0,A.t="n";else if(P)A.t="z";else continue;else A.t=S.t||"n";switch(f.s.c>b&&(f.s.c=b),f.e.c<b&&(f.e.c=b),A.t){case"n":if(A.v==""||A.v==null){if(!P)continue;A.t="z"}else A.v=parseFloat(A.v);break;case"s":if(typeof A.v>"u"){if(!P)continue;A.t="z"}else k=Pi[parseInt(A.v,10)],A.v=k.t,A.r=k.r,d.cellHTML&&(A.h=k.h);break;case"str":A.t="s",A.v=A.v!=null?yt(A.v):"",d.cellHTML&&(A.h=Dd(A.v));break;case"inlineStr":w=F.match(n),A.t="s",w!=null&&(k=Bd(w[1]))?(A.v=k.t,d.cellHTML&&(A.h=k.h)):A.v="";break;case"b":A.v=Et(A.v);break;case"d":d.cellDates?A.v=ir(A.v,1):(A.v=jr(ir(A.v,1)),A.t="n");break;case"e":(!d||d.cellText!==!1)&&(A.w=A.v),A.v=i1[A.v];break}if(_=B=0,Z=null,Q&&S.s!==void 0&&(Z=x.CellXf[S.s],Z!=null&&(Z.numFmtId!=null&&(_=Z.numFmtId),d.cellStyles&&Z.fillId!=null&&(B=Z.fillId))),L1(A,_,B,d,h,x),d.cellDates&&Q&&A.t=="n"&&ni(nt[_])&&(A.t="d",A.v=qc(A.v)),S.cm&&d.xlmeta){var O=(d.xlmeta.Cell||[])[+S.cm-1];O&&O.type=="XLDAPR"&&(A.D=!0)}if(te){var D=Cr(S.r);u[D.r]||(u[D.r]=[]),u[D.r][D.c]=A}else u[S.r]=A}}}}R.length>0&&(u["!rows"]=R)}}();function H6(e,r){var t={},n=e.l+r;t.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=a/20),t}var z6=bs;function G6(){}function Y6(e,r){var t={},n=e[e.l];return++e.l,t.above=!(n&64),t.left=!(n&128),e.l+=18,t.name=m4(e),t}function q6(e){var r=un(e);return[r]}function X6(e){var r=vs(e);return[r]}function K6(e){var r=un(e),t=e.read_shift(1);return[r,t,"b"]}function J6(e){var r=vs(e),t=e.read_shift(1);return[r,t,"b"]}function Q6(e){var r=un(e),t=e.read_shift(1);return[r,t,"e"]}function Z6(e){var r=vs(e),t=e.read_shift(1);return[r,t,"e"]}function eL(e){var r=un(e),t=e.read_shift(4);return[r,t,"s"]}function tL(e){var r=vs(e),t=e.read_shift(4);return[r,t,"s"]}function rL(e){var r=un(e),t=yr(e);return[r,t,"n"]}function $1(e){var r=vs(e),t=yr(e);return[r,t,"n"]}function nL(e){var r=un(e),t=Nd(e);return[r,t,"n"]}function aL(e){var r=vs(e),t=Nd(e);return[r,t,"n"]}function sL(e){var r=un(e),t=Od(e);return[r,t,"is"]}function iL(e){var r=un(e),t=wr(e);return[r,t,"str"]}function oL(e){var r=vs(e),t=wr(e);return[r,t,"str"]}function cL(e,r,t){var n=e.l+r,a=un(e);a.r=t["!row"];var s=e.read_shift(1),o=[a,s,"b"];if(t.cellFormula){e.l+=2;var c=Jc(e,n-e.l,t);o[3]=mr(c,null,a,t.supbooks,t)}else e.l=n;return o}function lL(e,r,t){var n=e.l+r,a=un(e);a.r=t["!row"];var s=e.read_shift(1),o=[a,s,"e"];if(t.cellFormula){e.l+=2;var c=Jc(e,n-e.l,t);o[3]=mr(c,null,a,t.supbooks,t)}else e.l=n;return o}function uL(e,r,t){var n=e.l+r,a=un(e);a.r=t["!row"];var s=yr(e),o=[a,s,"n"];if(t.cellFormula){e.l+=2;var c=Jc(e,n-e.l,t);o[3]=mr(c,null,a,t.supbooks,t)}else e.l=n;return o}function dL(e,r,t){var n=e.l+r,a=un(e);a.r=t["!row"];var s=wr(e),o=[a,s,"str"];if(t.cellFormula){e.l+=2;var c=Jc(e,n-e.l,t);o[3]=mr(c,null,a,t.supbooks,t)}else e.l=n;return o}var fL=bs;function hL(e,r){var t=e.l+r,n=bs(e),a=Rd(e),s=wr(e),o=wr(e),c=wr(e);e.l=t;var l={rfx:n,relId:a,loc:s,display:c};return o&&(l.Tooltip=o),l}function pL(){}function mL(e,r,t){var n=e.l+r,a=n1(e),s=e.read_shift(1),o=[a];if(o[2]=s,t.cellFormula){var c=b6(e,n-e.l,t);o[1]=c}else e.l=n;return o}function xL(e,r,t){var n=e.l+r,a=bs(e),s=[a];if(t.cellFormula){var o=S6(e,n-e.l,t);s[1]=o,e.l=n}else e.l=n;return s}var gL=["left","right","top","bottom","header","footer"];function yL(e){var r={};return gL.forEach(function(t){r[t]=yr(e)}),r}function vL(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function bL(){}function wL(){}function SL(e,r,t,n,a,s,o){if(!e)return e;var c=r||{};n||(n={"!id":{}});var l=c.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,x,m,p,g,w,y,v,T,F,A=[];c.biff=12,c["!row"]=0;var S=0,E=!1,b=[],k={},j=c.supbooks||a.supbooks||[[]];if(j.sharedf=k,j.arrayf=b,j.SheetNames=a.SheetNames||a.Sheets.map(function(te){return te.name}),!c.supbooks&&(c.supbooks=j,a.Names))for(var _=0;_<a.Names.length;++_)j[0][_+1]=a.Names[_];var B=[],Q=[],Z=!1;mc[16]={n:"BrtShortReal",f:$1};var L;if(aa(e,function(R,oe,J){if(!h)switch(J){case 148:u=R;break;case 0:x=R,c.sheetRows&&c.sheetRows<=x.r&&(h=!0),T=ur(g=x.r),c["!row"]=x.r,(R.hidden||R.hpt||R.level!=null)&&(R.hpt&&(R.hpx=Qi(R.hpt)),Q[R.r]=R);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:R[2]},R[2]){case"n":m.v=R[1];break;case"s":v=Pi[R[1]],m.v=v.t,m.r=v.r;break;case"b":m.v=!!R[1];break;case"e":m.v=R[1],c.cellText!==!1&&(m.w=ws[m.v]);break;case"str":m.t="s",m.v=R[1];break;case"is":m.t="s",m.v=R[1].t;break}if((p=o.CellXf[R[0].iStyleRef])&&L1(m,p.numFmtId,null,c,s,o),w=R[0].c==-1?w+1:R[0].c,c.dense?(l[g]||(l[g]=[]),l[g][w]=m):l[Jt(w)+T]=m,c.cellFormula){for(E=!1,S=0;S<b.length;++S){var P=b[S];x.r>=P[0].s.r&&x.r<=P[0].e.r&&w>=P[0].s.c&&w<=P[0].e.c&&(m.F=lt(P[0]),E=!0)}!E&&R.length>3&&(m.f=R[3])}if(d.s.r>x.r&&(d.s.r=x.r),d.s.c>w&&(d.s.c=w),d.e.r<x.r&&(d.e.r=x.r),d.e.c<w&&(d.e.c=w),c.cellDates&&p&&m.t=="n"&&ni(nt[p.numFmtId])){var V=Wa(m.v);V&&(m.t="d",m.v=new Date(V.y,V.m-1,V.d,V.H,V.M,V.S,V.u))}L&&(L.type=="XLDAPR"&&(m.D=!0),L=void 0);break;case 1:case 12:if(!c.sheetStubs||f)break;m={t:"z",v:void 0},w=R[0].c==-1?w+1:R[0].c,c.dense?(l[g]||(l[g]=[]),l[g][w]=m):l[Jt(w)+T]=m,d.s.r>x.r&&(d.s.r=x.r),d.s.c>w&&(d.s.c=w),d.e.r<x.r&&(d.e.r=x.r),d.e.c<w&&(d.e.c=w),L&&(L.type=="XLDAPR"&&(m.D=!0),L=void 0);break;case 176:A.push(R);break;case 49:L=((c.xlmeta||{}).Cell||[])[R-1];break;case 494:var z=n["!id"][R.relId];for(z?(R.Target=z.Target,R.loc&&(R.Target+="#"+R.loc),R.Rel=z):R.relId==""&&(R.Target="#"+R.loc),g=R.rfx.s.r;g<=R.rfx.e.r;++g)for(w=R.rfx.s.c;w<=R.rfx.e.c;++w)c.dense?(l[g]||(l[g]=[]),l[g][w]||(l[g][w]={t:"z",v:void 0}),l[g][w].l=R):(y=et({c:w,r:g}),l[y]||(l[y]={t:"z",v:void 0}),l[y].l=R);break;case 426:if(!c.cellFormula)break;b.push(R),F=c.dense?l[g][w]:l[Jt(w)+T],F.f=mr(R[1],d,{r:x.r,c:w},j,c),F.F=lt(R[0]);break;case 427:if(!c.cellFormula)break;k[et(R[0].s)]=R[1],F=c.dense?l[g][w]:l[Jt(w)+T],F.f=mr(R[1],d,{r:x.r,c:w},j,c);break;case 60:if(!c.cellStyles)break;for(;R.e>=R.s;)B[R.e--]={width:R.w/256,hidden:!!(R.flags&1),level:R.level},Z||(Z=!0,$d(R.w/256)),Js(B[R.e+1]);break;case 161:l["!autofilter"]={ref:lt(R)};break;case 476:l["!margins"]=R;break;case 147:a.Sheets[t]||(a.Sheets[t]={}),R.name&&(a.Sheets[t].CodeName=R.name),(R.above||R.left)&&(l["!outline"]={above:R.above,left:R.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),R.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!oe.T){if(!f||c.WTF)throw new Error("Unexpected record 0x"+J.toString(16))}}},c),delete c.supbooks,delete c["!row"],!l["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(l["!ref"]=lt(u||d)),c.sheetRows&&l["!ref"]){var q=Ot(l["!ref"]);c.sheetRows<=+q.e.r&&(q.e.r=c.sheetRows-1,q.e.r>d.e.r&&(q.e.r=d.e.r),q.e.r<q.s.r&&(q.s.r=q.e.r),q.e.c>d.e.c&&(q.e.c=d.e.c),q.e.c<q.s.c&&(q.s.c=q.e.c),l["!fullref"]=l["!ref"],l["!ref"]=lt(q))}return A.length>0&&(l["!merges"]=A),B.length>0&&(l["!cols"]=B),Q.length>0&&(l["!rows"]=Q),l}function EL(e){var r=[],t=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var o=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(r[+o[1]]=t?+o[2]:o[2])});var a=dt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[r,a,n]}function TL(e,r,t,n,a,s){var o=s||{"!type":"chart"};if(!e)return s;var c=0,l=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=EL(f);d.s.r=d.s.c=0,d.e.c=c,u=Jt(c),h[0].forEach(function(x,m){o[u+ur(m)]={t:"n",v:x,z:h[1]},l=m}),d.e.r<l&&(d.e.r=l),++c}),c>0&&(o["!ref"]=lt(d)),o}function AL(e,r,t,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o,c=e.match(B1);return c&&Vd(c[0],s,a,t),(o=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=o[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function kL(e,r){e.l+=10;var t=wr(e);return{name:t}}function CL(e,r,t,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o=!1;return aa(e,function(l,u,d){switch(d){case 550:s["!rel"]=l;break;case 651:a.Sheets[t]||(a.Sheets[t]={}),l.name&&(a.Sheets[t].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!o||r.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},r),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var U1=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],_L=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],DL=[],FL=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function tp(e,r){for(var t=0;t!=e.length;++t)for(var n=e[t],a=0;a!=r.length;++a){var s=r[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Et(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function rp(e,r){for(var t=0;t!=r.length;++t){var n=r[t];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Et(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function V1(e){rp(e.WBProps,U1),rp(e.CalcPr,FL),tp(e.WBView,_L),tp(e.Sheets,DL),Vs.date1904=Et(e.WBProps.date1904)}var jL="][*?/\\".split("");function IL(e,r){if(e.length>31){if(r)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var t=!0;return jL.forEach(function(n){if(e.indexOf(n)!=-1){if(!r)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");t=!1}}),t}var PL=/<\w+:workbook/;function OL(e,r){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},o=0;if(e.replace(Er,function(l,u){var d=Je(l);switch(Wn(d[0])){case"<?xml":break;case"<workbook":l.match(PL)&&(a="xmlns"+l.match(/<(\w+):/)[1]),t.xmlns=d[a];break;case"</workbook>":break;case"<fileVersion":delete d[0],t.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":U1.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":t.WBProps[f[0]]=Et(d[f[0]]);break;case"int":t.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:t.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(t.WBProps.CodeName=yt(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],t.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=dt(yt(d.name)),delete d[0],t.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=yt(d.name),d.comment&&(s.Comment=d.comment),d.localSheetId&&(s.Sheet=+d.localSheetId),Et(d.hidden||"0")&&(s.Hidden=!0),o=u+l.length;break;case"</definedName>":s.Ref=dt(yt(e.slice(o,u))),t.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete d[0],t.CalcPr=d;break;case"<calcPr/>":delete d[0],t.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&r.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return l}),QO.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return V1(t),t}function RL(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=cu(e),t.name=wr(e),t}function NL(e,r){var t={},n=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var a=r>8?wr(e):"";return a.length>0&&(t.CodeName=a),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function ML(e,r){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=r-8,t}function LL(e,r,t){var n=e.l+r;e.l+=4,e.l+=1;var a=e.read_shift(4),s=x4(e),o=w6(e,0,t),c=Rd(e);e.l=n;var l={Name:s,Ptg:o};return a<268435455&&(l.Sheet=a),c&&(l.Comment=c),l}function BL(e,r){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;r||(r={}),r.biff=12;var s=[],o=[[]];return o.SheetNames=[],o.XTI=[],mc[16]={n:"BrtFRTArchID$",f:ML},aa(e,function(l,u,d){switch(d){case 156:o.SheetNames.push(l.name),t.Sheets.push(l);break;case 153:t.WBProps=l;break;case 39:l.Sheet!=null&&(r.SID=l.Sheet),l.Ref=mr(l.Ptg,null,null,o,r),delete r.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([d,l]):o[0]=[d,l],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(l),o.XTI=o.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(d),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!u.T){if(!a||r.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},r),V1(t),t.Names=s,t.supbooks=o,t}function $L(e,r,t){return r.slice(-4)===".bin"?BL(e,t):OL(e,t)}function UL(e,r,t,n,a,s,o,c){return r.slice(-4)===".bin"?SL(e,n,t,a,s,o,c):R6(e,n,t,a,s,o,c)}function VL(e,r,t,n,a,s,o,c){return r.slice(-4)===".bin"?CL(e,n,t,a,s):AL(e,n,t,a,s)}function WL(e,r,t,n,a,s,o,c){return r.slice(-4)===".bin"?J3():Q3()}function HL(e,r,t,n,a,s,o,c){return r.slice(-4)===".bin"?X3():K3()}function zL(e,r,t,n){return r.slice(-4)===".bin"?f3(e,t,n):i3(e,t,n)}function GL(e,r,t){return _1(e,t)}function YL(e,r,t){return r.slice(-4)===".bin"?_N(e,t):kN(e,t)}function qL(e,r,t){return r.slice(-4)===".bin"?G3(e,t):U3(e,t)}function XL(e,r,t){return r.slice(-4)===".bin"?L3(e):N3(e)}function KL(e,r,t,n){return t.slice(-4)===".bin"?B3(e,r,t,n):void 0}function JL(e,r,t){return r.slice(-4)===".bin"?O3(e,r,t):R3(e,r,t)}var W1=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,H1=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function fn(e,r){var t=e.split(/\s+/),n=[];if(r||(n[0]=t[0]),t.length===1)return n;var a=e.match(W1),s,o,c,l;if(a)for(l=0;l!=a.length;++l)s=a[l].match(H1),(o=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?c="xmlns"+s[1].slice(6):c=s[1].slice(o+1),n[c]=s[2].slice(1,s[2].length-1));return n}function QL(e){var r=e.split(/\s+/),t={};if(r.length===1)return t;var n=e.match(W1),a,s,o,c;if(n)for(c=0;c!=n.length;++c)a=n[c].match(H1),(s=a[1].indexOf(":"))===-1?t[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(s+1),t[o]=a[2].slice(1,a[2].length-1));return t}var Ri;function ZL(e,r){var t=Ri[e]||dt(e);return t==="General"?is(r):cn(t,r)}function e5(e,r,t,n){var a=n;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Et(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=ir(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[dt(r)]=a}function t5(e,r,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||ws[e.v]:r==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Yi(e.v):e.w=is(e.v):e.w=ZL(r||"General",e.v)}catch(s){if(t.WTF)throw s}try{var n=Ri[r]||r||"General";if(t.cellNF&&(e.z=n),t.cellDates&&e.t=="n"&&ni(n)){var a=Wa(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(t.WTF)throw s}}}function r5(e,r,t){if(t.cellStyles&&r.Interior){var n=r.Interior;n.Pattern&&(n.patternType=e3[n.Pattern]||n.Pattern)}e[r.ID]=r}function n5(e,r,t,n,a,s,o,c,l,u){var d="General",f=n.StyleID,h={};u=u||{};var x=[],m=0;for(f===void 0&&c&&(f=c.StyleID),f===void 0&&o&&(f=o.StyleID);s[f]!==void 0&&(s[f].nf&&(d=s[f].nf),s[f].Interior&&x.push(s[f].Interior),!!s[f].Parent);)f=s[f].Parent;switch(t.Type){case"Boolean":n.t="b",n.v=Et(e);break;case"String":n.t="s",n.r=Th(dt(e)),n.v=e.indexOf("<")>-1?dt(r||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(ir(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=dt(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=i1[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&r==""?n.t="z":(n.t="s",n.v=Th(r||e));break}if(t5(n,d,u),u.cellFormula!==!1)if(n.Formula){var p=dt(n.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),n.f=Us(p,a),delete n.Formula,n.ArrayRange=="RC"?n.F=Us("RC:RC",a):n.ArrayRange&&(n.F=Us(n.ArrayRange,a),l.push([Ot(n.F),n.F]))}else for(m=0;m<l.length;++m)a.r>=l[m][0].s.r&&a.r<=l[m][0].e.r&&a.c>=l[m][0].s.c&&a.c<=l[m][0].e.c&&(n.F=l[m][1]);u.cellStyles&&(x.forEach(function(g){!h.patternType&&g.patternType&&(h.patternType=g.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function a5(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function _l(e,r){var t=r||{};jg();var n=wi(Fd(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(n=yt(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var o=lr(t);return o.type="string",Ki.to_workbook(n,o)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(xe){a.indexOf("<"+xe)>=0&&(s=!0)}),s)return h5(n,t);Ri={"General Number":"General","General Date":nt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":nt[15],"Short Date":nt[14],"Long Time":nt[19],"Medium Time":nt[18],"Short Time":nt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:nt[2],Standard:nt[4],Percent:nt[10],Scientific:nt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,l=[],u,d={},f=[],h=t.dense?[]:{},x="",m={},p={},g=fn('<Data ss:Type="String">'),w=0,y=0,v=0,T={s:{r:2e6,c:2e6},e:{r:0,c:0}},F={},A={},S="",E=0,b=[],k={},j={},_=0,B=[],Q=[],Z={},L=[],q,te=!1,R=[],oe=[],J={},P=0,V=0,z={Sheets:[],WBProps:{date1904:!1}},G={};Xi.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ne="";c=Xi.exec(n);)switch(c[3]=(ne=c[3]).toLowerCase()){case"data":if(ne=="data"){if(c[1]==="/"){if((u=l.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&l.push([c[3],!0]);break}if(l[l.length-1][1])break;c[1]==="/"?n5(n.slice(w,c.index),S,g,l[l.length-1][0]=="comment"?Z:m,{c:y,r:v},F,L[y],p,R,t):(S="",g=fn(c[0]),w=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(Q.length>0&&(m.c=Q),(!t.sheetRows||t.sheetRows>v)&&m.v!==void 0&&(t.dense?(h[v]||(h[v]=[]),h[v][y]=m):h[Jt(y)+ur(v)]=m),m.HRef&&(m.l={Target:dt(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(P=y+(parseInt(m.MergeAcross,10)|0),V=v+(parseInt(m.MergeDown,10)|0),b.push({s:{c:y,r:v},e:{c:P,r:V}})),!t.sheetStubs)m.MergeAcross?y=P+1:++y;else if(m.MergeAcross||m.MergeDown){for(var he=y;he<=P;++he)for(var se=v;se<=V;++se)(he>y||se>v)&&(t.dense?(h[se]||(h[se]=[]),h[se][he]={t:"z"}):h[Jt(he)+ur(se)]={t:"z"});y=P+1}else++y;else m=QL(c[0]),m.Index&&(y=+m.Index-1),y<T.s.c&&(T.s.c=y),y>T.e.c&&(T.e.c=y),c[0].slice(-2)==="/>"&&++y,Q=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(v<T.s.r&&(T.s.r=v),v>T.e.r&&(T.e.r=v),c[0].slice(-2)==="/>"&&(p=fn(c[0]),p.Index&&(v=+p.Index-1)),y=0,++v):(p=fn(c[0]),p.Index&&(v=+p.Index-1),J={},(p.AutoFitHeight=="0"||p.Height)&&(J.hpx=parseInt(p.Height,10),J.hpt=C1(J.hpx),oe[v]=J),p.Hidden=="1"&&(J.hidden=!0,oe[v]=J));break;case"worksheet":if(c[1]==="/"){if((u=l.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"));f.push(x),T.s.r<=T.e.r&&T.s.c<=T.e.c&&(h["!ref"]=lt(T),t.sheetRows&&t.sheetRows<=T.e.r&&(h["!fullref"]=h["!ref"],T.e.r=t.sheetRows-1,h["!ref"]=lt(T))),b.length&&(h["!merges"]=b),L.length>0&&(h["!cols"]=L),oe.length>0&&(h["!rows"]=oe),d[x]=h}else T={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=y=0,l.push([c[3],!1]),u=fn(c[0]),x=dt(u.Name),h=t.dense?[]:{},b=[],R=[],oe=[],G={name:x,Hidden:0},z.Sheets.push(G);break;case"table":if(c[1]==="/"){if((u=l.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else{if(c[0].slice(-2)=="/>")break;l.push([c[3],!1]),L=[],te=!1}break;case"style":c[1]==="/"?r5(F,A,t):A=fn(c[0]);break;case"numberformat":A.nf=dt(fn(c[0]).Format||"General"),Ri[A.nf]&&(A.nf=Ri[A.nf]);for(var ae=0;ae!=392&&nt[ae]!=A.nf;++ae);if(ae==392){for(ae=57;ae!=392;++ae)if(nt[ae]==null){Ga(A.nf,ae);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(q=fn(c[0]),q.Hidden&&(q.hidden=!0,delete q.Hidden),q.Width&&(q.wpx=parseInt(q.Width,10)),!te&&q.wpx>10){te=!0,kr=A1;for(var K=0;K<L.length;++K)L[K]&&Js(L[K])}te&&Js(q),L[q.Index-1||L.length]=q;for(var O=0;O<+q.Span;++O)L[L.length]=lr(q);break;case"namedrange":if(c[1]==="/")break;z.Names||(z.Names=[]);var D=Je(c[0]),re={Name:D.Name,Ref:Us(D.RefersTo.slice(1),{r:0,c:0})};z.Sheets.length>0&&(re.Sheet=z.Sheets.length-1),z.Names.push(re);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?S+=n.slice(E,c.index):E=c.index+c[0].length;break;case"interior":if(!t.cellStyles)break;A.Interior=fn(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?U4(k,ne,n.slice(_,c.index)):_=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((u=l.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else l.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((u=l.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"));a5(Z),Q.push(Z)}else l.push([c[3],!1]),u=fn(c[0]),Z={a:u.Author};break;case"autofilter":if(c[1]==="/"){if((u=l.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var le=fn(c[0]);h["!autofilter"]={ref:Us(le.Range).replace(/\$/g,"")},l.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((u=l.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&l.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((u=l.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&l.push([c[3],!0]);break;case"null":break;default:if(l.length==0&&c[3]=="document"||l.length==0&&c[3]=="uof")return cp(n,t);var Te=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Te=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Te=!1}break;case"excelworkbook":switch(c[3]){case"date1904":z.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Te=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:Te=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(n.slice(_,c.index)){case"SheetHidden":G.Hidden=1;break;case"SheetVeryHidden":G.Hidden=2;break}else _=c.index+c[0].length;break;case"header":h["!margins"]||Oi(h["!margins"]={},"xlml"),isNaN(+Je(c[0]).Margin)||(h["!margins"].header=+Je(c[0]).Margin);break;case"footer":h["!margins"]||Oi(h["!margins"]={},"xlml"),isNaN(+Je(c[0]).Margin)||(h["!margins"].footer=+Je(c[0]).Margin);break;case"pagemargins":var ue=Je(c[0]);h["!margins"]||Oi(h["!margins"]={},"xlml"),isNaN(+ue.Top)||(h["!margins"].top=+ue.Top),isNaN(+ue.Left)||(h["!margins"].left=+ue.Left),isNaN(+ue.Right)||(h["!margins"].right=+ue.Right),isNaN(+ue.Bottom)||(h["!margins"].bottom=+ue.Bottom);break;case"displayrighttoleft":z.Views||(z.Views=[]),z.Views[0]||(z.Views[0]={}),z.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Te=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Te=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Te=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Te=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Te=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Te=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Te=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Te=!1}break;case"smarttags":break;default:Te=!1;break}if(Te||c[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?e5(j,ne,B,n.slice(_,c.index)):(B=c,_=c.index+c[0].length);break}if(t.WTF)throw"Unrecognized tag: "+c[3]+"|"+l.join("|")}var we={};return!t.bookSheets&&!t.bookProps&&(we.Sheets=d),we.SheetNames=f,we.Workbook=z,we.SSF=lr(nt),we.Props=k,we.Custprops=j,we}function fu(e,r){switch(zd(r=r||{}),r.type||"base64"){case"base64":return _l(Kr(e),r);case"binary":case"buffer":case"file":return _l(e,r);case"array":return _l(ys(e),r)}}function s5(e){var r={},t=e.content;if(t.l=28,r.AnsiUserType=t.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=v4(t),t.length-t.l<=4)return r;var n=t.read_shift(4);if(n==0||n>40||(t.l-=4,r.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(n=t.read_shift(4),n!==1907505652)||(r.UnicodeClipboardFormat=b4(t),n=t.read_shift(4),n==0||n>40))return r;t.l-=4,r.Reserved2=t.read_shift(0,"lpwstr")}var i5=[60,1084,2066,2165,2175];function o5(e,r,t,n,a){var s=n,o=[],c=t.slice(t.l,t.l+s);if(a&&a.enc&&a.enc.insitu&&c.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(c)}o.push(c),t.l+=s;for(var l=Jn(t,t.l),u=hu[l],d=0;u!=null&&i5.indexOf(l)>-1;)s=Jn(t,t.l+2),d=t.l+4,l==2066?d+=4:(l==2165||l==2175)&&(d+=12),c=t.slice(d,t.l+4+s),o.push(c),t.l+=4+s,u=hu[l=Jn(t,t.l)];var f=fa(o);cr(f,0);var h=0;f.lens=[];for(var x=0;x<o.length;++x)f.lens.push(h),h+=o[x].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return r.f(f,f.length,a)}function Fn(e,r,t){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,r.cellNF&&(e.z=nt[n])}catch(s){if(r.WTF)throw s}if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||ws[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Yi(e.v):e.w=is(e.v):e.w=cn(n,e.v,{date1904:!!t,dateNF:r&&r.dateNF})}catch(s){if(r.WTF)throw s}if(r.cellDates&&n&&e.t=="n"&&ni(nt[n]||String(n))){var a=Wa(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function No(e,r,t){return{v:e,ixfe:r,t}}function c5(e,r){var t={opts:{}},n={},a=r.dense?[]:{},s={},o={},c=null,l=[],u="",d={},f,h="",x,m,p,g,w={},y=[],v,T,F=[],A=[],S={Sheets:[],WBProps:{date1904:!1},Views:[{}]},E={},b=function(Ie){return Ie<8?Ya[Ie]:Ie<64&&A[Ie-8]||Ya[Ie]},k=function(Ie,We,qe){var tt=We.XF.data;if(!(!tt||!tt.patternType||!qe||!qe.cellStyles)){We.s={},We.s.patternType=tt.patternType;var ut;(ut=Ji(b(tt.icvFore)))&&(We.s.fgColor={rgb:ut}),(ut=Ji(b(tt.icvBack)))&&(We.s.bgColor={rgb:ut})}},j=function(Ie,We,qe){if(!(J>1)&&!(qe.sheetRows&&Ie.r>=qe.sheetRows)){if(qe.cellStyles&&We.XF&&We.XF.data&&k(Ie,We,qe),delete We.ixfe,delete We.XF,f=Ie,h=et(Ie),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Ie.r<o.s.r&&(o.s.r=Ie.r),Ie.c<o.s.c&&(o.s.c=Ie.c),Ie.r+1>o.e.r&&(o.e.r=Ie.r+1),Ie.c+1>o.e.c&&(o.e.c=Ie.c+1),qe.cellFormula&&We.f){for(var tt=0;tt<y.length;++tt)if(!(y[tt][0].s.c>Ie.c||y[tt][0].s.r>Ie.r)&&!(y[tt][0].e.c<Ie.c||y[tt][0].e.r<Ie.r)){We.F=lt(y[tt][0]),(y[tt][0].s.c!=Ie.c||y[tt][0].s.r!=Ie.r)&&delete We.f,We.f&&(We.f=""+mr(y[tt][1],o,Ie,R,_));break}}qe.dense?(a[Ie.r]||(a[Ie.r]=[]),a[Ie.r][Ie.c]=We):a[h]=We}},_={enc:!1,sbcch:0,snames:[],sharedf:w,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(_.password=r.password);var B,Q=[],Z=[],L=[],q=[],te=!1,R=[];R.SheetNames=_.snames,R.sharedf=_.sharedf,R.arrayf=_.arrayf,R.names=[],R.XTI=[];var oe=0,J=0,P=0,V=[],z=[],G;_.codepage=1200,bn(1200);for(var ne=!1;e.l<e.length-1;){var he=e.l,se=e.read_shift(2);if(se===0&&oe===10)break;var ae=e.l===e.length?0:e.read_shift(2),K=hu[se];if(K&&K.f){if(r.bookSheets&&oe===133&&se!==133)break;if(oe=se,K.r===2||K.r==12){var O=e.read_shift(2);if(ae-=2,!_.enc&&O!==se&&((O&255)<<8|O>>8)!==se)throw new Error("rt mismatch: "+O+"!="+se);K.r==12&&(e.l+=10,ae-=10)}var D={};if(se===10?D=K.f(e,ae,_):D=o5(se,K,e,ae,_),J==0&&[9,521,1033,2057].indexOf(oe)===-1)continue;switch(se){case 34:t.opts.Date1904=S.WBProps.date1904=D;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(_.enc||(e.l=0),_.enc=D,!r.password)throw new Error("File is password-protected");if(D.valid==null)throw new Error("Encryption scheme unsupported");if(!D.valid)throw new Error("Password is incorrect");break;case 92:_.lastuser=D;break;case 66:var re=Number(D);switch(re){case 21010:re=1200;break;case 32768:re=1e4;break;case 32769:re=1252;break}bn(_.codepage=re),ne=!0;break;case 317:_.rrtabid=D;break;case 25:_.winlocked=D;break;case 439:t.opts.RefreshAll=D;break;case 12:t.opts.CalcCount=D;break;case 16:t.opts.CalcDelta=D;break;case 17:t.opts.CalcIter=D;break;case 13:t.opts.CalcMode=D;break;case 14:t.opts.CalcPrecision=D;break;case 95:t.opts.CalcSaveRecalc=D;break;case 15:_.CalcRefMode=D;break;case 2211:t.opts.FullCalc=D;break;case 129:D.fDialog&&(a["!type"]="dialog"),D.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),D.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:F.push(D);break;case 430:R.push([D]),R[R.length-1].XTI=[];break;case 35:case 547:R[R.length-1].push(D);break;case 24:case 536:G={Name:D.Name,Ref:mr(D.rgce,o,null,R,_)},D.itab>0&&(G.Sheet=D.itab-1),R.names.push(G),R[0]||(R[0]=[],R[0].XTI=[]),R[R.length-1].push(D),D.Name=="_xlnm._FilterDatabase"&&D.itab>0&&D.rgce&&D.rgce[0]&&D.rgce[0][0]&&D.rgce[0][0][0]=="PtgArea3d"&&(z[D.itab-1]={ref:lt(D.rgce[0][0][1][2])});break;case 22:_.ExternCount=D;break;case 23:R.length==0&&(R[0]=[],R[0].XTI=[]),R[R.length-1].XTI=R[R.length-1].XTI.concat(D),R.XTI=R.XTI.concat(D);break;case 2196:if(_.biff<8)break;G!=null&&(G.Comment=D[1]);break;case 18:a["!protect"]=D;break;case 19:D!==0&&_.WTF&&console.error("Password verifier: "+D);break;case 133:s[D.pos]=D,_.snames.push(D.name);break;case 10:{if(--J)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,a["!ref"]=lt(o),r.sheetRows&&r.sheetRows<=o.e.r){var le=o.e.r;o.e.r=r.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=lt(o),o.e.r=le}o.e.r++,o.e.c++}Q.length>0&&(a["!merges"]=Q),Z.length>0&&(a["!objects"]=Z),L.length>0&&(a["!cols"]=L),q.length>0&&(a["!rows"]=q),S.Sheets.push(E)}u===""?d=a:n[u]=a,a=r.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(_.biff===8&&(_.biff={9:2,521:3,1033:4}[se]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[D.BIFFVer]||8),_.biffguess=D.BIFFVer==0,D.BIFFVer==0&&D.dt==4096&&(_.biff=5,ne=!0,bn(_.codepage=28591)),_.biff==8&&D.BIFFVer==0&&D.dt==16&&(_.biff=2),J++)break;if(a=r.dense?[]:{},_.biff<8&&!ne&&(ne=!0,bn(_.codepage=r.codepage||1252)),_.biff<5||D.BIFFVer==0&&D.dt==4096){u===""&&(u="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var Te={pos:e.l-ae,name:u};s[Te.pos]=Te,_.snames.push(u)}else u=(s[he]||{name:""}).name;D.dt==32&&(a["!type"]="chart"),D.dt==64&&(a["!type"]="macro"),Q=[],Z=[],_.arrayf=y=[],L=[],q=[],te=!1,E={Hidden:(s[he]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(r.dense?(a[D.r]||[])[D.c]:a[et({c:D.c,r:D.r})])&&++D.c,v={ixfe:D.ixfe,XF:F[D.ixfe]||{},v:D.val,t:"n"},P>0&&(v.z=V[v.ixfe>>8&63]),Fn(v,r,t.opts.Date1904),j({c:D.c,r:D.r},v,r);break;case 5:case 517:v={ixfe:D.ixfe,XF:F[D.ixfe],v:D.val,t:D.t},P>0&&(v.z=V[v.ixfe>>8&63]),Fn(v,r,t.opts.Date1904),j({c:D.c,r:D.r},v,r);break;case 638:v={ixfe:D.ixfe,XF:F[D.ixfe],v:D.rknum,t:"n"},P>0&&(v.z=V[v.ixfe>>8&63]),Fn(v,r,t.opts.Date1904),j({c:D.c,r:D.r},v,r);break;case 189:for(var ue=D.c;ue<=D.C;++ue){var we=D.rkrec[ue-D.c][0];v={ixfe:we,XF:F[we],v:D.rkrec[ue-D.c][1],t:"n"},P>0&&(v.z=V[v.ixfe>>8&63]),Fn(v,r,t.opts.Date1904),j({c:ue,r:D.r},v,r)}break;case 6:case 518:case 1030:{if(D.val=="String"){c=D;break}if(v=No(D.val,D.cell.ixfe,D.tt),v.XF=F[v.ixfe],r.cellFormula){var xe=D.formula;if(xe&&xe[0]&&xe[0][0]&&xe[0][0][0]=="PtgExp"){var Ce=xe[0][0][1][0],Oe=xe[0][0][1][1],ze=et({r:Ce,c:Oe});w[ze]?v.f=""+mr(D.formula,o,D.cell,R,_):v.F=((r.dense?(a[Ce]||[])[Oe]:a[ze])||{}).F}else v.f=""+mr(D.formula,o,D.cell,R,_)}P>0&&(v.z=V[v.ixfe>>8&63]),Fn(v,r,t.opts.Date1904),j(D.cell,v,r),c=D}break;case 7:case 519:if(c)c.val=D,v=No(D,c.cell.ixfe,"s"),v.XF=F[v.ixfe],r.cellFormula&&(v.f=""+mr(c.formula,o,c.cell,R,_)),P>0&&(v.z=V[v.ixfe>>8&63]),Fn(v,r,t.opts.Date1904),j(c.cell,v,r),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(D);var M=et(D[0].s);if(x=r.dense?(a[D[0].s.r]||[])[D[0].s.c]:a[M],r.cellFormula&&x){if(!c||!M||!x)break;x.f=""+mr(D[1],o,D[0],R,_),x.F=lt(D[0])}}break;case 1212:{if(!r.cellFormula)break;if(h){if(!c)break;w[et(c.cell)]=D[0],x=r.dense?(a[c.cell.r]||[])[c.cell.c]:a[et(c.cell)],(x||{}).f=""+mr(D[0],o,f,R,_)}}break;case 253:v=No(l[D.isst].t,D.ixfe,"s"),l[D.isst].h&&(v.h=l[D.isst].h),v.XF=F[v.ixfe],P>0&&(v.z=V[v.ixfe>>8&63]),Fn(v,r,t.opts.Date1904),j({c:D.c,r:D.r},v,r);break;case 513:r.sheetStubs&&(v={ixfe:D.ixfe,XF:F[D.ixfe],t:"z"},P>0&&(v.z=V[v.ixfe>>8&63]),Fn(v,r,t.opts.Date1904),j({c:D.c,r:D.r},v,r));break;case 190:if(r.sheetStubs)for(var ce=D.c;ce<=D.C;++ce){var de=D.ixfe[ce-D.c];v={ixfe:de,XF:F[de],t:"z"},P>0&&(v.z=V[v.ixfe>>8&63]),Fn(v,r,t.opts.Date1904),j({c:ce,r:D.r},v,r)}break;case 214:case 516:case 4:v=No(D.val,D.ixfe,"s"),v.XF=F[v.ixfe],P>0&&(v.z=V[v.ixfe>>8&63]),Fn(v,r,t.opts.Date1904),j({c:D.c,r:D.r},v,r);break;case 0:case 512:J===1&&(o=D);break;case 252:l=D;break;case 1054:if(_.biff==4){V[P++]=D[1];for(var Se=0;Se<P+163&&nt[Se]!=D[1];++Se);Se>=163&&Ga(D[1],P+163)}else Ga(D[1],D[0]);break;case 30:{V[P++]=D;for(var ke=0;ke<P+163&&nt[ke]!=D;++ke);ke>=163&&Ga(D,P+163)}break;case 229:Q=Q.concat(D);break;case 93:Z[D.cmo[0]]=_.lastobj=D;break;case 438:_.lastobj.TxO=D;break;case 127:_.lastobj.ImData=D;break;case 440:for(g=D[0].s.r;g<=D[0].e.r;++g)for(p=D[0].s.c;p<=D[0].e.c;++p)x=r.dense?(a[g]||[])[p]:a[et({c:p,r:g})],x&&(x.l=D[1]);break;case 2048:for(g=D[0].s.r;g<=D[0].e.r;++g)for(p=D[0].s.c;p<=D[0].e.c;++p)x=r.dense?(a[g]||[])[p]:a[et({c:p,r:g})],x&&x.l&&(x.l.Tooltip=D[1]);break;case 28:{if(_.biff<=5&&_.biff>=2)break;x=r.dense?(a[D[0].r]||[])[D[0].c]:a[et(D[0])];var Be=Z[D[2]];x||(r.dense?(a[D[0].r]||(a[D[0].r]=[]),x=a[D[0].r][D[0].c]={t:"z"}):x=a[et(D[0])]={t:"z"},o.e.r=Math.max(o.e.r,D[0].r),o.s.r=Math.min(o.s.r,D[0].r),o.e.c=Math.max(o.e.c,D[0].c),o.s.c=Math.min(o.s.c,D[0].c)),x.c||(x.c=[]),m={a:D[1],t:Be.TxO.t},x.c.push(m)}break;case 2173:F3(F[D.ixfe],D.ext);break;case 125:{if(!_.cellStyles)break;for(;D.e>=D.s;)L[D.e--]={width:D.w/256,level:D.level||0,hidden:!!(D.flags&1)},te||(te=!0,$d(D.w/256)),Js(L[D.e+1])}break;case 520:{var Ve={};D.level!=null&&(q[D.r]=Ve,Ve.level=D.level),D.hidden&&(q[D.r]=Ve,Ve.hidden=!0),D.hpt&&(q[D.r]=Ve,Ve.hpt=D.hpt,Ve.hpx=Qi(D.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Oi(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[se]]=D;break;case 161:a["!margins"]||Oi(a["!margins"]={}),a["!margins"].header=D.header,a["!margins"].footer=D.footer;break;case 574:D.RTL&&(S.Views[0].RTL=!0);break;case 146:A=D;break;case 2198:B=D;break;case 140:T=D;break;case 442:u?E.CodeName=D||E.name:S.WBProps.CodeName=D||"ThisWorkbook";break}}else K||console.error("Missing Info for XLS Record 0x"+se.toString(16)),e.l+=ae}return t.SheetNames=Un(s).sort(function(Fe,Ie){return Number(Fe)-Number(Ie)}).map(function(Fe){return s[Fe].name}),r.bookSheets||(t.Sheets=n),!t.SheetNames.length&&d["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=d)):t.Preamble=d,t.Sheets&&z.forEach(function(Fe,Ie){t.Sheets[t.SheetNames[Ie]]["!autofilter"]=Fe}),t.Strings=l,t.SSF=lr(nt),_.enc&&(t.Encryption=_.enc),B&&(t.Themes=B),t.Metadata={},T!==void 0&&(t.Metadata.Country=T),R.names.length>0&&(S.Names=R.names),t.Workbook=S,t}var np={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function l5(e,r,t){var n=ct.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=$h(n,k4,np.DSI);for(var s in a)r[s]=a[s]}catch(u){if(t.WTF)throw u}var o=ct.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var c=$h(o,C4,np.SI);for(var l in c)r[l]==null&&(r[l]=c[l])}catch(u){if(t.WTF)throw u}r.HeadingPairs&&r.TitlesOfParts&&(c1(r.HeadingPairs,r.TitlesOfParts,r,t),delete r.HeadingPairs,delete r.TitlesOfParts)}function z1(e,r){r||(r={}),zd(r),vg(),r.codepage&&Ed(r.codepage);var t,n;if(e.FullPaths){if(ct.find(e,"/encryption"))throw new Error("File is password-protected");t=ct.find(e,"!CompObj"),n=ct.find(e,"/Workbook")||ct.find(e,"/Book")}else{switch(r.type){case"base64":e=vn(Kr(e));break;case"binary":e=vn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}cr(e,0),n={content:e}}var a,s;if(t&&s5(t),r.bookProps&&!r.bookSheets)a={};else{var o=ot?"buffer":"array";if(n&&n.content)a=c5(n.content,r);else if((s=ct.find(e,"PerfectOffice_MAIN"))&&s.content)a=Ii.to_workbook(s.content,(r.type=o,r));else if((s=ct.find(e,"NativeContent_MAIN"))&&s.content)a=Ii.to_workbook(s.content,(r.type=o,r));else throw(s=ct.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&e.FullPaths&&ct.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=q3(e))}var c={};return e.FullPaths&&l5(e,c,r),a.Props=a.Custprops=c,r.bookFiles&&(a.cfb=e),a}var mc={0:{f:H6},1:{f:q6},2:{f:nL},3:{f:Q6},4:{f:K6},5:{f:rL},6:{f:iL},7:{f:eL},8:{f:dL},9:{f:uL},10:{f:cL},11:{f:lL},12:{f:X6},13:{f:aL},14:{f:Z6},15:{f:J6},16:{f:$1},17:{f:oL},18:{f:tL},19:{f:Od},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:LL},40:{},42:{},43:{f:c3},44:{f:o3},45:{f:l3},46:{f:d3},47:{f:u3},48:{},49:{f:f4},50:{},51:{f:I3},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:b1},62:{f:sL},63:{f:M3},64:{f:bL},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Sr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:vL},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Y6},148:{f:z6,p:16},151:{f:pL},152:{},153:{f:NL},154:{},155:{},156:{f:RL},157:{},158:{},159:{T:1,f:CN},160:{T:-1},161:{T:1,f:bs},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:fL},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:j3},336:{T:-1},337:{f:P3,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:cu},357:{},358:{},359:{},360:{T:1},361:{},362:{f:v1},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:mL},427:{f:xL},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:yL},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:G6},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:hL},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:cu},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:z3},633:{T:1},634:{T:-1},635:{T:1,f:H3},636:{T:-1},637:{f:p4},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:kL},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:wL},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},hu={6:{f:kl},10:{f:ia},12:{f:Yt},13:{f:Yt},14:{f:Mt},15:{f:Mt},16:{f:yr},17:{f:Mt},18:{f:Mt},19:{f:Yt},20:{f:Hh},21:{f:Hh},23:{f:v1},24:{f:Gh},25:{f:Mt},26:{},27:{},28:{f:VR},29:{},34:{f:Mt},35:{f:zh},38:{f:yr},39:{f:yr},40:{f:yr},41:{f:yr},42:{f:Mt},43:{f:Mt},47:{f:GN},49:{f:ER},51:{f:Yt},60:{},61:{f:bR},64:{f:Mt},65:{f:SR},66:{f:Yt},77:{},80:{},81:{},82:{},85:{f:Yt},89:{},90:{},91:{},92:{f:fR},93:{f:HR},94:{},95:{f:Mt},96:{},97:{},99:{f:Mt},125:{f:b1},128:{f:PR},129:{f:hR},130:{f:Yt},131:{f:Mt},132:{f:Mt},133:{f:pR},134:{},140:{f:KR},141:{f:Yt},144:{},146:{f:QR},151:{},152:{},153:{},154:{},155:{},156:{f:Yt},157:{},158:{},160:{f:nN},161:{f:eN},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:DR},190:{f:FR},193:{f:ia},197:{},198:{},199:{},200:{},201:{},202:{f:Mt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Yt},220:{},221:{f:Mt},222:{},224:{f:IR},225:{f:dR},226:{f:ia},227:{},229:{f:WR},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:mR},253:{f:TR},255:{f:xR},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:h1},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Mt},353:{f:ia},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:RR},431:{f:Mt},432:{},433:{},434:{},437:{},438:{f:YR},439:{f:Mt},440:{f:qR},441:{},442:{f:mo},443:{},444:{f:Yt},445:{},446:{},448:{f:ia},449:{f:vR,r:2},450:{f:ia},512:{f:Vh},513:{f:rN},515:{f:OR},516:{f:AR},517:{f:Wh},519:{f:aN},520:{f:gR},523:{},545:{f:Yh},549:{f:Uh},566:{},574:{f:wR},638:{f:_R},659:{},1048:{},1054:{f:kR},1084:{},1212:{f:BR},2048:{f:XR},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Po},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ia},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:ZR,r:12},2173:{f:D3,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Mt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:LR,r:12},2197:{},2198:{f:E3,r:12},2199:{},2200:{},2201:{},2202:{f:$R,r:12},2203:{f:ia},2204:{},2205:{},2206:{},2207:{},2211:{f:yR},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Yt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:tN},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:JR},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Vh},1:{},2:{f:cN},3:{f:oN},4:{f:iN},5:{f:Wh},7:{f:lN},8:{},9:{f:Po},11:{},22:{f:Yt},30:{f:CR},31:{},32:{},33:{f:Yh},36:{},37:{f:Uh},50:{f:uN},62:{},52:{},67:{},68:{f:Yt},69:{},86:{},126:{},127:{f:sN},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:dN},223:{},234:{},354:{},421:{},518:{f:kl},521:{f:Po},536:{f:Gh},547:{f:zh},561:{},579:{},1030:{f:kl},1033:{f:Po},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function hn(e,r,t,n){var a=r;if(!isNaN(a)){var s=n||(t||[]).length||0,o=e.next(4);o.write_shift(2,a),o.write_shift(2,s),s>0&&e1(t)&&e.push(t)}}function ap(e,r){var t=r||{},n=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),o=a.index,c=s&&s.index||e.length,l=RO(e.slice(o,c),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,f=0,h=0,x={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(o=0;o<l.length;++o){var p=l[o].trim(),g=p.slice(0,3).toLowerCase();if(g=="<tr"){if(++u,t.sheetRows&&t.sheetRows<=u){--u;break}d=0;continue}if(!(g!="<td"&&g!="<th")){var w=p.split(/<\/t[dh]>/i);for(c=0;c<w.length;++c){var y=w[c].trim();if(y.match(/<t[dh]/i)){for(var v=y,T=0;v.charAt(0)=="<"&&(T=v.indexOf(">"))>-1;)v=v.slice(T+1);for(var F=0;F<m.length;++F){var A=m[F];A.s.c==d&&A.s.r<u&&u<=A.e.r&&(d=A.e.c+1,F=-1)}var S=Je(y.slice(0,y.indexOf(">")));h=S.colspan?+S.colspan:1,((f=+S.rowspan)>1||h>1)&&m.push({s:{r:u,c:d},e:{r:u+(f||1)-1,c:d+h-1}});var E=S.t||S["data-t"]||"";if(!v.length){d+=h;continue}if(v=Ug(v),x.s.r>u&&(x.s.r=u),x.e.r<u&&(x.e.r=u),x.s.c>d&&(x.s.c=d),x.e.c<d&&(x.e.c=d),!v.length){d+=h;continue}var b={t:"s",v};t.raw||!v.trim().length||E=="s"||(v==="TRUE"?b={t:"b",v:!0}:v==="FALSE"?b={t:"b",v:!1}:isNaN(Tn(v))?isNaN(Ks(v).getDate())||(b={t:"d",v:ir(v)},t.cellDates||(b={t:"n",v:jr(b.v)}),b.z=t.dateNF||nt[14]):b={t:"n",v:Tn(v)}),t.dense?(n[u]||(n[u]=[]),n[u][d]=b):n[et({r:u,c:d})]=b,d+=h}}}}return n["!ref"]=lt(x),m.length&&(n["!merges"]=m),n}function u5(e,r,t,n){for(var a=e["!merges"]||[],s=[],o=r.s.c;o<=r.e.c;++o){for(var c=0,l=0,u=0;u<a.length;++u)if(!(a[u].s.r>t||a[u].s.c>o)&&!(a[u].e.r<t||a[u].e.c<o)){if(a[u].s.r<t||a[u].s.c<o){c=-1;break}c=a[u].e.r-a[u].s.r+1,l=a[u].e.c-a[u].s.c+1;break}if(!(c<0)){var d=et({r:t,c:o}),f=n.dense?(e[t]||[])[o]:e[d],h=f&&f.v!=null&&(f.h||Dd(f.w||(ta(f),f.w)||""))||"",x={};c>1&&(x.rowspan=c),l>1&&(x.colspan=l),n.editable?h='<span contenteditable="true">'+h+"</span>":f&&(x["data-t"]=f&&f.t||"z",f.v!=null&&(x["data-v"]=f.v),f.z!=null&&(x["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),x.id=(n.id||"sjs")+"-"+d,s.push(KO("td",h,x))}}var m="<tr>";return m+s.join("")+"</tr>"}var d5='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',f5="</body></html>";function h5(e,r){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return Ca(ap(t[0],r),r);var n=Yd();return t.forEach(function(a,s){qd(n,ap(a,r),"Sheet"+(s+1))}),n}function p5(e,r,t){var n=[];return n.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function m5(e,r){var t=r||{},n=t.header!=null?t.header:d5,a=t.footer!=null?t.footer:f5,s=[n],o=ai(e["!ref"]);t.dense=Array.isArray(e),s.push(p5(e,o,t));for(var c=o.s.r;c<=o.e.r;++c)s.push(u5(e,o,c,t));return s.push("</table>"+a),s.join("")}function G1(e,r,t){var n=t||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var o=typeof n.origin=="string"?Cr(n.origin):n.origin;a=o.r,s=o.c}var c=r.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,c.length),u={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var d=ai(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),a==-1&&(u.e.r=a=d.e.r+1)}var f=[],h=0,x=e["!rows"]||(e["!rows"]=[]),m=0,p=0,g=0,w=0,y=0,v=0;for(e["!cols"]||(e["!cols"]=[]);m<c.length&&p<l;++m){var T=c[m];if(sp(T)){if(n.display)continue;x[p]={hidden:!0}}var F=T.children;for(g=w=0;g<F.length;++g){var A=F[g];if(!(n.display&&sp(A))){var S=A.hasAttribute("data-v")?A.getAttribute("data-v"):A.hasAttribute("v")?A.getAttribute("v"):Ug(A.innerHTML),E=A.getAttribute("data-z")||A.getAttribute("z");for(h=0;h<f.length;++h){var b=f[h];b.s.c==w+s&&b.s.r<p+a&&p+a<=b.e.r&&(w=b.e.c+1-s,h=-1)}v=+A.getAttribute("colspan")||1,((y=+A.getAttribute("rowspan")||1)>1||v>1)&&f.push({s:{r:p+a,c:w+s},e:{r:p+a+(y||1)-1,c:w+s+(v||1)-1}});var k={t:"s",v:S},j=A.getAttribute("data-t")||A.getAttribute("t")||"";S!=null&&(S.length==0?k.t=j||"z":n.raw||S.trim().length==0||j=="s"||(S==="TRUE"?k={t:"b",v:!0}:S==="FALSE"?k={t:"b",v:!1}:isNaN(Tn(S))?isNaN(Ks(S).getDate())||(k={t:"d",v:ir(S)},n.cellDates||(k={t:"n",v:jr(k.v)}),k.z=n.dateNF||nt[14]):k={t:"n",v:Tn(S)})),k.z===void 0&&E!=null&&(k.z=E);var _="",B=A.getElementsByTagName("A");if(B&&B.length)for(var Q=0;Q<B.length&&!(B[Q].hasAttribute("href")&&(_=B[Q].getAttribute("href"),_.charAt(0)!="#"));++Q);_&&_.charAt(0)!="#"&&(k.l={Target:_}),n.dense?(e[p+a]||(e[p+a]=[]),e[p+a][w+s]=k):e[et({c:w+s,r:p+a})]=k,u.e.c<w+s&&(u.e.c=w+s),w+=v}}++p}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,p-1+a),e["!ref"]=lt(u),p>=l&&(e["!fullref"]=lt((u.e.r=c.length-m+p-1+a,u))),e}function Y1(e,r){var t=r||{},n=t.dense?[]:{};return G1(n,e,r)}function x5(e,r){return Ca(Y1(e,r),r)}function sp(e){var r="",t=g5(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function g5(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function y5(e){var r=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=dt(r.replace(/<[^>]*>/g,""));return[t]}var ip={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function q1(e,r){var t=r||{},n=Fd(e),a=[],s,o,c={name:""},l="",u=0,d,f,h={},x=[],m=t.dense?[]:{},p,g,w={value:""},y="",v=0,T=[],F=-1,A=-1,S={s:{r:1e6,c:1e7},e:{r:0,c:0}},E=0,b={},k=[],j={},_=0,B=0,Q=[],Z=1,L=1,q=[],te={Names:[]},R={},oe=["",""],J=[],P={},V="",z=0,G=!1,ne=!1,he=0;for(Xi.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=Xi.exec(n);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"工作表":p[1]==="/"?(S.e.c>=S.s.c&&S.e.r>=S.s.r?m["!ref"]=lt(S):m["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=S.e.r&&(m["!fullref"]=m["!ref"],S.e.r=t.sheetRows-1,m["!ref"]=lt(S)),k.length&&(m["!merges"]=k),Q.length&&(m["!rows"]=Q),d.name=d.名称||d.name,typeof JSON<"u"&&JSON.stringify(d),x.push(d.name),h[d.name]=m,ne=!1):p[0].charAt(p[0].length-2)!=="/"&&(d=Je(p[0],!1),F=A=-1,S.s.r=S.s.c=1e7,S.e.r=S.e.c=0,m=t.dense?[]:{},k=[],Q=[],ne=!0);break;case"table-row-group":p[1]==="/"?--E:++E;break;case"table-row":case"行":if(p[1]==="/"){F+=Z,Z=1;break}if(f=Je(p[0],!1),f.行号?F=f.行号-1:F==-1&&(F=0),Z=+f["number-rows-repeated"]||1,Z<10)for(he=0;he<Z;++he)E>0&&(Q[F+he]={level:E});A=-1;break;case"covered-table-cell":p[1]!=="/"&&++A,t.sheetStubs&&(t.dense?(m[F]||(m[F]=[]),m[F][A]={t:"z"}):m[et({r:F,c:A})]={t:"z"}),y="",T=[];break;case"table-cell":case"数据":if(p[0].charAt(p[0].length-2)==="/")++A,w=Je(p[0],!1),L=parseInt(w["number-columns-repeated"]||"1",10),g={t:"z",v:null},w.formula&&t.cellFormula!=!1&&(g.f=ep(dt(w.formula))),(w.数据类型||w["value-type"])=="string"&&(g.t="s",g.v=dt(w["string-value"]||""),t.dense?(m[F]||(m[F]=[]),m[F][A]=g):m[et({r:F,c:A})]=g),A+=L-1;else if(p[1]!=="/"){++A,y="",v=0,T=[],L=1;var se=Z?F+Z-1:F;if(A>S.e.c&&(S.e.c=A),A<S.s.c&&(S.s.c=A),F<S.s.r&&(S.s.r=F),se>S.e.r&&(S.e.r=se),w=Je(p[0],!1),J=[],P={},g={t:w.数据类型||w["value-type"],v:null},t.cellFormula)if(w.formula&&(w.formula=dt(w.formula)),w["number-matrix-columns-spanned"]&&w["number-matrix-rows-spanned"]&&(_=parseInt(w["number-matrix-rows-spanned"],10)||0,B=parseInt(w["number-matrix-columns-spanned"],10)||0,j={s:{r:F,c:A},e:{r:F+_-1,c:A+B-1}},g.F=lt(j),q.push([j,g.F])),w.formula)g.f=ep(w.formula);else for(he=0;he<q.length;++he)F>=q[he][0].s.r&&F<=q[he][0].e.r&&A>=q[he][0].s.c&&A<=q[he][0].e.c&&(g.F=q[he][1]);switch((w["number-columns-spanned"]||w["number-rows-spanned"])&&(_=parseInt(w["number-rows-spanned"],10)||0,B=parseInt(w["number-columns-spanned"],10)||0,j={s:{r:F,c:A},e:{r:F+_-1,c:A+B-1}},k.push(j)),w["number-columns-repeated"]&&(L=parseInt(w["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=Et(w["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(w.value);break;case"percentage":g.t="n",g.v=parseFloat(w.value);break;case"currency":g.t="n",g.v=parseFloat(w.value);break;case"date":g.t="d",g.v=ir(w["date-value"]),t.cellDates||(g.t="n",g.v=jr(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=IO(w["time-value"])/86400,t.cellDates&&(g.t="d",g.v=qc(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(w.数据数值);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",w["string-value"]!=null&&(y=dt(w["string-value"]),T=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(G=!1,g.t==="s"&&(g.v=y||"",T.length&&(g.R=T),G=v==0),R.Target&&(g.l=R),J.length>0&&(g.c=J,J=[]),y&&t.cellText!==!1&&(g.w=y),G&&(g.t="z",delete g.v),(!G||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=F))for(var ae=0;ae<Z;++ae){if(L=parseInt(w["number-columns-repeated"]||"1",10),t.dense)for(m[F+ae]||(m[F+ae]=[]),m[F+ae][A]=ae==0?g:lr(g);--L>0;)m[F+ae][A+L]=lr(g);else for(m[et({r:F+ae,c:A})]=g;--L>0;)m[et({r:F+ae,c:A+L})]=lr(g);S.e.c<=A&&(S.e.c=A)}L=parseInt(w["number-columns-repeated"]||"1",10),A+=L-1,L=0,g={},y="",T=[]}R={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s;P.t=y,T.length&&(P.R=T),P.a=V,J.push(P)}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);V="",z=0,y="",v=0,T=[];break;case"creator":p[1]==="/"?V=n.slice(z,p.index):z=p.index+p[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);y="",v=0,T=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(b[c.name]=l,(s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&(l="",c=Je(p[0],!1),a.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":o=Je(p[0],!1),l+=ip[p[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":o=Je(p[0],!1),l+=ip[p[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(u,p.index);break}else u=p.index+p[0].length;break;case"named-range":o=Je(p[0],!1),oe=Cl(o["cell-range-address"]);var K={Name:o.name,Ref:oe[0]+"!"+oe[1]};ne&&(K.Sheet=x.length),te.Names.push(K);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(p[1]==="/"&&(!w||!w["string-value"])){var O=y5(n.slice(v,p.index));y=(y.length>0?y+`
`:"")+O[0]}else Je(p[0],!1),v=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{oe=Cl(Je(p[0])["target-range-address"]),h[oe[0]]["!autofilter"]={ref:oe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(R=Je(p[0],!1),!R.href)break;R.Target=dt(R.href),delete R.href,R.Target.charAt(0)=="#"&&R.Target.indexOf(".")>-1?(oe=Cl(R.Target.slice(1)),R.Target="#"+oe[0]+"!"+oe[1]):R.Target.match(/^\.\.[\\\/]/)&&(R.Target=R.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(t.WTF)throw new Error(p)}}var D={Sheets:h,SheetNames:x,Workbook:te};return t.bookSheets&&delete D.Sheets,D}function op(e,r){r=r||{},nn(e,"META-INF/manifest.xml")&&O4(Gt(e,"META-INF/manifest.xml"),r);var t=qr(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var n=q1(yt(t),r);return nn(e,"meta.xml")&&(n.Props=o1(Gt(e,"meta.xml"))),n}function cp(e,r){return q1(e,r)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Wd(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function pu(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):yt(ys(e))}function mu(e){var r=e.reduce(function(a,s){return a+s.length},0),t=new Uint8Array(r),n=0;return e.forEach(function(a){t.set(a,n),n+=a.length}),t}function lp(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function v5(e,r){for(var t=(e[r+15]&127)<<7|e[r+14]>>1,n=e[r+14]&1,a=r+13;a>=r;--a)n=n*256+e[a];return(e[r+15]&128?-n:n)*Math.pow(10,t-6176)}function Zi(e,r){var t=r?r[0]:0,n=e[t]&127;e:if(e[t++]>=128&&(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return r&&(r[0]=t),n}function Zt(e){var r=0,t=e[r]&127;e:if(e[r++]>=128){if(t|=(e[r]&127)<<7,e[r++]<128||(t|=(e[r]&127)<<14,e[r++]<128)||(t|=(e[r]&127)<<21,e[r++]<128))break e;t|=(e[r]&127)<<28}return t}function vr(e){for(var r=[],t=[0];t[0]<e.length;){var n=t[0],a=Zi(e,t),s=a&7;a=Math.floor(a/8);var o=0,c;if(a==0)break;switch(s){case 0:{for(var l=t[0];e[t[0]++]>=128;);c=e.slice(l,t[0])}break;case 5:o=4,c=e.slice(t[0],t[0]+o),t[0]+=o;break;case 1:o=8,c=e.slice(t[0],t[0]+o),t[0]+=o;break;case 2:o=Zi(e,t),c=e.slice(t[0],t[0]+o),t[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var u={data:c,type:s};r[a]==null?r[a]=[u]:r[a].push(u)}return r}function Hd(e,r){return(e==null?void 0:e.map(function(t){return r(t.data)}))||[]}function b5(e){for(var r,t=[],n=[0];n[0]<e.length;){var a=Zi(e,n),s=vr(e.slice(n[0],n[0]+a));n[0]+=a;var o={id:Zt(s[1][0].data),messages:[]};s[2].forEach(function(c){var l=vr(c.data),u=Zt(l[3][0].data);o.messages.push({meta:l,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(r=s[3])!=null&&r[0]&&(o.merge=Zt(s[3][0].data)>>>0>0),t.push(o)}return t}function w5(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],n=Zi(r,t),a=[];t[0]<r.length;){var s=r[t[0]]&3;if(s==0){var o=r[t[0]++]>>2;if(o<60)++o;else{var c=o-59;o=r[t[0]],c>1&&(o|=r[t[0]+1]<<8),c>2&&(o|=r[t[0]+2]<<16),c>3&&(o|=r[t[0]+3]<<24),o>>>=0,o++,t[0]+=c}a.push(r.slice(t[0],t[0]+o)),t[0]+=o;continue}else{var l=0,u=0;if(s==1?(u=(r[t[0]]>>2&7)+4,l=(r[t[0]++]&224)<<3,l|=r[t[0]++]):(u=(r[t[0]++]>>2)+1,s==2?(l=r[t[0]]|r[t[0]+1]<<8,t[0]+=2):(l=(r[t[0]]|r[t[0]+1]<<8|r[t[0]+2]<<16|r[t[0]+3]<<24)>>>0,t[0]+=4)),a=[mu(a)],l==0)throw new Error("Invalid offset 0");if(l>a[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(a.push(a[0].slice(-l)),u-=l;u>=a[a.length-1].length;)a.push(a[a.length-1]),u-=a[a.length-1].length;a.push(a[0].slice(-l,-l+u))}}var d=mu(a);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function S5(e){for(var r=[],t=0;t<e.length;){var n=e[t++],a=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,r.push(w5(n,e.slice(t,t+a))),t+=a}if(t!==e.length)throw new Error("data is not a valid framed stream!");return mu(r)}function E5(e,r,t,n){var a=Wd(e),s=a.getUint32(4,!0),o=(n>1?12:8)+lp(s&(n>1?3470:398))*4,c=-1,l=-1,u=NaN,d=new Date(2001,0,1);s&512&&(c=a.getUint32(o,!0),o+=4),o+=lp(s&(n>1?12288:4096))*4,s&16&&(l=a.getUint32(o,!0),o+=4),s&32&&(u=a.getFloat64(o,!0),o+=8),s&64&&(d.setTime(d.getTime()+a.getFloat64(o,!0)*1e3),o+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:r[l]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(c>-1)f={t:"s",v:t[c]};else if(l>-1)f={t:"s",v:r[l]};else if(!isNaN(u))f={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function T5(e,r,t){var n=Wd(e),a=n.getUint32(8,!0),s=12,o=-1,c=-1,l=NaN,u=NaN,d=new Date(2001,0,1);a&1&&(l=v5(e,s),s+=16),a&2&&(u=n.getFloat64(s,!0),s+=8),a&4&&(d.setTime(d.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(c=n.getUint32(s,!0),s+=4),a&16&&(o=n.getUint32(s,!0),s+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:l};break;case 3:f={t:"s",v:r[c]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:t[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return f}function A5(e,r,t){switch(e[0]){case 0:case 1:case 2:case 3:return E5(e,r,t,e[0]);case 5:return T5(e,r,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function ga(e){var r=vr(e);return Zi(r[1][0].data)}function up(e,r){var t=vr(r.data),n=Zt(t[1][0].data),a=t[3],s=[];return(a||[]).forEach(function(o){var c=vr(o.data),l=Zt(c[1][0].data)>>>0;switch(n){case 1:s[l]=pu(c[3][0].data);break;case 8:{var u=e[ga(c[9][0].data)][0],d=vr(u.data),f=e[ga(d[1][0].data)][0],h=Zt(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var x=vr(f.data);s[l]=x[3].map(function(m){return pu(m.data)}).join("")}break}}),s}function k5(e,r){var t,n,a,s,o,c,l,u,d,f,h,x,m,p,g=vr(e),w=Zt(g[1][0].data)>>>0,y=Zt(g[2][0].data)>>>0,v=((n=(t=g[8])==null?void 0:t[0])==null?void 0:n.data)&&Zt(g[8][0].data)>0||!1,T,F;if((s=(a=g[7])==null?void 0:a[0])!=null&&s.data&&r!=0)T=(c=(o=g[7])==null?void 0:o[0])==null?void 0:c.data,F=(u=(l=g[6])==null?void 0:l[0])==null?void 0:u.data;else if((f=(d=g[4])==null?void 0:d[0])!=null&&f.data&&r!=1)T=(x=(h=g[4])==null?void 0:h[0])==null?void 0:x.data,F=(p=(m=g[3])==null?void 0:m[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var A=v?4:1,S=Wd(T),E=[],b=0;b<T.length/2;++b){var k=S.getUint16(b*2,!0);k<65535&&E.push([b,k])}if(E.length!=y)throw"Expected ".concat(y," cells, found ").concat(E.length);var j=[];for(b=0;b<E.length-1;++b)j[E[b][0]]=F.subarray(E[b][1]*A,E[b+1][1]*A);return E.length>=1&&(j[E[E.length-1][0]]=F.subarray(E[E.length-1][1]*A)),{R:w,cells:j}}function C5(e,r){var t,n=vr(r.data),a=(t=n==null?void 0:n[7])!=null&&t[0]?Zt(n[7][0].data)>>>0>0?1:0:-1,s=Hd(n[5],function(o){return k5(o,a)});return{nrows:Zt(n[4][0].data)>>>0,data:s.reduce(function(o,c){return o[c.R]||(o[c.R]=[]),c.cells.forEach(function(l,u){if(o[c.R][u])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(u));o[c.R][u]=l}),o},[])}}function _5(e,r,t){var n,a=vr(r.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Zt(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(Zt(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));t["!ref"]=lt(s);var o=vr(a[4][0].data),c=up(e,e[ga(o[4][0].data)][0]),l=(n=o[17])!=null&&n[0]?up(e,e[ga(o[17][0].data)][0]):[],u=vr(o[3][0].data),d=0;u[1].forEach(function(f){var h=vr(f.data),x=e[ga(h[2][0].data)][0],m=Zt(x.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var p=C5(e,x);p.data.forEach(function(g,w){g.forEach(function(y,v){var T=et({r:d+w,c:v}),F=A5(y,c,l);F&&(t[T]=F)})}),d+=p.nrows})}function D5(e,r){var t=vr(r.data),n={"!ref":"A1"},a=e[ga(t[2][0].data)],s=Zt(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return _5(e,a[0],n),n}function F5(e,r){var t,n=vr(r.data),a={name:(t=n[1])!=null&&t[0]?pu(n[1][0].data):"",sheets:[]},s=Hd(n[2],ga);return s.forEach(function(o){e[o].forEach(function(c){var l=Zt(c.meta[1][0].data);l==6e3&&a.sheets.push(D5(e,c))})}),a}function j5(e,r){var t=Yd(),n=vr(r.data),a=Hd(n[1],ga);if(a.forEach(function(s){e[s].forEach(function(o){var c=Zt(o.meta[1][0].data);if(c==2){var l=F5(e,o);l.sheets.forEach(function(u,d){qd(t,u,d==0?l.name:l.name+"_"+d,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function Dl(e){var r,t,n,a,s={},o=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var u;try{u=S5(l.content)}catch(f){return console.log("?? "+l.content.length+" "+(f.message||f))}var d;try{d=b5(u)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){s[f.id]=f.messages,o.push(f.id)})}}),!o.length)throw new Error("File has no messages");var c=((a=(n=(t=(r=s==null?void 0:s[1])==null?void 0:r[0])==null?void 0:t.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Zt(s[1][0].meta[1][0].data)==1&&s[1][0];if(c||o.forEach(function(l){s[l].forEach(function(u){var d=Zt(u.meta[1][0].data)>>>0;if(d==1)if(!c)c=u;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return j5(s,c)}function I5(e){return function(t){for(var n=0;n!=e.length;++n){var a=e[n];t[a[0]]===void 0&&(t[a[0]]=a[1]),a[2]==="n"&&(t[a[0]]=Number(t[a[0]]))}}}function zd(e){I5([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function P5(e){return Rs.WS.indexOf(e)>-1?"sheet":e==Rs.CS?"chart":e==Rs.DS?"dialog":e==Rs.MS?"macro":e&&e.length?e:"sheet"}function O5(e,r){if(!e)return 0;try{e=r.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,P5(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function R5(e,r,t,n,a,s,o,c,l,u,d,f){try{s[n]=Fi(qr(e,t,!0),r);var h=Gt(e,r),x;switch(c){case"sheet":x=UL(h,r,a,l,s[n],u,d,f);break;case"chart":if(x=VL(h,r,a,l,s[n],u,d,f),!x||!x["!drawel"])break;var m=Ei(x["!drawel"].Target,r),p=lu(m),g=$3(qr(e,m,!0),Fi(qr(e,p,!0),m)),w=Ei(g,m),y=lu(w);x=TL(qr(e,w,!0),w,l,Fi(qr(e,y,!0),w),u,x);break;case"macro":x=WL(h,r,a,l,s[n],u,d,f);break;case"dialog":x=HL(h,r,a,l,s[n],u,d,f);break;default:throw new Error("Unrecognized sheet type "+c)}o[n]=x;var v=[];s&&s[n]&&Un(s[n]).forEach(function(T){var F="";if(s[n][T].Type==Rs.CMNT){F=Ei(s[n][T].Target,r);var A=qL(Gt(e,F,!0),F,l);if(!A||!A.length)return;Xh(x,A,!1)}s[n][T].Type==Rs.TCMNT&&(F=Ei(s[n][T].Target,r),v=v.concat(V3(Gt(e,F,!0),l)))}),v&&v.length&&Xh(x,v,!0,l.people||[])}catch(T){if(l.WTF)throw T}}function Zr(e){return e.charAt(0)=="/"?e.slice(1):e}function N5(e,r){if(jg(),r=r||{},zd(r),nn(e,"META-INF/manifest.xml")||nn(e,"objectdata.xml"))return op(e,r);if(nn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Dl<"u"){if(e.FileIndex)return Dl(e);var t=ct.utils.cfb_new();return Sh(e).forEach(function(Q){MO(t,Q,Mg(e,Q))}),Dl(t)}throw new Error("Unsupported NUMBERS file")}if(!nn(e,"[Content_Types].xml"))throw nn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):nn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Sh(e),a=I4(qr(e,"[Content_Types].xml")),s=!1,o,c;if(a.workbooks.length===0&&(c="xl/workbook.xml",Gt(e,c,!0)&&a.workbooks.push(c)),a.workbooks.length===0){if(c="xl/workbook.bin",!Gt(e,c,!0))throw new Error("Could not find workbook");a.workbooks.push(c),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},u={};if(!r.bookSheets&&!r.bookProps){if(Pi=[],a.sst)try{Pi=YL(Gt(e,Zr(a.sst)),a.sst,r)}catch(Q){if(r.WTF)throw Q}r.cellStyles&&a.themes.length&&(l=GL(qr(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],r)),a.style&&(u=zL(Gt(e,Zr(a.style)),a.style,l,r))}a.links.map(function(Q){try{var Z=Fi(qr(e,lu(Zr(Q))),Q);return KL(Gt(e,Zr(Q)),Z,Q,r)}catch{}});var d=$L(Gt(e,Zr(a.workbooks[0])),a.workbooks[0],r),f={},h="";a.coreprops.length&&(h=Gt(e,Zr(a.coreprops[0]),!0),h&&(f=o1(h)),a.extprops.length!==0&&(h=Gt(e,Zr(a.extprops[0]),!0),h&&M4(h,f,r)));var x={};(!r.bookSheets||r.bookProps)&&a.custprops.length!==0&&(h=qr(e,Zr(a.custprops[0]),!0),h&&(x=B4(h,r)));var m={};if((r.bookSheets||r.bookProps)&&(d.Sheets?o=d.Sheets.map(function(Z){return Z.name}):f.Worksheets&&f.SheetNames.length>0&&(o=f.SheetNames),r.bookProps&&(m.Props=f,m.Custprops=x),r.bookSheets&&typeof o<"u"&&(m.SheetNames=o),r.bookSheets?m.SheetNames:r.bookProps))return m;o={};var p={};r.bookDeps&&a.calcchain&&(p=XL(Gt(e,Zr(a.calcchain)),a.calcchain));var g=0,w={},y,v;{var T=d.Sheets;f.Worksheets=T.length,f.SheetNames=[];for(var F=0;F!=T.length;++F)f.SheetNames[F]=T[F].name}var A=s?"bin":"xml",S=a.workbooks[0].lastIndexOf("/"),E=(a.workbooks[0].slice(0,S+1)+"_rels/"+a.workbooks[0].slice(S+1)+".rels").replace(/^\//,"");nn(e,E)||(E="xl/_rels/workbook."+A+".rels");var b=Fi(qr(e,E,!0),E.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(r.xlmeta=JL(Gt(e,Zr(a.metadata[0])),a.metadata[0],r)),(a.people||[]).length>=1&&(r.people=W3(Gt(e,Zr(a.people[0])),r)),b&&(b=O5(b,d.Sheets));var k=Gt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=f.Worksheets;++g){var j="sheet";if(b&&b[g]?(y="xl/"+b[g][1].replace(/[\/]?xl\//,""),nn(e,y)||(y=b[g][1]),nn(e,y)||(y=E.replace(/_rels\/.*$/,"")+b[g][1]),j=b[g][2]):(y="xl/worksheets/sheet"+(g+1-k)+"."+A,y=y.replace(/sheet0\./,"sheet.")),v=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(g!=r.sheets)continue e;break;case"string":if(f.SheetNames[g].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var _=!1,B=0;B!=r.sheets.length;++B)typeof r.sheets[B]=="number"&&r.sheets[B]==g&&(_=1),typeof r.sheets[B]=="string"&&r.sheets[B].toLowerCase()==f.SheetNames[g].toLowerCase()&&(_=1);if(!_)continue e}}R5(e,y,v,f.SheetNames[g],g,w,o,j,r,d,l,u)}return m={Directory:a,Workbook:d,Props:f,Custprops:x,Deps:p,Sheets:o,SheetNames:f.SheetNames,Strings:Pi,Styles:u,Themes:l,SSF:lr(nt)},r&&r.bookFiles&&(e.files?(m.keys=n,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach(function(Q,Z){Q=Q.replace(/^Root Entry[\/]/,""),m.keys.push(Q),m.files[Q]=e.FileIndex[Z]}))),r&&r.bookVBA&&(a.vba.length>0?m.vbaraw=Gt(e,Zr(a.vba[0]),!0):a.defaults&&a.defaults.bin===Y3&&(m.vbaraw=Gt(e,"xl/vbaProject.bin",!0))),m}function M5(e,r){var t=r||{},n="Workbook",a=ct.find(e,n);try{if(n="/!DataSpaces/Version",a=ct.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(DN(a.content),n="/!DataSpaces/DataSpaceMap",a=ct.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=jN(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=ct.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=IN(a.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=ct.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);ON(a.content)}catch{}if(n="/EncryptionInfo",a=ct.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var c=RN(a.content);if(n="/EncryptedPackage",a=ct.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],a.content,t.password||"",t);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],a.content,t.password||"",t);throw new Error("File is password-protected")}function Gd(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=Kr(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function L5(e,r){return ct.find(e,"EncryptedPackage")?M5(e,r):z1(e,r)}function B5(e,r){var t,n=e,a=r||{};return a.type||(a.type=ot&&Buffer.isBuffer(e)?"buffer":"base64"),t=Lg(n,a),N5(t,a)}function X1(e,r){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return fu(e.slice(t),r);default:break e}return Ki.to_workbook(e,r)}function $5(e,r){var t="",n=Gd(e,r);switch(r.type){case"base64":t=Kr(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=os(e);break;default:throw new Error("Unrecognized type "+r.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(t=yt(t)),r.type="binary",X1(t,r)}function U5(e,r){var t=e;return r.type=="base64"&&(t=Kr(t)),t=da.utils.decode(1200,t.slice(2),"str"),r.type="binary",X1(t,r)}function V5(e){return e.match(/[^\x00-\x7F]/)?Ti(e):e}function Fl(e,r,t,n){return n?(t.type="string",Ki.to_workbook(e,t)):Ki.to_workbook(r,t)}function xc(e,r){vg();var t=r||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return xc(new Uint8Array(e),(t=lr(t),t.type="array",t));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],s=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),Vs={},t.dateNF&&(Vs.dateNF=t.dateNF),t.type||(t.type=ot&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=ot?"buffer":"binary",n=FO(e),typeof Uint8Array<"u"&&!ot&&(t.type="array")),t.type=="string"&&(s=!0,t.type="binary",t.codepage=65001,n=V5(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),c=new Uint8Array(o);if(c.foo="bar",!c.foo)return t=lr(t),t.type="array",xc(Td(n),t)}switch((a=Gd(n,t))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return L5(ct.read(n,t),t);break;case 9:if(a[1]<=8)return z1(n,t);break;case 60:return fu(n,t);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return xN(n,t);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return pN.to_workbook(n,t);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?B5(n,t):Fl(e,n,t,s);case 239:return a[3]===60?fu(n,t):Fl(e,n,t,s);case 255:if(a[1]===254)return U5(n,t);if(a[1]===0&&a[2]===2&&a[3]===0)return Ii.to_workbook(n,t);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Ii.to_workbook(n,t);break;case 3:case 131:case 139:case 140:return qh.to_workbook(n,t);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return YN.to_workbook(n,t);break;case 10:case 13:case 32:return $5(n,t);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return fN.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?qh.to_workbook(n,t):Fl(e,n,t,s)}function W5(e,r,t,n,a,s,o,c){var l=ur(t),u=c.defval,d=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),f=!0,h=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:t,enumerable:!1})}catch{h.__rowNum__=t}else h.__rowNum__=t;if(!o||e[t])for(var x=r.s.c;x<=r.e.c;++x){var m=o?e[t][x]:e[n[x]+l];if(m===void 0||m.t===void 0){if(u===void 0)continue;s[x]!=null&&(h[s[x]]=u);continue}var p=m.v;switch(m.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(s[x]!=null){if(p==null)if(m.t=="e"&&p===null)h[s[x]]=null;else if(u!==void 0)h[s[x]]=u;else if(d&&p===null)h[s[x]]=null;else continue;else h[s[x]]=d&&(m.t!=="n"||m.t==="n"&&c.rawNumbers!==!1)?p:ta(m,p,c);p!=null&&(f=!1)}}return{row:h,isempty:f}}function xu(e,r){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},n=0,a=1,s=[],o=0,c="",l={s:{r:0,c:0},e:{r:0,c:0}},u=r||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":l=Ot(d);break;case"number":l=Ot(e["!ref"]),l.s.r=d;break;default:l=d}n>0&&(a=0);var f=ur(l.s.r),h=[],x=[],m=0,p=0,g=Array.isArray(e),w=l.s.r,y=0,v={};g&&!e[w]&&(e[w]=[]);var T=u.skipHidden&&e["!cols"]||[],F=u.skipHidden&&e["!rows"]||[];for(y=l.s.c;y<=l.e.c;++y)if(!(T[y]||{}).hidden)switch(h[y]=Jt(y),t=g?e[w][y]:e[h[y]+f],n){case 1:s[y]=y-l.s.c;break;case 2:s[y]=h[y];break;case 3:s[y]=u.header[y-l.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),c=o=ta(t,null,u),p=v[o]||0,!p)v[o]=1;else{do c=o+"_"+p++;while(v[c]);v[o]=p,v[c]=1}s[y]=c}for(w=l.s.r+a;w<=l.e.r;++w)if(!(F[w]||{}).hidden){var A=W5(e,l,w,h,n,s,g,u);(A.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(x[m++]=A.row)}return x.length=m,x}var dp=/"/g;function H5(e,r,t,n,a,s,o,c){for(var l=!0,u=[],d="",f=ur(t),h=r.s.c;h<=r.e.c;++h)if(n[h]){var x=c.dense?(e[t]||[])[h]:e[n[h]+f];if(x==null)d="";else if(x.v!=null){l=!1,d=""+(c.rawNumbers&&x.t=="n"?x.v:ta(x,null,c));for(var m=0,p=0;m!==d.length;++m)if((p=d.charCodeAt(m))===a||p===s||p===34||c.forceQuotes){d='"'+d.replace(dp,'""')+'"';break}d=="ID"&&(d='"ID"')}else x.f!=null&&!x.F?(l=!1,d="="+x.f,d.indexOf(",")>=0&&(d='"'+d.replace(dp,'""')+'"')):d="";u.push(d)}return c.blankrows===!1&&l?null:u.join(o)}function K1(e,r){var t=[],n=r??{};if(e==null||e["!ref"]==null)return"";var a=Ot(e["!ref"]),s=n.FS!==void 0?n.FS:",",o=s.charCodeAt(0),c=n.RS!==void 0?n.RS:`
`,l=c.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),d="",f=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],x=n.skipHidden&&e["!rows"]||[],m=a.s.c;m<=a.e.c;++m)(h[m]||{}).hidden||(f[m]=Jt(m));for(var p=0,g=a.s.r;g<=a.e.r;++g)(x[g]||{}).hidden||(d=H5(e,a,g,f,o,l,s,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&t.push((p++?c:"")+d)));return delete n.dense,t.join("")}function z5(e,r){r||(r={}),r.FS="	",r.RS=`
`;var t=K1(e,r);return t}function G5(e){var r="",t,n="";if(e==null||e["!ref"]==null)return[];var a=Ot(e["!ref"]),s="",o=[],c,l=[],u=Array.isArray(e);for(c=a.s.c;c<=a.e.c;++c)o[c]=Jt(c);for(var d=a.s.r;d<=a.e.r;++d)for(s=ur(d),c=a.s.c;c<=a.e.c;++c)if(r=o[c]+s,t=u?(e[d]||[])[c]:e[r],n="",t!==void 0){if(t.F!=null){if(r=t.F,!t.f)continue;n=t.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(t.f!=null)n=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)n=""+t.v;else if(t.t=="b")n=t.v?"TRUE":"FALSE";else if(t.w!==void 0)n="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?n="'"+t.v:n=""+t.v}}l[l.length]=r+"="+n}return l}function J1(e,r,t){var n=t||{},a=+!n.skipHeader,s=e||{},o=0,c=0;if(s&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var l=typeof n.origin=="string"?Cr(n.origin):n.origin;o=l.r,c=l.c}var u,d={s:{c:0,r:0},e:{c,r:o+r.length-1+a}};if(s["!ref"]){var f=Ot(s["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),o==-1&&(o=f.e.r+1,d.e.r=o+r.length-1+a)}else o==-1&&(o=0,d.e.r=r.length-1+a);var h=n.header||[],x=0;r.forEach(function(p,g){Un(p).forEach(function(w){(x=h.indexOf(w))==-1&&(h[x=h.length]=w);var y=p[w],v="z",T="",F=et({c:c+x,r:o+g+a});u=eo(s,F),y&&typeof y=="object"&&!(y instanceof Date)?s[F]=y:(typeof y=="number"?v="n":typeof y=="boolean"?v="b":typeof y=="string"?v="s":y instanceof Date?(v="d",n.cellDates||(v="n",y=jr(y)),T=n.dateNF||nt[14]):y===null&&n.nullError&&(v="e",y=0),u?(u.t=v,u.v=y,delete u.w,delete u.R,T&&(u.z=T)):s[F]=u={t:v,v:y},T&&(u.z=T))})}),d.e.c=Math.max(d.e.c,c+h.length-1);var m=ur(o);if(a)for(x=0;x<h.length;++x)s[Jt(x+c)+m]={t:"s",v:h[x]};return s["!ref"]=lt(d),s}function Y5(e,r){return J1(null,e,r)}function eo(e,r,t){if(typeof r=="string"){if(Array.isArray(e)){var n=Cr(r);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?eo(e,et(r)):eo(e,et({r,c:t||0}))}function q5(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function Yd(){return{SheetNames:[],Sheets:{}}}function qd(e,r,t,n){var a=1;if(!t)for(;a<=65535&&e.SheetNames.indexOf(t="Sheet"+a)!=-1;++a,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(t)>=0){var s=t.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var o=s&&s[1]||t;for(++a;a<=65535&&e.SheetNames.indexOf(t=o+a)!=-1;++a);}if(IL(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function X5(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=q5(e,r);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[n].Hidden=t}function K5(e,r){return e.z=r,e}function Q1(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}function J5(e,r,t){return Q1(e,"#"+r,t)}function Q5(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})}function Z5(e,r,t,n){for(var a=typeof r!="string"?r:Ot(r),s=typeof r=="string"?r:lt(r),o=a.s.r;o<=a.e.r;++o)for(var c=a.s.c;c<=a.e.c;++c){var l=eo(e,o,c);l.t="n",l.F=s,delete l.v,o==a.s.r&&c==a.s.c&&(l.f=t,n&&(l.D=!0))}return e}var Z1={encode_col:Jt,encode_row:ur,encode_cell:et,encode_range:lt,decode_col:Pd,decode_row:Id,split_cell:d4,decode_cell:Cr,decode_range:ai,format_cell:ta,sheet_add_aoa:r1,sheet_add_json:J1,sheet_add_dom:G1,aoa_to_sheet:si,json_to_sheet:Y5,table_to_sheet:Y1,table_to_book:x5,sheet_to_csv:K1,sheet_to_txt:z5,sheet_to_json:xu,sheet_to_html:m5,sheet_to_formulae:G5,sheet_to_row_object_array:xu,sheet_get_cell:eo,book_new:Yd,book_append_sheet:qd,book_set_sheet_visibility:X5,cell_set_number_format:K5,cell_set_hyperlink:Q1,cell_set_internal_link:J5,cell_add_comment:Q5,sheet_set_array_formula:Z5,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const e8=["studentId","name","email","grade","phoneNumber"],t8=`studentId,name,grade,section,email,phoneNumber,dateOfBirth,gender,address,parentName,parentEmail,parentPhone
S001,John Smith,9,A,john.smith@example.com,1234567890,2010-05-15,MALE,123 Main St,Robert Smith,robert.smith@example.com,9876543210
S002,Jane Doe,9,A,jane.doe@example.com,0987654321,2010-03-20,FEMALE,456 Oak Ave,Mary Doe,mary.doe@example.com,1234567890`,r8=({open:e,onClose:r,onSubmit:t,loading:n})=>{const[a,s]=C.useState(""),[o,c]=C.useState([]),[l,u]=C.useState([]),[d,f]=C.useState("initial"),[h,x]=C.useState(""),m=C.useRef(null),p=A=>{s(A.target.value),f("initial"),c([]),u([]),x("")},g=(A,S)=>{const E=[];return e8.forEach(b=>{A[b]||E.push({index:S,field:b,message:`Missing required field: ${b}`})}),A.email&&!/^\S+@\S+\.\S+$/.test(A.email)&&E.push({index:S,field:"email",message:"Invalid email format"}),E},w=()=>{try{const A=gg.parse(a,{header:!0,skipEmptyLines:!0});if(A.errors.length>0){u(A.errors.map((b,k)=>({index:k,field:"csv",message:b.message}))),f("error");return}const S=A.data,E=[];S.forEach((b,k)=>{const j=g(b,k);E.push(...j)}),E.length>0?(u(E),f("error")):(c(S),f("success"))}catch(A){console.error("Error parsing CSV:",A),u([{index:0,field:"csv",message:"Failed to parse CSV: "+(A instanceof Error?A.message:String(A))}]),f("error")}},y=async()=>{if(!(o.length===0||d!=="success"))try{await t(o),s(""),c([]),f("initial"),x("")}catch(A){console.error("Failed to submit students:",A)}},v=()=>{const A=new Blob([t8],{type:"text/csv;charset=utf-8;"}),S=document.createElement("a");S.href=URL.createObjectURL(A),S.setAttribute("download","student_upload_template.csv"),document.body.appendChild(S),S.click(),document.body.removeChild(S)},T=()=>{m.current&&m.current.click()},F=A=>{var b;const S=(b=A.target.files)==null?void 0:b[0];if(!S)return;x(S.name);const E=new FileReader;E.onload=k=>{var _;const j=(_=k.target)==null?void 0:_.result;try{if(S.name.endsWith(".xlsx")||S.name.endsWith(".xls")){const B=xc(j,{type:"binary"}),Q=B.SheetNames[0],Z=B.Sheets[Q],L=Z1.sheet_to_csv(Z);s(L)}else if(S.name.endsWith(".csv"))s(j);else throw new Error("Unsupported file format. Please use CSV, XLSX, or XLS files.");f("initial"),c([]),u([])}catch(B){console.error("Error reading file:",B),u([{index:0,field:"file",message:"Failed to read file: "+(B instanceof Error?B.message:String(B))}]),f("error")}},S.name.endsWith(".csv")?E.readAsText(S):E.readAsBinaryString(S),A.target&&(A.target.value="")};return i.jsxs(br,{open:e,onClose:r,maxWidth:"md",fullWidth:!0,children:[i.jsx(Br,{children:"Bulk Student Upload"}),i.jsxs(Dr,{children:[i.jsxs(ye,{sx:{mb:2},children:[i.jsx(ee,{variant:"body1",gutterBottom:!0,children:"Upload your CSV/Excel file or paste CSV data below to add multiple students at once."}),i.jsx(ee,{variant:"body2",color:"text.secondary",children:"Required fields: Student ID, Name, Grade, Email, and Phone Number"})]}),i.jsxs(ye,{sx:{mb:2,display:"flex",gap:1},children:[i.jsx(st,{title:"Download sample CSV template",children:i.jsx(Pe,{variant:"outlined",size:"small",onClick:v,startIcon:i.jsx(vd,{}),children:"Download Template"})}),i.jsx("input",{type:"file",accept:".csv,.xlsx,.xls",style:{display:"none"},ref:m,onChange:F}),i.jsx(st,{title:"Upload CSV or Excel file",children:i.jsx(Pe,{variant:"contained",size:"small",onClick:T,startIcon:i.jsx(wd,{}),color:"primary",children:"Upload File"})})]}),h&&i.jsxs(Lr,{severity:"info",sx:{mb:2},children:["File loaded: ",h]}),i.jsx(Ae,{label:"CSV Data",multiline:!0,rows:10,value:a,onChange:p,fullWidth:!0,variant:"outlined",placeholder:"studentId,name,grade,section,email,phoneNumber,dateOfBirth,gender,address,parentName,parentEmail,parentPhone",sx:{mb:2}}),i.jsx(ye,{sx:{mb:2},children:i.jsx(Pe,{variant:"contained",color:"secondary",onClick:w,disabled:!a.trim()||n,children:"Parse Data"})}),d==="success"&&i.jsxs(Lr,{severity:"success",sx:{mb:2},children:[i.jsx(Li,{children:"Data Successfully Parsed"}),"Found ",o.length," valid student records ready to be imported."]}),d==="error"&&i.jsxs(Lr,{severity:"error",sx:{mb:2},children:[i.jsx(Li,{children:"Validation Errors"}),i.jsx(ye,{component:"ul",sx:{pl:2,mt:1},children:l.map((A,S)=>i.jsx("li",{children:`Row ${A.index+1}, ${A.field}: ${A.message}`},S))})]}),o.length>0&&i.jsxs(Ke,{variant:"outlined",sx:{p:2,mt:2,maxHeight:"200px",overflow:"auto"},children:[i.jsxs(ee,{variant:"subtitle1",gutterBottom:!0,children:["Preview of Parsed Data (",o.length," students)"]}),i.jsx(sr,{sx:{mb:2}}),o.slice(0,5).map((A,S)=>i.jsx(ye,{sx:{mb:1,p:1,bgcolor:"background.paper"},children:i.jsxs(ee,{variant:"body2",children:[i.jsx("strong",{children:"ID:"})," ",A.studentId,",",i.jsx("strong",{children:" Name:"})," ",A.name,",",i.jsx("strong",{children:" Grade:"})," ",A.grade,A.section?`-${A.section}`:"",",",i.jsx("strong",{children:" Email:"})," ",A.email]})},S)),o.length>5&&i.jsx($t,{label:`${o.length-5} more students`,size:"small",sx:{mt:1}})]})]}),i.jsxs(_r,{children:[i.jsx(Pe,{onClick:r,disabled:n,children:"Cancel"}),i.jsx(Pe,{onClick:y,color:"primary",disabled:o.length===0||d!=="success"||n,startIcon:n?i.jsx(sn,{size:20}):i.jsx(gd,{}),children:n?"Importing...":"Import Students"})]})]})},ey=e=>new Date(e).toLocaleDateString(),n8=(e,r,t)=>({id:"actions",label:"Actions",format:(n,a)=>i.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e&&i.jsx(st,{title:"Edit",children:i.jsx(Ze,{size:"small",color:"primary",onClick:()=>e(a),children:i.jsx(ro,{fontSize:"small"})})}),r&&i.jsx(st,{title:"Delete",children:i.jsx(Ze,{size:"small",color:"error",onClick:()=>r(a),children:i.jsx(Qs,{fontSize:"small"})})}),t&&t(a)]})}),Sn=({children:e,permission:r,permissions:t=[],requireAll:n=!1})=>{const{user:a}=_n();if(C.useEffect(()=>{r&&console.log(`🔒 Checking permission "${r}" for user role: "${(a==null?void 0:a.role)||"unknown"}"`,{hasPermission:a&&a.role?Lt(a.role,r):!1}),t.length>0&&console.log(`🔒 Checking permissions [${t.join(", ")}] for user role: "${(a==null?void 0:a.role)||"unknown"}"`,{requireAll:n,hasPermissions:a&&a.role?n?Gf(a.role,t):zf(a.role,t):!1})},[a,r,t,n]),!a)return console.warn("⚠️ Permission check failed: No user data available"),null;if(r){const s=a.role?Lt(a.role,r):!1;if(console.log(`🔑 Permission "${r}" check result: ${s?"granted ✅":"denied ❌"}`),!s)return null}if(t.length>0){const s=a.role?n?Gf(a.role,t):zf(a.role,t):!1;if(console.log(`🔑 Permissions [${t.join(", ")}] check result: ${s?"granted ✅":"denied ❌"}`),!s)return null}return i.jsx(i.Fragment,{children:e})},fp={getCommonEndpoints(e){return[{name:`Get all ${e} (api prefix)`,fn:()=>De.get(`/${e}`)},{name:`Get all ${e} (singular)`,fn:()=>De.get(`/${e.slice(0,-1)}`)},{name:"Check auth status",fn:()=>De.get("/auth/status")}]},async runApiTests(e){const r=[];for(const t of e)try{console.log(`🧪 Testing endpoint: ${t.name}`);const n=await t.fn();r.push({name:t.name,success:!0,status:"OK",data:n})}catch(n){r.push({name:t.name,success:!1,status:n.status||"Error",error:n.message||JSON.stringify(n)})}return r}},a8=({open:e,onClose:r,entityType:t,customEndpoints:n=[]})=>{const[a,s]=C.useState(!1),[o,c]=C.useState([]),l=async()=>{s(!0),c([]);const u=[...fp.getCommonEndpoints(t),...n],d=await fp.runApiTests(u);c(d),s(!1)};return i.jsxs(br,{open:e,onClose:r,maxWidth:"md",fullWidth:!0,children:[i.jsx(Br,{children:"API Endpoint Diagnostics"}),i.jsxs(Dr,{children:[i.jsx(ee,{variant:"body2",gutterBottom:!0,children:"Testing different API endpoints to find which one works with your backend."}),a&&i.jsx(ye,{sx:{display:"flex",justifyContent:"center",my:4},children:i.jsx(sn,{})}),o.length>0&&i.jsx(qa,{children:o.map((u,d)=>i.jsxs(An.Fragment,{children:[d>0&&i.jsx(sr,{}),i.jsx(Xa,{children:i.jsx(Ka,{primary:`${u.name} - ${u.success?"✅ Success":"❌ Failed"} (${u.status})`,secondary:i.jsx(ye,{component:"pre",sx:{mt:1,p:1,bgcolor:"grey.100",borderRadius:1,fontSize:"0.75rem",overflow:"auto",maxHeight:200},children:u.success?JSON.stringify(u.data,null,2):u.error})})})]},d))})]}),i.jsxs(_r,{children:[i.jsx(Pe,{onClick:l,disabled:a,color:"primary",children:"Run API Tests"}),i.jsx(Pe,{onClick:r,color:"secondary",children:"Close"})]})]})},ty=({feeDetails:e})=>{var t,n,a,s;if(!e||!e.feeStructure)return i.jsx(ee,{children:"No fee details available"});const{feeStructure:r}=e;return i.jsx(ye,{children:i.jsxs(X,{container:!0,spacing:2,children:[i.jsx(X,{item:!0,xs:12,md:6,children:i.jsxs(Ke,{elevation:0,sx:{p:2,bgcolor:"background.paper"},children:[i.jsx(ee,{variant:"subtitle1",fontWeight:"bold",gutterBottom:!0,children:"Fee Structure Details"}),i.jsx(sr,{sx:{my:1}}),i.jsxs(X,{container:!0,spacing:1,children:[i.jsx(X,{item:!0,xs:6,children:i.jsx(ee,{variant:"body2",color:"text.secondary",children:"Class Grade:"})}),i.jsx(X,{item:!0,xs:6,children:i.jsx(ee,{variant:"body2",children:r.classGrade})}),i.jsx(X,{item:!0,xs:6,children:i.jsx(ee,{variant:"body2",color:"text.secondary",children:"Annual Fees:"})}),i.jsx(X,{item:!0,xs:6,children:i.jsxs(ee,{variant:"body2",children:["$",(t=r.annualFees)==null?void 0:t.toFixed(2)]})}),i.jsx(X,{item:!0,xs:6,children:i.jsx(ee,{variant:"body2",color:"text.secondary",children:"Building Fees:"})}),i.jsx(X,{item:!0,xs:6,children:i.jsxs(ee,{variant:"body2",children:["$",(n=r.buildingFees)==null?void 0:n.toFixed(2)]})}),i.jsx(X,{item:!0,xs:6,children:i.jsx(ee,{variant:"body2",color:"text.secondary",children:"Lab Fees:"})}),i.jsx(X,{item:!0,xs:6,children:i.jsxs(ee,{variant:"body2",children:["$",(a=r.labFees)==null?void 0:a.toFixed(2)]})}),i.jsx(X,{item:!0,xs:6,children:i.jsx(ee,{variant:"body2",color:"text.secondary",fontWeight:"bold",children:"Total Fees:"})}),i.jsx(X,{item:!0,xs:6,children:i.jsxs(ee,{variant:"body2",fontWeight:"bold",children:["$",(s=r.totalFees)==null?void 0:s.toFixed(2)]})})]})]})}),i.jsx(X,{item:!0,xs:12,md:6,children:i.jsxs(Ke,{elevation:0,sx:{p:2,bgcolor:"background.paper"},children:[i.jsx(ee,{variant:"subtitle1",fontWeight:"bold",gutterBottom:!0,children:"Student Fee Assignment"}),i.jsx(sr,{sx:{my:1}}),i.jsxs(X,{container:!0,spacing:1,children:[i.jsx(X,{item:!0,xs:6,children:i.jsx(ee,{variant:"body2",color:"text.secondary",children:"Student ID:"})}),i.jsx(X,{item:!0,xs:6,children:i.jsx(ee,{variant:"body2",children:e.studentId})}),i.jsx(X,{item:!0,xs:6,children:i.jsx(ee,{variant:"body2",color:"text.secondary",children:"Student Fee ID:"})}),i.jsx(X,{item:!0,xs:6,children:i.jsx(ee,{variant:"body2",children:e.studentFeeId||"N/A"})})]})]})})]})})},s8=()=>{const[e,r]=C.useState(!1),[t,n]=C.useState(!1),[a,s]=C.useState(void 0),[o,c]=C.useState(!1),[l,u]=C.useState(null),[d,f]=C.useState(void 0),[h,x]=C.useState(!1),[m,p]=C.useState(null),[g,w]=C.useState(!1),{showNotification:y}=ln(),{user:v}=_n(),[T,F]=C.useState(!1),[A,S]=C.useState(null);C.useState(!1),C.useState(!1),C.useState(null);const{data:E,loading:b,error:k,refresh:j}=Ln(()=>Tr.getAllStudents(),{cacheKey:"students",onError:K=>{console.error("Error in useApi for students:",K),S(K)}}),{mutate:_,loading:B}=Mr(K=>Tr.create(K),{onSuccess:()=>{y({type:"success",message:"Student created successfully"}),r(!1),j()},onError:K=>{var D,re;console.error("Error saving student:",K);const O=K;O.response&&(console.error("Server response:",O.response.data),console.error("Status code:",O.response.status)),y({type:"error",message:`Failed to create student: ${((re=(D=O.response)==null?void 0:D.data)==null?void 0:re.message)||(K==null?void 0:K.message)||"Unknown error"}`})}}),{mutate:Q,loading:Z}=Mr(K=>Tr.update(K.id,K),{onSuccess:()=>{y({type:"success",message:"Student updated successfully"}),r(!1),s(void 0),j()}}),{mutate:L}=Mr(K=>Tr.delete(K),{onSuccess:()=>{y({type:"success",message:"Student deleted successfully"}),j()}}),{mutate:q,loading:te}=Mr(K=>Tr.createBulk(K),{onSuccess:K=>{y({type:"success",message:`${K.length} students created successfully`}),n(!1),j()},onError:K=>{console.error("Error creating students in bulk:",K),y({type:"error",message:`Failed to create students: ${K.message||"Unknown error"}`})}}),{mutate:R}=Mr(K=>Tr.updateStatus(K.id,K.status),{onSuccess:K=>{y({type:"success",message:`Student status updated to ${K.status}`}),j()},onError:K=>{y({type:"error",message:`Failed to update student status: ${K.message}`})}}),oe=async(K,O)=>{try{K.id&&await R({id:K.id,status:O}),u(null)}catch(D){console.error("Error updating student status:",D)}},J=K=>{s(K),r(!0)},P=async K=>{f(K),c(!0)},V=async K=>{try{if(!K.id){y({type:"error",message:"Cannot fetch fee details: Student ID is missing"});return}if(!Lt((v==null?void 0:v.role)||"","VIEW_FEES")&&!Lt((v==null?void 0:v.role)||"","MANAGE_FEES")){y({type:"error",message:"You do not have permission to view fee details."});return}w(!0);try{const O=await Bt.getStudentFeeDetails(K.id);s(K),p(O),x(!0),y({type:"info",message:"Displaying sample fee data while API access is being configured."})}catch(O){throw console.error("Error fetching fee details:",O),O}}catch(O){console.error("Error in fee details handling:",O);const D={studentId:K.id,studentFeeId:1,feeStructure:{id:1,classGrade:Number(K.grade)||1,annualFees:15e3,buildingFees:3e3,labFees:2e3,amount:2e4,totalFees:2e4}};s(K),p(D),x(!0),y({type:"warning",message:"Using sample fee data due to an error connecting to the fee service."})}finally{w(!1)}},z=async()=>{if(d)try{await L(d.id),c(!1),f(void 0)}catch(K){console.error("Error deleting student:",K),y({type:"error",message:`Failed to delete student: ${(K==null?void 0:K.message)||"Unknown error"}`})}},G=()=>{r(!1),s(void 0)},ne=()=>{x(!1),p(null)},he=async K=>{var O,D;try{if(a)await Q({...K,id:a.id});else{console.log("Creating new student with properly structured data:",K);try{await _(K)}catch(re){console.error("Standard API approach failed, trying with elevated permissions:",re);try{await Tr.createWithElevatedPermissions(K),y({type:"success",message:"Student created successfully with admin permissions"}),r(!1),j()}catch(le){throw console.error("Failed with elevated permissions too:",le),le}}}}catch(re){console.error("Error in handleSubmit:",re),y({type:"error",message:`Error: ${((D=(O=re.response)==null?void 0:O.data)==null?void 0:D.message)||(re==null?void 0:re.message)||"Unknown error occurred"}`})}},se=async K=>{try{await q(K)}catch(O){console.error("Standard API approach failed, trying with elevated permissions:",O);try{await Tr.createBulkWithElevatedPermissions(K),y({type:"success",message:`${K.length} students created successfully with admin permissions`}),n(!1),j()}catch(D){throw console.error("Failed with elevated permissions too:",D),D}}},ae=[{id:"studentId",label:"ID",sortable:!0},{id:"name",label:"Name",sortable:!0},{id:"grade",label:"Grade",sortable:!0},{id:"section",label:"Section",sortable:!0},{id:"dateOfBirth",label:"Date of Birth",sortable:!0,format:ey},{id:"email",label:"Email",sortable:!0},{id:"phoneNumber",label:"Contact",sortable:!0},{id:"status",label:"Status",sortable:!0,format:(K,O)=>{const D=String(K).toUpperCase();if(Lt((v==null?void 0:v.role)||"","EDIT_STUDENT"))return i.jsx(mt,{size:"small",fullWidth:!0,children:i.jsxs(gt,{value:D,onChange:re=>oe(O,re.target.value),displayEmpty:!0,variant:"standard",sx:{"& .MuiSelect-select":{py:0,color:()=>{switch(D){case"ACTIVE":return"success.main";case"INACTIVE":return"error.main";case"GRADUATED":return"info.main";case"SUSPENDED":return"warning.dark";default:return"text.primary"}}}},children:[i.jsx(Ye,{value:"ACTIVE",children:"Active"}),i.jsx(Ye,{value:"INACTIVE",children:"Inactive"}),i.jsx(Ye,{value:"GRADUATED",children:"Graduated"}),i.jsx(Ye,{value:"SUSPENDED",children:"Suspended"})]})});{let re="default";return D==="ACTIVE"?re="success":D==="INACTIVE"?re="error":D==="GRADUATED"?re="info":D==="SUSPENDED"&&(re="warning"),i.jsxs(ee,{variant:"body2",sx:{color:`${re}.main`,fontWeight:"medium",display:"inline-flex",alignItems:"center",gap:.5},children:[D==="ACTIVE"&&i.jsx(Wy,{fontSize:"small"}),D==="INACTIVE"&&i.jsx(Fp,{fontSize:"small"}),D==="GRADUATED"&&i.jsx(Qa,{fontSize:"small"}),D==="SUSPENDED"&&i.jsx(Hy,{fontSize:"small"}),D]})}}},{id:"actions",label:"Actions",sortable:!1,format:(K,O)=>i.jsxs(ye,{sx:{display:"flex",gap:1},children:[Lt((v==null?void 0:v.role)||"","EDIT_STUDENT")&&i.jsx(st,{title:"Edit",children:i.jsx(Ze,{size:"small",onClick:()=>J(O),color:"primary",children:i.jsx(ro,{fontSize:"small"})})}),Lt((v==null?void 0:v.role)||"","DELETE_STUDENT")&&i.jsx(st,{title:"Delete",children:i.jsx(Ze,{size:"small",onClick:()=>P(O),color:"error",children:i.jsx(Qs,{fontSize:"small"})})}),Lt((v==null?void 0:v.role)||"","MANAGE_ATTENDANCE")&&i.jsx(st,{title:"Attendance",children:i.jsx(Ze,{size:"small",color:"info",children:i.jsx(Go,{fontSize:"small"})})}),Lt((v==null?void 0:v.role)||"","MANAGE_EXAMS")&&i.jsx(st,{title:"Academic Records",children:i.jsx(Ze,{size:"small",color:"success",children:i.jsx(Qa,{fontSize:"small"})})}),"          ",(Lt((v==null?void 0:v.role)||"","MANAGE_FEES")||Lt((v==null?void 0:v.role)||"","VIEW_FEES"))&&i.jsx(st,{title:"Fee Details",children:i.jsx(Ze,{size:"small",color:"secondary",onClick:()=>V(O),children:i.jsx(Ol,{fontSize:"small"})})})]})}];if(b)return i.jsx(an,{});if(k){const K=typeof k=="string"?k:(k==null?void 0:k.message)||String(k)||"Couldn't load student data";return i.jsxs(ye,{sx:{p:3},children:[i.jsx(on,{title:"Error Loading Students",message:K,onRetry:j}),i.jsxs(ye,{sx:{mt:3,display:"flex",gap:2},children:[i.jsx(Pe,{variant:"contained",onClick:j,children:"Try Again"}),i.jsx(Pe,{variant:"outlined",color:"secondary",onClick:()=>F(!0),children:"Diagnostics"})]}),A&&i.jsxs(Ke,{elevation:0,variant:"outlined",sx:{p:3,mt:4},children:[i.jsxs(Lr,{severity:"error",sx:{mb:2},children:[i.jsxs(ee,{variant:"subtitle1",children:["HTTP Status: ",A.status||"Unknown"]}),A.message]}),i.jsx(ee,{variant:"subtitle1",children:"Debug Information:"}),i.jsx(ye,{component:"pre",sx:{p:2,bgcolor:"grey.100",borderRadius:1,overflowX:"auto"},children:JSON.stringify(A.originalError||A,null,2)}),i.jsxs(ye,{sx:{mt:2},children:[i.jsx(ee,{variant:"subtitle2",gutterBottom:!0,children:"Possible Solutions:"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Verify the API endpoint path is correct"}),i.jsx("li",{children:"Check that your user account has permission to access student data"}),i.jsx("li",{children:"Ensure your authentication token is valid and not expired"}),i.jsx("li",{children:"Verify the backend server is running and accessible"})]})]})]})]})}return i.jsxs(ye,{sx:{p:3},children:[i.jsxs(ye,{sx:{mb:3,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx(ee,{variant:"h4",children:"Students"}),i.jsxs(ye,{children:[i.jsx(Pe,{variant:"text",color:"secondary",onClick:()=>F(!0),sx:{mr:2},children:"Debug"}),i.jsx(Sn,{permission:"CREATE_STUDENT",children:i.jsxs(vc,{direction:"row",spacing:2,children:[i.jsx(Pe,{variant:"outlined",color:"primary",startIcon:i.jsx(jp,{}),onClick:()=>n(!0),children:"Bulk Upload"}),i.jsx(Pe,{variant:"contained",color:"primary",startIcon:i.jsx(zs,{}),onClick:()=>r(!0),children:"New Student"})]})})]})]}),i.jsx(Ke,{children:i.jsx(zc,{columns:ae,data:E||[],loading:b,onRefresh:j,searchPlaceholder:"Search students..."})}),i.jsx(HP,{open:e,onClose:G,onSubmit:he,initialData:a,loading:B||Z}),i.jsx(r8,{open:t,onClose:()=>n(!1),onSubmit:se,loading:te}),i.jsx(a8,{open:T,onClose:()=>F(!1),entityType:"students",customEndpoints:[{name:"Get student entities",fn:()=>Tr.getAllStudents()}]}),i.jsxs(br,{open:o,onClose:()=>c(!1),children:[i.jsx(Br,{children:"Confirm Deletion"}),i.jsx(Dr,{children:i.jsx(Ip,{children:"Are you sure you want to delete this student?"})}),i.jsxs(_r,{children:[i.jsx(Pe,{onClick:()=>c(!1),color:"primary",children:"Cancel"}),i.jsx(Pe,{onClick:z,color:"secondary",children:"Delete"})]})]}),"      ",i.jsxs(br,{open:h,onClose:ne,fullWidth:!0,maxWidth:"md",children:[i.jsx(Br,{children:"Fee Details"}),i.jsx(Dr,{children:g?i.jsx(ye,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:i.jsx(sn,{})}):m?i.jsx(ty,{feeDetails:m}):i.jsx(ee,{children:"No fee details available"})}),i.jsx(_r,{children:i.jsx(Pe,{onClick:ne,color:"primary",children:"Close"})})]}),i.jsxs(Ep,{anchorEl:l,open:!!l,onClose:()=>u(null),children:[i.jsx(Ye,{onClick:()=>oe(a,"ACTIVE"),children:"Set Active"}),i.jsx(Ye,{onClick:()=>oe(a,"INACTIVE"),children:"Set Inactive"}),i.jsx(Ye,{onClick:()=>oe(a,"GRADUATED"),children:"Set Graduated"}),i.jsx(Ye,{onClick:()=>oe(a,"SUSPENDED"),children:"Set Suspended"})]})]})},i8=({open:e,onClose:r,onSubmit:t,initialData:n,loading:a})=>{const[s,o]=C.useState({name:"",department:"",teacherId:0,credits:0,capacity:30,enrolled:0});C.useEffect(()=>{o(n?{...n}:{name:"",department:"",teacherId:0,credits:0,capacity:30,enrolled:0})},[n,e]);const[c,l]=C.useState({}),{data:u}=Ln(()=>Iu.getAll(),{cacheKey:"teachers"}),d=h=>x=>{const m=h==="teacherId"||h==="credits"||h==="capacity"||h==="enrolled"?Number(x.target.value):x.target.value;o(p=>({...p,[h]:m})),c[h]&&l(p=>({...p,[h]:""}))},f=()=>{const h=BP(s);if(Object.keys(h).length>0){l(h);return}t(s)};return i.jsx(Yc,{open:e,onClose:r,title:n?"Edit Course":"New Course",onSubmit:f,submitLabel:n?"Update":"Create",loading:a,children:i.jsxs(X,{container:!0,spacing:2,children:[i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Course Name",value:s.name,onChange:d("name"),error:!!c.name,helperText:c.name,required:!0})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Department",value:s.department,onChange:d("department"),error:!!c.department,helperText:c.department,required:!0})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsxs(mt,{fullWidth:!0,children:[i.jsx(Tt,{children:"Teacher"}),i.jsx(gt,{value:s.teacherId,onChange:d("teacherId"),label:"Teacher",required:!0,children:u==null?void 0:u.map(h=>i.jsx(Ye,{value:h.id,children:h.name},h.id))})]})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Credits",type:"number",value:s.credits,onChange:d("credits"),error:!!c.credits,helperText:c.credits,required:!0,inputProps:{min:0}})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Capacity",type:"number",value:s.capacity,onChange:d("capacity"),error:!!c.capacity,helperText:c.capacity,required:!0,inputProps:{min:1}})}),n&&i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Currently Enrolled",type:"number",value:s.enrolled,onChange:d("enrolled"),error:!!c.enrolled,helperText:c.enrolled,inputProps:{min:0,max:s.capacity}})})]})})},o8=()=>{const[e,r]=C.useState(!1),[t,n]=C.useState(null),{showNotification:a}=ln(),{user:s}=_n(),{data:o,loading:c,error:l,refresh:u}=Ln(()=>Is.getAll(),{cacheKey:"courses"}),{mutate:d,loading:f}=Mr(T=>Is.create(T),{onSuccess:()=>{a({type:"success",message:"Course created successfully"}),r(!1),u()}}),{mutate:h,loading:x}=Mr(T=>Is.update(T.id,T),{onSuccess:()=>{a({type:"success",message:"Course updated successfully"}),r(!1),n(null),u()}}),{mutate:m}=Mr(T=>Is.delete(T),{onSuccess:()=>{a({type:"success",message:"Course deleted successfully"}),u()}}),p=T=>{n(T),r(!0)},g=async T=>{window.confirm("Are you sure you want to delete this course?")&&await m(T.id)},w=()=>{r(!1),n(null)},y=async T=>{t?await h({...T,id:t.id}):await d(T)},v=[{id:"id",label:"ID",sortable:!0},{id:"name",label:"Name",sortable:!0},{id:"department",label:"Department",sortable:!0},{id:"teacherId",label:"Teacher ID",sortable:!0},{id:"credits",label:"Credits",sortable:!0},{id:"capacity",label:"Capacity",sortable:!0},{id:"enrolled",label:"Enrolled",sortable:!0},n8(T=>Lt((s==null?void 0:s.role)||"","EDIT_COURSE")&&p(T),T=>Lt((s==null?void 0:s.role)||"","DELETE_COURSE")&&g(T),T=>i.jsxs(i.Fragment,{children:[i.jsx(Sn,{permissions:["MANAGE_ENROLLMENTS","VIEW_ENROLLMENTS"],children:i.jsx(st,{title:"Students",children:i.jsx(Ze,{size:"small",onClick:()=>{},children:i.jsx(Ws,{})})})}),i.jsx(Sn,{permissions:["MANAGE_ASSIGNMENTS"],children:i.jsx(st,{title:"Assignments",children:i.jsx(Ze,{size:"small",onClick:()=>{},children:i.jsx(Go,{})})})}),i.jsx(Sn,{permissions:["MANAGE_SCHEDULE"],children:i.jsx(st,{title:"Schedule",children:i.jsx(Ze,{size:"small",onClick:()=>{},children:i.jsx(Pp,{})})})})]}))];return c&&!o?i.jsx(an,{}):l?i.jsx(on,{message:l,onRetry:u}):i.jsxs(ye,{children:[i.jsxs(ye,{sx:{mb:3,display:"flex",justifyContent:"space-between"},children:[i.jsx(ee,{variant:"h4",children:"Courses"}),i.jsx(Sn,{permission:"CREATE_COURSE",children:i.jsx(Pe,{variant:"contained",color:"primary",startIcon:i.jsx(zs,{}),onClick:()=>r(!0),children:"New Course"})})]}),i.jsx(Ke,{children:i.jsx(zc,{columns:v,data:o||[],loading:c,onRefresh:u,searchPlaceholder:"Search courses..."})}),i.jsx(i8,{open:e,onClose:w,onSubmit:y,initialData:t,loading:f||x})]})},c8=({reportType:e,classGrade:r,onDownload:t})=>{const[n,a]=C.useState(!1),[s,o]=C.useState(null),[c,l]=C.useState([]),[u,d]=C.useState([]),[f,h]=C.useState(""),[x,m]=C.useState("all");C.useEffect(()=>{(async()=>{a(!0),o(null);try{let E;e==="students-with-fees-due"?E=await Bt.generateFeesDueReport(r):e==="fee-payment-status"?E=await Bt.generateFeeStatusReport(r):E=[],console.log("Received fee report data:",E);const b=E.map(k=>{console.log("Processing fee report item:",k);let j=k.studentName;!j&&k.feeName&&(j=k.feeName);const _=k.totalAmount||k.totalDue||0,B=k.paidAmount||k.totalPaid||0,Q=k.remainingAmount||k.balance||_-B;let Z=k.status||k.paymentStatus||"UNKNOWN";return typeof Z=="object"&&Z!==null&&(Z=String(Z)),Z==="COMPLETED"||Z==="PAID"?Z="PAID":Z==="PENDING"&&B>0?Z="PARTIALLY_PAID":Z==="PENDING"&&B<=0&&(Z="UNPAID"),k.isOverdue===!0&&(Z="OVERDUE"),{studentId:k.studentId||0,studentName:j||"Unknown Student",totalDue:_,totalPaid:B,balance:Q,paymentStatus:Z,lastPaymentDate:k.lastPaymentDate,nextDueDate:k.nextDueDate||k.dueDate,isOverdue:k.isOverdue===!0||Z==="OVERDUE"}});l(b),d(b)}catch(E){console.error("Error fetching report data:",E),o("Failed to fetch report data. Please try again.")}finally{a(!1)}})()},[e,r]),C.useEffect(()=>{let S=[...c];if(f.trim()!==""){const E=f.toLowerCase();S=S.filter(b=>{var k;return((k=b.studentName)==null?void 0:k.toLowerCase().includes(E))||String(b.studentId).includes(E)})}x!=="all"&&(S=S.filter(E=>E.paymentStatus===x)),d(S)},[f,x,c]);const p=()=>e==="students-with-fees-due"?r?`Students with Fees Due - Grade ${r}`:"Students with Fees Due - All Classes":e==="fee-payment-status"?r?`Fee Payment Status - Grade ${r}`:"Fee Payment Status - All Classes":"Fee Report",g=S=>{switch(S){case"PAID":return"success";case"PARTIALLY_PAID":return"warning";case"UNPAID":return"error";case"OVERDUE":return"error";default:return"default"}},w=S=>S?new Date(S).toLocaleDateString():"N/A",y=S=>S.toLocaleString("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}),v=()=>{const S=u.reduce((k,j)=>k+(j.totalDue||0),0),E=u.reduce((k,j)=>k+(j.totalPaid||0),0),b=u.reduce((k,j)=>k+(j.balance||0),0);return{totalDue:S,totalPaid:E,totalBalance:b}};if(n)return i.jsx(an,{});if(s)return i.jsx(on,{message:s});if(!c||c.length===0||c.every(S=>(S.totalDue||S.totalAmount||0)===0)){const S=c&&c.length>0&&c.every(b=>(b.totalDue||b.totalAmount||0)===0),E=r===1||r===9;return i.jsxs(Ke,{sx:{p:3,textAlign:"center",backgroundColor:"#f9f9f9"},children:[i.jsx(ee,{variant:"h6",color:"textSecondary",sx:{mb:2},children:"No report data to display"}),i.jsx(ee,{color:"textSecondary",sx:{mb:1},children:S?"Students found, but no fees have been assigned to them.":e==="students-with-fees-due"?"No students with fees due found for the selected criteria.":"No fee payment status data available for the selected criteria."}),i.jsx(ee,{color:"textSecondary",sx:{mb:2,fontSize:"0.9rem"},children:S?E?`Grade ${r} students exist but have no fees assigned. Please add fees for Grade ${r} in the Fee Management section.`:"Students exist but have no fees assigned for their grade. Please add fee structures in the Fee Management section.":E?`Known issue with Grade ${r}: Students may exist but aren't being properly associated with fees. The app will now attempt to fix this issue automatically.`:r?"Try selecting a different grade or view all classes.":"Try narrowing down your search by selecting a specific grade."}),E&&i.jsx(Pe,{variant:"contained",color:"primary",onClick:()=>window.location.reload(),sx:{mt:2},children:"Reload Page to Apply Fix"})]})}const{totalDue:T,totalPaid:F,totalBalance:A}=v();return i.jsxs(Ke,{sx:{width:"100%",overflow:"hidden",mb:3,boxShadow:"0 4px 12px rgba(0,0,0,0.08)"},children:[i.jsx(ye,{sx:{p:3,backgroundColor:"#f5f9ff",borderBottom:"1px solid #e0e0e0"},children:i.jsxs(X,{container:!0,spacing:2,alignItems:"center",justifyContent:"space-between",children:[i.jsxs(X,{item:!0,children:[i.jsx(ee,{variant:"h6",sx:{fontWeight:"bold",color:"#1565C0"},children:p()}),i.jsx(ee,{variant:"body2",color:"textSecondary",children:`Showing ${u.length} of ${c.length} records`})]}),i.jsx(X,{item:!0,children:i.jsx(Pe,{variant:"contained",color:"primary",startIcon:i.jsx(Yo,{}),onClick:t,sx:{textTransform:"none"},children:"Download Report"})})]})}),i.jsx(ye,{sx:{p:2,backgroundColor:"#ffffff"},children:i.jsxs(X,{container:!0,spacing:2,alignItems:"center",children:[i.jsx(X,{item:!0,xs:12,sm:4,children:i.jsx(Ae,{fullWidth:!0,variant:"outlined",placeholder:"Search by student name or ID",size:"small",value:f,onChange:S=>h(S.target.value),InputProps:{startAdornment:i.jsx(yn,{position:"start",children:i.jsx(wu,{color:"action"})})}})}),i.jsx(X,{item:!0,xs:12,sm:4,children:i.jsxs(mt,{fullWidth:!0,size:"small",variant:"outlined",children:[i.jsx(Tt,{children:"Payment Status"}),i.jsxs(gt,{value:x,label:"Payment Status",onChange:S=>m(S.target.value),children:[i.jsx(Ye,{value:"all",children:"All Statuses"}),i.jsx(Ye,{value:"PAID",children:"Paid"}),i.jsx(Ye,{value:"PARTIALLY_PAID",children:"Partially Paid"}),i.jsx(Ye,{value:"UNPAID",children:"Unpaid"}),i.jsx(Ye,{value:"OVERDUE",children:"Overdue"})]})]})})]})}),i.jsx(ye,{sx:{p:2,backgroundColor:"#f5f9ff",borderTop:"1px solid #e0e0e0"},children:i.jsxs(X,{container:!0,spacing:3,children:[i.jsx(X,{item:!0,xs:12,sm:4,children:i.jsxs(Ke,{sx:{p:2,textAlign:"center",backgroundColor:"#ffffff"},children:[i.jsx(ee,{variant:"subtitle2",color:"textSecondary",children:"Total Due"}),i.jsx(ee,{variant:"h6",sx:{fontWeight:"bold",color:"#1565C0"},children:y(T)})]})}),i.jsx(X,{item:!0,xs:12,sm:4,children:i.jsxs(Ke,{sx:{p:2,textAlign:"center",backgroundColor:"#ffffff"},children:[i.jsx(ee,{variant:"subtitle2",color:"textSecondary",children:"Total Paid"}),i.jsx(ee,{variant:"h6",sx:{fontWeight:"bold",color:"#4caf50"},children:y(F)})]})}),i.jsx(X,{item:!0,xs:12,sm:4,children:i.jsxs(Ke,{sx:{p:2,textAlign:"center",backgroundColor:"#ffffff"},children:[i.jsx(ee,{variant:"subtitle2",color:"textSecondary",children:"Outstanding Balance"}),i.jsx(ee,{variant:"h6",sx:{fontWeight:"bold",color:A>0?"#f44336":"#4caf50"},children:y(A)})]})})]})}),i.jsx(sr,{}),i.jsx(rs,{sx:{maxHeight:440},children:i.jsxs(ya,{stickyHeader:!0,"aria-label":"fee report table",children:[i.jsx(va,{children:i.jsxs(Ut,{sx:{backgroundColor:"#f5f9ff"},children:[i.jsx(Re,{sx:{fontWeight:"bold"},children:"Student ID"}),i.jsx(Re,{sx:{fontWeight:"bold"},children:"Student Name"}),i.jsx(Re,{align:"right",sx:{fontWeight:"bold"},children:"Total Due"}),i.jsx(Re,{align:"right",sx:{fontWeight:"bold"},children:"Total Paid"}),i.jsx(Re,{align:"right",sx:{fontWeight:"bold"},children:"Balance"}),i.jsx(Re,{sx:{fontWeight:"bold"},children:"Status"}),i.jsx(Re,{sx:{fontWeight:"bold"},children:"Last Payment"}),i.jsx(Re,{sx:{fontWeight:"bold"},children:"Next Due Date"})]})}),i.jsx(ba,{children:u.length>0?u.map(S=>{const E=S.isOverdue||S.paymentStatus==="OVERDUE";return i.jsxs(Ut,{hover:!0,sx:{backgroundColor:E?"rgba(244, 67, 54, 0.05)":"inherit"},children:["                    ",i.jsx(Re,{children:S.studentId}),i.jsx(Re,{children:S.studentName}),i.jsx(Re,{align:"right",children:y(S.totalDue)}),i.jsx(Re,{align:"right",children:y(S.totalPaid)}),i.jsx(Re,{align:"right",children:y(S.balance)}),i.jsx(Re,{children:i.jsx($t,{label:S.paymentStatus.replace("_"," "),color:g(S.paymentStatus),size:"small",sx:{fontWeight:500},icon:S.isOverdue?i.jsx(Cp,{}):void 0})}),i.jsx(Re,{children:w(S.lastPaymentDate)}),i.jsx(Re,{children:w(S.nextDueDate)})]},S.studentId)}):i.jsx(Ut,{children:i.jsx(Re,{colSpan:8,align:"center",children:i.jsx(ee,{color:"textSecondary",sx:{py:2},children:"No matching records found"})})})})]})})]})},hp=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8"],pp=e=>{const{children:r,value:t,index:n,...a}=e;return i.jsx("div",{role:"tabpanel",hidden:t!==n,id:`reports-tabpanel-${n}`,"aria-labelledby":`reports-tab-${n}`,...a,children:t===n&&i.jsx(ye,{sx:{p:3},children:r})})},l8=()=>{const{showNotification:e}=ln(),[r,t]=C.useState(!0),[n,a]=C.useState(null),[s,o]=C.useState([]),[c,l]=C.useState([]),[u,d]=C.useState([]),[f,h]=C.useState("enrollment"),[x,m]=C.useState(0),[p,g]=C.useState("all"),[w,y]=C.useState(null),[v,T]=C.useState(""),[F,A]=C.useState([]),[S,E]=C.useState(!1),[b,k]=C.useState(null),j=async()=>{try{t(!0),a(null);const te=await Is.getAll(),R=await Tr.getAll(),oe=await Iu.getAll();if(Array.isArray(te))o(te);else{const J=te;o(Array.isArray(J.data)?J.data:[])}if(Array.isArray(R))l(R);else{const J=R;l(Array.isArray(J.data)?J.data:[])}if(Array.isArray(oe))d(oe);else{const J=oe;d(Array.isArray(J.data)?J.data:[])}}catch(te){console.error("Error loading report data:",te),a("Failed to load report data. Please try again."),e({type:"error",message:"Failed to load report data"})}finally{t(!1)}};C.useEffect(()=>{j()},[]);const _=(te,R)=>{m(R)},B=async te=>{T(te),E(!0),k(null);try{const R=(await Ll(()=>import("./debug-api-d828a4a5.js"),["assets/debug-api-d828a4a5.js","assets/mui-vendor-2642d531.js","assets/react-vendor-c0a3892c.js","assets/chart-vendor-22102d3f.js"])).default,oe=R.checkApiConfig();console.log("API config check before generating report:",oe);let J;if(te==="students-with-fees-due")J=await Bt.generateFeesDueReport(p==="byClass"?w:null);else try{console.log("Trying debug API call first..."),J=await R.testFeeStatusReport(p==="byClass"?w:null)}catch(z){console.error("Debug API call failed, falling back to regular service:",z),J=await Bt.generateFeeStatusReport(p==="byClass"?w:null)}const P=await Ll(()=>import("./fee-report-debug-399658ca.js"),[]);(!J||!Array.isArray(J))&&(console.warn("Received non-array data:",J),J=[]);const V=P.analyzeFeeReportData(te,p==="byClass"?w:null,J);console.log("Fee report diagnostics:",V.diagnostics.join(`
`)),V.hasIssues&&console.warn("⚠️ Issues detected in fee report data. Check console for details."),A(J)}catch(R){console.error("Error generating fee report:",R),k("Failed to generate report. Please try again. Check console for details."),e({type:"error",message:"Failed to generate fee report. Check browser console for details."})}finally{E(!1)}},Q=async()=>{if(!v){e({type:"error",message:"Please select a report type first"});return}try{await Bt.downloadFeeReport(v,p==="byClass"?w:null),e({type:"success",message:"Report downloaded successfully"})}catch(te){console.error("Error downloading fee report:",te),e({type:"error",message:"Error downloading report"})}},Z=s.map(te=>({courseName:te.name,enrolled:te.enrolled,capacity:te.capacity,availableSeats:te.capacity-te.enrolled})),L=s.reduce((te,R)=>{const oe=te.find(J=>J.name===R.department);return oe?(oe.courses+=1,oe.students=s.filter(J=>J.department===R.department).reduce((J,P)=>J+P.enrolled,0)):te.push({name:R.department,courses:1,students:s.filter(J=>J.department===R.department).reduce((J,P)=>J+P.enrolled,0),teachers:u.filter(J=>J.department===R.department).length}),te},[]),q=()=>{let te=[],R="";switch(f){case"enrollment":te=Z,R="enrollment-report.csv";break;case"department":te=L,R="department-stats.csv";break;default:return}const oe="data:text/csv;charset=utf-8,"+Object.keys(te[0]).join(",")+"\\n"+te.map(P=>Object.values(P).join(",")).join("\\n"),J=document.createElement("a");J.href=encodeURI(oe),J.download=R,document.body.appendChild(J),J.click(),document.body.removeChild(J)};return r&&x===0?i.jsx(an,{message:"Loading report data..."}):n&&x===0?i.jsx(on,{message:n,onRetry:j}):i.jsxs(ye,{children:[i.jsxs(ye,{sx:{display:"flex",justifyContent:"space-between",mb:4},children:[i.jsx(ee,{variant:"h4",children:"Reports & Analytics"}),x===0&&i.jsx(Pe,{variant:"contained",startIcon:i.jsx(zy,{}),onClick:q,children:"Export Report"})]}),i.jsx(ye,{sx:{borderBottom:1,borderColor:"divider",mb:3},children:i.jsxs(Su,{value:x,onChange:_,"aria-label":"reports tabs",children:[i.jsx(ma,{label:"Academic Reports"}),i.jsx(ma,{label:"Fee Reports"})]})}),i.jsxs(pp,{value:x,index:0,children:[i.jsxs(mt,{sx:{mb:4,minWidth:200},children:[i.jsx(Tt,{children:"Report Type"}),i.jsxs(gt,{value:f,label:"Report Type",onChange:te=>h(te.target.value),children:[i.jsx(Ye,{value:"enrollment",children:"Course Enrollment"}),i.jsx(Ye,{value:"department",children:"Department Statistics"})]})]}),f==="enrollment"&&i.jsxs(X,{container:!0,spacing:4,children:[i.jsx(X,{item:!0,xs:12,children:i.jsxs(Ke,{sx:{p:3},children:[i.jsx(ee,{variant:"h6",sx:{mb:2},children:"Course Enrollment Distribution"}),i.jsx(Tf,{width:"100%",height:400,children:i.jsxs(sv,{data:Z,children:[i.jsx(iv,{strokeDasharray:"3 3"}),i.jsx(ov,{dataKey:"courseName"}),i.jsx(cv,{}),i.jsx(Af,{}),i.jsx(kf,{}),i.jsx(Cf,{dataKey:"enrolled",fill:"#8884d8",name:"Enrolled"}),i.jsx(Cf,{dataKey:"availableSeats",fill:"#82ca9d",name:"Available Seats"})]})})]})}),i.jsx(X,{item:!0,xs:12,children:i.jsx(rs,{component:Ke,children:i.jsxs(ya,{children:[i.jsx(va,{children:i.jsxs(Ut,{children:[i.jsx(Re,{children:"Course"}),i.jsx(Re,{align:"right",children:"Enrolled"}),i.jsx(Re,{align:"right",children:"Capacity"}),i.jsx(Re,{align:"right",children:"Available Seats"}),i.jsx(Re,{align:"right",children:"Fill Rate (%)"})]})}),i.jsx(ba,{children:Z.map(te=>i.jsxs(Ut,{children:[i.jsx(Re,{children:te.courseName}),i.jsx(Re,{align:"right",children:te.enrolled}),i.jsx(Re,{align:"right",children:te.capacity}),i.jsx(Re,{align:"right",children:te.availableSeats}),i.jsxs(Re,{align:"right",children:[(te.enrolled/te.capacity*100).toFixed(1),"%"]})]},te.courseName))})]})})})]}),f==="department"&&i.jsxs(X,{container:!0,spacing:4,children:[i.jsx(X,{item:!0,xs:12,md:6,children:i.jsxs(Ke,{sx:{p:3},children:[i.jsx(ee,{variant:"h6",sx:{mb:2},children:"Department Distribution"}),i.jsx(Tf,{width:"100%",height:400,children:i.jsxs(lv,{children:[i.jsx(uv,{data:L,dataKey:"courses",nameKey:"name",cx:"50%",cy:"50%",label:!0,children:L.map((te,R)=>i.jsx(dv,{fill:hp[R%hp.length]},te.name))}),i.jsx(Af,{}),i.jsx(kf,{})]})})]})}),i.jsx(X,{item:!0,xs:12,md:6,children:i.jsx(rs,{component:Ke,children:i.jsxs(ya,{children:[i.jsx(va,{children:i.jsxs(Ut,{children:[i.jsx(Re,{children:"Department"}),i.jsx(Re,{align:"right",children:"Courses"}),i.jsx(Re,{align:"right",children:"Teachers"})]})}),i.jsx(ba,{children:L.map(te=>i.jsxs(Ut,{children:[i.jsx(Re,{children:te.name}),i.jsx(Re,{align:"right",children:te.courses}),i.jsx(Re,{align:"right",children:te.teachers})]},te.name))})]})})})]})]}),i.jsxs(pp,{value:x,index:1,children:[i.jsxs(ye,{sx:{mb:4},children:[i.jsx(ee,{variant:"h6",gutterBottom:!0,sx:{fontWeight:"bold",color:"#1565C0"},children:"Fee Reports"}),i.jsx(Ke,{sx:{p:3,backgroundColor:"#f5f9ff",boxShadow:"0 4px 8px rgba(0,0,0,0.05)"},children:i.jsxs(X,{container:!0,spacing:3,children:[i.jsxs(X,{item:!0,xs:12,children:[i.jsx(ee,{variant:"subtitle1",gutterBottom:!0,sx:{fontWeight:"medium",mb:2},children:"Report Filters"}),i.jsxs(X,{container:!0,spacing:3,alignItems:"center",children:[i.jsx(X,{item:!0,children:i.jsxs(mt,{sx:{minWidth:200},variant:"outlined",children:[i.jsx(Tt,{children:"Filter By"}),i.jsxs(gt,{value:p,label:"Filter By",onChange:te=>g(te.target.value),sx:{backgroundColor:"white"},children:[i.jsx(Ye,{value:"all",children:"All Classes"}),i.jsx(Ye,{value:"byClass",children:"Specific Class"})]})]})}),p==="byClass"&&i.jsx(X,{item:!0,children:i.jsxs(mt,{sx:{minWidth:150},variant:"outlined",children:[i.jsx(Tt,{children:"Class Grade"}),i.jsx(gt,{value:w??"",label:"Class Grade",onChange:te=>y(te.target.value?Number(te.target.value):null),sx:{backgroundColor:"white"},children:[1,2,3,4,5,6,7,8,9,10,11,12].map(te=>i.jsxs(Ye,{value:te,children:["Grade ",te]},te))})]})})]})]}),i.jsxs(X,{item:!0,xs:12,sx:{mt:1},children:[i.jsx(ee,{variant:"subtitle1",gutterBottom:!0,sx:{fontWeight:"medium",mb:2},children:"Report Types"}),i.jsxs(X,{container:!0,spacing:2,children:[i.jsx(X,{item:!0,children:i.jsx(Pe,{variant:"contained",color:"primary",onClick:()=>B("students-with-fees-due"),disabled:p==="byClass"&&!w,startIcon:i.jsx(wf,{}),sx:{borderRadius:"4px",textTransform:"none",backgroundColor:v==="students-with-fees-due"?"#1565C0":"#e0e0e0",color:v==="students-with-fees-due"?"white":"rgba(0, 0, 0, 0.87)","&:hover":{backgroundColor:v==="students-with-fees-due"?"#1976D2":"#d5d5d5"}},children:"Students with Fees Due"})}),i.jsx(X,{item:!0,children:i.jsx(Pe,{variant:"contained",color:"primary",onClick:()=>B("fee-payment-status"),disabled:p==="byClass"&&!w,startIcon:i.jsx(wf,{}),sx:{borderRadius:"4px",textTransform:"none",backgroundColor:v==="fee-payment-status"?"#1565C0":"#e0e0e0",color:v==="fee-payment-status"?"white":"rgba(0, 0, 0, 0.87)","&:hover":{backgroundColor:v==="fee-payment-status"?"#1976D2":"#d5d5d5"}},children:"Fee Payment Status"})})]})]}),i.jsx(X,{item:!0,xs:12,sx:{mt:2,display:"flex",justifyContent:"flex-end"},children:i.jsx(Pe,{variant:"contained",color:"secondary",onClick:Q,disabled:p==="byClass"&&!w||!v,startIcon:i.jsx(Yo,{}),sx:{borderRadius:"4px",textTransform:"none",fontWeight:"medium",boxShadow:"0 2px 5px rgba(0,0,0,0.1)"},children:"Download Report"})})]})})]}),i.jsx(ye,{sx:{mt:4},children:S?i.jsx(an,{message:"Generating report, please wait..."}):b?i.jsx(on,{message:b}):F&&F.length>0?i.jsx(c8,{reportType:v,classGrade:p==="byClass"?w:null,onDownload:Q}):i.jsx(Ke,{sx:{p:4,textAlign:"center",backgroundColor:"#f9f9f9"},children:i.jsx(ee,{variant:"subtitle1",color:"textSecondary",children:"No report data to display. Select a report type and generate a report to view results."})})})]})]})},gn={getAllApplications:async()=>{const e=await De.get("/api/admissions");return console.log("API Response for getAllApplications:",e),e.map(mp)},getApplicationById:async e=>{try{console.log(`Fetching admission details for ID: ${e}`);const r=await De.get(`/api/admissions/${e}`);console.log("Admission details from backend:",r);const t=mp(r);if(r.studentId)try{console.log(`Admission has associated student ID: ${r.studentId}, fetching student details`);const n=await Tr.getById(r.studentId);console.log("Student data retrieved:",n),n&&n.address&&(console.log("Found address in student record:",n.address),t.address=n.address)}catch(n){console.warn("Could not fetch student data:",n)}else console.log("No associated student ID found for this admission");return t}catch(r){throw console.error(`Failed to get admission details for ID ${e}:`,r),r}},createApplication:e=>{let r=e.dateOfBirth;if(r&&!r.includes("-")){const n=new Date(r);isNaN(n.getTime())||(r=n.toISOString().split("T")[0])}const t={applicantName:e.studentName,dateOfBirth:r,email:e.email,contactNumber:e.contactNumber,guardianName:e.parentName,guardianContact:e.contactNumber,guardianEmail:e.email,address:e.address,gradeApplying:parseInt(e.gradeApplying,10)||1,previousSchool:e.previousSchool||"Not Available",previousGrade:e.previousGrade||"Not Available",previousPercentage:e.previousPercentage||75,documents:e.documents,documentsFormat:e.documentsFormat};return console.log("Sending admission request with structured data:",t),console.log("Date format checking - original:",e.dateOfBirth,"formatted:",r),console.log("Address value being sent:",e.address),De.post("/api/admissions",t)},updateApplication:async(e,r)=>{if(console.log(`Updating admission application with ID: ${e}`,r),!localStorage.getItem("token"))throw new Error("You must be logged in to update applications");try{const n={applicantName:r.studentName,dateOfBirth:r.dateOfBirth,email:r.email,contactNumber:r.contactNumber,guardianName:r.parentName,guardianContact:r.contactNumber,guardianEmail:r.email,address:r.address,gradeApplying:parseInt(r.gradeApplying,10),previousSchool:r.previousSchool||"Not Available",previousGrade:r.previousGrade||"Not Available",previousPercentage:r.previousPercentage||75,documents:r.documents,documentsFormat:r.documentsFormat};console.log("Sending general update request with data:",n);const a=await De.put(`/api/admissions/${e}`,n);return console.log("Update response:",a),a}catch(n){throw console.error("Update attempt failed:",n),n}},updateStatus:async(e,r,t)=>{console.log(`Updating admission status ${e} to ${r}`);const n=new URLSearchParams;return n.append("status",r),t&&n.append("remarks",t),De.put(`/api/admissions/${e}/status?${n.toString()}`)},getByStatus:e=>De.get(`/api/admissions/status/${e}`),searchApplications:e=>De.get(`/api/admissions/search?query=${e}`),getByDateRange:(e,r)=>De.get(`/api/admissions/date-range?startDate=${e}&endDate=${r}`),getByGrade:e=>De.get(`/api/admissions/grade/${e}`),deleteApplication:e=>De.delete(`/api/admissions/${e}`),processAdmission:async(e,r,t)=>{console.log(`Processing admission ${e} with action: ${r}`);try{const n=r==="APPROVE"?"APPROVED":"REJECTED",a=new URLSearchParams;a.append("status",n),r==="REJECT"&&t&&a.append("remarks",t);const s=await De.put(`/api/admissions/${e}/status?${a.toString()}`);return console.log(`Admission ${e} processed with response:`,s),s}catch(n){throw console.error(`Error processing admission ${e}:`,n),n}},createStudentFromAdmission:async(e,r={})=>{console.log(`Creating student from admission ${e}`);const t=await gn.getApplicationById(e);if(!t)throw new Error(`Admission record ${e} not found`);if(t.status!=="APPROVED")throw new Error(`Cannot create student from admission with status ${t.status}`);return{studentId:`STU${new Date().getFullYear()}${Math.floor(1e3+Math.random()*9e3)}`,name:t.studentName,email:t.email,phoneNumber:t.contactNumber,dateOfBirth:t.dateOfBirth,grade:String(parseInt(t.gradeApplying,10)),section:r.section||"A",address:t.address||"",parentName:t.parentName,parentPhone:t.contactNumber,parentEmail:t.email,status:"ACTIVE",admissionDate:new Date().toISOString().split("T")[0],gender:r.gender||"MALE",...r}},hasStudentRecord:async e=>{try{const r=await De.get(`/api/admissions/${e}/student-status`);return r&&r.hasStudent}catch(r){return console.warn(`Error checking if admission ${e} has student record:`,r),!1}},getDebugInfo:async()=>{const e=localStorage.getItem("user"),r=localStorage.getItem("token");let t=null,n=null;try{if(e&&(t=JSON.parse(e)),r){const a=r.split(".");if(a.length===3){const s=JSON.parse(atob(a[1]));n={exp:new Date(s.exp*1e3).toLocaleString(),roles:s.roles||s.authorities||s.role||"Not found in token",sub:s.sub||s.username}}}}catch(a){console.error("Error parsing user/token data",a)}return{user:t,token:r?`${r.substring(0,20)}...`:null,tokenInfo:n,endpoints:{getAllApplications:"/api/admissions",getApplicationById:"/api/admissions/:id",createApplication:"/api/admissions",updateApplication:"/api/admissions/:id",updateStatus:"/api/admissions/:id/status",deleteApplication:"/api/admissions/:id",getByStatus:"/api/admissions/status/:status",searchApplications:"/api/admissions/search?query=:query",getByDateRange:"/api/admissions/date-range",getByGrade:"/api/admissions/grade/:grade",checkStudentStatus:"/api/admissions/:id/student-status"}}}};function mp(e){var n;console.log("Transforming response to application:",e);const r=["PENDING","UNDER_REVIEW","APPROVED","REJECTED","WAITLISTED","CANCELLED","ENROLLED"],t=e.status&&r.includes(e.status)?e.status:"PENDING";return{id:e.id,studentName:e.applicantName,dateOfBirth:e.dateOfBirth,gradeApplying:((n=e.gradeApplying)==null?void 0:n.toString())||"",parentName:e.guardianName,contactNumber:e.contactNumber||e.guardianContact||"",email:e.email||e.guardianEmail||"",address:e.address||"",status:t,submissionDate:e.applicationDate,rejectionReason:e.rejectionReason,previousSchool:e.previousSchool||"",previousGrade:e.previousGrade||"",previousPercentage:e.previousPercentage,documents:e.documents,documentsFormat:e.documentsFormat||""}}const Xd={email:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,phone:/^\+?[\d\s-]{10,}$/,name:/^[a-zA-Z\s-']{2,}$/},u8=e=>Xd.email.test(e),d8=e=>Xd.phone.test(e),xp=e=>Xd.name.test(e),f8=e=>!isNaN(Date.parse(e)),h8=e=>{const r={};return(!e.studentName||!xp(e.studentName))&&(r.studentName="Please enter a valid student name"),(!e.dateOfBirth||!f8(e.dateOfBirth))&&(r.dateOfBirth="Please enter a valid date of birth"),e.gradeApplying||(r.gradeApplying="Grade is required"),(!e.parentName||!xp(e.parentName))&&(r.parentName="Please enter a valid parent/guardian name"),(!e.contactNumber||!d8(e.contactNumber))&&(r.contactNumber="Please enter a valid phone number"),(!e.email||!u8(e.email))&&(r.email="Please enter a valid email address"),(!e.address||e.address.length<10)&&(r.address="Please enter a complete address (minimum 10 characters)"),r},p8=["1","2","3","4","5","6","7","8","9","10","11","12"],m8=["A","B","C","D"],x8=["MALE","FEMALE","OTHER"],g8=["A+","A-","B+","B-","AB+","AB-","O+","O-"],y8=({open:e,onClose:r,onSubmit:t,initialData:n,loading:a})=>{const[s,o]=C.useState(n||{studentName:"",firstName:"",lastName:"",dateOfBirth:"",gradeApplying:"1",section:"A",parentName:"",contactNumber:"",email:"",address:"",gender:"MALE",bloodGroup:"",medicalConditions:"",previousSchool:"",previousGrade:"",previousPercentage:75,status:"PENDING"}),[c,l]=C.useState(!1),[u,d]=C.useState({}),[f,h]=C.useState(!1);C.useEffect(()=>{if(e){const p=(n==null?void 0:n.id)||n&&Object.keys(n).length>0&&n.studentName;if(l(!!p),n&&Object.keys(n).length>0){let g=n.firstName||"",w=n.lastName||"";if((!g||!w)&&n.studentName){const y=n.studentName.split(" ");g=y[0]||"",w=y.length>1?y.slice(1).join(" "):""}o({...n,id:n.id,firstName:g,lastName:w,studentName:n.studentName||"",dateOfBirth:n.dateOfBirth||"",gradeApplying:n.gradeApplying||"1",section:n.section||"A",parentName:n.parentName||"",contactNumber:n.contactNumber||"",email:n.email||"",address:n.address||"",gender:n.gender||"MALE",bloodGroup:n.bloodGroup||"",medicalConditions:n.medicalConditions||"",previousSchool:n.previousSchool||"",previousGrade:n.previousGrade||"",previousPercentage:n.previousPercentage||75,status:n.status||"PENDING"})}else o({studentName:"",firstName:"",lastName:"",dateOfBirth:"",gradeApplying:"1",section:"A",parentName:"",contactNumber:"",email:"",address:"",gender:"MALE",bloodGroup:"",medicalConditions:"",previousSchool:"",previousGrade:"",previousPercentage:75,status:"PENDING"});d({})}},[e,n]),C.useEffect(()=>{if(s.firstName||s.lastName){const p=`${s.firstName||""} ${s.lastName||""}`.trim();o(g=>({...g,studentName:p}))}},[s.firstName,s.lastName]);const x=p=>g=>{o(w=>({...w,[p]:g.target.value})),u[p]&&d(w=>({...w,[p]:""}))},m=()=>{const p={...s,submissionDate:s.submissionDate||new Date().toISOString().split("T")[0]},g=h8(p);if(Object.keys(g).length>0){d(g);return}t(p)};return i.jsx(Yc,{open:e,onClose:r,title:c?"Edit Application":"New Admission Application",onSubmit:m,submitLabel:c?"Update":"Submit",loading:a,maxWidth:"md",fullWidth:!0,children:i.jsxs(X,{container:!0,spacing:3,children:[i.jsx(X,{item:!0,xs:12,children:i.jsxs(Ke,{elevation:1,sx:{p:3,mb:2,borderRadius:2,borderTop:"5px solid #1976d2",bgcolor:"#f5f9ff"},children:[i.jsxs(ye,{sx:{display:"flex",alignItems:"center",mb:3,pb:1,borderBottom:"1px solid #e0e0e0"},children:[i.jsx(_p,{sx:{fontSize:28,mr:1,color:"#1976d2"}}),i.jsx(ee,{variant:"h6",fontWeight:"500",color:"#1976d2",children:"STUDENT INFORMATION"})]}),i.jsxs(X,{container:!0,spacing:2,children:[i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"First Name",value:s.firstName||"",onChange:x("firstName"),error:!!u.firstName,helperText:u.firstName,required:!0})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Last Name",value:s.lastName||"",onChange:x("lastName"),error:!!u.lastName,helperText:u.lastName,required:!0})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Date of Birth",type:"date",value:s.dateOfBirth||"",onChange:x("dateOfBirth"),error:!!u.dateOfBirth,helperText:u.dateOfBirth||"Select date from calendar",InputLabelProps:{shrink:!0},required:!0})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsxs(mt,{fullWidth:!0,required:!0,children:[i.jsx(Tt,{id:"gender-label",children:"Gender"}),i.jsx(gt,{labelId:"gender-label",value:s.gender||"MALE",onChange:x("gender"),label:"Gender",children:x8.map(p=>i.jsx(Ye,{value:p,children:p},p))})]})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,select:!0,label:"Grade Applying",value:s.gradeApplying||"",onChange:x("gradeApplying"),error:!!u.gradeApplying,helperText:u.gradeApplying,required:!0,children:p8.map(p=>i.jsxs(Ye,{value:p,children:["Grade ",p]},p))})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,select:!0,label:"Section",value:s.section||"A",onChange:x("section"),children:m8.map(p=>i.jsxs(Ye,{value:p,children:["Section ",p]},p))})})]})]})}),i.jsx(X,{item:!0,xs:12,children:i.jsxs(Ke,{elevation:1,sx:{p:3,mb:2,borderRadius:2,borderTop:"5px solid #f50057",bgcolor:"#fff9fb"},children:[i.jsxs(ye,{sx:{display:"flex",alignItems:"center",mb:3,pb:1,borderBottom:"1px solid #e0e0e0"},children:[i.jsx(Ws,{sx:{fontSize:28,mr:1,color:"#f50057"}}),i.jsx(ee,{variant:"h6",fontWeight:"500",color:"#f50057",children:"PARENT/GUARDIAN INFORMATION"})]}),i.jsxs(X,{container:!0,spacing:2,children:[i.jsx(X,{item:!0,xs:12,children:i.jsx(Ae,{fullWidth:!0,label:"Parent/Guardian Name",value:s.parentName||"",onChange:x("parentName"),error:!!u.parentName,helperText:u.parentName||"Full name of parent or guardian",required:!0})}),i.jsx(X,{item:!0,xs:12,md:6,children:i.jsxs(ye,{sx:{p:2,border:"1px dashed #f50057",borderRadius:1,mb:2},children:[i.jsx(ee,{variant:"subtitle2",fontWeight:"500",color:"#f50057",sx:{mb:2},children:"Contact Information"}),i.jsxs(vc,{spacing:2,children:[i.jsx(Ae,{fullWidth:!0,label:"Phone Number",value:s.contactNumber||"",onChange:x("contactNumber"),error:!!u.contactNumber,helperText:u.contactNumber||"e.g. +1234567890",required:!0}),i.jsx(Ae,{fullWidth:!0,label:"Email Address",type:"email",value:s.email||"",onChange:x("email"),error:!!u.email,helperText:u.email,required:!0})]})]})}),i.jsx(X,{item:!0,xs:12,md:6,children:i.jsxs(ye,{sx:{p:2,border:"1px dashed #f50057",borderRadius:1},children:[i.jsx(ee,{variant:"subtitle2",fontWeight:"500",color:"#f50057",sx:{mb:2},children:"Residence Information"}),i.jsx(Ae,{fullWidth:!0,label:"Home Address",multiline:!0,rows:4,value:s.address||"",onChange:x("address"),error:!!u.address,helperText:u.address||"Complete residential address",required:!0})]})})]})]})}),i.jsx(X,{item:!0,xs:12,children:i.jsxs(Ke,{elevation:1,sx:{p:3,borderRadius:2,borderTop:"5px solid #4caf50",bgcolor:"#f5fbf5"},children:[i.jsxs(ye,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:1,borderBottom:"1px solid #e0e0e0",mb:2},children:[i.jsxs(ye,{sx:{display:"flex",alignItems:"center"},children:[i.jsx(Qa,{sx:{fontSize:28,mr:1,color:"#4caf50"}}),i.jsx(ee,{variant:"h6",fontWeight:"500",color:"#4caf50",children:"ADDITIONAL INFORMATION"})]}),i.jsx(ee,{variant:"body2",color:"primary",sx:{cursor:"pointer",fontWeight:500,textDecoration:"underline"},onClick:()=>h(!f),children:f?"Hide Additional Fields":"Show More Fields"})]}),f&&i.jsxs(X,{container:!0,spacing:2,children:[i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsxs(Ae,{fullWidth:!0,select:!0,label:"Blood Group",value:s.bloodGroup||"",onChange:x("bloodGroup"),children:[i.jsx(Ye,{value:"",children:"Not Specified"}),g8.map(p=>i.jsx(Ye,{value:p,children:p},p))]})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Medical Conditions",multiline:!0,rows:2,value:s.medicalConditions||"",onChange:x("medicalConditions")})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Previous School",value:s.previousSchool||"",onChange:x("previousSchool")})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Previous Grade",value:s.previousGrade||"",onChange:x("previousGrade")})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Previous Percentage/GPA",type:"number",inputProps:{min:0,max:100,step:.1},value:s.previousPercentage||75,onChange:x("previousPercentage")})})]})]})}),i.jsx(X,{item:!0,xs:12,children:i.jsx(Ja,{sx:{textAlign:"center"},children:"Fields marked with * are required. Submission date will be set automatically."})})]})})},v8=({error:e,onClose:r})=>{const[t,n]=C.useState(!1);return i.jsx("div",{className:"auth-error-dialog",children:i.jsxs("div",{className:"auth-error-content",children:[i.jsx("h3",{children:"Authentication Error"}),i.jsxs("div",{className:"error-message",children:[i.jsx("strong",{children:e.message||"Access Denied"}),i.jsxs("p",{children:["Status code: ",e.status]})]}),e.tokenInfo&&i.jsxs("div",{className:"token-info",children:[i.jsx("h4",{children:"Token Information:"}),i.jsxs("ul",{children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Username:"})," ",e.tokenInfo.username]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Roles:"})," ",e.tokenInfo.roles]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Expiration:"})," ",e.tokenInfo.exp]})]})]}),i.jsxs("div",{className:"troubleshooting",children:[i.jsx("h4",{children:"Troubleshooting:"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Verify you have the required role (ADMIN) for this operation"}),i.jsx("li",{children:"Try logging out and logging back in"}),i.jsx("li",{children:"Check that your token has not expired"})]})]}),i.jsxs("div",{className:"buttons",children:[i.jsx("button",{onClick:()=>n(!t),children:t?"Hide Technical Details":"Show Technical Details"}),i.jsx("button",{onClick:r,children:"Close"})]}),t&&i.jsxs("div",{className:"technical-details",children:[i.jsx("h4",{children:"Technical Details:"}),i.jsx("pre",{children:JSON.stringify(e,null,2)})]})]})})};var Kd={},b8=_t;Object.defineProperty(Kd,"__esModule",{value:!0});var ry=Kd.default=void 0,w8=b8(Ft()),S8=i;ry=Kd.default=(0,w8.default)((0,S8.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit");var Jd={},E8=_t;Object.defineProperty(Jd,"__esModule",{value:!0});var Qd=Jd.default=void 0,T8=E8(Ft()),A8=i;Qd=Jd.default=(0,T8.default)((0,A8.jsx)("path",{d:"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m-9-2V7H4v3H1v2h3v3h2v-3h3v-2zm9 4c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"PersonAdd");var Zd={},k8=_t;Object.defineProperty(Zd,"__esModule",{value:!0});var ny=Zd.default=void 0,C8=k8(Ft()),_8=i;ny=Zd.default=(0,C8.default)((0,_8.jsx)("path",{d:"M4.25 5.61C6.27 8.2 10 13 10 13v6c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-6s3.72-4.8 5.74-7.39c.51-.66.04-1.61-.79-1.61H5.04c-.83 0-1.3.95-.79 1.61"}),"FilterAlt");var ef={},D8=_t;Object.defineProperty(ef,"__esModule",{value:!0});var ay=ef.default=void 0,F8=D8(Ft()),j8=i;ay=ef.default=(0,F8.default)((0,j8.jsx)("path",{d:"M19 9h-4V3H9v6H5l7 7zM5 18v2h14v-2z"}),"FileDownload");var tf={},I8=_t;Object.defineProperty(tf,"__esModule",{value:!0});var sy=tf.default=void 0,P8=I8(Ft()),O8=i;sy=tf.default=(0,P8.default)((0,O8.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Clear");const R8=(e,r,t)=>({id:"actions",label:"Actions",sortable:!1,align:"right",format:(n,a)=>a?i.jsxs(ye,{sx:{display:"flex",alignItems:"center",justifyContent:"flex-end"},children:[e&&i.jsx(st,{title:"Edit",children:i.jsx(Ze,{size:"small",onClick:()=>{a&&e(a)},sx:{mr:.5},children:i.jsx(ry,{fontSize:"small"})})}),r&&a&&i.jsx(Pe,{size:"small",color:"error",onClick:()=>{a&&r(a)},children:"Delete"}),t&&a&&t(a)]}):(console.warn("Action column received undefined row data"),null)}),vi=[{value:"PENDING",label:"Submitted"},{value:"UNDER_REVIEW",label:"Under Review"},{value:"APPROVED",label:"Approved"},{value:"REJECTED",label:"Rejected"},{value:"WAITLISTED",label:"Waitlisted"}],N8=Array.from({length:12},(e,r)=>({value:(r+1).toString(),label:`Grade ${r+1}`})),M8=()=>{const{user:e}=_n(),{showNotification:r}=ln(),[t,n]=C.useState(null),[a,s]=C.useState(!1),[o,c]=C.useState(!1),[l,u]=C.useState(!1),[d,f]=C.useState([]),[h,x]=C.useState(null),[m,p]=C.useState(!1),[g,w]=C.useState(null),[y,v]=C.useState([]),[T,F]=C.useState("PENDING"),[A,S]=C.useState(!1),[E,b]=C.useState(""),[k,j]=C.useState(()=>Promise.resolve()),[_,B]=C.useState(!1),[Q,Z]=C.useState({name:"",grade:[],status:[],dateRange:{start:"",end:""}}),[L,q]=C.useState(!1);C.useEffect(()=>{console.log("🔍 Admissions component mounted"),console.log("👤 User:",e);const M=localStorage.getItem("token");if(M)try{const ce=JSON.parse(atob(M.split(".")[1]));console.log("🔑 Token payload:",{exp:new Date(ce.exp*1e3).toLocaleString(),roles:ce.roles||ce.authorities||ce.role||"Not found in token",sub:ce.sub||ce.username})}catch{console.log("⚠️ Could not parse token")}return gn.getDebugInfo().then(ce=>{console.log("📝 API connection info:",ce)}),()=>{console.log("🔍 Admissions component unmounted")}},[e]);const{data:te,loading:R,error:oe,refresh:J}=Ln(()=>(console.log("🔄 Calling admissionService.getAllApplications() with multiple fallbacks"),console.log("🔑 Current user role:",e==null?void 0:e.role),console.log("🔒 Auth token present:",!!localStorage.getItem("token")),gn.getAllApplications()),{onError:M=>(console.error("❌ Error in useApi for admissions:",M),x(M),[])}),P=C.useMemo(()=>te?L?te.filter(M=>{var Be,Ve,Fe,Ie;const ce=!Q.name||((Be=M.studentName)==null?void 0:Be.toLowerCase().includes(Q.name.toLowerCase()))||((Ve=M.email)==null?void 0:Ve.toLowerCase().includes(Q.name.toLowerCase()))||((Fe=M.parentName)==null?void 0:Fe.toLowerCase().includes(Q.name.toLowerCase())),de=Q.grade.length===0||Q.grade.includes((Ie=M.gradeApplying)==null?void 0:Ie.toString()),Se=Q.status.length===0||Q.status.includes(M.status);let ke=!0;if(Q.dateRange.start||Q.dateRange.end){const We=M.submissionDate?new Date(M.submissionDate):null;if(We){if(Q.dateRange.start){const qe=new Date(Q.dateRange.start);We<qe&&(ke=!1)}if(Q.dateRange.end&&ke){const qe=new Date(Q.dateRange.end);qe.setHours(23,59,59),We>qe&&(ke=!1)}}}return ce&&de&&Se&&ke}):te:[],[te,Q,L]),V=()=>{n({studentName:"",dateOfBirth:"",gradeApplying:"",parentName:"",contactNumber:"",email:"",address:"",status:"PENDING"}),s(!0)},z=async M=>{if(console.log("Edit clicked for application:",M),!M){console.error("Error: Attempted to edit undefined application");return}p(!0);try{const ce={...M,id:M.id,studentName:M.studentName||"",dateOfBirth:M.dateOfBirth||"2005-01-01",gradeApplying:M.gradeApplying||"1",parentName:M.parentName!=="Not available"?M.parentName:"",contactNumber:M.contactNumber||"",email:M.email||"",address:M.address||"",status:M.status||"PENDING"};if(console.log("Enhanced application object for editing:",ce),n(ce),M.id)try{const de=await gn.getApplicationById(M.id);console.log("Retrieved detailed application data:",de),de&&de.studentName&&n(de)}catch(de){console.warn("Could not fetch complete details, using basic data:",de)}}catch(ce){console.error("Error preparing application for edit:",ce),r({type:"warning",message:"Could not load complete application details. Some fields may be missing."})}finally{p(!1),s(!0)}},G=async M=>{var ce,de;try{if(M.id)console.log("Attempting to update application:",M),await gn.updateApplication(M.id,M),r({type:"success",message:"Application updated successfully"});else{console.log("Submitting application data:",M);const Se=[];if(M.studentName||Se.push("Student Name"),M.dateOfBirth||Se.push("Date of Birth"),M.gradeApplying||Se.push("Grade"),M.parentName||Se.push("Parent/Guardian Name"),M.contactNumber||Se.push("Contact Number"),M.email||Se.push("Email"),M.address||Se.push("Address"),Se.length>0)throw new Error(`Missing required fields: ${Se.join(", ")}`);if(!/^\d{4}-\d{2}-\d{2}$/.test(M.dateOfBirth))throw new Error("Date of Birth must be in YYYY-MM-DD format");const Be=await gn.createApplication(M);console.log("Submission successful, response:",Be),r({type:"success",message:"New application created successfully"})}s(!1),J()}catch(Se){if(console.error("Error saving application:",Se),Se.status===403)w(Se);else{let ke=Se.message||"An error occurred while saving the application";if((de=(ce=Se.originalError)==null?void 0:ce.response)!=null&&de.data&&(console.log("Backend validation errors:",Se.originalError.response.data),Se.originalError.response.data.message&&(ke=`Validation error: ${Se.originalError.response.data.message}`),Se.originalError.response.data.errors))try{if(Array.isArray(Se.originalError.response.data.errors))ke=`Validation errors: ${Se.originalError.response.data.errors.map(Ve=>Ve.defaultMessage||Ve.field).join(", ")}`;else if(typeof Se.originalError.response.data.errors=="object"){const Be=Se.originalError.response.data.errors,Ve=[];for(const Fe in Be)Be.hasOwnProperty(Fe)&&Ve.push(`${Fe}: ${Be[Fe]}`);Ve.length>0&&(ke=`Validation errors: ${Ve.join(", ")}`)}}catch(Be){console.error("Error parsing validation errors:",Be)}r({type:"error",message:ke})}}},ne=async(M,ce)=>{try{p(!0);let de="";ce==="REJECTED"&&(de=prompt("Please provide a reason for rejection:")||""),console.log(`Processing admission ${M.id} with status: ${ce}, reason: ${de}`);const Se=ce==="APPROVED"?"APPROVE":"REJECT";if(M.id!==void 0)await gn.processAdmission(M.id,Se,de);else throw new Error("Application ID is undefined");r({type:"success",message:`Application status changed to ${ce.toLowerCase()} successfully`}),J()}catch(de){console.error(`Error updating application status to ${ce}:`,de),de.status===403?w(de):r({type:"error",message:`Failed to update application status: ${de.message}`})}finally{p(!1)}},he=async M=>{try{if(p(!0),M.status!=="APPROVED")if(M.id!==void 0)await gn.processAdmission(M.id,"APPROVE");else throw new Error("Application ID is undefined");if(M.id!==void 0){const ce=await gn.createStudentFromAdmission(M.id)}else throw new Error("Application ID is undefined");r({type:"success",message:"Student created successfully from application"}),J()}catch(ce){console.error("Error creating student from application:",ce),r({type:"error",message:`Failed to create student: ${ce.message||"Unknown error"}`})}finally{p(!1)}},se=(M,ce)=>{v(ce?de=>[...de,M]:de=>de.filter(Se=>Se.id!==M.id))},ae=M=>{v(M&&te?[...te]:[])},K=M=>{F(M.target.value)},O=async()=>{var M;try{p(!0),b(`Are you sure you want to change the status of ${y.length} application(s) to ${((M=vi.find(ce=>ce.value===T))==null?void 0:M.label)||T}?`),j(()=>async()=>{const ce=await Promise.allSettled(y.map(ke=>{if(ke.status===T)return Promise.resolve();const Be=T==="REJECTED"?"Rejected in bulk update":void 0,Ve=T==="APPROVED"?"APPROVE":"REJECT";if(ke.id!==void 0)return gn.processAdmission(ke.id,Ve,Be);throw new Error("Application ID is undefined")})),de=ce.filter(ke=>ke.status==="fulfilled").length,Se=ce.filter(ke=>ke.status==="rejected").length;r({type:Se>0?"warning":"success",message:`Status update complete: ${de} successful, ${Se} failed`}),v([]),J()}),S(!0)}catch(ce){r({type:"error",message:`Failed to process bulk action: ${ce.message||"Unknown error"}`})}finally{p(!1)}},D=(M,ce)=>{ce==="APPROVED"?ne(M,"APPROVED"):ce==="REJECTED"?ne(M,"REJECTED"):(async()=>{try{if(p(!0),M.id!==void 0)await gn.updateStatus(M.id,ce);else throw new Error("Application ID is undefined");r({type:"success",message:`Status updated to ${ce.toLowerCase()}`}),J()}catch(de){r({type:"error",message:`Failed to update status: ${de.message||"Unknown error"}`})}finally{p(!1)}})()},re=(M,ce)=>{Z(de=>({...de,[M]:ce}))},le=()=>{q(!0),B(!1)},Te=()=>{Z({name:"",grade:[],status:[],dateRange:{start:"",end:""}}),q(!1)},ue=()=>{try{const M=L?P:te||[];if(M.length===0){r({type:"warning",message:"No data to export"});return}const Se=[["ID","Student Name","Date of Birth","Email","Contact Number","Parent/Guardian Name","Parent/Guardian Contact","Address","Grade Applying","Previous School","Previous Grade","Previous Percentage","Submission Date","Status"].join(","),...M.map(Fe=>[Fe.id||"",`"${Fe.studentName||""}"`,Fe.dateOfBirth||"",`"${Fe.email||""}"`,Fe.contactNumber||"",`"${Fe.parentName||""}"`,Fe.guardianContact||Fe.contactNumber||"",`"${Fe.address||""}"`,Fe.gradeApplying||"",`"${Fe.previousSchool||""}"`,Fe.previousGrade||"",Fe.previousPercentage||"",Fe.submissionDate?new Date(Fe.submissionDate).toISOString().split("T")[0]:"",Fe.status||"PENDING"].join(","))].join(`
`),ke=new Blob([Se],{type:"text/csv;charset=utf-8;"}),Be=URL.createObjectURL(ke),Ve=document.createElement("a");Ve.setAttribute("href",Be),Ve.setAttribute("download",`admissions_export_${new Date().toISOString().slice(0,10)}.csv`),document.body.appendChild(Ve),Ve.click(),document.body.removeChild(Ve),r({type:"success",message:`Exported ${M.length} records to CSV`})}catch(M){console.error("Error exporting CSV:",M),r({type:"error",message:"Failed to export CSV: "+(M.message||"Unknown error")})}},we=async()=>{u(!0),f([]);const M=[{name:"Get all admissions (singular)",fn:()=>De.get("/admission")},{name:"Get all admissions (plural)",fn:()=>De.get("/admissions")},{name:"Get health check",fn:()=>De.get("/health")},{name:"Get auth status",fn:()=>De.get("/auth/status")}],ce=[];for(const de of M)try{console.log(`🧪 Testing endpoint: ${de.name}`);const Se=await de.fn();ce.push({name:de.name,success:!0,status:"OK",data:Se})}catch(Se){ce.push({name:de.name,success:!1,status:Se.status||"Error",error:Se.message||JSON.stringify(Se)})}f(ce),u(!1)},xe=[{id:"selector",label:"Select",sortable:!1,width:50,format:(M,ce)=>i.jsx(Sf,{checked:y.some(de=>de.id===ce.id),onChange:de=>se(ce,de.target.checked),size:"small"}),renderHeader:()=>i.jsx(Sf,{checked:!!(te&&te.length>0&&y.length===te.length),indeterminate:y.length>0&&y.length<((te==null?void 0:te.length)||0),onChange:M=>ae(M.target.checked),size:"small"})},{id:"id",label:"ID",sortable:!0},{id:"studentName",label:"Student Name",sortable:!0},{id:"gradeApplying",label:"Grade",sortable:!0},{id:"parentName",label:"Parent Name",sortable:!0},{id:"submissionDate",label:"Submitted On",sortable:!0,format:ey},{id:"status",label:"Status",sortable:!0,format:(M,ce)=>i.jsx(Sn,{permission:"MANAGE_ADMISSIONS",children:i.jsx(mt,{size:"small",fullWidth:!0,children:i.jsx(gt,{value:M||"PENDING",onChange:de=>D(ce,de.target.value),displayEmpty:!0,variant:"standard",sx:{"& .MuiSelect-select":{py:0,color:()=>{switch(M==null?void 0:M.toUpperCase()){case"APPROVED":return"success.main";case"REJECTED":return"error.main";case"UNDER_REVIEW":return"info.main";case"WAITLISTED":return"warning.dark";default:return"warning.main"}}}},children:vi.map(de=>i.jsx(Ye,{value:de.value,children:de.label},de.value))})})})},R8(M=>z(M),void 0,M=>i.jsx(Sn,{permission:"MANAGE_ADMISSIONS",children:i.jsx(st,{title:"Create Student",children:i.jsx(Ze,{size:"small",onClick:()=>he(M),color:"secondary",children:i.jsx(Qd,{fontSize:"small"})})})}))],Ce=()=>i.jsxs(br,{open:_,onClose:()=>B(!1),maxWidth:"md",fullWidth:!0,children:[i.jsx(Br,{children:"Filter Admissions"}),i.jsx(Dr,{children:i.jsxs(X,{container:!0,spacing:3,sx:{mt:.5},children:[i.jsx(X,{item:!0,xs:12,children:i.jsx(Ae,{label:"Search by Name or Email",fullWidth:!0,value:Q.name,onChange:M=>re("name",M.target.value),placeholder:"Enter student name, email, or parent name",variant:"outlined"})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsxs(mt,{fullWidth:!0,children:[i.jsx(Tt,{id:"grade-filter-label",children:"Filter by Grade"}),i.jsx(gt,{labelId:"grade-filter-label",multiple:!0,value:Q.grade,onChange:M=>re("grade",M.target.value),input:i.jsx(Ef,{label:"Filter by Grade"}),renderValue:M=>i.jsx(ye,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:M.map(ce=>i.jsx($t,{label:`Grade ${ce}`,size:"small"},ce))}),children:N8.map(M=>i.jsx(Ye,{value:M.value,children:M.label},M.value))})]})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsxs(mt,{fullWidth:!0,children:[i.jsx(Tt,{id:"status-filter-label",children:"Filter by Status"}),i.jsx(gt,{labelId:"status-filter-label",multiple:!0,value:Q.status,onChange:M=>re("status",M.target.value),input:i.jsx(Ef,{label:"Filter by Status"}),renderValue:M=>i.jsx(ye,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:M.map(ce=>{var de;return i.jsx($t,{label:((de=vi.find(Se=>Se.value===ce))==null?void 0:de.label)||ce,size:"small"},ce)})}),children:vi.map(M=>i.jsx(Ye,{value:M.value,children:M.label},M.value))})]})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{label:"Date Range From",type:"date",InputLabelProps:{shrink:!0},fullWidth:!0,value:Q.dateRange.start,onChange:M=>re("dateRange",{...Q.dateRange,start:M.target.value})})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{label:"Date Range To",type:"date",InputLabelProps:{shrink:!0},fullWidth:!0,value:Q.dateRange.end,onChange:M=>re("dateRange",{...Q.dateRange,end:M.target.value})})})]})}),i.jsxs(_r,{children:[i.jsx(Pe,{onClick:Te,color:"secondary",children:"Clear All Filters"}),i.jsx(Pe,{onClick:()=>B(!1),children:"Cancel"}),i.jsx(Pe,{onClick:le,variant:"contained",color:"primary",children:"Apply Filters"})]})]}),Oe=()=>i.jsxs(br,{open:A,onClose:()=>S(!1),children:[i.jsx(Br,{children:"Confirm Action"}),i.jsx(Dr,{children:i.jsx(ee,{children:E})}),i.jsxs(_r,{children:[i.jsx(Pe,{onClick:()=>S(!1),children:"Cancel"}),i.jsx(Pe,{onClick:async()=>{S(!1),await k()},color:"primary",variant:"contained",autoFocus:!0,children:"Confirm"})]})]}),ze=()=>i.jsxs(br,{open:o,onClose:()=>c(!1),maxWidth:"md",fullWidth:!0,children:[i.jsx(Br,{children:"API Endpoint Diagnostics"}),i.jsxs(Dr,{children:[i.jsx(ee,{variant:"body2",gutterBottom:!0,children:"Testing different API endpoints to find which one works with your backend."}),l&&i.jsx(ye,{sx:{display:"flex",justifyContent:"center",my:4},children:i.jsx(sn,{})}),d.length>0&&i.jsx(qa,{children:d.map((M,ce)=>i.jsxs(An.Fragment,{children:[ce>0&&i.jsx(sr,{}),i.jsx(Xa,{children:i.jsx(Ka,{primary:`${M.name} - ${M.success?"✅ Success":"❌ Failed"} (${M.status})`,secondary:i.jsx(ye,{component:"pre",sx:{mt:1,p:1,bgcolor:"grey.100",borderRadius:1,fontSize:"0.75rem",overflow:"auto",maxHeight:200},children:M.success?JSON.stringify(M.data,null,2):M.error?`Error: ${M.error}`:"No response data"})})})]},ce))}),i.jsxs(ye,{sx:{mt:3},children:[i.jsx(ee,{variant:"h6",gutterBottom:!0,children:"Authentication Information"}),i.jsxs(Ke,{sx:{p:2},children:[i.jsxs(ee,{variant:"body2",children:[i.jsx("strong",{children:"User:"})," ",e?JSON.stringify(e):"Not logged in"]}),i.jsxs(ee,{variant:"body2",children:[i.jsx("strong",{children:"Token present:"})," ",localStorage.getItem("token")?"Yes":"No"]}),i.jsxs(ee,{variant:"body2",children:[i.jsx("strong",{children:"API URL:"})," ",bt.apiUrl]})]})]})]}),i.jsxs(_r,{children:[i.jsx(Pe,{onClick:we,disabled:l,color:"primary",children:"Run API Tests"}),i.jsx(Pe,{onClick:()=>c(!1),color:"secondary",children:"Close"})]})]});return R?i.jsx(an,{}):oe?i.jsxs(ye,{sx:{p:3},children:[i.jsx(on,{title:"Error Loading Admissions",message:typeof oe=="string"?oe:oe.message||"Couldn't load admissions data"}),i.jsxs(ye,{sx:{mt:3,display:"flex",gap:2},children:[i.jsx(Pe,{variant:"contained",onClick:J,children:"Try Again"}),i.jsx(Pe,{variant:"outlined",color:"secondary",onClick:()=>c(!0),children:"Diagnostics"})]}),h&&i.jsxs(Ke,{elevation:0,variant:"outlined",sx:{p:3,mt:4},children:[i.jsxs(Lr,{severity:"error",sx:{mb:2},children:[i.jsxs(Li,{children:["HTTP Status: ",h.status||"Unknown"]}),h.message]}),i.jsx(ee,{variant:"subtitle1",children:"Debug Information:"}),i.jsx(ye,{component:"pre",sx:{p:2,bgcolor:"grey.100",borderRadius:1,overflowX:"auto"},children:JSON.stringify(h.originalError||h,null,2)}),i.jsxs(ye,{sx:{mt:2},children:[i.jsx(ee,{variant:"subtitle2",gutterBottom:!0,children:"Possible Solutions:"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Verify the API endpoint path is correct"}),i.jsx("li",{children:"Check that your user account has permission to access admissions"}),i.jsx("li",{children:"Ensure your authentication token is valid and not expired"}),i.jsx("li",{children:"Verify the backend server is running and accessible"})]})]})]}),ze()]}):i.jsxs(ye,{sx:{p:3},children:[i.jsxs(ye,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[i.jsx(ee,{variant:"h4",component:"h1",children:"Admission Applications"}),i.jsxs(ye,{sx:{display:"flex",gap:1},children:[i.jsx(st,{title:"Export to CSV",children:i.jsx(Ze,{color:"primary",onClick:ue,disabled:(!P||P.length===0)&&(!te||te.length===0),children:i.jsx(ay,{})})}),i.jsx(st,{title:L?"Edit Filters":"Filter Applications",children:i.jsx(Ze,{color:L?"secondary":"default",onClick:()=>B(!0),children:i.jsx(ny,{})})}),L&&i.jsx(st,{title:"Clear All Filters",children:i.jsx(Ze,{color:"error",onClick:Te,children:i.jsx(sy,{})})}),i.jsx(Pe,{variant:"text",color:"secondary",onClick:()=>c(!0),sx:{ml:1},children:"Debug"}),i.jsx(Sn,{permission:"MANAGE_ADMISSIONS",children:i.jsx(Pe,{variant:"contained",onClick:V,children:"New Application"})})]})]}),L&&i.jsxs(Ke,{sx:{p:1.5,mb:2,bgcolor:"background.default",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[i.jsxs(ye,{sx:{display:"flex",alignItems:"center",flexWrap:"wrap",gap:1},children:[i.jsx(ee,{variant:"body2",sx:{fontWeight:"medium",mr:1},children:"Filters:"}),Q.name&&i.jsx($t,{label:`Search: "${Q.name}"`,size:"small",onDelete:()=>re("name",""),color:"primary",variant:"outlined"}),Q.status.length>0&&i.jsx($t,{label:`Status: ${Q.status.length} selected`,size:"small",onDelete:()=>re("status",[]),color:"primary",variant:"outlined"}),Q.grade.length>0&&i.jsx($t,{label:`Grade: ${Q.grade.length} selected`,size:"small",onDelete:()=>re("grade",[]),color:"primary",variant:"outlined"}),(Q.dateRange.start||Q.dateRange.end)&&i.jsx($t,{label:`Date Range: ${Q.dateRange.start||"Any"} to ${Q.dateRange.end||"Any"}`,size:"small",onDelete:()=>re("dateRange",{start:"",end:""}),color:"primary",variant:"outlined"})]}),i.jsxs(ee,{variant:"body2",sx:{ml:2,color:"text.secondary"},children:[P.length," record",P.length!==1?"s":""," found"]})]}),y.length>0&&i.jsxs(Ke,{sx:{p:2,mb:3,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[i.jsxs(ye,{sx:{display:"flex",alignItems:"center"},children:[i.jsxs(ee,{variant:"body1",sx:{mr:2},children:[y.length," application(s) selected"]}),i.jsxs(mt,{size:"small",sx:{minWidth:200,mr:2},children:[i.jsx(Tt,{id:"bulk-status-select-label",children:"Change Status To"}),i.jsx(gt,{labelId:"bulk-status-select-label",id:"bulk-status-select",value:T,label:"Change Status To",onChange:K,children:vi.map(M=>i.jsx(Ye,{value:M.value,children:M.label},M.value))})]}),i.jsx(Pe,{variant:"contained",onClick:O,disabled:m||y.length===0,children:"Apply Status Change"})]}),i.jsx(Pe,{variant:"outlined",onClick:()=>v([]),color:"secondary",children:"Clear Selection"})]}),"      ",i.jsx(zc,{columns:xe,data:P||[],defaultRowsPerPage:10}),ze(),Oe(),Ce(),i.jsx(y8,{open:a,onClose:()=>s(!1),onSubmit:G,initialData:t||void 0,loading:m}),g&&i.jsx(v8,{error:g,onClose:()=>w(null)})]})},L8=({transportRoutes:e,onEdit:r,onDelete:t,onRefresh:n})=>!e||e.length===0?i.jsxs(ye,{sx:{p:2,textAlign:"center"},children:[i.jsx(ee,{variant:"body1",color:"text.secondary",children:"No transport routes available."}),i.jsx(Ze,{onClick:n,sx:{mt:1},color:"primary",children:i.jsx(Za,{})})]}):i.jsxs(Ke,{sx:{width:"100%",overflow:"hidden"},children:[i.jsx(ye,{sx:{display:"flex",justifyContent:"flex-end",p:1},children:i.jsx(st,{title:"Refresh",children:i.jsx(Ze,{onClick:n,children:i.jsx(Za,{})})})}),i.jsx(rs,{sx:{maxHeight:440},children:i.jsxs(ya,{stickyHeader:!0,"aria-label":"transport routes table",children:[i.jsx(va,{children:i.jsxs(Ut,{children:[i.jsx(Re,{children:"ID"}),i.jsx(Re,{children:"Route Name"}),i.jsx(Re,{children:"Description"}),i.jsx(Re,{children:"Fee Amount"}),i.jsx(Re,{children:"Actions"})]})}),i.jsx(ba,{children:e.map(a=>{var s;return i.jsxs(Ut,{children:[i.jsx(Re,{children:a.id}),i.jsx(Re,{children:a.routeName}),i.jsx(Re,{children:a.routeDescription}),i.jsxs(Re,{children:["$",(s=a.feeAmount)==null?void 0:s.toFixed(2)]}),i.jsxs(Re,{children:[i.jsx(st,{title:"Edit",children:i.jsx(Ze,{size:"small",onClick:()=>a.id&&r(a.id),children:i.jsx(ro,{fontSize:"small"})})}),i.jsx(st,{title:"Delete",children:i.jsx(Ze,{size:"small",onClick:()=>a.id&&t(a.id),children:i.jsx(Qs,{fontSize:"small"})})})]})]},a.id)})})]})})]}),B8=({feeStructures:e,onEdit:r,onDelete:t,onRefresh:n})=>!e||e.length===0?i.jsxs(ye,{sx:{p:2,textAlign:"center"},children:[i.jsx(ee,{variant:"body1",color:"text.secondary",children:"No fee structures available."}),i.jsx(Ze,{onClick:n,sx:{mt:1},color:"primary",children:i.jsx(Za,{})})]}):i.jsxs(Ke,{sx:{width:"100%",overflow:"hidden"},children:[i.jsx(ye,{sx:{display:"flex",justifyContent:"flex-end",p:1},children:i.jsx(st,{title:"Refresh",children:i.jsx(Ze,{onClick:n,children:i.jsx(Za,{})})})}),i.jsx(rs,{sx:{maxHeight:440},children:i.jsxs(ya,{stickyHeader:!0,"aria-label":"fee structures table",children:[i.jsx(va,{children:i.jsxs(Ut,{children:[i.jsx(Re,{children:"ID"}),i.jsx(Re,{children:"Class Grade"}),i.jsx(Re,{children:"Annual Fees"}),i.jsx(Re,{children:"Building Fees"}),i.jsx(Re,{children:"Lab Fees"}),i.jsx(Re,{children:"Total Fees"}),i.jsx(Re,{children:"Actions"})]})}),i.jsx(ba,{children:e.map(a=>{var s,o,c,l;return i.jsxs(Ut,{children:[i.jsx(Re,{children:a.id}),i.jsx(Re,{children:a.classGrade}),i.jsxs(Re,{children:["$",(s=a.annualFees)==null?void 0:s.toFixed(2)]}),i.jsxs(Re,{children:["$",(o=a.buildingFees)==null?void 0:o.toFixed(2)]}),i.jsxs(Re,{children:["$",(c=a.labFees)==null?void 0:c.toFixed(2)]}),i.jsxs(Re,{children:["$",(l=a.totalFees)==null?void 0:l.toFixed(2)]}),i.jsxs(Re,{children:[i.jsx(st,{title:"Edit",children:i.jsx(Ze,{size:"small",onClick:()=>a.id&&r(a.id),children:i.jsx(ro,{fontSize:"small"})})}),i.jsx(st,{title:"Delete",children:i.jsx(Ze,{size:"small",onClick:()=>a.id&&t(a.id),children:i.jsx(Qs,{fontSize:"small"})})})]})]},a.id)})})]})})]});function jl(e){const{children:r,value:t,index:n,...a}=e;return i.jsx("div",{role:"tabpanel",hidden:t!==n,id:`fee-dialog-tabpanel-${n}`,"aria-labelledby":`fee-dialog-tab-${n}`,...a,children:t===n&&i.jsx(ye,{sx:{pt:2},children:r})})}const $8=({open:e,onClose:r,onSubmit:t,initialData:n,loading:a})=>{const s=!!(n!=null&&n.id),[o,c]=C.useState(0),[l,u]=C.useState({classGrade:0,annualFees:0,buildingFees:0,labFees:0,paymentSchedules:[],lateFees:[]}),[d,f]=C.useState({});C.useEffect(()=>{u(n?{id:n.id,classGrade:n.classGrade,annualFees:n.annualFees,buildingFees:n.buildingFees,labFees:n.labFees,paymentSchedules:n.paymentSchedules||[],lateFees:n.lateFees||[],totalFees:n.totalFees}:{classGrade:1,annualFees:0,buildingFees:0,labFees:0,paymentSchedules:[{scheduleType:"MONTHLY",amount:0,isEnabled:!0},{scheduleType:"QUARTERLY",amount:0,isEnabled:!0},{scheduleType:"YEARLY",amount:0,isEnabled:!0}],lateFees:[]}),c(0)},[n,e]);const h=(S,E)=>{c(E)},x=S=>E=>{const b=E.target.type==="number"?Number(E.target.value):E.target.value;u(k=>({...k,[S]:b})),d[S]&&f(k=>({...k,[S]:""}))},m=(S,E,b)=>{const k=[...l.paymentSchedules];k[S]={...k[S],[E]:b},u(j=>({...j,paymentSchedules:k}))},p=(S,E,b)=>{const k=[...l.lateFees];k[S]={...k[S],[E]:b},u(j=>({...j,lateFees:k}))},g=()=>{u(S=>({...S,lateFees:[...S.lateFees,{month:1,lateFeeAmount:0,lateFeeDescription:"",fineAmount:0,fineDescription:""}]}))},w=S=>{const E=[...l.lateFees];E.splice(S,1),u(b=>({...b,lateFees:E}))},y=S=>{const E=l.paymentSchedules.map(b=>{let k=0;switch(b.scheduleType){case"MONTHLY":k=parseFloat((S/12).toFixed(2));break;case"QUARTERLY":k=parseFloat((S/4).toFixed(2));break;case"YEARLY":k=S;break}return{...b,amount:k}});u(b=>({...b,paymentSchedules:E}))},v=S=>{const E=Number(S.target.value);u(b=>({...b,annualFees:E})),y(E)},T=()=>{const S={};return l.classGrade||(S.classGrade="Class/Grade is required"),l.annualFees<0&&(S.annualFees="Annual fees cannot be negative"),l.buildingFees<0&&(S.buildingFees="Building fees cannot be negative"),l.labFees<0&&(S.labFees="Lab fees cannot be negative"),l.paymentSchedules.some(E=>E.isEnabled)||(S.paymentSchedules="At least one payment schedule must be enabled"),f(S),Object.keys(S).length===0},F=()=>{T()&&t(l)},A=S=>["January","February","March","April","May","June","July","August","September","October","November","December"][S-1]||"";return i.jsxs(br,{open:e,onClose:r,fullWidth:!0,maxWidth:"md","aria-labelledby":"fee-structure-dialog-title",children:[i.jsx(Br,{id:"fee-structure-dialog-title",children:n?"Edit Fee Structure":"Create Fee Structure"}),i.jsxs(Dr,{children:[i.jsx(ye,{sx:{borderBottom:1,borderColor:"divider",mb:2},children:i.jsxs(Su,{value:o,onChange:h,"aria-label":"fee structure tabs",children:[i.jsx(ma,{label:"Basic Information"}),i.jsx(ma,{label:"Payment Schedules"}),i.jsx(ma,{label:"Late Fees & Fines"})]})}),i.jsx(jl,{value:o,index:0,children:i.jsxs(X,{container:!0,spacing:3,children:[i.jsx(X,{item:!0,xs:12,sm:4,children:i.jsx(Ae,{fullWidth:!0,required:!0,label:"Class/Grade",type:"number",value:l.classGrade,onChange:x("classGrade"),InputProps:{inputProps:{min:1,max:12}},disabled:s,error:!!d.classGrade,helperText:d.classGrade})}),i.jsx(X,{item:!0,xs:12,sm:8,children:i.jsx(Ae,{fullWidth:!0,required:!0,label:"Annual Fees",type:"number",value:l.annualFees,onChange:v,InputProps:{startAdornment:i.jsx(yn,{position:"start",children:"₹"}),inputProps:{min:0}},error:!!d.annualFees,helperText:d.annualFees})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Building Fees",type:"number",value:l.buildingFees,onChange:x("buildingFees"),InputProps:{startAdornment:i.jsx(yn,{position:"start",children:"₹"}),inputProps:{min:0}},error:!!d.buildingFees,helperText:d.buildingFees})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Lab Fees",type:"number",value:l.labFees,onChange:x("labFees"),InputProps:{startAdornment:i.jsx(yn,{position:"start",children:"₹"}),inputProps:{min:0}},error:!!d.labFees,helperText:d.labFees})}),i.jsx(X,{item:!0,xs:12,children:i.jsxs(ee,{variant:"subtitle1",color:"text.secondary",children:["Total Fees: ₹",(Number(l.annualFees)+Number(l.buildingFees)+Number(l.labFees)).toLocaleString()]})})]})}),i.jsxs(jl,{value:o,index:1,children:[i.jsx(ee,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Configure payment schedules and amounts. Enable or disable payment options as needed."}),d.paymentSchedules&&i.jsx(Ja,{error:!0,children:d.paymentSchedules}),i.jsx(X,{container:!0,spacing:3,sx:{mt:1},children:l.paymentSchedules.map((S,E)=>i.jsx(X,{item:!0,xs:12,children:i.jsx(es,{variant:"outlined",children:i.jsx(ts,{children:i.jsxs(X,{container:!0,spacing:2,alignItems:"center",children:[i.jsx(X,{item:!0,xs:12,sm:3,children:i.jsxs(ee,{variant:"subtitle1",children:[S.scheduleType.charAt(0)+S.scheduleType.slice(1).toLowerCase()," Payment"]})}),i.jsx(X,{item:!0,xs:12,sm:5,children:i.jsx(Ae,{fullWidth:!0,label:"Amount",type:"number",value:S.amount,onChange:b=>m(E,"amount",Number(b.target.value)),InputProps:{startAdornment:i.jsx(yn,{position:"start",children:"₹"}),inputProps:{min:0}}})}),i.jsx(X,{item:!0,xs:12,sm:4,children:i.jsx(Rl,{control:i.jsx(Nl,{checked:S.isEnabled,onChange:b=>m(E,"isEnabled",b.target.checked),color:"primary"}),label:"Enable this payment option"})})]})})})},E))})]}),i.jsxs(jl,{value:o,index:2,children:[i.jsxs(ye,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[i.jsx(ee,{variant:"subtitle1",children:"Define late fees and fines for specific months"}),i.jsx(Pe,{variant:"outlined",startIcon:i.jsx(zs,{}),onClick:g,children:"Add Late Fee"})]}),l.lateFees.length===0?i.jsx(ee,{variant:"body2",color:"text.secondary",sx:{my:4,textAlign:"center"},children:'No late fees or fines defined. Click "Add Late Fee" to create one.'}):l.lateFees.map((S,E)=>i.jsxs(es,{variant:"outlined",sx:{mb:2},children:[i.jsx(Gy,{title:`Late Fee for ${A(S.month)}`,action:i.jsx(Ze,{onClick:()=>w(E),color:"error",size:"small",children:i.jsx(Qs,{})})}),i.jsx(ts,{children:i.jsxs(X,{container:!0,spacing:2,children:[i.jsx(X,{item:!0,xs:12,sm:4,children:i.jsxs(mt,{fullWidth:!0,children:[i.jsx(Tt,{children:"Month"}),i.jsx(gt,{value:S.month,label:"Month",onChange:b=>p(E,"month",b.target.value),children:Array.from({length:12},(b,k)=>k+1).map(b=>i.jsx(Ye,{value:b,children:A(b)},b))})]})}),i.jsx(X,{item:!0,xs:12,sm:4,children:i.jsx(Ae,{fullWidth:!0,label:"Late Fee Amount",type:"number",value:S.lateFeeAmount,onChange:b=>p(E,"lateFeeAmount",Number(b.target.value)),InputProps:{startAdornment:i.jsx(yn,{position:"start",children:"₹"}),inputProps:{min:0}}})}),i.jsx(X,{item:!0,xs:12,sm:4,children:i.jsx(Ae,{fullWidth:!0,label:"Fine Amount",type:"number",value:S.fineAmount,onChange:b=>p(E,"fineAmount",Number(b.target.value)),InputProps:{startAdornment:i.jsx(yn,{position:"start",children:"₹"}),inputProps:{min:0}}})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Late Fee Description",value:S.lateFeeDescription,onChange:b=>p(E,"lateFeeDescription",b.target.value)})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Fine Description",value:S.fineDescription,onChange:b=>p(E,"fineDescription",b.target.value)})})]})})]},E))]})]}),i.jsxs(_r,{children:[i.jsx(Pe,{onClick:r,children:"Cancel"}),i.jsx(Pe,{onClick:F,variant:"contained",color:"primary",disabled:a,children:a?"Saving...":s?"Update":"Create"})]})]})},U8=({open:e,onClose:r,onSubmit:t,initialData:n,loading:a})=>{const s=!!(n!=null&&n.id),[o,c]=C.useState({routeName:"",routeDescription:"",feeAmount:0}),[l,u]=C.useState({});C.useEffect(()=>{c(n?{id:n.id,routeName:n.routeName,routeDescription:n.routeDescription,feeAmount:n.feeAmount}:{routeName:"",routeDescription:"",feeAmount:0})},[n,e]);const d=x=>m=>{const p=x==="feeAmount"?Number(m.target.value):m.target.value;c(g=>({...g,[x]:p})),l[x]&&u(g=>({...g,[x]:""}))},f=()=>{const x={};return o.routeName.trim()||(x.routeName="Route name is required"),o.feeAmount<0&&(x.feeAmount="Fee amount cannot be negative"),u(x),Object.keys(x).length===0},h=()=>{f()&&t(o)};return i.jsxs(br,{open:e,onClose:r,fullWidth:!0,maxWidth:"sm","aria-labelledby":"transport-route-dialog-title",children:[i.jsx(Br,{id:"transport-route-dialog-title",children:n?"Edit Transport Route":"Create Transport Route"}),i.jsx(Dr,{children:i.jsxs(X,{container:!0,spacing:3,sx:{mt:.5},children:[i.jsx(X,{item:!0,xs:12,children:i.jsx(Ae,{fullWidth:!0,required:!0,label:"Route Name",value:o.routeName,onChange:d("routeName"),error:!!l.routeName,helperText:l.routeName})}),i.jsx(X,{item:!0,xs:12,children:i.jsx(Ae,{fullWidth:!0,label:"Route Description",multiline:!0,rows:2,value:o.routeDescription,onChange:d("routeDescription")})}),i.jsx(X,{item:!0,xs:12,children:i.jsx(Ae,{fullWidth:!0,required:!0,label:"Fee Amount",type:"number",value:o.feeAmount,onChange:d("feeAmount"),InputProps:{startAdornment:i.jsx(yn,{position:"start",children:"₹"}),inputProps:{min:0}},error:!!l.feeAmount,helperText:l.feeAmount})})]})}),i.jsxs(_r,{children:[i.jsx(Pe,{onClick:r,children:"Cancel"}),i.jsx(Pe,{onClick:h,variant:"contained",color:"primary",disabled:a,children:a?"Saving...":s?"Update":"Create"})]})]})},V8=({payments:e,onViewReceipt:r,onDownloadReceipt:t,onVoidPayment:n,isAdmin:a=!1})=>{var y;const[s,o]=C.useState(0),[c,l]=C.useState(5),[u,d]=C.useState(null),[f,h]=C.useState(!1),x=(v,T)=>{o(T)},m=v=>{l(parseInt(v.target.value,10)),o(0)},p=v=>{d(v),h(!0)},g=()=>{h(!1)},w=v=>{let T="default";switch(v){case"COMPLETED":T="success";break;case"PENDING":T="warning";break;case"FAILED":T="error";break;case"VOID":T="default";break}return i.jsx($t,{size:"small",label:v,color:T})};return i.jsxs(i.Fragment,{children:[i.jsxs(rs,{component:Ke,elevation:1,children:[i.jsxs(ya,{size:"small",children:[i.jsx(va,{children:i.jsxs(Ut,{children:[i.jsx(Re,{children:"Receipt #"}),i.jsx(Re,{children:"Date"}),i.jsx(Re,{children:"Amount"}),i.jsx(Re,{children:"Method"}),i.jsx(Re,{children:"Status"}),i.jsx(Re,{align:"right",children:"Actions"})]})}),i.jsx(ba,{children:e.length===0?i.jsx(Ut,{children:i.jsx(Re,{colSpan:6,align:"center",children:i.jsx(ee,{variant:"body2",color:"textSecondary",children:"No payment records found"})})}):e.slice(s*c,s*c+c).map(v=>i.jsxs(Ut,{children:[i.jsx(Re,{children:v.receiptNumber||"-"}),i.jsx(Re,{children:v.paymentDate?qs(new Date(v.paymentDate),"dd MMM yyyy"):"-"}),i.jsxs(Re,{children:["₹",v.amountPaid.toLocaleString()]}),i.jsx(Re,{children:v.paymentMethod}),i.jsx(Re,{children:w(v.paymentStatus)}),i.jsxs(Re,{align:"right",children:[i.jsx(st,{title:"View Details",children:i.jsx(Ze,{size:"small",onClick:()=>p(v),children:i.jsx(Yy,{fontSize:"small"})})}),i.jsx(st,{title:"View Receipt",children:i.jsx(Ze,{size:"small",onClick:()=>r(v.id),disabled:v.paymentStatus==="VOID",children:i.jsx(yc,{fontSize:"small"})})}),i.jsx(st,{title:"Download Receipt",children:i.jsx(Ze,{size:"small",onClick:()=>t(v.id),disabled:v.paymentStatus==="VOID",children:i.jsx(Yo,{fontSize:"small"})})}),a&&n&&v.paymentStatus!=="VOID"&&i.jsx(st,{title:"Void Payment",children:i.jsx(Ze,{size:"small",onClick:()=>n(v.id),color:"error",children:i.jsx(qy,{fontSize:"small"})})})]})]},v.id))})]}),e.length>0&&i.jsx(Dp,{rowsPerPageOptions:[5,10,25],component:"div",count:e.length,rowsPerPage:c,page:s,onPageChange:x,onRowsPerPageChange:m})]}),i.jsx(br,{open:f,onClose:g,maxWidth:"sm",fullWidth:!0,children:u&&i.jsxs(i.Fragment,{children:[i.jsxs(ye,{sx:{p:3},children:[i.jsx(ee,{variant:"h6",gutterBottom:!0,children:"Payment Details"}),i.jsxs(ye,{sx:{mt:2},children:[i.jsx(ee,{variant:"subtitle2",color:"textSecondary",children:"Receipt Number"}),i.jsx(ee,{variant:"body1",gutterBottom:!0,children:u.receiptNumber||"N/A"}),i.jsx(ee,{variant:"subtitle2",color:"textSecondary",children:"Academic Year/Term"}),i.jsxs(ee,{variant:"body1",gutterBottom:!0,children:[u.academicYear," (",u.academicTerm,")"]}),i.jsx(ee,{variant:"subtitle2",color:"textSecondary",children:"Payment Date"}),i.jsx(ee,{variant:"body1",gutterBottom:!0,children:qs(new Date(u.paymentDate),"dd MMMM yyyy")}),i.jsx(ee,{variant:"subtitle2",color:"textSecondary",children:"Payment Method"}),i.jsxs(ee,{variant:"body1",gutterBottom:!0,children:[u.paymentMethod,u.transactionReference&&` (Ref: ${u.transactionReference})`]}),i.jsx(ee,{variant:"subtitle2",color:"textSecondary",children:"Amount Paid"}),i.jsxs(ee,{variant:"h6",color:"primary",gutterBottom:!0,children:["₹",u.amountPaid.toLocaleString()]}),u.notes&&i.jsxs(i.Fragment,{children:[i.jsx(ee,{variant:"subtitle2",color:"textSecondary",children:"Notes"}),i.jsx(ee,{variant:"body2",gutterBottom:!0,children:u.notes})]}),i.jsx(ee,{variant:"subtitle2",color:"textSecondary",sx:{mt:2},children:"Fee Breakdown"}),i.jsxs(ya,{size:"small",sx:{mt:1},children:[i.jsx(va,{children:i.jsxs(Ut,{children:[i.jsx(Re,{children:"Fee Type"}),i.jsx(Re,{children:"Description"}),i.jsx(Re,{align:"right",children:"Amount"})]})}),"                  ",i.jsx(ba,{children:(y=u.feeBreakdown)==null?void 0:y.map((v,T)=>i.jsxs(Ut,{children:[i.jsx(Re,{children:v.feeType}),i.jsx(Re,{children:v.description||"-"}),i.jsxs(Re,{align:"right",children:["₹",v.amount.toLocaleString()]})]},T))})]})]})]}),i.jsxs(ye,{sx:{display:"flex",justifyContent:"flex-end",p:2},children:[i.jsx(Pe,{onClick:g,children:"Close"}),i.jsx(Pe,{startIcon:i.jsx(Yo,{}),onClick:()=>t(u.id),disabled:u.paymentStatus==="VOID",sx:{ml:1},children:"Download Receipt"})]})]})})]})};var iy={exports:{}};(function(e,r){(function(t,n){e.exports=n(C)})(typeof self<"u"?self:Np,function(t){return function(){var n={155:function(w){w.exports=t}},a={};function s(w){var y=a[w];if(y!==void 0)return y.exports;var v=a[w]={exports:{}};return n[w](v,v.exports,s),v.exports}s.d=function(w,y){for(var v in y)s.o(y,v)&&!s.o(w,v)&&Object.defineProperty(w,v,{enumerable:!0,get:y[v]})},s.o=function(w,y){return Object.prototype.hasOwnProperty.call(w,y)},s.r=function(w){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(w,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(w,"__esModule",{value:!0})};var o={};s.r(o),s.d(o,{useReactToPrint:function(){return g}});var c=s(155);function l({level:w="error",messages:y,suppressErrors:v=!1}){v||(w==="error"?console.error(y):w==="warning"?console.warn(y):console.debug(y))}function u(w,y){if(y||!w){const v=document.getElementById("printWindow");v&&document.body.removeChild(v)}}function d(w){return w instanceof Error?w:new Error("Unknown Error")}function f(w,y){const{documentTitle:v,onAfterPrint:T,onPrintError:F,preserveAfterPrint:A,print:S,suppressErrors:E}=y;setTimeout(()=>{var b,k;if(w.contentWindow){let j=function(){T==null||T(),u(A)};if(w.contentWindow.focus(),S)S(w).then(j).catch(_=>{F?F("print",d(_)):l({messages:["An error was thrown by the specified `print` function"],suppressErrors:E})});else{if(w.contentWindow.print){const _=(k=(b=w.contentDocument)===null||b===void 0?void 0:b.title)!==null&&k!==void 0?k:"",B=w.ownerDocument.title;v&&(w.ownerDocument.title=v,w.contentDocument&&(w.contentDocument.title=v)),w.contentWindow.print(),v&&(w.ownerDocument.title=B,w.contentDocument&&(w.contentDocument.title=_))}else l({messages:["Printing for this browser is not currently possible: the browser does not have a `print` method available for iframes."],suppressErrors:E});[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i].some(_=>{var B,Q;return((Q=(B=navigator.userAgent)!==null&&B!==void 0?B:navigator.vendor)!==null&&Q!==void 0?Q:"opera"in window&&window.opera).match(_)})?setTimeout(j,500):j()}}else l({messages:["Printing failed because the `contentWindow` of the print iframe did not load. This is possibly an error with `react-to-print`. Please file an issue: https://github.com/MatthewHerbst/react-to-print/issues/"],suppressErrors:E})},500)}function h(w){const y=[],v=document.createTreeWalker(w,NodeFilter.SHOW_ELEMENT,null);let T=v.nextNode();for(;T;)y.push(T),T=v.nextNode();return y}function x(w,y,v){const T=h(w),F=h(y);if(T.length===F.length)for(let A=0;A<T.length;A++){const S=T[A],E=F[A],b=S.shadowRoot;if(b!==null){const k=E.attachShadow({mode:b.mode});k.innerHTML=b.innerHTML,x(b,k,v)}}else l({messages:["When cloning shadow root content, source and target elements have different size. `onBeforePrint` likely resolved too early.",w,y],suppressErrors:v})}const m=`
    @page {
        /* Remove browser default header (title) and footer (url) */
        margin: 0;
    }
    @media print {
        body {
            /* Tell browsers to print background colors */
            color-adjust: exact; /* Firefox. This is an older version of "print-color-adjust" */
            print-color-adjust: exact; /* Firefox/Safari */
            -webkit-print-color-adjust: exact; /* Chrome/Safari/Edge/Opera */
        }
    }
`;function p(w,y,v,T){var F,A,S,E,b;const{contentNode:k,clonedContentNode:j,clonedImgNodes:_,clonedVideoNodes:B,numResourcesToLoad:Q,originalCanvasNodes:Z}=v,{bodyClass:L,fonts:q,ignoreGlobalStyles:te,pageStyle:R,nonce:oe,suppressErrors:J,copyShadowRoots:P}=T;w.onload=null;const V=(F=w.contentDocument)!==null&&F!==void 0?F:(A=w.contentWindow)===null||A===void 0?void 0:A.document;if(V){const z=V.body.appendChild(j);P&&x(k,z,!!J),q&&(!((S=w.contentDocument)===null||S===void 0)&&S.fonts&&(!((E=w.contentWindow)===null||E===void 0)&&E.FontFace)?q.forEach(O=>{const D=new FontFace(O.family,O.source,{weight:O.weight,style:O.style});w.contentDocument.fonts.add(D),D.loaded.then(()=>{y(D)}).catch(re=>{y(D,["Failed loading the font:",D,"Load error:",d(re)])})}):(q.forEach(O=>{y(O)}),l({messages:['"react-to-print" is not able to load custom fonts because the browser does not support the FontFace API but will continue attempting to print the page'],suppressErrors:J})));const G=R??m,ne=V.createElement("style");oe&&(ne.setAttribute("nonce",oe),V.head.setAttribute("nonce",oe)),ne.appendChild(V.createTextNode(G)),V.head.appendChild(ne),L&&V.body.classList.add(...L.split(" "));const he=V.querySelectorAll("canvas");for(let O=0;O<Z.length;++O){const D=Z[O],re=he[O];if(re===void 0){l({messages:["A canvas element could not be copied for printing, has it loaded? `onBeforePrint` likely resolved too early.",D],suppressErrors:J});continue}const le=re.getContext("2d");le&&le.drawImage(D,0,0)}for(let O=0;O<_.length;O++){const D=_[O],re=D.getAttribute("src");if(re){const le=new Image;le.onload=()=>{y(D)},le.onerror=(Te,ue,we,xe,Ce)=>{y(D,["Error loading <img>",D,"Error",Ce])},le.src=re}else y(D,['Found an <img> tag with an empty "src" attribute. This prevents pre-loading it.',D])}for(let O=0;O<B.length;O++){const D=B[O];D.preload="auto";const re=D.getAttribute("poster");if(re){const le=new Image;le.onload=()=>{y(D)},le.onerror=(Te,ue,we,xe,Ce)=>{y(D,["Error loading video poster",re,"for video",D,"Error:",Ce])},le.src=re}else D.readyState>=2?y(D):D.src?(D.onloadeddata=()=>{y(D)},D.onerror=(le,Te,ue,we,xe)=>{y(D,["Error loading video",D,"Error",xe])},D.onstalled=()=>{y(D,["Loading video stalled, skipping",D])}):y(D,["Error loading video, `src` is empty",D])}const se="select",ae=k.querySelectorAll(se),K=V.querySelectorAll(se);for(let O=0;O<ae.length;O++)K[O].value=ae[O].value;if(!te){const O=document.querySelectorAll("style, link[rel~='stylesheet'], link[as='style']");for(let D=0,re=O.length;D<re;++D){const le=O[D];if(le.tagName.toLowerCase()==="style"){const Te=V.createElement(le.tagName),ue=le.sheet;if(ue){let we="";try{const xe=ue.cssRules.length;for(let Ce=0;Ce<xe;++Ce)typeof ue.cssRules[Ce].cssText=="string"&&(we+=`${ue.cssRules[Ce].cssText}\r
`)}catch(xe){l({messages:["A stylesheet could not be accessed. This is likely due to the stylesheet having cross-origin imports, and many browsers block script access to cross-origin stylesheets. See https://github.com/MatthewHerbst/react-to-print/issues/429 for details. You may be able to load the sheet by both marking the stylesheet with the cross `crossorigin` attribute, and setting the `Access-Control-Allow-Origin` header on the server serving the stylesheet. Alternatively, host the stylesheet on your domain to avoid this issue entirely.",le,`Original error: ${d(xe).message}`],level:"warning"})}Te.setAttribute("id",`react-to-print-${D}`),oe&&Te.setAttribute("nonce",oe),Te.appendChild(V.createTextNode(we)),V.head.appendChild(Te)}}else if(le.getAttribute("href"))if(le.hasAttribute("disabled"))l({messages:["`react-to-print` encountered a <link> tag with a `disabled` attribute and will ignore it. Note that the `disabled` attribute is deprecated, and some browsers ignore it. You should stop using it. https://developer.mozilla.org/en-US/docs/Web/HTML/Element/link#attr-disabled. The <link> is:",le],level:"warning"}),y(le);else{const Te=V.createElement(le.tagName);for(let ue=0,we=le.attributes.length;ue<we;++ue){const xe=le.attributes[ue];xe&&Te.setAttribute(xe.nodeName,(b=xe.nodeValue)!==null&&b!==void 0?b:"")}Te.onload=()=>{y(Te)},Te.onerror=(ue,we,xe,Ce,Oe)=>{y(Te,["Failed to load",Te,"Error:",Oe])},oe&&Te.setAttribute("nonce",oe),V.head.appendChild(Te)}else l({messages:["`react-to-print` encountered a <link> tag with an empty `href` attribute. In addition to being invalid HTML, this can cause problems in many browsers, and so the <link> was not loaded. The <link> is:",le],level:"warning"}),y(le)}}}Q===0&&f(w,T)}function g({bodyClass:w,contentRef:y,copyShadowRoots:v,documentTitle:T,fonts:F,ignoreGlobalStyles:A,nonce:S,onAfterPrint:E,onBeforePrint:b,onPrintError:k,pageStyle:j,preserveAfterPrint:_,print:B,suppressErrors:Q}){return(0,c.useCallback)(Z=>{function L(){const q={bodyClass:w,contentRef:y,copyShadowRoots:v,documentTitle:T,fonts:F,ignoreGlobalStyles:A,nonce:S,onAfterPrint:E,onBeforePrint:b,onPrintError:k,pageStyle:j,preserveAfterPrint:_,print:B,suppressErrors:Q},te=function(){const J=document.createElement("iframe");return J.width=`${document.documentElement.clientWidth}px`,J.height=`${document.documentElement.clientHeight}px`,J.style.position="absolute",J.style.top=`-${document.documentElement.clientHeight+100}px`,J.style.left=`-${document.documentElement.clientWidth+100}px`,J.id="printWindow",J.srcdoc="<!DOCTYPE html>",J}(),R=function(J,P){const{contentRef:V,fonts:z,ignoreGlobalStyles:G,suppressErrors:ne}=P,he=function({contentRef:re,optionalContent:le,suppressErrors:Te}){return!le||le instanceof Event||(re&&l({level:"warning",messages:['"react-to-print" received a `contentRef` option and a optional-content param passed to its callback. The `contentRef` option will be ignored.']}),typeof le!="function")?re?re.current:void l({messages:['"react-to-print" did not receive a `contentRef` option or a optional-content param pass to its callback.'],suppressErrors:Te}):le()}({contentRef:V,optionalContent:J,suppressErrors:ne});if(!he)return;const se=he.cloneNode(!0),ae=document.querySelectorAll("link[rel~='stylesheet'], link[as='style']"),K=se.querySelectorAll("img"),O=se.querySelectorAll("video"),D=z?z.length:0;return{contentNode:he,clonedContentNode:se,clonedImgNodes:K,clonedVideoNodes:O,numResourcesToLoad:(G?0:ae.length)+K.length+O.length+D,originalCanvasNodes:he.querySelectorAll("canvas")}}(Z,q);if(!R)return void l({messages:["There is nothing to print"],suppressErrors:Q});const oe=function(J,P,V){const{suppressErrors:z}=J,G=[],ne=[];return function(he,se){G.includes(he)?l({level:"debug",messages:["Tried to mark a resource that has already been handled",he],suppressErrors:z}):(se?(l({messages:['"react-to-print" was unable to load a resource but will continue attempting to print the page',...se],suppressErrors:z}),ne.push(he)):G.push(he),G.length+ne.length===P&&f(V,J))}}(q,R.numResourcesToLoad,te);(function(J,P,V,z){J.onload=()=>{p(J,P,V,z)},document.body.appendChild(J)})(te,oe,R,q)}u(_,!0),b?b().then(()=>{L()}).catch(q=>{k==null||k("onBeforePrint",d(q))}):L()},[w,y,v,T,F,A,S,E,b,k,j,_,B,Q])}return o}()})})(iy);var W8=iy.exports;const Xr=Mn.create({baseURL:bt.apiUrl,timeout:bt.apiTimeout,headers:{"Content-Type":"application/json"}});Xr.interceptors.request.use(e=>{var t;const r=localStorage.getItem("token");if(console.log("API Request:",{url:e.url,method:(t=e.method)==null?void 0:t.toUpperCase(),timestamp:new Date().toISOString(),hasToken:!!r,tokenFirstChars:r?`${r.substring(0,10)}...`:"none"}),r&&e.headers){e.headers.Authorization=`Bearer ${r}`;try{const n=r.split(".");if(n.length===3){const a=JSON.parse(atob(n[1])),s=a.exp*1e3,o=Date.now();console.log("Token status:",{isValid:o<s,expiresIn:`${Math.round((s-o)/1e3/60)} minutes`,expTime:new Date(s).toISOString(),currentTime:new Date(o).toISOString(),roles:a.roles||a.authorities||a.role||"Not found"}),s-o<3e5&&console.warn("Token is expired or about to expire soon")}}catch(n){console.error("Failed to decode token:",n)}}return e},e=>(console.error("Request interceptor error:",e),Promise.reject(e)));Xr.interceptors.response.use(e=>{var r;return console.log("API Success Response:",{url:e.config.url,method:(r=e.config.method)==null?void 0:r.toUpperCase(),status:e.status,timestamp:new Date().toISOString()}),e},async e=>{var n,a,s,o,c,l,u,d,f,h,x,m,p,g,w,y,v,T,F,A,S,E;const r=e.config;if(console.error("API Error Details:",{url:r==null?void 0:r.url,method:(n=r==null?void 0:r.method)==null?void 0:n.toUpperCase(),status:(a=e.response)==null?void 0:a.status,statusText:(s=e.response)==null?void 0:s.statusText,timestamp:new Date().toISOString(),requestHeaders:{contentType:(o=r==null?void 0:r.headers)==null?void 0:o["Content-Type"],hasAuthHeader:!!((c=r==null?void 0:r.headers)!=null&&c.Authorization),authHeader:(l=r==null?void 0:r.headers)!=null&&l.Authorization?`${String((u=r==null?void 0:r.headers)==null?void 0:u.Authorization).substring(0,20)}...`:"none"},requestData:r==null?void 0:r.data,responseData:(d=e.response)==null?void 0:d.data,isAuthError:((f=e.response)==null?void 0:f.status)===401||((h=e.response)==null?void 0:h.status)===403}),!r._retry&&r.url!=="/api/auth/login"&&(!e.response||e.response.status>=500&&e.response.status<600)&&(r._retryCount||(r._retryCount=0),r._retryCount<bt.retryAttempts)){r._retry=!0,r._retryCount++;const b=Math.pow(2,r._retryCount)*1e3;return await new Promise(k=>setTimeout(k,b)),console.log(`Retrying request (attempt ${r._retryCount}):`,{url:r.url,method:(x=r.method)==null?void 0:x.toUpperCase(),timestamp:new Date().toISOString()}),Xr(r)}if(!e.response)return r.baseURL===bt.apiUrl&&!r._usedFallback?(r.baseURL=bt.fallbackApiUrl,r._usedFallback=!0,Xr(r)):Promise.reject({message:"Network error. Please check your connection.",status:"network_error"});const t={message:"",status:e.response.status,originalError:e};if(e.response.status===403){const b=localStorage.getItem("token");let k=null;const j=`${r.baseURL}${r.url}`;try{if(b){const _=b.split(".");if(_.length===3){const B=JSON.parse(atob(_[1]));k={exp:new Date(B.exp*1e3).toISOString(),roles:B.roles||B.authorities||B.role||"Not found in token",username:B.sub||B.username||"Not found in token",iat:B.iat?new Date(B.iat*1e3).toISOString():"Not available",jti:B.jti||"Not available",claims:B,scope:B.scope||B.scopes||"Not found"},Date.now()>B.exp*1e3&&console.error("Permission denied with EXPIRED token",{expiredSince:`${Math.round((Date.now()-B.exp*1e3)/1e3/60)} minutes ago`})}}}catch(_){console.error("Error parsing token:",_)}t.message="Access denied. You don't have permission to perform this action.",t.tokenInfo=k,console.error("Permission Error (403 Forbidden):",{endpoint:r==null?void 0:r.url,fullUrl:j,method:(m=r==null?void 0:r.method)==null?void 0:m.toUpperCase(),tokenPresent:!!b,tokenInfo:k,requestData:r==null?void 0:r.data,requestPath:(p=r==null?void 0:r.url)==null?void 0:p.split("?")[0],requestParams:r==null?void 0:r.params,requestBody:JSON.stringify(r==null?void 0:r.data),responseData:(g=e.response)==null?void 0:g.data,responseHeaders:(w=e.response)==null?void 0:w.headers,timestamp:new Date().toISOString(),errorDetail:((v=(y=e.response)==null?void 0:y.data)==null?void 0:v.error)||((F=(T=e.response)==null?void 0:T.data)==null?void 0:F.message)||"No error details"}),b&&bt&&typeof bt=="object"&&(localStorage.setItem("last_403_url",j),localStorage.setItem("last_403_time",new Date().toISOString()),localStorage.setItem("last_403_data",JSON.stringify((r==null?void 0:r.data)||{})))}else e.response.status===401?(t.message="Unauthorized. Please log in again.",console.error("Authentication Error (401 Unauthorized):",{endpoint:r==null?void 0:r.url,method:(A=r==null?void 0:r.method)==null?void 0:A.toUpperCase(),tokenPresent:!!localStorage.getItem("token"),responseData:(S=e.response)==null?void 0:S.data,timestamp:new Date().toISOString()}),localStorage.removeItem("token"),window.location.href="/login"):t.message=((E=e.response.data)==null?void 0:E.message)||"An unexpected error occurred.";return Promise.reject(t)});Xr.get;Xr.post;Xr.put;Xr.delete;const H8={sendEmail:async e=>{try{return(await Xr.post("/api/notifications/email",e)).data}catch(r){throw console.error("Failed to send email notification:",r),r}},sendFeeReceiptEmail:async(e,r,t)=>{try{return(await Xr.post(`/api/notifications/fee-receipt/${r}`,{studentId:e,recipientEmail:t})).data}catch(n){throw console.error("Failed to send fee receipt email:",n),n}},getNotificationSettings:async()=>{try{return(await Xr.get("/api/notifications/settings")).data}catch(e){throw console.error("Failed to fetch notification settings:",e),e}},updateNotificationSettings:async e=>{try{return(await Xr.put("/api/notifications/settings",e)).data}catch(r){throw console.error("Failed to update notification settings:",r),r}},sendPaymentReminders:async()=>{try{return(await Xr.post("/api/notifications/payment-reminders")).data}catch(e){throw console.error("Failed to send payment reminders:",e),e}}},gp={CASH:"Cash",CHEQUE:"Cheque",CHECK:"Check",BANK_TRANSFER:"Bank Transfer",UPI:"UPI",ONLINE:"Online",CREDIT_CARD:"Credit Card"},Mo={MONTHLY:"Monthly",QUARTERLY:"Quarterly",HALF_YEARLY:"Half-Yearly",YEARLY:"Annual"},z8=({open:e,onClose:r,payment:t,studentName:n,className:a,studentId:s,parentEmail:o=""})=>{const c=C.useRef(null),[l,u]=C.useState(o),[d,f]=C.useState(!1),[h,x]=C.useState(!1),[m,p]=C.useState({open:!1,message:"",severity:"success"}),g=W8.useReactToPrint({documentTitle:`Receipt_${(t==null?void 0:t.id)||"Unknown"}_${(n==null?void 0:n.replace(/\s+/g,"_"))||"Student"}`,onAfterPrint:()=>{console.log("Print complete")},content:()=>c.current}),w=async()=>{if(!(!t||!s))try{x(!0);const T=await H8.sendFeeReceiptEmail(s,t.id,l);p({open:!0,message:"Receipt has been sent successfully to "+l,severity:"success"}),f(!1)}catch(T){console.error("Failed to send receipt email:",T),p({open:!0,message:"Failed to send email. Please try again.",severity:"error"})}finally{x(!1)}},y=()=>{p({...m,open:!1})};if(!t)return null;const v=`R${String(t.id).padStart(6,"0")}`;return i.jsxs(br,{open:e,onClose:r,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{minHeight:"60vh"}},children:[i.jsxs(Br,{sx:{display:"flex",alignItems:"center"},children:[i.jsx(yc,{sx:{mr:1}}),"Payment Receipt"]}),i.jsxs(Dr,{children:[i.jsx(ye,{ref:c,sx:{p:2},children:i.jsx(Ke,{elevation:0,sx:{p:3,border:"1px dashed #ccc"},children:i.jsxs(X,{container:!0,spacing:2,children:[i.jsxs(X,{item:!0,xs:12,sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[i.jsxs(ye,{children:[i.jsx(ee,{variant:"h5",gutterBottom:!0,children:"SCHOOL MANAGEMENT SYSTEM"}),i.jsx(ee,{variant:"body2",color:"textSecondary",children:"123 Education Street, City, Country"}),i.jsx(ee,{variant:"body2",color:"textSecondary",children:"Phone: +91 1234567890"}),i.jsx(ee,{variant:"body2",color:"textSecondary",children:"Email: info@schoolms.com"})]}),i.jsxs(ye,{sx:{textAlign:"right"},children:[i.jsx(ee,{variant:"h6",children:"RECEIPT"}),i.jsx(ee,{variant:"body1",children:v}),i.jsxs(ee,{variant:"body2",children:["Date: ",qs(new Date(t.paymentDate),"dd MMM yyyy")]})]})]}),i.jsx(X,{item:!0,xs:12,children:i.jsx(sr,{})}),i.jsxs(X,{item:!0,xs:12,sm:6,children:[i.jsx(ee,{variant:"subtitle2",gutterBottom:!0,children:"STUDENT DETAILS"}),i.jsx(ee,{variant:"body1",children:n}),i.jsxs(ee,{variant:"body2",children:["Class: ",a]}),i.jsxs(ee,{variant:"body2",children:["Student ID: ",t.studentId]})]}),i.jsxs(X,{item:!0,xs:12,sm:6,children:[i.jsx(ee,{variant:"subtitle2",gutterBottom:!0,children:"PAYMENT DETAILS"}),"                ",i.jsxs(ee,{variant:"body2",children:[i.jsx("strong",{children:"Payment Type:"})," ",t.frequency&&Mo[t.frequency]?Mo[t.frequency]:t.frequency," Fee"]}),i.jsxs(ee,{variant:"body2",children:[i.jsx("strong",{children:"Payment Method:"})," ",t.paymentMethod&&gp[t.paymentMethod]?gp[t.paymentMethod]:t.paymentMethod]}),t.reference&&i.jsxs(ee,{variant:"body2",children:[i.jsx("strong",{children:"Reference:"})," ",t.reference]})]}),i.jsx(X,{item:!0,xs:12,children:i.jsx(sr,{})}),i.jsx(X,{item:!0,xs:12,children:i.jsx(ye,{sx:{backgroundColor:"#f5f5f5",p:2,borderRadius:1,mt:2},children:i.jsxs(X,{container:!0,spacing:2,children:[i.jsxs(X,{item:!0,xs:8,children:["                      ",i.jsxs(ee,{variant:"subtitle1",children:[t.frequency&&Mo[t.frequency]?Mo[t.frequency]:t.frequency," Fee Payment"]}),t.notes&&i.jsxs(ee,{variant:"body2",color:"textSecondary",sx:{mt:1},children:["Notes: ",t.notes]})]}),i.jsx(X,{item:!0,xs:4,sx:{textAlign:"right"},children:i.jsxs(ee,{variant:"subtitle1",children:["₹",t.amount.toLocaleString()]})})]})})}),i.jsx(X,{item:!0,xs:12,sx:{display:"flex",justifyContent:"flex-end",mt:2},children:i.jsx(ye,{children:i.jsxs(ee,{variant:"h6",children:["TOTAL PAID: ₹",t.amount.toLocaleString()]})})}),i.jsxs(X,{item:!0,xs:12,sx:{mt:4},children:[i.jsx(sr,{}),i.jsxs(ye,{sx:{display:"flex",justifyContent:"space-between",mt:3,alignItems:"flex-end"},children:[i.jsxs(ye,{sx:{maxWidth:"50%"},children:[i.jsx(ee,{variant:"body2",gutterBottom:!0,children:i.jsx("strong",{children:"Received with thanks"})}),i.jsx(ee,{variant:"caption",color:"textSecondary",children:"This is a computer generated receipt and doesn't require a signature."})]}),i.jsx(ye,{sx:{textAlign:"center",borderTop:"1px solid #000",pt:1,minWidth:"150px"},children:i.jsx(ee,{variant:"body2",children:"Authorized Signature"})})]})]})]})})}),d&&i.jsxs(ye,{sx:{mt:2,p:2,border:"1px solid #eee",borderRadius:1},children:[i.jsx(ee,{variant:"subtitle2",gutterBottom:!0,children:"Send Receipt via Email"}),i.jsx(Ae,{fullWidth:!0,size:"small",label:"Email Address",variant:"outlined",value:l,onChange:T=>u(T.target.value),placeholder:"parent@example.com",sx:{mb:2}}),i.jsxs(ye,{sx:{display:"flex",justifyContent:"flex-end"},children:[i.jsx(Pe,{size:"small",onClick:()=>f(!1),sx:{mr:1},children:"Cancel"}),i.jsx(Pe,{size:"small",variant:"contained",onClick:w,disabled:!l||h,children:h?"Sending...":"Send"})]})]})]}),i.jsxs(_r,{sx:{justifyContent:"space-between",p:2},children:[i.jsx(Pe,{onClick:r,children:"Close"}),i.jsxs(ye,{children:[!d&&s&&i.jsx(Pe,{startIcon:i.jsx(Op,{}),onClick:()=>f(!0),sx:{mr:1},children:"Email Receipt"}),i.jsx(Pe,{startIcon:i.jsx(Xy,{}),variant:"contained",onClick:g,children:"Print Receipt"})]})]}),i.jsx(yu,{open:m.open,autoHideDuration:6e3,onClose:y,anchorOrigin:{vertical:"bottom",horizontal:"center"},children:i.jsx(Lr,{onClose:y,severity:m.severity,variant:"filled",children:m.message})})]})},Il=e=>{const{children:r,value:t,index:n,...a}=e;return i.jsx("div",{role:"tabpanel",hidden:t!==n,id:`fee-tabpanel-${n}`,"aria-labelledby":`fee-tab-${n}`,...a,children:t===n&&i.jsx(ye,{sx:{p:3},children:r})})},G8=()=>{var he;const[e,r]=C.useState(0),[t,n]=C.useState(!1),[a,s]=C.useState(!1),[o,c]=C.useState(!1),[l,u]=C.useState(!1),[d,f]=C.useState(null),[h,x]=C.useState(""),[m,p]=C.useState(null),[g,w]=C.useState(null),[y,v]=C.useState([]),[T,F]=C.useState({open:!1,message:"",severity:"success"}),{user:A}=_n(),S=(A==null?void 0:A.role)==="ADMIN"||(A==null?void 0:A.role)==="ACCOUNTS",{data:E,loading:b,error:k,refetch:j}=Ln(()=>Bt.getAllFeeStructures()),{data:_,loading:B,error:Q,refetch:Z}=Ln(()=>Bt.getAllTransportRoutes()),{data:L,loading:q}=Ln(()=>Tr.getAll()),te=(se,ae)=>{r(ae)},R=async()=>{if(h.trim())try{const se=await Tr.search(h);if(se){const ae=Array.isArray(se)?se[0]:se;if(ae&&ae.id)p(ae),await oe(ae.id),await J(ae.id);else throw new Error("Invalid student data returned")}else F({open:!0,message:"Student not found",severity:"error"}),p(null)}catch{F({open:!0,message:"Error searching for student",severity:"error"})}},oe=async se=>{try{const ae=await Bt.getStudentFeeDetails(se);w(ae)}catch{F({open:!0,message:"Error fetching student fee details",severity:"error"})}},J=async se=>{try{const ae=await Bt.getPaymentsByStudentId(se);v(ae)}catch{F({open:!0,message:"Error fetching student payments",severity:"error"})}},P=async()=>{c(!1),F({open:!0,message:"Payment processed successfully",severity:"success"}),m!=null&&m.id&&(await oe(m.id),await J(m.id))},V=se=>{f(se),u(!0)},z=async se=>{try{await Bt.downloadReceipt(se),F({open:!0,message:"Receipt downloaded successfully",severity:"success"})}catch{F({open:!0,message:"Error downloading receipt",severity:"error"})}},G=async se=>{if(window.confirm("Are you sure you want to void this payment? This action cannot be undone."))try{await Bt.voidPayment(se,"Voided by admin"),F({open:!0,message:"Payment voided successfully",severity:"success"}),m!=null&&m.id&&(await oe(m.id),await J(m.id))}catch{F({open:!0,message:"Error voiding payment",severity:"error"})}},ne=()=>{p(null),x(""),w(null),v([])};return i.jsxs(ye,{sx:{width:"100%"},children:[i.jsx(ye,{sx:{borderBottom:1,borderColor:"divider"},children:i.jsxs(Su,{value:e,onChange:te,"aria-label":"fee management tabs",children:[i.jsx(ma,{label:"Fee Structures"}),i.jsx(ma,{label:"Transport Routes"}),i.jsx(ma,{label:"Payments"})]})}),i.jsxs(Il,{value:e,index:0,children:[i.jsxs(ye,{sx:{mb:2,display:"flex",justifyContent:"space-between"},children:[i.jsx(ee,{variant:"h6",children:"Fee Structures"}),"          ",i.jsx(Sn,{permissions:["MANAGE_FEES"],children:i.jsx(Pe,{variant:"contained",startIcon:i.jsx(zs,{}),onClick:()=>n(!0),children:"Add Fee Structure"})})]}),b?i.jsx(an,{}):k?i.jsx(on,{message:"Error loading fee structures"}):E?i.jsx(B8,{feeStructures:E,onEdit:se=>console.log("Edit fee structure:",se),onDelete:se=>console.log("Delete fee structure:",se),onRefresh:j}):null]}),i.jsxs(Il,{value:e,index:1,children:[i.jsxs(ye,{sx:{mb:2,display:"flex",justifyContent:"space-between"},children:[i.jsx(ee,{variant:"h6",children:"Transport Routes"}),"          ",i.jsx(Sn,{permissions:["MANAGE_FEES"],children:i.jsx(Pe,{variant:"contained",startIcon:i.jsx(zs,{}),onClick:()=>s(!0),children:"Add Transport Route"})})]}),B?i.jsx(an,{}):Q?i.jsx(on,{message:"Error loading transport routes"}):_?i.jsx(L8,{transportRoutes:_,onEdit:se=>console.log("Edit route:",se),onDelete:se=>console.log("Delete route:",se),onRefresh:Z}):null]}),i.jsxs(Il,{value:e,index:2,children:[i.jsxs(ye,{sx:{mb:3},children:[i.jsx(ee,{variant:"h6",gutterBottom:!0,children:"Student Fee Management"}),i.jsx(Ke,{sx:{p:2},children:i.jsxs(X,{container:!0,spacing:2,alignItems:"center",children:[i.jsx(X,{item:!0,xs:12,sm:6,md:4,children:i.jsx(Ky,{options:L||[],getOptionLabel:se=>`${se.name} (${se.id})`,value:m,onChange:(se,ae)=>{p(ae),ae!=null&&ae.id&&(oe(ae.id),J(ae.id))},renderInput:se=>i.jsx(Ae,{...se,label:"Search Student",variant:"outlined",fullWidth:!0,onChange:ae=>x(ae.target.value),InputProps:{...se.InputProps,endAdornment:i.jsx(i.Fragment,{children:q?i.jsx(an,{size:20}):se.InputProps.endAdornment})}})})}),i.jsx(X,{item:!0,children:i.jsx(Pe,{variant:"contained",startIcon:i.jsx(wu,{}),onClick:R,children:"Search"})}),i.jsx(X,{item:!0,children:i.jsx(st,{title:"Reset",children:i.jsx(Ze,{onClick:ne,children:i.jsx(Za,{})})})})]})})]}),m&&i.jsxs(i.Fragment,{children:[i.jsx(ye,{sx:{mt:3},children:i.jsxs(Ke,{sx:{p:2,mb:3},children:[i.jsxs(ye,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[i.jsxs(ee,{variant:"h6",children:[m.name,"'s Fee Details"]}),"                  ",i.jsx(Sn,{permissions:["MANAGE_FEES"],children:i.jsx(Pe,{variant:"contained",startIcon:i.jsx(yc,{}),onClick:()=>c(!0),disabled:!g,children:"Record Payment"})})]}),"                ",g?i.jsx(ty,{feeDetails:g}):i.jsx(ee,{children:"No fee details available for this student"})]})}),i.jsxs(ye,{sx:{mt:3},children:[i.jsx(ee,{variant:"h6",gutterBottom:!0,children:"Payment History"}),i.jsx(V8,{payments:y,onViewReceipt:V,onDownloadReceipt:z,onVoidPayment:G,isAdmin:S})]})]})]}),"      ",t&&i.jsx($8,{open:t,onClose:()=>n(!1),onSubmit:async se=>{await Bt.createFeeStructure(se),n(!1),j(),F({open:!0,message:"Fee structure created successfully",severity:"success"})}}),a&&i.jsx(U8,{open:a,onClose:()=>s(!1),onSubmit:async se=>{await Bt.createTransportRoute(se),s(!1),Z(),F({open:!0,message:"Transport route created successfully",severity:"success"})}}),o&&m&&g&&i.jsx(pg,{open:o,onClose:()=>c(!1),studentId:m.id??null,onSubmit:async se=>{try{await Bt.createPayment(se),P()}catch{F({open:!0,message:"Error processing payment",severity:"error"})}},loading:!1}),"      ",l&&d!==null&&i.jsx(z8,{open:l,payment:{id:d,studentId:(m==null?void 0:m.id)||0,paymentDate:new Date().toISOString(),amount:0,amountPaid:0,paymentMethod:"CASH",frequency:"MONTHLY",paymentStatus:"PAID",academicYear:"2024-2025",academicTerm:"TERM1"},studentName:(m==null?void 0:m.name)||"Student",className:`Grade ${((he=g==null?void 0:g.feeStructure)==null?void 0:he.classGrade)||"N/A"}`,onClose:()=>{u(!1),f(null)},onDownload:()=>{d!==null&&z(d)}}),i.jsx(yu,{open:T.open,autoHideDuration:6e3,onClose:()=>F({...T,open:!1}),children:i.jsx(Lr,{onClose:()=>F({...T,open:!1}),severity:T.severity,sx:{width:"100%"},children:T.message})})]})},Y8=()=>{const{login:e}=_n(),[r,t]=C.useState(""),[n,a]=C.useState(""),[s,o]=C.useState(!1),[c,l]=C.useState(null),[u,d]=C.useState(null),[f,h]=C.useState(!1),[x,m]=C.useState(!1),[p,g]=C.useState(null);C.useEffect(()=>{try{console.log("🔍 Login component mounted"),console.log("⚙️ API URL from environment config:",{}.VITE_API_URL||"https://api.schoolms.com")}catch(T){console.error("Error in debug collection:",T)}},[]);const w=async T=>{T.preventDefault(),l(null),d(null),g(null);try{if(o(!0),console.log(`🔐 Attempting login with username: ${r}`),f){console.log("🧪 Debug mode: Making direct API call instead of using auth context");try{const F=await Jo.login({username:r,password:n});console.log("✅ Direct login API call successful:",F),g("Direct API call successful! Proceeding with normal login flow...")}catch(F){throw console.error("❌ Direct login API call failed:",F),d(F),g(`Direct API call failed: ${(F==null?void 0:F.message)||JSON.stringify(F)}`),F}}await e(r,n),console.log("✅ Login successful through auth context")}catch(F){console.error("❌ Login error:",F),l(F.message||"Login failed. Please try again."),d(F)}finally{o(!1)}},y=async()=>{try{o(!0),g(null);const T={}.VITE_API_URL||"https://api.schoolms.com";console.log(`🧪 Testing server connection to ${T}/health`);const F=await fetch(`${T}/health`,{method:"GET"});if(F.ok){const A=`Server connection successful: ${await F.text()}`;g(A),console.log("✅",A)}else{const A=`Server returned status: ${F.status} ${F.statusText}`;g(A),console.warn("⚠️",A)}}catch(T){const F=`Server connection failed: ${T.message}`;g(F),console.error("❌",F)}finally{o(!1)}},v=async()=>{if(!r||!n){g("Please enter username and password before testing");return}o(!0),l(null),d(null),g("Testing login with /api/auth/login endpoint...");try{const T={}.VITE_API_URL||"https://api.schoolms.com";console.log(`🧪 Testing login with ${T}/api/auth/login`);const F=await Jo.login({username:r,password:n});F&&F.data&&(g("Login successful! Received token and user details."),console.log("✅ Test login successful:",F.data))}catch(T){const F=`Login test failed: ${T.message||JSON.stringify(T)}`;g(F),console.error("❌",F),d(T)}finally{o(!1)}};return i.jsx(ye,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",bgcolor:"background.default",py:4},children:i.jsx(es,{sx:{width:"100%",maxWidth:450,boxShadow:3},children:i.jsxs(ts,{sx:{p:4},children:[i.jsx(ee,{variant:"h4",component:"h1",gutterBottom:!0,textAlign:"center",children:"Login"}),c&&i.jsx(Lr,{severity:"error",sx:{mb:2},children:c}),p&&i.jsx(Lr,{severity:"info",sx:{mb:2,whiteSpace:"pre-line"},children:p}),i.jsxs(ye,{component:"form",onSubmit:w,noValidate:!0,sx:{mt:1},children:[i.jsx(Ae,{margin:"normal",required:!0,fullWidth:!0,id:"username",label:"Username",name:"username",autoComplete:"username",autoFocus:!0,value:r,onChange:T=>t(T.target.value),disabled:s}),i.jsx(Ae,{margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",value:n,onChange:T=>a(T.target.value),disabled:s}),i.jsx(Pe,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},disabled:s||!r||!n,children:s?i.jsx(sn,{size:24}):"Sign In"}),i.jsx(ye,{sx:{mt:2},children:i.jsx(Rl,{control:i.jsx(Nl,{checked:x,onChange:()=>m(!x)}),label:"Show debugging tools"})}),i.jsx(Jy,{in:x,children:i.jsxs(Ke,{variant:"outlined",sx:{p:2,mt:2},children:[i.jsx(ee,{variant:"subtitle2",gutterBottom:!0,children:"Debugging Tools"}),i.jsx(Rl,{control:i.jsx(Nl,{checked:f,onChange:()=>h(!f),disabled:s}),label:"Debug mode (direct API calls)"}),i.jsx(sr,{sx:{my:2}}),i.jsxs(X,{container:!0,spacing:2,children:[i.jsx(X,{item:!0,xs:6,children:i.jsx(Pe,{fullWidth:!0,variant:"outlined",disabled:s,onClick:y,children:"Test Server Connection"})}),i.jsx(X,{item:!0,xs:6,children:i.jsx(Pe,{fullWidth:!0,variant:"outlined",disabled:s||!r||!n,onClick:v,children:"Test Login"})})]}),u&&i.jsxs(ye,{sx:{mt:2,overflow:"auto"},children:[i.jsx(ee,{variant:"subtitle2",color:"error",children:"Detailed Error:"}),i.jsx(Ke,{variant:"outlined",sx:{p:1,bgcolor:"grey.100"},children:i.jsx("pre",{style:{margin:0,whiteSpace:"pre-wrap",fontSize:12},children:JSON.stringify(u,null,2)})})]})]})}),i.jsx(ye,{sx:{mt:3,textAlign:"center"},children:i.jsx(tn,{component:qn,to:"/register",variant:"body2",children:"Don't have an account? Sign Up"})})]})]})})})},q8=[{value:"ADMIN",label:"ADMIN - Full system administrative access"},{value:"TEACHER",label:"TEACHER - Access to teaching-related functions"},{value:"STUDENT",label:"STUDENT - Access to student-specific features"},{value:"STAFF",label:"STAFF - General staff access"},{value:"PARENT",label:"PARENT - Parent/guardian access"}],X8=()=>{const e=no(),{showNotification:r}=ln(),[t,n]=C.useState({username:"",password:"",email:"",role:"",fullName:""}),[a,s]=C.useState(!1),[o,c]=C.useState(null),l=d=>f=>{n(h=>({...h,[d]:f.target.value})),o&&c(null)},u=async d=>{d.preventDefault();try{s(!0),c(null),await Jo.register(t),r({type:"success",message:"Registration successful! Please login."}),e("/login")}catch(f){console.error("Registration error:",f);let h="Registration failed. Please try again.";f.message&&typeof f.message=="string"?h=f.message:f.response&&(f.response.data&&f.response.data.message?h=f.response.data.message:f.response.data&&typeof f.response.data=="string"&&(h=f.response.data)),c(h),r({type:"error",message:h})}finally{s(!1)}};return i.jsx(ye,{sx:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"background.default"},children:i.jsx(es,{sx:{maxWidth:400,width:"100%",mx:2},children:i.jsx(ts,{sx:{p:4},children:i.jsxs(ye,{component:"form",onSubmit:u,children:[i.jsx(ee,{variant:"h4",align:"center",gutterBottom:!0,children:"Create Account"}),i.jsx(ee,{variant:"h6",align:"center",color:"textSecondary",sx:{mb:4},children:"Register for a new account"}),o&&i.jsx(Lr,{severity:"error",sx:{mb:2},children:o}),i.jsx(Ae,{fullWidth:!0,label:"Full Name",value:t.fullName,onChange:l("fullName"),margin:"normal",required:!0,disabled:a}),i.jsx(Ae,{fullWidth:!0,label:"Username",value:t.username,onChange:l("username"),margin:"normal",required:!0,disabled:a,error:!!o&&o.toLowerCase().includes("username"),helperText:o&&o.toLowerCase().includes("username")?o:""}),i.jsx(Ae,{fullWidth:!0,type:"email",label:"Email",value:t.email,onChange:l("email"),margin:"normal",required:!0,disabled:a,error:!!o&&o.toLowerCase().includes("email"),helperText:o&&o.toLowerCase().includes("email")?o:""}),i.jsx(Ae,{fullWidth:!0,select:!0,label:"Role",value:t.role,onChange:l("role"),margin:"normal",required:!0,disabled:a,children:q8.map(d=>i.jsx(Ye,{value:d.value,children:d.label},d.value))}),i.jsx(Ae,{fullWidth:!0,type:"password",label:"Password",value:t.password,onChange:l("password"),margin:"normal",required:!0,disabled:a,error:!!o&&o.toLowerCase().includes("password"),helperText:o&&o.toLowerCase().includes("password")?o:""}),i.jsx(Pe,{fullWidth:!0,variant:"contained",color:"primary",size:"large",type:"submit",disabled:a,sx:{mt:3},children:a?i.jsx(sn,{size:24}):"Register"}),i.jsx(ye,{sx:{mt:2,textAlign:"center"},children:i.jsxs(ee,{variant:"body2",color:"textSecondary",children:["Already have an account?"," ",i.jsx(tn,{component:qn,to:"/login",children:"Sign in"})]})})]})})})})};var rf={},K8=_t;Object.defineProperty(rf,"__esModule",{value:!0});var oy=rf.default=void 0,J8=K8(Ft()),Q8=i;oy=rf.default=(0,J8.default)((0,Q8.jsx)("path",{d:"M5 13.18v4L12 21l7-3.82v-4L12 17zM12 3 1 9l11 6 9-4.91V17h2V9z"}),"School");var nf={},Z8=_t;Object.defineProperty(nf,"__esModule",{value:!0});var af=nf.default=void 0,eB=Z8(Ft()),tB=i;af=nf.default=(0,eB.default)((0,tB.jsx)("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3m-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3m0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5m8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5"}),"People");var sf={},rB=_t;Object.defineProperty(sf,"__esModule",{value:!0});var cy=sf.default=void 0,nB=rB(Ft()),yp=i;cy=sf.default=(0,nB.default)([(0,yp.jsx)("path",{d:"M21 5c-1.11-.35-2.33-.5-3.5-.5-1.95 0-4.05.4-5.5 1.5-1.45-1.1-3.55-1.5-5.5-1.5S2.45 4.9 1 6v14.65c0 .25.25.5.5.5.1 0 .15-.05.25-.05C3.1 20.45 5.05 20 6.5 20c1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.3 4.75 1.05.1.05.15.05.25.05.25 0 .5-.25.5-.5V6c-.6-.45-1.25-.75-2-1m0 13.5c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V8c1.35-.85 3.8-1.5 5.5-1.5 1.2 0 2.4.15 3.5.5z"},"0"),(0,yp.jsx)("path",{d:"M17.5 10.5c.88 0 1.73.09 2.5.26V9.24c-.79-.15-1.64-.24-2.5-.24-1.7 0-3.24.29-4.5.83v1.66c1.13-.64 2.7-.99 4.5-.99M13 12.49v1.66c1.13-.64 2.7-.99 4.5-.99.88 0 1.73.09 2.5.26V11.9c-.79-.15-1.64-.24-2.5-.24-1.7 0-3.24.3-4.5.83m4.5 1.84c-1.7 0-3.24.29-4.5.83v1.66c1.13-.64 2.7-.99 4.5-.99.88 0 1.73.09 2.5.26v-1.52c-.79-.16-1.64-.24-2.5-.24"},"1")],"MenuBook");var of={},aB=_t;Object.defineProperty(of,"__esModule",{value:!0});var ly=of.default=void 0,sB=aB(Ft()),iB=i;ly=of.default=(0,sB.default)((0,iB.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2M9 17H7v-7h2zm4 0h-2V7h2zm4 0h-2v-4h2z"}),"Assessment");var cf={},oB=_t;Object.defineProperty(cf,"__esModule",{value:!0});var uy=cf.default=void 0,cB=oB(Ft()),lB=i;uy=cf.default=(0,cB.default)((0,lB.jsx)("path",{d:"M3 13h8V3H3zm0 8h8v-6H3zm10 0h8V11h-8zm0-18v6h8V3z"}),"Dashboard");var lf={},uB=_t;Object.defineProperty(lf,"__esModule",{value:!0});var dy=lf.default=void 0,dB=uB(Ft()),fB=i;dy=lf.default=(0,dB.default)((0,fB.jsx)("path",{d:"M6 17h3l2-4V7H5v6h3zm8 0h3l2-4V7h-6v6h3z"}),"FormatQuote");var uf={},hB=_t;Object.defineProperty(uf,"__esModule",{value:!0});var fy=uf.default=void 0,pB=hB(Ft()),mB=i;fy=uf.default=(0,pB.default)((0,mB.jsx)("path",{d:"M17 10H7v2h10zm2-7h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m0 16H5V8h14zm-5-5H7v2h7z"}),"EventNote");var df={},xB=_t;Object.defineProperty(df,"__esModule",{value:!0});var hy=df.default=void 0,gB=xB(Ft()),yB=i;hy=df.default=(0,gB.default)((0,yB.jsx)("path",{d:"M14.06 9.94 12 9l2.06-.94L15 6l.94 2.06L18 9l-2.06.94L15 12zM4 14l.94-2.06L7 11l-2.06-.94L4 8l-.94 2.06L1 11l2.06.94zm4.5-5 1.09-2.41L12 5.5 9.59 4.41 8.5 2 7.41 4.41 5 5.5l2.41 1.09zm-4 11.5 6-6.01 4 4L23 8.93l-1.41-1.41-7.09 7.97-4-4L3 19z"}),"AutoGraph");var ff={},vB=_t;Object.defineProperty(ff,"__esModule",{value:!0});var py=ff.default=void 0,bB=vB(Ft()),wB=i;py=ff.default=(0,bB.default)((0,wB.jsx)("path",{d:"M19 5h-2V3H7v2H5c-1.1 0-2 .9-2 2v1c0 2.55 1.92 4.63 4.39 4.94.63 1.5 1.98 2.63 3.61 2.96V19H7v2h10v-2h-4v-3.1c1.63-.33 2.98-1.46 3.61-2.96C19.08 12.63 21 10.55 21 8V7c0-1.1-.9-2-2-2M5 8V7h2v3.82C5.84 10.4 5 9.3 5 8m14 0c0 1.3-.84 2.4-2 2.82V7h2z"}),"EmojiEvents");const SB=[{icon:i.jsx(uy,{fontSize:"large",color:"primary"}),title:"Interactive Dashboard",description:"Get a comprehensive view of school performance with our intuitive dashboard"},{icon:i.jsx(af,{fontSize:"large",color:"primary"}),title:"Student Management",description:"Manage student profiles, attendance, performance and more in one place"},{icon:i.jsx(oy,{fontSize:"large",color:"primary"}),title:"Teacher Management",description:"Streamline teacher scheduling, performance tracking, and professional development"},{icon:i.jsx(cy,{fontSize:"large",color:"primary"}),title:"Course Management",description:"Create and manage courses, curriculum planning and resource allocation"},{icon:i.jsx(ly,{fontSize:"large",color:"primary"}),title:"Detailed Reports",description:"Generate insightful reports on attendance, grades, and overall performance"},{icon:i.jsx(Qd,{fontSize:"large",color:"primary"}),title:"Admissions",description:"Simplify the admission process with online applications and tracking"}],EB=[{name:"Sarah Johnson",position:"Principal, Westfield Academy",comment:"Implementing this School Management System has transformed our administrative processes. We've reduced paperwork by 80% and our staff can focus more on what matters - the students.",rating:5},{name:"Michael Chen",position:"IT Director, Riverdale High School",comment:"After evaluating several systems, this platform stood out for its intuitive interface and comprehensive feature set. The support team has been exceptional throughout our onboarding.",rating:5},{name:"Dr. Amelia Patel",position:"Superintendent, Springfield District",comment:"The analytics and reporting capabilities have given us unprecedented insights into student performance trends. It's helping us make data-driven decisions to improve educational outcomes.",rating:4.5}],TB=[{question:"How easy is it to migrate from our current system?",answer:"Our team provides comprehensive migration support. We have experience integrating with most popular school management systems and can transfer your data seamlessly with minimal disruption to your operations."},{question:"Is the platform secure for handling student data?",answer:"Absolutely. We prioritize data security with end-to-end encryption, regular security audits, and full compliance with educational data protection regulations including FERPA and GDPR."},{question:"Can we customize the platform for our school's specific needs?",answer:"Yes, our system is highly customizable. You can configure user roles, permission sets, and workflows to match your institution's processes. For more specialized needs, our development team can build custom modules."},{question:"What kind of training and support do you provide?",answer:"We offer comprehensive onboarding training for administrators, teachers, and staff. Our support team is available via email, chat, and phone. We also provide an extensive knowledge base with tutorials and best practices."},{question:"Do you offer mobile access for parents and students?",answer:"Yes, our platform is fully mobile-responsive and we offer dedicated mobile apps for both iOS and Android. Parents and students can access grades, attendance, announcements, and more on the go."}],AB=[{icon:i.jsx(hy,{fontSize:"large",color:"primary"}),value:"95%",label:"Administrative Efficiency Increase"},{icon:i.jsx(af,{fontSize:"large",color:"primary"}),value:"250+",label:"Schools Onboarded"},{icon:i.jsx(fy,{fontSize:"large",color:"primary"}),value:"68%",label:"Reduction in Paperwork"},{icon:i.jsx(py,{fontSize:"large",color:"primary"}),value:"4.8/5",label:"Customer Satisfaction"}],my=()=>{const e=vu();bu(e.breakpoints.down("sm"));const[r,t]=C.useState(!1),n=a=>(s,o)=>{t(o?a:!1)};return i.jsxs(ye,{sx:{minHeight:"100vh"},children:[i.jsx(Ke,{sx:{position:"relative",backgroundColor:e.palette.primary.main,color:e.palette.primary.contrastText,pt:8,pb:12},elevation:0,children:i.jsx(Da,{maxWidth:"lg",children:i.jsxs(X,{container:!0,spacing:4,alignItems:"center",children:[i.jsxs(X,{item:!0,md:7,xs:12,children:[i.jsx(ee,{variant:"h1",gutterBottom:!0,sx:{fontWeight:700,fontSize:{xs:"2.5rem",md:"3.5rem"}},children:"Modern School Management System"}),i.jsx(ee,{variant:"h5",paragraph:!0,sx:{mb:4,opacity:.9},children:"Streamline educational administration with our comprehensive, user-friendly platform designed for modern schools."}),i.jsxs(vc,{direction:{xs:"column",sm:"row"},spacing:2,children:[i.jsx(Pe,{component:qn,to:"/login",variant:"contained",size:"large",color:"secondary",sx:{px:4,py:1.5},children:"Sign In"}),i.jsx(Pe,{component:qn,to:"/register",variant:"outlined",size:"large",sx:{px:4,py:1.5,color:"white",borderColor:"white","&:hover":{borderColor:"white",backgroundColor:"rgba(255,255,255,0.1)"}},children:"Register"})]})]}),i.jsx(X,{item:!0,md:5,xs:12,sx:{display:{xs:"none",md:"block"}},children:i.jsx(ye,{component:"img",src:"/school-illustration.svg",alt:"School Management",sx:{width:"100%",maxHeight:400,objectFit:"contain",filter:"drop-shadow(0px 4px 8px rgba(0,0,0,0.2))"}})})]})})}),i.jsxs(Da,{maxWidth:"lg",sx:{py:8},children:[i.jsx(ee,{variant:"h3",align:"center",gutterBottom:!0,sx:{mb:6,fontWeight:700},children:"Transforming Education Administration"}),i.jsx(X,{container:!0,spacing:4,justifyContent:"center",children:AB.map((a,s)=>i.jsx(X,{item:!0,xs:6,md:3,children:i.jsxs(Ke,{elevation:3,sx:{p:3,textAlign:"center",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",transition:"0.3s","&:hover":{transform:"translateY(-5px)",boxShadow:e.shadows[8]}},children:[i.jsx(ye,{sx:{mb:2},children:a.icon}),i.jsx(ee,{variant:"h3",component:"div",sx:{fontWeight:"bold",mb:1},children:a.value}),i.jsx(ee,{variant:"body1",color:"text.secondary",children:a.label})]})},s))})]}),i.jsxs(Da,{maxWidth:"lg",sx:{py:8},children:[i.jsx(ee,{variant:"h3",align:"center",gutterBottom:!0,sx:{mb:6,fontWeight:700},children:"Features that Transform Education Management"}),i.jsx(X,{container:!0,spacing:4,children:SB.map((a,s)=>i.jsx(X,{item:!0,xs:12,sm:6,md:4,children:i.jsx(es,{sx:{height:"100%",display:"flex",flexDirection:"column",transition:"0.3s","&:hover":{transform:"translateY(-5px)",boxShadow:e.shadows[10]}},elevation:2,children:i.jsxs(ts,{sx:{flexGrow:1,textAlign:"center",p:3},children:[i.jsx(ye,{sx:{mb:2},children:a.icon}),i.jsx(ee,{variant:"h5",component:"h2",gutterBottom:!0,fontWeight:"bold",children:a.title}),i.jsx(ee,{variant:"body1",color:"text.secondary",children:a.description})]})})},s))})]}),i.jsx(ye,{sx:{py:8,bgcolor:"background.default"},children:i.jsxs(Da,{maxWidth:"lg",children:[i.jsx(ee,{variant:"h3",align:"center",gutterBottom:!0,sx:{mb:6,fontWeight:700},children:"Trusted by Educational Leaders"}),i.jsx(X,{container:!0,spacing:4,children:EB.map((a,s)=>i.jsx(X,{item:!0,xs:12,md:4,children:i.jsxs(es,{elevation:3,sx:{height:"100%",display:"flex",flexDirection:"column",position:"relative",pt:6,pb:3,px:3},children:[i.jsx(ye,{sx:{position:"absolute",top:-20,left:"calc(50% - 25px)",width:50,height:50,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",bgcolor:e.palette.primary.main,color:"white"},children:i.jsx(dy,{})}),i.jsxs(ts,{sx:{textAlign:"center",flexGrow:1},children:[i.jsxs(ee,{variant:"body1",sx:{mb:3,fontStyle:"italic"},children:['"',a.comment,'"']}),i.jsxs(ye,{sx:{mt:"auto"},children:[i.jsx(ee,{variant:"h6",component:"div",fontWeight:"bold",children:a.name}),i.jsx(ee,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:a.position}),i.jsx(Qy,{value:a.rating,precision:.5,readOnly:!0,sx:{mt:1}})]})]})]})},s))})]})}),i.jsxs(Da,{maxWidth:"md",sx:{py:8},children:[i.jsx(ee,{variant:"h3",align:"center",gutterBottom:!0,sx:{mb:6,fontWeight:700},children:"Frequently Asked Questions"}),i.jsx(Ke,{elevation:2,sx:{p:{xs:2,md:4},borderRadius:2},children:TB.map((a,s)=>i.jsxs(ca,{expanded:r===`panel${s}`,onChange:n(`panel${s}`),disableGutters:!0,elevation:0,sx:{border:0,"&:not(:last-child)":{borderBottom:1,borderColor:"divider"},"&:before":{display:"none"}},children:[i.jsx(la,{expandIcon:i.jsx(Xn,{}),"aria-controls":`panel${s}-content`,id:`panel${s}-header`,sx:{py:2},children:i.jsx(ee,{variant:"h6",fontWeight:"medium",children:a.question})}),i.jsx(ua,{children:i.jsx(ee,{variant:"body1",color:"text.secondary",children:a.answer})})]},s))})]}),i.jsx(ye,{sx:{py:8,bgcolor:"background.default"},children:i.jsx(Da,{maxWidth:"md",children:i.jsxs(Ke,{elevation:4,sx:{p:{xs:4,md:6},textAlign:"center",borderRadius:4,backgroundColor:e.palette.background.paper,backgroundImage:"linear-gradient(rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.9))"},children:[i.jsx(ee,{variant:"h4",gutterBottom:!0,fontWeight:"bold",children:"Ready to Transform Your School's Administration?"}),i.jsx(ee,{variant:"body1",paragraph:!0,sx:{mb:4,maxWidth:"80%",mx:"auto"},children:"Join thousands of educational institutions that have streamlined their operations with our comprehensive School Management System."}),i.jsx(Pe,{component:qn,to:"/register",variant:"contained",color:"primary",size:"large",sx:{px:5,py:1.5},children:"Get Started Today"})]})})}),i.jsx(ye,{component:"footer",sx:{py:6,bgcolor:"background.paper",borderTop:`1px solid ${e.palette.divider}`},children:i.jsx(Da,{maxWidth:"lg",children:i.jsxs(X,{container:!0,spacing:4,justifyContent:"space-between",children:[i.jsxs(X,{item:!0,xs:12,sm:6,md:3,children:[i.jsx(ee,{variant:"h6",color:"text.primary",gutterBottom:!0,children:"School MS"}),i.jsx(ee,{variant:"body2",color:"text.secondary",children:"Simplifying education management for a better learning experience."}),i.jsx(ye,{sx:{mt:2},children:i.jsxs(ee,{variant:"body2",color:"text.secondary",children:["© ",new Date().getFullYear()," School Management System"]})})]}),i.jsxs(X,{item:!0,xs:12,sm:6,md:3,children:[i.jsx(ee,{variant:"h6",color:"text.primary",gutterBottom:!0,children:"Features"}),i.jsx(tn,{component:qn,to:"/login",color:"text.secondary",display:"block",sx:{mb:1},children:"Dashboard"}),i.jsx(tn,{component:qn,to:"/login",color:"text.secondary",display:"block",sx:{mb:1},children:"Student Management"}),i.jsx(tn,{component:qn,to:"/login",color:"text.secondary",display:"block",sx:{mb:1},children:"Teacher Management"}),i.jsx(tn,{component:qn,to:"/login",color:"text.secondary",display:"block",children:"Reports"})]}),i.jsxs(X,{item:!0,xs:12,sm:6,md:3,children:[i.jsx(ee,{variant:"h6",color:"text.primary",gutterBottom:!0,children:"Resources"}),i.jsx(tn,{href:"#",color:"text.secondary",display:"block",sx:{mb:1},children:"Documentation"}),i.jsx(tn,{href:"#",color:"text.secondary",display:"block",sx:{mb:1},children:"Support"}),i.jsx(tn,{href:"#",color:"text.secondary",display:"block",children:"Blog"})]}),i.jsxs(X,{item:!0,xs:12,sm:6,md:3,children:[i.jsx(ee,{variant:"h6",color:"text.primary",gutterBottom:!0,children:"Company"}),i.jsx(tn,{href:"#",color:"text.secondary",display:"block",sx:{mb:1},children:"About Us"}),i.jsx(tn,{href:"#",color:"text.secondary",display:"block",sx:{mb:1},children:"Contact"}),i.jsx(tn,{href:"#",color:"text.secondary",display:"block",children:"Privacy Policy"})]})]})})})]})};var pr=(e=>(e.ACTIVE="ACTIVE",e.ON_LEAVE="ON_LEAVE",e.SUSPENDED="SUSPENDED",e.TERMINATED="TERMINATED",e.RETIRED="RETIRED",e.RESIGNED="RESIGNED",e))(pr||{});const vp={Teacher:1,Principal:2,"Admin Officer":3,Librarian:4,Management:5,"Account Officer":6},Pl=e=>{const r={...e};return r.role&&vp[r.role]&&(r.roleId=vp[r.role]),r.joinDate&&!r.joiningDate&&(r.joiningDate=r.joinDate),r.phoneNumber&&!r.phone?r.phone=r.phoneNumber:r.phone&&!r.phoneNumber&&(r.phoneNumber=r.phone),r},kB=(e,r,t)=>{const n=()=>{const s={staff:r,expectedCount:r.length};return console.log("Trying Format 1: Wrapped in staff property with expectedCount",s),fetch(e,{method:"POST",headers:t,body:JSON.stringify(s)}).then(o=>{if(!o.ok)throw new Error(`HTTP error! Status: ${o.status}`);return o.json()}).then(o=>(console.log("Bulk upload successful with Format 1",o),o))},a=()=>(console.log("Trying Format 2: Direct array of staff members"),fetch(e,{method:"POST",headers:t,body:JSON.stringify(r)}).then(s=>{if(!s.ok)throw new Error(`HTTP error! Status: ${s.status}`);return s.json()}).then(s=>(console.log("Bulk upload successful with Format 2",s),s)));return n().catch(s=>(console.log("Format 1 failed:",s.message),a().catch(o=>{throw console.log("Format 2 failed:",o.message),{message:"Failed to import staff data after trying multiple formats",details:"The server may not be correctly configured to accept bulk staff data",originalError:o}})))},Ra={getAll:()=>De.get("staff"),getById:e=>De.get(`staff/${e}`),create:e=>{const r=Pl(e);return De.post("staff",r)},createBulk:e=>{const r=e.map(o=>{const c=Pl(o);return c.joinDate&&(c.joiningDate=c.joinDate,c.joinDate=c.joinDate),c.phoneNumber&&!c.phone&&(c.phone=c.phoneNumber),c});console.log("Sending bulk staff data to server:",JSON.stringify(r,null,2));const n=`${bt.apiUrl.endsWith("/")?bt.apiUrl.slice(0,-1):bt.apiUrl}/api/staff/bulk`;console.log("Using URL:",n);const a=localStorage.getItem("token"),s={"Content-Type":"application/json"};return a?(s.Authorization=`Bearer ${a}`,console.log("Using authentication token")):console.warn("No authentication token found in localStorage"),kB(n,r,s)},bulkCreate:function(e){return this.createBulk(e)},update:(e,r)=>{const t=Pl(r);return De.put(`staff/${e}`,t)},toggleStatus:(e,r)=>De.patch(`staff/${e}/status`,{isActive:r}),updateEmploymentStatus:(e,r)=>{console.log(`[staffService] Updating employment status for staff ID ${e} to ${r}`);const t=localStorage.getItem("token"),n=t?`Token present (${t.substring(0,15)}...)`:"Token missing";let a=[];if(t)try{const s=JSON.parse(atob(t.split(".")[1]));a=s.roles||s.authorities||[],console.log("[staffService] User roles from token:",a),console.log("[staffService] Token expires:",new Date(s.exp*1e3).toLocaleString())}catch(s){console.error("[staffService] Error decoding token:",s)}return console.log("[staffService] Request details:",{endpoint:`staff/${e}/employment-status`,method:"PATCH",payload:{employmentStatus:r},authStatus:n,userRoles:a,timestamp:new Date().toISOString()}),De.patch(`staff/${e}/employment-status`,{employmentStatus:r}).then(s=>(console.log("[staffService] Status update successful:",{statusCode:200,responseData:s,timestamp:new Date().toISOString()}),s)).catch(s=>{var o,c,l;throw console.error("[staffService] Status update failed:",{statusCode:((o=s.response)==null?void 0:o.status)||"No status",errorMessage:((l=(c=s.response)==null?void 0:c.data)==null?void 0:l.message)||s.message,requestDetails:{url:`staff/${e}/employment-status`,method:"PATCH",payload:{employmentStatus:r},authStatus:n,userRoles:a},timestamp:new Date().toISOString()}),s})},delete:e=>De.delete(`staff/${e}`)},CB=["TEACHER","PRINCIPAL","ADMIN_OFFICER","MANAGEMENT","ACCOUNT_OFFICER","LIBRARIAN"],_B=["Mathematics","Science","English","Social Studies","Physical Education","Arts","Music","Computer Science","Languages"],DB=["A+","A-","B+","B-","AB+","AB-","O+","O-"],FB=({open:e,onClose:r,onSubmit:t,initialData:n,loading:a})=>{var p,g,w,y,v;const[s,o]=C.useState(n||{staffId:"",firstName:"",lastName:"",email:"",phoneNumber:"",address:"",dateOfBirth:"",gender:"MALE",joinDate:new Date().toISOString().split("T")[0],role:"TEACHER",isActive:!0,qualifications:"",bloodGroup:"",pfUAN:"",gratuity:"",serviceEndDate:"",basicSalary:0,hra:0,da:0,ta:0,otherAllowances:0,pfContribution:0,taxDeduction:0,netSalary:0,salaryAccountNumber:"",bankName:"",ifscCode:"",teacherDetails:{department:"",specialization:"",subjects:"",teachingExperience:0,isClassTeacher:!1}}),[c,l]=C.useState({}),u=T=>F=>{o(A=>({...A,[T]:F.target.value})),c[T]&&l(A=>({...A,[T]:""}))},d=T=>F=>{o(A=>({...A,teacherDetails:{...A.teacherDetails,[T]:F.target.value}})),c[`teacherDetails.${T}`]&&l(A=>({...A,[`teacherDetails.${T}`]:""}))},f=T=>F=>{o(A=>({...A,teacherDetails:{...A.teacherDetails,[T]:F.target.checked}}))},h=()=>{var F,A;const T={};return s.firstName||(T.firstName="First name is required"),s.lastName||(T.lastName="Last name is required"),s.staffId||(T.staffId="Staff ID is required"),s.email?/^\S+@\S+\.\S+$/.test(s.email)||(T.email="Invalid email format"):T.email="Email is required",s.phoneNumber?/^\+?[\d\s-]{10,}$/.test(s.phoneNumber)||(T.phoneNumber="Invalid phone number"):T.phoneNumber="Phone number is required",s.pfUAN&&!/^[a-zA-Z0-9]+$/.test(s.pfUAN)&&(T.pfUAN="PF UAN must be alphanumeric only"),s.gratuity&&!/^[a-zA-Z0-9]+$/.test(s.gratuity)&&(T.gratuity="Gratuity must be alphanumeric only"),s.role==="TEACHER"&&((F=s.teacherDetails)!=null&&F.department||(T["teacherDetails.department"]="Department is required"),(A=s.teacherDetails)!=null&&A.subjects||(T["teacherDetails.subjects"]="At least one subject is required")),l(T),Object.keys(T).length===0},x=()=>{var F,A,S,E,b,k,j,_;if(!h())return;const T={id:s.id||0,staffId:s.staffId||"",firstName:s.firstName||"",lastName:s.lastName||"",fullName:`${s.firstName||""} ${s.lastName||""}`.trim(),email:s.email||"",phoneNumber:s.phoneNumber||"",address:s.address||"",dateOfBirth:s.dateOfBirth||"",gender:s.gender||"MALE",joinDate:s.joinDate||new Date().toISOString().split("T")[0],role:s.role||"TEACHER",isActive:s.isActive!==void 0?s.isActive:!0,qualifications:s.qualifications||"",emergencyContact:s.emergencyContact||"",bloodGroup:s.bloodGroup||"",profileImage:s.profileImage||"",designations:[],pfUAN:s.pfUAN||"",gratuity:s.gratuity||"",serviceEndDate:s.serviceEndDate||"",basicSalary:s.basicSalary||0,hra:s.hra||0,da:s.da||0,ta:s.ta||0,otherAllowances:s.otherAllowances||0,pfContribution:s.pfContribution||0,taxDeduction:s.taxDeduction||0,netSalary:s.netSalary||0,salaryAccountNumber:s.salaryAccountNumber||"",bankName:s.bankName||"",ifscCode:s.ifscCode||""};T.role==="TEACHER"&&(T.teacherDetails={id:((F=s.teacherDetails)==null?void 0:F.id)||0,department:((A=s.teacherDetails)==null?void 0:A.department)||"",specialization:((S=s.teacherDetails)==null?void 0:S.specialization)||"",subjects:((E=s.teacherDetails)==null?void 0:E.subjects)||"",teachingExperience:((b=s.teacherDetails)==null?void 0:b.teachingExperience)||0,isClassTeacher:((k=s.teacherDetails)==null?void 0:k.isClassTeacher)||!1,classAssignedId:((j=s.teacherDetails)==null?void 0:j.classAssignedId)||0,className:((_=s.teacherDetails)==null?void 0:_.className)||""}),t(T)},m=s.role==="TEACHER";return i.jsx(Yc,{open:e,onClose:r,title:n?"Edit Staff Member":"Add Staff Member",onSubmit:x,submitLabel:n?"Update":"Create",loading:a,maxWidth:"md",children:i.jsxs(X,{container:!0,spacing:2,children:[i.jsxs(X,{item:!0,xs:12,children:[i.jsx(ee,{variant:"h6",children:"Personal Information"}),i.jsx(sr,{sx:{mb:2}})]}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"First Name",value:s.firstName,onChange:u("firstName"),error:!!c.firstName,helperText:c.firstName,required:!0})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Last Name",value:s.lastName,onChange:u("lastName"),error:!!c.lastName,helperText:c.lastName,required:!0})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Staff ID",value:s.staffId,onChange:u("staffId"),error:!!c.staffId,helperText:c.staffId,required:!0,disabled:!!(n!=null&&n.id)})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsxs(mt,{fullWidth:!0,required:!0,children:[i.jsx(Tt,{children:"Role"}),i.jsx(gt,{value:s.role||"TEACHER",onChange:u("role"),label:"Role",children:CB.map(T=>i.jsx(Ye,{value:T,children:T.replace("_"," ")},T))})]})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Email",type:"email",value:s.email,onChange:u("email"),error:!!c.email,helperText:c.email,required:!0})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Phone Number",value:s.phoneNumber,onChange:u("phoneNumber"),error:!!c.phoneNumber,helperText:c.phoneNumber,required:!0})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Date of Birth",type:"date",value:s.dateOfBirth,onChange:u("dateOfBirth"),InputLabelProps:{shrink:!0}})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsxs(mt,{fullWidth:!0,children:[i.jsx(Tt,{children:"Gender"}),i.jsxs(gt,{value:s.gender||"MALE",onChange:u("gender"),label:"Gender",children:[i.jsx(Ye,{value:"MALE",children:"Male"}),i.jsx(Ye,{value:"FEMALE",children:"Female"}),i.jsx(Ye,{value:"OTHER",children:"Other"})]})]})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Join Date",type:"date",value:s.joinDate,onChange:u("joinDate"),InputLabelProps:{shrink:!0},required:!0})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsxs(mt,{fullWidth:!0,children:[i.jsx(Tt,{children:"Blood Group"}),i.jsx(gt,{value:s.bloodGroup||"",onChange:u("bloodGroup"),label:"Blood Group",children:DB.map(T=>i.jsx(Ye,{value:T,children:T},T))})]})}),i.jsx(X,{item:!0,xs:12,children:i.jsx(Ae,{fullWidth:!0,label:"Qualifications",multiline:!0,rows:2,value:s.qualifications,onChange:u("qualifications"),placeholder:"E.g., Bachelor of Education, Master's in Mathematics"})}),i.jsx(X,{item:!0,xs:12,children:i.jsx(Ae,{fullWidth:!0,label:"Address",multiline:!0,rows:2,value:s.address,onChange:u("address")})}),i.jsx(X,{item:!0,xs:12,children:i.jsx(Ae,{fullWidth:!0,label:"Emergency Contact",value:s.emergencyContact,onChange:u("emergencyContact")})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"PF UAN",value:s.pfUAN,onChange:u("pfUAN"),placeholder:"Enter PF UAN"})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Gratuity",value:s.gratuity,onChange:u("gratuity"),placeholder:"Enter Gratuity"})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Service End Date",type:"date",value:s.serviceEndDate,onChange:u("serviceEndDate"),InputLabelProps:{shrink:!0}})}),i.jsxs(X,{item:!0,xs:12,children:[i.jsx(ee,{variant:"h6",sx:{mt:2},children:"Salary Details"}),i.jsx(sr,{sx:{mb:2}})]}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Basic Salary",type:"number",value:s.basicSalary,onChange:u("basicSalary"),InputProps:{inputProps:{min:0}}})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"HRA",type:"number",value:s.hra,onChange:u("hra"),InputProps:{inputProps:{min:0}}})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"DA",type:"number",value:s.da,onChange:u("da"),InputProps:{inputProps:{min:0}}})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"TA",type:"number",value:s.ta,onChange:u("ta"),InputProps:{inputProps:{min:0}}})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Other Allowances",type:"number",value:s.otherAllowances,onChange:u("otherAllowances"),InputProps:{inputProps:{min:0}}})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"PF Contribution",type:"number",value:s.pfContribution,onChange:u("pfContribution"),InputProps:{inputProps:{min:0}}})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Tax Deduction",type:"number",value:s.taxDeduction,onChange:u("taxDeduction"),InputProps:{inputProps:{min:0}}})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Net Salary",type:"number",value:s.netSalary,onChange:u("netSalary"),InputProps:{inputProps:{min:0}}})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Salary Account Number",value:s.salaryAccountNumber,onChange:u("salaryAccountNumber")})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Bank Name",value:s.bankName,onChange:u("bankName")})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"IFSC Code",value:s.ifscCode,onChange:u("ifscCode")})}),m&&i.jsxs(i.Fragment,{children:[i.jsxs(X,{item:!0,xs:12,children:[i.jsx(ee,{variant:"h6",sx:{mt:2},children:"Teacher Details"}),i.jsx(sr,{sx:{mb:2}})]}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsxs(mt,{fullWidth:!0,error:!!c["teacherDetails.department"],children:[i.jsx(Tt,{children:"Department"}),i.jsx(gt,{value:((p=s.teacherDetails)==null?void 0:p.department)||"",onChange:d("department"),label:"Department",required:!0,children:_B.map(T=>i.jsx(Ye,{value:T,children:T},T))}),c["teacherDetails.department"]&&i.jsx(Ja,{children:c["teacherDetails.department"]})]})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Specialization",value:(g=s.teacherDetails)==null?void 0:g.specialization,onChange:d("specialization"),placeholder:"E.g., Calculus, Algebra, Literature"})}),i.jsx(X,{item:!0,xs:12,children:i.jsx(Ae,{fullWidth:!0,label:"Subjects",value:(w=s.teacherDetails)==null?void 0:w.subjects,onChange:d("subjects"),error:!!c["teacherDetails.subjects"],helperText:c["teacherDetails.subjects"]||"Enter comma-separated subjects, e.g., 'Mathematics, Physics'",required:!0})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsx(Ae,{fullWidth:!0,label:"Teaching Experience (years)",type:"number",value:((y=s.teacherDetails)==null?void 0:y.teachingExperience)||0,onChange:d("teachingExperience"),InputProps:{inputProps:{min:0}}})}),i.jsx(X,{item:!0,xs:12,sm:6,children:i.jsxs(mt,{fullWidth:!0,children:[i.jsx(Tt,{children:"Class Teacher"}),i.jsxs(gt,{value:(v=s.teacherDetails)!=null&&v.isClassTeacher?"yes":"no",onChange:T=>{f("isClassTeacher")({target:{checked:String(T.target.value)==="yes"}})},label:"Class Teacher",children:[i.jsx(Ye,{value:"yes",children:"Yes"}),i.jsx(Ye,{value:"no",children:"No"})]})]})})]})]})})};var hf={},jB=_t;Object.defineProperty(hf,"__esModule",{value:!0});var xy=hf.default=void 0,IB=jB(Ft()),PB=i;xy=hf.default=(0,IB.default)((0,PB.jsx)("path",{d:"M11 18h2v-2h-2zm1-16C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8m0-14c-2.21 0-4 1.79-4 4h2c0-1.1.9-2 2-2s2 .9 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5 0-2.21-1.79-4-4-4"}),"HelpOutline");const OB=["staffId","firstName","lastName","email","phoneNumber","role","joinDate"],RB=`staffId,firstName,lastName,email,phoneNumber,role,joinDate,address,dateOfBirth,gender,qualifications,emergencyContact,bloodGroup,isActive
EMP001,John,Smith,john.smith@example.com,1234567890,Teacher,2022-05-15,123 Main St,1985-03-20,MALE,B.Ed in Mathematics,9876543210,A+,true
EMP002,Jane,Doe,jane.doe@example.com,9876543210,Librarian,2021-06-10,456 Elm St,1990-07-12,FEMALE,Master in Library Science,1234567890,O+,true
EMP003,Robert,Johnson,robert.johnson@example.com,5551234567,Admin Officer,2020-03-15,789 Oak Ave,1982-11-30,MALE,MBA,7778889999,B-,true`,NB=({open:e,onClose:r,onSubmit:t,loading:n})=>{const[a,s]=C.useState(""),[o,c]=C.useState([]),[l,u]=C.useState([]),[d,f]=C.useState("initial"),[h,x]=C.useState(""),m=C.useRef(null),p=A=>{s(A.target.value),f("initial"),c([]),u([]),x("")},g=(A,S)=>{const E=[];OB.forEach(k=>{A[k]||E.push({index:S,field:k,message:`Missing required field: ${k}`})}),A.email&&!/^\S+@\S+\.\S+$/.test(A.email)&&E.push({index:S,field:"email",message:"Invalid email format"});const b=["Teacher","Principal","Admin Officer","Management","Account Officer","Librarian"];return A.role&&!b.includes(A.role)&&E.push({index:S,field:"role",message:`Invalid role: ${A.role}. Must be one of: ${b.join(", ")}`}),A.joinDate&&!/^\d{4}-\d{2}-\d{2}$/.test(A.joinDate)&&E.push({index:S,field:"joinDate",message:"Invalid date format for joinDate. Use YYYY-MM-DD"}),A.dateOfBirth&&!/^\d{4}-\d{2}-\d{2}$/.test(A.dateOfBirth)&&E.push({index:S,field:"dateOfBirth",message:"Invalid date format for dateOfBirth. Use YYYY-MM-DD"}),E},w=()=>{try{const A=gg.parse(a,{header:!0,skipEmptyLines:!0});if(A.errors.length>0){u(A.errors.map((b,k)=>({index:k,field:"csv",message:b.message}))),f("error");return}const S=A.data,E=[];if(S.forEach((b,k)=>{const j=g(b,k);E.push(...j)}),E.length>0)u(E),f("error");else{const b=S.map(k=>({...k,isActive:typeof k.isActive=="string"&&k.isActive?String(k.isActive).toLowerCase()==="true":!!k.isActive}));c(b),f("success")}}catch(A){console.error("Error parsing CSV:",A),u([{index:0,field:"csv",message:"Failed to parse CSV: "+(A instanceof Error?A.message:String(A))}]),f("error")}},y=async()=>{if(!(o.length===0||d!=="success"))try{await t(o),s(""),c([]),f("initial"),x("")}catch(A){console.error("Failed to submit staff data:",A)}},v=()=>{const A=new Blob([RB],{type:"text/csv;charset=utf-8;"}),S=document.createElement("a");S.href=URL.createObjectURL(A),S.setAttribute("download","staff_upload_template.csv"),document.body.appendChild(S),S.click(),document.body.removeChild(S)},T=()=>{m.current&&m.current.click()},F=A=>{var b;const S=(b=A.target.files)==null?void 0:b[0];if(!S)return;x(S.name);const E=new FileReader;E.onload=k=>{var _;const j=(_=k.target)==null?void 0:_.result;try{if(S.name.endsWith(".xlsx")||S.name.endsWith(".xls")){const B=xc(j,{type:"binary"}),Q=B.SheetNames[0],Z=B.Sheets[Q],L=Z1.sheet_to_csv(Z);s(L)}else if(S.name.endsWith(".csv"))s(j);else throw new Error("Unsupported file format. Please use CSV, XLSX, or XLS files.");f("initial"),c([]),u([])}catch(B){console.error("Error reading file:",B),u([{index:0,field:"file",message:"Failed to read file: "+(B instanceof Error?B.message:String(B))}]),f("error")}},S.name.endsWith(".csv")?E.readAsText(S):E.readAsBinaryString(S),A.target&&(A.target.value="")};return i.jsxs(br,{open:e,onClose:r,maxWidth:"md",fullWidth:!0,children:[i.jsx(Br,{children:"Bulk Staff Upload"}),i.jsxs(Dr,{children:[i.jsxs(ye,{sx:{mb:2},children:[i.jsx(ee,{variant:"body1",gutterBottom:!0,children:"Upload your CSV/Excel file or paste CSV data below to add or update multiple staff members at once."}),i.jsx(ee,{variant:"body2",color:"text.secondary",children:"Required fields: Staff ID, First Name, Last Name, Email, Phone Number, Role, and Join Date"})]}),i.jsxs(ye,{sx:{mb:2,display:"flex",gap:1},children:[i.jsx(st,{title:"Download sample CSV template",children:i.jsx(Pe,{variant:"outlined",size:"small",onClick:v,startIcon:i.jsx(vd,{}),children:"Download Template"})}),i.jsx("input",{type:"file",accept:".csv,.xlsx,.xls",style:{display:"none"},ref:m,onChange:F}),i.jsx(st,{title:"Upload CSV or Excel file",children:i.jsx(Pe,{variant:"contained",size:"small",onClick:T,startIcon:i.jsx(wd,{}),color:"primary",children:"Upload File"})}),i.jsx(st,{title:"Staff roles must be one of: Teacher, Principal, Admin Officer, Management, Account Officer, or Librarian",children:i.jsx(Ze,{size:"small",color:"info",children:i.jsx(xy,{})})})]}),h&&i.jsxs(Lr,{severity:"info",sx:{mb:2},children:["File loaded: ",h]}),i.jsx(Ae,{label:"CSV Data",multiline:!0,rows:10,value:a,onChange:p,fullWidth:!0,variant:"outlined",placeholder:"staffId,firstName,lastName,email,phoneNumber,role,joinDate,address,dateOfBirth,gender,qualifications,emergencyContact,bloodGroup,isActive",sx:{mb:2}}),i.jsx(ye,{sx:{mb:2},children:i.jsx(Pe,{variant:"contained",color:"secondary",onClick:w,disabled:!a.trim()||n,children:"Parse Data"})}),d==="success"&&i.jsxs(Lr,{severity:"success",sx:{mb:2},children:[i.jsx(Li,{children:"Data Successfully Parsed"}),"Found ",o.length," valid staff records ready to be imported."]}),d==="error"&&i.jsxs(Lr,{severity:"error",sx:{mb:2},children:[i.jsx(Li,{children:"Validation Errors"}),i.jsx(ye,{component:"ul",sx:{pl:2,mt:1},children:l.map((A,S)=>i.jsx("li",{children:`Row ${A.index+1}, ${A.field}: ${A.message}`},S))})]}),o.length>0&&i.jsxs(Ke,{variant:"outlined",sx:{p:2,mt:2,maxHeight:"200px",overflow:"auto"},children:[i.jsxs(ee,{variant:"subtitle1",gutterBottom:!0,children:["Preview of Parsed Data (",o.length," staff members)"]}),i.jsx(sr,{sx:{mb:2}}),o.slice(0,5).map((A,S)=>i.jsx(ye,{sx:{mb:1,p:1,bgcolor:"background.paper"},children:i.jsxs(ee,{variant:"body2",children:[i.jsx("strong",{children:"ID:"})," ",A.staffId,",",i.jsx("strong",{children:" Name:"})," ",A.firstName," ",A.lastName,",",i.jsx("strong",{children:" Role:"})," ",A.role,",",i.jsx("strong",{children:" Email:"})," ",A.email,i.jsx("strong",{children:" Status:"})," ",A.isActive?"Active":"Inactive"]})},S)),o.length>5&&i.jsx($t,{label:`${o.length-5} more staff members`,size:"small",sx:{mt:1}})]})]}),i.jsxs(_r,{children:[i.jsx(Pe,{onClick:r,disabled:n,children:"Cancel"}),i.jsx(Pe,{onClick:y,color:"primary",disabled:o.length===0||d!=="success"||n,startIcon:n?i.jsx(sn,{size:20}):i.jsx(gd,{}),children:n?"Importing...":"Import Staff Data"})]})]})};var pf={},MB=_t;Object.defineProperty(pf,"__esModule",{value:!0});var gy=pf.default=void 0,LB=MB(Ft()),BB=i;gy=pf.default=(0,LB.default)((0,BB.jsx)("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"}),"Refresh");var mf={},$B=_t;Object.defineProperty(mf,"__esModule",{value:!0});var gu=mf.default=void 0,UB=$B(Ft()),VB=i;gu=mf.default=(0,UB.default)((0,VB.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-2h2zm0-4h-2V7h2z"}),"Error");const WB=()=>{const[e,r]=C.useState(!1),[t,n]=C.useState(null),[a,s]=C.useState(0),o=()=>s(l=>l+1);An.useEffect(()=>{const l=localStorage.getItem("token");if(l)try{const u=l.split(".");if(u.length!==3){n({error:"Invalid token format"});return}const d=JSON.parse(atob(u[1])),f=Math.floor(Date.now()/1e3),h=d.exp&&d.exp<f;n({...d,isExpired:h,expiresIn:d.exp?new Date(d.exp*1e3).toLocaleString():"Unknown",decodedPayload:d})}catch(u){const d=u&&typeof u=="object"&&"message"in u&&typeof u.message=="string"?u.message:"Unknown error";n({error:"Failed to decode token",details:d})}else n({error:"No token found in localStorage"})},[a]);const c=An.useMemo(()=>{const l=localStorage.getItem("user");if(!l)return{error:"No user data found"};try{return JSON.parse(l)}catch(u){return{error:"Failed to parse user data",details:u&&typeof u=="object"&&"message"in u&&typeof u.message=="string"?u.message:"Unknown error"}}},[a]);return i.jsxs(ca,{expanded:e,onChange:()=>r(!e),sx:{mb:2,border:"1px solid #ddd"},children:[i.jsx(la,{expandIcon:i.jsx(Xn,{}),children:i.jsxs(ye,{sx:{display:"flex",alignItems:"center",width:"100%",justifyContent:"space-between"},children:[i.jsx(ee,{variant:"subtitle1",children:"Authentication Debugger"}),t!=null&&t.isExpired?i.jsx($t,{icon:i.jsx(gu,{}),label:"Token Expired",color:"error",size:"small"}):t!=null&&t.error?i.jsx($t,{icon:i.jsx(gu,{}),label:"Auth Error",color:"error",size:"small"}):i.jsx($t,{icon:i.jsx(ju,{}),label:"Token Valid",color:"success",size:"small"})]})}),i.jsxs(ua,{children:[i.jsx(ye,{sx:{mb:1},children:i.jsx(Pe,{size:"small",startIcon:i.jsx(gy,{}),onClick:o,variant:"outlined",sx:{mb:2},children:"Refresh Auth Data"})}),i.jsx(ee,{variant:"subtitle2",sx:{fontWeight:"bold",mb:1},children:"User Information:"}),i.jsx(Ke,{sx:{p:1,mb:2,bgcolor:"#f8f9fa",overflowX:"auto"},children:i.jsx("pre",{style:{margin:0},children:JSON.stringify(c,null,2)})}),i.jsx(ee,{variant:"subtitle2",sx:{fontWeight:"bold",mb:1},children:"Token Information:"}),i.jsx(Ke,{sx:{p:1,mb:2,bgcolor:"#f8f9fa",overflowX:"auto"},children:i.jsx("pre",{style:{margin:0},children:JSON.stringify(t,null,2)})}),(t==null?void 0:t.isExpired)&&i.jsxs(ee,{color:"error",variant:"body2",children:["Your token has expired at ",t.expiresIn,". You need to log in again."]}),(t==null?void 0:t.error)&&i.jsxs(ee,{color:"error",variant:"body2",children:["Authentication error: ",t.error]}),i.jsx(ee,{variant:"caption",color:"textSecondary",children:"This debugger is intended for development use only"})]})]})},HB=()=>{const[e,r]=C.useState(!1),[t,n]=C.useState(!1),[a,s]=C.useState(!1),[o,c]=C.useState(void 0),[l,u]=C.useState(null),{showNotification:d}=ln(),{user:f}=_n();C.useEffect(()=>{console.log("Current user:",f),console.log("Has MANAGE_STAFF permission:",f&&f.role?Lt(f.role,"MANAGE_STAFF"):!1)},[f]);const{data:h,loading:x,error:m,refresh:p}=Ln(()=>Ra.getAll(),{cacheKey:"staffList"}),{mutate:g,loading:w}=Mr(O=>Ra.create(O),{onSuccess:()=>{d({type:"success",message:"Staff member created successfully"}),r(!1),p()},onError:O=>{d({type:"error",message:`Failed to create staff member: ${O.message}`})}}),{mutate:y,loading:v}=Mr(O=>Ra.bulkCreate(O),{onSuccess:O=>{const{created:D,updated:re,errors:le}=O;le&&le.length>0?d({type:"warning",message:`Partially completed: Created ${D}, Updated ${re}, Failed ${le.length} records`}):d({type:"success",message:`Successfully imported staff data: Created ${D}, Updated ${re} records`}),n(!1),p()},onError:O=>{d({type:"error",message:`Failed to import staff data: ${O.message}`})}}),{mutate:T,loading:F}=Mr(O=>Ra.update(O.id,O),{onSuccess:()=>{d({type:"success",message:"Staff member updated successfully"}),r(!1),c(void 0),p()},onError:O=>{d({type:"error",message:`Failed to update staff member: ${O.message}`})}}),{mutate:A,loading:S}=Mr(O=>Ra.delete(O),{onSuccess:()=>{d({type:"success",message:"Staff member deleted successfully"}),s(!1),c(void 0),p()},onError:O=>{d({type:"error",message:`Failed to delete staff member: ${O.message}`})}});Mr(O=>{const D={isActive:O.isActive};return Ra.update(O.id,D)},{onSuccess:()=>{d({type:"success",message:"Staff status updated successfully"}),p()},onError:O=>{d({type:"error",message:`Failed to update staff status: ${O.message}`})}});const{mutate:E,loading:b}=Mr(O=>(console.log("Attempting to update employment status with:",{staffId:O.id,newStatus:O.status,currentTime:new Date().toISOString()}),Ra.updateEmploymentStatus(O.id,O.status)),{onSuccess:O=>{console.log("Employment status update succeeded:",{result:O,timestamp:new Date().toISOString()}),d({type:"success",message:"Employment status updated successfully"}),p()},onError:O=>{console.error("Employment status update failed:",{error:O,timestamp:new Date().toISOString()}),d({type:"error",message:`Failed to update employment status: ${O.message}`})}}),k=async(O,D)=>{if(console.log(`[DEBUG] [${new Date().toISOString()}] Attempting to update employment status for staff ID: ${O} to ${D}`),!Xb()){console.error(`[DEBUG] [${new Date().toISOString()}] Permission denied: User lacks required role (ADMIN or HR_MANAGER) for staff status updates`),j(),d({type:"error",message:"You don't have permission to update employment status. This action requires ADMIN or HR_MANAGER role."});return}console.log(`[DEBUG] [${new Date().toISOString()}] Permission check passed. User has ADMIN or HR_MANAGER role.`);try{console.log(`[DEBUG] [${new Date().toISOString()}] Calling staffService.updateEmploymentStatus with ID: ${O}, status: ${D}`);try{const re=localStorage.getItem("token");if(re){const le=qb(re);console.log("[DEBUG] Auth token details before request:",{exp:new Date(le.exp*1e3).toISOString(),roles:le.roles||le.authorities,sub:le.sub,tokenLength:re.length,tokenPrefix:re.substring(0,15)+"..."})}else console.error("[DEBUG] No authentication token found in localStorage")}catch(re){console.error("[DEBUG] Error parsing authentication token:",re)}await E({id:O,status:D}),console.log(`[DEBUG] [${new Date().toISOString()}] Employment status update successful for staff ID: ${O}`)}catch(re){console.error(`[DEBUG] [${new Date().toISOString()}] Error occurred while updating employment status:`,re),re.response?(console.error("[DEBUG] Server response error details:",{status:re.response.status,statusText:re.response.statusText,headers:re.response.headers,data:re.response.data}),re.response.status===403&&(console.error("[DEBUG] 403 Forbidden error detected. Possible causes:"),console.error("1. Token expired during the request"),console.error("2. Token does not contain required roles (ADMIN or HR_MANAGER)"),console.error("3. Backend permission check differs from frontend"),j())):re.request?console.error("[DEBUG] Request was made but no response received:",re.request):console.error("[DEBUG] Error setting up the request:",re.message)}},j=()=>{var O;return f?(console.log("Debug: User permissions check",{userId:f.id,userName:(f==null?void 0:f.username)||"unknown",userRole:(f==null?void 0:f.role)||"none",token:localStorage.getItem("token")?"Present (first 10 chars): "+((O=localStorage.getItem("token"))==null?void 0:O.substring(0,10))+"...":"Missing",hasManageStaff:f!=null&&f.role?Lt(f.role,"MANAGE_STAFF"):!1,timestamp:new Date().toISOString()}),f!=null&&f.role?Lt(f.role,"MANAGE_STAFF"):!1):(console.log("Debug: No user is logged in"),!1)};C.useEffect(()=>{j()},[f]);const _=O=>{j(),c(O),r(!0)},B=O=>{j(),c(O),s(!0)},Q=()=>{r(!1),c(void 0)},Z=()=>{n(!1)},L=()=>{o!=null&&o.id&&A(o.id)},q=async O=>{o!=null&&o.id?await T({...O,id:o.id}):await g(O)},te=async O=>{await y(O)},R=(O,D)=>{console.log("Status change requested:",{staffId:O.id,staffName:`${O.firstName} ${O.lastName}`,currentStatus:O.employmentStatus,requestedStatus:D,timestamp:new Date().toISOString()});const re=j();if(!f){console.error("Permission denied: No authenticated user"),d({type:"error",message:"Authentication required: Please log in again"}),p();return}if(!re){console.error(`Permission denied: User role ${f.role} does not have MANAGE_STAFF permission`),d({type:"error",message:"You do not have permission to update employment status"}),p();return}O.id&&(console.log(`Proceeding with status update for staff ${O.id} to ${D}`),k(O.id,D))},oe=O=>{if(!O)return"default";switch(O){case pr.ACTIVE:return"success";case pr.ON_LEAVE:case pr.SUSPENDED:return"warning";case pr.TERMINATED:case pr.RETIRED:case pr.RESIGNED:return"error";default:return"default"}},J=O=>O==null?void 0:O.replace(/_/g," "),P=O=>{var D;return O.role!=="TEACHER"||!((D=O.teacherDetails)!=null&&D.subjects)?"":O.teacherDetails.subjects},V=O=>{if(!O)return"";const D=O.firstName?O.firstName.charAt(0):"",re=O.lastName?O.lastName.charAt(0):"";return`${D}${re}`.toUpperCase()},z=O=>`${O.firstName||""} ${O.lastName||""}`,G=O=>{switch(O){case"TEACHER":return"#2196f3";case"PRINCIPAL":return"#9c27b0";case"ADMIN_OFFICER":return"#4caf50";case"MANAGEMENT":return"#ff9800";case"ACCOUNT_OFFICER":return"#f44336";case"LIBRARIAN":return"#795548";default:return"#9e9e9e"}},ne={Teacher:"primary",Principal:"secondary","Admin Officer":"info",Management:"warning","Account Officer":"error",Librarian:"success"},he=C.useMemo(()=>h?!l||l==="Total"?h:l==="Active"?h.filter(O=>O.isActive):h.filter(O=>O.role.replace("_"," ").toUpperCase()===l.toUpperCase()||O.role.toUpperCase()===l.replace(" ","_").toUpperCase()):[],[h,l]),se=C.useMemo(()=>{if(!h)return[];const O=[{label:"Total",count:h.length,color:"default"},{label:"Active",count:h.filter(D=>D.isActive).length,color:"success"}];return Object.keys(ne).forEach(D=>{const re=h.filter(le=>le.role===D.toUpperCase().replace(" ","_")||le.role===D).length;O.push({label:D,count:re,color:ne[D]})}),O},[h]),ae=O=>{u(l===O?null:O)},K=[{id:"name",label:"Name",sortable:!0,format:(O,D)=>i.jsxs(ye,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[i.jsx(Sp,{sx:{bgcolor:G(D.role),width:35,height:35,fontSize:"0.9rem"},children:V(D)}),i.jsx(ee,{variant:"body2",children:z(D)})]})},{id:"staffId",label:"Staff ID",sortable:!0},{id:"role",label:"Role",sortable:!0,format:O=>i.jsx($t,{label:J(O),size:"small",color:O==="TEACHER"?"primary":"default",variant:O==="TEACHER"?"filled":"outlined"})},{id:"department",label:"Department",sortable:!0,format:(O,D)=>{var re;return D.role==="TEACHER"?(re=D.teacherDetails)==null?void 0:re.department:"-"}},{id:"subjects",label:"Subjects",sortable:!1,format:(O,D)=>{const re=P(D);return re?i.jsx(ye,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:re.split(",").map((le,Te)=>i.jsx($t,{label:le.trim(),size:"small",variant:"outlined"},Te))}):"-"}},{id:"email",label:"Email",sortable:!0},{id:"phoneNumber",label:"Contact",sortable:!0},{id:"isActive",label:"Status",sortable:!0,format:(O,D)=>Lt((f==null?void 0:f.role)||"","MANAGE_STAFF")?i.jsx(mt,{size:"small",fullWidth:!0,children:i.jsx(gt,{value:D.employmentStatus||pr.ACTIVE,onChange:re=>R(D,re.target.value),disabled:b,variant:"standard",sx:{"& .MuiSelect-select":{py:0,color:()=>{switch(D.employmentStatus){case pr.ACTIVE:return"success.main";case pr.ON_LEAVE:case pr.SUSPENDED:return"warning.main";case pr.TERMINATED:case pr.RETIRED:case pr.RESIGNED:return"error.main";default:return"text.primary"}}}},children:Object.values(pr).map(re=>i.jsx(Ye,{value:re,children:re.replace("_"," ")},re))})}):i.jsx($t,{label:(D.employmentStatus||pr.ACTIVE).replace("_"," "),color:oe(D.employmentStatus),size:"small"})},{id:"actions",label:"Actions",sortable:!1,format:(O,D)=>i.jsxs(ye,{sx:{display:"flex",gap:1},children:[Lt((f==null?void 0:f.role)||"","MANAGE_STAFF")&&i.jsxs(i.Fragment,{children:[i.jsx(st,{title:"Edit",children:i.jsx(Ze,{size:"small",onClick:()=>_(D),color:"primary",children:i.jsx(ro,{fontSize:"small"})})}),i.jsx(st,{title:"Delete",children:i.jsx(Ze,{size:"small",onClick:()=>B(D),color:"error",children:i.jsx(Qs,{fontSize:"small"})})})]}),D.role==="TEACHER"&&i.jsxs(i.Fragment,{children:[i.jsx(st,{title:"View Schedule",children:i.jsx(Ze,{size:"small",color:"default",children:i.jsx(Pp,{fontSize:"small"})})}),i.jsx(st,{title:"View Classes",children:i.jsx(Ze,{size:"small",color:"info",children:i.jsx(Qa,{fontSize:"small"})})})]}),i.jsx(st,{title:"Contact",children:i.jsx(Ze,{size:"small",color:"success",children:i.jsx(Op,{fontSize:"small"})})})]})}];if(x&&!h)return i.jsx(an,{});if(m){const O=typeof m=="string"?m:(m==null?void 0:m.message)||String(m);return i.jsx(on,{message:O,onRetry:p})}return i.jsxs(ye,{sx:{p:3},children:[i.jsxs(ye,{sx:{mb:3,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx(ee,{variant:"h4",children:"Staff Management"}),Lt((f==null?void 0:f.role)||"","MANAGE_STAFF")&&i.jsxs(vc,{direction:"row",spacing:2,children:[i.jsx(Pe,{variant:"outlined",color:"primary",startIcon:i.jsx(jp,{}),onClick:()=>n(!0),children:"Bulk Upload"}),i.jsx(Pe,{variant:"contained",color:"primary",startIcon:i.jsx(zs,{}),onClick:()=>r(!0),children:"Add Staff Member"})]})]}),i.jsx(Ke,{sx:{p:2,mb:3},children:i.jsxs(ye,{sx:{mb:2},children:[i.jsx(ee,{variant:"h6",gutterBottom:!0,children:"Staff Overview"}),i.jsx(X,{container:!0,spacing:1,children:se.map((O,D)=>i.jsx(X,{item:!0,children:i.jsx($t,{label:`${O.label}: ${O.count}`,color:O.color,variant:l===O.label?"filled":"outlined",sx:{minWidth:100,cursor:"pointer",fontWeight:l===O.label?"bold":"normal"},onClick:()=>ae(O.label)})},D))}),l&&i.jsxs(ye,{sx:{mt:2,display:"flex",alignItems:"center"},children:[i.jsx(ee,{variant:"body2",color:"text.secondary",mr:1,children:"Filtered by:"}),i.jsx($t,{label:l,size:"small",onDelete:()=>u(null)})]})]})}),i.jsx(Ke,{children:i.jsx(zc,{columns:K,data:he||[],loading:x,onRefresh:p,searchPlaceholder:"Search staff...",initialSortBy:"role"})}),i.jsx(FB,{open:e,onClose:Q,onSubmit:q,initialData:o,loading:w||F}),i.jsx(NB,{open:t,onClose:Z,onSubmit:te,loading:v}),i.jsxs(br,{open:a,onClose:()=>s(!1),children:[i.jsx(Br,{children:"Confirm Deletion"}),i.jsx(Dr,{children:i.jsxs(Ip,{children:["Are you sure you want to delete ",o?z(o):"this staff member","? This action cannot be undone."]})}),i.jsxs(_r,{children:[i.jsx(Pe,{onClick:()=>s(!1),disabled:S,children:"Cancel"}),i.jsx(Pe,{onClick:L,color:"error",disabled:S,children:S?"Deleting...":"Delete"})]})]}),i.jsx(WB,{})]})},zB=Zy({palette:{primary:{main:"#1976d2",light:"#42a5f5",dark:"#1565c0",contrastText:"#ffffff"},secondary:{main:"#9c27b0",light:"#ba68c8",dark:"#7b1fa2",contrastText:"#ffffff"},success:{main:"#2e7d32",light:"#4caf50",dark:"#1b5e20"},warning:{main:"#ed6c02",light:"#ff9800",dark:"#e65100"},error:{main:"#d32f2f",light:"#ef5350",dark:"#c62828"},info:{main:"#0288d1",light:"#03a9f4",dark:"#01579b"}},typography:{fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif',h1:{fontSize:"2.5rem",fontWeight:500,letterSpacing:"-0.01562em"},h2:{fontSize:"2rem",fontWeight:500,letterSpacing:"-0.00833em"},h3:{fontSize:"1.75rem",fontWeight:500,letterSpacing:"0em"},h4:{fontSize:"1.5rem",fontWeight:500,letterSpacing:"0.00735em"},h5:{fontSize:"1.25rem",fontWeight:500,letterSpacing:"0em"},h6:{fontSize:"1rem",fontWeight:500,letterSpacing:"0.0075em"},button:{textTransform:"none",fontWeight:500}},components:{MuiButton:{styleOverrides:{root:{borderRadius:8},contained:{boxShadow:"none","&:hover":{boxShadow:"0px 2px 4px rgba(0,0,0,0.2)"}}}},MuiCard:{styleOverrides:{root:{borderRadius:12,boxShadow:"0px 2px 4px rgba(0,0,0,0.1)"}}},MuiDialog:{styleOverrides:{paper:{borderRadius:12}}},MuiDataGrid:{styleOverrides:{root:{border:"none","& .MuiDataGrid-cell:focus":{outline:"none"}}}}}});class bp extends An.Component{constructor(r){super(r),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(r,t){console.error("Error in component:",r,t)}render(){return this.state.hasError?i.jsx("div",{children:"Something went wrong. Please try refreshing the page."}):this.props.children}}const Na=({children:e})=>{const r=C.useContext(Du);return C.useEffect(()=>{console.log("🔐 ProtectedRoute: Auth context available:",!!r),console.log("🔐 ProtectedRoute: Authentication status:",r==null?void 0:r.isAuthenticated)},[r]),r!=null&&r.loading?i.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:i.jsx("div",{children:"Authenticating..."})}):r!=null&&r.isAuthenticated?i.jsx(i.Fragment,{children:e}):(console.log("🚫 ProtectedRoute: User not authenticated, redirecting to login"),i.jsx(Lo,{to:"/login"}))},Hr={ADMIN:"ADMIN",TEACHER:"TEACHER",STAFF:"STAFF",PARENT:"PARENT",STUDENT:"STUDENT"};function GB(){return i.jsxs(Mp,{children:[i.jsx(pn,{path:"/",element:i.jsx(my,{})}),i.jsx(pn,{path:"/login",element:i.jsx(Y8,{})}),i.jsx(pn,{path:"/register",element:i.jsx(X8,{})}),i.jsx(pn,{path:"/dashboard",element:i.jsx(Na,{children:i.jsx(Fa,{children:i.jsx(_P,{})})})}),i.jsx(pn,{path:"/students",element:i.jsx(Na,{children:i.jsx(Fa,{children:i.jsx(As,{allowedRoles:[Hr.ADMIN,Hr.TEACHER,Hr.STAFF],children:i.jsx(s8,{})})})})}),i.jsx(pn,{path:"/staff",element:i.jsx(Na,{children:i.jsx(Fa,{children:i.jsx(As,{allowedRoles:[Hr.ADMIN],children:i.jsx(HB,{})})})})}),i.jsx(pn,{path:"/courses",element:i.jsx(Na,{children:i.jsx(Fa,{children:i.jsx(As,{allowedRoles:[Hr.ADMIN,Hr.TEACHER,Hr.STAFF],children:i.jsx(o8,{})})})})}),i.jsx(pn,{path:"/reports",element:i.jsx(Na,{children:i.jsx(Fa,{children:i.jsx(As,{allowedRoles:[Hr.ADMIN,Hr.TEACHER,Hr.STAFF],children:i.jsx(l8,{})})})})}),i.jsx(pn,{path:"/admissions",element:i.jsx(Na,{children:i.jsx(Fa,{children:i.jsx(As,{allowedRoles:[Hr.ADMIN,Hr.STAFF],children:i.jsx(M8,{})})})})}),i.jsx(pn,{path:"/fees",element:i.jsx(Na,{children:i.jsx(Fa,{children:i.jsx(As,{allowedRoles:[Hr.ADMIN],children:i.jsx(G8,{})})})})})]})}function YB(){const[e,r]=C.useState(!1);return C.useEffect(()=>{console.log("🏁 App component mounted")},[]),i.jsx(bp,{children:i.jsxs(ev,{theme:zB,children:[i.jsx(wp,{}),i.jsx(Jb,{children:i.jsx(av,{children:i.jsx(bp,{children:e?i.jsx(Mp,{children:i.jsx(pn,{path:"*",element:i.jsx(my,{})})}):i.jsx(An.Suspense,{fallback:i.jsx("div",{children:"Loading..."}),children:i.jsx(Zb,{children:i.jsx(GB,{})})})})})})]})})}Ml.createRoot(document.getElementById("root")).render(i.jsx(An.StrictMode,{children:i.jsx(YB,{})}));export{Mn as a,bt as c};
//# sourceMappingURL=index-c302092e.js.map
